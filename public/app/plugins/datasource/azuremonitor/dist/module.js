/*! For license information please see module.js.LICENSE.txt */
/* [create-plugin] version: 5.22.0 */
define(["module","@grafana/data","react","i18next","@grafana/runtime","@emotion/css","@grafana/ui","lodash","rxjs","prismjs","@kusto/monaco-kusto","rxjs/operators"],((e,t,r,o,s,a,n,i,c,l,u,d)=>(()=>{var p,m,f,b,h,g,v,y={24:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var o=r(3241),s=r(7781);class a{static createISO8601Duration(e,t){return(0,o.includes)(["hour","minute","h","m"],t)?`PT${e}${t[0].toUpperCase()}`:`P${e}${t[0].toUpperCase()}`}static createISO8601DurationFromInterval(e){const t=+e.slice(0,e.length-1),r=e[e.length-1];if(e.indexOf("ms")>-1)return a.createISO8601Duration(1,"m");if("s"===e[e.length-1]){let e=60*t%60;return e<1&&(e=1),a.createISO8601Duration(e,"m")}return a.createISO8601Duration(t,r)}static findClosestTimeGrain(e,t){const r=(0,o.filter)(t,(e=>"auto"!==e));let a=r[0];const n=s.rangeUtil.intervalToMs(e);for(let e=0;e<r.length;e++)n>s.rangeUtil.intervalToMs(r[e])&&(a=e+1<r.length?r[e+1]:r[e]);return a}static createTimeGrainFromISO8601Duration(e){let t=1;"PT"===e.substring(0,2)&&(t=2);const r=e.substring(t,e.length-1),o=e.substring(e.length-1);return r+" "+a.timeUnitToText(+r,o)}static timeUnitToText(e,t){let r="";return"S"===t&&(r="second"),"M"===t&&(r="minute"),"H"===t&&(r="hour"),"D"===t&&(r="day"),e>1?r+"s":r}static createKbnUnitFromISO8601Duration(e){if("auto"===e)return"auto";let t=1;"PT"===e.substring(0,2)&&(t=2);const r=e.substring(t,e.length-1),o=e.substring(e.length-1);return r+a.timeUnitToKbn(+r,o)}static timeUnitToKbn(e,t){return"S"===t?"s":"M"===t?"m":"H"===t?"h":"D"===t?"d":""}}},110:(e,t,r)=>{"use strict";const o=r(7715);e.exports=(e,t,r)=>o(e,t,"<",r)},122:e=>{"use strict";e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},130:(e,t,r)=>{"use strict";const o=r(2839);e.exports=(e,t)=>{try{return new o(e,t).range||"*"}catch(e){return null}}},186:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",o=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),o&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),o&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,o,s,a){"string"==typeof e&&(e=[[null,e,void 0]]);var n={};if(o)for(var i=0;i<this.length;i++){var c=this[i][0];null!=c&&(n[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);o&&n[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),s&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=s):u[4]="".concat(s)),t.push(u))}},t}},211:e=>{"use strict";e.exports=o},284:(e,t,r)=>{"use strict";const o=r(2839);e.exports=(e,t,r)=>(e=new o(e,r),t=new o(t,r),e.intersects(t,r))},362:(e,t,r)=>{"use strict";const o=r(4708),s=r(4256),{safeRe:a,t:n}=r(5750);e.exports=(e,t)=>{if(e instanceof o)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const o=t.includePrerelease?a[n.COERCERTLFULL]:a[n.COERCERTL];let s;for(;(s=o.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&s.index+s[0].length===r.index+r[0].length||(r=s),o.lastIndex=s.index+s[1].length+s[2].length;o.lastIndex=-1}else r=e.match(t.includePrerelease?a[n.COERCEFULL]:a[n.COERCE]);if(null===r)return null;const i=r[2],c=r[3]||"0",l=r[4]||"0",u=t.includePrerelease&&r[5]?`-${r[5]}`:"",d=t.includePrerelease&&r[6]?`+${r[6]}`:"";return s(`${i}.${c}.${l}${u}${d}`,t)}},608:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var o=r(9728),s=r(6089),a=r(5959),n=r(1874),i=r(2827),c=r(2007);const l=e=>({resourceList:(0,s.css)({width:"100%",display:"flex",marginBlock:e.spacing(1)})}),u=({resources:e,onChange:t})=>{const r=(0,c.useStyles2)(l);(0,a.useEffect)((()=>{0===e.length&&t([""])}),[e,t]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.Label,{children:(0,o.jsxs)("h6",{children:[(0,o.jsx)(n.x6,{i18nKey:"components.advanced-resource-picker.label-resource-uri",children:"Resource URI(s) "}),(0,o.jsx)(c.Tooltip,{content:(0,o.jsxs)(n.x6,{i18nKey:"components.advanced-resource-picker.tooltip-resource-uri",children:["Manually edit the"," ",(0,o.jsx)(c.TextLink,{href:"https://docs.microsoft.com/en-us/azure/azure-monitor/logs/log-standard-columns#_resourceid",external:!0,children:"resource uri"}),". Supports the use of multiple template variables (ex: /subscriptions/$subId/resourceGroups/$rg)"]}),placement:"right",interactive:!0,children:(0,o.jsx)(c.Icon,{name:"info-circle"})})]})}),e.map(((s,a)=>(0,o.jsx)("div",{children:(0,o.jsxs)("div",{className:r.resourceList,children:[(0,o.jsx)(c.Input,{id:`input-advanced-resource-picker-${a+1}`,value:s,onChange:r=>((r,o)=>{const s=[...e];s[r]=o,t(s)})(a,r.currentTarget.value),placeholder:"ex: /subscriptions/$subId","data-testid":`input-advanced-resource-picker-${a+1}`}),(0,o.jsx)(i.Z,{"aria-label":(0,n.t)("components.advanced-resource-picker.aria-label-remove","Remove"),icon:"times",variant:"secondary",onClick:()=>(r=>{const o=[...e];o.splice(r,1),t(o)})(a),"data-testid":"remove-resource",hidden:1===e.length})]})},`resource-${a+1}`))),(0,o.jsx)(c.Button,{"aria-label":(0,n.t)("components.advanced-resource-picker.aria-label-add","Add"),icon:"plus",variant:"secondary",onClick:()=>{t(e.concat(""))},type:"button",children:(0,o.jsx)(n.x6,{i18nKey:"components.advanced-resource-picker.button-add-resource-uri",children:"Add resource URI"})})]})}},627:e=>{e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},709:(e,t,r)=>{"use strict";const o=r(5750),s=r(2074),a=r(4708),n=r(3808),i=r(4256),c=r(9881),l=r(8854),u=r(2479),d=r(4952),p=r(1034),m=r(9406),f=r(5229),b=r(6513),h=r(3440),g=r(7618),v=r(5699),y=r(7565),w=r(3559),O=r(1173),j=r(9308),S=r(2083),x=r(1409),k=r(6031),A=r(3833),P=r(4624),E=r(4991),z=r(362),C=r(9264),T=r(2839),D=r(3238),N=r(3327),I=r(6988),R=r(2366),L=r(7453),M=r(130),q=r(7715),$=r(7379),G=r(110),F=r(284),_=r(8285),V=r(2008);e.exports={parse:i,valid:c,clean:l,inc:u,diff:d,major:p,minor:m,patch:f,prerelease:b,compare:h,rcompare:g,compareLoose:v,compareBuild:y,sort:w,rsort:O,gt:j,lt:S,eq:x,neq:k,gte:A,lte:P,cmp:E,coerce:z,Comparator:C,Range:T,satisfies:D,toComparators:N,maxSatisfying:I,minSatisfying:R,minVersion:L,validRange:M,outside:q,gtr:$,ltr:G,intersects:F,simplifyRange:_,subset:V,SemVer:a,re:o.re,src:o.src,tokens:o.t,SEMVER_SPEC_VERSION:s.SEMVER_SPEC_VERSION,RELEASE_TYPES:s.RELEASE_TYPES,compareIdentifiers:n.compareIdentifiers,rcompareIdentifiers:n.rcompareIdentifiers}},894:(e,t,r)=>{"use strict";r.d(t,{A:()=>Ce});var o=r(3241),s=r(1269),a=r(3059),n=r(9688),i=r(7781),c=r(8531),l=r(3542),u=r(2098),d=r(5098),p=r(9473);const m=/([\w\W]+):([\w]+)(?:\s?=\s?([\w\W]+))?/;function f(e){return e.functions?e.functions.map((e=>{const t=e.parameters&&e.parameters.split(", ").map((e=>{const t=e.match(m);if(!t)return;const[,r,o,s]=t;return{name:r,type:o,defaultValue:s,cslDefaultValue:s}})).filter((e=>!!e));return{name:e.name,body:e.body,inputParameters:t||[]}})):[]}function b(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){b(a,o,s,n,i,"next",e)}function i(e){b(a,o,s,n,i,"throw",e)}n(void 0)}))}}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){g(e,t,r[t])}))}return e}function y(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class w extends c.DataSourceWithBackend{isConfigured(){return!this.validateDatasource()}filterQuery(e){var t,r,o,s;return!(!0===e.hide||(!(null===(t=e.azureLogAnalytics)||void 0===t?void 0:t.query)||!(null===(r=e.azureLogAnalytics.resources)||void 0===r?void 0:r.length)&&!e.azureLogAnalytics.workspace)&&!(null===(s=e.azureTraces)||void 0===s||null===(o=s.resources)||void 0===o?void 0:o.length))}getSubscriptions(){return h((function*(){if(!this.isConfigured())return[];const e=`${this.azureMonitorPath}?api-version=2019-03-01`;return yield this.getResource(e).then((e=>l.A.parseSubscriptions(e)))})).call(this)}getWorkspaces(e){return h((function*(){const t=yield this.getWorkspaceList(e);return(0,o.map)(t.value,(e=>({text:e.name,value:e.id})))||[]})).call(this)}getWorkspaceList(e){const t=this.templateSrv.replace(e||this.defaultSubscriptionId),r=this.azureMonitorPath+`/${t}/providers/Microsoft.OperationalInsights/workspaces?api-version=2017-04-26-preview`;return this.getResource(r)}getMetadata(e){return h((function*(){const t=`${this.resourcePath}/v1${e}/metadata`;return yield this.getResource(t)})).call(this)}getKustoSchema(e){return h((function*(){const t=this.templateSrv.replace(e,{},p.sf);return function(e,t,r){const o={name:t,tables:e.tables,functions:f(e),majorVersion:0,minorVersion:0,entityGroups:[]};return o.functions.push({name:"$__timeFilter",body:"{ true }",inputParameters:[{name:"timeColumn",type:"System.String",defaultValue:'""',cslDefaultValue:'""'}]},{name:"$__timeFrom",body:"{ datetime(2018-06-05T18:09:58.907Z) }",inputParameters:[]},{name:"$__timeTo",body:"{ datetime(2018-06-05T20:09:58.907Z) }",inputParameters:[]},{name:"$__escapeMulti",body:"{ @'\\grafana-vmNetwork(eth0)Total', @'\\hello!'}",inputParameters:[{name:"$myVar",type:"System.String",defaultValue:"$myVar",cslDefaultValue:"$myVar"}]},{name:"$__contains",body:"{ colName in ('value1','value2') }",inputParameters:[{name:"colName",type:"System.String",defaultValue:"colName",cslDefaultValue:"colName"},{name:"$myVar",type:"System.String",defaultValue:"$myVar",cslDefaultValue:"$myVar"}]}),{clusterType:"Engine",cluster:{connectionString:t,databases:[o]},database:o,globalScalarParameters:r.map((e=>({name:`$${e.name}`,type:"dynamic"})))}}(yield this.getMetadata(t),t,this.templateSrv.getVariables())})).call(this)}applyTemplateVariables(e,t){let r;if(e.queryType===d.o.LogAnalytics&&e.azureLogAnalytics){r=e.azureLogAnalytics;const o=this.expandResourcesForMultipleVariables(r.resources,t);let s=this.templateSrv.replace(r.workspace,t);s||o||!this.firstWorkspace||(s=this.firstWorkspace);const a=this.templateSrv.replace(r.query,t,p.sf);return y(v({},e),{queryType:e.queryType||d.o.LogAnalytics,azureLogAnalytics:{builderQuery:r.builderQuery,resultFormat:r.resultFormat,query:a,resources:o,workspace:s,dashboardTime:r.dashboardTime,basicLogsQuery:r.basicLogsQuery,timeColumn:this.templateSrv.replace(r.timeColumn,t)}})}if(e.queryType===d.o.AzureTraces&&e.azureTraces){var o,s;r=e.azureTraces;const n=this.expandResourcesForMultipleVariables(r.resources,t),i=this.templateSrv.replace(r.query,t,p.sf),c=null===(o=r.traceTypes)||void 0===o?void 0:o.map((e=>this.templateSrv.replace(e,t)));var a;const l=(null!==(a=r.filters)&&void 0!==a?a:[]).filter((e=>!!e.property)).map((e=>{var r;const o=null===(r=e.filters)||void 0===r?void 0:r.map((e=>this.templateSrv.replace(null!=e?e:"",t)));return{property:this.templateSrv.replace(e.property,t),operation:e.operation||"eq",filters:o||[]}}));return y(v({},e),{queryType:e.queryType||d.o.AzureTraces,azureTraces:{resultFormat:r.resultFormat,query:i,resources:n,operationId:this.templateSrv.replace(null===(s=e.azureTraces)||void 0===s?void 0:s.operationId,t),filters:l,traceTypes:c}})}return e}expandResourcesForMultipleVariables(e,t){if(!e)return;const r=[];return e.forEach((e=>{this.templateSrv.replace(e,t,"raw").split(",").forEach((e=>{r.push(e)}))})),r}getDeprecatedDefaultWorkSpace(){return this.instanceSettings.jsonData.logAnalyticsDefaultWorkspace}getDefaultOrFirstSubscription(){return h((function*(){var e;if(this.defaultSubscriptionId)return this.defaultSubscriptionId;return null===(e=(yield this.getSubscriptions())[0])||void 0===e?void 0:e.value})).call(this)}getFirstWorkspace(){return h((function*(){var e;if(this.firstWorkspace)return this.firstWorkspace;const t=yield this.getDefaultOrFirstSubscription();if(!t)return;const r=null===(e=(yield this.getWorkspaces(t))[0])||void 0===e?void 0:e.value;return r&&(this.firstWorkspace=r),r})).call(this)}validateDatasource(){if("clientsecret"===this.credentials.authType){if(!this.isValidConfigField(this.credentials.tenantId))return{status:"error",message:"The Tenant Id field is required."};if(!this.isValidConfigField(this.credentials.clientId))return{status:"error",message:"The Client Id field is required."}}}isValidConfigField(e){return"string"==typeof e&&e.length>0}getAzureLogAnalyticsCheatsheetQueries(){return h((function*(){return yield this.getResource(`${this.resourcePath}/v1/metadata`)})).call(this)}getBasicLogsQueryUsage(e,t){return h((function*(){var r,o;const s=(0,c.getTemplateSrv)(),a={table:t,resource:s.replace(null===(o=e.azureLogAnalytics)||void 0===o||null===(r=o.resources)||void 0===r?void 0:r[0]),queryType:e.queryType,from:s.replace("$__from"),to:s.replace("$__to")};return yield this.postResource(`${this.resourcePath}/usage/basiclogs`,a)})).call(this)}constructor(e,t=(0,c.getTemplateSrv)()){super(e),g(this,"instanceSettings",void 0),g(this,"templateSrv",void 0),g(this,"credentials",void 0),g(this,"resourcePath",void 0),g(this,"defaultSubscriptionId",void 0),g(this,"azureMonitorPath",void 0),g(this,"firstWorkspace",void 0),this.instanceSettings=e,this.templateSrv=t,this.credentials=(0,u.p)(e),this.resourcePath=`${p.yX.logAnalytics}`,this.azureMonitorPath=`${p.yX.azureMonitor}/subscriptions`,this.defaultSubscriptionId=this.instanceSettings.jsonData.subscriptionId||""}}var O=r(24),j=r(1427),S=r(6463),x=r(6180);function k(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function A(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){k(a,o,s,n,i,"next",e)}function i(e){k(a,o,s,n,i,"throw",e)}n(void 0)}))}}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){P(e,t,r[t])}))}return e}function z(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function C(e){return!(!e||"select"===e)}class T extends c.DataSourceWithBackend{isConfigured(){return!this.validateDatasource()}filterQuery(e){var t,r,o,s,a,n;const i=(null==e||null===(t=e.azureMonitor)||void 0===t?void 0:t.resources)&&e.azureMonitor.resources.length>0&&e.azureMonitor.resources.every((e=>C(e.resourceGroup)&&C(e.resourceName)))&&C((null==e||null===(r=e.azureMonitor)||void 0===r?void 0:r.metricDefinition)||(null==e||null===(o=e.azureMonitor)||void 0===o?void 0:o.metricNamespace)),c=C(null===(s=e.azureMonitor)||void 0===s?void 0:s.resourceUri);return!(!0===e.hide||!i&&!c||!C(null==e||null===(a=e.azureMonitor)||void 0===a?void 0:a.metricName)||!C(null==e||null===(n=e.azureMonitor)||void 0===n?void 0:n.aggregation))}applyTemplateVariables(e,t){var r;const o=e.azureMonitor;if(!o)throw new Error("Query is not a valid Azure Monitor Metrics query");o.resourceUri&&(o.resourceUri=this.templateSrv.replace(o.resourceUri,t)),o.metricDefinition&&(o.metricDefinition=this.templateSrv.replace(o.metricDefinition,t)),o.timeGrain&&o.timeGrainUnit&&"auto"!==o.timeGrain&&(o.timeGrain=O.A.createISO8601Duration(o.timeGrain,o.timeGrainUnit));const s=(0,S.A)(e),a=s.azureMonitor;if(!a)throw new Error("Query is not a valid Azure Monitor Metrics query");const n=this.templateSrv.replace(s.subscription||this.defaultSubscriptionId,t),i=null===(r=a.resources)||void 0===r?void 0:r.map((e=>(0,p.GV)(this.templateSrv,e,t))).flat(),c=this.templateSrv.replace(a.metricNamespace,t),l=this.templateSrv.replace(a.customNamespace,t),u=this.templateSrv.replace((a.timeGrain||"").toString(),t),m=this.templateSrv.replace(a.aggregation,t),f=this.templateSrv.replace(a.top||"",t);var b;const h=(null!==(b=a.dimensionFilters)&&void 0!==b?b:[]).filter((e=>e.dimension&&"None"!==e.dimension)).map((e=>{var r;const o=null===(r=e.filters)||void 0===r?void 0:r.map((e=>this.templateSrv.replace(null!=e?e:"",t)));return{dimension:this.templateSrv.replace(e.dimension,t),operator:e.operator||"eq",filters:o||[]}})),g=z(E({},a),{resources:i,metricNamespace:c,customNamespace:l,timeGrain:u,allowedTimeGrainsMs:a.allowedTimeGrainsMs,metricName:this.templateSrv.replace(a.metricName,t),region:this.templateSrv.replace(a.region,t),aggregation:m,dimensionFilters:h,top:f||"10",alias:a.alias});return z(E({},e),{subscription:n,queryType:d.o.AzureMonitor,azureMonitor:g})}getSubscriptions(){return A((function*(){return this.isConfigured()?this.getResource(`${this.resourcePath}/subscriptions?api-version=2019-03-01`).then((e=>l.A.parseSubscriptions(e))):[]})).call(this)}getMetricNamespaces(e,t,r,s){const a=x.A.buildAzureMonitorGetMetricNamespacesUrl(this.resourcePath,this.apiPreviewVersion,this.replaceSingleTemplateVariables(e),t,this.templateSrv,r);return this.getResource(a).then((e=>(s&&(e.value=e.value.filter((e=>"Custom"===e.classification))),l.A.parseResponseValues(e,"properties.metricNamespaceName","properties.metricNamespaceName")))).then((e=>{if(a.toLowerCase().includes("microsoft.storage/storageaccounts")){const t=["microsoft.storage/storageaccounts","microsoft.storage/storageaccounts/blobservices","microsoft.storage/storageaccounts/fileservices","microsoft.storage/storageaccounts/tableservices","microsoft.storage/storageaccounts/queueservices"];for(const r of t)(0,o.find)(e,["value",r.toLowerCase()])||e.push({value:r,text:r})}return e})).catch((e=>(console.error(`Failed to get metric namespaces: ${e}`),[])))}getMetricNames(e,t,r){const o=t?this.apiPreviewVersion:this.apiVersion,s=x.A.buildAzureMonitorGetMetricNamesUrl(this.resourcePath,o,this.replaceSingleTemplateVariables(e),this.templateSrv,t,r);return this.getResource(s).then((e=>l.A.parseResponseValues(e,"name.localizedValue","name.value")))}getMetricMetadata(e,t,r){const{metricName:o}=e,s=t?this.apiPreviewVersion:this.apiVersion,a=x.A.buildAzureMonitorGetMetricNamesUrl(this.resourcePath,s,this.replaceSingleTemplateVariables(e),this.templateSrv,t,r);return this.getResource(a).then((e=>l.A.parseMetadata(e,this.templateSrv.replace(o))))}validateDatasource(){if("clientsecret"===this.credentials.authType){if(!this.isValidConfigField(this.credentials.tenantId))return{status:"error",message:"The Tenant Id field is required."};if(!this.isValidConfigField(this.credentials.clientId))return{status:"error",message:"The Client Id field is required."}}}getWorkspaceTablePlan(e,t){return A((function*(){let r="";if(e&&(r=e[0]),!r)return j.iy.Analytics;if(r&&!r.toLowerCase().includes("microsoft.operationalinsights/workspaces"))return j.iy.Analytics;const o=x.A.buildAzureMonitorGetLogsTableUrl(this.resourcePath,this.templateSrv.replace(r),this.templateSrv.replace(t)),s=yield this.getResource(o);return!s||(0,j.Tc)(s)?j.iy.Analytics:s.properties.plan||j.iy.Analytics})).call(this)}isValidConfigField(e){return"string"==typeof e&&e.length>0}replaceSingleTemplateVariables(e,t){return(0,p.GV)(this.templateSrv,e,t)[0]}getProvider(e){return A((function*(){return yield this.getResource(`${p.yX.azureMonitor}/providers/${e}?api-version=${this.providerApiVersion}`)})).call(this)}getLocations(e){return A((function*(){const t=new Map;for(const r of e){const e=l.A.parseLocations(yield this.getResource(`${p.yX.azureMonitor}/subscriptions/${this.templateSrv.replace(r)}/locations?api-version=${this.locationsApiVersion}`));for(const r of e)t.set(r.name,r)}return t})).call(this)}constructor(e,t=(0,c.getTemplateSrv)()){super(e),P(this,"templateSrv",void 0),P(this,"credentials",void 0),P(this,"apiVersion",void 0),P(this,"apiPreviewVersion",void 0),P(this,"listByResourceGroupApiVersion",void 0),P(this,"providerApiVersion",void 0),P(this,"locationsApiVersion",void 0),P(this,"defaultSubscriptionId",void 0),P(this,"basicLogsEnabled",void 0),P(this,"resourcePath",void 0),this.templateSrv=t,this.apiVersion="2018-01-01",this.apiPreviewVersion="2017-12-01-preview",this.listByResourceGroupApiVersion="2021-04-01",this.providerApiVersion="2021-04-01",this.locationsApiVersion="2020-01-01",this.credentials=(0,u.p)(e),this.defaultSubscriptionId=e.jsonData.subscriptionId,this.basicLogsEnabled=e.jsonData.basicLogsEnabled,this.resourcePath=p.yX.azureMonitor}}var D=r(5340),N=r(3292);var I=r(8785),R=r(9580);function L(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function M(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){L(a,o,s,n,i,"next",e)}function i(e){L(a,o,s,n,i,"throw",e)}n(void 0)}))}}function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const $=["microsoft.aad/domainservices","microsoft.aadiam/azureadmetrics","microsoft.aadiam/tenants","microsoft.agfoodplatform/farmbeats","microsoft.analysisservices/servers","microsoft.apimanagement/service","microsoft.app/managedenvironments","microsoft.appconfiguration/configurationstores","microsoft.appplatform/spring","microsoft.attestation/attestationproviders","microsoft.automation/automationaccounts","microsoft.autonomousdevelopmentplatform/accounts","microsoft.autonomousdevelopmentplatform/datapools","microsoft.autonomousdevelopmentplatform/workspaces","microsoft.avs/privateclouds","microsoft.azuredatatransfer/connections/flows","microsoft.azureplaywrightservice/accounts","microsoft.azuresphere/catalogs","microsoft.azurestackresourcemonitor/storageaccountmonitor","microsoft.batch/batchaccounts","microsoft.batchai/workspaces","microsoft.blockchain/blockchainmembers","microsoft.blockchain/cordamembers","microsoft.botservice/botservices","microsoft.cache/redis","microsoft.cache/redisenterprise","microsoft.cache/redisenterprise/databases","microsoft.cdn/cdnwebapplicationfirewallpolicies","microsoft.cdn/profiles","microsoft.cdn/profiles/endpoints","microsoft.chaos/experiments","microsoft.classiccompute/domainnames","microsoft.classiccompute/virtualmachines","microsoft.classicnetwork/networksecuritygroups","microsoft.classicstorage/storageaccounts","microsoft.codesigning/codesigningaccounts","microsoft.cognitiveservices/accounts","microsoft.communication/communicationservices","microsoft.community/communitytrainings","microsoft.compute/disks","microsoft.compute/virtualmachines","microsoft.compute/virtualmachinescalesets","microsoft.confidentialledger/managedccf","microsoft.confidentialledger/managedccfs","microsoft.connectedcache/cachenodes","microsoft.connectedcache/enterprisemcccustomers","microsoft.connectedcache/ispcustomers","microsoft.connectedvehicle/platformaccounts","microsoft.containerinstance/containergroups","microsoft.containerregistry/registries","microsoft.containerservice/fleets","microsoft.containerservice/managedclusters","microsoft.customerinsights/hubs","microsoft.customproviders/resourceproviders","microsoft.d365customerinsights/instances","microsoft.dashboard/grafana","microsoft.databoxedge/databoxedgedevices","microsoft.databricks/workspaces","microsoft.datacollaboration/workspaces","microsoft.datafactory/datafactories","microsoft.datafactory/factories","microsoft.datalakeanalytics/accounts","microsoft.datalakestore/accounts","microsoft.dataprotection/backupvaults","microsoft.datashare/accounts","microsoft.dbformariadb/servers","microsoft.dbformysql/flexibleservers","microsoft.dbformysql/servers","microsoft.dbforpostgresql/flexibleservers","microsoft.dbforpostgresql/servergroupsv2","microsoft.dbforpostgresql/servers","microsoft.dbforpostgresql/serversv2","microsoft.desktopvirtualization/appattachpackages","microsoft.desktopvirtualization/applicationgroups","microsoft.desktopvirtualization/hostpools","microsoft.desktopvirtualization/scalingplans","microsoft.desktopvirtualization/workspaces","microsoft.devcenter/devcenters","microsoft.devices/elasticpools/iothubtenants","microsoft.devices/iothubs","microsoft.devices/provisioningservices","microsoft.devopsinfrastructure/pools","microsoft.digitaltwins/digitaltwinsinstances","microsoft.documentdb/cassandraclusters","microsoft.documentdb/databaseaccounts","microsoft.documentdb/mongoclusters","microsoft.eventgrid/domains","microsoft.eventgrid/namespaces","microsoft.eventgrid/partnernamespaces","microsoft.eventgrid/partnertopics","microsoft.eventgrid/systemtopics","microsoft.eventgrid/topics","microsoft.eventhub/clusters","microsoft.eventhub/namespaces","microsoft.experimentation/experimentworkspaces","microsoft.fabric.admin/fabriclocations","microsoft.hardwaresecuritymodules/cloudhsmclusters","microsoft.hdinsight/clusters","microsoft.healthcareapis/services","microsoft.healthcareapis/workspaces/dicomservices","microsoft.healthcareapis/workspaces/fhirservices","microsoft.healthcareapis/workspaces/iotconnectors","microsoft.healthdataaiservices/deidservices","microsoft.insights/autoscalesettings","microsoft.insights/components","microsoft.insights/datacollectionrules","microsoft.insights/qos","microsoft.iotcentral/iotapps","microsoft.keyvault/managedhsms","microsoft.keyvault/vaults","microsoft.kubernetes/connectedclusters","microsoft.kusto/clusters","microsoft.loadtestservice/loadtests","microsoft.logic/integrationaccounts","microsoft.logic/integrationserviceenvironments","microsoft.logic/workflows","microsoft.machinelearningservices/registries","microsoft.machinelearningservices/workspaces","microsoft.machinelearningservices/workspaces/onlineendpoints","microsoft.managednetworkfabric/networkdevices","microsoft.media/mediaservices","microsoft.media/mediaservices/liveevents","microsoft.media/mediaservices/streamingendpoints","microsoft.media/videoanalyzers","microsoft.monitor/accounts","microsoft.netapp/netappaccounts/capacitypools","microsoft.netapp/netappaccounts/capacitypools/volumes","microsoft.network/applicationgateways","microsoft.network/azurefirewalls","microsoft.network/bastionhosts","microsoft.network/connections","microsoft.network/dnsresolverpolicies","microsoft.network/dnszones","microsoft.network/expressroutecircuits","microsoft.network/expressroutegateways","microsoft.network/expressrouteports","microsoft.network/frontdoors","microsoft.network/loadbalancers","microsoft.network/natgateways","microsoft.network/networkinterfaces","microsoft.network/networkmanagers","microsoft.network/networkmanagers/ipampools","microsoft.network/networksecuritygroups","microsoft.network/networksecurityperimeters","microsoft.network/networksecurityperimeters/profiles","microsoft.network/networkvirtualappliances","microsoft.network/networkwatchers","microsoft.network/networkwatchers/connectionmonitors","microsoft.network/p2svpngateways","microsoft.network/privateendpoints","microsoft.network/privatelinkservices","microsoft.network/publicipaddresses","microsoft.network/publicipprefixes","microsoft.network/trafficmanagerprofiles","microsoft.network/virtualnetworkgateways","microsoft.network/virtualnetworks","microsoft.network/vpngateways","microsoft.networkanalytics/dataproducts","microsoft.networkcloud/baremetalmachines","microsoft.networkcloud/clustermanagers","microsoft.networkcloud/clusters","microsoft.networkcloud/storageappliances","microsoft.networkfunction/azuretrafficcollectors","microsoft.notificationhubs/namespaces","microsoft.notificationhubs/namespaces/notificationhubs","microsoft.openlogisticsplatform/workspaces","microsoft.operationalinsights/workspaces","microsoft.operationsmanagement/solutions","microsoft.peering/peeringservices","microsoft.playfab/titles","microsoft.powerbi/tenants","microsoft.powerbi/tenants/workspaces","microsoft.powerbidedicated/capacities","microsoft.providerhub/providerregistrations","microsoft.purview/accounts","microsoft.recoveryservices/vaults","microsoft.relay/namespaces","microsoft.resources/subscriptions","microsoft.resources/subscriptions/resourcegroups","microsoft.search/searchservices","microsoft.security/antimalwaresettings","microsoft.security/defenderforstoragesettings","microsoft.securityinsights/settings","microsoft.servicebus/namespaces","microsoft.servicenetworking/trafficcontrollers","microsoft.signalrservice/signalr","microsoft.signalrservice/signalr/replicas","microsoft.signalrservice/webpubsub","microsoft.signalrservice/webpubsub/replicas","microsoft.singularity/accounts","microsoft.sql/managedinstances","microsoft.sql/managedinstances/databases","microsoft.sql/servers/databases","microsoft.sql/servers/elasticpools","microsoft.storage/storageaccounts","microsoft.storage/storageaccounts/blobservices","microsoft.storage/storageaccounts/fileservices","microsoft.storage/storageaccounts/queueservices","microsoft.storage/storageaccounts/tableservices","microsoft.storagecache/amlfilesystems","microsoft.storagecache/caches","microsoft.storagemover/storagemovers","microsoft.storagesync/storagesyncservices","microsoft.streamanalytics/streamingjobs","microsoft.synapse/workspaces","microsoft.synapse/workspaces/bigdatapools","microsoft.synapse/workspaces/kustopools","microsoft.synapse/workspaces/scopepools","microsoft.synapse/workspaces/sqlpools","microsoft.timeseriesinsights/environments","microsoft.timeseriesinsights/environments/eventsources","microsoft.videoindexer/accounts","microsoft.vmwarecloudsimple/virtualmachines","microsoft.web/hostingenvironments","microsoft.web/hostingenvironments/workerpools","microsoft.web/serverfarms","microsoft.web/sites","microsoft.web/sites/slots","microsoft.web/staticsites","microsoft.workloads/sapvirtualinstances"].map((e=>`"${e}"`)).join(",");class G extends c.DataSourceWithBackend{fetchInitialRows(e,t,r){return M((function*(){try{const o=yield this.getSubscriptions(r);if(!t)return o;let s=o;const a=t.map((t=>()=>M((function*(){if(t.subscription){const r=`/subscriptions/${t.subscription}/resourceGroups/${t.resourceGroup}`;if(t.resourceGroup&&!(0,R.uv)(s,r)){const r=yield this.getResourceGroupsBySubscriptionId(t.subscription,e);s=(0,R.pU)(s,`/subscriptions/${t.subscription}`,r)}const o=(0,R.zj)(t);if(t.resourceName&&!(0,R.uv)(s,o)){const t=yield this.getResourcesForResourceGroup(r,e);s=(0,R.pU)(s,r,t)}}})).call(this)));for(const e of a)yield e();return s}catch(e){if(e instanceof Error){if("No subscriptions were found"!==e.message)throw e;if(r)return[]}throw e}})).call(this)}fetchAndAppendNestedRow(e,t,r,o){return M((function*(){const s=t.type===I.X.Subscription?yield this.getResourceGroupsBySubscriptionId(t.id,r,o):yield this.getResourcesForResourceGroup(t.uri,r,o);return(0,R.pU)(e,t.uri,s)})).call(this)}getSubscriptions(e){return M((function*(){const t=yield this.azureResourceGraphDatasource.getSubscriptions(e);if(!t.length)throw new Error("No subscriptions were found");return t.map((e=>({name:e.subscriptionName,id:e.subscriptionId,uri:`/subscriptions/${e.subscriptionId}`,typeLabel:"Subscription",type:I.X.Subscription,children:[]})))})).call(this)}getResourceGroupsBySubscriptionId(e,t,r){return M((function*(){const o=yield this.filterByType(t);return(yield this.azureResourceGraphDatasource.getResourceGroups(e,o,r)).map((e=>{const t=(0,R.U4)(e.resourceGroupURI);if(!t||!t.resourceGroup)throw new Error("unable to fetch resource groups");return{name:e.resourceGroupName,uri:e.resourceGroupURI,id:t.resourceGroup,type:I.X.ResourceGroup,typeLabel:"Resource Group",children:[]}}))})).call(this)}getResourcesForResourceGroup(e,t,r){return M((function*(){return(yield this.azureResourceGraphDatasource.getResourceNames({uri:e},yield this.filterByType(t),r)).map((e=>({name:e.name,id:e.name,uri:e.id,resourceGroupName:e.resourceGroup,type:I.X.Resource,typeLabel:D.De[e.type]||e.type,locationDisplayName:e.location,location:e.location})))})).call(this)}getResourceURIDisplayProperties(e){return M((function*(){var t;const{subscription:r,resourceGroup:o,resourceName:s}=null!==(t=(0,R.oU)(e))&&void 0!==t?t:{};if(!r)throw new Error("Invalid resource URI passed");const a=`/subscriptions/${r}`,n=`\n    resourcecontainers\n    | where type == "microsoft.resources/subscriptions"\n    | where id =~ "${a}"\n    | project subscriptionName=name, subscriptionId\n\n    | join kind=leftouter (\n      resourcecontainers            \n            | where type == "microsoft.resources/subscriptions/resourcegroups"\n            | where id =~ "${`${a}/resourceGroups/${o}`}"\n            | project resourceGroupName=name, resourceGroup, subscriptionId\n        ) on subscriptionId\n\n        | join kind=leftouter (\n          resources\n            | where id =~ "${e}"\n            | project resourceName=name, subscriptionId\n        ) on subscriptionId\n\n        | project subscriptionName, resourceGroupName, resourceName\n    `,i=yield this.azureResourceGraphDatasource.pagedResourceGraphRequest(n);if(!i.length)throw new Error("unable to fetch resource details");const{subscriptionName:c,resourceGroupName:l,resourceName:u}=i[0];return{subscription:c||r,resourceGroup:l||o,resourceName:u||s}})).call(this)}getResourceURIFromWorkspace(e){return M((function*(){const t=yield this.azureResourceGraphDatasource.pagedResourceGraphRequest(`\n      resources\n      | where properties['customerId'] == "${e}"\n      | project id\n    `);if(!t.length)throw new Error("unable to find resource for workspace "+e);return t[0].id})).call(this)}fetchAllNamespaces(){return M((function*(){const e=yield this.getSubscriptions();(0,c.reportInteraction)("grafana_ds_azuremonitor_subscriptions_loaded",{subscriptions:e.length});let t=new Set;D.AU.forEach((e=>{t.add(`"${e}"`)}));const r=r=>M((function*(){const o=yield this.azureMonitorDatasource.getMetricNamespaces({resourceUri:`/subscriptions/${e[0].id}`},!1,r);if(o)for(const e of o)t.add(`"${e.value.toLocaleLowerCase()}"`)})).call(this),o=["westeurope","eastus","japaneast"].map((e=>r(e)));if(yield Promise.all(o),0===t.size)throw new Error("Unable to resolve a list of valid metric namespaces. Validate the datasource configuration is correct and required permissions have been granted for all subscriptions. Grafana requires at least the Reader role to be assigned.");this.supportedMetricNamespaces=Array.from(t).join(",")})).call(this)}parseRows(e){const t=(0,R._Z)(e),r=[];return t.forEach(((e,t)=>{var o;let s=e.resourceName,a=e.resourceName,n=I.X.Resource;var i,c,l;s||(s=e.resourceGroup,a=e.resourceGroup,n=I.X.ResourceGroup,s||(s=e.subscription,a=e.subscription,n=I.X.Subscription)),r.push({id:null!=s?s:"",name:null!=a?a:"",type:n,uri:(0,R.zj)(e),typeLabel:null!==(l=null!==(c=D.De[null!==(i=null===(o=e.metricNamespace)||void 0===o?void 0:o.toLowerCase())&&void 0!==i?i:""])&&void 0!==c?c:e.metricNamespace)&&void 0!==l?l:"",location:e.region})})),r}constructor(e,t,r){var o;super(e),q(o=this,"resultLimit",200),q(o,"azureMonitorDatasource",void 0),q(o,"azureResourceGraphDatasource",void 0),q(o,"supportedMetricNamespaces",""),q(o,"search",((e,t,r)=>M((function*(){let s="resources";"logs"===t&&(s+="\n      | union resourcecontainers");const a=F(r);s+=`\n        | where id contains "${e}"\n        ${yield o.filterByType(t)}\n        ${a}\n        | order by tolower(name) asc\n        | limit ${o.resultLimit}\n      `;return(yield o.azureResourceGraphDatasource.pagedResourceGraphRequest(s)).map((e=>{const t=(0,R.U4)(e.id);if(!t||!(t.resourceName||t.resourceGroup||t.subscription))throw new Error("unable to fetch resource details");var r;let o=null!==(r=t.subscription)&&void 0!==r?r:"",s=I.X.Subscription;return t.resourceName?(o=t.resourceName,s=I.X.Resource):t.resourceGroup&&(o=t.resourceGroup,s=I.X.ResourceGroup),{name:e.name,id:o,uri:e.id,resourceGroupName:e.resourceGroup,type:s,typeLabel:D.De[e.type]||e.type,location:e.location}}))}))())),q(o,"filterByType",(e=>M((function*(){return""===o.supportedMetricNamespaces&&"logs"!==e&&(yield o.fetchAllNamespaces()),"logs"===e?`| where type in (${$})`:`| where type in (${o.supportedMetricNamespaces})`}))())),o.azureMonitorDatasource=t,o.azureResourceGraphDatasource=r}}const F=e=>{let t="";return e&&(e.subscriptions&&e.subscriptions.length>0&&(t+=`| where subscriptionId in (${e.subscriptions.map((e=>`"${e.toLowerCase()}"`)).join(",")})\n`),e.types&&e.types.length>0&&(t+=`| where type in (${e.types.map((e=>`"${e.toLowerCase()}"`)).join(",")})\n`),e.locations&&e.locations.length>0&&(t+=`| where location in (${e.locations.map((e=>`"${e.toLowerCase()}"`)).join(",")})\n`)),t};function _(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){_(a,o,s,n,i,"next",e)}function i(e){_(a,o,s,n,i,"throw",e)}n(void 0)}))}}function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){B(e,t,r[t])}))}return e}function U(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class X extends c.DataSourceWithBackend{filterQuery(e){var t;return!!(null===(t=e.azureResourceGraph)||void 0===t?void 0:t.query)&&(e.azureResourceGraph.scope===N.pG.Directory||!!e.subscriptions&&e.subscriptions.length>0)}applyTemplateVariables(e,t){const r=(0,c.getTemplateSrv)(),s=e.azureResourceGraph;if(!s)return e;const a=r.getVariables().map((e=>`$${e.name}`)),n=(0,o.find)(e.subscriptions,(e=>(0,o.includes)(a,e))),i=[...r.replace(n,t,(e=>e)).split(",").filter((e=>e.length>0)),...(0,o.filter)(e.subscriptions,(e=>!(0,o.includes)(a,e)))],l=r.replace(s.query,t,p.sf);return U(Q({},e),{queryType:d.o.AzureResourceGraph,subscriptions:i,azureResourceGraph:{resultFormat:"table",query:l,scope:s.scope}})}pagedResourceGraphRequest(e,t=1){return V((function*(){try{let t,r=!1,o=[];for(;!r;){let s={};t&&(s={$skipToken:t});const a=yield this.postResource(this.resourcePath+this.resourceGraphURL,{query:e,options:Q({resultFormat:"objectArray"},s)});o=o.concat(a.data),t=a.$skipToken,r=!t}return o}catch(r){if(t>0)return this.pagedResourceGraphRequest(e,t-1);throw r}})).call(this)}getSubscriptions(e){return V((function*(){const t=`\n        resources\n        | join kind=inner (\n                  ResourceContainers\n                    | where type == 'microsoft.resources/subscriptions'\n                    | project subscriptionName=name, subscriptionURI=id, subscriptionId\n                  ) on subscriptionId\n        ${e?F(e):""}\n        | summarize count=count() by subscriptionName, subscriptionURI, subscriptionId\n        | order by subscriptionName desc\n      `;return yield this.pagedResourceGraphRequest(t,1)})).call(this)}getResourceGroups(e,t,r){return V((function*(){const o=r?F(U(Q({},r),{subscriptions:[e]})):"",s=`resources \n    ${t||""}\n    | where subscriptionId == '${e}'\n    ${o}\n    | extend resourceGroupURI = strcat("/subscriptions/", subscriptionId, "/resourcegroups/", resourceGroup) \n    | join kind=leftouter (resourcecontainers  \n        | where type =~ 'microsoft.resources/subscriptions/resourcegroups'  \n        | project resourceGroupName=name, resourceGroupURI=tolower(id)) on resourceGroupURI \n    | project resourceGroupName=iff(resourceGroupName != "", resourceGroupName, resourceGroup), resourceGroupURI\n    | summarize count=count() by resourceGroupName, resourceGroupURI\n    | order by tolower(resourceGroupName) asc `;return yield this.pagedResourceGraphRequest(s)})).call(this)}getResourceNames(e,t,r){return V((function*(){const s=(0,p.GV)(this.templateSrv,e).map((({metricNamespace:e,subscriptionId:s,resourceGroup:a,region:n,uri:i})=>V((function*(){const c=(0,o.startsWith)(null==e?void 0:e.toLowerCase(),"microsoft.storage/storageaccounts/")?"microsoft.storage/storageaccounts":e;let l=i;l||(s&&(l=`/subscriptions/${s}`),a&&(l+=`/resourceGroups/${a}`));const u=[];c&&u.push(`type == '${c.toLowerCase()}'`),n&&u.push(`location == '${n}'`);const d=r?F(r):"",p=`resources${t?"\n"+t:""}\n        | where id hasprefix "${l}/"${""!==d?`\n${d}`:""}\n        ${u.length>0?`| where ${u.join(" and ")}`:""}\n        | order by tolower(name) asc`;return yield this.pagedResourceGraphRequest(p)})).call(this)));return(yield Promise.all(s)).flat()})).call(this)}getMetricNamespaces(e){return V((function*(){const t=(0,p.GV)(this.templateSrv,{resourceUri:e}).map((({resourceUri:e})=>V((function*(){const t=D.AU.map((e=>`"${e}"`)).join(","),r=`\n        resources\n        | where id hasprefix "${e}"\n        | where type in (${t})\n        | project type\n        | distinct type\n        | order by tolower(type) asc`;return(yield this.pagedResourceGraphRequest(r)).map((e=>({text:e.type,value:e.type})))})).call(this)));return(yield Promise.all(t)).flat()})).call(this)}constructor(e,t=(0,c.getTemplateSrv)()){super(e),B(this,"templateSrv",void 0),B(this,"resourcePath",void 0),B(this,"resourceGraphURL",void 0),this.templateSrv=t,this.resourceGraphURL="/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01",this.resourcePath=p.yX.resourceGraph}}function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){W(e,t,r[t])}))}return e}function K(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function J(e){var t,r,o;const s="string"==typeof e.rawQuery?e.rawQuery:null,a="string"==typeof e.workspace?e.workspace:null;if(!s||!a||(null===(r=e.target)||void 0===r||null===(t=r.azureLogAnalytics)||void 0===t?void 0:t.query))return e;var n,i;const c=K(H({},null!==(n=e.target)&&void 0!==n?n:{}),{refId:null!==(i=null===(o=e.target)||void 0===o?void 0:o.refId)&&void 0!==i?i:"Anno",queryType:d.o.LogAnalytics,azureLogAnalytics:{query:s,resources:[a]}});return K(H({},e),{rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:c})}var Z=r(9728),Y=r(5959),ee=r(3789),te=r(1874),re=r(2007),oe=r(6344);function se(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function ae(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){se(a,o,s,n,i,"next",e)}function i(e){se(a,o,s,n,i,"throw",e)}n(void 0)}))}}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ie=e=>({subscriptions:e.match(/^Subscriptions\(\)/i),resourceGroups:e.match(/^ResourceGroups\(\)/i),resourceGroupsWithSub:e.match(/^ResourceGroups\(([^\)]+?)(,\s?([^,]+?))?\)/i),namespaces:e.match(/^Namespaces\(([^\)]+?)(,\s?([^,]+?))?\)/i),namespacesWithSub:e.match(/^Namespaces\(([^,]+?),\s?([^,]+?)\)/i),resourceNames:e.match(/^ResourceNames\(([^,]+?),\s?([^,]+?)\)/i),resourceNamesWithSub:e.match(/^ResourceNames\(([^,]+?),\s?([^,]+?),\s?(.+?)\)/i),metricNamespace:e.match(/^MetricNamespace\(([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/i),metricNamespaceWithSub:e.match(/^metricnamespace\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/i),metricNames:e.match(/^MetricNames\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/i),metricNamesWithSub:e.match(/^MetricNames\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?(.+?)\)/i),appInsightsMetricNameQuery:e.match(/^AppInsightsMetricNames\(\)/i),appInsightsGroupByQuery:e.match(/^AppInsightsGroupBys\(([^\)]+?)(,\s?([^,]+?))?\)/i),workspacesQuery:e.match(/^workspaces\(\)/i),workspacesQueryWithSub:e.match(/^workspaces\(["']?([^\)]+?)["']?\)/i)}),ce=e=>{const{queryType:t,grafanaTemplateVariableFn:r}=e;if(t!==d.o.GrafanaTemplateVariableFn||!r)return e;const o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){ne(e,t,r[t])}))}return e}({},e);switch("subscription"in r&&(o.subscription=r.subscription),"resourceGroup"in r&&(o.resourceGroup=r.resourceGroup),"metricNamespace"in r&&(o.namespace=r.metricNamespace),"resourceName"in r&&(o.resource=r.resourceName),r.kind){case"SubscriptionsQuery":o.queryType=d.o.SubscriptionsQuery;break;case"ResourceGroupsQuery":o.queryType=d.o.ResourceGroupsQuery;break;case"ResourceNamesQuery":o.queryType=d.o.ResourceNamesQuery;break;case"MetricNamespaceQuery":case"MetricDefinitionsQuery":o.queryType=d.o.NamespacesQuery;break;case"MetricNamesQuery":o.queryType=d.o.MetricNamesQuery;break;case"WorkspacesQuery":o.queryType=d.o.WorkspacesQuery}return o},le=(e,t)=>ae((function*(){return"string"!=typeof e?e:(e=>{const t=ie(e);return Object.keys(t).some((e=>!!t[e]))})(e)?((e,t)=>{const r=ie(e),o=t.azureMonitorDatasource.defaultSubscriptionId;return{refId:"A",queryType:d.o.GrafanaTemplateVariableFn,grafanaTemplateVariableFn:r.appInsightsMetricNameQuery?{rawQuery:e,kind:"AppInsightsMetricNameQuery"}:r.appInsightsGroupByQuery?{kind:"AppInsightsGroupByQuery",rawQuery:e,metricName:r.appInsightsGroupByQuery[1]}:r.subscriptions?{kind:"SubscriptionsQuery",rawQuery:e}:r.resourceGroupsWithSub?{kind:"ResourceGroupsQuery",rawQuery:e,subscription:r.resourceGroupsWithSub[1]}:r.resourceGroups&&o?{kind:"ResourceGroupsQuery",rawQuery:e,subscription:o}:r.namespacesWithSub?{kind:"MetricNamespaceQuery",rawQuery:e,subscription:r.namespacesWithSub[1],resourceGroup:r.namespacesWithSub[2]}:r.namespaces&&o?{kind:"MetricNamespaceQuery",rawQuery:e,subscription:o,resourceGroup:r.namespaces[1]}:r.resourceNamesWithSub?{kind:"ResourceNamesQuery",rawQuery:e,subscription:r.resourceNamesWithSub[1],resourceGroup:r.resourceNamesWithSub[2],metricNamespace:r.resourceNamesWithSub[3]}:r.resourceNames&&o?{kind:"ResourceNamesQuery",rawQuery:e,subscription:o,resourceGroup:r.resourceNames[1],metricNamespace:r.resourceNames[2]}:r.metricNamespaceWithSub?{kind:"MetricNamespaceQuery",rawQuery:e,subscription:r.metricNamespaceWithSub[1],resourceGroup:r.metricNamespaceWithSub[2],metricNamespace:r.metricNamespaceWithSub[3],resourceName:r.metricNamespaceWithSub[4]}:r.metricNamespace&&o?{kind:"MetricNamespaceQuery",rawQuery:e,subscription:o,resourceGroup:r.metricNamespace[1],metricNamespace:r.metricNamespace[2],resourceName:r.metricNamespace[3]}:r.metricNames&&o&&-1===r.metricNames[3].indexOf(",")?{kind:"MetricNamesQuery",rawQuery:e,subscription:o,resourceGroup:r.metricNames[1],metricNamespace:r.metricNames[2],resourceName:r.metricNames[3]}:r.metricNamesWithSub?{kind:"MetricNamesQuery",rawQuery:e,subscription:r.metricNamesWithSub[1],resourceGroup:r.metricNamesWithSub[2],metricNamespace:r.metricNamesWithSub[3],resourceName:r.metricNamesWithSub[4]}:r.workspacesQueryWithSub?{kind:"WorkspacesQuery",rawQuery:e,subscription:(r.workspacesQueryWithSub[1]||"").trim()}:r.workspacesQuery&&o?{kind:"WorkspacesQuery",rawQuery:e,subscription:o}:{kind:"SubscriptionsQuery",rawQuery:e},subscription:o}})(e,t.datasource):((e,t)=>ae((function*(){const r=t.azureMonitorDatasource.defaultSubscriptionId;let o="";if(e){const e=t.azureLogAnalyticsDatasource.getDeprecatedDefaultWorkSpace();o=e?(0,R.wr)(e)?yield t.resourcePickerData.getResourceURIFromWorkspace(e):e:(yield t.azureLogAnalyticsDatasource.getFirstWorkspace())||""}return{refId:"A",queryType:d.o.LogAnalytics,azureLogAnalytics:{query:e,resources:o?[o]:[]},subscription:r}}))())(e,t.datasource)}))(),ue=(e,t)=>ae((function*(){let r=yield le(e,t);return r.queryType===d.o.GrafanaTemplateVariableFn&&(r=ce(r)),r}))();var de=r(8495),pe=r(8840),me=r(2356);function fe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function be(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const he=({query:e,updateQuery:t,datasource:r})=>{var o;const[s,a]=(0,Y.useState)("");(0,Y.useEffect)((()=>{var t;a((null===(t=e.grafanaTemplateVariableFn)||void 0===t?void 0:t.rawQuery)||"")}),[null===(o=e.grafanaTemplateVariableFn)||void 0===o?void 0:o.rawQuery]);const n=(0,Y.useCallback)((o=>{le(o,{datasource:r}).then((r=>{r.queryType===d.o.GrafanaTemplateVariableFn?t(r):t(be(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){fe(e,t,r[t])}))}return e}({},e),{grafanaTemplateVariableFn:{kind:"UnknownQuery",rawQuery:o}}))}))}),[r,e,t]);return(0,Z.jsx)(re.InlineField,{label:(0,te.t)("components.grafana-template-variable-fn-input.label-grafana-template-variable","Grafana template variable function"),children:(0,Z.jsx)(re.Input,{placeholder:(0,te.t)("components.grafana-template-variable-fn-input.placeholder-grafana-template-variable","Type a grafana template variable function, e.g. {{example}}",{example:"Subscriptions()"}),value:s,onChange:e=>{a(e.target.value)},onBlur:()=>n(s)})})};function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){ge(e,t,r[t])}))}return e}function ye(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const we={label:"-",value:""},Oe=e=>{const{query:t,onChange:r,datasource:s}=e,a=[{label:"Subscriptions",value:d.o.SubscriptionsQuery},{label:"Resource Groups",value:d.o.ResourceGroupsQuery},{label:"Namespaces",value:d.o.NamespacesQuery},{label:"Regions",value:d.o.LocationsQuery},{label:"Resource Names",value:d.o.ResourceNamesQuery},{label:"Metric Names",value:d.o.MetricNamesQuery},{label:"Workspaces",value:d.o.WorkspacesQuery},{label:"Resource Graph",value:d.o.AzureResourceGraph},{label:"Logs",value:d.o.LogAnalytics},{label:"Custom Namespaces",value:d.o.CustomNamespacesQuery},{label:"Custom Metric Names",value:d.o.CustomMetricNamesQuery}];"object"==typeof e.query&&e.query.queryType===d.o.GrafanaTemplateVariableFn&&a.push({label:"Grafana Query Function",value:d.o.GrafanaTemplateVariableFn});const[n,i]=(0,Y.useState)({label:"Template Variables",options:[]}),[l,u]=(0,Y.useState)(!1),[p,m]=(0,Y.useState)(!1),[f,b]=(0,Y.useState)(!1),[h,g]=(0,Y.useState)(!1),[v,y]=(0,Y.useState)(!1),[w,O]=(0,Y.useState)(!1),[j,S]=(0,Y.useState)(!1),[k,A]=(0,Y.useState)(!1),[P,E]=(0,Y.useState)([]),[z,C]=(0,Y.useState)([]),[T,D]=(0,Y.useState)([]),[N,I]=(0,Y.useState)([]),[L,M]=(0,Y.useState)([]),[q,$]=(0,Y.useState)([]),[G,F]=(0,de.A)(),_="string"==typeof t?"":t.queryType;(0,Y.useEffect)((()=>{ue(t,{datasource:s}).then((e=>{(0,o.isEqual)(t,e)||r(e)}))}),[t,s,r]),(0,Y.useEffect)((()=>{switch(u(!1),m(!1),b(!1),y(!1),O(!1),A(!1),S(!1),_){case d.o.ResourceGroupsQuery:case d.o.WorkspacesQuery:u(!0);break;case d.o.NamespacesQuery:u(!0),m(!0);break;case d.o.ResourceNamesQuery:u(!0),m(!0),b(!0),g(!0);break;case d.o.MetricNamesQuery:u(!0),y(!0),O(!0),A(!0);break;case d.o.LocationsQuery:u(!0);break;case d.o.CustomNamespacesQuery:u(!0),y(!0),O(!0),A(!0);break;case d.o.CustomMetricNamesQuery:u(!0),y(!0),A(!0),O(!0),S(!0)}}),[_]),(0,Y.useEffect)((()=>{const e=[];s.getVariablesRaw().forEach((t=>{(0,o.get)(t,"query.queryType")!==_&&e.push({label:t.label||t.name,value:`$${t.name}`})})),i({label:"Template Variables",options:e})}),[s,_]),(0,ee.A)((()=>{s.getSubscriptions().then((e=>{E(e.map((e=>({label:e.text,value:e.value}))))}))}));const V="object"==typeof t&&t.subscription;(0,Y.useEffect)((()=>{V&&s.getResourceGroups(V).then((e=>{C(e.map((e=>({label:e.resourceGroupName,value:e.resourceGroupName}))))}))}),[s,V]);const B="object"==typeof t&&t.resourceGroup||"";(0,Y.useEffect)((()=>{V&&B&&s.getMetricNamespaces(V,B,void 0,!1,!0).then((e=>{D(e.map((e=>({label:e.text,value:e.value}))))}))}),[s,V,B]),(0,Y.useEffect)((()=>{V&&s.azureMonitorDatasource.getLocations([V]).then((e=>{const t=[];e.forEach((e=>t.push({label:e.displayName,value:e.name}))),$(t)}))}),[s,V,B]);const Q="object"==typeof t&&t.namespace||"";(0,Y.useEffect)((()=>{V&&B&&Q&&s.getResourceNames(V,B,Q).then((e=>{M(e.map((e=>{const t=(0,R.U4)(e.id);return{label:e.name,value:t.resourceName}})))}))}),[s,V,B,Q]);const U="object"==typeof t&&t.resource||"";if((0,Y.useEffect)((()=>{if(V&&B&&Q&&U){const e=x.A.buildResourceUri((0,c.getTemplateSrv)(),{subscription:V,resourceGroup:B,metricNamespace:Q,resourceName:U});s.getMetricNamespaces(V,B,e,!0).then((e=>{I(e.map((e=>({label:e.text,value:e.value}))))}))}}),[s,V,B,Q,U]),"string"==typeof t)return null;const X=e=>{r(e)};var W;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(re.Field,{label:(0,te.t)("components.variable-editor.label-query-type","Query Type"),"data-testid":oe.T.components.variableEditor.queryType.input,children:(0,Z.jsx)(re.Select,{"aria-label":(0,te.t)("components.variable-editor.aria-label-select-query-type","Select query type"),onChange:e=>{e.value&&r(ye(ve({},t),{queryType:e.value,subscription:void 0,resourceGroup:void 0,namespace:void 0,resource:void 0}))},options:a,width:25,value:_})}),t.queryType===d.o.LogAnalytics&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(me.A,{subscriptionId:t.subscription,query:t,datasource:s,onChange:X,onQueryChange:X,variableOptionGroup:n,setError:F,hideFormatAs:!0,basicLogsEnabled:null!==(W=s.azureMonitorDatasource.basicLogsEnabled)&&void 0!==W&&W}),G&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(re.Space,{v:2}),(0,Z.jsx)(re.Alert,{severity:"error",title:(0,te.t)("components.variable-editor.title-error-occurred","An error occurred while requesting metadata from Azure Monitor"),children:G instanceof Error?G.message:G})]})]}),t.queryType===d.o.GrafanaTemplateVariableFn&&(0,Z.jsx)(he,{query:t,updateQuery:e.onChange,datasource:s}),l&&(0,Z.jsx)(re.Field,{label:(0,te.t)("components.variable-editor.label-subscription","Subscription"),"data-testid":oe.T.components.variableEditor.subscription.input,children:(0,Z.jsx)(re.Select,{"aria-label":(0,te.t)("components.variable-editor.aria-label-select-subscription","Select subscription"),onChange:e=>{e.value&&r(ye(ve({},t),{subscription:e.value,resourceGroup:void 0,namespace:void 0,resource:void 0}))},options:P.concat(n),width:25,value:t.subscription||null})}),(v||p)&&(0,Z.jsx)(re.Field,{label:(0,te.t)("components.variable-editor.label-resource-group","Resource Group"),"data-testid":oe.T.components.variableEditor.resourceGroup.input,children:(0,Z.jsx)(re.Select,{"aria-label":(0,te.t)("components.variable-editor.aria-label-select-resource-group","Select resource group"),onChange:e=>{r(ye(ve({},t),{resourceGroup:e.value,namespace:void 0,resource:void 0}))},options:v?z.concat(n):z.concat(n,we),width:25,value:t.resourceGroup||null,placeholder:v?void 0:(0,te.t)("components.variable-editor.placeholder-resource-group","Optional")})}),(w||f)&&(0,Z.jsx)(re.Field,{label:_===d.o.CustomNamespacesQuery||_===d.o.CustomMetricNamesQuery?(0,te.t)("components.variable-editor.label-resource-type","Resource Type"):(0,te.t)("components.variable-editor.label-namespace","Namespace"),"data-testid":oe.T.components.variableEditor.namespace.input,children:(0,Z.jsx)(re.Select,{"aria-label":(0,te.t)("components.variable-editor.aria-label-select-namespace","Select namespace"),onChange:e=>{r(ye(ve({},t),{namespace:e.value,resource:void 0}))},options:w?T.concat(n):T.concat(n,we),width:25,value:t.namespace||null,placeholder:w?void 0:(0,te.t)("components.variable-editor.placeholder-namespace","Optional")})}),h&&(0,Z.jsx)(re.Field,{label:(0,te.t)("components.variable-editor.label-region","Region"),"data-testid":oe.T.components.variableEditor.region.input,children:(0,Z.jsx)(re.Select,{"aria-label":(0,te.t)("components.variable-editor.aria-label-select-region","Select region"),onChange:e=>{r(ye(ve({},t),{region:e.value}))},options:q.concat(n),width:25,value:t.region||null,placeholder:(0,te.t)("components.variable-editor.placeholder-region","Optional")})}),k&&(0,Z.jsx)(re.Field,{label:(0,te.t)("components.variable-editor.label-resource","Resource"),"data-testid":oe.T.components.variableEditor.resource.input,children:(0,Z.jsx)(re.Select,{"aria-label":(0,te.t)("components.variable-editor.aria-label-select-resource","Select resource"),onChange:e=>{r(ye(ve({},t),{resource:e.value}))},options:L.concat(n),width:25,value:t.resource||null})}),j&&(0,Z.jsx)(re.Field,{label:(0,te.t)("components.variable-editor.label-custom-namespace","Custom Namespace"),"data-testid":oe.T.components.variableEditor.customNamespace.input,children:(0,Z.jsx)(re.Select,{"aria-label":(0,te.t)("components.variable-editor.aria-label-select-custom-namespace","Select custom namespace"),onChange:e=>{r(ye(ve({},t),{customNamespace:e.value}))},options:j?N.concat(n):N.concat(n,we),width:25,value:t.customNamespace||null,placeholder:j?void 0:(0,te.t)("components.variable-editor.placeholder-custom-namespace","Optional")})}),t.queryType===d.o.AzureResourceGraph&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(pe.A,{subscriptionId:s.azureLogAnalyticsDatasource.defaultSubscriptionId,query:t,datasource:s,onChange:X,variableOptionGroup:n,setError:F}),G&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(re.Space,{v:2}),(0,Z.jsx)(re.Alert,{severity:"error",title:(0,te.t)("components.variable-editor.title-error-occurred","An error occurred while requesting metadata from Azure Monitor"),children:G instanceof Error?G.message:G})]})]})]})};var je=r(6063);function Se(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function xe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ke(e,t){return e.map((e=>(0,o.startsWith)(null==t?void 0:t.toLowerCase(),"microsoft.storage/storageaccounts/")?{text:e.name+"/default",value:e.name+"/default"}:{text:e.name,value:(0,R.U4)(e.id).resourceName}))}class Ae extends i.CustomVariableSupport{hasValue(...e){return e.every((e=>!!this.templateSrv.replace(e)))}query(e){return(0,s.from)((()=>{return(t=function*(){const t=yield ue(e.targets[0],{datasource:this.datasource});try{switch(t.queryType){case d.o.SubscriptionsQuery:const r=yield this.datasource.getSubscriptions();return{data:(null==r?void 0:r.length)?[(0,i.toDataFrame)(r)]:[]};case d.o.ResourceGroupsQuery:if(t.subscription&&this.hasValue(t.subscription)){const e=yield this.datasource.getResourceGroups(t.subscription);return{data:(null==e?void 0:e.length)?[(0,i.toDataFrame)(e)]:[]}}return{data:[]};case d.o.NamespacesQuery:if(t.subscription&&this.hasValue(t.subscription)){const e=yield this.datasource.getMetricNamespaces(t.subscription,t.resourceGroup,void 0,!1,!0);return{data:(null==e?void 0:e.length)?[(0,i.toDataFrame)(e)]:[]}}return{data:[]};case d.o.ResourceNamesQuery:if(t.subscription&&this.hasValue(t.subscription)){const e=yield this.datasource.getResourceNames(t.subscription,t.resourceGroup,t.namespace,t.region);return{data:(null==e?void 0:e.length)?[(0,i.toDataFrame)(ke(e))]:[]}}return{data:[]};case d.o.MetricNamesQuery:if(t.subscription&&t.resourceGroup&&t.namespace&&t.resource&&this.hasValue(t.subscription,t.resourceGroup,t.namespace,t.resource)){const e=yield this.datasource.getMetricNames(t.subscription,t.resourceGroup,t.namespace,t.resource);return{data:(null==e?void 0:e.length)?[(0,i.toDataFrame)(e)]:[]}}return{data:[]};case d.o.WorkspacesQuery:if(t.subscription&&this.hasValue(t.subscription)){const e=yield this.datasource.getAzureLogAnalyticsWorkspaces(t.subscription);return{data:(null==e?void 0:e.length)?[(0,i.toDataFrame)(e)]:[]}}return{data:[]};case d.o.GrafanaTemplateVariableFn:if(t.grafanaTemplateVariableFn){const e=yield this.callGrafanaTemplateVariableFn(t.grafanaTemplateVariableFn);return{data:(null==e?void 0:e.length)?[(0,i.toDataFrame)(e)]:[]}}return{data:[]};case d.o.LocationsQuery:if(t.subscription&&this.hasValue(t.subscription)){const e=yield this.datasource.azureMonitorDatasource.getLocations([t.subscription]),r=[];return e.forEach((e=>{r.push({text:e.displayName,value:e.name})})),{data:(null==r?void 0:r.length)?[(0,i.toDataFrame)(r)]:[]}}case d.o.CustomNamespacesQuery:if(t.subscription&&t.resourceGroup&&t.namespace&&t.resource&&this.hasValue(t.subscription,t.resourceGroup,t.namespace,t.resource)){const e=x.A.buildResourceUri(this.templateSrv,{subscription:t.subscription,resourceGroup:t.resourceGroup,metricNamespace:t.namespace,resourceName:t.resource}),r=yield this.datasource.getMetricNamespaces(t.subscription,t.resourceGroup,e,!0);return{data:(null==r?void 0:r.length)?[(0,i.toDataFrame)(r)]:[]}}return{data:[]};case d.o.CustomMetricNamesQuery:if(t.subscription&&t.resourceGroup&&t.namespace&&t.resource&&t.customNamespace&&this.hasValue(t.subscription,t.resourceGroup,t.namespace,t.resource,t.customNamespace)){const e=yield this.datasource.getMetricNames(t.subscription,t.resourceGroup,t.namespace,t.resource,t.customNamespace);return{data:(null==e?void 0:e.length)?[(0,i.toDataFrame)(e)]:[]}}return{data:[]};default:e.targets[0]=t;const o=yield(0,s.lastValueFrom)(this.datasource.query(e));return{data:o.data,error:o.error?new Error((0,je.A)(o.error)):void 0}}}catch(e){return{data:[],error:new Error((0,je.A)(e))}}},function(){var e=this,r=arguments;return new Promise((function(o,s){var a=t.apply(e,r);function n(e){Se(a,o,s,n,i,"next",e)}function i(e){Se(a,o,s,n,i,"throw",e)}n(void 0)}))}).call(this);var t})())}callGrafanaTemplateVariableFn(e){return"SubscriptionsQuery"===e.kind?this.datasource.getSubscriptions():"ResourceGroupsQuery"===e.kind?this.datasource.getResourceGroups(this.replaceVariable(e.subscription)).then((e=>e.length>0?e.map((e=>({text:e.resourceGroupName,value:e.resourceGroupName}))):[])):"ResourceNamesQuery"===e.kind?this.datasource.getResourceNames(this.replaceVariable(e.subscription),this.replaceVariable(e.resourceGroup),this.replaceVariable(e.metricNamespace)).then((t=>t.length>0?ke(t,e.metricNamespace):[])):"MetricNamespaceQuery"===e.kind?this.datasource.azureMonitorDatasource.getMetricNamespaces(e,!0):"MetricNamesQuery"===e.kind?this.datasource.azureMonitorDatasource.getMetricNames(e):"WorkspacesQuery"===e.kind?this.datasource.azureLogAnalyticsDatasource.getWorkspaces(this.replaceVariable(e.subscription)):null}replaceVariable(e){return this.templateSrv.replace((e||"").trim())}constructor(e,t=(0,c.getTemplateSrv)()){super(),xe(this,"datasource",void 0),xe(this,"templateSrv",void 0),xe(this,"editor",void 0),this.datasource=e,this.templateSrv=t,this.editor=Oe,this.datasource=e}}function Pe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){Pe(e,t,r[t])}))}return e}function ze(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class Ce extends c.DataSourceWithBackend{filterQuery(e){var t;if(!e.queryType)return!1;const r=(0,S.A)(e),o=this.pseudoDatasource[e.queryType];var s;return null===(s=null==o||null===(t=o.filterQuery)||void 0===t?void 0:t.call(o,r))||void 0===s||s}query(e){const t=new Map;for(const r of e.targets){const s=(0,S.A)(r);if(!s.queryType||s.hide||!Te(s))continue;if(!t.has(s.queryType)){const r=(0,o.cloneDeep)(e);r.requestId=`${r.requestId}-${s.refId}`,r.targets=[],t.set(s.queryType,r)}const a=t.get(s.queryType);null==a||a.targets.push(s)}const r=Array.from(t.entries()).map((([e,t])=>{let r=e;e!==d.o.AzureTraces&&e!==d.o.TraceExemplar||(r=d.o.LogAnalytics);const o=this.pseudoDatasource[r];if(!o)throw new Error("Data source not created for query type "+e);return o.query(t)}));return 1===r.length?r[0]:r.length>1?(0,s.forkJoin)(r).pipe((0,a.map)((e=>{const t=[];for(const r of e)for(const e of r.data)t.push(e);return{state:i.LoadingState.Done,data:t}}))):(0,s.of)({state:i.LoadingState.Done,data:[]})}targetContainsTemplate(e){if(e.subscription&&this.templateSrv.containsTemplate(e.subscription))return!0;let t;return e.queryType===d.o.AzureMonitor?t=JSON.stringify(e.azureMonitor):e.queryType===d.o.LogAnalytics?t=JSON.stringify(e.azureLogAnalytics):e.queryType===d.o.AzureResourceGraph&&(t=JSON.stringify([e.azureResourceGraph,e.subscriptions])),!!t&&this.templateSrv.containsTemplate(t)}getMetricNamespaces(e,t,r,o,s){let a=`/subscriptions/${e}`;return t&&(a+=`/resourceGroups/${t}`),r&&(a=r),s?this.azureResourceGraphDatasource.getMetricNamespaces(a):this.azureMonitorDatasource.getMetricNamespaces({resourceUri:a},!o,void 0,o)}getMetricNames(e,t,r,o,s){return this.azureMonitorDatasource.getMetricNames({subscription:e,resourceGroup:t,metricNamespace:r,resourceName:o,customNamespace:s})}getSubscriptions(){return this.azureMonitorDatasource.getSubscriptions()}getAzureLogAnalyticsWorkspaces(e){return this.azureLogAnalyticsDatasource.getWorkspaces(e)}getResourceGroups(e){return this.azureResourceGraphDatasource.getResourceGroups(this.templateSrv.replace(e))}getResourceNames(e,t,r,o){return this.azureResourceGraphDatasource.getResourceNames({subscriptionId:e,resourceGroup:t,metricNamespace:r,region:o})}getLocations(e){return this.azureMonitorDatasource.getLocations(e)}interpolateVariablesInQueries(e,t){return e.map((e=>{if(!e.queryType)return e;const r=e.queryType===d.o.AzureTraces?d.o.LogAnalytics:e.queryType,o=this.pseudoDatasource[r];var s;return Ee({datasource:null==o?void 0:o.getRef()},null!==(s=null==o?void 0:o.applyTemplateVariables(e,t))&&void 0!==s?s:e)}))}getVariables(){return this.templateSrv.getVariables().map((e=>`$${e.name}`))}getVariablesRaw(){return this.templateSrv.getVariables()}modifyQuery(e,t){var r;if(!t.options)return e;let o=null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.query;if(void 0===o)return e;switch(t.type){case"ADD_FILTER":o+=`\n| where ${t.options.key} == "${t.options.value}"`;break;case"ADD_FILTER_OUT":o+=`\n| where ${t.options.key} != "${t.options.value}"`}return ze(Ee({},e),{azureLogAnalytics:ze(Ee({},e.azureLogAnalytics),{query:o})})}getDefaultSubscriptionId(){return this.defaultSubscriptionId||""}constructor(e,t=(0,c.getTemplateSrv)()){super(e),Pe(this,"templateSrv",void 0),Pe(this,"annotations",void 0),Pe(this,"azureMonitorDatasource",void 0),Pe(this,"azureLogAnalyticsDatasource",void 0),Pe(this,"resourcePickerData",void 0),Pe(this,"azureResourceGraphDatasource",void 0),Pe(this,"currentUserAuth",void 0),Pe(this,"currentUserAuthFallbackAvailable",void 0),Pe(this,"defaultSubscriptionId",void 0),Pe(this,"pseudoDatasource",void 0),this.templateSrv=t,this.annotations={prepareAnnotation:J},this.pseudoDatasource={},this.azureMonitorDatasource=new T(e),this.azureResourceGraphDatasource=new X(e),this.azureLogAnalyticsDatasource=new w(e),this.resourcePickerData=new G(e,this.azureMonitorDatasource,this.azureResourceGraphDatasource),this.pseudoDatasource={[d.o.AzureMonitor]:this.azureMonitorDatasource,[d.o.LogAnalytics]:this.azureLogAnalyticsDatasource,[d.o.AzureResourceGraph]:this.azureResourceGraphDatasource,[d.o.AzureTraces]:this.azureLogAnalyticsDatasource},this.variables=new Ae(this);const r=e.jsonData.azureCredentials;r&&(0,n.Hc)("currentuser",r)?(this.currentUserAuth=!0,r.serviceCredentials?this.currentUserAuthFallbackAvailable=(0,n.wo)(r.serviceCredentials,!0):this.currentUserAuthFallbackAvailable=!1):(this.currentUserAuth="currentuser"===e.jsonData.azureAuthType,this.currentUserAuthFallbackAvailable=!1),this.defaultSubscriptionId=e.jsonData.subscriptionId}}function Te(e){switch(e.queryType){case d.o.AzureMonitor:return!!e.azureMonitor;case d.o.LogAnalytics:return!!e.azureLogAnalytics;case d.o.AzureResourceGraph:return!!e.azureResourceGraph;case d.o.AzureTraces:case d.o.TraceExemplar:return!!e.azureTraces;case d.o.GrafanaTemplateVariableFn:return!!e.grafanaTemplateVariableFn;default:return!1}}},1034:(e,t,r)=>{"use strict";const o=r(4708);e.exports=(e,t)=>new o(e,t).major},1064:e=>{"use strict";const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},1173:(e,t,r)=>{"use strict";const o=r(7565);e.exports=(e,t)=>e.sort(((e,r)=>o(r,e,t)))},1269:e=>{"use strict";e.exports=c},1308:t=>{"use strict";t.exports=e},1409:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t,r)=>0===o(e,t,r)},1427:(e,t,r)=>{"use strict";r.d(t,{Tc:()=>s,iy:()=>o});var o=function(e){return e.Analytics="Analytics",e.Basic="Basic",e}({});function s(e){return!!e&&e.hasOwnProperty("error")}},1490:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var o=r(9728),s=r(5959),a=r(3789),n=r(1874),i=r(2007),c=r(6344),l=r(7809);const u=({query:e,variableOptionGroup:t,onQueryChange:r,inputId:u,options:d,defaultValue:p,onLoad:m,setFormatAs:f,resultFormat:b})=>{const h=(0,s.useMemo)((()=>[...d,t]),[t,d]),g=(0,s.useCallback)((t=>{const{value:o}=t;if(!o)return;const s=f(e,o);r(s)}),[r,e,f]);return(0,a.A)((()=>{d.find((e=>e.value===b))||g({value:p}),m(e,p,g)})),(0,o.jsx)(l.D,{label:(0,n.t)("components.format-as-field.label-format-as","Format as"),"data-testid":c.T.components.queryEditor.logsQueryEditor.formatSelection.input,children:(0,o.jsx)(i.Select,{inputId:`${u}-format-as-field`,value:b,onChange:g,options:h,width:20})})}},1874:(e,t,r)=>{"use strict";r.d(t,{x6:()=>ce,wR:()=>se,t:()=>ie});var o=r(9728),s=r(211),a=r.n(s);const{slice:n,forEach:i}=[];let c=!1;try{document.cookie,c=!0}catch(e){}const l=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];c||l.splice(1,1);var u=r(5959),d=r(627),p=r.n(d),m=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function f(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},r=e.match(/<\/?([^\s]+?)[/\s>]/);if(r&&(t.name=r[1],(p()[r[1]]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){var o=e.indexOf("--\x3e");return{type:"comment",comment:-1!==o?e.slice(4,o):""}}for(var s=new RegExp(m),a=null;null!==(a=s.exec(e));)if(a[0].trim())if(a[1]){var n=a[1].trim(),i=[n,""];n.indexOf("=")>-1&&(i=n.split("=")),t.attrs[i[0]]=i[1],s.lastIndex--}else a[2]&&(t.attrs[a[2]]=a[3].trim().substring(1,a[3].length-1));return t}var b=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,h=/^\s*$/,g=Object.create(null);function v(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var r in e)t.push(r+'="'+e[r]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(v,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}var y={parse:function(e,t){t||(t={}),t.components||(t.components=g);var r,o=[],s=[],a=-1,n=!1;if(0!==e.indexOf("<")){var i=e.indexOf("<");o.push({type:"text",content:-1===i?e:e.substring(0,i)})}return e.replace(b,(function(i,c){if(n){if(i!=="</"+r.name+">")return;n=!1}var l,u="/"!==i.charAt(1),d=i.startsWith("\x3c!--"),p=c+i.length,m=e.charAt(p);if(d){var b=f(i);return a<0?(o.push(b),o):((l=s[a]).children.push(b),o)}if(u&&(a++,"tag"===(r=f(i)).type&&t.components[r.name]&&(r.type="component",n=!0),r.voidElement||n||!m||"<"===m||r.children.push({type:"text",content:e.slice(p,e.indexOf("<",p))}),0===a&&o.push(r),(l=s[a-1])&&l.children.push(r),s[a]=r),(!u||r.voidElement)&&(a>-1&&(r.voidElement||r.name===i.slice(2,-1))&&(a--,r=-1===a?o:s[a]),!n&&"<"!==m&&m)){l=-1===a?o:s[a].children;var g=e.indexOf("<",p),v=e.slice(p,-1===g?void 0:g);h.test(v)&&(v=" "),(g>-1&&a+l.length>=0||" "!==v)&&l.push({type:"text",content:v})}})),o},stringify:function(e){return e.reduce((function(e,t){return e+v("",t)}),"")}};const w=y,O=(e,t,r,o)=>{const s=[r,{code:t,...o||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(s,"warn","react-i18next::",!0);x(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...s):console?.warn&&console.warn(...s)},j={},S=(e,t,r,o)=>{x(r)&&j[r]||(x(r)&&(j[r]=new Date),O(e,t,r,o))},x=e=>"string"==typeof e,k=e=>"object"==typeof e&&null!==e,A=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,P={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},E=e=>P[e];let z={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(A,E)};const C=(e={})=>{z={...z,...e}},T=()=>z;let D;const N=e=>{D=e},I=()=>D,R=(e,t)=>{if(!e)return!1;const r=e.props?.children??e.children;return t?r.length>0:!!r},L=e=>{if(!e)return[];const t=e.props?.children??e.children;return e.props?.i18nIsDynamicList?M(t):t},M=e=>Array.isArray(e)?e:[e],q=(e,t,r,o)=>{if(!e)return"";let s="";const a=M(e),n=t?.transSupportBasicHtmlNodes?t.transKeepBasicHtmlNodesFor??[]:[];return a.forEach(((e,a)=>{if(x(e))s+=`${e}`;else if((0,u.isValidElement)(e)){const{props:i,type:c}=e,l=Object.keys(i).length,u=n.indexOf(c)>-1,d=i.children;if(!d&&u&&!l)return void(s+=`<${c}/>`);if(!d&&(!u||l)||i.i18nIsDynamicList)return void(s+=`<${a}></${a}>`);if(u&&1===l&&x(d))return void(s+=`<${c}>${d}</${c}>`);const p=q(d,t,r,o);s+=`<${a}>${p}</${a}>`}else if(null!==e)if(k(e)){const{format:t,...a}=e,n=Object.keys(a);if(1===n.length){const e=t?`${n[0]}, ${t}`:n[0];return void(s+=`{{${e}}}`)}O(r,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:o,child:e})}else O(r,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:o,child:e});else O(r,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:o})})),s},$=(e,t,r,o,s,a,n)=>{if(""===r)return[];const i=s.transKeepBasicHtmlNodesFor||[],c=r&&new RegExp(i.map((e=>`<${e}`)).join("|")).test(r);if(!(e||t||c||n))return[r];const l=t??{},d=e=>{M(e).forEach((e=>{x(e)||(R(e)?d(L(e)):k(e)&&!(0,u.isValidElement)(e)&&Object.assign(l,e))}))};d(e);const p=w.parse(`<0>${r}</0>`),m={...l,...a},f=(e,t,r)=>{const o=L(e),s=h(o,t.children,r);return(e=>Array.isArray(e)&&e.every(u.isValidElement))(o)&&0===s.length||e.props?.i18nIsDynamicList?o:s},b=(e,t,r,o,s)=>{e.dummy?(e.children=t,r.push((0,u.cloneElement)(e,{key:o},s?void 0:t))):r.push(...u.Children.map([e],(e=>{const r={...e.props};return delete r.i18nIsDynamicList,(0,u.createElement)(e.type,{...r,key:o,ref:e.props.ref??e.ref},s?null:t)})))},h=(e,r,a)=>{const l=M(e);return M(r).reduce(((e,r,d)=>{const p=r.children?.[0]?.content&&o.services.interpolator.interpolate(r.children[0].content,m,o.language);if("tag"===r.type){let n=l[parseInt(r.name,10)];!n&&t&&(n=t[r.name]),1!==a.length||n||(n=a[0][r.name]),n||(n={});const g=0!==Object.keys(r.attrs).length?((e,t)=>{const r={...t};return r.props=Object.assign(e.props,t.props),r})({props:r.attrs},n):n,v=(0,u.isValidElement)(g),y=v&&R(r,!0)&&!r.voidElement,w=c&&k(g)&&g.dummy&&!v,O=k(t)&&Object.hasOwnProperty.call(t,r.name);if(x(g)){const t=o.services.interpolator.interpolate(g,m,o.language);e.push(t)}else if(R(g)||y){const t=f(g,r,a);b(g,t,e,d)}else if(w){const t=h(l,r.children,a);b(g,t,e,d)}else if(Number.isNaN(parseFloat(r.name)))if(O){const t=f(g,r,a);b(g,t,e,d,r.voidElement)}else if(s.transSupportBasicHtmlNodes&&i.indexOf(r.name)>-1)if(r.voidElement)e.push((0,u.createElement)(r.name,{key:`${r.name}-${d}`}));else{const t=h(l,r.children,a);e.push((0,u.createElement)(r.name,{key:`${r.name}-${d}`},t))}else if(r.voidElement)e.push(`<${r.name} />`);else{const t=h(l,r.children,a);e.push(`<${r.name}>${t}</${r.name}>`)}else if(k(g)&&!v){const t=r.children[0]?p:null;t&&e.push(t)}else b(g,p,e,d,1!==r.children.length||!p)}else if("text"===r.type){const t=s.transWrapTextNodes,a=n?s.unescape(o.services.interpolator.interpolate(r.content,m,o.language)):o.services.interpolator.interpolate(r.content,m,o.language);t?e.push((0,u.createElement)(t,{key:`${r.name}-${d}`},a)):e.push(a)}return e}),[])},g=h([{dummy:!0,children:e||[]}],p,M(e||[]));return L(g[0])},G=(e,t,r)=>{const o=e.key||t,s=(0,u.cloneElement)(e,{key:o});if(!s.props||!s.props.children||r.indexOf(`${t}/>`)<0&&r.indexOf(`${t} />`)<0)return s;return(0,u.createElement)((function(){return(0,u.createElement)(u.Fragment,null,s)}),{key:o})},F=(e,t,r,o)=>e?Array.isArray(e)?((e,t)=>e.map(((e,r)=>G(e,r,t))))(e,t):k(e)?((e,t)=>{const r={};return Object.keys(e).forEach((o=>{Object.assign(r,{[o]:G(e[o],o,t)})})),r})(e,t):(S(r,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:o}),null):null,_=e=>!!k(e)&&(!Array.isArray(e)&&Object.keys(e).reduce(((e,t)=>e&&Number.isNaN(Number.parseFloat(t))),!0));const V={type:"3rdParty",init(e){C(e.options.react),N(e)}},B=(0,u.createContext)();function Q({children:e,count:t,parent:r,i18nKey:o,context:s,tOptions:a={},values:n,defaults:i,components:c,ns:l,i18n:d,t:p,shouldUnescape:m,...f}){const{i18n:b,defaultNS:h}=(0,u.useContext)(B)||{},g=d||b||I(),v=p||g?.t.bind(g);return function({children:e,count:t,parent:r,i18nKey:o,context:s,tOptions:a={},values:n,defaults:i,components:c,ns:l,i18n:d,t:p,shouldUnescape:m,...f}){const b=d||I();if(!b)return S(b,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:o}),e;const h=p||b.t.bind(b)||(e=>e),g={...T(),...b.options?.react};let v=l||h.ns||b.options?.defaultNS;v=x(v)?[v]:v||["translation"];const y=q(e,g,b,o),w=i||y||g.transEmptyNodeValue||o,{hashTransKey:O}=g,j=o||(O?O(y||w):y||w);b.options?.interpolation?.defaultVariables&&(n=n&&Object.keys(n).length>0?{...n,...b.options.interpolation.defaultVariables}:{...b.options.interpolation.defaultVariables});const k=n||void 0!==t&&!b.options?.interpolation?.alwaysFormat||!e?a.interpolation:{interpolation:{...a.interpolation,prefix:"#$?",suffix:"?$#"}},A={...a,context:s||a.context,count:t,...n,...k,defaultValue:w,ns:v},P=j?h(j,A):w,E=F(c,P,b,o);let z=E||e,C=null;_(E)&&(C=E,z=e);const D=$(z,C,P,b,g,A,m),N=r??g.defaultTransParent;return N?(0,u.createElement)(N,f,D):D}({children:e,count:t,parent:r,i18nKey:o,context:s,tOptions:a,values:n,defaults:i,components:c,ns:l||v?.ns||h||g?.options?.defaultNS,i18n:g,t:p,shouldUnescape:m,...f})}const U="en-US",X=U,W="pseudo";function H(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function K(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){H(a,o,s,n,i,"next",e)}function i(e){H(a,o,s,n,i,"throw",e)}n(void 0)}))}}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){J(e,t,r[t])}))}return e}let Y,ee;function te({id:e,ns:t}={}){if(e)return Y=ae().getFixedT(null,e),void(ee=t=>(0,o.jsx)(Q,Z({shouldUnescape:!0,ns:e},t)));Y=ae().t,ee=e=>(0,o.jsx)(Q,Z({shouldUnescape:!0,ns:t},e))}function re(e,t,r){return K((function*(){if(!(null==r?void 0:r.length))return;const o=t===W?X:t;return Promise.all(r.map((t=>K((function*(){try{const r=yield t(o);!function(e,t,r){ae().addResourceBundle(e,t,r,!0,!1)}(o,e,r)}catch(t){console.error(`Error loading resources for namespace ${e} and language: ${o}`,t)}}))())))}))()}function oe(){var e;if((null===(e=ae().options)||void 0===e?void 0:e.resources)&&"object"==typeof ae().options.resources)return;const t=ae().use(V).init({resources:{},returnEmptyString:!1,lng:X});return te(),t}function se(e,t){return K((function*(){yield oe(),function(){var e,t;if(null===(t=I())||void 0===t||null===(e=t.options)||void 0===e?void 0:e.react)return;C({}),N(ae())}();const r=ne();return te({id:e}),yield re(e,r,t),{language:r}}))()}function ae(){const e=a();return e&&e.default?e.default:e}function ne(){var e;return(null===(e=ae())||void 0===e?void 0:e.resolvedLanguage)||X}const ie=(e,t,r)=>(oe(),Y||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),Y=ae().t),Y(e,t,r));function ce(e){oe();const t=null!=ee?ee:Q;return(0,o.jsx)(t,Z({shouldUnescape:!0},e))}},2007:e=>{"use strict";e.exports=n},2008:(e,t,r)=>{"use strict";const o=r(2839),s=r(9264),{ANY:a}=s,n=r(3238),i=r(3440),c=[new s(">=0.0.0-0")],l=[new s(">=0.0.0")],u=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===a){if(1===t.length&&t[0].semver===a)return!0;e=r.includePrerelease?c:l}if(1===t.length&&t[0].semver===a){if(r.includePrerelease)return!0;t=l}const o=new Set;let s,u,m,f,b,h,g;for(const t of e)">"===t.operator||">="===t.operator?s=d(s,t,r):"<"===t.operator||"<="===t.operator?u=p(u,t,r):o.add(t.semver);if(o.size>1)return null;if(s&&u){if(m=i(s.semver,u.semver,r),m>0)return null;if(0===m&&(">="!==s.operator||"<="!==u.operator))return null}for(const e of o){if(s&&!n(e,String(s),r))return null;if(u&&!n(e,String(u),r))return null;for(const o of t)if(!n(e,String(o),r))return!1;return!0}let v=!(!u||r.includePrerelease||!u.semver.prerelease.length)&&u.semver,y=!(!s||r.includePrerelease||!s.semver.prerelease.length)&&s.semver;v&&1===v.prerelease.length&&"<"===u.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(g=g||">"===e.operator||">="===e.operator,h=h||"<"===e.operator||"<="===e.operator,s)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(f=d(s,e,r),f===e&&f!==s)return!1}else if(">="===s.operator&&!n(s.semver,String(e),r))return!1;if(u)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(b=p(u,e,r),b===e&&b!==u)return!1}else if("<="===u.operator&&!n(u.semver,String(e),r))return!1;if(!e.operator&&(u||s)&&0!==m)return!1}return!(s&&h&&!u&&0!==m)&&(!(u&&g&&!s&&0!==m)&&(!y&&!v))},d=(e,t,r)=>{if(!e)return t;const o=i(e.semver,t.semver,r);return o>0?e:o<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,r)=>{if(!e)return t;const o=i(e.semver,t.semver,r);return o<0?e:o>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new o(e,r),t=new o(t,r);let s=!1;e:for(const o of e.set){for(const e of t.set){const t=u(o,e,r);if(s=s||null!==t,t)continue e}if(s)return!1}return!0}},2074:e=>{"use strict";const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},2083:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t,r)=>o(e,t,r)<0},2098:(e,t,r)=>{"use strict";r.d(t,{p:()=>a,y:()=>n});var o=r(9688),s=r(8531);function a(e){const t=(0,o.Gg)(e);return t||(function(e){try{if("clientsecret"===e.jsonData.azureAuthType||!e.jsonData.azureAuthType&&e.jsonData.tenantId&&e.jsonData.clientId)return{authType:"clientsecret",tenantId:e.jsonData.tenantId,clientId:e.jsonData.clientId,azureCloud:(0,o.Wp)(e.jsonData.cloudName)||(0,o.kZ)(),clientSecret:(0,o.qs)(e)};if(!e.jsonData.azureAuthType)return;return{authType:e.jsonData.azureAuthType}}catch(e){return void(e instanceof Error&&console.error("Unable to restore legacy credentials: %s",e.message))}}(e)||(s.config.azure.managedIdentityEnabled?{authType:"msi"}:s.config.azure.workloadIdentityEnabled?{authType:"workloadidentity"}:{authType:"clientsecret",azureCloud:(0,o.kZ)()}))}function n(e,t){return(0,o.lk)(e,t)}},2356:(e,t,r)=>{"use strict";r.d(t,{A:()=>_e});var o=r(9728),s=r(5959),a=r(1874),n=r(3769),i=r(8442),c=r(8899),l=r(8531),u=r(2007),d=r(3292),p=r(6344),m=r(5098),f=r(4326),b=r(7088),h=r(6089);const g=({children:e})=>{const t=(0,u.useStyles2)(y),r=s.Children.map(e,(e=>(0,s.isValidElement)(e)&&e.props.invalid?(0,s.cloneElement)(e,{className:(0,h.cx)(e.props.className,t.invalidChild)}):e));return s.createElement("div",{className:t.root},r)},v=["","base","hovered","invalid","focused"],y=()=>({root:(0,h.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:v.indexOf("base"),"&:hover":{zIndex:v.indexOf("hovered")},"&:focus-within":{zIndex:v.indexOf("focused")}}}),invalidChild:(0,h.css)({zIndex:v.indexOf("invalid")})});var w=r(2827),O=r(3241);const j=20,S={columns:{columns:[],type:d.zu.Property},from:{type:d.zu.Property,property:{type:d.eg.String,name:""}},groupBy:{expressions:[],type:d.zu.Group_by},reduce:{expressions:[],type:d.zu.Reduce},where:{expressions:[],type:d.zu.And},limit:1e3},x={string:[{label:"==",value:"=="},{label:"!=",value:"!="},{label:"contains",value:"contains"},{label:"!contains",value:"!contains"},{label:"startswith",value:"startswith"},{label:"endswith",value:"endswith"}],int:[{label:"==",value:"=="},{label:"!=",value:"!="},{label:">",value:">"},{label:"<",value:"<"},{label:">=",value:">="},{label:"<=",value:"<="}],datetime:[{label:"before",value:"<"},{label:"after",value:">"},{label:"between",value:"between"}],bool:[{label:"==",value:"=="},{label:"!=",value:"!="}]},k=[{label:"sum",value:"sum"},{label:"avg",value:"avg"},{label:"percentile",value:"percentile"},{label:"count",value:"count"},{label:"min",value:"min"},{label:"max",value:"max"},{label:"dcount",value:"dcount"},{label:"stdev",value:"stdev"}];function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const P=({aggregate:e,onChange:t,onDelete:r,columns:n,templateVariableOptions:i})=>{var c,l,p,m,f,b,h,v,y;const O="percentile"===(null===(c=e.reduce)||void 0===c?void 0:c.name),S=null===(p=e.reduce)||void 0===p||null===(l=p.name)||void 0===l?void 0:l.includes("count"),[x,P]=(0,s.useState)((null===(f=e.parameters)||void 0===f||null===(m=f[0])||void 0===m?void 0:m.value)||""),[E,z]=(0,s.useState)(O?(null===(h=e.parameters)||void 0===h||null===(b=h[1])||void 0===b?void 0:b.value)||"":(null===(v=e.property)||void 0===v?void 0:v.name)||""),C=Array.isArray(i)?i:[i],T=n.concat(C),D=(e,t)=>[{type:d.zu.Function_parameter,fieldType:d.eg.Number,value:e},{type:d.zu.Function_parameter,fieldType:d.eg.String,value:t}],N=r=>{const o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){A(e,t,r[t])}))}return e}({},e,r);t(o)};return(0,o.jsxs)(g,{children:[(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.aggregate-item.aria-label-aggregate-function","Aggregate function"),width:j,value:(null===(y=e.reduce)||void 0===y?void 0:y.name)?{label:e.reduce.name,value:e.reduce.name}:null,options:k,onChange:e=>{return t=e.value,void N({reduce:{name:t||"",type:d.eg.Function}});var t}}),O?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Input,{type:"number",min:0,max:100,step:1,value:null!=x?x:"",width:j,onChange:e=>{const t=Number(e.currentTarget.value);!isNaN(t)&&t>=0&&t<=100&&(e=>{const t=e||"";P(t);const r=D(t,E);N({parameters:r})})(t.toString())}}),(0,o.jsx)(u.Label,{style:{margin:"9px 9px 0 9px"},children:(0,o.jsx)(a.x6,{i18nKey:"components.aggregate-item.label-percentile",children:"OF"})})]}):(0,o.jsx)(o.Fragment,{}),S?(0,o.jsx)(o.Fragment,{}):(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.aggregate-item.aria-label-column","Column"),width:j,value:E?{label:E,value:E}:null,options:T,onChange:e=>(e=>{const t=e||"";if(z(t),O){const e=D(x,t);N({parameters:e,property:{name:t,type:d.eg.String}})}else N({property:{name:t,type:d.eg.String}})})(e.value)}),(0,o.jsx)(w.Z,{"aria-label":(0,a.t)("components.aggregate-item.aria-label-remove","Remove"),icon:"times",variant:"secondary",onClick:r})]})},E=({query:e,allColumns:t,buildAndUpdateQuery:r,templateVariableOptions:n})=>{var l,u,d,p,m;const h=null===(l=e.azureLogAnalytics)||void 0===l?void 0:l.builderQuery,[g,v]=(0,s.useState)((null==h||null===(u=h.reduce)||void 0===u?void 0:u.expressions)||[]),y=(0,s.useRef)((null==h||null===(d=h.from)||void 0===d?void 0:d.property.name)||null),w=(0,s.useRef)(!1);(0,s.useEffect)((()=>{var e,t;const r=(null==h||null===(e=h.from)||void 0===e?void 0:e.property.name)||null;y.current===r&&0!==(null==h||null===(t=h.reduce)||void 0===t?void 0:t.expressions.length)||(v([]),w.current=!1,y.current=r)}),[h]);const O=(null==h||null===(m=h.columns)||void 0===m||null===(p=m.columns)||void 0===p?void 0:p.length)?h.columns.columns.map((e=>({label:e,value:e}))):t.map((e=>({label:e.name,value:e.name})));return(0,o.jsx)("div",{"data-testid":"aggregate-section",children:(0,o.jsx)(i.U,{children:(0,o.jsx)(c.B,{children:(0,o.jsx)(f.c,{label:(0,a.t)("components.aggregate-section.label-aggregate","Aggregate"),optional:!0,tooltip:(0,a.t)("components.aggregate-section.tooltip-aggregate","Perform calculations across rows of data, such as count, sum, average, minimum, maximum, standard deviation or percentiles."),children:(0,o.jsx)(b.o,{items:g,onChange:e=>{v(e),r({reduce:e})},renderItem:z(O,(e=>{v((t=>{const o=t.filter((t=>{var r,o,s,a;return(null===(r=t.property)||void 0===r?void 0:r.name)!==(null===(o=e.property)||void 0===o?void 0:o.name)||(null===(s=t.reduce)||void 0===s?void 0:s.name)!==(null===(a=e.reduce)||void 0===a?void 0:a.name)}));return r({reduce:0===o.length?[]:o}),o}))}),n)})})})})})};function z(e,t,r){return function(s,a){return(0,o.jsx)(P,{aggregate:s,onChange:a,onDelete:()=>t(s),columns:e,templateVariableOptions:r})}}const C=e=>{if("expressions"in e&&Array.isArray(e.expressions)){const t=e.expressions.every((e=>"operator"in e&&"property"in e)),r=e.expressions.map(C).filter((e=>Boolean(e)));if(0===r.length)return;const o=t?" or ":" and ",s=r.join(o);return r.length>1?`(${s})`:s}if((e=>{var t,r;return"operator"in e&&"property"in e&&"string"==typeof(null===(t=e.operator)||void 0===t?void 0:t.name)&&"string"==typeof(null===(r=e.property)||void 0===r?void 0:r.name)})(e)){const{name:t,value:r}=e.operator,{name:o}=e.property,s=String(r).replace(/'/g,"''");return"$__timeFilter"===t?`$__timeFilter(${o})`:`${o} ${t} '${s}'`}},T=e=>{var t;const{from:r,timeFilter:o,fuzzySearch:s,where:a}=e;if(!(null==r||null===(t=r.property)||void 0===t?void 0:t.name))return"";const n=[];return n.push(r.property.name),((e,t,r,o)=>{[t,r,o].forEach((t=>{null==t||t.expressions.forEach((t=>{const r=C(t);r&&e.push(`where ${r}`)}))}))})(n,o,s,a),((e,t)=>{var r;const o=(null===(r=e.columns)||void 0===r?void 0:r.columns)||[];o.length>0&&t.push(`project ${o.join(", ")}`)})(e,n),((e,t)=>{var r,o,s,a;if(t.some((e=>e.startsWith("summarize"))))return;const n=null!==(a=null===(r=e.reduce)||void 0===r?void 0:r.expressions)&&void 0!==a?a:[];var i;const c=null!==(i=null===(s=e.groupBy)||void 0===s||null===(o=s.expressions)||void 0===o?void 0:o.map((e=>{var t;return null===(t=e.property)||void 0===t?void 0:t.name})).filter(Boolean))&&void 0!==i?i:[],l=n.map((e=>{var t,r;if(!(null===(t=e.reduce)||void 0===t?void 0:t.name))return;const o=e.reduce.name;if("percentile"===o){var s,a,n,i,c;const t=null===(a=e.parameters)||void 0===a||null===(s=a[0])||void 0===s?void 0:s.value;var l,u;const r=null!==(u=null!==(l=null===(i=e.parameters)||void 0===i||null===(n=i[1])||void 0===n?void 0:n.value)&&void 0!==l?l:null===(c=e.property)||void 0===c?void 0:c.name)&&void 0!==u?u:"";return r?`percentile(${t}, ${r})`:null}var d;const p=null!==(d=null===(r=e.property)||void 0===r?void 0:r.name)&&void 0!==d?d:"";return"count"===o?"count()":p?`${o}(${p})`:o})).filter(Boolean);if(0===l.length&&0===c.length)return;const u=l.length>0?`summarize ${l.join(", ")}${c.length>0?` by ${c.join(", ")}`:""}`:`summarize by ${c.join(", ")}`;t.push(u)})(e,n),((e,t)=>{var r;const o=(null===(r=e.orderBy)||void 0===r?void 0:r.expressions)||[];if(!o.length)return;const s=o.map((e=>{var t;return`${null===(t=e.property)||void 0===t?void 0:t.name} ${e.order}`})).filter(Boolean);s.length>0&&t.push(`order by ${s.join(", ")}`)})(e,n),((e,t)=>{e.limit&&e.limit>0&&t.push(`limit ${e.limit}`)})(e,n),n.join("\n| ")};var D=r(1269),N=r(7781);const I=({filter:e,filterIndex:t,groupIndex:r,usedColumns:s,selectableOptions:n,onChange:i,onDelete:c,getFilterValues:l,showOr:d})=>{var p,m,f;return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.filter-item.aria-label-column","Column"),width:j,value:(f=e.property.name,{value:f,label:f.replace(new RegExp((0,O.escapeRegExp)('["`indexer`"]'),"g"),"[ ]")}),options:n.filter((e=>!s.includes(e.value))),onChange:e=>e.value&&i(r,"property",e.value,t)}),(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.filter-item.aria-label-operator","Operator"),width:12,value:{label:e.operator.name,value:e.operator.name},options:(m="string",x[m]||x.string),onChange:e=>e.value&&i(r,"operator",e.value,t)}),(0,o.jsx)(u.Combobox,{"aria-label":(0,a.t)("components.filter-item.aria-label-column-value","Column value"),value:e.operator.value?{label:String(e.operator.value),value:String(e.operator.value)}:null,options:t=>l(e,t),onChange:e=>e.value&&i(r,"value",String(e.value),t),width:j,disabled:!(null===(p=e.property)||void 0===p?void 0:p.name)}),(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.filter-item.aria-label-remove-filter","Remove filter"),variant:"secondary",icon:"times",onClick:()=>c(r,t)}),d&&(0,o.jsx)(u.Label,{style:{padding:"9px 14px"},children:(0,o.jsx)(a.x6,{i18nKey:"components.filter-item.label-or",children:"OR"})})]})};function R(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){L(e,t,r[t])}))}return e}function q(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const $=({buildAndUpdateQuery:e,query:t,allColumns:r,templateVariableOptions:n,datasource:l,timeRange:p})=>{var m,b,v,y,w,O;const j=(0,u.useStyles2)((()=>({filters:(0,h.css)({marginBottom:"8px"})}))),S=null===(m=t.azureLogAnalytics)||void 0===m?void 0:m.builderQuery,x=(0,s.useRef)((null==S||null===(b=S.from)||void 0===b?void 0:b.property.name)||null),[k,A]=(0,s.useState)((null==S||null===(y=S.where)||void 0===y||null===(v=y.expressions)||void 0===v?void 0:v.map((e=>{var t;return q(M({},e),{expressions:null!==(t=e.expressions)&&void 0!==t?t:[]})})))||[]),P=(0,s.useRef)(!1),E=Array.isArray(n)?n:[n],z=(null==S||null===(O=S.columns)||void 0===O||null===(w=O.columns)||void 0===w?void 0:w.length)?((e,t)=>e.filter((e=>t.some((t=>t.name===e&&"dynamic"!==t.type)))))(S.columns.columns,r).map((e=>({label:e,value:e}))):r.filter((e=>"dynamic"!==e.type)).map((e=>({label:e.name,value:e.name}))),C=[...z,...E];(0,s.useEffect)((()=>{var e,t;const r=(null==S||null===(e=S.from)||void 0===e?void 0:e.property.name)||null;x.current===r&&0!==(null==S||null===(t=S.where)||void 0===t?void 0:t.expressions.length)||(A([]),P.current=!1,x.current=r)}),[S]);const T=t=>{A(t),e({where:t})},L=(e,t,r,o)=>{const s=[...k],a=s[e];if(!a)return;let n=void 0!==o?M({},a.expressions[o]):{type:d.zu.Operator,property:{name:"",type:d.eg.String},operator:{name:"==",value:""}};"property"===t?(n.property.name=r,n.operator.value=""):"operator"===t?n.operator.name=r:"value"===t&&(n.operator.value=r);const i=n.property.name&&n.operator.name&&""!==n.operator.value;void 0!==o?a.expressions[o]=n:a.expressions.push(n),s[e]=a,A(s),i&&T(s)},$=()=>{const e=[...k,{type:d.zu.Or,expressions:[{type:d.zu.Operator,property:{name:"",type:d.eg.String},operator:{name:"==",value:""}}]}];T(e)},G=(e,t)=>{const r=[...k];r[e].expressions.splice(t,1),0===r[e].expressions.length&&r.splice(e,1),T(r)},F=e=>{return(r=function*(){var r,o,s,a,n,i,c;const u=null==p||null===(r=p.from)||void 0===r?void 0:r.toISOString(),m=null==p||null===(o=p.to)||void 0===o?void 0:o.toISOString(),f=(null===(s=t.azureLogAnalytics)||void 0===s?void 0:s.timeColumn)||"TimeGenerated",b=`\n    ${null===(i=t.azureLogAnalytics)||void 0===i||null===(n=i.builderQuery)||void 0===n||null===(a=n.from)||void 0===a?void 0:a.property.name}\n    | where ${f} >= datetime(${u}) and ${f} <= datetime(${m})\n    | distinct ${e.property.name}\n    | limit 1000\n  `;var h;const g=yield(0,D.lastValueFrom)(l.azureLogAnalyticsDatasource.query({requestId:"azure-logs-builder-filter-values",interval:"",intervalMs:0,scopedVars:{},timezone:"",app:N.CoreApp.Unknown,startTime:0,range:p||(0,N.getDefaultTimeRange)(),targets:[{refId:"A",queryType:d.oj.LogAnalytics,azureLogAnalytics:{query:b,resources:null!==(h=null===(c=t.azureLogAnalytics)||void 0===c?void 0:c.resources)&&void 0!==h?h:[]}}]}));var v,y,w,O,j;return"Done"===g.state?(null!==(j=null===(O=g.data)||void 0===O||null===(w=O[0])||void 0===w||null===(y=w.fields)||void 0===y||null===(v=y[0])||void 0===v?void 0:v.values)&&void 0!==j?j:[]).toArray().map((e=>({label:String(e),value:String(e)}))):[]},function(){var e=this,t=arguments;return new Promise((function(o,s){var a=r.apply(e,t);function n(e){R(a,o,s,n,i,"next",e)}function i(e){R(a,o,s,n,i,"throw",e)}n(void 0)}))})();var r};return(0,o.jsx)(i.U,{children:(0,o.jsx)(c.B,{children:(0,o.jsx)(f.c,{label:(0,a.t)("components.filter-section.label-filters","Filters"),optional:!0,tooltip:(0,a.t)("components.filter-section.tooltip-filters","Narrow results by applying conditions to specific columns."),children:(0,o.jsx)("div",{className:j.filters,children:0===k.length||k.every((e=>0===e.expressions.length))?(0,o.jsx)(g,{children:(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.filter-section.aria-label-add-filter","Add filter"),variant:"secondary",onClick:$,icon:"plus"})}):(0,o.jsxs)(o.Fragment,{children:[k.map(((e,t)=>{var r;return(0,o.jsxs)("div",{children:[t>0&&(null===(r=k[t-1])||void 0===r?void 0:r.expressions.length)>0&&(0,o.jsx)(u.Label,{style:{padding:"9px 14px"},children:(0,o.jsx)(a.x6,{i18nKey:"components.filter-section.label-and",children:"AND"})}),(0,o.jsxs)(g,{children:[(0,o.jsx)(o.Fragment,{children:e.expressions.map(((r,s)=>{return(0,o.jsx)(I,{filter:r,filterIndex:s,groupIndex:t,usedColumns:(a=t,k.flatMap(((e,t)=>t!==a?e.expressions:[])).map((e=>e.property.name)).filter(Boolean)),selectableOptions:C,onChange:L,onDelete:G,getFilterValues:F,showOr:s<e.expressions.length-1},`${t}-${s}`);var a}))}),(0,o.jsx)(u.Button,{tooltip:(0,a.t)("components.filter-section.aria-label-add-or-filter","Add OR filter"),variant:"secondary",style:{marginLeft:"15px"},onClick:()=>L(t,"property",""),icon:"plus"})]})]},t)})),k.some((e=>e.expressions.length>0))&&(0,o.jsx)(u.Button,{variant:"secondary",onClick:$,style:{marginTop:"8px"},children:(0,o.jsx)(a.x6,{i18nKey:"components.filter-section.label-add-group",children:"Add group"})})]})})})})})},G=({buildAndUpdateQuery:e,query:t,allColumns:r,templateVariableOptions:n})=>{var l,p;const m=null===(l=t.azureLogAnalytics)||void 0===l?void 0:l.builderQuery,b=(0,s.useRef)((null==m||null===(p=m.from)||void 0===p?void 0:p.property.name)||null),[h,v]=(0,s.useState)(""),[y,w]=(0,s.useState)(""),[O,j]=(0,s.useState)(!1),S=(0,s.useRef)(!1);(0,s.useEffect)((()=>{var e,t,r;const o=(null==m||null===(e=m.from)||void 0===e?void 0:e.property.name)||null;if(b.current!==o&&(v(""),w(""),j(!1),S.current=!1,b.current=o),!S.current&&(null==m||null===(r=m.fuzzySearch)||void 0===r||null===(t=r.expressions)||void 0===t?void 0:t.length)){var s,a;const e=m.fuzzySearch.expressions[0];var n,i;v((e=>{let t=String(e).trim();return t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t})(String(null!==(n=null===(s=e.expressions[0].operator)||void 0===s?void 0:s.value)&&void 0!==n?n:""))),w(null!==(i=null===(a=e.expressions[0].property)||void 0===a?void 0:a.name)&&void 0!==i?i:"*"),j(!0),S.current=!0}}),[m]);const x=[{label:"All Columns *",value:"*"},...r.map((e=>({label:e.name,value:e.name}))),...Array.isArray(n)?n:[n]],k=(t,r)=>{v(r),w(t);const o={type:d.zu.Operator,expressions:[{type:d.zu.Property,operator:{name:"has",value:r},property:{name:t||"*",type:d.eg.String}}]};e({fuzzySearch:r?[o]:[]})};return(0,o.jsx)(i.U,{children:(0,o.jsx)(c.B,{children:(0,o.jsx)(f.c,{label:(0,a.t)("components.fuzzy-search.label-fuzzy-search","Fuzzy Search"),optional:!0,tooltip:(0,a.t)("components.fuzzy-search.tooltip-fuzzy-search","Find approximate text matches with tolerance for spelling variations. By default, fuzzy search scans all columns (*) in the entire table, not just specific fields."),children:(0,o.jsx)(g,{children:O?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Input,{className:"width-10",type:"text",placeholder:(0,a.t)("components.fuzzy-search.placeholder-search-team","Enter search term"),value:h,onChange:e=>k(y,e.currentTarget.value)}),(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.fuzzy-search.aria-label-select-column","Select Column"),options:x,value:{label:y||"*",value:y||"*"},onChange:e=>{var t;return k(null!==(t=e.value)&&void 0!==t?t:"*",h)},width:"auto"}),(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.fuzzy-search.aria-label-remove-fuzzy-search","Remove fuzzy search"),variant:"secondary",icon:"times",onClick:()=>{v(""),w(""),j(!1),e({fuzzySearch:[]})}})]}):(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.fuzzy-search.aria-label-add-fuzzy-search","Add fuzzy search"),variant:"secondary",onClick:()=>j(!0),icon:"plus"})})})})})};function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const V=({groupBy:e,onChange:t,onDelete:r,columns:s,templateVariableOptions:n})=>{var i;const c=[...s.length>0?s.map((e=>({label:e.label,value:e.value}))):[{label:"No columns available",value:""}],...n?Array.isArray(n)?n:[n]:[]];return(0,o.jsxs)(g,{children:[(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.group-by-item.aria-label-column","Column"),width:j,value:(null===(i=e.property)||void 0===i?void 0:i.name)?{label:e.property.name,value:e.property.name}:null,options:c,allowCustomValue:!0,onChange:r=>{if(!r.value)return;const o=r.value.startsWith("$"),a=s.find((e=>e.value===r.value));t(_(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){F(e,t,r[t])}))}return e}({},e),{property:{name:r.value,type:o?d.eg.String:(null==a?void 0:a.type)||d.eg.String},interval:e.interval,type:d.zu.Group_by}))}}),(0,o.jsx)(w.Z,{"aria-label":(0,a.t)("components.group-by-item.aria-label-remove","Remove"),icon:"times",variant:"secondary",onClick:r})]})},B=({query:e,buildAndUpdateQuery:t,allColumns:r,templateVariableOptions:n})=>{var l,p,m,h;const v=null===(l=e.azureLogAnalytics)||void 0===l?void 0:l.builderQuery,y=(0,s.useRef)((null==v||null===(p=v.from)||void 0===p?void 0:p.property.name)||null),[w,O]=(0,s.useState)((null==v||null===(m=v.groupBy)||void 0===m?void 0:m.expressions)||[]),j=(0,s.useRef)(!1);(0,s.useEffect)((()=>{var e,t;const r=(null==v||null===(e=v.from)||void 0===e?void 0:e.property.name)||null;y.current===r&&0!==(null==v||null===(t=v.groupBy)||void 0===t?void 0:t.expressions.length)||(O([]),j.current=!1,y.current=r)}),[v]);const S=[];var x;const k=null!==(x=null==v||null===(h=v.columns)||void 0===h?void 0:h.columns)&&void 0!==x?x:[];k.length>0?S.push(...k.map((e=>({label:e,value:e})))):S.push(...r.map((e=>({label:e.name,value:e.name}))));const A=e=>{O(e),t({groupBy:e})};return(0,o.jsx)(i.U,{children:(0,o.jsx)(c.B,{children:(0,o.jsx)(f.c,{label:(0,a.t)("components.group-by-section.label-group-by","Group by"),optional:!0,tooltip:(0,a.t)("components.group-by-section.tooltip-group-by","Organize results into categories based on specified columns. Group by can be used independently to list unique values in selected columns, or combined with aggregate functions to produce summary statistics for each group. When used alone, it returns distinct combinations of the specified columns."),children:(0,o.jsx)(g,{children:w.length>0?(0,o.jsx)(b.o,{items:w,onChange:A,renderItem:Q(S,(e=>{O((r=>{const o=r.filter((t=>{var r;return(null===(r=t.property)||void 0===r?void 0:r.name)!==e}));return t({groupBy:o}),o}))}),n)}):(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.group-by-section.aria-label-add-group-by","Add group by"),variant:"secondary",icon:"plus",onClick:()=>A([{type:d.zu.Group_by,property:{type:d.eg.String,name:""}}])})})})})})},Q=(e,t,r)=>(s,a,n)=>(0,o.jsx)(V,{groupBy:s,onChange:e=>{a(e)},onDelete:()=>{var e;(null===(e=s.property)||void 0===e?void 0:e.name)&&t(s.property.name),n()},columns:e,templateVariableOptions:r});var U=r(8146),X=r.n(U),W=(r(3006),r(7264)),H=r.n(W),K=r(6449),J=r.n(K),Z=r(4811),Y=r.n(Z),ee=r(4272),te=r.n(ee),re=r(8332),oe=r.n(re),se=r(4745),ae=r.n(se),ne=r(3422),ie={};ie.styleTagTransform=ae(),ie.setAttributes=te(),ie.insert=Y().bind(null,"head"),ie.domAPI=J(),ie.insertStyleElement=oe();H()(ne.A,ie);ne.A&&ne.A.locals&&ne.A.locals;const ce=e=>({codeBlock:(0,h.css)({width:"100%",display:"table",tableLayout:"fixed"}),code:(0,h.css)({marginBottom:"4px"})}),le=({query:e,hidden:t,setHidden:r})=>{const n=(0,u.useStyles2)(ce);return(0,s.useEffect)((()=>{X().highlightAll()}),[e]),(0,o.jsx)(i.U,{children:(0,o.jsx)(c.B,{children:(0,o.jsx)(f.c,{label:(0,a.t)("components.kql-preview.label-query-preview","Query Preview"),children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Button,{hidden:!t,variant:"secondary",onClick:()=>r(!1),size:"sm",children:(0,o.jsx)(a.x6,{i18nKey:"components.kql-preview.button-show",children:"Show"})}),(0,o.jsx)("div",{className:n.codeBlock,hidden:t,children:(0,o.jsx)("pre",{className:n.code,children:(0,o.jsx)("code",{className:"language-kusto",children:e})})}),(0,o.jsx)(u.Button,{hidden:t,variant:"secondary",onClick:()=>r(!0),size:"sm",children:(0,o.jsx)(a.x6,{i18nKey:"components.kql-preview.button-hide",children:"Hide"})})]})})})})},ue=e=>{const{buildAndUpdateQuery:t}=e,[r,n]=(0,s.useState)(1e3);return(0,o.jsx)(i.U,{children:(0,o.jsx)(c.B,{children:(0,o.jsx)(f.c,{label:(0,a.t)("components.limit-section.label-limit","Limit"),optional:!0,tooltip:(0,a.t)("components.limit-section.tooltip-limit","Restrict the number of rows returned (default is 1000)."),children:(0,o.jsx)(u.Input,{className:"width-5",type:"number",placeholder:(0,a.t)("components.limit-section.placeholder-limit","Enter limit"),value:r,onChange:e=>{const r=e.target.value.replace(/[^0-9]/g,"");var o;n(Number(r)),o=Number(r),t({limit:o})}})})})})};function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const me=({query:e,allColumns:t,buildAndUpdateQuery:r})=>{var n,l,p,m,b,h,v,y;const w=null===(n=e.azureLogAnalytics)||void 0===n?void 0:n.builderQuery,O=(0,s.useRef)((null==w||null===(l=w.from)||void 0===l?void 0:l.property.name)||null),S=(0,s.useRef)(!1),[x,k]=(0,s.useState)((null==w||null===(p=w.orderBy)||void 0===p?void 0:p.expressions)||[]);(0,s.useEffect)((()=>{var e,t;const r=(null==w||null===(e=w.from)||void 0===e?void 0:e.property.name)||null;O.current===r&&0!==(null==w||null===(t=w.orderBy)||void 0===t?void 0:t.expressions.length)||(k([]),S.current=!1,O.current=r)}),[w]);const A=(null==w||null===(b=w.groupBy)||void 0===b||null===(m=b.expressions)||void 0===m?void 0:m.map((e=>{var t;return null===(t=e.property)||void 0===t?void 0:t.name})))||[],P=(null==w||null===(v=w.reduce)||void 0===v||null===(h=v.expressions)||void 0===h?void 0:h.map((e=>{var t;return null===(t=e.property)||void 0===t?void 0:t.name})))||[],E=(null==w||null===(y=w.columns)||void 0===y?void 0:y.columns)||[],z=(A.length>0?A:P.length>0?P:E.length>0?E:t.map((e=>e.name))).map((e=>({label:e,value:e}))),C=[{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],T=(e,t,o)=>{k((s=>{const a=[...s];return-1===e?a.push({property:{name:o,type:d.eg.String},order:d.MX.Asc,type:d.zu.Order_by}):a[e]=pe(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){de(e,t,r[t])}))}return e}({},a[e]),{property:"column"===t?{name:o,type:d.eg.String}:a[e].property,order:"order"!==t||o!==d.MX.Asc&&o!==d.MX.Desc?a[e].order:o}),r({orderBy:a}),a}))};return(0,o.jsx)(i.U,{children:(0,o.jsx)(c.B,{children:(0,o.jsx)(f.c,{label:(0,a.t)("components.order-by-section.label-order-by","Order By"),optional:!0,tooltip:(0,a.t)("components.order-by-section.tooltip-order-by","Sort results based on one or more columns in ascending or descending order."),children:(0,o.jsx)(o.Fragment,{children:x.length>0?x.map(((e,t)=>{var s;return(0,o.jsxs)(g,{children:[(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.order-by-section.aria-label-order-by-column","Order by column"),width:j,value:(null===(s=e.property)||void 0===s?void 0:s.name)?{label:e.property.name,value:e.property.name}:null,options:z,onChange:e=>e.value&&T(t,"column",e.value)}),(0,o.jsx)(u.Label,{style:{margin:"9px 9px 0 9px"},children:(0,o.jsx)(a.x6,{i18nKey:"components.order-by-section.label-by",children:"BY"})}),(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.order-by-section.aria-label-order-direction","Order Direction"),width:j,value:C.find((t=>t.value===e.order))||null,options:C,onChange:e=>e.value&&T(t,"order",e.value)}),(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.order-by-section.aria-label-remove-order-by","Remove order by"),variant:"secondary",icon:"times",onClick:()=>(e=>{k((t=>{const o=t.filter(((t,r)=>r!==e));return r({orderBy:o}),o}))})(t)}),t===x.length-1?(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.order-by-section.aria-label-add-order-by","Add order by"),variant:"secondary",onClick:()=>T(-1,"column",""),icon:"plus",style:{marginLeft:"15px"}}):(0,o.jsx)(o.Fragment,{})]},t)})):(0,o.jsx)(g,{children:(0,o.jsx)(u.Button,{"aria-label":(0,a.t)("components.order-by-section.aria-label-add-order-by","Add order by"),variant:"secondary",onClick:()=>T(-1,"column",""),icon:"plus"})})})})})})};var fe=r(1427);const be=e=>{var t,r,s,n,l,p;const{allColumns:m,query:b,tables:h,buildAndUpdateQuery:v,templateVariableOptions:y,isLoadingSchema:w}=e,O=null===(t=b.azureLogAnalytics)||void 0===t?void 0:t.builderQuery,S=(null===(n=b.azureLogAnalytics)||void 0===n||null===(s=n.builderQuery)||void 0===s||null===(r=s.columns)||void 0===r?void 0:r.columns)||[],x=h.map((e=>({label:e.name,value:e.name,description:e.plan===fe.iy.Basic?"Selecting this table will switch the query mode to Basic Logs":""}))),k={label:"All Columns",value:"__all_columns__"},A=[k,...m.map((e=>({label:e.name,value:e.name,type:e.type}))),...y?Array.isArray(y)?y:[y]:[]],P=m.length>0?m.map((e=>e.name)):[],E=P.length>0&&S.length>0&&S.length===P.length&&P.every((e=>S.includes(e)))?[k]:S.map((e=>({label:e,value:e})));return(0,o.jsx)(i.U,{children:(0,o.jsxs)(c.B,{children:[(0,o.jsx)(f.c,{label:(0,a.t)("components.table-section.label-table","Table"),children:(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.table-section.aria-label-table","Table"),value:null==O||null===(l=O.from)||void 0===l?void 0:l.property.name,options:x,placeholder:(0,a.t)("components.table-section.placeholder-select-table","Select a table"),onChange:e=>{const t=h.find((t=>t.name===e.value));t&&v({from:{property:{name:t.name,type:d.eg.String},type:d.zu.Property},reduce:[],where:[],fuzzySearch:[],groupBy:[],orderBy:[],columns:[],basicLogsQuery:t.plan===fe.iy.Basic})},width:j,isLoading:w})}),(0,o.jsx)(f.c,{label:(0,a.t)("components.table-section.label-columns","Columns"),children:(0,o.jsxs)(g,{children:[(0,o.jsx)(u.Select,{"aria-label":(0,a.t)("components.table-section.aria-label-columns","Columns"),isMulti:!0,isClearable:!0,closeMenuOnSelect:!1,value:E,options:A,placeholder:(0,a.t)("components.table-section.placeholder-select-columns","Select columns"),onChange:e=>{const t=Array.isArray(e)?e:e?[e]:[];if(0===t.length)return void v({columns:[]});const r=t.some((e=>"__all_columns__"===e.value)),o=t[t.length-1];if(r&&"__all_columns__"===o.value)v({columns:m.map((e=>e.name))});else if(r&&t.length>1){const e=t.filter((e=>"__all_columns__"!==e.value));v({columns:e.map((e=>e.value))})}else r&&1===t.length?v({columns:m.map((e=>e.name))}):v({columns:t.map((e=>e.value))})},isDisabled:!(null==O||null===(p=O.from)||void 0===p?void 0:p.property.name),width:30}),(0,o.jsx)(u.Button,{tooltip:(0,a.t)("components.table-section.tooltip-remove-all-columns","Remove all columns"),variant:"secondary",icon:"times",onClick:()=>{v({columns:[]})}})]})})]})})};function he(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){he(e,t,r[t])}))}return e}function ve(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ye=e=>{var t,r;const{query:i,onQueryChange:c,schema:l,datasource:m,timeRange:f,isLoadingSchema:b}=e,[h,g]=(0,s.useState)(!0),v=(0,s.useMemo)((()=>{var e;return(null==l||null===(e=l.database)||void 0===e?void 0:e.tables)||[]}),[null==l?void 0:l.database]),y=(null===(t=i.azureLogAnalytics)||void 0===t?void 0:t.builderQuery)||S,w=(0,s.useMemo)((()=>{var e;const t=null===(e=y.from)||void 0===e?void 0:e.property.name,r=v.find((e=>e.name===t));return(null==r?void 0:r.columns)||[]}),[y,v]),O=(0,s.useCallback)((({limit:e,reduce:t,where:r,fuzzySearch:o,groupBy:s,orderBy:a,columns:n,from:l,basicLogsQuery:u})=>{var p,m;const f=(null===(p=w.find((e=>"datetime"===e.type)))||void 0===p?void 0:p.name)||"TimeGenerated",b={type:d.zu.Or,expressions:[{type:d.zu.Operator,operator:{name:"$__timeFilter",value:f},property:{name:f,type:d.eg.Datetime}}]},h=ve(ge({},y,void 0!==e?{limit:e}:{},void 0!==t?{reduce:{expressions:t,type:d.zu.Reduce}}:{},void 0!==r?{where:{expressions:r,type:d.zu.And}}:{},void 0!==o?{fuzzySearch:{expressions:o,type:d.zu.And}}:{},void 0!==s?{groupBy:{expressions:s,type:d.zu.Group_by}}:{},void 0!==a?{orderBy:{expressions:a,type:d.zu.Order_by}}:{},void 0!==n?{columns:{columns:n,type:d.zu.Property}}:{},void 0!==l?{from:l}:{}),{timeFilter:{expressions:[b],type:d.zu.And}}),g=T(h);c(ve(ge({},i),{azureLogAnalytics:ve(ge({},i.azureLogAnalytics),{builderQuery:h,query:g,basicLogsQuery:l?u:null===(m=i.azureLogAnalytics)||void 0===m?void 0:m.basicLogsQuery})}))}),[i,y,c,w]);return(0,o.jsx)("span",{"data-testid":p.T.components.queryEditor.logsQueryBuilder.container.input,children:(0,o.jsxs)(n.D,{children:[l&&0===v.length&&(0,o.jsx)(u.Alert,{severity:"warning",title:(0,a.t)("components.logs-query-builder.title-no-tables","Resource loaded successfully but without any tables")}),(0,o.jsx)(be,ve(ge({},e),{tables:v,allColumns:w,buildAndUpdateQuery:O,isLoadingSchema:b})),(0,o.jsx)($,ve(ge({},e),{allColumns:w,buildAndUpdateQuery:O,datasource:m,timeRange:f})),(0,o.jsx)(E,ve(ge({},e),{allColumns:w,buildAndUpdateQuery:O})),(0,o.jsx)(B,ve(ge({},e),{allColumns:w,buildAndUpdateQuery:O})),(0,o.jsx)(me,ve(ge({},e),{allColumns:w,buildAndUpdateQuery:O})),(0,o.jsx)(G,ve(ge({},e),{allColumns:w,buildAndUpdateQuery:O})),(0,o.jsx)(ue,ve(ge({},e),{buildAndUpdateQuery:O})),(0,o.jsx)(le,{query:(null===(r=i.azureLogAnalytics)||void 0===r?void 0:r.query)||"",hidden:h,setHidden:g})]})})};var we=r(5130),Oe=r(8785),je=r(9580),Se=r(1490),xe=r(608),ke=r(7059);function Ae({query:e,onQueryChange:t}){var r;const[n,i]=(0,s.useState)(!1);var c;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.ConfirmModal,{isOpen:n,title:(0,a.t)("components.logs-management.title-basic-logs-queries","Basic Logs Queries"),body:(0,a.t)("components.logs-management.body-basic-logs-queries","Are you sure you want to switch to Basic Logs?"),description:(0,a.t)("components.logs-management.description-basic-logs-queries","Basic Logs queries incur cost based on the amount of data scanned."),confirmText:(0,a.t)("components.logs-management.confirmText-confirm","Confirm"),onConfirm:()=>{i(!1);let r=(0,ke.yg)(e,!0);r=(0,ke.i6)(r,"dashboard"),t((0,ke.Ds)(r,""))},onDismiss:()=>{i(!1),t((0,ke.yg)(e,!1))},confirmButtonVariant:"primary"}),(0,o.jsx)(u.InlineField,{label:(0,a.t)("components.logs-management.label-logs","Logs"),tooltip:(0,a.t)("components.logs-management.tooltip-logs","Specifies whether to run a Basic or Analytics Logs query."),children:(0,o.jsx)(u.RadioButtonGroup,{options:[{label:"Analytics",value:!1},{label:"Basic",value:!0}],value:null!==(c=null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.basicLogsQuery)&&void 0!==c&&c,size:"md",onChange:r=>{if(i(r),!r){const o=(0,ke.yg)(e,r);t((0,ke.Ds)(o,""))}}})})]})}var Pe=r(4831);function Ee(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}const ze=({query:e,onQueryChange:t,schema:r})=>{var a;const[n,i]=(0,s.useState)();(0,s.useEffect)((()=>{if(!r||!n)return;(({monaco:e,editor:t},r)=>{return(o=function*(){try{const e=t.getModel();if(e){const t=yield(0,Pe.getKustoWorker)(),o=yield t(null==e?void 0:e.uri);yield o.setSchema(r)}}catch(e){console.error(e)}},function(){var e=this,t=arguments;return new Promise((function(r,s){var a=o.apply(e,t);function n(e){Ee(a,r,s,n,i,"next",e)}function i(e){Ee(a,r,s,n,i,"throw",e)}n(void 0)}))})();var o})(n,r).catch((e=>console.error(e)))}),[r,n]);const c=(0,s.useCallback)(((e,t)=>{i({monaco:t,editor:e})}),[]),l=(0,s.useCallback)((r=>{t((0,ke.Ds)(e,r))}),[t,e]);var d;return(0,o.jsx)(u.CodeEditor,{value:null!==(d=null===(a=e.azureLogAnalytics)||void 0===a?void 0:a.query)&&void 0!==d?d:"",language:"kusto",height:200,width:"100%",showMiniMap:!1,onBlur:l,onSave:l,onEditorDidMount:c})};function Ce({query:e,onQueryChange:t,schema:r}){var n,i,c,l,d,p,m,f,b,h;const[g,v]=(0,s.useState)(),[y,w]=(0,s.useState)(),[O,j]=(0,s.useState)(!1),S=(0,s.useCallback)((r=>t((0,ke.sX)(e,r))),[e,t]);(0,s.useEffect)((()=>{var t;if(r&&(null===(t=e.azureLogAnalytics)||void 0===t?void 0:t.dashboardTime)){var o;const t=[],s=new Set,a=new Map,n=r.database;if(n&&(null==n||null===(o=n.tables)||void 0===o?void 0:o.length)>0){for(const e of n.tables){const r=e.columns.reduce(((t,r,o)=>("datetime"===r.type&&(e.timespanColumn&&e.timespanColumn===r.name||(t.push({value:r.name,label:`${e.name} > ${r.name}`}),s.add(r.name))),t)),[]);t.push(...r),e.timespanColumn&&!a.has(e.timespanColumn)&&a.set(e.timespanColumn,{value:e.timespanColumn,label:e.timespanColumn})}w(t);const r=Array.from(a.values());if(v(r),!e.azureLogAnalytics.timeColumn||e.azureLogAnalytics.timeColumn&&!s.has(e.azureLogAnalytics.timeColumn)&&!a.has(e.azureLogAnalytics.timeColumn))return r&&r.length?(S(r[0].value),void S(r[0].value)):t&&t.length?void S(t[0].value):void S("TimeGenerated")}}}),[r,null===(n=e.azureLogAnalytics)||void 0===n?void 0:n.dashboardTime,null===(i=e.azureLogAnalytics)||void 0===i?void 0:i.timeColumn,S]);const x=(0,s.useCallback)((r=>{if(!r.value)return;const o=(0,ke.sX)(e,r.value);t(o)}),[t,e]);return(0,s.useEffect)((()=>{var t;(null===(t=e.azureLogAnalytics)||void 0===t?void 0:t.basicLogsQuery)?j(!0):j(!1)}),[null===(c=e.azureLogAnalytics)||void 0===c?void 0:c.basicLogsQuery]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.InlineField,{label:(0,a.t)("components.time-management.label-time-range","Time-range"),tooltip:(0,o.jsx)(a.x6,{i18nKey:"components.time-management.tooltip-time-range",children:(0,o.jsxs)("span",{children:["Specifies the time-range used to query. The ",(0,o.jsx)("code",{children:"Query"})," option will only use time-ranges specified in the query. ",(0,o.jsx)("code",{children:"Dashboard"})," will only use the Grafana time-range. In Logs Builder mode, only Dashboard time will be used."]})}),children:(0,o.jsx)(u.RadioButtonGroup,{options:[{label:"Query",value:"query",disabled:"builder"===(null===(l=e.azureLogAnalytics)||void 0===l?void 0:l.mode)},{label:"Dashboard",value:"dashboard"}],value:(null===(d=e.azureLogAnalytics)||void 0===d?void 0:d.dashboardTime)||"builder"===(null===(p=e.azureLogAnalytics)||void 0===p?void 0:p.mode)?"dashboard":"query",size:"md",onChange:r=>t((0,ke.i6)(e,r)),disabled:O,disabledOptions:O?["query"]:[]})}),((null===(m=e.azureLogAnalytics)||void 0===m?void 0:m.dashboardTime)||"builder"===(null===(f=e.azureLogAnalytics)||void 0===f?void 0:f.mode))&&(0,o.jsx)(u.InlineField,{label:(0,a.t)("components.time-management.label-time-column","Time Column"),tooltip:(0,o.jsx)(a.x6,{i18nKey:"components.time-management.tooltip-time-column",children:(0,o.jsxs)("span",{children:["Specifies the time column used for filtering. Defaults to the first tables ",(0,o.jsx)("code",{children:"timeSpan"})," column, the first ",(0,o.jsx)("code",{children:"datetime"})," column found or ",(0,o.jsx)("code",{children:"TimeGenerated"}),"."]})}),children:(0,o.jsx)(u.Select,{options:[{label:"Default time columns",options:null!=g?g:[{value:"TimeGenerated",label:"TimeGenerated"}]},{label:"Other time columns",options:null!=y?y:[]}],onChange:x,value:(null===(b=e.azureLogAnalytics)||void 0===b?void 0:b.timeColumn)?null===(h=e.azureLogAnalytics)||void 0===h?void 0:h.timeColumn:g?g[0]:y?y[0]:{value:"TimeGenerated",label:"TimeGenerated"},allowCustomValue:!0})})]})}function Te(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function De(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){De(e,t,r[t])}))}return e}function Ie(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Re(e,t,r){return(o=function*(){var o;if(void 0!==(null===(o=t.azureLogAnalytics)||void 0===o?void 0:o.workspace)&&!t.azureLogAnalytics.resources){let o;o=(0,je.wr)(t.azureLogAnalytics.workspace)?yield e.resourcePickerData.getResourceURIFromWorkspace(t.azureLogAnalytics.workspace):t.azureLogAnalytics.workspace;const s=Ie(Ne({},t),{azureLogAnalytics:Ie(Ne({},t.azureLogAnalytics),{resource:o,workspace:void 0})});delete s.azureLogAnalytics.workspace,r(s)}},function(){var e=this,t=arguments;return new Promise((function(r,s){var a=o.apply(e,t);function n(e){Te(a,r,s,n,i,"next",e)}function i(e){Te(a,r,s,n,i,"throw",e)}n(void 0)}))})();var o}function Le(e,t){var r,o;const s=null===(r=(0,l.getTemplateSrv)())||void 0===r?void 0:r.replace(e[0]);return t&&1===e.length&&"microsoft.operationalinsights/workspaces"===(null===(o=(0,je.U4)(s).metricNamespace)||void 0===o?void 0:o.toLowerCase())}function Me(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function qe(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){Me(a,o,s,n,i,"next",e)}function i(e){Me(a,o,s,n,i,"throw",e)}n(void 0)}))}}function $e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){$e(e,t,r[t])}))}return e}function Fe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const _e=({query:e,datasource:t,basicLogsEnabled:r,subscriptionId:f,variableOptionGroup:b,onChange:h,onQueryChange:g,setError:v,hideFormatAs:y,timeRange:w,data:O})=>{var j,S,x,k,A,P,E,z,C;const T=function(e,t,r){const[o,a]=(0,s.useState)();return(0,s.useEffect)((()=>{Re(e,t,r).catch((e=>a({title:"Unable to migrate workspace as a resource",message:e.message})))}),[e,t,r]),o}(t,e,h),[D,N]=(0,s.useState)(Le((null===(j=e.azureLogAnalytics)||void 0===j?void 0:j.resources)||[],r)),[I,R]=(0,s.useState)(null),L=(0,l.getTemplateSrv)(),M=null==L?void 0:L.replace("$__from"),q=null==L?void 0:L.replace("$__to"),$=L.getVariables();var G;const F=null!==(G=r&&(null===(S=e.azureLogAnalytics)||void 0===S?void 0:S.basicLogsQuery))&&void 0!==G&&G,[_,V]=(0,s.useState)(!1),[B,Q]=(0,s.useState)();(0,s.useEffect)((()=>{var r;const o=null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.resources;if(o){V(!0);const r=e=>qe((function*(){const r=[];for(const s of e)r.push(Fe(Ge({},s),{plan:yield t.azureMonitorDatasource.getWorkspaceTablePlan(o,s.name)}));return yield Promise.all(r)}))();t.azureLogAnalyticsDatasource.getKustoSchema(o[0]).then((t=>{var o,s,a;(null==t||null===(o=t.database)||void 0===o?void 0:o.tables)&&(null===(s=e.azureLogAnalytics)||void 0===s?void 0:s.mode)===d.O8.Builder&&r(null==t||null===(a=t.database)||void 0===a?void 0:a.tables).then((e=>qe((function*(){var r;(null===(r=t.database)||void 0===r?void 0:r.tables)&&(t.database.tables=e)}))()));Q(t),V(!1)}))}}),[null===(x=e.azureLogAnalytics)||void 0===x?void 0:x.resources,t.azureLogAnalyticsDatasource,t.azureMonitorDatasource,null===(k=e.azureLogAnalytics)||void 0===k?void 0:k.mode]),(0,s.useEffect)((()=>{var t;Le((null===(t=e.azureLogAnalytics)||void 0===t?void 0:t.resources)||[],r)?N(!0):N(!1)}),[r,null===(A=e.azureLogAnalytics)||void 0===A?void 0:A.resources,L]),(0,s.useEffect)((()=>{var t;if((!r||!D)&&(null===(t=e.azureLogAnalytics)||void 0===t?void 0:t.basicLogsQuery)){const t=(0,ke.yg)(e,!1);h((0,ke.Ds)(t,""))}}),[r,h,e,D]),(0,s.useEffect)((()=>{var t,r,o;const s=!!(null===(t=e.azureLogAnalytics)||void 0===t?void 0:t.query),a=!(null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.builderQuery),n=void 0===(null===(o=e.azureLogAnalytics)||void 0===o?void 0:o.mode);s&&a&&n&&h(Fe(Ge({},e),{azureLogAnalytics:Fe(Ge({},e.azureLogAnalytics),{mode:d.O8.Raw})}))}),[e,h]),(0,s.useEffect)((()=>{var t,r;(null===(t=e.azureLogAnalytics)||void 0===t?void 0:t.mode)===d.O8.Raw&&void 0!==(null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.builderQuery)&&g(Fe(Ge({},e),{azureLogAnalytics:Fe(Ge({},e.azureLogAnalytics),{builderQuery:void 0,query:""})}))}),[null===(P=e.azureLogAnalytics)||void 0===P?void 0:P.mode,g,e]),(0,s.useEffect)((()=>{(e=>qe((function*(){try{var r;if(D&&(null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.basicLogsQuery)&&e.azureLogAnalytics.query){const r=e.azureLogAnalytics.query.split("|")[0].trim(),s=yield t.azureLogAnalyticsDatasource.getBasicLogsQueryUsage(e,r),n=s?`This query is processing ${s} GiB when run. `:"This is a Basic Logs query and incurs cost per GiB scanned. ";R((0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(u.Text,{color:"primary",children:[n," ",(0,o.jsx)(u.TextLink,{href:"https://learn.microsoft.com/en-us/azure/azure-monitor/logs/basic-logs-configure?tabs=portal-1",external:!0,children:(0,o.jsx)(a.x6,{i18nKey:"components.logs-query-editor.learn-more",children:"Learn More"})})]})}))}else R(null)}catch(e){console.error(e)}}))())(e).catch((e=>console.error(e)))}),[t.azureLogAnalyticsDatasource,e,D,M,q]);let U=null;if(null==O?void 0:O.series){var X,W;const t=O.series.find((t=>t.refId===e.refId));var H,K;if(t&&(null===(W=t.meta)||void 0===W||null===(X=W.custom)||void 0===X?void 0:X.azurePortalLink))U=(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(u.LinkButton,{size:"md",target:"_blank",style:{marginTop:"22px"},href:null===(K=t.meta)||void 0===K||null===(H=K.custom)||void 0===H?void 0:H.azurePortalLink,children:(0,o.jsx)(a.x6,{i18nKey:"components.logs-query-editor.view-query",children:"View query in Azure Portal"})})})}var J;return(0,o.jsx)("span",{"data-testid":p.T.components.queryEditor.logsQueryEditor.container.input,children:(0,o.jsxs)(n.D,{children:[(0,o.jsx)(i.U,{children:(0,o.jsxs)(c.B,{children:[(0,o.jsx)(we.A,{query:e,datasource:t,inlineField:!0,labelWidth:10,subscriptionId:f,variableOptionGroup:b,onQueryChange:h,setError:v,selectableEntryTypes:[Oe.X.Subscription,Oe.X.ResourceGroup,Oe.X.Resource,Oe.X.Variable],resources:null!==(J=null===(E=e.azureLogAnalytics)||void 0===E?void 0:E.resources)&&void 0!==J?J:[],queryType:"logs",disableRow:(e,t)=>{var r,o;if(0===t.length)return!1;if(F&&1===t.length)return!0;return(null===(r=(0,je.oU)(e.uri,e.location).metricNamespace)||void 0===r?void 0:r.toLowerCase())!==(null===(o=(0,je.oU)(t[0].uri,t[0].location).metricNamespace)||void 0===o?void 0:o.toLowerCase())},renderAdvanced:(e,t)=>(0,o.jsx)(xe.A,{resources:e,onChange:t}),selectionNotice:e=>1===e.length&&F?"When using Basic Logs, you may only select one resource at a time.":"You may only choose items of the same resource type."}),D&&(0,o.jsx)(Ae,{query:e,datasource:t,variableOptionGroup:b,onQueryChange:h,setError:v}),(0,o.jsx)(Ce,{query:e,datasource:t,variableOptionGroup:b,onQueryChange:h,setError:v,schema:B})]})}),(0,o.jsx)(u.Space,{}),(null===(z=e.azureLogAnalytics)||void 0===z?void 0:z.mode)===d.O8.Builder&&l.config.featureToggles.azureMonitorLogsBuilderEditor?(0,o.jsx)(ye,{query:e,schema:B,basicLogsEnabled:r,onQueryChange:g,templateVariableOptions:$,datasource:t,timeRange:w,isLoadingSchema:_}):(0,o.jsx)(ze,{query:e,datasource:t,subscriptionId:f,variableOptionGroup:b,onQueryChange:h,setError:v,schema:B}),I,(0,o.jsx)(i.U,{children:(0,o.jsxs)(c.B,{children:[!y&&(0,o.jsx)(Se.A,{query:e,datasource:t,subscriptionId:f,variableOptionGroup:b,onQueryChange:h,setError:v,inputId:"azure-monitor-logs",options:[{label:"Log",value:m.f.Logs},{label:"Time series",value:m.f.TimeSeries},{label:"Table",value:m.f.Table}],defaultValue:m.f.Logs,setFormatAs:ke.Q$,resultFormat:null===(C=e.azureLogAnalytics)||void 0===C?void 0:C.resultFormat,onLoad:ke.kF}),U,T&&(0,o.jsx)(u.Alert,{title:T.title,children:T.message})]})})]})})}},2366:(e,t,r)=>{"use strict";const o=r(4708),s=r(2839);e.exports=(e,t,r)=>{let a=null,n=null,i=null;try{i=new s(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(a&&1!==n.compare(e)||(a=e,n=new o(a,r)))})),a}},2479:(e,t,r)=>{"use strict";const o=r(4708);e.exports=(e,t,r,s,a)=>{"string"==typeof r&&(a=s,s=r,r=void 0);try{return new o(e instanceof o?e.version:e,r).inc(t,s,a).version}catch(e){return null}}},2533:e=>{"use strict";e.exports=JSON.parse('{"id":"grafana-azure-monitor-datasource"}')},2827:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var o=r(6089),s=r(5959),a=(r(7781),r(2007));const n=({className:e,...t})=>{const r=(0,a.useStyles2)(i);return s.createElement(a.Button,{...t,className:(0,o.cx)(e,r.button)})},i=e=>({button:(0,o.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)})})},2839:(e,t,r)=>{"use strict";const o=/\s+/g;class s{constructor(e,t){if(t=n(t),e instanceof s)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new s(e.raw,t);if(e instanceof i)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(o," "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!g(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&v(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&b)|(this.options.loose&&h))+":"+e,r=a.get(t);if(r)return r;const o=this.options.loose,s=o?u[d.HYPHENRANGELOOSE]:u[d.HYPHENRANGE];e=e.replace(s,C(this.options.includePrerelease)),c("hyphen replace",e),e=e.replace(u[d.COMPARATORTRIM],p),c("comparator trim",e),e=e.replace(u[d.TILDETRIM],m),c("tilde trim",e),e=e.replace(u[d.CARETTRIM],f),c("caret trim",e);let n=e.split(" ").map((e=>w(e,this.options))).join(" ").split(/\s+/).map((e=>z(e,this.options)));o&&(n=n.filter((e=>(c("loose invalid filter",e,this.options),!!e.match(u[d.COMPARATORLOOSE]))))),c("range list",n);const l=new Map,v=n.map((e=>new i(e,this.options)));for(const e of v){if(g(e))return[e];l.set(e.value,e)}l.size>1&&l.has("")&&l.delete("");const y=[...l.values()];return a.set(t,y),y}intersects(e,t){if(!(e instanceof s))throw new TypeError("a Range is required");return this.set.some((r=>y(r,t)&&e.set.some((e=>y(e,t)&&r.every((r=>e.every((e=>r.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(T(this.set[t],e,this.options))return!0;return!1}}e.exports=s;const a=new(r(122)),n=r(9547),i=r(9264),c=r(1064),l=r(4708),{safeRe:u,t:d,comparatorTrimReplace:p,tildeTrimReplace:m,caretTrimReplace:f}=r(5750),{FLAG_INCLUDE_PRERELEASE:b,FLAG_LOOSE:h}=r(2074),g=e=>"<0.0.0-0"===e.value,v=e=>""===e.value,y=(e,t)=>{let r=!0;const o=e.slice();let s=o.pop();for(;r&&o.length;)r=o.every((e=>s.intersects(e,t))),s=o.pop();return r},w=(e,t)=>(c("comp",e,t),e=x(e,t),c("caret",e),e=j(e,t),c("tildes",e),e=A(e,t),c("xrange",e),e=E(e,t),c("stars",e),e),O=e=>!e||"x"===e.toLowerCase()||"*"===e,j=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{const r=t.loose?u[d.TILDELOOSE]:u[d.TILDE];return e.replace(r,((t,r,o,s,a)=>{let n;return c("tilde",e,t,r,o,s,a),O(r)?n="":O(o)?n=`>=${r}.0.0 <${+r+1}.0.0-0`:O(s)?n=`>=${r}.${o}.0 <${r}.${+o+1}.0-0`:a?(c("replaceTilde pr",a),n=`>=${r}.${o}.${s}-${a} <${r}.${+o+1}.0-0`):n=`>=${r}.${o}.${s} <${r}.${+o+1}.0-0`,c("tilde return",n),n}))},x=(e,t)=>e.trim().split(/\s+/).map((e=>k(e,t))).join(" "),k=(e,t)=>{c("caret",e,t);const r=t.loose?u[d.CARETLOOSE]:u[d.CARET],o=t.includePrerelease?"-0":"";return e.replace(r,((t,r,s,a,n)=>{let i;return c("caret",e,t,r,s,a,n),O(r)?i="":O(s)?i=`>=${r}.0.0${o} <${+r+1}.0.0-0`:O(a)?i="0"===r?`>=${r}.${s}.0${o} <${r}.${+s+1}.0-0`:`>=${r}.${s}.0${o} <${+r+1}.0.0-0`:n?(c("replaceCaret pr",n),i="0"===r?"0"===s?`>=${r}.${s}.${a}-${n} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}-${n} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a}-${n} <${+r+1}.0.0-0`):(c("no pr"),i="0"===r?"0"===s?`>=${r}.${s}.${a}${o} <${r}.${s}.${+a+1}-0`:`>=${r}.${s}.${a}${o} <${r}.${+s+1}.0-0`:`>=${r}.${s}.${a} <${+r+1}.0.0-0`),c("caret return",i),i}))},A=(e,t)=>(c("replaceXRanges",e,t),e.split(/\s+/).map((e=>P(e,t))).join(" ")),P=(e,t)=>{e=e.trim();const r=t.loose?u[d.XRANGELOOSE]:u[d.XRANGE];return e.replace(r,((r,o,s,a,n,i)=>{c("xRange",e,r,o,s,a,n,i);const l=O(s),u=l||O(a),d=u||O(n),p=d;return"="===o&&p&&(o=""),i=t.includePrerelease?"-0":"",l?r=">"===o||"<"===o?"<0.0.0-0":"*":o&&p?(u&&(a=0),n=0,">"===o?(o=">=",u?(s=+s+1,a=0,n=0):(a=+a+1,n=0)):"<="===o&&(o="<",u?s=+s+1:a=+a+1),"<"===o&&(i="-0"),r=`${o+s}.${a}.${n}${i}`):u?r=`>=${s}.0.0${i} <${+s+1}.0.0-0`:d&&(r=`>=${s}.${a}.0${i} <${s}.${+a+1}.0-0`),c("xRange return",r),r}))},E=(e,t)=>(c("replaceStars",e,t),e.trim().replace(u[d.STAR],"")),z=(e,t)=>(c("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),C=e=>(t,r,o,s,a,n,i,c,l,u,d,p)=>`${r=O(o)?"":O(s)?`>=${o}.0.0${e?"-0":""}`:O(a)?`>=${o}.${s}.0${e?"-0":""}`:n?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=O(l)?"":O(u)?`<${+l+1}.0.0-0`:O(d)?`<${l}.${+u+1}.0-0`:p?`<=${l}.${u}.${d}-${p}`:e?`<${l}.${u}.${+d+1}-0`:`<=${c}`}`.trim(),T=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(c(e[r].semver),e[r].semver!==i.ANY&&e[r].semver.prerelease.length>0){const o=e[r].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0}},3006:()=>{Prism.languages.kusto={comment:{pattern:/\/\/.*/,greedy:!0},string:{pattern:/```[\s\S]*?```|[hH]?(?:"(?:[^\r\n\\"]|\\.)*"|'(?:[^\r\n\\']|\\.)*'|@(?:"[^\r\n"]*"|'[^\r\n']*'))/,greedy:!0},verb:{pattern:/(\|\s*)[a-z][\w-]*/i,lookbehind:!0,alias:"keyword"},command:{pattern:/\.[a-z][a-z\d-]*\b/,alias:"keyword"},"class-name":/\b(?:bool|datetime|decimal|dynamic|guid|int|long|real|string|timespan)\b/,keyword:/\b(?:access|alias|and|anti|as|asc|auto|between|by|(?:contains|(?:ends|starts)with|has(?:perfix|suffix)?)(?:_cs)?|database|declare|desc|external|from|fullouter|has_all|in|ingestion|inline|inner|innerunique|into|(?:left|right)(?:anti(?:semi)?|inner|outer|semi)?|let|like|local|not|of|on|or|pattern|print|query_parameters|range|restrict|schema|set|step|table|tables|to|view|where|with|matches\s+regex|nulls\s+(?:first|last))(?![\w-])/,boolean:/\b(?:false|null|true)\b/,function:/\b[a-z_]\w*(?=\s*\()/,datetime:[{pattern:/\b(?:(?:Fri|Friday|Mon|Monday|Sat|Saturday|Sun|Sunday|Thu|Thursday|Tue|Tuesday|Wed|Wednesday)\s*,\s*)?\d{1,2}(?:\s+|-)(?:Apr|Aug|Dec|Feb|Jan|Jul|Jun|Mar|May|Nov|Oct|Sep)(?:\s+|-)\d{2}\s+\d{2}:\d{2}(?::\d{2})?(?:\s*(?:\b(?:[A-Z]|(?:[ECMT][DS]|GM|U)T)|[+-]\d{4}))?\b/,alias:"number"},{pattern:/[+-]?\b(?:\d{4}-\d{2}-\d{2}(?:[ T]\d{2}:\d{2}(?::\d{2}(?:\.\d+)?)?)?|\d{2}:\d{2}(?::\d{2}(?:\.\d+)?)?)Z?/,alias:"number"}],number:/\b(?:0x[0-9A-Fa-f]+|\d+(?:\.\d+)?(?:[Ee][+-]?\d+)?)(?:(?:min|sec|[mn]s|[dhms]|microsecond|tick)\b)?|[+-]?\binf\b/,operator:/=>|[!=]~|[!=<>]=?|[-+*/%|]|\.\./,punctuation:/[()\[\]{},;.:]/}},3059:e=>{"use strict";e.exports=d},3238:(e,t,r)=>{"use strict";const o=r(2839);e.exports=(e,t,r)=>{try{t=new o(t,r)}catch(e){return!1}return t.test(e)}},3241:e=>{"use strict";e.exports=i},3292:(e,t,r)=>{"use strict";r.d(t,{MX:()=>c,O8:()=>a,eg:()=>i,fW:()=>s,oj:()=>o,pG:()=>l,zu:()=>n});var o=function(e){return e.AzureMonitor="Azure Monitor",e.AzureResourceGraph="Azure Resource Graph",e.AzureTraces="Azure Traces",e.CustomMetricNamesQuery="Azure Custom Metric Names",e.CustomNamespacesQuery="Azure Custom Namespaces",e.GrafanaTemplateVariableFn="Grafana Template Variable Function",e.LocationsQuery="Azure Regions",e.LogAnalytics="Azure Log Analytics",e.MetricNamesQuery="Azure Metric Names",e.NamespacesQuery="Azure Namespaces",e.ResourceGroupsQuery="Azure Resource Groups",e.ResourceNamesQuery="Azure Resource Names",e.SubscriptionsQuery="Azure Subscriptions",e.TraceExemplar="traceql",e.WorkspacesQuery="Azure Workspaces",e}({});var s=function(e){return e.Logs="logs",e.Table="table",e.TimeSeries="time_series",e.Trace="trace",e}({}),a=function(e){return e.Builder="builder",e.Raw="raw",e}({}),n=function(e){return e.And="and",e.Function_parameter="function_parameter",e.Group_by="group_by",e.Operator="operator",e.Or="or",e.Order_by="order_by",e.Property="property",e.Reduce="reduce",e}({}),i=function(e){return e.Boolean="boolean",e.Datetime="datetime",e.Function="function",e.Interval="interval",e.Number="number",e.String="string",e.Time_span="time_span",e}({}),c=function(e){return e.Asc="asc",e.Desc="desc",e}({});var l=function(e){return e.Directory="directory",e.Subscription="subscription",e}({})},3327:(e,t,r)=>{"use strict";const o=r(2839);e.exports=(e,t)=>new o(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},3422:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var o=r(8954),s=r.n(o),a=r(186),n=r.n(a)()(s());n.push([e.id,"code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}","",{version:3,sources:["webpack://./../../../../../node_modules/prismjs/themes/prism-tomorrow.min.css"],names:[],mappings:"AAAA,6CAA6C,UAAU,CAAC,cAAc,CAAC,iEAAiE,CAAC,aAAa,CAAC,eAAe,CAAC,eAAe,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,eAAe,CAAC,eAAe,CAAC,aAAa,CAAC,UAAU,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,YAAY,CAAC,sBAAsB,WAAW,CAAC,aAAa,CAAC,aAAa,CAAC,uDAAuD,kBAAkB,CAAC,iCAAiC,YAAY,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,8EAA8E,UAAU,CAAC,mBAAmB,UAAU,CAAC,4DAA4D,aAAa,CAAC,qBAAqB,aAAa,CAAC,6CAA6C,aAAa,CAAC,gEAAgE,aAAa,CAAC,6EAA6E,aAAa,CAAC,yEAAyE,aAAa,CAAC,yCAAyC,aAAa,CAAC,6BAA6B,eAAe,CAAC,cAAc,iBAAiB,CAAC,cAAc,WAAW,CAAC,gBAAgB,WAAW",sourcesContent:["code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}"],sourceRoot:""}]);const i=n},3440:(e,t,r)=>{"use strict";const o=r(4708);e.exports=(e,t,r)=>new o(e,r).compare(new o(t,r))},3542:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var o=r(3241),s=r(24);class a{static parseResponseValues(e,t,r){const s=[];if(!e)return s;for(let a=0;a<e.value.length;a++)if(!(0,o.find)(s,["value",(0,o.get)(e.value[a],r)])){const n=(0,o.get)(e.value[a],r),i=(0,o.get)(e.value[a],t,n);s.push({text:i,value:n})}return s}static parseMetadata(e,t){const r=["None","Average","Minimum","Maximum","Total","Count"],o=null==e?void 0:e.value.find((e=>e.name.value===t));return o?{primaryAggType:o.primaryAggregationType,supportedAggTypes:o.supportedAggregationTypes||r,supportedTimeGrains:[{label:"Auto",value:"auto"},...a.parseTimeGrains(null!==(s=o.metricAvailabilities)&&void 0!==s?s:[])],dimensions:a.parseDimensions(null!==(n=o.dimensions)&&void 0!==n?n:[])}:{primaryAggType:"",supportedAggTypes:r,supportedTimeGrains:[],dimensions:[]};var s,n}static parseTimeGrains(e){const t=[];return e?(e.forEach((e=>{e.timeGrain&&t.push({label:s.A.createTimeGrainFromISO8601Duration(e.timeGrain),value:e.timeGrain})})),t):t}static parseDimensions(e){return e.map((e=>({label:e.localizedValue||e.value,value:e.value})))}static parseSubscriptions(e){const t=[];if(!e)return t;const r="subscriptionId";for(let s=0;s<e.value.length;s++)(0,o.find)(t,["value",(0,o.get)(e.value[s],r)])||t.push({text:`${(0,o.get)(e.value[s],"displayName")}`,value:(0,o.get)(e.value[s],r)});return t}static parseSubscriptionsForSelect(e){const t=[];if(!e)return t;const r="subscriptionId";for(let s=0;s<e.data.value.length;s++)(0,o.find)(t,["value",(0,o.get)(e.data.value[s],r)])||t.push({label:`${(0,o.get)(e.data.value[s],"displayName")} - ${(0,o.get)(e.data.value[s],r)}`,value:(0,o.get)(e.data.value[s],r)});return t}static parseLocations(e){const t=[];if(!e)return t;for(const r of e.value)t.push({name:r.name,displayName:r.displayName,supportsLogs:void 0});return t}}},3559:(e,t,r)=>{"use strict";const o=r(7565);e.exports=(e,t)=>e.sort(((e,r)=>o(e,r,t)))},3769:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var o=r(5959),s=r(5910);const a=({children:e})=>o.createElement(s.C,{gap:.5,direction:"column"},e)},3789:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var o=r(5959);const s=function(e){(0,o.useEffect)(e,[])}},3808:e=>{"use strict";const t=/^[0-9]+$/,r=(e,r)=>{const o=t.test(e),s=t.test(r);return o&&s&&(e=+e,r=+r),e===r?0:o&&!s?-1:s&&!o?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},3833:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t,r)=>o(e,t,r)>=0},3963:(e,t,r)=>{"use strict";r.a(e,(async(e,o)=>{try{r.r(t),r.d(t,{plugin:()=>g});r(9866);var s=r(7781),a=r(1874),n=r(8531),i=r(5777),c=r(5740),l=r(894),u=r(2533),d=r(5111),p=r(5098);function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){m(e,t,r[t])}))}return e}function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function h(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}await(0,a.wR)(u.id);const g=new s.DataSourcePlugin(l.A).setConfigEditor(i._).setQueryEditor(c.A);(0,n.getAppEvents)().subscribe(s.DashboardLoadedEvent,(({payload:{dashboardId:e,orgId:t,userId:r,grafanaVersion:o,queries:s}})=>{const a=s[u.id],n={hidden:0,visible:0,multiResource:0,count:0};let i={[p.o.AzureMonitor]:f({},n),[p.o.LogAnalytics]:h(f({},n),{grafanaTime:0,queryTime:0}),[p.o.AzureResourceGraph]:f({},n),[p.o.AzureTraces]:h(f({},n),{table:0,trace:0,operationIdSpecified:0,eventTypesSpecified:0,filtersSpecified:0}),[p.o.SubscriptionsQuery]:f({},n),[p.o.ResourceGroupsQuery]:f({},n),[p.o.NamespacesQuery]:f({},n),[p.o.ResourceNamesQuery]:f({},n),[p.o.MetricNamesQuery]:f({},n),[p.o.WorkspacesQuery]:f({},n),[p.o.GrafanaTemplateVariableFn]:f({},n),[p.o.LocationsQuery]:f({},n),unknown:f({},n)};a.forEach((e=>{var t,r,o;e.queryType===p.o.AzureMonitor&&(i[p.o.AzureMonitor][e.hide?"hidden":"visible"]++,(null===(t=e.azureMonitor)||void 0===t?void 0:t.resources)&&e.azureMonitor.resources.length>1&&i[p.o.AzureMonitor].multiResource++);e.queryType===p.o.LogAnalytics&&(i[p.o.LogAnalytics][e.hide?"hidden":"visible"]++,i[p.o.LogAnalytics][(null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.dashboardTime)?"grafanaTime":"queryTime"]++,(null===(o=e.azureLogAnalytics)||void 0===o?void 0:o.resources)&&e.azureLogAnalytics.resources.length>1&&i[p.o.LogAnalytics].multiResource++);switch(e.queryType===p.o.AzureResourceGraph&&(i[p.o.AzureResourceGraph][e.hide?"hidden":"visible"]++,e.subscriptions&&e.subscriptions.length>1&&i[p.o.AzureResourceGraph].multiResource++),e.queryType===p.o.AzureTraces&&(i[p.o.AzureTraces][e.hide?"hidden":"visible"]++,e.azureTraces&&(e.azureTraces.resultFormat&&i[p.o.AzureTraces][e.azureTraces.resultFormat===p.f.Trace?p.f.Trace:p.f.Table]++,e.azureTraces.resources&&e.azureTraces.resources.length>1&&i[p.o.AzureTraces].multiResource++,e.azureTraces.operationId&&""!==e.azureTraces.operationId&&i[p.o.AzureTraces].operationIdSpecified++,e.azureTraces.traceTypes&&e.azureTraces.traceTypes.length>0&&i[p.o.AzureTraces].eventTypesSpecified++,e.azureTraces.filters&&e.azureTraces.filters.length>0&&i[p.o.AzureTraces].filtersSpecified++)),e.queryType){case p.o.AzureMonitor:case p.o.LogAnalytics:case p.o.AzureResourceGraph:case p.o.AzureTraces:case p.o.SubscriptionsQuery:case p.o.ResourceGroupsQuery:case p.o.NamespacesQuery:case p.o.ResourceNamesQuery:case p.o.MetricNamesQuery:case p.o.WorkspacesQuery:case p.o.GrafanaTemplateVariableFn:case p.o.LocationsQuery:i[e.queryType].count++;break;default:i.unknown.count++}})),a&&a.length>0&&(0,d.c)({grafana_version:o,dashboard_id:e,org_id:t,azure_monitor_queries:i[p.o.AzureMonitor].visible,azure_monitor_queries_hidden:i[p.o.AzureMonitor].hidden,azure_monitor_multiple_resource:i[p.o.AzureMonitor].multiResource,azure_monitor_query:i[p.o.AzureMonitor].count,azure_log_analytics_queries:i[p.o.LogAnalytics].visible,azure_log_analytics_queries_hidden:i[p.o.LogAnalytics].hidden,azure_log_multiple_resource:i[p.o.LogAnalytics].multiResource,azure_log_analytics_queries_grafana_time:i[p.o.LogAnalytics].grafanaTime,azure_log_analytics_queries_query_time:i[p.o.LogAnalytics].queryTime,azure_log_query:i[p.o.LogAnalytics].count,azure_resource_graph_queries:i[p.o.AzureResourceGraph].visible,azure_resource_graph_queries_hidden:i[p.o.AzureResourceGraph].hidden,azure_resource_graph_multiple_subscription:i[p.o.AzureResourceGraph].multiResource,azure_resource_graph_query:i[p.o.AzureResourceGraph].count,azure_traces_queries:i[p.o.AzureTraces].visible,azure_traces_queries_hidden:i[p.o.AzureTraces].hidden,azure_traces_multiple_resource:i[p.o.AzureTraces].multiResource,azure_traces_table:i[p.o.AzureTraces].table,azure_traces_trace:i[p.o.AzureTraces].trace,azure_traces_operation_id_specified:i[p.o.AzureTraces].operationIdSpecified,azure_traces_event_type_specified:i[p.o.AzureTraces].eventTypesSpecified,azure_traces_filters:i[p.o.AzureTraces].filtersSpecified,azure_traces_query:i[p.o.AzureTraces].count,azure_subscriptions_query:i[p.o.SubscriptionsQuery].count,azure_resource_groups_query:i[p.o.ResourceGroupsQuery].count,azure_namespaces_query:i[p.o.NamespacesQuery].count,azure_resource_names_query:i[p.o.ResourceNamesQuery].count,azure_metric_names_query:i[p.o.MetricNamesQuery].count,azure_workspaces_query:i[p.o.WorkspacesQuery].count,azure_grafana_template_variable_query:i[p.o.GrafanaTemplateVariableFn].count,azure_locations_query:i[p.o.LocationsQuery].count,azure_unknown_query:i.unknown.count})})),o()}catch(v){o(v)}}),1)},4173:(e,t,r)=>{"use strict";function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),s.forEach((function(t){o(e,t,r[t])}))}return e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function n(e,t){var r;return(null===(r=e.azureMonitor)||void 0===r?void 0:r.customNamespace)===t?e:(null==t?void 0:t.toLowerCase().startsWith("microsoft.storage/storageaccounts/"))?a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{metricNamespace:t,metricName:void 0,aggregation:void 0,timeGrain:"",dimensionFilters:[]})}):a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{customNamespace:t,metricName:void 0,aggregation:void 0,timeGrain:"",dimensionFilters:[]})})}function i(e,t){var r;return(null===(r=e.azureMonitor)||void 0===r?void 0:r.metricName)===t?e:a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{metricName:t,aggregation:void 0,timeGrain:"",dimensionFilters:[]})})}function c(e,t){var r;return(null===(r=e.azureMonitor)||void 0===r?void 0:r.aggregation)===t?e:a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{aggregation:t})})}function l(e,t){var r;return(null===(r=e.azureMonitor)||void 0===r?void 0:r.timeGrain)===t?e:a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{timeGrain:t})})}function u(e,t){var r;return(null===(r=e.azureMonitor)||void 0===r?void 0:r.dimensionFilters)===t?e:a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{dimensionFilters:t})})}function d(e,t="",r="eq",o=[]){var s,a;return u(e,[...null!==(a=null===(s=e.azureMonitor)||void 0===s?void 0:s.dimensionFilters)&&void 0!==a?a:[],{dimension:t,operator:r,filters:o}])}function p(e,t){var r;return(null===(r=e.azureMonitor)||void 0===r?void 0:r.top)===t?e:a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{top:t})})}function m(e,t){var r;return(null===(r=e.azureMonitor)||void 0===r?void 0:r.alias)===t?e:a(s({},e),{azureMonitor:a(s({},e.azureMonitor),{alias:t})})}r.d(t,{Ik:()=>p,Jk:()=>l,LD:()=>d,Zp:()=>n,cJ:()=>u,gU:()=>m,pv:()=>c,st:()=>i})},4256:(e,t,r)=>{"use strict";const o=r(4708);e.exports=(e,t,r=!1)=>{if(e instanceof o)return e;try{return new o(e,t)}catch(e){if(!r)return null;throw e}}},4272:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},4326:(e,t,r)=>{"use strict";r.d(t,{c:()=>n});var o=r(6089),s=r(5959),a=(r(7781),r(2007));const n=e=>{var t;const{label:r,optional:o,tooltip:n,tooltipInteractive:c,children:l,width:u,...d}=e,p=(0,a.useStyles2)(i,u),m=(null==d?void 0:d.htmlFor)||(null==(t=a.ReactUtils)?void 0:t.getChildId(l)),f=s.createElement(s.Fragment,null,s.createElement("label",{className:p.label,htmlFor:m},r,o&&s.createElement("span",{className:p.optional}," - optional"),n&&s.createElement(a.Tooltip,{placement:"top",content:n,theme:"info",interactive:c},s.createElement(a.Icon,{tabIndex:0,name:"info-circle",size:"sm",className:p.icon}))),s.createElement(a.Space,{v:.5}));return s.createElement("div",{className:p.root},s.createElement(a.Field,{className:p.field,label:f,...d},l))},i=(e,t)=>({root:(0,o.css)({minWidth:e.spacing(null!=t?t:0)}),label:(0,o.css)({fontSize:12,fontWeight:e.typography.fontWeightMedium}),optional:(0,o.css)({fontStyle:"italic",color:e.colors.text.secondary}),field:(0,o.css)({marginBottom:0}),icon:(0,o.css)({color:e.colors.text.secondary,marginLeft:e.spacing(1),":hover":{color:e.colors.text.primary}})})},4513:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var o,s,a;if(Array.isArray(t)){if((o=t.length)!=r.length)return!1;for(s=o;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((o=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=o;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=o;0!=s--;){var n=a[s];if(!e(t[n],r[n]))return!1}return!0}return t!=t&&r!=r}},4624:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t,r)=>o(e,t,r)<=0},4708:(e,t,r)=>{"use strict";const o=r(1064),{MAX_LENGTH:s,MAX_SAFE_INTEGER:a}=r(2074),{safeRe:n,t:i}=r(5750),c=r(9547),{compareIdentifiers:l}=r(3808);class u{constructor(e,t){if(t=c(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>s)throw new TypeError(`version is longer than ${s} characters`);o("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?n[i.LOOSE]:n[i.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<a)return t}return e})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(o("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],s=e.prerelease[t];if(o("prerelease compare",t,r,s),void 0===r&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===r)return-1;if(r!==s)return l(r,s)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const r=this.build[t],s=e.build[t];if(o("build compare",t,r,s),void 0===r&&void 0===s)return 0;if(void 0===s)return 1;if(void 0===r)return-1;if(r!==s)return l(r,s)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?n[i.PRERELEASELOOSE]:n[i.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let o=this.prerelease.length;for(;--o>=0;)"number"==typeof this.prerelease[o]&&(this.prerelease[o]++,o=-2);if(-1===o){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let o=[t,e];!1===r&&(o=[t]),0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},4745:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},4811:e=>{"use strict";var t={};e.exports=function(e,r){var o=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(r)}},4831:e=>{"use strict";e.exports=u},4952:(e,t,r)=>{"use strict";const o=r(4256);e.exports=(e,t)=>{const r=o(e,null,!0),s=o(t,null,!0),a=r.compare(s);if(0===a)return null;const n=a>0,i=n?r:s,c=n?s:r,l=!!i.prerelease.length;if(!!c.prerelease.length&&!l){if(!c.patch&&!c.minor)return"major";if(0===c.compareMain(i))return c.minor&&!c.patch?"minor":"patch"}const u=l?"pre":"";return r.major!==s.major?u+"major":r.minor!==s.minor?u+"minor":r.patch!==s.patch?u+"patch":"prerelease"}},4991:(e,t,r)=>{"use strict";const o=r(1409),s=r(6031),a=r(9308),n=r(3833),i=r(2083),c=r(4624);e.exports=(e,t,r,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return o(e,r,l);case"!=":return s(e,r,l);case">":return a(e,r,l);case">=":return n(e,r,l);case"<":return i(e,r,l);case"<=":return c(e,r,l);default:throw new TypeError(`Invalid operator: ${t}`)}}},5098:(e,t,r)=>{"use strict";r.d(t,{f:()=>o.fW,o:()=>o.oj});var o=r(3292)},5111:(e,t,r)=>{"use strict";r.d(t,{c:()=>s});var o=r(8531);const s=e=>{(0,o.reportInteraction)("grafana_ds_azuremonitor_dashboard_loaded",e)}},5130:(e,t,r)=>{"use strict";r.d(t,{A:()=>N});var o=r(9728),s=r(6089),a=r(5959),n=r(1874),i=r(2007),c=r(6344),l=r(3241),u=r(3789),d=r(7781),p=r(8531),m=r(5340),f=r(6063);const b=({resources:e,onChange:t,renderAdvanced:r})=>{const[s,l]=(0,a.useState)(!!e.length&&JSON.stringify(e).includes("$"));return(0,o.jsx)("div",{"data-testid":c.T.components.queryEditor.resourcePicker.advanced.collapse,children:(0,o.jsxs)(i.Collapse,{collapsible:!0,label:(0,n.t)("components.advanced-multi.label-advanced","Advanced"),isOpen:s,onToggle:()=>l(!s),children:[r(e,t),(0,o.jsx)(i.Space,{v:2})]})})};var h=r(8785);const g=({isOpen:e,entry:{type:t}})=>{switch(t){case h.X.Subscription:return(0,o.jsx)(i.Icon,{name:"layer-group"});case h.X.ResourceGroup:return(0,o.jsx)(i.Icon,{name:e?"folder-open":"folder"});case h.X.Resource:return(0,o.jsx)(i.Icon,{name:"cube"});case h.X.VariableGroup:case h.X.Variable:return(0,o.jsx)(i.Icon,{name:"x"});default:return null}},v=e=>({table:(0,s.css)({width:"100%",tableLayout:"fixed",overflow:"scroll"}),scrollableTable:(0,s.css)({overflow:"auto"}),tableScroller:(0,s.css)({maxHeight:"35vh"}),selectedTableScroller:(0,s.css)({maxHeight:"35vh"}),header:(0,s.css)({background:e.colors.background.secondary}),row:(0,s.css)({borderBottom:`1px solid ${e.colors.border.weak}`,"&:last-of-type":{borderBottomColor:e.colors.border.medium}}),disabledRow:(0,s.css)({opacity:.5}),cell:(0,s.css)({padding:e.spacing(1,1,1,0),width:"25%",overflow:"hidden",textOverflow:"ellipsis","&:first-of-type":{width:"50%",padding:e.spacing(1,1,1,2)}}),collapseButton:(0,s.css)({margin:0}),loadingCell:(0,s.css)({textAlign:"center"}),spinner:(0,s.css)({marginBottom:0}),nestedEntry:(0,s.css)({display:"flex",alignItems:"center"}),entryContentItem:(0,s.css)({margin:e.spacing(0,1,0,0)}),truncated:(0,s.css)({minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),resourceField:(0,s.css)({maxWidth:e.spacing(36),overflow:"hidden"}),resourceFieldButton:(0,s.css)({padding:"7px",textAlign:"left"}),nestedRowCheckbox:(0,s.css)({zIndex:0}),selectionFooter:(0,s.css)({background:e.colors.background.primary,paddingTop:e.spacing(2)}),loadingWrapper:(0,s.css)({textAlign:"center",paddingTop:e.spacing(2),paddingBottom:e.spacing(2),color:e.colors.text.secondary}),resultLimit:(0,s.css)({margin:"4px 0",fontStyle:"italic"}),modal:(0,s.css)({width:e.breakpoints.values.lg,maxHeight:"80vh"}),filterInput:e=>(0,s.css)({width:"metrics"===e?"30%":"50%",marginTop:"10px"})}),y=({entry:e,isSelected:t,isDisabled:r,isOpen:n,isSelectable:c,level:l,scrollIntoView:u,onToggleCollapse:d,onSelectedChange:p})=>{const m=(0,i.useTheme2)(),f=(0,i.useStyles2)(v),b=!!e.children,h=(0,a.useCallback)((()=>{d(e)}),[d,e]),y=(0,a.useCallback)((t=>{const r=t.target.checked;p(e,r)}),[e,p]),w=`${u?"table":"summary"}_checkbox_${e.uri}`;return(0,a.useEffect)((()=>{var e;t&&u&&(null===(e=document.getElementById(w))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}))}),[]),(0,o.jsxs)("div",{className:f.nestedEntry,style:{marginLeft:l*(3*m.spacing.gridSize)},children:[b?(0,o.jsx)(i.IconButton,{className:f.collapseButton,name:n?"angle-down":"angle-right","aria-label":n?`Collapse ${e.name}`:`Expand ${e.name}`,onClick:h,id:e.id}):(0,o.jsx)(i.Space,{layout:"inline",h:2}),(0,o.jsx)(i.Space,{layout:"inline",h:2}),c&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.Checkbox,{id:w,onChange:y,disabled:r,value:t,className:f.nestedRowCheckbox}),(0,o.jsx)(i.Space,{layout:"inline",h:2})]}),(0,o.jsx)(g,{entry:e,isOpen:n}),(0,o.jsx)(i.Space,{layout:"inline",h:1}),(0,o.jsx)("label",{htmlFor:w,className:(0,s.cx)(f.entryContentItem,f.truncated),children:e.name})]})};var w=r(9580);function O(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}const j=({row:e,selectedRows:t,level:r,requestNestedRows:c,onRowSelectedChange:l,selectableEntryTypes:u,scrollIntoView:d,disableRow:p})=>{const m=(0,i.useStyles2)(v),[f,b]=(0,a.useState)("closed"),g=!!t.find((t=>t.uri.toLowerCase()===e.uri.toLowerCase())),S=!g&&p(e,t),x="open"===f,k=(0,w.U4)(e.uri);var A,P;return(0,a.useEffect)((()=>{const r=t[0];var o;r&&!!(0,w.uv)(null!==(o=e.children)&&void 0!==o?o:[],r.uri)&&b("open")}),[t,e]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("tr",{className:(0,s.cx)(m.row,S&&m.disabledRow),children:[(0,o.jsx)("td",{className:m.cell,title:e.name,children:(0,o.jsx)(y,{level:r,isSelected:g,isDisabled:S,isOpen:x,entry:e,onToggleCollapse:()=>{return(t=function*(){"open"!==f?(b("loading"),c(e).then((()=>b("open"))).catch((()=>b("closed")))):b("closed")},function(){var e=this,r=arguments;return new Promise((function(o,s){var a=t.apply(e,r);function n(e){O(a,o,s,n,i,"next",e)}function i(e){O(a,o,s,n,i,"throw",e)}n(void 0)}))})();var t},onSelectedChange:l,isSelectable:u.some((t=>t===e.type)),scrollIntoView:d})}),(0,o.jsx)("td",{className:m.cell,title:k.resourceGroup&&e.type===h.X.Resource?k.resourceGroup:"-",children:k.resourceGroup&&e.type===h.X.Resource?k.resourceGroup:"-"}),(0,o.jsx)("td",{className:m.cell,title:e.typeLabel,children:e.typeLabel}),(0,o.jsx)("td",{className:m.cell,title:null!==(A=e.location)&&void 0!==A?A:"-",children:null!==(P=e.location)&&void 0!==P?P:"-"})]},e.id),x&&e.children&&Object.keys(e.children).length>0&&e.children.map((e=>(0,o.jsx)(j,{row:e,selectedRows:t,level:r+1,requestNestedRows:c,onRowSelectedChange:l,selectableEntryTypes:u,scrollIntoView:d,disableRow:p},e.uri))),(0,o.jsx)(i.FadeTransition,{visible:"loading"===f,children:(0,o.jsx)("tr",{children:(0,o.jsx)("td",{className:(0,s.cx)(m.cell,m.loadingCell),colSpan:3,children:(0,o.jsx)(i.LoadingPlaceholder,{text:(0,n.t)("components.nested-row.text-loading","Loading..."),className:m.spinner})})})})]})},S=j,x=({searchFn:e})=>{const[t,r]=(0,a.useState)(""),s=(0,a.useMemo)((()=>(0,l.debounce)(e,600)),[e]);return(0,a.useEffect)((()=>()=>{s.cancel()}),[s]),(0,o.jsx)(i.Input,{"aria-label":(0,n.t)("components.search.aria-label-resource-search","Resource search"),prefix:(0,o.jsx)(i.Icon,{name:"search"}),value:t,onChange:e=>{const t=e.currentTarget.value;r(t),s(t)},placeholder:(0,n.t)("components.search.placeholder-resource-search","Search for a resource"),"data-testid":c.T.components.queryEditor.resourcePicker.search.input,style:{marginBottom:"10px"}})};function k(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function A(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){k(a,o,s,n,i,"next",e)}function i(e){k(a,o,s,n,i,"throw",e)}n(void 0)}))}}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const E=e=>`grafana.datasources.azuremonitor.recent-resources.${e}`,z=({resourcePickerData:e,resources:t,datasource:r,onApply:h,onCancel:g,selectableEntryTypes:y,queryType:O,disableRow:j,renderAdvanced:k,selectionNotice:z})=>{const C=(0,i.useStyles2)(v),[T,D]=(0,a.useState)(!1),[N,I]=(0,a.useState)([]),[R,L]=(0,a.useState)([]),[M,q]=(0,a.useState)(t),[$,G]=(0,a.useState)(void 0),[F,_]=(0,a.useState)(!1),V=null==z?void 0:z(R),[B,Q]=(0,a.useState)([]),[U,X]=(0,a.useState)(!1),[W,H]=(0,a.useState)([]),[K,J]=(0,a.useState)(!1),[Z,Y]=(0,a.useState)([]),[ee,te]=(0,a.useState)(!1),[re,oe]=(0,a.useState)({subscriptions:[],types:[],locations:[]}),[se,ae]=(0,a.useState)("picker");(0,a.useEffect)((()=>{q(t)}),[t]);const ne=(0,a.useCallback)((()=>A((function*(){X(!0);const e=yield r.getSubscriptions();if(Q(e.map((e=>({label:e.text,value:e.value})))),X(!1),"metrics"===O){var t;J(!0);const o=yield r.getMetricNamespaces((null===(t=e[0])||void 0===t?void 0:t.value)||r.getDefaultSubscriptionId());H(null==o?void 0:o.map((e=>({label:m.De[e.value.toLowerCase()]||e.value,value:e.value})))),J(!1)}te(!0);const o=yield r.getLocations(e.map((e=>e.value)).slice(0,3));Y(Array.from(o.values()).map((e=>({label:e.displayName,value:e.name})))),te(!1)}))()),[r,O]),ie=(0,a.useCallback)((()=>A((function*(){if(!T){try{D(!0);const t=yield e.fetchInitialRows(O,(0,w._Z)(null!=M?M:{}));I(t)}catch(e){G((0,f.A)(e))}D(!1)}}))()),[M,T,e,O]);(0,u.A)((()=>{ie(),p.config.featureToggles.azureResourcePickerUpdates&&ne()}));const ce=e=>"string"==typeof e?""!==e:e.subscription&&e.resourceGroup&&e.resourceName&&e.metricNamespace;(0,a.useEffect)((()=>{M||L([]);const t=M.filter((e=>ce(e))),r=M&&(0,w.bs)(N,(0,w.xt)(t));return(null==t?void 0:t.length)>r.length?L(e.parseRows(t)):r&&r.length?L(r):L([])}),[M,N,e]);const le=(0,a.useCallback)((t=>A((function*(){var r;if(G(void 0),!(null===(r=t.children)||void 0===r?void 0:r.length))try{const r=yield e.fetchAndAppendNestedRow(N,t,O,re);I(r)}catch(e){throw G((0,f.A)(e)),e}}))()),[e,N,O,re]),ue=(0,a.useCallback)(((e,t)=>{if(t){const t="logs"===O?e.uri:(0,w._Z)([e.uri],e.location)[0],r=M?M.concat(t):[t];q(r.filter((e=>ce(e))))}else{const t=null==M?void 0:M.filter((t=>!(0,w.Ux)((0,w.zj)(t),e.uri)));q(t)}}),[O,M,q]),de=(0,a.useCallback)((()=>{M&&h("logs"===O?M:(0,w._Z)(M))}),[O,M,h]),pe=(0,a.useCallback)(((e,t)=>{if(M){t((0,l.uniqBy)([...R,...e],"id").slice(0,30)),h("logs"===O?M:(0,w._Z)(M))}}),[O,M,R,h]),me=(0,a.useCallback)((t=>A((function*(){if(G(void 0),_(!1),t){try{D(!0);const r=yield e.search(t,O,re);I(r),r.length>=e.resultLimit&&_(!0)}catch(e){G((0,f.A)(e))}D(!1)}else ie()}))()),[ie,e,O,re]),fe=(0,a.useCallback)((t=>A((function*(){try{D(!0);const r=yield e.fetchInitialRows(O,void 0,t);I(r)}catch(e){G((0,f.A)(e))}D(!1)}))()),[e,O]),be=(e,t)=>{const r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){P(e,t,r[t])}))}return e}({},re),o=e.map((e=>e.value));switch(t){case"subscriptions":r.subscriptions=o;break;case"types":r.types=o;break;case"locations":r.locations=o}oe(r),(0,p.reportInteraction)("grafana_ds_azuremonitor_resource_picker_filters",{subscriptionsFilters:r.subscriptions.length,typesFilters:r.types.length,locationsFilters:r.locations.length}),0!==r.subscriptions.length||0!==r.types.length||0!==r.locations.length?fe(r):ie()},he=e=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("table",{className:C.table,children:(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{className:(0,s.cx)(C.row,C.header),children:[(0,o.jsx)("td",{className:C.cell,children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.header-scope",children:"Scope"})}),(0,o.jsx)("td",{className:C.cell,children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.header-resource-group",children:"Resource Group"})}),(0,o.jsx)("td",{className:C.cell,children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.header-type",children:"Type"})}),(0,o.jsx)("td",{className:C.cell,children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.header-location",children:"Location"})})]})})}),(0,o.jsx)("div",{className:(0,s.cx)(C.scrollableTable,C.tableScroller),children:(0,o.jsx)("table",{className:C.table,children:(0,o.jsxs)("tbody",{children:[T&&(0,o.jsx)("tr",{className:(0,s.cx)(C.row),children:(0,o.jsx)("td",{className:C.cell,children:(0,o.jsx)(i.LoadingPlaceholder,{text:(0,n.t)("components.resource-picker.text-loading","Loading...")})})}),!T&&0===(null==e?void 0:e.length)&&(0,o.jsx)("tr",{className:(0,s.cx)(C.row),children:(0,o.jsx)("td",{className:C.cell,"aria-live":"polite",children:"picker"===se?(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.text-no-resources",children:"No resources found"}):(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.text-no-recent-resources",children:"No recent resources found"})})}),!T&&(null==e?void 0:e.map((e=>(0,o.jsx)(S,{row:e,selectedRows:R,level:0,requestNestedRows:le,onRowSelectedChange:ue,selectableEntryTypes:y,scrollIntoView:!0,disableRow:j},e.uri))))]})})}),(0,o.jsxs)("footer",{className:C.selectionFooter,children:[R.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h5",{children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.heading-selection",children:"Selection"})}),(0,o.jsx)("div",{className:(0,s.cx)(C.scrollableTable,C.selectedTableScroller),children:(0,o.jsx)("table",{className:C.table,children:(0,o.jsx)("tbody",{children:R.map((e=>(0,o.jsx)(S,{row:e,selectedRows:R,level:0,requestNestedRows:le,onRowSelectedChange:ue,selectableEntryTypes:y,disableRow:()=>!1},e.uri)))})})}),(0,o.jsx)(i.Space,{v:2}),(null==V?void 0:V.length)?(0,o.jsx)(i.Alert,{title:"",severity:"info",children:V}):null]}),"picker"===se&&(0,o.jsx)(b,{resources:M,onChange:e=>q(e),renderAdvanced:k}),$&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.Space,{v:2}),(0,o.jsx)(i.Alert,{severity:"error",title:(0,n.t)("components.resource-picker.title-error-occurred","An error occurred while requesting resources from Azure Monitor"),children:$})]})]})]}),ge=(t,r)=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(x,{searchFn:me}),p.config.featureToggles.azureResourcePickerUpdates&&(0,o.jsxs)(i.Stack,{direction:"row",alignItems:"flex-start",justifyContent:"space-between",gap:1,children:[(0,o.jsx)(i.Field,{label:(0,n.t)("components.resource-picker.subscriptions-filter","Subscriptions"),noMargin:!0,className:C.filterInput(O),children:(0,o.jsx)(i.MultiCombobox,{"aria-label":(0,n.t)("components.resource-picker.subscriptions-filter","Subscriptions"),value:re.subscriptions,options:B,onChange:e=>be(e,"subscriptions"),isClearable:!0,enableAllOption:!0,loading:U,"data-testid":c.T.components.queryEditor.resourcePicker.filters.subscription.input,placeholder:(0,n.t)("components.resource-picker.subscriptions-filter-placeholder","Select a subscription")})}),"metrics"===O&&(0,o.jsx)(i.Field,{label:(0,n.t)("components.resource-picker.types-filter","Resource Types"),noMargin:!0,className:C.filterInput(O),children:(0,o.jsx)(i.MultiCombobox,{"aria-label":(0,n.t)("components.resource-picker.types-filter","Resource Types"),value:re.types,options:W,onChange:e=>be(e,"types"),isClearable:!0,enableAllOption:!0,loading:K,"data-testid":c.T.components.queryEditor.resourcePicker.filters.type.input,placeholder:(0,n.t)("components.resource-picker.types-filter-placeholder","Select a resource type")})}),(0,o.jsx)(i.Field,{label:(0,n.t)("components.resource-picker.locations-filter","Locations"),noMargin:!0,className:C.filterInput(O),children:(0,o.jsx)(i.MultiCombobox,{"aria-label":(0,n.t)("components.resource-picker.locations-filter","Locations"),value:re.locations,options:Z,onChange:e=>be(e,"locations"),isClearable:!0,enableAllOption:!0,loading:ee,"data-testid":c.T.components.queryEditor.resourcePicker.filters.location.input,placeholder:(0,n.t)("components.resource-picker.locations-filter-placeholder","Select a location")})})]}),F?(0,o.jsx)("p",{className:C.resultLimit,children:(0,o.jsxs)(n.x6,{i18nKey:"components.resource-picker.result-limit",values:{numResults:e.resultLimit},children:["Showing first ","{{numResults}}"," results"]})}):(0,o.jsx)(i.Space,{v:2}),he(N),(0,o.jsxs)(i.Modal.ButtonRow,{children:[(0,o.jsx)(i.Button,{onClick:g,variant:"secondary",fill:"outline",children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.button-cancel",children:"Cancel"})}),(0,o.jsx)(i.Button,{disabled:!!$||!M.every(ce),onClick:r&&t?()=>pe(t,r):de,"data-testid":c.T.components.queryEditor.resourcePicker.apply.button,children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.button-apply",children:"Apply"})})]})]});return p.config.featureToggles.azureResourcePickerUpdates?(0,o.jsx)(d.LocalStorageValueProvider,{storageKey:E(O),defaultValue:[],children:(e,t)=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.TabsBar,{children:[(0,o.jsx)(i.Tab,{label:(0,n.t)("components.resource-picker.browse-tab","Browse"),active:"picker"===se,onChangeTab:()=>ae("picker")},"picker"),(0,o.jsx)(i.Tab,{label:(0,n.t)("components.resource-picker.recent-tab","Recent"),active:"recent"===se,onChangeTab:()=>{(0,p.reportInteraction)("grafana_ds_azuremonitor_resource_picker_recent_used",{recentResourcesCount:e.length}),ae("recent")}},"recent")]}),(0,o.jsxs)(i.TabContent,{style:{margin:"10px"},children:["picker"===se&&ge(e,t),"recent"===se&&(0,o.jsxs)(o.Fragment,{children:[he(e),(0,o.jsxs)(i.Modal.ButtonRow,{children:[(0,o.jsx)(i.Button,{onClick:g,variant:"secondary",fill:"outline",children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.button-cancel",children:"Cancel"})}),(0,o.jsx)(i.Button,{disabled:!!$||!M.every(ce),onClick:de,"data-testid":c.T.components.queryEditor.resourcePicker.apply.button,children:(0,o.jsx)(n.x6,{i18nKey:"components.resource-picker.button-apply",children:"Apply"})})]})]})]})]})}):ge()};var C=r(7809);const T=({resources:e,datasource:t})=>{const[r,s]=(0,a.useState)((0,w._Z)(e));return(0,a.useEffect)((()=>{s((0,w._Z)(e))}),[e]),e.length?(0,o.jsx)(D,{resources:r}):(0,o.jsx)(n.x6,{i18nKey:"components.resource-label.select-resource",children:"Select a resource"})},D=({resources:e})=>{const t=(0,i.useStyles2)(v);let r="cube";const a=[];return e.forEach((e=>{if(!e.resourceName)return e.resourceGroup?(r="folder",void a.push(e.resourceGroup)):e.subscription?(r="layer-group",void a.push(e.subscription)):void 0;a.push(e.resourceName.split("/")[0])})),(0,o.jsxs)("span",{className:(0,s.cx)(t.truncated,t.resourceField),children:[(0,o.jsx)(i.Icon,{name:r}),a.join(", ")]})},N=({query:e,datasource:t,onQueryChange:r,selectableEntryTypes:s,queryType:l,resources:u,inlineField:d,labelWidth:p,disableRow:m,renderAdvanced:f,selectionNotice:b})=>{const h=(0,i.useStyles2)(v),[g,y]=(0,a.useState)(!1),O=(0,a.useCallback)((()=>{y(!0)}),[]),j=(0,a.useCallback)((()=>{y(!1)}),[]),S=(0,a.useCallback)((t=>{r((0,w.e8)(e,l,t)),j()}),[j,r,e,l]);return(0,o.jsxs)("span",{"data-testid":c.T.components.queryEditor.resourcePicker.select.button,children:[(0,o.jsx)(i.Modal,{className:h.modal,title:(0,n.t)("components.resource-field.title-select-resource","Select a resource"),isOpen:g,onDismiss:j,trapFocus:!1,children:(0,o.jsx)(z,{resourcePickerData:t.resourcePickerData,resources:u,onApply:S,onCancel:j,selectableEntryTypes:s,queryType:l,disableRow:m,renderAdvanced:f,selectionNotice:b,datasource:t})}),(0,o.jsx)(C.D,{label:(0,n.t)("components.resource-field.label-resource","Resource"),inlineField:d,labelWidth:p,children:(0,o.jsx)(i.Button,{className:h.resourceFieldButton,variant:"secondary",onClick:O,type:"button",children:(0,o.jsx)(T,{resources:u,datasource:t})})})]})}},5229:(e,t,r)=>{"use strict";const o=r(4708);e.exports=(e,t)=>new o(e,t).patch},5340:(e,t,r)=>{"use strict";r.d(t,{AU:()=>a,De:()=>o,Jo:()=>s});const o={"84codes.cloudamqp/servers":"CloudAMQP","citrix.services/xenappessentials":"Citrix Virtual Apps Essentials","citrix.services/xendesktopessentials":"Citrix Virtual Desktops Essentials","dynatrace.observability/monitors":"Dynatrace","github.enterprise/accounts":"GitHub AE","livearena.broadcast/services":"LiveArena Broadcast","mailjet.email/services":"Mailjet Email Service","microsoft.aad/domainservices":"Azure AD Domain Services","microsoft.aadiam/privatelinkforazuread":"Private Link for Azure AD","microsoft.agfoodplatform/farmbeats":"Azure FarmBeats","microsoft.analysisservices/servers":"Analysis Services","microsoft.anybuild/clusters":"AnyBuild clusters","microsoft.apimanagement/service":"API Management services","microsoft.appconfiguration/configurationstores":"App Configuration","microsoft.appplatform/spring":"Azure Spring Cloud","microsoft.attestation/attestationproviders":"Attestation providers","microsoft.authorization/resourcemanagementprivatelinks":"Resource management private links","microsoft.automation/automationaccounts":"Automation Accounts","microsoft.automation/automationaccounts/runbooks":"Runbook","microsoft.autonomoussystems/workspaces":"Bonsai","microsoft.avs/privateclouds":"AVS Private clouds","microsoft.azureactivedirectory/b2cdirectories":"B2C Tenants","microsoft.azureactivedirectory/guestusages":"Guest Usages","microsoft.azurearcdata/datacontrollers":"Azure Arc data controllers","microsoft.azurearcdata/postgresinstances":"Azure Arc-enabled PostgreSQL Hyperscale server groups","microsoft.azurearcdata/sqlmanagedinstances":"SQL managed instances - Azure Arc","microsoft.azurearcdata/sqlserverinstances":"SQL Server - Azure Arc","microsoft.azuredata/sqlserverregistrations":"SQL Server registries","microsoft.azurepercept/accounts":"Azure Percept accounts","microsoft.azurestack/registrations":"Azure Stack Hubs","microsoft.azurestackhci/clusters":"Azure Stack HCI","microsoft.azurestackhci/virtualmachines":"Azure Stack HCI virtual machine - Azure Arc","microsoft.baremetal/crayservers":"Cray Servers","microsoft.baremetal/monitoringservers":"Monitoring Servers","microsoft.baremetalinfrastructure/baremetalinstances":"BareMetal Instances","microsoft.batch/batchaccounts":"Batch accounts","microsoft.bing/accounts":"Bing Resources","microsoft.blockchain/blockchainmembers":"Azure Blockchain Service","microsoft.blockchain/cordamembers":"Corda","microsoft.botservice/botservices":"Bot Services","microsoft.cache/redis":"Azure Cache for Redis","microsoft.cache/redisenterprise":"Redis Enterprise","microsoft.cdn/cdnwebapplicationfirewallpolicies":"Content Delivery Network WAF policies","microsoft.cdn/profiles":"(Front Doors Standard/Premium Preview)","microsoft.cdn/profiles/afdendpoints":"Endpoints","microsoft.cdn/profiles/endpoints":"Endpoints","microsoft.certificateregistration/certificateorders":"App Service Certificates","microsoft.chaos/chaosexperiments":"Chaos Experiments (Classic)","microsoft.chaos/experiments":"Chaos Experiments","microsoft.classiccompute/domainnames":"Cloud services (classic)","microsoft.classiccompute/virtualmachines":"Virtual machines (classic)","microsoft.classicnetwork/networksecuritygroups":"Network security groups (classic)","microsoft.classicnetwork/reservedips":"Reserved IP addresses (classic)","microsoft.classicnetwork/virtualnetworks":"Virtual networks (classic)","microsoft.classicstorage/storageaccounts":"Storage accounts (classic)","microsoft.cloudtest/accounts":"CloudTest Accounts","microsoft.cloudtest/hostedpools":"1ES Hosted Pools","microsoft.cloudtest/images":"CloudTest Images","microsoft.cloudtest/pools":"CloudTest Pools","microsoft.cognition/syntheticsaccounts":"Synthetics Accounts","microsoft.clusterstor/nodes":"ClusterStors","microsoft.cognitiveservices/accounts":"Cognitive Services","microsoft.compute/availabilitysets":"Availability sets","microsoft.compute/capacityreservationgroups":"Capacity Reservation Groups","microsoft.compute/cloudservices":"Cloud services (extended support)","microsoft.compute/diskaccesses":"Disk Accesses","microsoft.compute/diskencryptionsets":"Disk Encryption Sets","microsoft.compute/disks":"Disks","microsoft.compute/galleries":"Azure compute galleries","microsoft.compute/galleries/applications":"VM application definitions","microsoft.compute/galleries/applications/versions":"VM application versions","microsoft.compute/galleries/images":"VM image definitions","microsoft.compute/galleries/images/versions":"VM image versions","microsoft.compute/hostgroups":"Host groups","microsoft.compute/hostgroups/hosts":"Hosts","microsoft.compute/images":"Images","microsoft.compute/proximityplacementgroups":"Proximity placement groups","microsoft.compute/restorepointcollections":"Restore Point Collections","microsoft.compute/snapshots":"Snapshots","microsoft.compute/sshpublickeys":"SSH keys","microsoft.compute/virtualmachines":"Virtual machines","microsoft.compute/virtualmachinescalesets":"Virtual machine scale sets","microsoft.confidentialledger/ledgers":"Confidential Ledgers","microsoft.confluent/organizations":"Confluent organizations","microsoft.connectedcache/cachenodes":"Connected Cache Resources","microsoft.connectedcache/enterprisecustomers":"Connected Cache Resources","microsoft.connectedvehicle/platformaccounts":"Connected Vehicle Platforms","microsoft.connectedvmwarevsphere/vcenters":"VMware vCenters","microsoft.connectedvmwarevsphere/virtualmachines":"VMware + AVS virtual machines","microsoft.containerinstance/containergroups":"Container instances","microsoft.containerregistry/registries":"Container registries","microsoft.containerregistry/registries/replications":"Container registry replications","microsoft.containerregistry/registries/webhooks":"Container registry webhooks","microsoft.containerservice/managedclusters":"Kubernetes services","microsoft.dashboard/grafana":"Grafana Workspaces","microsoft.databox/jobs":"Azure Data Box","microsoft.databoxedge/databoxedgedevices":"Azure Stack Edge / Data Box Gateway","microsoft.databricks/workspaces":"Azure Databricks Services","microsoft.datacatalog/catalogs":"Data Catalog","microsoft.datacollaboration/workspaces":"Project CI","microsoft.datadog/monitors":"Datadog","microsoft.datafactory/datafactories":"Data factories","microsoft.datafactory/factories":"Data factories (V2)","microsoft.datalakeanalytics/accounts":"Data Lake Analytics","microsoft.datalakestore/accounts":"Data Lake Storage Gen1","microsoft.datamigration/services":"Azure Database Migration Services","microsoft.datamigration/services/projects":"Azure Database Migration Projects","microsoft.datamigration/sqlmigrationservices":"Azure Database Migration Services","microsoft.dataprotection/backupvaults":"Backup vaults","microsoft.dataprotection/resourceguards":"Resource Guards (Preview)","microsoft.datareplication/replicationvaults":"Site Recovery Vaults","microsoft.datashare/accounts":"Data Shares","microsoft.dbformariadb/servers":"Azure Database for MariaDB servers","microsoft.dbformysql/flexibleservers":"Azure Database for MySQL flexible servers","microsoft.dbformysql/servers":"Azure Database for MySQL servers","microsoft.dbforpostgresql/flexibleservers":"Azure Database for PostgreSQL flexible servers","microsoft.dbforpostgresql/servergroups":"Azure Database for PostgreSQL server groups","microsoft.dbforpostgresql/servergroupsv2":"Azure Database for PostgreSQL server groups","microsoft.dbforpostgresql/servers":"Azure Database for PostgreSQL servers","microsoft.dbforpostgresql/serversv2":"Azure Database for PostgreSQL servers v2","microsoft.deploymentmanager/rollouts":"Rollouts","microsoft.desktopvirtualization/applicationgroups":"Application groups","microsoft.desktopvirtualization/hostpools":"Host pools","microsoft.desktopvirtualization/scalingplans":"Scaling plans","microsoft.desktopvirtualization/workspaces":"Workspaces","microsoft.devices/iothubs":"IoT Hub","microsoft.devices/provisioningservices":"Device Provisioning Services","microsoft.deviceupdate/accounts":"Device Update for IoT Hubs","microsoft.devops/pipelines":"DevOps Starter","microsoft.devtestlab/labs":"DevTest Labs","microsoft.devtestlab/labs/virtualmachines":"Virtual machines","microsoft.digitaltwins/digitaltwinsinstances":"Azure Digital Twins","microsoft.documentdb/cassandraclusters":"Azure Managed Instance for Apache Cassandra","microsoft.documentdb/databaseaccounts":"Azure Cosmos DB accounts","microsoft.domainregistration/domains":"App Service Domains","microsoft.edgeorder/addresses":"Azure Edge Hardware Center Address","microsoft.edgeorder/orderitems":"Azure Edge Hardware Center","microsoft.elastic/monitors":"Elasticsearch (Elastic Cloud)","microsoft.eventgrid/domains":"Event Grid Domains","microsoft.eventgrid/partnernamespaces":"Event Grid Partner Namespaces","microsoft.eventgrid/partnerregistrations":"Event Grid Partner Registrations","microsoft.eventgrid/partnertopics":"Event Grid Partner Topics","microsoft.eventgrid/systemtopics":"Event Grid System Topics","microsoft.eventgrid/topics":"Event Grid Topics","microsoft.eventhub/clusters":"Event Hubs Clusters","microsoft.eventhub/namespaces":"Event Hubs Namespaces","microsoft.experimentation/experimentworkspaces":"Experiment Workspaces","microsoft.extendedlocation/customlocations":"Custom locations","microsoft.fidalgo/devcenters":"Fidalgo DevCenters","microsoft.fidalgo/networksettings":"Network Configurations","microsoft.fidalgo/projects":"Fidalgo Projects","microsoft.fidalgo/projects/environments":"Fidalgo Environments","microsoft.fluidrelay/fluidrelayservers":"Fluid Relay","microsoft.genomics/accounts":"Genomics accounts","microsoft.hanaonazure/hanainstances":"SAP HANA on Azure","microsoft.hanaonazure/sapmonitors":"Azure Monitors for SAP Solutions","microsoft.hdinsight/clusterpools":"HDInsight cluster pools","microsoft.hdinsight/clusterpools/clusters":"HDInsight gen2 clusters","microsoft.hdinsight/clusterpools/clusters/sessionclusters":"HDInsight session clusters","microsoft.hdinsight/clusters":"HDInsight clusters","microsoft.healthbot/healthbots":"Azure Health Bot","microsoft.healthcareapis/services":"Azure API for FHIR","microsoft.healthcareapis/workspaces":"Healthcare APIs Workspaces","microsoft.healthcareapis/workspaces/dicomservices":"DICOM services","microsoft.healthcareapis/workspaces/fhirservices":"FHIR services","microsoft.healthcareapis/workspaces/iotconnectors":"IoT connectors","microsoft.hpcworkbench/instances":"HPC Workbenches (preview)","microsoft.hpcworkbench/instances/chambers":"Chambers (preview)","microsoft.hpcworkbench/instances/chambers/accessprofiles":"Chamber Profiles (preview)","microsoft.hpcworkbench/instances/chambers/workloads":"Chamber VMs (preview)","microsoft.hpcworkbench/instances/consortiums":"Consortiums (preview)","microsoft.hybridcompute/machines":"Servers - Azure Arc","microsoft.hybridcompute/privatelinkscopes":"Azure Arc Private Link Scopes","microsoft.hybridcontainerservice/provisionedclusters":"Provisioned clusters","microsoft.hybriddata/datamanagers":"StorSimple Data Managers","microsoft.hybridnetwork/devices":"Azure Network Function Manager  Devices","microsoft.hybridnetwork/networkfunctions":"Azure Network Function Manager  Network Functions","microsoft.importexport/jobs":"Import/export jobs","microsoft.insights/components":"Application Insights","microsoft.insights/datacollectionendpoints":"Data collection endpoints","microsoft.insights/datacollectionrules":"Data collection rules","microsoft.insights/privatelinkscopes":"Azure Monitor Private Link Scopes","microsoft.insights/webtests":"Availability tests","microsoft.insights/workbooks":"Azure Workbooks","microsoft.insights/workbooktemplates":"Azure Workbook Templates","microsoft.intelligentitdigitaltwin/digitaltwins":"Minervas","microsoft.intelligentitdigitaltwin/digitaltwins/assets":"Assets","microsoft.intelligentitdigitaltwin/digitaltwins/executionplans":"Deployments","microsoft.intelligentitdigitaltwin/digitaltwins/testplans":"Suites","microsoft.intelligentitdigitaltwin/digitaltwins/tests":"Scripts","microsoft.iotcentral/iotapps":"IoT Central Applications","microsoft.keyvault/vaults":"Key vaults","microsoft.kubernetes/connectedclusters":"Kubernetes - Azure Arc","microsoft.kusto/clusters":"Azure Data Explorer Clusters","microsoft.kusto/clusters/databases":"Azure Data Explorer Databases","microsoft.labservices/labaccounts":"Lab Services","microsoft.labservices/labplans":"Lab plans","microsoft.labservices/labs":"Labs","microsoft.loadtestservice/loadtests":"Azure Load Testing","microsoft.logic/integrationaccounts":"Integration accounts","microsoft.logic/integrationserviceenvironments":"Integration Service Environments","microsoft.logic/integrationserviceenvironments/managedapis":"Managed Connector","microsoft.logic/workflows":"Logic apps","microsoft.logz/monitors":"Logz main account","microsoft.logz/monitors/accounts":"Logz sub account","microsoft.logz/monitors/metricssource":"Logz metrics data source","microsoft.machinelearning/commitmentplans":"Machine Learning Studio (classic) web service plans","microsoft.machinelearning/webservices":"Machine Learning Studio (classic) web services","microsoft.machinelearning/workspaces":"Machine Learning Studio (classic) workspaces","microsoft.machinelearningservices/workspaces":"Machine learning","microsoft.machinelearningservices/workspaces/onlineendpoints":"Machine learning online endpoints","microsoft.machinelearningservices/workspaces/onlineendpoints/deployments":"Machine learning online deployments","microsoft.maintenance/maintenanceconfigurations":"Maintenance Configurations","microsoft.managedidentity/userassignedidentities":"Managed Identities","microsoft.maps/accounts":"Azure Maps Accounts","microsoft.maps/accounts/creators":"Azure Maps Creator Resources","microsoft.marketplaceapps/classicdevservices":"Classic Dev Services","microsoft.media/mediaservices":"Media Services","microsoft.media/mediaservices/liveevents":"Live events","microsoft.media/mediaservices/streamingendpoints":"Streaming Endpoints","microsoft.media/videoanalyzers":"Video Analyzers","microsoft.migrate/projects":"Migration projects","microsoft.mixedreality/holographicsbroadcastaccounts":"Holographics Broadcast Accounts","microsoft.mixedreality/objectanchorsaccounts":"Object Anchors Accounts","microsoft.mixedreality/objectunderstandingaccounts":"Object Understanding Accounts","microsoft.mixedreality/remoterenderingaccounts":"Remote Rendering Accounts","microsoft.mixedreality/spatialanchorsaccounts":"Spatial Anchors Accounts","microsoft.mobilenetwork/mobilenetworks":"Mobile Networks","microsoft.mobilenetwork/mobilenetworks/datanetworks":"Data Networks","microsoft.mobilenetwork/mobilenetworks/services":"Services","microsoft.mobilenetwork/mobilenetworks/simpolicies":"Sim Policies","microsoft.mobilenetwork/mobilenetworks/sites":"Mobile Network Sites","microsoft.mobilenetwork/mobilenetworks/slices":"Slices","microsoft.mobilenetwork/packetcorecontrolplanes":"Packet Core Control Planes","microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes":"Packet Core Data Planes","microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes/attacheddatanetworks":"Attached Data Networks","microsoft.mobilenetwork/sims":"Sims","microsoft.netapp/netappaccounts":"NetApp accounts","microsoft.netapp/netappaccounts/capacitypools":"Capacity pools","microsoft.netapp/netappaccounts/capacitypools/volumes":"Volumes","microsoft.netapp/netappaccounts/capacitypools/volumes/snapshots":"Snapshots","microsoft.netapp/netappaccounts/snapshotpolicies":"Snapshot policies","microsoft.network/applicationgateways":"Application gateways","microsoft.network/applicationgatewaywebapplicationfirewallpolicies":"Application Gateway WAF policies","microsoft.network/applicationsecuritygroups":"Application security groups","microsoft.network/azurefirewalls":"Firewalls","microsoft.network/bastionhosts":"Bastions","microsoft.network/connections":"Connections","microsoft.network/customipprefixes":"Custom IP Prefixes","microsoft.network/ddosprotectionplans":"DDoS protection plans","microsoft.network/dnsforwardingrulesets":"Dns Forwarding Rulesets","microsoft.network/dnsresolvers":"DNS Private Resolvers","microsoft.network/dnszones":"DNS zones","microsoft.network/expressroutecircuits":"ExpressRoute circuits","microsoft.network/expressrouteports":"ExpressRoute Direct","microsoft.network/firewallpolicies":"Firewall Policies","microsoft.network/frontdoors":"Front Doors","microsoft.network/frontdoorwebapplicationfirewallpolicies":"Web Application Firewall policies (WAF)","microsoft.network/ipgroups":"IP Groups","microsoft.network/loadbalancers":"Load balancers","microsoft.network/localnetworkgateways":"Local network gateways","microsoft.network/natgateways":"NAT gateways","microsoft.network/networkexperimentprofiles":"Internet Analyzer profiles","microsoft.network/networkinterfaces":"Network interfaces","microsoft.network/networkmanagers":"Network Managers","microsoft.network/networksecuritygroups":"Network security groups","microsoft.network/networkwatchers":"Network Watchers","microsoft.network/networkwatchers/connectionmonitors":"Connection Monitors","microsoft.network/networkwatchers/flowlogs":"NSG Flow Logs","microsoft.network/privatednszones":"Private DNS zones","microsoft.network/privateendpoints":"Private endpoints","microsoft.network/privatelinkservices":"Private link services","microsoft.network/publicipaddresses":"Public IP addresses","microsoft.network/publicipprefixes":"Public IP Prefixes","microsoft.network/routefilters":"Route filters","microsoft.network/routetables":"Route tables","microsoft.network/serviceendpointpolicies":"Service endpoint policies","microsoft.network/trafficmanagerprofiles":"Traffic Manager profiles","microsoft.network/virtualnetworkgateways":"Virtual network gateways","microsoft.network/virtualnetworks":"Virtual networks","microsoft.network/virtualwans":"Virtual WANs","microsoft.notificationhubs/namespaces":"Notification Hub Namespaces","microsoft.notificationhubs/namespaces/notificationhubs":"Notification Hubs","microsoft.openenergyplatform/energyservices":"Azure OpenEnergy","microsoft.openlogisticsplatform/workspaces":"Open Supply Chain Platform","microsoft.operationalinsights/querypacks":"Log Analytics query packs","microsoft.operationalinsights/workspaces":"Log Analytics workspaces","microsoft.operationsmanagement/solutions":"Solutions","microsoft.orbital/contactprofiles":"Contact Profiles","microsoft.orbital/edgesites":"Edge Sites","microsoft.orbital/groundstations":"Ground Stations","microsoft.orbital/l2connections":"L2 Connections","microsoft.orbital/spacecrafts":"Spacecrafts","microsoft.peering/peerings":"Peerings","microsoft.peering/peeringservices":"Peering Services","microsoft.playfab/playeraccountpools":"Player account pools","microsoft.playfab/titles":"PlayFab titles","microsoft.portal/dashboards":"Shared dashboards","microsoft.powerbidedicated/capacities":"Power BI Embedded","microsoft.purview/accounts":"Purview accounts","microsoft.quantum/workspaces":"Quantum Workspaces","microsoft.recommendationsservice/accounts":"Intelligent Recommendations Accounts","microsoft.recommendationsservice/accounts/modeling":"Modeling","microsoft.recommendationsservice/accounts/serviceendpoints":"Service Endpoints","microsoft.recoveryservices/vaults":"Recovery Services vaults","microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems":"Backup Items","microsoft.redhatopenshift/openshiftclusters":"Azure Red Hat OpenShift","microsoft.relay/namespaces":"Relays","microsoft.resourceconnector/appliances":"Resource bridges","microsoft.resourcegraph/queries":"Resource Graph queries","microsoft.resources/deploymentscripts":"Deployment Scripts","microsoft.resources/subscriptions":"Subscriptions","microsoft.resources/subscriptions/resourcegroups":"Resource groups","microsoft.resources/templatespecs":"Template specs","microsoft.saas/applications":"Software as a Service (classic)","microsoft.saas/resources":"SaaS","microsoft.scheduler/jobcollections":"Scheduler Job Collections","microsoft.scom/managedinstances":"Aquila Instances","microsoft.scvmm/virtualmachines":"SCVMM virtual machine - Azure Arc","microsoft.scvmm/vmmservers":"SCVMM management servers","microsoft.search/searchservices":"Search services","microsoft.security/insights/classification":"Data Sensitivity Security Insights (Preview)","microsoft.security/locations/alerts":"Security Alerts","microsoft.securitydetonation/chambers":"Security Detonation Chambers","microsoft.servicebus/namespaces":"Service Bus Namespaces","microsoft.servicefabric/clusters":"Service Fabric clusters","microsoft.servicefabric/managedclusters":"Service Fabric managed clusters","microsoft.serviceshub/connectors":"Services Hub Connectors","microsoft.signalrservice/signalr":"SignalR","microsoft.signalrservice/webpubsub":"Web PubSub Service","microsoft.solutions/applicationdefinitions":"Service catalog managed application definitions","microsoft.solutions/applications":"Managed applications","microsoft.sql/instancepools":"Instance pools","microsoft.sql/managedinstances":"SQL managed instances","microsoft.sql/managedinstances/databases":"Managed databases","microsoft.sql/servers":"SQL servers","microsoft.sql/servers/databases":"SQL databases","microsoft.sql/servers/elasticpools":"SQL elastic pools","microsoft.sql/servers/jobagents":"Elastic Job agents","microsoft.sql/virtualclusters":"Virtual clusters","microsoft.sqlvirtualmachine/sqlvirtualmachines":"SQL virtual machines","microsoft.storage/storageaccounts":"Storage accounts","microsoft.storagecache/amlfilesystems":"Lustre File Systems","microsoft.storagecache/caches":"HPC caches","microsoft.storagepool/diskpools":"Disk Pools","microsoft.storagesync/storagesyncservices":"Storage Sync Services","microsoft.storagesyncdev/storagesyncservices":"Storage Sync Services","microsoft.storagesyncint/storagesyncservices":"Storage Sync Services","microsoft.storsimple/managers":"StorSimple Device Managers","microsoft.streamanalytics/clusters":"Stream Analytics clusters","microsoft.streamanalytics/streamingjobs":"Stream Analytics jobs","microsoft.synapse/privatelinkhubs":"Azure Synapse Analytics (private link hubs)","microsoft.synapse/workspaces":"Azure Synapse Analytics","microsoft.synapse/workspaces/bigdatapools":"Apache Spark pools","microsoft.synapse/workspaces/kustopools":"Data Explorer pools (preview)","microsoft.synapse/workspaces/sqlpools":"Dedicated SQL pools","microsoft.testbase/testbaseaccounts":"Test Base Accounts","microsoft.testbase/testbaseaccounts/packages":"Test Base Packages","microsoft.timeseriesinsights/environments":"Time Series Insights environments","microsoft.timeseriesinsights/environments/eventsources":"Time Series Insights event sources","microsoft.timeseriesinsights/environments/referencedatasets":"Time Series Insights reference data sets","microsoft.videoindexer/accounts":"Video Analyzer for Media","microsoft.virtualmachineimages/imagetemplates":"Image Templates","microsoft.visualstudio/account":"Azure DevOps organizations","microsoft.visualstudio/account/project":"DevOps Starter","microsoft.vmwarecloudsimple/dedicatedcloudnodes":"CloudSimple Nodes","microsoft.vmwarecloudsimple/dedicatedcloudservices":"CloudSimple Services","microsoft.vmwarecloudsimple/virtualmachines":"CloudSimple Virtual Machines","microsoft.vsonline/plans":"Visual Studio Online Plans","microsoft.web/connectiongateways":"On-premises data gateways","microsoft.web/connections":"API Connections","microsoft.web/containerapps":"Container Apps","microsoft.web/customapis":"Logic Apps Custom Connector","microsoft.web/hostingenvironments":"App Service Environments","microsoft.web/kubeenvironments":"App Service Kubernetes Environments","microsoft.web/serverfarms":"App Service plans","microsoft.web/sites":"App Services","microsoft.web/sites/slots":"App Service (Slots)","microsoft.web/staticsites":"Static Web Apps","microsoft.windowsesu/multipleactivationkeys":"Windows Multiple Activation Keys","microsoft.windowsiot/deviceservices":"Windows 10 IoT Core Services","microsoft.workloads/monitors":"Azure Monitors for SAP Solutions (v2)","microsoft.workloads/phpworkloads":"Scalable WordPress on Linux","microsoft.workloads/sapvirtualinstances":"SAP Virtual Instances","microsoft.workloads/sapvirtualinstances/applicationinstances":"SAP app server instances","microsoft.workloads/sapvirtualinstances/centralinstances":"SAP central server instances","microsoft.workloads/sapvirtualinstances/databaseinstances":"SAP database server instances","nginx.nginxplus/nginxdeployments":"NGINX Deployment","paraleap.cloudmonix/services":"CloudMonix","pokitdok.platform/services":"PokitDok Platform","providers.test/statefulibizaengines":"My Resources","ravenhq.db/databases":"RavenHQ","raygun.crashreporting/apps":"Raygun","sendgrid.email/accounts":"SendGrid Accounts","trendmicro.deepsecurity/accounts":"Deep Security SaaS","wandisco.fusion/fusiongroups":"LiveData Planes","wandisco.fusion/fusiongroups/azurezones":"Azure Zones","wandisco.fusion/fusiongroups/azurezones/plugins":"Plugins","wandisco.fusion/fusiongroups/hivereplicationrules":"Hive Replication Rules","wandisco.fusion/fusiongroups/managedonpremzones":"On-premises Zones","wandisco.fusion/fusiongroups/replicationrules":"Replication Rules","wandisco.fusion/migrators":"LiveData Migrators","wandisco.fusion/migrators/exclusiontemplates":"Exclusions","wandisco.fusion/migrators/livedatamigrations":"Migrations","wandisco.fusion/migrators/metadatamigrations":"Metadata Migrations","wandisco.fusion/migrators/metadatatargets":"Metadata Targets","wandisco.fusion/migrators/pathmappings":"Path Mappings","wandisco.fusion/migrators/targets":"Targets"},s={"microsoft.cache/redis":!0,"microsoft.documentdb/mongoclusters":!0,"microsoft.dbforpostgresql/flexibleservers":!0,"microsoft.storagecache/amlfilesystems":!0,"microsoft.monitor/accounts":!0,"microsoft.databoxedge/databoxedgedevices":!0,"microsoft.azurestackhci/clusters":!0,"microsoft.dataprotection/backupvaults":!0,"microsoft.networkcloud/baremetalmachines":!0,"microsoft.netapp/netappaccounts/capacitypools":!0,"microsoft.netapp/netappaccounts/capacitypools/volumes":!0,"microsoft.network/networkwatchers/connectionmonitors":!0,"microsoft.keyvault/vaults":!0,"microsoft.recoveryservices/vaults":!0,"microsoft.sql/servers/databases":!0,"microsoft.sql/servers/elasticpools":!0,"microsoft.compute/virtualmachinescalesets":!0,"microsoft.compute/virtualmachines":!0,"microsoft.signalrservice/webpubsub":!0},a=["microsoft.aad/domainservices","microsoft.aadiam/azureadmetrics","microsoft.analysisservices/servers","microsoft.apimanagement/service","microsoft.app/containerapps","microsoft.app/jobs","microsoft.app/managedenvironments","microsoft.appconfiguration/configurationstores","microsoft.appplatform/spring","microsoft.automation/automationaccounts","microsoft.avs/privateclouds","microsoft.azuresphere/catalogs","microsoft.azurestackhci/clusters","microsoft.azurestackresourcemonitor/storageaccountmonitor","microsoft.batch/batchaccounts","microsoft.batchai/workspaces","microsoft.bing/accounts","microsoft.botservice/botservices","microsoft.botservice/botservices/channels","microsoft.botservice/botservices/connections","microsoft.botservice/checknameavailability","microsoft.botservice/hostsettings","microsoft.botservice/listauthserviceproviders","microsoft.botservice/listqnamakerendpointkeys","microsoft.cache/redis","microsoft.cache/redisenterprise","microsoft.cdn/cdnwebapplicationfirewallpolicies","microsoft.cdn/profiles","microsoft.classiccompute/domainnames","microsoft.classiccompute/domainnames/slots/roles","microsoft.classiccompute/virtualmachines","microsoft.classicstorage/storageaccounts","microsoft.classicstorage/storageaccounts/blobservices","microsoft.classicstorage/storageaccounts/fileservices","microsoft.classicstorage/storageaccounts/queueservices","microsoft.classicstorage/storageaccounts/tableservices","microsoft.cloudtest/hostedpools","microsoft.cloudtest/pools","microsoft.clusterstor/nodes","microsoft.codesigning/codesigningaccounts","microsoft.cognitiveservices/accounts","microsoft.communication/communicationservices","microsoft.compute/cloudservices","microsoft.compute/cloudservices/roles","microsoft.compute/disks","microsoft.compute/virtualmachines","microsoft.compute/virtualmachinescalesets","microsoft.compute/virtualmachinescalesets/virtualmachines","microsoft.connectedcache/cachenodes","microsoft.connectedcache/enterprisemcccustomers","microsoft.connectedcache/ispcustomers","microsoft.connectedvehicle/platformaccounts","microsoft.containerinstance/containergroups","microsoft.containerinstance/containerscalesets","microsoft.containerregistry/registries","microsoft.containerservice/managedclusters","microsoft.customerinsights/hubs","microsoft.customproviders/resourceproviders","microsoft.dashboard/grafana","microsoft.databoxedge/databoxedgedevices","microsoft.databricks/workspaces","microsoft.datacollaboration/workspaces","microsoft.datafactory/datafactories","microsoft.datafactory/factories","microsoft.datalakeanalytics/accounts","microsoft.datalakestore/accounts","microsoft.dataprotection/backupvaults","microsoft.datashare/accounts","microsoft.dbformariadb/servers","microsoft.dbformysql/flexibleservers","microsoft.dbformysql/servers","microsoft.dbforpostgresql/flexibleservers","microsoft.dbforpostgresql/servergroupsv2","microsoft.dbforpostgresql/servers","microsoft.dbforpostgresql/serversv2","microsoft.devcenter/devcenters","microsoft.devices/iothubs","microsoft.devices/provisioningservices","microsoft.devopsinfrastructure/pools","microsoft.digitaltwins/digitaltwinsinstances","microsoft.documentdb/cassandraclusters","microsoft.documentdb/databaseaccounts","microsoft.documentdb/mongoclusters","microsoft.edgezones/edgezones","microsoft.elasticsan/elasticsans","microsoft.enterpriseknowledgegraph/services","microsoft.eventgrid/domains","microsoft.eventgrid/eventsubscriptions","microsoft.eventgrid/extensiontopics","microsoft.eventgrid/namespaces","microsoft.eventgrid/partnernamespaces","microsoft.eventgrid/partnertopics","microsoft.eventgrid/systemtopics","microsoft.eventgrid/topics","microsoft.eventhub/clusters","microsoft.eventhub/namespaces","microsoft.fabric.admin/fabriclocations","microsoft.hdinsight/clusters","microsoft.healthcareapis/services","microsoft.healthcareapis/workspaces/dicomservices","microsoft.healthcareapis/workspaces/fhirservices","microsoft.healthcareapis/workspaces/iotconnectors","microsoft.healthmodel/healthmodels","microsoft.hybridcontainerservice/provisionedclusters","microsoft.hybridnetwork/networkfunctions","microsoft.hybridnetwork/virtualnetworkfunctions","microsoft.insights/autoscalesettings","microsoft.insights/components","microsoft.insights/datacollectionrules","microsoft.iotcentral/iotapps","microsoft.iotspaces/graph","microsoft.keyvault/managedhsms","microsoft.keyvault/vaults","microsoft.kubernetes/connectedclusters","microsoft.kubernetesconfiguration/extensions","microsoft.kusto/clusters","microsoft.logic/integrationserviceenvironments","microsoft.logic/workflows","microsoft.machinelearningservices/workspaces","microsoft.machinelearningservices/workspaces/onlineendpoints","microsoft.machinelearningservices/workspaces/onlineendpoints/deployments","microsoft.managednetworkfabric/internetgateways","microsoft.managednetworkfabric/l2isolationdomains","microsoft.managednetworkfabric/l3isolationdomains","microsoft.managednetworkfabric/networkdevices","microsoft.maps/accounts","microsoft.media/mediaservices","microsoft.media/mediaservices/liveevents","microsoft.media/mediaservices/streamingendpoints","microsoft.media/videoanalyzers","microsoft.messagingconnectors/connectors","microsoft.mixedreality/remoterenderingaccounts","microsoft.mixedreality/spatialanchorsaccounts","microsoft.mobilenetwork/mobilenetworks/sites","microsoft.mobilenetwork/packetcorecontrolplanes","microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes","microsoft.mobilenetwork/radioaccessnetworks","microsoft.monitor/accounts","microsoft.netapp/netappaccounts/capacitypools","microsoft.netapp/netappaccounts/capacitypools/volumes","microsoft.network/applicationgateways","microsoft.network/azurefirewalls","microsoft.network/bastionhosts","microsoft.network/connections","microsoft.network/dnsforwardingrulesets","microsoft.network/dnsresolverpolicies","microsoft.network/dnsresolvers","microsoft.network/dnszones","microsoft.network/expressroutecircuits","microsoft.network/expressroutecircuits/peerings","microsoft.network/expressroutegateways","microsoft.network/expressrouteports","microsoft.network/frontdoors","microsoft.network/loadbalancers","microsoft.network/natgateways","microsoft.network/networkinterfaces","microsoft.network/networkmanagers/ipampools","microsoft.network/networkvirtualappliances","microsoft.network/networkwatchers","microsoft.network/networkwatchers/connectionmonitors","microsoft.network/p2svpngateways","microsoft.network/privatednszones","microsoft.network/privateendpoints","microsoft.network/privatelinkservices","microsoft.network/publicipaddresses","microsoft.network/publicipprefixes","microsoft.network/trafficmanagerprofiles","microsoft.network/virtualhubs","microsoft.network/virtualnetworkgateways","microsoft.network/virtualnetworks","microsoft.network/virtualrouters","microsoft.network/vpngateways","microsoft.networkanalytics/dataconnectors","microsoft.networkcloud/baremetalmachines","microsoft.networkcloud/clustermanagers","microsoft.networkcloud/clusters","microsoft.networkcloud/storageappliances","microsoft.networkfunction/azuretrafficcollectors","microsoft.notificationhubs/namespaces/notificationhubs","microsoft.operationalinsights/workspaces","microsoft.operationsmanagement/solutions","microsoft.orbital/contactprofiles","microsoft.orbital/l2connections","microsoft.orbital/spacecrafts","microsoft.orbital/terminals","microsoft.peering/peerings","microsoft.peering/peeringservices","microsoft.playfab/titles","microsoft.powerbidedicated/capacities","microsoft.providerhub/providermonitorsettings","microsoft.purview/accounts","microsoft.recoveryservices/vaults","microsoft.relay/namespaces","microsoft.resources/subscriptions","microsoft.search/searchservices","microsoft.securitydetonation/chambers","microsoft.securitydetonation/securitydetonationchambers","microsoft.servicebus/namespaces","microsoft.servicefabricmesh/applications","microsoft.servicenetworking/trafficcontrollers","microsoft.signalrservice/signalr","microsoft.signalrservice/signalr/replicas","microsoft.signalrservice/webpubsub","microsoft.signalrservice/webpubsub/replicas","microsoft.singularity/accounts","microsoft.sql/managedinstances","microsoft.sql/servers/databases","microsoft.sql/servers/elasticpools","microsoft.sql/servers/jobagents","microsoft.storageactions/storagetasks","microsoft.storage/storageaccounts","microsoft.storage/storageaccounts/blobservices","microsoft.storage/storageaccounts/fileservices","microsoft.storage/storageaccounts/objectreplicationpolicies","microsoft.storage/storageaccounts/queueservices","microsoft.storage/storageaccounts/storagetasks","microsoft.storage/storageaccounts/tableservices","microsoft.storage/storagetasks","microsoft.storagecache/amlfilesystems","microsoft.storagecache/caches","microsoft.storagemover/storagemovers","microsoft.storagesync/storagesyncservices","microsoft.storagetasks/storagetasks","microsoft.streamanalytics/streamingjobs","microsoft.synapse/workspaces","microsoft.synapse/workspaces/bigdatapools","microsoft.synapse/workspaces/kustopools","microsoft.synapse/workspaces/scopepools","microsoft.synapse/workspaces/sqlpools","microsoft.timeseriesinsights/environments","microsoft.timeseriesinsights/environments/eventsources","microsoft.vmwarecloudsimple/virtualmachines","microsoft.voiceservices/communicationsgateways","microsoft.web/containerapps","microsoft.web/hostingenvironments","microsoft.web/hostingenvironments/multirolepools","microsoft.web/hostingenvironments/workerpools","microsoft.web/serverfarms","microsoft.web/sites","microsoft.web/sites/slots","microsoft.web/staticsites","nginx.nginxplus/nginxdeployments","oracle.database/autonomousdatabases","oracle.database/cloudvmclusters","oracle.database/exadbvmclusters","private.messagingconnectors/private.messagingconnectors/connectors","wandisco.fusion/migrators","wandisco.fusion/migrators/datatransferagents","wandisco.fusion/migrators/livedatamigrations","wandisco.fusion/migrators/metadatamigrations"]},5699:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t)=>o(e,t,!0)},5740:(e,t,r)=>{"use strict";r.d(t,{A:()=>xt});var o=r(9728),s=r(3241),a=r(5959),n=r(3789),i=r(7781),c=r(1874),l=r(8531),u=r(2007),d=r(6344),p=r(5098),m=r(8495),f=r(8840),b=r(2356),h=r(6089),g=r(8146),v=r.n(g);function y({query:e,lang:t,className:r}){const s=(0,u.useTheme2)(),a=w(s),n=v().highlight(e,t.grammar,t.name);return(0,o.jsx)("div",{className:(0,h.cx)(a.editorField,"prism-syntax-highlight",r),"aria-label":(0,c.t)("components.raw-query.aria-label-selector","Selector"),dangerouslySetInnerHTML:{__html:n}})}const w=e=>({editorField:(0,h.css)({fontFamily:e.typography.fontFamilyMonospace,fontSize:e.typography.bodySmall.fontSize})}),O=[{label:"isValidIp",detail:"isValidIp(fieldname)",documentation:"Returns true if the field is a valid v4 or v6 IP address."},{label:"isValidIpV4",detail:"isValidIpV4(fieldname)",documentation:"Returns true if the field is a valid v4 IP address."},{label:"isValidIpV6",detail:"isValidIpV6(fieldname)",documentation:"Returns true if the field is a valid v6 IP address."},{label:"isIpInSubnet",detail:"isIpInSubnet(fieldname, string)",documentation:"Returns true if the field is a valid v4 or v6 IP address within the specified v4 or v6 subnet."},{label:"isIpv4InSubnet",detail:"isIpv4InSubnet(fieldname, string)",documentation:"Returns true if the field is a valid v4 IP address within the specified v4 subnet."},{label:"isIpv6InSubnet",detail:"isIpv6InSubnet(fieldname, string)",documentation:"Returns true if the field is a valid v6 IP address within the specified v6 subnet."}],j=[{label:"avg",detail:"avg(NumericFieldname)",documentation:"The average of the values in the specified field."},{label:"count",detail:"count(fieldname) or count(*)",documentation:"Counts the log records."},{label:"count_distinct",detail:"count_distinct(fieldname)",documentation:"Returns the number of unique values for the field."},{label:"max",detail:"max(fieldname)",documentation:"The maximum of the values for this log field in the queried logs."},{label:"min",detail:"min(fieldname)",documentation:"The minimum of the values for this log field in the queried logs."},{label:"pct",detail:"pct(fieldname, value)",documentation:"A percentile indicates the relative standing of a value in a datas."},{label:"stddev",detail:"stddev(NumericFieldname)",documentation:"The standard deviation of the values in the specified field."},{label:"sum",detail:"sum(NumericFieldname)",documentation:"The sum of the values in the specified field."},{label:"earliest",detail:"earliest(fieldname)",documentation:"Returns the value of fieldName from the log event that has the earliest time stamp in the queried logs."},{label:"latest",detail:"latest(fieldname)",documentation:"Returns the value of fieldName from the log event that has the latest time stamp in the queried logs."},{label:"sortsFirst",detail:"sortsFirst(fieldname)",documentation:"Returns the value of fieldName that sorts first in the queried logs."},{label:"sortsLast",detail:"sortsLast(fieldname)",documentation:"Returns the value of fieldName that sorts last in the queried logs."}],S=[...[{label:"abs",detail:"abs(a)",documentation:"Absolute value."},{label:"ceil",detail:"ceil(a)",documentation:"Round to ceiling (the smallest integer that is greater than the value of a)."},{label:"floor",detail:"floor(a)",documentation:"Round to floor (the largest integer that is smaller than the value of a)."},{label:"greatest",detail:"greatest(a,b, ... z)",documentation:"Returns the largest value."},{label:"least",detail:"least(a, b, ... z)",documentation:"Returns the smallest value."},{label:"log",detail:"log(a)",documentation:"Natural logarithm."},{label:"sqrt",detail:"sqrt(a)",documentation:"Square root."},{label:"ispresent",detail:"ispresent(fieldname)",documentation:"Returns true if the field exists."},{label:"coalesce",detail:"coalesce(fieldname1, fieldname2, ... fieldnamex)",documentation:"Returns the first non-null value from the list."},{label:"isempty",detail:"isempty(fieldname)",documentation:"Returns true if the field is missing or is an empty string."},{label:"isblank",detail:"isblank(fieldname)",documentation:"Returns true if the field is missing, an empty string, or contains only white space."},{label:"concat",detail:"concat(string1, string2, ... stringz)",documentation:"Concatenates the strings."},{label:"ltrim",detail:"ltrim(string) or ltrim(string1, string2)",documentation:"Remove white space from the left of the string. If the function has a second string argument, it removes the characters of string2 from the left of string1."},{label:"rtrim",detail:"rtrim(string) or rtrim(string1, string2)",documentation:"Remove white space from the right of the string. If the function has a second string argument, it removes the characters of string2 from the right of string1."},{label:"trim",detail:"trim(string) or trim(string1, string2)",documentation:"Remove white space from both ends of the string. If the function has a second string argument, it removes the characters of string2 from both sides of string1."},{label:"strlen",detail:"strlen(string)",documentation:"Returns the length of the string in Unicode code points."},{label:"toupper",detail:"toupper(string)",documentation:"Converts the string to uppercase."},{label:"tolower",detail:"tolower(string)",documentation:"Converts the string to lowercase."},{label:"substr",detail:"substr(string1, x), or substr(string1, x, y)",documentation:"Returns a substring from the index specified by the number argument to the end of the string. If the function has a second number argument, it contains the length of the substring to be retrieved."},{label:"replace",detail:"replace(string1, string2, string3)",documentation:"Replaces all instances of string2 in string1 with string3."},{label:"strcontains",detail:"strcontains(string1, string2)",documentation:"Returns 1 if string1 contains string2 and 0 otherwise."},{label:"bin",detail:"bin(period)",documentation:"Rounds the value of @timestamp to the given period and then truncates."},{label:"datefloor",detail:"datefloor(a, period)",documentation:"Truncates the timestamp to the given period."},{label:"dateceil",detail:"dateceil(a, period)",documentation:"Rounds up the timestamp to the given period and then truncates."},{label:"fromMillis",detail:"fromMillis(fieldname)",documentation:"Interprets the input field as the number of milliseconds since the Unix epoch and converts it to a timestamp."},{label:"toMillis",detail:"toMillis(fieldname)",documentation:"Converts the timestamp found in the named field into a number representing the milliseconds since the Unix epoch."},...O],...j],x={comment:{pattern:/^#.*/,greedy:!0},backticks:{pattern:/`.*?`/,alias:"string",greedy:!0},quote:{pattern:/".*?"/,alias:"string",greedy:!0},regex:{pattern:/\/.*?\/(?=\||\s*$|,)/,greedy:!0},"query-command":{pattern:new RegExp(`\\b(?:${[{label:"fields",documentation:"Retrieves the specified fields from log events"},{label:"display",documentation:"Specifies which fields to display in the query results"},{label:"filter",documentation:"Filters the results of a query based on one or more conditions"},{label:"stats",documentation:"Calculates aggregate statistics based on the values of log fields"},{label:"sort",documentation:"Sorts the retrieved log events"},{label:"limit",documentation:"Specifies the number of log events returned by the query"},{label:"parse",documentation:"Extracts data from a log field, creating one or more ephemeral fields that you can process further in the query"}].map((e=>e.label)).join("|")})\\b`,"i"),alias:"function"},function:{pattern:new RegExp(`\\b(?:${S.map((e=>e.label)).join("|")})\\b`,"i")},keyword:{pattern:new RegExp(`(\\s+)(${["as","like","by","in","desc","asc"].join("|")})(?=\\s+)`,"i"),lookbehind:!0},"log-group-name":{pattern:/[\.\-_/#A-Za-z0-9]+/},"field-name":{pattern:/(@?[_a-zA-Z]+[_.0-9a-zA-Z]*)|(`((\\`)|([^`]))*?`)/,greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,"command-separator":{pattern:/\|/,alias:"punctuation"},"comparison-operator":{pattern:/([<>]=?)|(!?=)/},punctuation:/[{}()`,.]/,whitespace:/\s+/};function k(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){A(e,t,r[t])}))}return e}function E(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const z=e=>{const[t,r]=(0,a.useState)(null),[s,n]=(0,a.useState)({}),[i,d]=(0,a.useState)(null),[m,f]=(0,a.useState)(!0),[b,h]=(0,a.useState)(""),g=(0,u.useStyles2)(C),v={grammar:x,name:"kql"},w=(0,a.useMemo)((()=>t?Object.keys(t).map((e=>({label:e,value:e}))):[]),[t]),O=()=>{return(t=function*(){yield e.datasource.getAzureLogAnalyticsCheatsheetQueries().then((e=>{e.categories.sort(((e,t)=>e.displayName.toLowerCase()===t.displayName.toLowerCase()?0:e.displayName.toLowerCase()<t.displayName.toLowerCase()?-1:1));const t=e.categories.reduce(((t,r)=>{const o=r.related.queries.map((t=>e.queries.find((e=>e.id===t))));return t[r.displayName]=o,n(E(P({},s),{[r.id]:!1})),t}),{});return r(t),d(t),f(!1),t}))},function(){var e=this,r=arguments;return new Promise((function(o,s){var a=t.apply(e,r);function n(e){k(a,o,s,n,i,"next",e)}function i(e){k(a,o,s,n,i,"throw",e)}n(void 0)}))})();var t};(0,a.useEffect)((()=>{t||O()}));return(0,o.jsx)("div",{children:!m&&i?(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:g.filterAlignment,children:[(0,o.jsx)(u.Input,{value:b,onChange:e=>{h(e.currentTarget.value);const r=(e=>{const r=Object.keys(i);if(e.length>0&&t){const o=Object.keys(t).reduce(((o,s)=>{const a=t[s].filter((t=>t.displayName.toLowerCase().includes(e.toLowerCase())));return r.includes(s)&&(o[s]=a),o}),{});return d(o),o}return Object.keys(i).length!==Object.keys(t).length?(d(i),i):(d(t),t)})(e.currentTarget.value);d(r)},placeholder:(0,c.t)("components.azure-cheat-sheet.placeholder-search-logs","Search Logs queries"),width:40}),(0,o.jsx)(u.Field,{label:(0,c.t)("components.azure-cheat-sheet.label-categories","Categories"),className:g.categoryDropdown,children:(0,o.jsx)(u.Select,{options:w,value:"",onChange:e=>(e=>{if(e.length>0){const r=e.map((e=>e.label)).reduce(((e,r)=>(e[r]=t[r],e)),{});d(r)}else d(t)})(e),allowCustomValue:!1,backspaceRemovesValue:!0,placeholder:(0,c.t)("components.azure-cheat-sheet.placeholder-all-categories","All categories"),isClearable:!0,noOptionsMessage:(0,c.t)("components.azure-cheat-sheet.noOptionsMessage-unable-to-list-categories","Unable to list all categories"),formatCreateLabel:e=>`Category: ${e}`,isSearchable:!0,isMulti:!0,width:40})})]}),(0,o.jsx)("div",{className:g.spacing,children:(0,o.jsxs)(c.x6,{i18nKey:"components.azure-cheat-sheet.label-query-results",values:{numResults:Object.keys(i).reduce(((e,t)=>e=i[t].length+e),0)},children:["Query results: ","{{numResults}}"]})}),(0,o.jsx)(u.ScrollContainer,{showScrollIndicators:!0,maxHeight:"350px",children:Object.keys(i).map((t=>{if(i[t].length)return(0,o.jsx)(u.Collapse,{label:t+" "+`(${i[t].length})`,collapsible:!0,isOpen:s[t],onToggle:e=>n(E(P({},s),{[t]:e})),children:i[t].map((t=>(0,o.jsxs)(u.Card,{className:g.card,children:[(0,o.jsx)(u.Card.Heading,{children:t.displayName}),(0,o.jsx)(u.ScrollContainer,{showScrollIndicators:!0,maxHeight:"100px",children:(0,o.jsx)(y,{"aria-label":(0,c.t)("components.azure-cheat-sheet.aria-label-raw-query","{{queryDisplayName}} raw query",{queryDisplayName:t.displayName}),query:t.body,lang:v,className:g.rawQuery})}),(0,o.jsx)(u.Card.Actions,{children:(0,o.jsx)(u.Button,{size:"sm","aria-label":(0,c.t)("components.azure-cheat-sheet.aria-label-use-query","Use this query button"),onClick:()=>{e.onChange({refId:"A",queryType:p.o.LogAnalytics,azureLogAnalytics:{query:t.body},datasource:e.datasource}),(0,l.reportInteraction)("grafana_azure_cheatsheet_logs_query_selected",{id:t.id,queryName:t.displayName,query:t.body,queryCategories:t.related.categories})},children:(0,o.jsx)(c.x6,{i18nKey:"components.azure-cheat-sheet.button-use-query",children:"Use this query"})})})]},t.id)))},t)}))})]}):(0,o.jsx)(u.LoadingPlaceholder,{text:(0,c.t)("components.azure-cheat-sheet.text-loading","Loading...")})})},C=e=>({card:(0,h.css)({width:"90%",display:"flex",flexDirection:"column"}),rawQuery:(0,h.css)({backgroundColor:`${e.colors.background.primary}`,padding:`${e.spacing(1)}`,marginTop:`${e.spacing(1)}`}),spacing:(0,h.css)({marginBottom:`${e.spacing(1)}`}),filterAlignment:(0,h.css)({display:"flex"}),categoryDropdown:(0,h.css)({margin:"0 0 10px 10px",display:"flex",flexDirection:"row",alignItems:"center"})}),T=e=>{const{isOpen:t,onClose:r,datasource:s,onChange:a}=e;return(0,o.jsx)(u.Modal,{"aria-label":(0,c.t)("components.azure-cheat-sheet-modal.aria-label-kick-start","Kick start your query modal"),isOpen:t,title:(0,c.t)("components.azure-cheat-sheet-modal.title-kick-start","Kick start your query"),onDismiss:r,children:(0,o.jsx)(z,{onChange:e=>{a(e),r()},query:{refId:"A"},datasource:s})})};var D=r(3769),N=r(8442),I=r(8899),R=r(5340),L=r(5130),M=r(8785),q=r(9580),$=r(2827);function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){G(e,t,r[t])}))}return e}function _(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const V=e=>({resourceList:(0,h.css)({display:"flex",columnGap:e.spacing(1),flexWrap:"wrap",marginBottom:e.spacing(1)}),resource:(0,h.css)({flex:"0 0 auto"}),resourceLabel:(0,h.css)({padding:e.spacing(1)}),resourceGroupAndName:(0,h.css)({display:"flex",columnGap:e.spacing(.5)})}),B=({resources:e,onChange:t})=>{var r,s,n,i,l;const p=(0,u.useStyles2)(V);(0,a.useEffect)((()=>{0===e.length&&t([{}])}),[e,t]);const m=(r,o)=>{const s=[...e];s[r]=o,t(s)},f=r=>{t(e.map((e=>F({},e,r))))};var b,h,g;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.InlineField,{label:(0,c.t)("components.advanced-resource-picker.label-subscription","Subscription"),grow:!0,transparent:!0,htmlFor:"input-advanced-resource-picker-subscription",labelWidth:15,"data-testid":d.T.components.queryEditor.resourcePicker.advanced.subscription.input,children:(0,o.jsx)(u.Input,{id:"input-advanced-resource-picker-subscription",value:null!==(b=null===(r=e[0])||void 0===r?void 0:r.subscription)&&void 0!==b?b:"",onChange:e=>f({subscription:e.currentTarget.value}),placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXX"})}),(0,o.jsx)(u.InlineField,{label:(0,c.t)("components.advanced-resource-picker.label-namespace","Namespace"),grow:!0,transparent:!0,htmlFor:"input-advanced-resource-picker-metricNamespace",labelWidth:15,"data-testid":d.T.components.queryEditor.resourcePicker.advanced.namespace.input,invalid:null===(n=e[0])||void 0===n||null===(s=n.metricNamespace)||void 0===s?void 0:s.endsWith("/"),error:'Namespace cannot end with a "/"',children:(0,o.jsx)(u.Input,{id:"input-advanced-resource-picker-metricNamespace",value:null!==(h=null===(i=e[0])||void 0===i?void 0:i.metricNamespace)&&void 0!==h?h:"",onChange:e=>f({metricNamespace:e.currentTarget.value}),placeholder:"Microsoft.Insights/metricNamespaces"})}),(0,o.jsx)(u.InlineField,{label:(0,c.t)("components.advanced-resource-picker.label-region","Region"),grow:!0,transparent:!0,htmlFor:"input-advanced-resource-picker-region",labelWidth:15,"data-testid":d.T.components.queryEditor.resourcePicker.advanced.region.input,tooltip:(0,c.t)("components.advanced-resource-picker.tooltip-region","The code region of the resource. Optional for one resource but mandatory when selecting multiple ones."),children:(0,o.jsx)(u.Input,{id:"input-advanced-resource-picker-region",value:null!==(g=null===(l=e[0])||void 0===l?void 0:l.region)&&void 0!==g?g:"",onChange:e=>f({region:e.currentTarget.value}),placeholder:"northeurope"})}),(0,o.jsx)("div",{className:p.resourceList,children:e.map(((r,s)=>{var a,n;return(0,o.jsxs)("div",{className:p.resource,children:[1!==e.length&&(0,o.jsx)(u.Label,{className:p.resourceLabel,children:(0,o.jsxs)(c.x6,{i18nKey:"components.advanced-resource-picker.label-resource-number",values:{resourceNum:s+1},children:["Resource ","{{resourceNum}}"]})}),(0,o.jsx)(u.InlineField,{label:(0,c.t)("components.advanced-resource-picker.label-resource-group","Resource Group"),transparent:!0,htmlFor:`input-advanced-resource-picker-resourceGroup-${s+1}`,labelWidth:15,"data-testid":d.T.components.queryEditor.resourcePicker.advanced.resourceGroup.input,children:(0,o.jsxs)("div",{className:p.resourceGroupAndName,children:[(0,o.jsx)(u.Input,{id:`input-advanced-resource-picker-resourceGroup-${s+1}`,value:null!==(a=null==r?void 0:r.resourceGroup)&&void 0!==a?a:"",onChange:e=>m(s,_(F({},r),{resourceGroup:e.currentTarget.value})),placeholder:"resource-group"}),(0,o.jsx)($.Z,{"aria-label":(0,c.t)("components.advanced-resource-picker.aria-label-remove","Remove"),icon:"times",variant:"secondary",onClick:()=>(r=>{const o=[...e];o.splice(r,1),t(o)})(s),hidden:1===e.length,"data-testid":"remove-resource"})]})}),(0,o.jsx)(u.InlineField,{label:(0,c.t)("components.advanced-resource-picker.label-resource-name","Resource Name"),transparent:!0,htmlFor:`input-advanced-resource-picker-resourceName-${s+1}`,labelWidth:15,"data-testid":d.T.components.queryEditor.resourcePicker.advanced.resource.input,children:(0,o.jsx)(u.Input,{id:`input-advanced-resource-picker-resourceName-${s+1}`,value:null!==(n=null==r?void 0:r.resourceName)&&void 0!==n?n:"",onChange:e=>m(s,_(F({},r),{resourceName:e.currentTarget.value})),placeholder:(0,c.t)("components.advanced-resource-picker.placeholder-resource-name","name")})})]},`resource-${s+1}`)}))}),(0,o.jsx)(u.Button,{"aria-label":(0,c.t)("components.advanced-resource-picker.aria-label-add","Add"),icon:"plus",variant:"secondary",onClick:()=>{var r,o;t(e.concat({subscription:null===(r=e[0])||void 0===r?void 0:r.subscription,metricNamespace:null===(o=e[0])||void 0===o?void 0:o.metricNamespace,resourceGroup:"",resourceName:""}))},type:"button",children:(0,o.jsx)(c.x6,{i18nKey:"components.advanced-resource-picker.button-add-resource",children:"Add resource"})})]})};var Q=r(9473),U=r(7809),X=r(4173);const W=({query:e,variableOptionGroup:t,onQueryChange:r,aggregationOptions:s,isLoading:n})=>{var i,l;const d=(0,a.useCallback)((t=>{if(!t.value)return;const o=(0,X.pv)(e,t.value);r(o)}),[r,e]),p=(0,Q.qP)(s,t,null===(i=e.azureMonitor)||void 0===i?void 0:i.aggregation);return(0,o.jsx)(U.D,{label:(0,c.t)("components.aggregation-field.label-aggregation","Aggregation"),children:(0,o.jsx)(u.Select,{inputId:"azure-monitor-metrics-aggregation-field",value:(null===(l=e.azureMonitor)||void 0===l?void 0:l.aggregation)||null,onChange:d,options:p,isLoading:n})})};var H=r(7088);const K=({data:e,query:t,dimensionOptions:r,onQueryChange:s})=>{var n;const i=(0,a.useMemo)((()=>{var e,r;return null!==(r=null===(e=t.azureMonitor)||void 0===e?void 0:e.dimensionFilters)&&void 0!==r?r:[]}),[null===(n=t.azureMonitor)||void 0===n?void 0:n.dimensionFilters]),l=((e,t)=>{const[r,o]=(0,a.useState)({});return(0,a.useEffect)((()=>{var r;let s={};if(null==e||null===(r=e.series)||void 0===r?void 0:r.length){const r=e.series.flat().filter((e=>e.refId===t.refId)).flatMap((e=>e.fields)).map((e=>e.labels)).flat().filter((e=>null!=e));for(const e of r)for(const[t,r]of Object.entries(e)){const e=t.toLowerCase();s[e]?s[e].add(r):s[e]=new Set([r])}}o((e=>{const t={},r=Object.keys(s);if(0===r.length)return e;for(const o of r)e[o]&&s[o].size<e[o].size?t[o]=e[o]:t[o]=s[o];return t}))}),[null==e?void 0:e.series,t.refId]),r})(e,t),d=[{label:"==",value:"eq"},{label:"!=",value:"ne"},{label:"starts with",value:"sw"}],p=(0,a.useMemo)((()=>{let e=r;return i.length&&(e=r.filter((e=>!i.some((t=>t.dimension===e.value))))),e}),[i,r]),m=(e,t,r,o)=>{t[e]=r,o(t)},f=(e,t)=>{var r;const o=Array.from(null!==(r=l[t.toLowerCase()])&&void 0!==r?r:[]);return o.find((t=>t===e))?o.map((e=>({value:e,label:e}))):[...o,...e&&"*"!==e?[e]:[]].map((e=>({value:e,label:e})))},b=(e,t)=>{const r=f(void 0,t);if(e)for(const t of e)r.find((e=>e.value===t))||r.push({value:t,label:t});return r};return(0,o.jsx)(U.D,{label:(0,c.t)("components.dimension-fields.label-dimensions","Dimensions"),children:(0,o.jsx)(H.o,{items:i,onChange:e=>{const r=e.map((e=>{var t,r,o;return{dimension:null!==(t=e.dimension)&&void 0!==t?t:"",operator:null!==(r=e.operator)&&void 0!==r?r:"eq",filters:null!==(o=e.filters)&&void 0!==o?o:[]}}));s((0,X.cJ)(t,r))},renderItem:(e,t,s)=>{var a,n,i,l;return(0,o.jsxs)(u.Stack,{gap:0,children:[(0,o.jsx)(u.Select,{menuShouldPortal:!0,placeholder:(0,c.t)("components.dimension-fields.placeholder-field","Field"),value:e.dimension,options:(l=e.dimension||"",p.concat(r.filter((e=>e.value===l)))),onChange:r=>{var o;return m("dimension",e,null!==(o=r.value)&&void 0!==o?o:"",t)}}),(0,o.jsx)(u.Select,{menuShouldPortal:!0,placeholder:(0,c.t)("components.dimension-fields.placeholder-operation","Operation"),value:e.operator,options:(i=e.operator||"eq",d.find((e=>e.value===i))?d:[...d,...i?[{label:i,value:i}]:[]]),onChange:r=>{var o;return m("operator",e,null!==(o=r.value)&&void 0!==o?o:"",t)},allowCustomValue:!0}),"eq"===e.operator||"ne"===e.operator?(0,o.jsx)(u.MultiSelect,{menuShouldPortal:!0,placeholder:(0,c.t)("components.dimension-fields.placeholder-select-values","Select value(s)"),value:e.filters,options:b(e.filters,null!==(a=e.dimension)&&void 0!==a?a:""),onChange:r=>m("filters",e,r.map((e=>{var t;return null!==(t=e.value)&&void 0!==t?t:""})),t),"data-testid":"dimension-labels-select",allowCustomValue:!0}):(0,o.jsx)(u.Select,{menuShouldPortal:!0,placeholder:(0,c.t)("components.dimension-fields.placeholder-select-value","Select value"),value:e.filters?e.filters[0]:"",allowCustomValue:!0,options:f(e.filters?e.filters[0]:"",null!==(n=e.dimension)&&void 0!==n?n:""),onChange:r=>{var o;return m("filters",e,[null!==(o=null==r?void 0:r.value)&&void 0!==o?o:""],t)},isClearable:!0}),(0,o.jsx)($.Z,{"aria-label":(0,c.t)("components.dimension-fields.aria-label-remove","Remove"),icon:"times",variant:"secondary",onClick:s,type:"button"})]})}})})},J=({onQueryChange:e,query:t})=>{var r,s;const[n,i]=(0,a.useState)(null!==(s=null===(r=t.azureMonitor)||void 0===r?void 0:r.alias)&&void 0!==s?s:""),l=(0,a.useCallback)((e=>{e.target instanceof HTMLInputElement&&i(e.target.value)}),[]),d=(0,a.useCallback)((()=>{const r=(0,X.gU)(t,n);e(r)}),[e,t,n]);return(0,o.jsx)(U.D,{label:(0,c.t)("components.legend-format-field.label-legend-format","Legend format"),children:(0,o.jsx)(u.Input,{id:"azure-monitor-metrics-legend-field",placeholder:(0,c.t)("components.legend-format-field.placeholder-legend-format","Alias patterns"),value:n,onChange:l,onBlur:d,width:38})})},Z=({metricNames:e,query:t,variableOptionGroup:r,onQueryChange:s})=>{var n,i;const l=(0,a.useCallback)((e=>{if(!e.value)return;const r=(0,X.st)(t,e.value);s(r)}),[s,t]),p=(0,Q.qP)(e,r,null===(n=t.azureMonitor)||void 0===n?void 0:n.metricName);var m;return(0,o.jsx)(U.D,{label:(0,c.t)("components.metric-name-field.label-metric","Metric"),"data-testid":d.T.components.queryEditor.metricsQueryEditor.metricName.input,children:(0,o.jsx)(u.Select,{inputId:"azure-monitor-metrics-metric-field",value:null!==(m=null===(i=t.azureMonitor)||void 0===i?void 0:i.metricName)&&void 0!==m?m:null,onChange:l,options:p,allowCustomValue:!0})})},Y=({metricNamespaces:e,query:t,variableOptionGroup:r,onQueryChange:s})=>{var n,i;const l=(0,a.useCallback)((e=>{if(!e.value)return;const r=(0,X.Zp)(t,e.value);s(r)}),[s,t]),d=(null===(n=t.azureMonitor)||void 0===n?void 0:n.customNamespace)||(null===(i=t.azureMonitor)||void 0===i?void 0:i.metricNamespace),p=(0,Q.qP)(e,r,d);return(0,o.jsx)(U.D,{label:(0,c.t)("components.metric-namespace-field.label-metric-namespace","Metric namespace"),children:(0,o.jsx)(u.Select,{inputId:"azure-monitor-metrics-metric-namespace-field",value:d||null,onChange:l,options:p,allowCustomValue:!0})})};var ee=r(24);function te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function re(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const oe=({query:e,timeGrainOptions:t,variableOptionGroup:r,onQueryChange:s})=>{var n,i;const l=(0,a.useCallback)((t=>{if(!t.value)return;const r=(0,X.Jk)(e,t.value);s(r)}),[s,e]),d=(0,a.useMemo)((()=>{var o;const s=ee.A.findClosestTimeGrain("1m",t.map((e=>ee.A.createKbnUnitFromISO8601Duration(e.value)))||["1m","5m","15m","30m","1h","6h","12h","1d"]),a=t.map((e=>"auto"===e.value?re(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){te(e,t,r[t])}))}return e}({},e),{description:s}):e));return(0,Q.qP)(a,r,null===(o=e.azureMonitor)||void 0===o?void 0:o.timeGrain)}),[t,r,null===(n=e.azureMonitor)||void 0===n?void 0:n.timeGrain]);return(0,o.jsx)(U.D,{label:(0,c.t)("components.time-grain-field.label-time-grain","Time grain"),children:(0,o.jsx)(u.Select,{inputId:"azure-monitor-metrics-time-grain-field",value:null===(i=e.azureMonitor)||void 0===i?void 0:i.timeGrain,onChange:l,options:d})})},se=({onQueryChange:e,query:t})=>{var r,s;const[n,i]=(0,a.useState)(null!==(s=null===(r=t.azureMonitor)||void 0===r?void 0:r.top)&&void 0!==s?s:""),l=(0,a.useCallback)((e=>{e.target instanceof HTMLInputElement&&i(e.target.value)}),[]),d=(0,a.useCallback)((()=>{const r=(0,X.Ik)(t,n);e(r)}),[e,t,n]);return(0,o.jsx)(U.D,{label:(0,c.t)("components.top-field.label-top","Top"),children:(0,o.jsx)(u.Input,{id:"azure-monitor-metrics-top-field",value:n,onChange:l,onBlur:d,width:16})})};function ae(e,t,r){const[o]=(0,a.useState)((()=>Math.random())),[s,n]=(0,a.useState)(),i=(0,a.useMemo)((()=>null!=s?s:[]),[s]);return(0,a.useEffect)((()=>{e().then((e=>{n(e),t(o,void 0)})).catch((e=>{t(o,e)}))}),r),i}function ne(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function ie(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){ne(a,o,s,n,i,"next",e)}function i(e){ne(a,o,s,n,i,"throw",e)}n(void 0)}))}}function ce(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){ce(e,t,r[t])}))}return e}function ue(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const de=e=>{return e&&e.length?{resourceGroup:null!==(t=e[0].resourceGroup)&&void 0!==t?t:"",resourceName:null!==(r=e[0].resourceName)&&void 0!==r?r:""}:{resourceGroup:"",resourceName:""};var t,r},pe={aggOptions:[],timeGrains:[],dimensions:[],isLoading:!1,supportedAggTypes:[],primaryAggType:void 0};function me(e,t){const r=e.map(Q.zL);return t&&!r.find((e=>e.value===t.toLowerCase()))&&r.push({label:t,value:t}),r}const fe=({data:e,query:t,datasource:r,variableOptionGroup:s,onChange:n,setError:c})=>{var l,u;const p=((e,t,r)=>{const[o,s]=(0,a.useState)(pe),{subscription:n}=e;var c;const{resources:l,metricNamespace:u,metricName:d,aggregation:p,timeGrain:m,customNamespace:f,region:b}=null!==(c=e.azureMonitor)&&void 0!==c?c:{},{resourceGroup:h,resourceName:g}=de(l);var v;const y=null!==(v=l&&l.length>1)&&void 0!==v&&v;return(0,a.useEffect)((()=>{n&&h&&g&&u&&d?t.azureMonitorDatasource.getMetricMetadata({subscription:n,resourceGroup:h,resourceName:g,metricNamespace:u,metricName:d,customNamespace:f},y,b).then((e=>{const t=(e.supportedAggTypes||[e.primaryAggType]).map((e=>({label:e,value:e})));var r;s({aggOptions:t,timeGrains:e.supportedTimeGrains,dimensions:e.dimensions,isLoading:!1,supportedAggTypes:null!==(r=e.supportedAggTypes)&&void 0!==r?r:[],primaryAggType:e.primaryAggType})})):s(pe)}),[b,t,n,h,g,u,d,f,y]),(0,a.useEffect)((()=>{const t=p||o.primaryAggType,s=m||"auto";t===p&&s===m||r(ue(le({},e),{azureMonitor:ue(le({},e.azureMonitor),{aggregation:t,timeGrain:s,allowedTimeGrainsMs:o.timeGrains.filter((e=>"auto"!==e.value)).map((e=>i.rangeUtil.intervalToMs(ee.A.createKbnUnitFromISO8601Duration(e.value))))})}))}),[r,o,p,m,e]),o})(t,r,n),m=((e,t,r,o)=>{const{subscription:s}=e;var a;const{metricNamespace:n,resources:i}=null!==(a=e.azureMonitor)&&void 0!==a?a:{},{resourceGroup:c,resourceName:l}=de(i);return ae((()=>ie((function*(){if(!s||!c||!l)return;const o=me(yield t.azureMonitorDatasource.getMetricNamespaces({subscription:s,metricNamespace:n,resourceGroup:c,resourceName:l},!1),n);return!n&&o.length&&r((0,X.Zp)(e,o[0].value)),o}))()),o,[s,n,c,l])})(t,r,n,c),f=((e,t,r,o)=>{var s;const{subscription:a}=e;var n;const{metricNamespace:i,metricName:c,resources:l,customNamespace:u}=null!==(n=e.azureMonitor)&&void 0!==n?n:{},{resourceGroup:d,resourceName:p}=de(l);var m;const f=null!==(m=l&&l.length>1)&&void 0!==m&&m;var b;const h=null!==(b=null===(s=e.azureMonitor)||void 0===s?void 0:s.region)&&void 0!==b?b:"";return ae((()=>ie((function*(){if(a&&i&&d&&p)return me(yield t.azureMonitorDatasource.getMetricNames({subscription:a,resourceGroup:d,resourceName:p,metricNamespace:i,customNamespace:u},f,h),c)}))()),o,[a,d,p,i,u,f])})(t,r,0,c);var b;const h=null!==(b=null===(u=t.azureMonitor)||void 0===u||null===(l=u.resources)||void 0===l?void 0:l.map((e=>{var r,o;return{subscription:t.subscription,resourceGroup:e.resourceGroup,metricNamespace:null===(r=t.azureMonitor)||void 0===r?void 0:r.metricNamespace,resourceName:e.resourceName,region:null===(o=t.azureMonitor)||void 0===o?void 0:o.region}})))&&void 0!==b?b:[],g=e=>{var t,r;return null!==(r=R.Jo[null!==(t=null==e?void 0:e.toLocaleLowerCase())&&void 0!==t?t:""])&&void 0!==r&&r};var v,y,w;return(0,o.jsx)("span",{"data-testid":d.T.components.queryEditor.metricsQueryEditor.container.input,children:(0,o.jsxs)(D.D,{children:[(0,o.jsx)(N.U,{children:(0,o.jsxs)(I.B,{children:[(0,o.jsx)(L.A,{query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c,selectableEntryTypes:[M.X.Resource],resources:null!=h?h:[],queryType:"metrics",disableRow:(e,t)=>{var r,o;if(0===t.length)return!1;const s=(0,q.oU)(e.uri,e.location),a=(0,q.oU)(t[0].uri,t[0].location);return s.subscription!==a.subscription||s.region!==a.region||(null===(r=s.metricNamespace)||void 0===r?void 0:r.toLocaleLowerCase())!==(null===(o=a.metricNamespace)||void 0===o?void 0:o.toLocaleLowerCase())||!g(s.metricNamespace)},renderAdvanced:(e,t)=>(0,o.jsx)(B,{resources:e,onChange:t}),selectionNotice:e=>{if(0===e.length)return"";const t=(0,q.oU)(e[0].uri,e[0].location);return g(t.metricNamespace)?"You can select items of the same resource type and location. To select resources of a different resource type or location, please first uncheck your current selection.":""}}),(0,o.jsx)(Y,{metricNamespaces:m,query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c}),(0,o.jsx)(Z,{metricNames:f,query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c}),(0,o.jsx)(W,{query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c,aggregationOptions:null!==(v=null==p?void 0:p.aggOptions)&&void 0!==v?v:[],isLoading:p.isLoading}),(0,o.jsx)(oe,{query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c,timeGrainOptions:null!==(y=null==p?void 0:p.timeGrains)&&void 0!==y?y:[]})]})}),(0,o.jsx)(N.U,{children:(0,o.jsx)(I.B,{children:(0,o.jsx)(K,{data:e,query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c,dimensionOptions:null!==(w=null==p?void 0:p.dimensions)&&void 0!==w?w:[]})})}),(0,o.jsx)(N.U,{children:(0,o.jsxs)(I.B,{children:[(0,o.jsx)(se,{query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c}),(0,o.jsx)(J,{query:t,datasource:r,variableOptionGroup:s,onQueryChange:n,setError:c})]})})]})})};var be=r(608),he=r(1490),ge=r(1269),ve=r(709);function ye(e,t="latest"){return we(e,t.replace(/\-.*/,""))}function we(e,t){const r={};for(const[o,s]of Object.entries(e))Oe(s)?r[o]=we(s,t):(Se(s,o),r[o]=je(s,t));return r}function Oe(e){if("object"==typeof e){const[t]=Object.keys(e);return!(0,ve.valid)(t)}return!1}function je(e,t){let r,o=Object.keys(e).sort(ve.compare);if("latest"===t)return e[o[o.length-1]];for(const e of o)(0,ve.gte)(t,e)&&(r=e);return r||(r=o[o.length-1]),e[r]}function Se(e,t){if(!Object.keys(e).every((e=>(0,ve.valid)(e))))throw new Error(`Invalid semver version: '${t}'`)}const xe="8.5.0",ke={RadioButton:{container:{"10.2.3":"data-testid radio-button"}},Breadcrumbs:{breadcrumb:{"9.4.0":e=>`data-testid ${e} breadcrumb`}},CanvasGridAddActions:{addPanel:{"12.1.0":"data-testid CanvasGridAddActions add-panel"},groupPanels:{"12.1.0":"data-testid CanvasGridAddActions group-panels"},ungroup:{"12.1.0":"data-testid CanvasGridAddActions ungroup"},addRow:{"12.1.0":"data-testid CanvasGridAddActions add-row"},pasteRow:{"12.1.0":"data-testid CanvasGridAddActions paste-row"},addTab:{"12.1.0":"data-testid CanvasGridAddActions add-tab"},pasteTab:{"12.1.0":"data-testid CanvasGridAddActions paste-tab"}},DashboardEditPaneSplitter:{primaryBody:{"12.1.0":"data-testid DashboardEditPaneSplitter primary body"}},EditPaneHeader:{deleteButton:{"12.1.0":"data-testid EditPaneHeader delete panel"},copyDropdown:{"12.1.0":"data-testid EditPaneHeader copy dropdown"},copy:{"12.1.0":"data-testid EditPaneHeader copy"},duplicate:{"12.1.0":"data-testid EditPaneHeader duplicate"},backButton:{"12.1.0":"data-testid EditPaneHeader back"}},TimePicker:{openButton:{[xe]:"data-testid TimePicker Open Button"},overlayContent:{"10.2.3":"data-testid TimePicker Overlay Content"},fromField:{"10.2.3":"data-testid Time Range from field",[xe]:"Time Range from field"},toField:{"10.2.3":"data-testid Time Range to field",[xe]:"Time Range to field"},applyTimeRange:{[xe]:"data-testid TimePicker submit button"},copyTimeRange:{"10.4.0":"data-testid TimePicker copy button"},pasteTimeRange:{"10.4.0":"data-testid TimePicker paste button"},calendar:{label:{"10.2.3":"data-testid Time Range calendar",[xe]:"Time Range calendar"},openButton:{"10.2.3":"data-testid Open time range calendar",[xe]:"Open time range calendar"},closeButton:{"10.2.3":"data-testid Close time range Calendar",[xe]:"Close time range Calendar"}},absoluteTimeRangeTitle:{[xe]:"data-testid-absolute-time-range-narrow"}},DataSourcePermissions:{form:{"9.5.0":()=>'form[name="addPermission"]'},roleType:{"9.5.0":"Role to add new permission to"},rolePicker:{"9.5.0":"Built-in role picker"},permissionLevel:{"12.0.0":"Permission level","9.5.0":"Permission Level"}},DateTimePicker:{input:{"10.2.3":"data-testid date-time-input"}},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:{[xe]:"Test Data Query scenario select container"},scenarioSelect:{[xe]:"Test Data Query scenario select"},max:{[xe]:"TestData max"},min:{[xe]:"TestData min"},noise:{[xe]:"TestData noise"},seriesCount:{[xe]:"TestData series count"},spread:{[xe]:"TestData spread"},startValue:{[xe]:"TestData start value"},drop:{[xe]:"TestData drop values"}}},DataSourceHttpSettings:{urlInput:{"10.4.0":"data-testid Datasource HTTP settings url",[xe]:"Datasource HTTP settings url"}},Jaeger:{traceIDInput:{[xe]:"Trace ID"}},Prometheus:{configPage:{connectionSettings:{[xe]:"Data source connection URL"},manageAlerts:{"10.4.0":"prometheus-alerts-manager"},allowAsRecordingRulesTarget:{"12.1.0":"prometheus-recording-rules-target"},scrapeInterval:{"10.4.0":"data-testid scrape interval"},queryTimeout:{"10.4.0":"data-testid query timeout"},defaultEditor:{"10.4.0":"data-testid default editor"},disableMetricLookup:{"10.4.0":"disable-metric-lookup"},prometheusType:{"10.4.0":"data-testid prometheus type"},prometheusVersion:{"10.4.0":"data-testid prometheus version"},cacheLevel:{"10.4.0":"data-testid cache level"},incrementalQuerying:{"10.4.0":"prometheus-incremental-querying"},queryOverlapWindow:{"10.4.0":"data-testid query overlap window"},disableRecordingRules:{"10.4.0":"disable-recording-rules"},customQueryParameters:{"10.4.0":"data-testid custom query parameters"},httpMethod:{"10.4.0":"data-testid http method"},exemplarsAddButton:{"10.3.0":"data-testid Add exemplar config button",[xe]:"Add exemplar config button"},internalLinkSwitch:{"10.3.0":"data-testid Internal link switch",[xe]:"Internal link switch"},codeModeMetricNamesSuggestionLimit:{"11.1.0":"data-testid code mode metric names suggestion limit"},seriesLimit:{"12.0.2":"data-testid maximum series limit"}},queryEditor:{explain:{"10.4.0":"data-testid prometheus explain switch wrapper"},editorToggle:{"10.4.0":"data-testid QueryEditorModeToggle"},options:{"10.4.0":"data-testid prometheus options"},legend:{"10.4.0":"data-testid prometheus legend wrapper"},format:{"10.4.0":"data-testid prometheus format"},step:{"10.4.0":"data-testid prometheus-step"},type:{"10.4.0":"data-testid prometheus type"},exemplars:{"10.4.0":"data-testid prometheus-exemplars"},builder:{metricSelect:{"10.4.0":"data-testid metric select"},hints:{"10.4.0":"data-testid prometheus hints"},metricsExplorer:{"10.4.0":"data-testid metrics explorer"},queryAdvisor:{"10.4.0":"data-testid query advisor"}},code:{queryField:{"10.4.0":"data-testid prometheus query field"},metricsCountInfo:{"11.1.0":"data-testid metrics count disclaimer"},metricsBrowser:{openButton:{"10.4.0":"data-testid open metrics browser"},selectMetric:{"10.4.0":"data-testid select a metric"},seriesLimit:{"10.3.1":"data-testid series limit"},metricList:{"10.4.0":"data-testid metric list"},labelNamesFilter:{"10.4.0":"data-testid label names filter"},labelValuesFilter:{"10.4.0":"data-testid label values filter"},useQuery:{"10.4.0":"data-testid use query"},useAsRateQuery:{"10.4.0":"data-testid use as rate query"},validateSelector:{"10.4.0":"data-testid validate selector"},clear:{"10.4.0":"data-testid clear"}}}},exemplarMarker:{"10.3.0":"data-testid Exemplar marker",[xe]:"Exemplar marker"},variableQueryEditor:{queryType:{"10.4.0":"data-testid query type"},labelnames:{metricRegex:{"10.4.0":"data-testid label names metric regex"}},labelValues:{labelSelect:{"10.4.0":"data-testid label values label select"}},metricNames:{metricRegex:{"10.4.0":"data-testid metric names metric regex"}},varQueryResult:{"10.4.0":"data-testid variable query result"},seriesQuery:{"10.4.0":"data-testid prometheus series query"},classicQuery:{"10.4.0":"data-testid prometheus classic query"}},annotations:{minStep:{"10.4.0":"data-testid prometheus-annotation-min-step"},title:{"10.4.0":"data-testid prometheus annotation title"},tags:{"10.4.0":"data-testid prometheus annotation tags"},text:{"10.4.0":"data-testid prometheus annotation text"},seriesValueAsTimestamp:{"10.4.0":"data-testid prometheus annotation series value as timestamp"}}}},Menu:{MenuComponent:{[xe]:e=>`${e} menu`},MenuGroup:{[xe]:e=>`${e} menu group`},MenuItem:{[xe]:e=>`${e} menu item`},SubMenu:{container:{"10.3.0":"data-testid SubMenu container",[xe]:"SubMenu container"},icon:{"10.3.0":"data-testid SubMenu icon",[xe]:"SubMenu icon"}}},Panels:{Panel:{title:{[xe]:e=>`data-testid Panel header ${e}`},content:{"11.1.0":"data-testid panel content"},headerContainer:{"9.5.0":"data-testid header-container"},headerItems:{"10.2.0":e=>`data-testid Panel header item ${e}`},menuItems:{"9.5.0":e=>`data-testid Panel menu item ${e}`},menu:{"9.5.0":e=>`data-testid Panel menu ${e}`},containerByTitle:{[xe]:e=>`${e} panel`},headerCornerInfo:{[xe]:e=>`Panel header ${e}`},status:{"10.2.0":e=>`data-testid Panel status ${e}`,[xe]:e=>"Panel status"},loadingBar:{"10.0.0":()=>"Panel loading bar"},HoverWidget:{container:{"10.1.0":"data-testid hover-header-container",[xe]:"hover-header-container"},dragIcon:{"10.0.0":"data-testid drag-icon"}},PanelDataErrorMessage:{"10.4.0":"data-testid Panel data error message"}},Visualization:{Graph:{container:{"9.5.0":"Graph container"},VisualizationTab:{legendSection:{[xe]:"Legend section"}},Legend:{legendItemAlias:{[xe]:e=>`gpl alias ${e}`},showLegendSwitch:{[xe]:"gpl show legend"}},xAxis:{labels:{[xe]:()=>"div.flot-x-axis > div.flot-tick-label"}}},BarGauge:{valueV2:{[xe]:"data-testid Bar gauge value"}},PieChart:{svgSlice:{"10.3.0":"data testid Pie Chart Slice"}},Text:{container:{[xe]:()=>".markdown-html"}},Table:{header:{[xe]:"table header"},footer:{[xe]:"table-footer"},body:{"10.2.0":"data-testid table body"}},TableNG:{Filters:{HeaderButton:{"12.1.0":"data-testid tableng header filter"},Container:{"12.1.0":"data-testid tablenf filter container"},SelectAll:{"12.1.0":"data-testid tableng filter select-all"}},Tooltip:{Wrapper:{"12.2.0":"data-testid tableng tooltip wrapper"},Caret:{"12.2.0":"data-testid tableng tooltip caret"}},Footer:{ReducerLabel:{"12.2.0":"data-testid tableng footer reducer-label"},Value:{"12.2.0":"data-testid tableng footer value"}}}}},VizLegend:{seriesName:{"10.3.0":e=>`data-testid VizLegend series ${e}`}},Drawer:{General:{title:{[xe]:e=>`Drawer title ${e}`},expand:{[xe]:"Drawer expand"},contract:{[xe]:"Drawer contract"},close:{"10.3.0":"data-testid Drawer close",[xe]:"Drawer close"},rcContentWrapper:{"9.4.0":()=>".rc-drawer-content-wrapper"},subtitle:{"10.4.0":"data-testid drawer subtitle"}},DashboardSaveDrawer:{saveButton:{"11.1.0":"data-testid Save dashboard drawer button"},saveAsButton:{"11.1.0":"data-testid Save as dashboard drawer button"},saveAsTitleInput:{"11.1.0":"Save dashboard title field"}}},PanelEditor:{General:{content:{"11.1.0":"data-testid Panel editor content","8.0.0":"Panel editor content"}},OptionsPane:{content:{"11.1.0":"data-testid Panel editor option pane content",[xe]:"Panel editor option pane content"},select:{[xe]:"Panel editor option pane select"},fieldLabel:{[xe]:e=>`${e} field property editor`},fieldInput:{"11.0.0":e=>`data-testid Panel editor option pane field input ${e}`}},DataPane:{content:{"11.1.0":"data-testid Panel editor data pane content",[xe]:"Panel editor data pane content"}},applyButton:{"9.2.0":"data-testid Apply changes and go back to dashboard","9.1.0":"Apply changes and go back to dashboard","8.0.0":"panel editor apply"},toggleVizPicker:{"10.0.0":"data-testid toggle-viz-picker","8.0.0":"toggle-viz-picker"},toggleVizOptions:{"10.1.0":"data-testid toggle-viz-options",[xe]:"toggle-viz-options"},toggleTableView:{"11.1.0":"data-testid toggle-table-view",[xe]:"toggle-table-view"},showZoomField:{"10.2.0":"Map controls Show zoom control field property editor"},showAttributionField:{"10.2.0":"Map controls Show attribution field property editor"},showScaleField:{"10.2.0":"Map controls Show scale field property editor"},showMeasureField:{"10.2.0":"Map controls Show measure tools field property editor"},showDebugField:{"10.2.0":"Map controls Show debug field property editor"},measureButton:{"12.1.0":"data-testid panel-editor-measure-button","9.2.0":"show measure tools"},Outline:{section:{"12.0.0":"data-testid Outline section"},node:{"12.0.0":e=>`data-testid outline node ${e}`},item:{"12.0.0":e=>`data-testid outline item ${e}`}},ElementEditPane:{variableType:{"12.0.0":e=>`data-testid variable type ${e}`},addVariableButton:{"12.0.0":"data-testid add variable button"},variableNameInput:{"12.0.0":"data-testid variable name input"},variableLabelInput:{"12.0.0":"data-testid variable label input"},AutoGridLayout:{minColumnWidth:{"12.1.0":"data-testid min column width selector"},customMinColumnWidth:{"12.1.0":"data-testid custom min column width input"},clearCustomMinColumnWidth:{"12.1.0":"data-testid clear custom min column width input"},maxColumns:{"12.1.0":"data-testid max columns selector"},rowHeight:{"12.1.0":"data-testid row height selector"},customRowHeight:{"12.1.0":"data-testid custom row height input"},clearCustomRowHeight:{"12.1.0":"data-testid clear custom row height input"},fillScreen:{"12.1.0":"data-testid fill screen switch"}}}},PanelInspector:{Data:{content:{[xe]:"Panel inspector Data content"}},Stats:{content:{[xe]:"Panel inspector Stats content"}},Json:{content:{"11.1.0":"data-testid Panel inspector Json content",[xe]:"Panel inspector Json content"}},Query:{content:{[xe]:"Panel inspector Query content"},refreshButton:{[xe]:"Panel inspector Query refresh button"},jsonObjectKeys:{[xe]:()=>".json-formatter-key"}}},Tab:{title:{"11.2.0":e=>`data-testid Tab ${e}`},active:{[xe]:()=>'[class*="-activeTabStyle"]'}},RefreshPicker:{runButtonV2:{[xe]:"data-testid RefreshPicker run button"},intervalButtonV2:{[xe]:"data-testid RefreshPicker interval button"}},QueryTab:{content:{[xe]:"Query editor tab content"},queryInspectorButton:{[xe]:"Query inspector button"},queryHistoryButton:{"10.2.0":"data-testid query-history-button",[xe]:"query-history-button"},addQuery:{"10.2.0":"data-testid query-tab-add-query",[xe]:"Query editor add query button"},addQueryFromLibrary:{"11.5.0":"data-testid query-tab-add-query-from-library"},queryGroupTopSection:{"11.2.0":"data-testid query group top section"},addExpression:{"11.2.0":"data-testid query-tab-add-expression"}},QueryHistory:{queryText:{"9.0.0":"Query text"}},QueryEditorRows:{rows:{[xe]:"Query editor row"}},QueryEditorRow:{actionButton:{"10.4.0":e=>`data-testid ${e}`},title:{[xe]:e=>`Query editor row title ${e}`},container:{[xe]:e=>`Query editor row ${e}`}},AlertTab:{content:{"10.2.3":"data-testid Alert editor tab content",[xe]:"Alert editor tab content"}},AlertRules:{groupToggle:{"11.0.0":"data-testid group-collapse-toggle"},toggle:{"11.0.0":"data-testid collapse-toggle"},expandedContent:{"11.0.0":"data-testid expanded-content"},previewButton:{"11.1.0":"data-testid alert-rule preview-button"},ruleNameField:{"11.1.0":"data-testid alert-rule name-field"},newFolderButton:{"11.1.0":"data-testid alert-rule new-folder-button"},newFolderNameField:{"11.1.0":"data-testid alert-rule name-folder-name-field"},newFolderNameCreateButton:{"11.1.0":"data-testid alert-rule name-folder-name-create-button"},newEvaluationGroupButton:{"11.1.0":"data-testid alert-rule new-evaluation-group-button"},newEvaluationGroupName:{"11.1.0":"data-testid alert-rule new-evaluation-group-name"},newEvaluationGroupInterval:{"11.1.0":"data-testid alert-rule new-evaluation-group-interval"},newEvaluationGroupCreate:{"11.1.0":"data-testid alert-rule new-evaluation-group-create-button"},step:{"11.5.0":e=>`data-testid alert-rule step-${e}`},stepAdvancedModeSwitch:{"11.5.0":e=>`data-testid advanced-mode-switch step-${e}`}},Alert:{alertV2:{[xe]:e=>`data-testid Alert ${e}`}},TransformTab:{content:{"10.1.0":"data-testid Transform editor tab content",[xe]:"Transform editor tab content"},newTransform:{"10.1.0":e=>`data-testid New transform ${e}`},transformationEditor:{"10.1.0":e=>`data-testid Transformation editor ${e}`},transformationEditorDebugger:{"10.1.0":e=>`data-testid Transformation editor debugger ${e}`}},Transforms:{card:{"10.1.0":e=>`data-testid New transform ${e}`},disableTransformationButton:{"10.4.0":"data-testid Disable transformation button"},Reduce:{modeLabel:{"10.2.3":"data-testid Transform mode label",[xe]:"Transform mode label"},calculationsLabel:{"10.2.3":"data-testid Transform calculations label",[xe]:"Transform calculations label"}},SpatialOperations:{actionLabel:{"9.1.2":"root Action field property editor"},locationLabel:{"10.2.0":"root Location Mode field property editor"},location:{autoOption:{"9.1.2":"Auto location option"},coords:{option:{"9.1.2":"Coords location option"},latitudeFieldLabel:{"9.1.2":"root Latitude field field property editor"},longitudeFieldLabel:{"9.1.2":"root Longitude field field property editor"}},geohash:{option:{"9.1.2":"Geohash location option"},geohashFieldLabel:{"9.1.2":"root Geohash field field property editor"}},lookup:{option:{"9.1.2":"Lookup location option"},lookupFieldLabel:{"9.1.2":"root Lookup field field property editor"},gazetteerFieldLabel:{"9.1.2":"root Gazetteer field property editor"}}}},searchInput:{"10.2.3":"data-testid search transformations",[xe]:"search transformations"},noTransformationsMessage:{"10.2.3":"data-testid no transformations message"},addTransformationButton:{"10.1.0":"data-testid add transformation button",[xe]:"add transformation button"},removeAllTransformationsButton:{"10.4.0":"data-testid remove all transformations button"}},NavBar:{Configuration:{button:{"9.5.0":"Configuration"}},Toggle:{button:{"10.2.3":"data-testid Toggle menu",[xe]:"Toggle menu"}},Reporting:{button:{"9.5.0":"Reporting"}}},NavMenu:{Menu:{"10.2.3":"data-testid navigation mega-menu"},item:{"9.5.0":"data-testid Nav menu item"}},NavToolbar:{container:{"9.4.0":"data-testid Nav toolbar"},commandPaletteTrigger:{"11.5.0":"data-testid Command palette trigger"},shareDashboard:{"11.1.0":"data-testid Share dashboard"},markAsFavorite:{"11.1.0":"data-testid Mark as favorite"},editDashboard:{editButton:{"11.1.0":"data-testid Edit dashboard button"},saveButton:{"11.1.0":"data-testid Save dashboard button"},exitButton:{"11.1.0":"data-testid Exit edit mode button"},settingsButton:{"11.1.0":"data-testid Dashboard settings"},addRowButton:{"11.1.0":"data-testid Add row button"},addLibraryPanelButton:{"11.1.0":"data-testid Add a panel from the panel library button"},addVisualizationButton:{"11.1.0":"data-testid Add new visualization menu item"},pastePanelButton:{"11.1.0":"data-testid Paste panel button"},discardChangesButton:{"11.1.0":"data-testid Discard changes button"},discardLibraryPanelButton:{"11.1.0":"data-testid Discard library panel button"},unlinkLibraryPanelButton:{"11.1.0":"data-testid Unlink library panel button"},saveLibraryPanelButton:{"11.1.0":"data-testid Save library panel button"},backToDashboardButton:{"11.1.0":"data-testid Back to dashboard button"}}},PageToolbar:{container:{[xe]:()=>".page-toolbar"},item:{[xe]:e=>`${e}`},itemButton:{"9.5.0":e=>`data-testid ${e}`}},QueryEditorToolbarItem:{button:{[xe]:e=>`QueryEditor toolbar item button ${e}`}},BackButton:{backArrow:{"10.3.0":"data-testid Go Back",[xe]:"Go Back"}},OptionsGroup:{group:{"11.1.0":e=>e?`data-testid Options group ${e}`:"data-testid Options group",[xe]:e=>e?`Options group ${e}`:"Options group"},toggle:{"11.1.0":e=>e?`data-testid Options group ${e} toggle`:"data-testid Options group toggle",[xe]:e=>e?`Options group ${e} toggle`:"Options group toggle"}},PluginVisualization:{item:{[xe]:e=>`Plugin visualization item ${e}`},current:{[xe]:()=>'[class*="-currentVisualizationItem"]'}},Select:{menu:{"11.5.0":"data-testid Select menu",[xe]:"Select options menu"},option:{"11.1.0":"data-testid Select option",[xe]:"Select option"},toggleAllOptions:{"11.3.0":"data-testid toggle all options"},input:{[xe]:()=>'input[id*="time-options-input"]'},singleValue:{[xe]:()=>'div[class*="-singleValue"]'}},FieldConfigEditor:{content:{[xe]:"Field config editor content"}},OverridesConfigEditor:{content:{[xe]:"Field overrides editor content"}},FolderPicker:{containerV2:{[xe]:"data-testid Folder picker select container"},input:{"10.4.0":"data-testid folder-picker-input"}},ReadonlyFolderPicker:{container:{[xe]:"data-testid Readonly folder picker select container"}},DataSourcePicker:{container:{"10.0.0":"data-testid Data source picker select container","8.0.0":"Data source picker select container"},inputV2:{"10.1.0":"data-testid Select a data source",[xe]:"Select a data source"},dataSourceList:{"10.4.0":"data-testid Data source list dropdown"},advancedModal:{dataSourceList:{"10.4.0":"data-testid Data source list"},builtInDataSourceList:{"10.4.0":"data-testid Built in data source list"}}},TimeZonePicker:{containerV2:{[xe]:"data-testid Time zone picker select container"},changeTimeSettingsButton:{"11.0.0":"data-testid Time zone picker Change time settings button"}},WeekStartPicker:{containerV2:{[xe]:"data-testid Choose starting day of the week"},placeholder:{[xe]:"Choose starting day of the week"}},TraceViewer:{spanBar:{"9.0.0":"data-testid SpanBar--wrapper"}},QueryField:{container:{"10.3.0":"data-testid Query field",[xe]:"Query field"}},QueryBuilder:{queryPatterns:{"10.3.0":"data-testid Query patterns",[xe]:"Query patterns"},labelSelect:{"10.3.0":"data-testid Select label",[xe]:"Select label"},inputSelect:{"11.1.0":"data-testid Select label-input"},valueSelect:{"10.3.0":"data-testid Select value",[xe]:"Select value"},matchOperatorSelect:{"10.3.0":"data-testid Select match operator",[xe]:"Select match operator"}},ValuePicker:{button:{"10.3.0":e=>`data-testid Value picker button ${e}`},select:{"10.3.0":e=>`data-testid Value picker select ${e}`}},Search:{sectionV2:{[xe]:"data-testid Search section"},itemsV2:{[xe]:"data-testid Search items"},cards:{[xe]:"data-testid Search cards"},collapseFolder:{[xe]:e=>`data-testid Collapse folder ${e}`},expandFolder:{[xe]:e=>`data-testid Expand folder ${e}`},dashboardItem:{[xe]:e=>`data-testid Dashboard search item ${e}`},dashboardCard:{[xe]:e=>`data-testid Search card ${e}`},folderHeader:{"9.3.0":e=>`data-testid Folder header ${e}`},folderContent:{"9.3.0":e=>`data-testid Folder content ${e}`},dashboardItems:{[xe]:"data-testid Dashboard search item"}},DashboardLinks:{container:{[xe]:"data-testid Dashboard link container"},dropDown:{[xe]:"data-testid Dashboard link dropdown"},link:{[xe]:"data-testid Dashboard link"}},LoadingIndicator:{icon:{"10.4.0":"data-testid Loading indicator",[xe]:"Loading indicator"}},CallToActionCard:{buttonV2:{[xe]:e=>`data-testid Call to action button ${e}`}},DataLinksContextMenu:{singleLink:{"10.3.0":"data-testid Data link",[xe]:"Data link"}},DataLinksActionsTooltip:{tooltipWrapper:{"12.1.0":"data-testid Data links actions tooltip wrapper"}},CodeEditor:{container:{"10.2.3":"data-testid Code editor container",[xe]:"Code editor container"}},ReactMonacoEditor:{editorLazy:{"11.1.0":"data-testid ReactMonacoEditor editorLazy"}},DashboardImportPage:{textarea:{[xe]:"data-testid-import-dashboard-textarea"},submit:{[xe]:"data-testid-load-dashboard"}},ImportDashboardForm:{name:{[xe]:"data-testid-import-dashboard-title"},submit:{[xe]:"data-testid-import-dashboard-submit"}},PanelAlertTabContent:{content:{"10.2.3":"data-testid Unified alert editor tab content",[xe]:"Unified alert editor tab content"}},VisualizationPreview:{card:{[xe]:e=>`data-testid suggestion-${e}`}},ColorSwatch:{name:{[xe]:"data-testid-colorswatch"}},DashboardRow:{title:{[xe]:e=>`data-testid dashboard-row-title-${e}`},wrapper:{"12.1.0":e=>`data-testid dashboard-row-wrapper-for-${e}`}},UserProfile:{profileSaveButton:{[xe]:"data-testid-user-profile-save"},preferencesSaveButton:{[xe]:"data-testid-shared-prefs-save"},orgsTable:{[xe]:"data-testid-user-orgs-table"},sessionsTable:{[xe]:"data-testid-user-sessions-table"},extensionPointTabs:{"10.2.3":"data-testid-extension-point-tabs"},extensionPointTab:{"10.2.3":e=>`data-testid-extension-point-tab-${e}`}},FileUpload:{inputField:{"9.0.0":"data-testid-file-upload-input-field"},fileNameSpan:{"9.0.0":"data-testid-file-upload-file-name"}},DebugOverlay:{wrapper:{"9.2.0":"debug-overlay"}},OrgRolePicker:{input:{"9.5.0":"Role"}},AnalyticsToolbarButton:{button:{"9.5.0":"Dashboard insights"}},Variables:{variableOption:{"9.5.0":"data-testid variable-option"},variableLinkWrapper:{"11.1.1":"data-testid variable-link-wrapper"}},Annotations:{annotationsTypeInput:{"11.1.0":"data-testid annotations-type-input",[xe]:"annotations-type-input"},annotationsChoosePanelInput:{"11.1.0":"data-testid choose-panels-input",[xe]:"choose-panels-input"},editor:{testButton:{"11.0.0":"data-testid annotations-test-button"},resultContainer:{"11.0.0":"data-testid annotations-query-result-container"}}},Tooltip:{container:{"10.2.0":"data-testid tooltip"}},ReturnToPrevious:{buttonGroup:{"11.0.0":"data-testid dismissable button group"},backButton:{"11.0.0":"data-testid back"},dismissButton:{"11.0.0":"data-testid dismiss"}},SQLQueryEditor:{selectColumn:{"11.0.0":"data-testid select-column"},selectColumnInput:{"11.0.0":"data-testid select-column-input"},selectFunctionParameter:{"11.0.0":e=>`data-testid select-function-parameter-${e}`},selectAggregation:{"11.0.0":"data-testid select-aggregation"},selectAggregationInput:{"11.0.0":"data-testid select-aggregation-input"},selectAlias:{"11.0.0":"data-testid select-alias"},selectAliasInput:{"11.0.0":"data-testid select-alias-input"},selectInputParameter:{"11.0.0":"data-testid select-input-parameter"},filterConjunction:{"11.0.0":"data-testid filter-conjunction"},filterField:{"11.0.0":"data-testid filter-field"},filterOperator:{"11.0.0":"data-testid filter-operator"},headerTableSelector:{"11.0.0":"data-testid header-table-selector"},headerFilterSwitch:{"11.0.0":"data-testid header-filter-switch"},headerGroupSwitch:{"11.0.0":"data-testid header-group-switch"},headerOrderSwitch:{"11.0.0":"data-testid header-order-switch"},headerPreviewSwitch:{"11.0.0":"data-testid header-preview-switch"}},EntityNotFound:{container:{"11.2.0":"data-testid entity-not-found"}},Portal:{container:{"11.5.0":"data-testid portal-container"}},ExportImage:{formatOptions:{container:{"12.1.0":"data-testid export-image-format-options"},png:{"12.1.0":"data-testid export-image-format-png"},jpg:{"12.1.0":"data-testid export-image-format-jpg"}},rendererAlert:{container:{"12.1.0":"data-testid export-image-renderer-alert"},title:{"12.1.0":"data-testid export-image-renderer-alert-title"},description:{"12.1.0":"data-testid export-image-renderer-alert-description"}},buttons:{generate:{"12.1.0":"data-testid export-image-generate-button"},download:{"12.1.0":"data-testid export-image-download-button"},cancel:{"12.1.0":"data-testid export-image-cancel-button"}},preview:{container:{"12.1.0":"data-testid export-image-preview-container"},loading:{"12.1.0":"data-testid export-image-preview-loading"},image:{"12.1.0":"data-testid export-image-preview"},error:{container:{"12.1.0":"data-testid export-image-error"},title:{"12.1.0":"data-testid export-image-error-title"},message:{"12.1.0":"data-testid export-image-error-message"}}}}},Ae={pages:ye({Alerting:{AddAlertRule:{url:{"10.1.0":"/alerting/new/alerting",[xe]:"/alerting/new"}},EditAlertRule:{url:{[xe]:e=>`alerting/${e}/edit`}}},Login:{url:{[xe]:"/login"},username:{"10.2.3":"data-testid Username input field",[xe]:"Username input field"},password:{"10.2.3":"data-testid Password input field",[xe]:"Password input field"},submit:{"10.2.3":"data-testid Login button",[xe]:"Login button"},skip:{"10.2.3":"data-testid Skip change password button"}},PasswordlessLogin:{url:{[xe]:"/login/passwordless/authenticate"},email:{"10.2.3":"data-testid Email input field",[xe]:"Email input field"},submit:{"10.2.3":"data-testid PasswordlessLogin button",[xe]:"PasswordlessLogin button"}},Home:{url:{[xe]:"/"}},DataSource:{name:{"10.3.0":"data-testid Data source settings page name input field",[xe]:"Data source settings page name input field"},delete:{[xe]:"Data source settings page Delete button"},readOnly:{"10.3.0":"data-testid Data source settings page read only message",[xe]:"Data source settings page read only message"},saveAndTest:{"10.0.0":"data-testid Data source settings page Save and Test button",[xe]:"Data source settings page Save and Test button"},alert:{"10.3.0":"data-testid Data source settings page Alert",[xe]:"Data source settings page Alert"}},DataSources:{url:{[xe]:"/datasources"},dataSources:{[xe]:e=>`Data source list item ${e}`}},EditDataSource:{url:{"9.5.0":e=>`/datasources/edit/${e}`},settings:{"9.5.0":"Datasource settings page basic settings"}},AddDataSource:{url:{[xe]:"/datasources/new"},dataSourcePluginsV2:{"9.3.1":e=>`Add new data source ${e}`,[xe]:e=>`Data source plugin item ${e}`}},ConfirmModal:{delete:{"10.0.0":"data-testid Confirm Modal Danger Button",[xe]:"Confirm Modal Danger Button"},input:{"12.2.0":"data-testid Confirm Modal Input"}},SecretsManagement:{SecretForm:{"12.2.0":"data-testid Secret Form"}},AddDashboard:{url:{[xe]:"/dashboard/new"},itemButton:{"9.5.0":e=>`data-testid ${e}`},addNewPanel:{"11.1.0":"data-testid Add new panel","8.0.0":"Add new panel",[xe]:"Add new panel"},itemButtonAddViz:{[xe]:"Add new visualization menu item"},addNewRow:{"11.1.0":"data-testid Add new row",[xe]:"Add new row"},addNewPanelLibrary:{"11.1.0":"data-testid Add new panel from panel library",[xe]:"Add new panel from panel library"},Settings:{Annotations:{List:{url:{[xe]:"/dashboard/new?orgId=1&editview=annotations"}},Edit:{url:{[xe]:e=>`/dashboard/new?editview=annotations&editIndex=${e}`}}},Variables:{List:{url:{"11.3.0":"/dashboard/new?orgId=1&editview=variables",[xe]:"/dashboard/new?orgId=1&editview=templating"}},Edit:{url:{"11.3.0":e=>`/dashboard/new?orgId=1&editview=variables&editIndex=${e}`,[xe]:e=>`/dashboard/new?orgId=1&editview=templating&editIndex=${e}`}}}}},ImportDashboard:{url:{[xe]:"/dashboard/import"}},Dashboard:{url:{[xe]:e=>`/d/${e}`},DashNav:{nav:{[xe]:"Dashboard navigation"},navV2:{[xe]:"data-testid Dashboard navigation"},publicDashboardTag:{"9.1.0":"data-testid public dashboard tag"},shareButton:{"10.4.0":"data-testid share-button"},scrollContainer:{"11.1.0":"data-testid Dashboard canvas scroll container"},newShareButton:{container:{"11.1.0":"data-testid new share button"},shareLink:{"11.1.0":"data-testid new share link-button"},arrowMenu:{"11.1.0":"data-testid new share button arrow menu"},menu:{container:{"11.1.0":"data-testid new share button menu"},shareInternally:{"11.1.0":"data-testid new share button share internally"},shareExternally:{"11.1.1":"data-testid new share button share externally"},shareSnapshot:{"11.2.0":"data-testid new share button share snapshot"}}},NewExportButton:{container:{"11.2.0":"data-testid new export button"},arrowMenu:{"11.2.0":"data-testid new export button arrow menu"},Menu:{container:{"11.2.0":"data-testid new export button menu"},exportAsJson:{"11.2.0":"data-testid new export button export as json"},exportAsImage:{"12.1.0":"data-testid new export button export as image"}}},playlistControls:{prev:{"11.0.0":"data-testid playlist previous dashboard button"},stop:{"11.0.0":"data-testid playlist stop dashboard button"},next:{"11.0.0":"data-testid playlist next dashboard button"}}},Controls:{"11.1.0":"data-testid dashboard controls"},SubMenu:{submenu:{[xe]:"Dashboard submenu"},submenuItem:{[xe]:"data-testid template variable"},submenuItemLabels:{[xe]:e=>`data-testid Dashboard template variables submenu Label ${e}`},submenuItemValueDropDownValueLinkTexts:{[xe]:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`},submenuItemValueDropDownDropDown:{[xe]:"Variable options"},submenuItemValueDropDownOptionTexts:{[xe]:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`},Annotations:{annotationsWrapper:{"10.0.0":"data-testid annotation-wrapper"},annotationLabel:{"10.0.0":e=>`data-testid Dashboard annotations submenu Label ${e}`},annotationToggle:{"10.0.0":e=>`data-testid Dashboard annotations submenu Toggle ${e}`}}},Settings:{Actions:{close:{"9.5.0":"data-testid dashboard-settings-close"}},General:{deleteDashBoard:{"11.1.0":"data-testid Dashboard settings page delete dashboard button"},sectionItems:{[xe]:e=>`Dashboard settings section item ${e}`},saveDashBoard:{[xe]:"Dashboard settings aside actions Save button"},saveAsDashBoard:{[xe]:"Dashboard settings aside actions Save As button"},title:{"11.2.0":"General"}},Annotations:{Edit:{urlParams:{[xe]:e=>`editview=annotations&editIndex=${e}`}},List:{url:{[xe]:e=>`/d/${e}?editview=annotations`},addAnnotationCTAV2:{[xe]:"data-testid Call to action button Add annotation query"},annotations:{"10.4.0":"data-testid list-annotations"}},Settings:{name:{"11.1.0":"data-testid Annotations settings name input",[xe]:"Annotations settings name input"}},NewAnnotation:{panelFilterSelect:{"10.0.0":"data-testid annotations-panel-filter"},showInLabel:{"11.1.0":"data-testid show-in-label"},previewInDashboard:{"10.0.0":"data-testid annotations-preview"},delete:{"10.4.0":"data-testid annotations-delete"},apply:{"10.4.0":"data-testid annotations-apply"},enable:{"10.4.0":"data-testid annotation-enable"},hide:{"10.4.0":"data-testid annotation-hide"}}},Variables:{List:{url:{"11.3.0":e=>`/d/${e}?editview=variables`,[xe]:e=>`/d/${e}?editview=templating`},addVariableCTAV2:{[xe]:"data-testid Call to action button Add variable"},newButton:{[xe]:"Variable editor New variable button"},table:{[xe]:"Variable editor Table"},tableRowNameFields:{[xe]:e=>`Variable editor Table Name field ${e}`},tableRowDefinitionFields:{"10.1.0":e=>`Variable editor Table Definition field ${e}`},tableRowArrowUpButtons:{[xe]:e=>`Variable editor Table ArrowUp button ${e}`},tableRowArrowDownButtons:{[xe]:e=>`Variable editor Table ArrowDown button ${e}`},tableRowDuplicateButtons:{[xe]:e=>`Variable editor Table Duplicate button ${e}`},tableRowRemoveButtons:{[xe]:e=>`Variable editor Table Remove button ${e}`}},Edit:{urlParams:{"11.3.0":e=>`editview=variables&editIndex=${e}`,[xe]:e=>`editview=templating&editIndex=${e}`},General:{headerLink:{[xe]:"Variable editor Header link"},modeLabelNew:{[xe]:"Variable editor Header mode New"},modeLabelEdit:{[xe]:"Variable editor Header mode Edit"},generalNameInput:{[xe]:"Variable editor Form Name field"},generalNameInputV2:{[xe]:"data-testid Variable editor Form Name field"},generalTypeSelect:{[xe]:"Variable editor Form Type select"},generalTypeSelectV2:{[xe]:"data-testid Variable editor Form Type select"},generalLabelInput:{[xe]:"Variable editor Form Label field"},generalLabelInputV2:{[xe]:"data-testid Variable editor Form Label field"},generalHideSelect:{[xe]:"Variable editor Form Hide select"},generalHideSelectV2:{[xe]:"data-testid Variable editor Form Hide select"},selectionOptionsAllowCustomValueSwitch:{[xe]:"data-testid Variable editor Form Allow Custom Value switch"},selectionOptionsMultiSwitch:{"10.4.0":"data-testid Variable editor Form Multi switch",[xe]:"Variable editor Form Multi switch"},selectionOptionsIncludeAllSwitch:{"10.4.0":"data-testid Variable editor Form IncludeAll switch",[xe]:"Variable editor Form IncludeAll switch"},selectionOptionsCustomAllInput:{"10.4.0":"data-testid Variable editor Form IncludeAll field",[xe]:"Variable editor Form IncludeAll field"},previewOfValuesOption:{"10.4.0":"data-testid Variable editor Preview of Values option",[xe]:"Variable editor Preview of Values option"},submitButton:{"10.4.0":"data-testid Variable editor Run Query button",[xe]:"Variable editor Submit button"},applyButton:{"9.3.0":"data-testid Variable editor Apply button"}},QueryVariable:{closeButton:{[xe]:"data-testid Query Variable editor close button"},editor:{[xe]:"data-testid Query Variable editor"},previewButton:{[xe]:"data-testid Query Variable editor preview button"},queryOptionsDataSourceSelect:{"10.4.0":"data-testid Select a data source","10.0.0":"data-testid Data source picker select container",[xe]:"Data source picker select container"},queryOptionsOpenButton:{[xe]:"data-testid Query Variable editor open button"},queryOptionsRefreshSelect:{[xe]:"Variable editor Form Query Refresh select"},queryOptionsRefreshSelectV2:{[xe]:"data-testid Variable editor Form Query Refresh select"},queryOptionsRegExInput:{[xe]:"Variable editor Form Query RegEx field"},queryOptionsRegExInputV2:{[xe]:"data-testid Variable editor Form Query RegEx field"},queryOptionsSortSelect:{[xe]:"Variable editor Form Query Sort select"},queryOptionsSortSelectV2:{[xe]:"data-testid Variable editor Form Query Sort select"},queryOptionsQueryInput:{"10.4.0":"data-testid Variable editor Form Default Variable Query Editor textarea"},queryOptionsStaticOptionsRow:{[xe]:"Variable editor Form Query Static Options row"},queryOptionsStaticOptionsToggle:{[xe]:"Variable editor Form Query Static Options toggle"},queryOptionsStaticOptionsLabelInput:{[xe]:"Variable editor Form Query Static Options Label input"},queryOptionsStaticOptionsValueInput:{[xe]:"Variable editor Form Query Static Options Value input"},queryOptionsStaticOptionsDeleteButton:{[xe]:"Variable editor Form Query Static Options Delete button"},queryOptionsStaticOptionsAddButton:{[xe]:"Variable editor Form Query Static Options Add button"},queryOptionsStaticOptionsOrderDropdown:{[xe]:"Variable editor Form Query Static Options Order dropdown"},valueGroupsTagsEnabledSwitch:{[xe]:"Variable editor Form Query UseTags switch"},valueGroupsTagsTagsQueryInput:{[xe]:"Variable editor Form Query TagsQuery field"},valueGroupsTagsTagsValuesQueryInput:{[xe]:"Variable editor Form Query TagsValuesQuery field"}},ConstantVariable:{constantOptionsQueryInput:{[xe]:"Variable editor Form Constant Query field"},constantOptionsQueryInputV2:{[xe]:"data-testid Variable editor Form Constant Query field"}},DatasourceVariable:{datasourceSelect:{[xe]:"data-testid datasource variable datasource type"},nameFilter:{[xe]:"data-testid datasource variable datasource name filter"}},TextBoxVariable:{textBoxOptionsQueryInput:{[xe]:"Variable editor Form TextBox Query field"},textBoxOptionsQueryInputV2:{[xe]:"data-testid Variable editor Form TextBox Query field"}},CustomVariable:{customValueInput:{[xe]:"data-testid custom-variable-input"}},IntervalVariable:{intervalsValueInput:{[xe]:"data-testid interval variable intervals input"},autoEnabledCheckbox:{"10.4.0":"data-testid interval variable auto value checkbox"},stepCountIntervalSelect:{"10.4.0":"data-testid interval variable step count input"},minIntervalInput:{"10.4.0":"data-testid interval variable mininum interval input"}},GroupByVariable:{dataSourceSelect:{"10.4.0":"data-testid Select a data source"},infoText:{"10.4.0":"data-testid group by variable info text"},modeToggle:{"10.4.0":"data-testid group by variable mode toggle"}},AdHocFiltersVariable:{datasourceSelect:{"10.4.0":"data-testid Select a data source"},infoText:{"10.4.0":"data-testid ad-hoc filters variable info text"},modeToggle:{"11.0.0":"data-testid ad-hoc filters variable mode toggle"}}}}},Annotations:{marker:{"10.0.0":"data-testid annotation-marker"}},Rows:{Repeated:{ConfigSection:{warningMessage:{"10.2.0":"data-testid Repeated rows warning message"}}}}},Dashboards:{url:{[xe]:"/dashboards"},dashboards:{"10.2.0":e=>`Dashboard search item ${e}`},toggleView:{[xe]:"data-testid radio-button"}},SaveDashboardAsModal:{newName:{"10.2.0":"Save dashboard title field"},save:{"10.2.0":"Save dashboard button"}},SaveDashboardModal:{save:{"10.2.0":"Dashboard settings Save Dashboard Modal Save button"},saveVariables:{"10.2.0":"Dashboard settings Save Dashboard Modal Save variables checkbox"},saveTimerange:{"10.2.0":"Dashboard settings Save Dashboard Modal Save timerange checkbox"},saveRefresh:{"11.1.0":"Dashboard settings Save Dashboard Modal Save refresh checkbox"},variablesWarningAlert:{"12.2.0":"Dashboard settings Save Dashboard Modal Save variables Variables With Errors Warning Alert"}},SharePanelModal:{linkToRenderedImage:{[xe]:"Link to rendered image"}},ShareDashboardModal:{PublicDashboard:{WillBePublicCheckbox:{"9.1.0":"data-testid public dashboard will be public checkbox"},LimitedDSCheckbox:{"9.1.0":"data-testid public dashboard limited datasources checkbox"},CostIncreaseCheckbox:{"9.1.0":"data-testid public dashboard cost may increase checkbox"},PauseSwitch:{"9.5.0":"data-testid public dashboard pause switch"},EnableAnnotationsSwitch:{"9.3.0":"data-testid public dashboard on off switch for annotations"},CreateButton:{"9.5.0":"data-testid public dashboard create button"},DeleteButton:{"9.3.0":"data-testid public dashboard delete button"},CopyUrlInput:{"9.1.0":"data-testid public dashboard copy url input"},CopyUrlButton:{"9.1.0":"data-testid public dashboard copy url button"},SettingsDropdown:{"10.1.0":"data-testid public dashboard settings dropdown"},TemplateVariablesWarningAlert:{"9.1.0":"data-testid public dashboard disabled template variables alert"},UnsupportedDataSourcesWarningAlert:{"9.5.0":"data-testid public dashboard unsupported data sources alert"},NoUpsertPermissionsWarningAlert:{"9.5.0":"data-testid public dashboard no upsert permissions alert"},EnableTimeRangeSwitch:{"9.4.0":"data-testid public dashboard on off switch for time range"},EmailSharingConfiguration:{Container:{"9.5.0":"data-testid email sharing config container"},ShareType:{"9.5.0":"data-testid public dashboard share type"},EmailSharingInput:{"9.5.0":"data-testid public dashboard email sharing input"},EmailSharingInviteButton:{"9.5.0":"data-testid public dashboard email sharing invite button"},EmailSharingList:{"9.5.0":"data-testid public dashboard email sharing list"},DeleteEmail:{"9.5.0":"data-testid public dashboard delete email button"},ReshareLink:{"9.5.0":"data-testid public dashboard reshare link button"}}},SnapshotScene:{url:{"11.1.0":e=>`/dashboard/snapshot/${e}`},PublishSnapshot:{"11.1.0":"data-testid publish snapshot button"},CopyUrlButton:{"11.1.0":"data-testid snapshot copy url button"},CopyUrlInput:{"11.1.0":"data-testid snapshot copy url input"}}},ShareDashboardDrawer:{ShareInternally:{container:{"11.3.0":"data-testid share internally drawer container"},lockTimeRangeSwitch:{"11.3.0":"data-testid share internally lock time range switch"},shortenUrlSwitch:{"11.3.0":"data-testid share internally shorten url switch"},copyUrlButton:{"11.3.0":"data-testid share internally copy url button"},SharePanel:{preview:{"11.5.0":"data-testid share panel internally image generation preview"},widthInput:{"11.5.0":"data-testid share panel internally width input"},heightInput:{"11.5.0":"data-testid share panel internally height input"},scaleFactorInput:{"11.5.0":"data-testid share panel internally scale factor input"},generateImageButton:{"11.5.0":"data-testid share panel internally generate image button"},downloadImageButton:{"11.5.0":"data-testid share panel internally download image button"}}},ShareExternally:{container:{"11.3.0":"data-testid share externally drawer container"},publicAlert:{"11.3.0":"data-testid public share alert"},emailSharingAlert:{"11.3.0":"data-testid email share alert"},shareTypeSelect:{"11.3.0":"data-testid share externally share type select"},Creation:{PublicShare:{createButton:{"11.3.0":"data-testid public share dashboard create button"},cancelButton:{"11.3.0":"data-testid public share dashboard cancel button"}},EmailShare:{createButton:{"11.3.0":"data-testid email share dashboard create button"},cancelButton:{"11.3.0":"data-testid email share dashboard cancel button"}},willBePublicCheckbox:{"11.3.0":"data-testid share dashboard will be public checkbox"}},Configuration:{enableTimeRangeSwitch:{"11.3.0":"data-testid share externally enable time range switch"},enableAnnotationsSwitch:{"11.3.0":"data-testid share externally enable annotations switch"},copyUrlButton:{"11.3.0":"data-testid share externally copy url button"},revokeAccessButton:{"11.3.0":"data-testid share externally revoke access button"},toggleAccessButton:{"11.3.0":"data-testid share externally pause or resume access button"}}},ShareSnapshot:{url:{"11.3.0":e=>`/dashboard/snapshot/${e}`},container:{"11.3.0":"data-testid share snapshot drawer container"},publishSnapshot:{"11.3.0":"data-testid share snapshot publish button"},copyUrlButton:{"11.3.0":"data-testid share snapshot copy url button"}}},ExportDashboardDrawer:{ExportAsJson:{container:{"11.3.0":"data-testid export as json drawer container"},codeEditor:{"11.3.0":"data-testid export as json code editor"},exportExternallyToggle:{"11.3.0":"data-testid export as json externally switch"},saveToFileButton:{"11.3.0":"data-testid export as json save to file button"},copyToClipboardButton:{"11.3.0":"data-testid export as json copy to clipboard button"},cancelButton:{"11.3.0":"data-testid export as json cancel button"}}},PublicDashboard:{page:{"9.5.0":"public-dashboard-page"},NotAvailable:{container:{"9.5.0":"public-dashboard-not-available"},title:{"9.5.0":"public-dashboard-title"},pausedDescription:{"9.5.0":"public-dashboard-paused-description"}},footer:{"11.0.0":"public-dashboard-footer"}},PublicDashboardScene:{loadingPage:{"11.0.0":"public-dashboard-scene-loading-page"},page:{"11.0.0":"public-dashboard-scene-page"},controls:{"11.0.0":"public-dashboard-controls"}},RequestViewAccess:{form:{"9.5.0":"request-view-access-form"},recipientInput:{"9.5.0":"request-view-access-recipient-input"},submitButton:{"9.5.0":"request-view-access-submit-button"}},PublicDashboardConfirmAccess:{submitButton:{"10.2.0":"data-testid confirm-access-submit-button"}},Explore:{url:{[xe]:"/explore"},General:{container:{[xe]:"data-testid Explore"},graph:{[xe]:"Explore Graph"},table:{[xe]:"Explore Table"},scrollView:{"9.0.0":"data-testid explorer scroll view"},addFromQueryLibrary:{"11.5.0":"data-testid explore add from query library button"}},QueryHistory:{container:{"11.1.0":"data-testid QueryHistory"}}},SoloPanel:{url:{[xe]:e=>`/d-solo/${e}`}},PluginsList:{page:{[xe]:"Plugins list page"},list:{[xe]:"Plugins list"},listItem:{[xe]:"Plugins list item"},signatureErrorNotice:{"10.3.0":"data-testid Unsigned plugins notice",[xe]:"Unsigned plugins notice"}},PluginPage:{page:{[xe]:"Plugin page"},signatureInfo:{"10.3.0":"data-testid Plugin signature info",[xe]:"Plugin signature info"},disabledInfo:{"10.3.0":"data-testid Plugin disabled info",[xe]:"Plugin disabled info"}},PlaylistForm:{name:{[xe]:"Playlist name"},interval:{[xe]:"Playlist interval"},itemDelete:{"10.2.0":"data-testid playlist-form-delete-item"}},BrowseDashboards:{table:{body:{"10.2.0":"data-testid browse-dashboards-table"},row:{"10.2.0":e=>`data-testid browse dashboards row ${e}`},checkbox:{"10.0.0":e=>`data-testid ${e} checkbox`}},NewFolderForm:{form:{"10.2.0":"data-testid new folder form"},nameInput:{"10.2.0":"data-testid new-folder-name-input"},createButton:{"10.2.0":"data-testid new-folder-create-button"}}},SearchDashboards:{table:{"10.2.0":"Search results table"}},Search:{url:{"9.3.0":"/?search=openn"},FolderView:{url:{"9.3.0":"/?search=open&layout=folders"}}},PublicDashboards:{ListItem:{linkButton:{"9.3.0":"public-dashboard-link-button"},configButton:{"9.3.0":"public-dashboard-configuration-button"},trashcanButton:{"9.3.0":"public-dashboard-remove-button"},pauseSwitch:{"10.1.0":"data-testid public dashboard pause switch"}}},UserListPage:{tabs:{allUsers:{"10.0.0":"data-testid all-users-tab"},orgUsers:{"10.0.0":"data-testid org-users-tab"},anonUserDevices:{"10.2.3":"data-testid anon-user-devices-tab"},publicDashboardsUsers:{"10.0.0":"data-testid public-dashboards-users-tab"},users:{"10.0.0":"data-testid users-tab"}},org:{url:{"10.2.0":"/admin/users","9.5.0":"/org/users"}},admin:{url:{"9.5.0":"/admin/users"}},publicDashboards:{container:{"11.1.0":"data-testid public-dashboards-users-list"}},UserListAdminPage:{container:{"10.0.0":"data-testid user-list-admin-page"}},UsersListPage:{container:{"10.0.0":"data-testid users-list-page"}},UserAnonListPage:{container:{"10.4.0":"data-testid user-anon-list-page"}},UsersListPublicDashboardsPage:{container:{"10.0.0":"data-testid users-list-public-dashboards-page"},DashboardsListModal:{listItem:{"10.0.0":e=>`data-testid dashboards-list-item-${e}`}}}},ProfilePage:{url:{"10.2.0":"/profile"}},Plugin:{url:{[xe]:e=>`/plugins/${e}`}},MigrateToCloud:{url:{"11.2.0":"/admin/migrate-to-cloud"}}}),components:ye(ke)};var Pe=r(3292);function Ee(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function ze(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){Ee(a,o,s,n,i,"next",e)}function i(e){Ee(a,o,s,n,i,"throw",e)}n(void 0)}))}}function Ce(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){Ce(e,t,r[t])}))}return e}function De(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Ne=(e,t,r,o)=>{"filters"===e?t[e]=r.map((e=>e.value)):(t[e]=r.value,"property"===e&&(t.filters=[])),o(t)};const Ie=e=>{const{data:t,innerProps:r,innerRef:s,isFocused:a,isSelected:n}=e,i=(0,u.useTheme2)(),c=(0,u.getSelectStyles)(i),l=r=>{e.selectOption(Te({},t)),r.stopPropagation(),r.preventDefault()};return(0,o.jsx)("div",De(Te({ref:s,className:(0,h.cx)(c.option,a&&c.optionFocused,n&&c.optionSelected,t.isDisabled&&c.optionDisabled)},r),{"data-testid":Ae.components.Select.option,title:t.title,onClick:l,onKeyDown:l,role:"checkbox","aria-checked":n,tabIndex:0,children:(0,o.jsx)("div",{className:c.optionBody,children:(0,o.jsx)(u.Checkbox,{value:n,label:t.label?`${t.label} - (${t.count})`:""})})}))},Re=e=>{const{query:t,datasource:r,propertyMap:s,setPropertyMap:n,queryTraceTypes:l,properties:d,item:p,onChange:m,onDelete:f,variableOptionGroup:b,range:h}=e,[g,v]=(0,a.useState)(!1);var y,w;const[O,j]=(0,a.useState)((0,Q.qP)(null!==(w=s.get(null!==(y=p.property)&&void 0!==y?y:""))&&void 0!==w?w:[],b)),[S,x]=(0,a.useState)(p.filters?p.filters.map((e=>({value:e,label:""===e?"<Empty>":e}))):[]),k=()=>ze((function*(){if(v(!0),p.property&&""!==p.property){var e;const o=s.get(null!==(e=p.property)&&void 0!==e?e:"");if(o)return j((0,Q.qP)(o,b)),v(!1),Promise.resolve(o);{const e=yield((e,t,r,o,s,a,n)=>ze((function*(){const{azureTraces:c}=e;if(!c)return[];const{resources:l}=c;if(!l||!a)return[];const u=a.property;if(!u)return[];const d=`let ${u} = toscalar(union isfuzzy=true ${r.join(",")}\n  | where $__timeFilter(timestamp)\n  | summarize count=count() by ${u}\n  | summarize make_list(pack_all()));\n  print properties = bag_pack("${u}", ${u});`,p=yield(0,ge.lastValueFrom)(t.azureLogAnalyticsDatasource.query({requestId:"azure-traces-properties-req",interval:"",intervalMs:0,scopedVars:{},timezone:"",startTime:0,app:i.CoreApp.Unknown,targets:[De(Te({},e),{azureLogAnalytics:{resources:l,query:d},queryType:Pe.oj.LogAnalytics})],range:n||(0,i.getDefaultTimeRange)()}));if(p.data.length>0){const e=p.data[0];if(e.fields.length>0){const t=JSON.parse(e.fields[0].values.toArray()[0])[u].map((e=>{let t=e[u];return""===e[u]&&(t="<Empty>"),{label:t.toString(),value:e[u].toString(),count:e.count}}));return o.set(u,t),s(o),t}}return[]}))())(t,r,l,s,n,p,h);return j((0,Q.qP)(e,b)),v(!1),e}}return Promise.resolve([])}))();return(0,o.jsxs)(u.Stack,{gap:0,children:[(0,o.jsx)(u.Select,{menuShouldPortal:!0,placeholder:(0,c.t)("components.filter.placeholder-property","Property"),value:p.property?{value:p.property,label:p.property}:null,options:(0,Q.qP)(d.map((e=>({label:e,value:e}))),b),onChange:e=>Ne("property",p,e,m),width:25}),(0,o.jsx)(u.ButtonSelect,{value:p.operation?{label:"eq"===p.operation?"=":"!=",value:p.operation}:void 0,options:[{label:"=",value:"eq"},{label:"!=",value:"ne"}],onChange:e=>Ne("operation",p,e,m),defaultValue:"eq"}),(0,o.jsx)(u.AsyncMultiSelect,{blurInputOnSelect:!1,menuShouldPortal:!0,placeholder:(0,c.t)("components.filter.placeholder-value","Value"),value:S,loadOptions:k,isLoading:g,onOpenMenu:k,onChange:e=>{x(e),0===e.length&&Ne("filters",p,S,m)},width:35,defaultOptions:O,isClearable:!0,components:{Option:Ie},closeMenuOnSelect:!1,onCloseMenu:()=>Ne("filters",p,S,m),hideSelectedOptions:!1}),(0,o.jsx)($.Z,{"aria-label":(0,c.t)("components.filter.aria-label-remove-filter","Remove filter"),icon:"times",variant:"secondary",onClick:f,type:"button"})]})};function Le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){Le(e,t,r[t])}))}return e}function qe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const $e={availabilityResults:{label:"Availablity Results",description:"Availability test results."},dependencies:{label:"Dependencies",description:"Calls your application makes to other services such as databases or REST APIs."},customEvents:{label:"Custom Events",description:"Calls to TrackEvent that are inserted to monitor usage."},exceptions:{label:"Exceptions",description:"Exceptions that are logged via TrackException, or uncaught exceptions."},pageViews:{label:"Page Views",description:"Web client telemetry to create page view reports."},requests:{label:"Requests",description:"HTTP requests received by the application."},traces:{label:"Traces",description:"Diagnostic logs emitted using TrackTrace and similar methods. Note: Traces are not visualised if the result format is set to Trace"}},Ge=["operationId","duration","id","name","problemId","operation_ParentId","timestamp","customDimensions","operation_Name"],Fe={appId:"ResourceGUID",application_Version:"AppVersion",appName:"_ResourceId",client_Browser:"ClientBrowser",client_City:"ClientCity",client_CountryOrRegion:"ClientCountryOrRegion",client_IP:"ClientIP",client_Model:"ClientModel",client_OS:"ClientOS",client_StateOrProvince:"ClientStateOrProvince",client_Type:"ClientType",cloud_RoleInstance:"AppRoleInstance",cloud_RoleName:"AppRoleName",customDimensions:"Properties",customMeasurements:"Measurements",duration:"DurationMs",id:"Id",iKey:"IKey",itemCount:"ItemCount",itemId:"_ItemId",itemType:"Type",name:"Name",operation_Id:"OperationId",operation_Name:"OperationName",operation_ParentId:"OperationParentId",operation_SyntheticSource:"OperationSyntheticSource",performanceBucket:"PerformanceBucket",sdkVersion:"SDKVersion",session_Id:"SessionId",success:"Success",timestamp:"TimeGenerated",user_AccountId:"UserAccountId",user_AuthenticatedId:"UserAuthenticatedId",user_Id:"UserId"},_e=qe(Me({},Fe),{location:"Location",message:"Message",size:"Size"}),Ve=qe(Me({},Fe),{data:"Data",resultCode:"ResultCode",target:"Target",type:"DependencyType"}),Be=(0,s.omit)(Fe,["duration","id","success","performanceBucket"]),Qe=(0,s.omit)(qe(Me({},Fe),{url:"Url"}),["success"]),Ue={availabilityResults:_e,dependencies:Ve,customEvents:Be,exceptions:(0,s.omit)(qe(Me({},Fe),{assembly:"Assembly",details:"Details",handledAt:"HandledAt",innermostAssembly:"InnermostAssembly",innermostMessage:"InnermostMessage",innermostMethod:"InnermostMethod",innermostType:"InnermostType",message:"Message",method:"Method",outerAssembly:"OuterAssembly",outerMessage:"OuterMessage",outerMethod:"OuterMethod",outerType:"OuterType",problemId:"ProblemId",severityLevel:"SeverityLevel",type:"ExceptionType"}),["duration","id","name","performanceBucket","success"]),pageViews:Qe,requests:{resultCode:"ResultCode",source:"Source",url:"Url"},traces:(0,s.omit)({message:"Message",severityLevel:"SeverityLevel"},["duration","id","name","performanceBucket","success"])};Object.entries(Ue).reduce(((e,[t,r])=>qe(Me({},e),{[t]:Object.keys((0,s.omit)(r,Ge)).join(",")})),{});function Xe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){Xe(e,t,r[t])}))}return e}function He(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ke(e,t){return He(We({},e),{azureTraces:He(We({},e.azureTraces),{resultFormat:t})})}function Je(e,t){return He(We({},e),{azureTraces:He(We({},e.azureTraces),{traceTypes:t})})}function Ze(e,t,r){var o;(null===(o=e.azureTraces)||void 0===o?void 0:o.resultFormat)||r({value:t})}const Ye=({query:e,datasource:t,onQueryChange:r,variableOptionGroup:n,range:i})=>{var l,d,p,m;const{azureTraces:f}=e,b=(null==f?void 0:f.traceTypes)?f.traceTypes:Object.keys(Ue),h=new Set(["customDimensions","customMeasurements","details","duration","id","itemId","operation_Id","operation_ParentId","timestamp"]),g=(0,s.uniq)(b.map((e=>Object.keys(Ue[e]))).flat()).filter((e=>!h.has(e))),[v,y]=(0,a.useState)(new Map),w=(0,a.useMemo)((()=>{var t,r;return null!==(r=null===(t=e.azureTraces)||void 0===t?void 0:t.filters)&&void 0!==r?r:[]}),[null===(l=e.azureTraces)||void 0===l?void 0:l.filters]),[O,j]=(0,a.useState)(w);(0,a.useEffect)((()=>{y(new Map)}),[null===(d=e.azureTraces)||void 0===d?void 0:d.resources,null===(p=e.azureTraces)||void 0===p?void 0:p.traceTypes,null===(m=e.azureTraces)||void 0===m?void 0:m.operationId]);return(0,o.jsx)(u.Field,{label:(0,c.t)("components.filters.label-filters","Filters"),children:(0,o.jsx)(H.o,{items:O,onChange:t=>{let o=!1;const s=t.map((e=>{var t,r,s;return o=!!(""!==e.property&&e.filters&&e.filters.length>0&&""!==e.operation),{property:null!==(t=e.property)&&void 0!==t?t:"",filters:null!==(r=e.filters)&&void 0!==r?r:[],operation:null!==(s=e.operation)&&void 0!==s?s:"eq"}}));j(s),(o||w.length>0&&0===s.length)&&r(function(e,t){return He(We({},e),{azureTraces:He(We({},e.azureTraces),{filters:t})})}(e,s))},renderItem:(S={query:e,datasource:t,propertyMap:v,setPropertyMap:y,queryTraceTypes:b,properties:g,variableOptionGroup:n,range:i},function(e,t,r){return(0,o.jsx)(Re,De(Te({},S),{item:e,onChange:t,onDelete:r}))})})});var S},et=({query:e,variableOptionGroup:t,onQueryChange:r})=>{var s;const n=Object.entries($e).map((([e,t])=>({label:t.label,description:t.description,value:e}))),i=(0,a.useCallback)((t=>{const o=Je(e,t.map((e=>{var t;return null!==(t=e.value)&&void 0!==t?t:""})));r(o)}),[r,e]),l=(0,a.useMemo)((()=>[...n,t]),[n,t]);var p;return(0,o.jsx)(U.D,{label:(0,c.t)("components.trace-type-field.label-event-type","Event Type"),children:(0,o.jsx)(u.MultiSelect,{placeholder:(0,c.t)("components.trace-type-field.placeholder-event-type","Choose event types"),inputId:"azure-monitor-traces-type-field",value:(0,Q.Mz)([...n,...t.options],null!==(p=null===(s=e.azureTraces)||void 0===s?void 0:s.traceTypes)&&void 0!==p?p:(()=>{const t=n.map((e=>e.value)),o=Je(e,t);return r(o),t})()),onChange:i,options:l,allowCustomValue:!0,isClearable:!0,"aria-label":d.T.components.queryEditor.tracesQueryEditor.traceTypes.select})})},tt=({query:e,datasource:t,subscriptionId:r,variableOptionGroup:s,onChange:n,setError:i,range:l})=>{var m,f,b,h;var g;const[v,y]=(0,a.useState)(null!==(g=null===(m=e.azureTraces)||void 0===m?void 0:m.operationId)&&void 0!==g?g:""),w=(O=null===(f=e.azureTraces)||void 0===f?void 0:f.operationId,j=(0,a.useRef)(),(0,a.useEffect)((function(){j.current=O})),j.current);var O,j;(0,a.useEffect)((()=>{var t;(null===(t=e.azureTraces)||void 0===t?void 0:t.operationId)&&w!==e.azureTraces.operationId&&y(e.azureTraces.operationId)}),[y,w,e,v]);const S=(0,a.useCallback)((t=>{t.target instanceof HTMLInputElement&&(y(t.target.value),e.queryType===p.o.TraceExemplar&&""===t.target.value&&n(function(e){return He(We({},e),{query:void 0,queryType:p.o.AzureTraces,azureTraces:void 0})}(e)))}),[n,e]),x=(0,a.useCallback)((t=>{const r=function(e,t){return He(We({},e),{azureTraces:He(We({},e.azureTraces),{operationId:t})})}(e,v);n(r)}),[n,v,e]);var k;return(0,o.jsx)("span",{"data-testid":d.T.components.queryEditor.tracesQueryEditor.container.input,children:(0,o.jsxs)(D.D,{children:[(0,o.jsx)(N.U,{children:(0,o.jsx)(I.B,{children:(0,o.jsx)(L.A,{query:e,datasource:t,subscriptionId:r,variableOptionGroup:s,onQueryChange:n,setError:i,selectableEntryTypes:[M.X.Subscription,M.X.ResourceGroup,M.X.Resource,M.X.Variable],resources:null!==(k=null===(b=e.azureTraces)||void 0===b?void 0:b.resources)&&void 0!==k?k:[],queryType:"traces",disableRow:(e,t)=>{var r,o;if(0===t.length)return!1;return(null===(r=(0,q.oU)(e.uri,e.location).metricNamespace)||void 0===r?void 0:r.toLowerCase())!==(null===(o=(0,q.oU)(t[0].uri,t[0].location).metricNamespace)||void 0===o?void 0:o.toLowerCase())},renderAdvanced:(e,t)=>(0,o.jsx)(be.A,{resources:e,onChange:t}),selectionNotice:()=>"You may only choose items of the same resource type.",range:l})})}),(0,o.jsx)(N.U,{children:(0,o.jsxs)(I.B,{children:[(0,o.jsx)(et,{datasource:t,onQueryChange:n,query:e,setError:i,variableOptionGroup:s,range:l}),(0,o.jsx)(U.D,{label:(0,c.t)("components.traces-query-editor.label-operation-id","Operation ID"),children:(0,o.jsx)(u.Input,{id:"azure-monitor-traces-operation-id-field",value:v,onChange:S,onBlur:x,width:40})})]})}),(0,o.jsx)(N.U,{children:(0,o.jsx)(I.B,{children:(0,o.jsx)(Ye,{datasource:t,onQueryChange:n,query:e,setError:i,variableOptionGroup:s,range:l})})}),(0,o.jsx)(N.U,{children:(0,o.jsx)(I.B,{children:(0,o.jsx)(he.A,{datasource:t,setError:i,query:e,variableOptionGroup:s,onQueryChange:n,inputId:"azure-monitor-traces",options:[{label:"Table",value:p.f.Table},{label:"Trace",value:p.f.Trace}],defaultValue:p.f.Table,setFormatAs:Ke,resultFormat:null===(h=e.azureTraces)||void 0===h?void 0:h.resultFormat,range:l,onLoad:Ze})})})]})})},rt=({children:e})=>{const t=(0,u.useStyles2)(ot);return a.createElement("div",{className:t.root},e)},ot=e=>({root:(0,h.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:e.spacing(3),minHeight:e.spacing(4)})});function st({label:e,...t}){const[r]=(0,a.useState)((()=>Math.random().toString(16).slice(2))),o=(0,u.useStyles2)(it),s={SelectContainer:at,ValueContainer:nt,SingleValue:nt};return a.createElement("div",{className:o.root},e&&a.createElement("label",{className:o.label,htmlFor:r},e,":",""),a.createElement(u.Select,{openMenuOnFocus:!0,inputId:r,...t,components:s}))}const at=e=>{const{children:t}=e,r=(0,u.useStyles2)(it);return a.createElement(u.SelectContainer,{...e,className:(0,h.cx)(e.className,r.container)},t)},nt=e=>{const{className:t,children:r}=e,o=(0,u.useStyles2)(it);return a.createElement("div",{className:(0,h.cx)(t,o.valueContainer)},r)},it=e=>({root:(0,h.css)({display:"flex",fontSize:12,alignItems:"center"}),label:(0,h.css)({color:e.colors.text.secondary,whiteSpace:"nowrap"}),container:(0,h.css)({background:"none",borderColor:"transparent"}),valueContainer:(0,h.css)({display:"flex",alignItems:"center",flex:"initial",color:e.colors.text.secondary,fontSize:12})}),ct=({grow:e,shrink:t})=>a.createElement("div",{style:{display:"block",flexGrow:e,flexShrink:t}});function lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){lt(e,t,r[t])}))}return e}function dt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const pt=({query:e,onQueryChange:t,setAzureLogsCheatSheetModalOpen:r,data:s,app:n,onRunQuery:m})=>{var f,b,h,g;const v=(0,a.useMemo)((()=>(null==s?void 0:s.state)===i.LoadingState.Loading),[null==s?void 0:s.state]),[y,w]=(0,a.useState)(!1),[O,j]=(0,a.useState)(null),S=[{label:(0,c.t)("components.query-header.editor-modes.label-builder","Builder"),value:Pe.O8.Builder},{label:(0,c.t)("components.query-header.editor-modes.label-kql","KQL"),value:Pe.O8.Raw}],x=null===(f=e.azureLogAnalytics)||void 0===f?void 0:f.mode,k=[{value:p.o.AzureMonitor,label:"Metrics"},{value:p.o.LogAnalytics,label:"Logs"},{value:p.o.AzureTraces,label:"Traces"},{value:p.o.AzureResourceGraph,label:"Azure Resource Graph"}],A=(0,a.useCallback)((r=>{r.value&&r.value!==e.queryType&&t(dt(ut({},e),{queryType:r.value}))}),[t,e]);(0,a.useEffect)((()=>{if(e.azureLogAnalytics&&void 0===e.azureLogAnalytics.mode){var r,o;const s=dt(ut({},e),{azureLogAnalytics:dt(ut({},e.azureLogAnalytics),{mode:void 0===(null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.builderQuery)&&void 0!==(null===(o=e.azureLogAnalytics)||void 0===o?void 0:o.query)||!l.config.featureToggles.azureMonitorLogsBuilderEditor?Pe.O8.Raw:Pe.O8.Builder,dashboardTime:!0})});t(s)}}),[e,t]);const P=r=>{var o;const s=dt(ut({},e),{azureLogAnalytics:dt(ut({},e.azureLogAnalytics),{mode:r,query:"",builderQuery:r===Pe.O8.Raw||null===(o=e.azureLogAnalytics)||void 0===o?void 0:o.builderQuery,dashboardTime:r===Pe.O8.Builder||void 0})});t(s)};return(0,o.jsx)("span",{"data-testid":d.T.components.queryEditor.header.select,children:(0,o.jsxs)(rt,{children:[(0,o.jsx)(u.ConfirmModal,{isOpen:y,title:(0,c.t)("components.query-header.title-switch-mode","Switch editor mode?"),body:O===Pe.O8.Builder?(0,c.t)("components.query-header.body-switching-to-builder","Switching to Builder will discard your current KQL query and clear the KQL editor. Are you sure?"):(0,c.t)("components.query-header.body-switching-to-kql","Switching to KQL will discard your current builder settings. Are you sure?"),confirmText:(0,c.t)("components.query-header.confirmText-switch-to","Switch to {{newMode}}",{newMode:O===Pe.O8.Builder?"Builder":"KQL"}),onConfirm:()=>{O&&P(O),w(!1),j(null)},onDismiss:()=>{w(!1),j(null)}}),(0,o.jsx)(st,{label:(0,c.t)("components.query-header.label-service","Service"),value:e.queryType===p.o.TraceExemplar?p.o.AzureTraces:e.queryType,placeholder:(0,c.t)("components.query-header.placeholder-service","Service..."),allowCustomValue:!0,options:k,onChange:A}),e.queryType===p.o.LogAnalytics&&(null===(b=e.azureLogAnalytics)||void 0===b?void 0:b.mode)===Pe.O8.Raw&&(0,o.jsx)(u.Button,{"aria-label":(0,c.t)("components.query-header.aria-label-kick-start","Azure logs kick start your query button"),variant:"secondary",size:"sm",onClick:()=>{r((e=>!e)),(0,l.reportInteraction)("grafana_azure_logs_query_patterns_opened",{version:"v2",editorMode:e.azureLogAnalytics})},children:(0,o.jsx)(c.x6,{i18nKey:"components.query-header.button-kick-start-your-query",children:"Kick start your query"})}),(0,o.jsx)(ct,{grow:1}),e.queryType===p.o.LogAnalytics&&!!l.config.featureToggles.azureMonitorLogsBuilderEditor&&(0,o.jsx)(u.RadioButtonGroup,{size:"sm",options:S,value:(null===(h=e.azureLogAnalytics)||void 0===h?void 0:h.mode)||Pe.O8.Builder,onChange:t=>{var r,o;if(t===x)return;const s=t===Pe.O8.Builder,a=t===Pe.O8.Raw,n=!!(null===(r=e.azureLogAnalytics)||void 0===r?void 0:r.query),i=!!(null===(o=e.azureLogAnalytics)||void 0===o?void 0:o.builderQuery);s&&n||a&&i?(j(t),w(!0)):P(t)},"data-testid":"azure-query-header-logs-radio-button"}),(null===(g=e.azureLogAnalytics)||void 0===g?void 0:g.mode)===Pe.O8.Builder&&!!l.config.featureToggles.azureMonitorLogsBuilderEditor&&n!==i.CoreApp.Explore&&(0,o.jsx)(u.Button,{variant:"primary",icon:v?"spinner":"play",size:"sm",onClick:m,"data-testid":d.T.components.queryEditor.logsQueryEditor.runQuery.button,children:(0,o.jsx)(c.x6,{i18nKey:"components.query-header.button-run-query",children:"Run query"})})]})})};var mt=r(4513),ft=r.n(mt),bt=r(6463);const ht={queryType:p.o.AzureMonitor},gt=(e,t)=>{const r=((e,t)=>(e.queryType!==p.o.TraceExemplar||""===e.query||e.azureTraces||(e.azureTraces={operationId:e.query,resultFormat:p.f.Trace,resources:[`/subscriptions/${t}`]}),e))((0,s.defaults)({},e,ht),t),o=(0,bt.A)(r);return ft()(o,e)?e:o},vt=(e,t,r)=>{const o=(0,a.useMemo)((()=>gt(e,r)),[e,r]);return(0,a.useEffect)((()=>{o!==e&&t(o)}),[o,e,t]),o};function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Ot=({data:e,subscriptionId:t,basicLogsEnabled:r,query:s,datasource:a,variableOptionGroup:n,onChange:i,setError:l,onQueryChange:d,range:m})=>{switch(s.queryType){case p.o.AzureMonitor:return(0,o.jsx)(fe,{data:e,query:s,datasource:a,onChange:i,variableOptionGroup:n,setError:l});case p.o.LogAnalytics:return(0,o.jsx)(b.A,{data:e,subscriptionId:t,basicLogsEnabled:r,query:s,datasource:a,onChange:i,variableOptionGroup:n,setError:l,timeRange:m,onQueryChange:d});case p.o.AzureResourceGraph:return(0,o.jsx)(f.A,{subscriptionId:t,query:s,datasource:a,onChange:i,variableOptionGroup:n,setError:l});case p.o.AzureTraces:case p.o.TraceExemplar:return(0,o.jsx)(tt,{subscriptionId:t,query:s,datasource:a,onChange:i,variableOptionGroup:n,setError:l,range:m});default:const h=s.queryType;return(0,o.jsx)(u.Alert,{title:(0,c.t)("components.editor-for-query-type.title-unknown-query-type","Unknown query type"),children:("Application Insights"===h||"Insights Analytics"===h)&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(c.x6,{i18nKey:"components.editor-for-query-type.body-unknown-query-type",children:[{type:h}," was deprecated in Grafana 9. See the"," ",(0,o.jsx)(u.TextLink,{href:"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/#application-insights-and-insights-analytics-removed",external:!0,children:"deprecation notice"})," ","to get more information about how to migrate your queries. This is the current query definition:"]}),(0,o.jsx)(u.CodeEditor,{height:"200px",readOnly:!0,language:"json",value:JSON.stringify(s,null,4)})]})})}},jt=()=>(0,o.jsx)(u.Alert,{title:(0,c.t)("components.user-auth-alert.title-unsupported-auth","Unsupported authentication provider"),"data-testid":d.T.components.queryEditor.userAuthAlert,children:(0,o.jsxs)(c.x6,{i18nKey:"components.user-auth-alert.body-unsupported-auth",children:["Usage of this data source requires you to be authenticated via Azure Entra (formerly Azure Active Directory). Please review the"," ",(0,o.jsx)(u.TextLink,{href:"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/#configure-current-user-authentication",external:!0,children:"documentation"})," ","for more information."]})}),St=()=>(0,o.jsx)(u.Alert,{title:(0,c.t)("components.user-auth-fallback-alert.title-no-fallback-credentials","No fallback credentials available"),"data-testid":d.T.components.queryEditor.userAuthFallbackAlert,children:(0,o.jsxs)(c.x6,{i18nKey:"components.user-auth-fallback-alert.body-no-fallback-credentials",children:["Data source backend features (such as alerting) require service credentials to function. This data source is configured without service credential fallback, or the fallback functionality is disabled. Please review the"," ",(0,o.jsx)(u.TextLink,{href:"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/#configure-current-user-authentication",external:!0,children:"documentation"})," ","for more information."]})}),xt=({app:e,query:t,datasource:r,onChange:d,onRunQuery:f,data:b,range:h})=>{const[g,v]=(0,m.A)(),y=(0,a.useMemo)((()=>(0,s.debounce)(f,500)),[f]),[w,O]=(0,a.useState)(!1),[j,S]=(0,a.useState)(""),x=(0,a.useCallback)((e=>{d(e),y()}),[d,y]);(0,n.A)((()=>{t.queryType===p.o.TraceExemplar&&r.azureLogAnalyticsDatasource.getDefaultOrFirstSubscription().then((e=>{S(e||"")}))}));const k=vt(t,x,j),A=k.subscription||r.azureMonitorDatasource.defaultSubscriptionId,P=r.azureMonitorDatasource.basicLogsEnabled&&e!==i.CoreApp.UnifiedAlerting&&e!==i.CoreApp.CloudAlerting,E={label:"Template Variables",options:r.getVariables().map((e=>({label:e,value:e})))},z="oauth_azuread"===l.config.bootData.user.authenticatedBy||"authproxy"===l.config.bootData.user.authenticatedBy;if(r.currentUserAuth){if(!(e!==i.CoreApp.UnifiedAlerting||l.config.azure.userIdentityFallbackCredentialsEnabled&&r.currentUserAuthFallbackAvailable))return(0,o.jsx)(St,{});if(!z)return(0,o.jsx)(jt,{})}return(0,o.jsxs)("div",{"data-testid":"azure-monitor-query-editor",children:[(0,o.jsx)(T,{datasource:r.azureLogAnalyticsDatasource,isOpen:w,onClose:()=>O(!1),onChange:e=>d(wt(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){yt(e,t,r[t])}))}return e}({},e),{queryType:p.o.LogAnalytics}))}),(0,o.jsx)(pt,{query:k,onQueryChange:x,setAzureLogsCheatSheetModalOpen:O,onRunQuery:f,data:b,app:e}),(0,o.jsx)(Ot,{data:b,subscriptionId:A,basicLogsEnabled:null!=P&&P,query:k,datasource:r,onChange:x,onQueryChange:d,variableOptionGroup:E,setError:v,range:h}),g&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Space,{v:2}),(0,o.jsx)(u.Alert,{severity:"error",title:(0,c.t)("components.query-editor.alert-error-occurred","An error occurred while requesting metadata from Azure Monitor"),children:g instanceof Error?g.message:g})]})]})}},5750:(e,t,r)=>{"use strict";const{MAX_SAFE_COMPONENT_LENGTH:o,MAX_SAFE_BUILD_LENGTH:s,MAX_LENGTH:a}=r(2074),n=r(1064),i=(t=e.exports={}).re=[],c=t.safeRe=[],l=t.src=[],u=t.safeSrc=[],d=t.t={};let p=0;const m="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",a],[m,s]],b=(e,t,r)=>{const o=(e=>{for(const[t,r]of f)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),s=p++;n(e,s,t),d[e]=s,l[s]=t,u[s]=o,i[s]=new RegExp(t,r?"g":void 0),c[s]=new RegExp(o,r?"g":void 0)};b("NUMERICIDENTIFIER","0|[1-9]\\d*"),b("NUMERICIDENTIFIERLOOSE","\\d+"),b("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),b("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`),b("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`),b("PRERELEASEIDENTIFIER",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIER]})`),b("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIERLOOSE]})`),b("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`),b("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`),b("BUILDIDENTIFIER",`${m}+`),b("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`),b("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`),b("FULL",`^${l[d.FULLPLAIN]}$`),b("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`),b("LOOSE",`^${l[d.LOOSEPLAIN]}$`),b("GTLT","((?:<|>)?=?)"),b("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),b("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`),b("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`),b("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`),b("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`),b("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`),b("COERCEPLAIN",`(^|[^\\d])(\\d{1,${o}})(?:\\.(\\d{1,${o}}))?(?:\\.(\\d{1,${o}}))?`),b("COERCE",`${l[d.COERCEPLAIN]}(?:$|[^\\d])`),b("COERCEFULL",l[d.COERCEPLAIN]+`(?:${l[d.PRERELEASE]})?`+`(?:${l[d.BUILD]})?(?:$|[^\\d])`),b("COERCERTL",l[d.COERCE],!0),b("COERCERTLFULL",l[d.COERCEFULL],!0),b("LONETILDE","(?:~>?)"),b("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",b("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`),b("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`),b("LONECARET","(?:\\^)"),b("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",b("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`),b("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`),b("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`),b("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`),b("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",b("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`),b("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`),b("STAR","(<|>)?=?\\s*\\*"),b("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),b("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},5777:(e,t,r)=>{"use strict";r.d(t,{_:()=>Q});var o=r(9728),s=r(5959),a=r(7781),n=r(1874),i=r(6089),c=r(2007);const l=({dataSourceName:e,docsLink:t,hasRequiredFields:r=!0,className:o})=>{const a=(0,c.useTheme2)(),n={container:(0,i.css)({p:{margin:0},"p + p":{marginTop:a.spacing(2)}}),text:(0,i.css)({...a.typography.body,color:a.colors.text.secondary,a:(0,i.css)({color:a.colors.text.link,textDecoration:"underline","&:hover":{textDecoration:"none"}})})};return s.createElement("div",{className:(0,i.cx)(n.container,o)},s.createElement("p",{className:n.text},"Before you can use the ",e," data source, you must configure it below or in the config file. For detailed instructions,"," ",s.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},"view the documentation"),"."),r&&s.createElement("p",{className:n.text},s.createElement("i",null,"Fields marked with * are required")))},u=({children:e,title:t,description:r,isCollapsible:o=!1,isInitiallyOpen:a=!0,kind:n="section",className:l})=>{const{colors:u,typography:d,spacing:p}=(0,c.useTheme2)(),[m,f]=(0,s.useState)(!o||a),b=m?"angle-up":"angle-down",h="sub-section"===n,g=`${m?"Collapse":"Expand"} section ${t}`,v={header:(0,i.css)({display:"flex",justifyContent:"space-between",alignItems:"center"}),title:(0,i.css)({margin:0}),subtitle:(0,i.css)({margin:0,fontWeight:d.fontWeightRegular}),descriptionText:(0,i.css)({marginTop:p(h?.25:.5),marginBottom:0,...d.bodySmall,color:u.text.secondary}),content:(0,i.css)({marginTop:p(2)})};return s.createElement("div",{className:l},s.createElement("div",{className:v.header},"section"===n?s.createElement("h3",{className:v.title},t):s.createElement("h6",{className:v.subtitle},t),o&&s.createElement(c.IconButton,{name:b,onClick:()=>f(!m),type:"button",size:"xl","aria-label":g})),r&&s.createElement("p",{className:v.descriptionText},r),m&&s.createElement("div",{className:v.content},e))},d=({children:e,...t})=>s.createElement(u,{...t,kind:"section"},e),p=({children:e,...t})=>s.createElement(u,{...t,kind:"sub-section"},e),m=({config:e,onChange:t,className:r})=>{const o={container:(0,i.css)({maxWidth:578})};return s.createElement(p,{title:"Advanced HTTP settings",className:(0,i.cx)(o.container,r)},s.createElement(c.InlineField,{htmlFor:"advanced-http-cookies",label:"Allowed cookies",labelWidth:24,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.",disabled:e.readOnly,grow:!0},s.createElement(c.TagsInput,{id:"advanced-http-cookies",placeholder:"New cookie (hit enter to add)",tags:e.jsonData.keepCookies,onChange:r=>{t({...e,jsonData:{...e.jsonData,keepCookies:r}})}})),s.createElement(c.InlineField,{htmlFor:"advanced-http-timeout",label:"Timeout",labelWidth:24,tooltip:"HTTP request timeout in seconds",disabled:e.readOnly,grow:!0},s.createElement(c.Input,{id:"advanced-http-timeout",type:"number",min:0,placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:e.jsonData.timeout,onChange:r=>{t({...e,jsonData:{...e.jsonData,timeout:parseInt(r.currentTarget.value,10)}})}})))};var f=r(8531),b=r(3542),h=r(9473),g=r(3789),v=r(2098),y=r(9688),w=r(6344);function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){O(e,t,r[t])}))}return e}function S(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const x=e=>{const{azureCloudOptions:t,disabled:r,credentials:s,onCredentialsChange:a}=e;return(0,o.jsxs)(o.Fragment,{children:[t&&(0,o.jsx)(c.Field,{label:(0,n.t)("components.app-registration-credentials.label-azure-cloud","Azure Cloud"),"data-testid":w.T.components.configEditor.azureCloud.input,htmlFor:"azure-cloud-type",disabled:r,children:(0,o.jsx)(c.Select,{inputId:"azure-cloud-type","aria-label":(0,n.t)("components.app-registration-credentials.aria-label-azure-cloud","Azure Cloud"),className:"width-15",value:t.find((e=>e.value===s.azureCloud)),options:t,onChange:e=>{const t=S(j({},s),{azureCloud:e.value});a(t)}})}),(0,o.jsx)(c.Field,{label:(0,n.t)("components.app-registration-credentials.label-tenant-id","Directory (tenant) ID"),required:"clientsecret"===s.authType,"data-testid":w.T.components.configEditor.tenantID.input,htmlFor:"tenant-id",invalid:"clientsecret"===s.authType&&!s.tenantId,error:"Tenant ID is required",children:(0,o.jsx)(c.Input,{"aria-label":(0,n.t)("components.app-registration-credentials.aria-label-tenant-id","Tenant ID"),className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:s.tenantId||"",onChange:e=>{const t=S(j({},s),{tenantId:e.target.value});a(t)},disabled:r})}),(0,o.jsx)(c.Field,{label:(0,n.t)("components.app-registration-credentials.label-client-id","Application (client) ID"),required:"clientsecret"===s.authType,"data-testid":w.T.components.configEditor.clientID.input,htmlFor:"client-id",invalid:"clientsecret"===s.authType&&!s.clientId,error:"Client ID is required",children:(0,o.jsx)(c.Input,{className:"width-30","aria-label":(0,n.t)("components.app-registration-credentials.aria-label-client-id","Client ID"),placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:s.clientId||"",onChange:e=>{const t=S(j({},s),{clientId:e.target.value});a(t)},disabled:r})}),!r&&("symbol"==typeof s.clientSecret?(0,o.jsx)(c.Field,{label:(0,n.t)("components.app-registration-credentials.label-symbol-client-secret","Client Secret"),htmlFor:"client-secret",required:!0,children:(0,o.jsxs)("div",{className:"width-30",style:{display:"flex",gap:"4px"},children:[(0,o.jsx)(c.Input,{"aria-label":(0,n.t)("components.app-registration-credentials.aria-label-symbol-client-secret","Client Secret"),placeholder:(0,n.t)("components.app-registration-credentials.placeholder-symbol-client-secret","configured"),disabled:!0,"data-testid":"client-secret"}),(0,o.jsx)(c.Button,{variant:"secondary",type:"button",onClick:()=>{const e=S(j({},s),{clientSecret:""});a(e)},disabled:r,children:(0,o.jsx)(n.x6,{i18nKey:"components.app-registration-credentials.reset-symbol-client-secret",children:"Reset"})})]})}):(0,o.jsx)(c.Field,{label:(0,n.t)("components.app-registration-credentials.label-client-secret","Client Secret"),"data-testid":w.T.components.configEditor.clientSecret.input,required:!0,htmlFor:"client-secret",invalid:!s.clientSecret,error:"Client secret is required",children:(0,o.jsx)(c.Input,{className:"width-30","aria-label":(0,n.t)("components.app-registration-credentials.aria-label-client-secret","Client Secret"),placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:s.clientSecret||"",onChange:e=>{const t=S(j({},s),{clientSecret:e.target.value});a(t)},id:"client-secret",disabled:r})}))]})};function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){k(e,t,r[t])}))}return e}function P(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const E=e=>{var t;const{credentials:r,azureCloudOptions:a,onCredentialsChange:i,disabled:l,managedIdentityEnabled:u,workloadIdentityEnabled:p}=e,m=(0,s.useMemo)((()=>{let e=[{value:"clientsecret",label:"App Registration"}];return u&&e.push({value:"msi",label:"Managed Identity"}),p&&e.push({value:"workloadidentity",label:"Workload Identity"}),e}),[u,p]);return f.config.azure.userIdentityFallbackCredentialsEnabled?(0,o.jsxs)(d,{title:(0,n.t)("components.current-user-fallback-credentials.title-fallback-service-credentials","Fallback Service Credentials"),isCollapsible:!0,children:[(0,o.jsx)(c.Alert,{severity:"info",title:(0,n.t)("components.current-user-fallback-credentials.title-service-credentials","Service Credentials"),children:(0,o.jsxs)(c.Stack,{direction:"column",children:[(0,o.jsx)("div",{children:(0,o.jsx)(n.x6,{i18nKey:"components.current-user-fallback-credentials.body-service-credentials",children:"User-based authentication does not inherently support Grafana features that make requests to the data source without a users details available to the request. An example of this is alerting. If you wish to ensure that features that do not have a user in the context of the request still function, please provide fallback credentials below."})}),(0,o.jsx)("div",{children:(0,o.jsx)("b",{children:(0,o.jsx)(n.x6,{i18nKey:"components.current-user-fallback-credentials.note-service-credentials",children:"Note: Features like alerting will be restricted to the access level of the fallback credentials rather than the user. This may present confusion for users and should be clarified."})})})]})}),(0,o.jsx)(c.Field,{label:(0,n.t)("components.current-user-fallback-credentials.label-service-credentials","Service Credentials"),description:(0,n.t)("components.current-user-fallback-credentials.description-service-credentials","Choose if fallback service credentials are enabled or disabled for this data source"),"data-testid":w.T.components.configEditor.serviceCredentialsEnabled.button,children:(0,o.jsx)(c.RadioButtonGroup,{options:[{label:"Enabled",value:!0},{label:"Disabled",value:!1}],value:null!==(b=r.serviceCredentialsEnabled)&&void 0!==b&&b,size:"md",onChange:e=>(e=>{let t=P(A({},r),{serviceCredentialsEnabled:e});e||(t=P(A({},t),{serviceCredentials:void 0})),i(t)})(e)})}),r.serviceCredentialsEnabled?(0,o.jsxs)(o.Fragment,{children:[m.length>0&&(0,o.jsx)(c.Field,{label:(0,n.t)("components.current-user-fallback-credentials.label-authentication","Authentication"),description:(0,n.t)("components.current-user-fallback-credentials.description-authentication","Choose the type of authentication to Azure services"),"data-testid":w.T.components.configEditor.authType.select,htmlFor:"authentication-type",children:(0,o.jsx)(c.Select,{className:"width-15",value:m.find((e=>{var t;return e.value===(null===(t=r.serviceCredentials)||void 0===t?void 0:t.authType)})),options:m,onChange:e=>{const t=u?"msi":p?"workloadidentity":"clientsecret",o=P(A({},r),{serviceCredentials:{authType:e.value||t}});i(o)},disabled:l})}),"clientsecret"===(null===(t=r.serviceCredentials)||void 0===t?void 0:t.authType)&&(0,o.jsx)(x,{credentials:r.serviceCredentials,azureCloudOptions:a,onCredentialsChange:e=>{(0,y.Hc)("currentuser",e)||i(P(A({},r),{serviceCredentials:e}))},disabled:l})]}):null,e.children]}):(0,o.jsx)(c.Alert,{severity:"info",title:(0,n.t)("components.current-user-fallback-credentials.title-fallback-credentials-disabled","Fallback Credentials Disabled"),children:(0,o.jsxs)(n.x6,{i18nKey:"components.current-user-fallback-credentials.alert-fallback-credentials-disabled",children:["Fallback credentials have been disabled. As user-based authentication only inherently supports requests with a user in scope, features such as alerting, recorded queries, or reporting will not function as expected. Please review the"," ",(0,o.jsx)(c.TextLink,{href:"https://grafana.com/docs/grafana/latest/datasources/azuremonitor/deprecated-application-insights/",external:!0,children:"documentation"})," ","for more details."]})});var b};function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function T(){return(0,y.Yz)().map((e=>({value:e.name,label:e.displayName})))}const D=e=>{const{credentials:t,onCredentialsChange:r,disabled:a,managedIdentityEnabled:i,workloadIdentityEnabled:l,userIdentityEnabled:u}=e,p=(0,s.useMemo)((()=>{let e=[{value:"clientsecret",label:"App Registration"}];return i&&e.push({value:"msi",label:"Managed Identity"}),l&&e.push({value:"workloadidentity",label:"Workload Identity"}),u&&e.unshift({value:"currentuser",label:"Current User"}),e}),[i,l,u]);return(0,o.jsxs)(d,{title:(0,n.t)("components.azure-credentials-form.title-authentication","Authentication"),children:[p.length>1&&(0,o.jsx)(c.Field,{label:(0,n.t)("components.azure-credentials-form.label-authentication","Authentication"),description:(0,n.t)("components.azure-credentials-form.description-authentication","Choose the type of authentication to Azure services"),"data-testid":w.T.components.configEditor.authType.select,htmlFor:"authentication-type",children:(0,o.jsx)(c.Select,{className:"width-15",value:p.find((e=>e.value===t.authType)),options:p,onChange:e=>{const o=i?"msi":l?"workloadidentity":u?"currentuser":"clientsecret",s=C(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){z(e,t,r[t])}))}return e}({},t),{authType:e.value||o});r(s)},disabled:a})}),"clientsecret"===t.authType&&(0,o.jsx)(x,{credentials:t,azureCloudOptions:T(),onCredentialsChange:r,disabled:a}),e.children,"currentuser"===t.authType&&(0,o.jsx)(E,{credentials:t,azureCloudOptions:T(),onCredentialsChange:r,disabled:a,managedIdentityEnabled:i,workloadIdentityEnabled:l})]})};function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){N(e,t,r[t])}))}return e}function R(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const L=e=>{const{options:t,onBasicLogsEnabledChange:r}=e,s=(0,c.useTheme2)(),a={text:(0,i.css)(R(I({},s.typography.body),{color:s.colors.text.secondary,fontSize:"11px",a:(0,i.css)({color:s.colors.text.link,textDecoration:"underline","&:hover":{textDecoration:"none"}})}))},l=(0,o.jsx)("p",{className:a.text,children:(0,o.jsxs)(n.x6,{i18nKey:"components.basic-logs-toggle.description-basic-logs",children:["Enabling this feature incurs Azure Monitor per-query costs on dashboard panels that query tables configured for"," ",(0,o.jsx)(c.TextLink,{href:"https://learn.microsoft.com/en-us/azure/azure-monitor/logs/basic-logs-configure?tabs=portal-1",external:!0,children:"Basic Logs"}),"."]})});var u;return(0,o.jsx)(c.Field,{description:l,label:(0,n.t)("components.basic-logs-toggle.label-enable-basic-logs","Enable Basic Logs"),children:(0,o.jsx)("div",{children:(0,o.jsx)(c.Switch,{"aria-label":(0,n.t)("components.basic-logs-toggle.aria-label-enable-basic-logs","Basic Logs"),onChange:e=>r(e.target.checked),value:null!==(u=t.basicLogsEnabled)&&void 0!==u&&u})})})},M=e=>{const{credentials:t,disabled:r,options:a,subscriptions:i,getSubscriptions:l,onSubscriptionChange:u,onSubscriptionsChange:d}=e,p=(0,y.wo)(t),[m,f]=(0,s.useReducer)((e=>e+1),0);(0,s.useEffect)((()=>{if(!l||!p)return void b([]);let e=!1;return l().then((t=>{e||b(t,m)})),()=>{e=!0}}),[m]);const b=(e,t=!1)=>{if(d(e),l)if(t&&!a.subscriptionId&&e.length>0)h(e[0]);else if(a.subscriptionId){e.find((e=>e.value===a.subscriptionId))||h(void 0)}},h=e=>u(null==e?void 0:e.value);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(c.Field,{label:(0,n.t)("components.default-subscription.label-default-subscription","Default Subscription"),"data-testid":w.T.components.configEditor.defaultSubscription.input,htmlFor:"default-subscription",children:(0,o.jsxs)("div",{className:"width-30",style:{display:"flex",gap:"4px"},children:[(0,o.jsx)(c.Select,{inputId:"default-subscription","aria-label":(0,n.t)("components.default-subscription.aria-label-default-subscription","Default Subscription"),value:a.subscriptionId?i.find((e=>e.value===a.subscriptionId)):void 0,options:i,onChange:h,disabled:r}),(0,o.jsx)(c.Button,{variant:"secondary",type:"button",onClick:f,disabled:!p||r,"data-testid":w.T.components.configEditor.loadSubscriptions.button,children:(0,o.jsx)(n.x6,{i18nKey:"components.default-subscription.load-subscriptions",children:"Load Subscriptions"})})]})})})};function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){q(e,t,r[t])}))}return e}function G(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const F=e=>{const{updateOptions:t,getSubscriptions:r,options:a}=e,[n,i]=(0,s.useState)([]),c=(0,s.useMemo)((()=>(0,v.p)(e.options)),[e.options]),l=(e,r)=>{r||i([]),t((t=>(0,v.y)(G($({},t),{jsonData:G($({},t.jsonData),{subscriptionId:r})}),e)))};return(0,g.A)((()=>{a.jsonData.authType&&c.authType||l(c,a.jsonData.subscriptionId)})),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(D,{managedIdentityEnabled:f.config.azure.managedIdentityEnabled,workloadIdentityEnabled:f.config.azure.workloadIdentityEnabled,userIdentityEnabled:f.config.azure.userIdentityEnabled&&!!f.config.featureToggles.azureMonitorEnableUserAuth,credentials:c,azureCloudOptions:T(),onCredentialsChange:l,disabled:e.options.readOnly,children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(M,{subscriptions:n,credentials:c,getSubscriptions:r,disabled:e.options.readOnly,onSubscriptionsChange:e=>i(e),onSubscriptionChange:e=>t((t=>G($({},t),{jsonData:G($({},t.jsonData),{subscriptionId:e})}))),options:a.jsonData}),(0,o.jsx)(L,{options:a.jsonData,onBasicLogsEnabledChange:e=>t((t=>G($({},t),{jsonData:G($({},t.jsonData),{basicLogsEnabled:e})})))})]})})})};function _(e,t,r,o,s,a,n){try{var i=e[a](n),c=i.value}catch(e){return void r(e)}i.done?t(c):Promise.resolve(c).then(o,s)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(o,s){var a=e.apply(t,r);function n(e){_(a,o,s,n,i,"next",e)}function i(e){_(a,o,s,n,i,"throw",e)}n(void 0)}))}}function B(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Q extends s.PureComponent{render(){const{options:e,onOptionsChange:t}=this.props,{error:r}=this.state;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l,{dataSourceName:"Azure Monitor",docsLink:"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/",hasRequiredFields:!0}),(0,o.jsx)(c.Divider,{}),(0,o.jsx)(F,{options:e,updateOptions:this.updateOptions,getSubscriptions:this.getSubscriptions}),r&&(0,o.jsxs)(c.Alert,{severity:"error",title:r.title,children:[(0,o.jsx)("p",{children:r.description}),r.details&&(0,o.jsx)("details",{style:{whiteSpace:"pre-wrap"},children:r.details})]}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.Divider,{}),(0,o.jsxs)(d,{title:(0,n.t)("components.config-editor.title-additional-settings","Additional settings"),description:(0,n.t)("components.config-editor.description-additional-settings","Additional settings are optional settings that can be configured for more control over your data source. This includes Secure Socks Proxy, request timeout, and forwarded cookies."),isCollapsible:!0,isInitiallyOpen:void 0!==e.jsonData.enableSecureSocksProxy||void 0!==e.jsonData.timeout||void 0!==e.jsonData.keepCookies,children:[(0,o.jsx)(m,{config:e,onChange:t}),f.config.secureSocksDSProxyEnabled&&(0,o.jsx)(c.SecureSocksProxySettings,{options:e,onOptionsChange:t})]})]})]})}constructor(e){var t;super(e),B(t=this,"templateSrv",(0,f.getTemplateSrv)()),B(t,"baseURL",void 0),B(t,"updateOptions",(e=>{const r=e(t.props.options);t.props.onOptionsChange(r),t.setState({unsaved:!0})})),B(t,"saveOptions",(()=>V((function*(){t.state.unsaved&&(yield(0,f.getBackendSrv)().put(`/api/datasources/${t.props.options.id}`,t.props.options).then((e=>{(0,a.updateDatasourcePluginOption)(t.props,"version",e.datasource.version)})),t.setState({unsaved:!1}))}))())),B(t,"getSubscriptions",(()=>V((function*(){yield t.saveOptions();try{const e=yield(0,f.getBackendSrv)().fetch({url:t.baseURL+"?api-version=2019-03-01",method:"GET"}).toPromise();return t.setState({error:void 0}),b.A.parseSubscriptionsForSelect(e)}catch(r){var e;if((0,f.isFetchError)(r))t.setState({error:{title:"Error requesting subscriptions",description:"Could not request subscriptions from Azure. Check your credentials and try again.",details:null==r||null===(e=r.data)||void 0===e?void 0:e.message}});return Promise.resolve([])}}))())),t.state={unsaved:!1},t.baseURL=`/api/datasources/${t.props.options.id}/resources/${h.yX.azureMonitor}/subscriptions`}}},5910:(e,t,r)=>{"use strict";r.d(t,{C:()=>a});var o=r(5959),s=r(2007);r(7781);const a=({children:e,wrap:t=!0,...r})=>{var a,n;return o.createElement(s.Stack,{wrap:t?"wrap":void 0,direction:null!=(a=r.direction)?a:"row",gap:null!=(n=r.gap)?n:2,...r},e)}},5959:e=>{"use strict";e.exports=r},6031:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t,r)=>0!==o(e,t,r)},6063:(e,t,r)=>{"use strict";r.d(t,{A:()=>a,G:()=>s});var o=r(5959);function s(e){return(0,o.isValidElement)(e)?e:a(e)}function a(e){var t,r,o,s,a,n,i,c,l,u,d,p,m,f,b,h,g;if(!e||"object"!=typeof e)return;if("string"==typeof e.message)return e.message;if("string"==typeof(null===(r=e.data)||void 0===r||null===(t=r.error)||void 0===t?void 0:t.message))return e.data.error.message;const v=(null===(i=e.error)||void 0===i||null===(n=i.data)||void 0===n||null===(a=n.error)||void 0===a||null===(s=a.innererror)||void 0===s||null===(o=s.innererror)||void 0===o?void 0:o.message)||(null===(d=e.error)||void 0===d||null===(u=d.data)||void 0===u||null===(l=u.error)||void 0===l||null===(c=l.innererror)||void 0===c?void 0:c.message)||(null===(f=e.error)||void 0===f||null===(m=f.data)||void 0===m||null===(p=m.error)||void 0===p?void 0:p.message)||(null===(h=e.error)||void 0===h||null===(b=h.data)||void 0===b?void 0:b.message)||(null===(g=e.data)||void 0===g?void 0:g.message)||e;return"string"==typeof v?v:v&&v.toString?v.toString():void 0}},6089:e=>{"use strict";e.exports=a},6180:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});class o{static buildResourceUri(e,t,r){const o=[],{subscription:s,resourceGroup:a,metricNamespace:n,resourceName:i}=t;if(s&&(o.push("/subscriptions",s),a&&!r&&(o.push("resourceGroups",a),n&&i))){const t=e.replace(n),r=n.split("/"),s=e.replace(i),a=i.split("/"),c=r.shift();if(c&&o.push("providers",c),t.toLowerCase().startsWith("microsoft.storage/storageaccounts/")&&!s.endsWith("default")&&a.push("default"),a.length>r.length){const e=a.shift();e&&o.push(e)}for(const e in r)o.push(r[e]),o.push(a[e])}return o.join("/")}static buildAzureMonitorGetMetricNamespacesUrl(e,t,r,s,a,n){let i;if("resourceUri"in r)i=r.resourceUri;else{const{subscription:e,resourceGroup:t,metricNamespace:s,resourceName:n}=r;i=o.buildResourceUri(a,{subscription:e,resourceGroup:t,metricNamespace:s,resourceName:n})}return`${e}${i}/providers/microsoft.insights/metricNamespaces?api-version=${t}${n?`&region=${n}`:s?"&region=global":""}`}static buildAzureMonitorGetMetricNamesUrl(e,t,r,s,a,n){let i;const{customNamespace:c,metricNamespace:l}=r;if("resourceUri"in r)i=r.resourceUri;else{const{subscription:e,resourceGroup:t,metricNamespace:n,resourceName:c}=r;i=o.buildResourceUri(s,{subscription:e,resourceGroup:t,metricNamespace:n,resourceName:c},a)}let u=`${e}${i}/providers/microsoft.insights/metricdefinitions?api-version=${t}`;return c&&(u+=`&metricnamespace=${encodeURIComponent(c)}`),a&&!c&&l&&(u+=`&metricnamespace=${encodeURIComponent(l)}`),n&&a&&(u+=`&region=${n}`),u}static buildAzureMonitorGetLogsTableUrl(e,t,r,o="2025-02-01"){return`${e}${t}/tables/${r}?api-version=${o}`}}},6344:(e,t,r)=>{"use strict";r.d(t,{T:()=>o});const o={components:{configEditor:{authType:{select:"data-testid auth-type"},azureCloud:{input:"data-testid azure-cloud"},tenantID:{input:"data-testid tenant-id"},clientID:{input:"data-testid client-id"},clientSecret:{input:"data-testid client-secret"},loadSubscriptions:{button:"data-testid load-subscriptions"},defaultSubscription:{input:"data-testid default-subscription"},serviceCredentialsEnabled:{button:"data-testid service-credentials-enabled"}},queryEditor:{header:{select:"data-testid azure-monitor-experimental-header"},userAuthAlert:"data-testid azure-monitor-user-auth-invalid-auth-provider-alert",userAuthFallbackAlert:"data-testid azure-monitor-user-auth-fallback-alert",resourcePicker:{select:{button:"data-testid resource-picker-select"},search:{input:"data-testid resource-picker-search"},apply:{button:"data-testid resource-picker-apply"},cancel:{button:"data-testid resource-picker-cancel"},advanced:{collapse:"data-testid resource-picker-advanced",subscription:{input:"data-testid resource-picker-subscription"},resourceGroup:{input:"data-testid resource-picker-resource-group"},namespace:{input:"data-testid resource-picker-namespace"},region:{input:"data-testid resource-picker-region"},resource:{input:"data-testid resource-picker-resource"}},filters:{subscription:{input:"data-testid resource-picker-filter-subscription"},type:{input:"data-testid resource-picker-filter-type"},location:{input:"data-testid resource-picker-filter-location"}}},metricsQueryEditor:{container:{input:"data-testid azure-monitor-metrics-query-editor-with-experimental-ui"},metricName:{input:"data-testid metric-name"}},logsQueryEditor:{container:{input:"data-testid azure-monitor-logs-query-editor-with-experimental-ui"},formatSelection:{input:"data-testid format-selection"},runQuery:{button:"data-testid run-query"}},logsQueryBuilder:{container:{input:"data-testid azure-monitor-logs-query-builder"}},argsQueryEditor:{container:{input:"data-testid azure-monitor-arg-query-editor"},scope:{input:"data-testid azure-monitor-arg-query-editor-scope"},subscriptions:{input:"data-testid azure-monitor-args-subscription"}},tracesQueryEditor:{container:{input:"data-testid azure-monitor-traces-query-editor-with-experimental-ui"},traceTypes:{select:"data-testid azure-monitor-traces-query-editor-trace-types"}}},variableEditor:{queryType:{input:"data-testid query-type"},subscription:{input:"data-testid subscription"},resourceGroup:{input:"data-testid resource-group"},namespace:{input:"data-testid namespace"},resource:{input:"data-testid resource"},region:{input:"data-testid region"},customNamespace:{input:"data-testid custom-namespace"}}}}},6449:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var o="";r.supports&&(o+="@supports (".concat(r.supports,") {")),r.media&&(o+="@media ".concat(r.media," {"));var s=void 0!==r.layer;s&&(o+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),o+=r.css,s&&(o+="}"),r.media&&(o+="}"),r.supports&&(o+="}");var a=r.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},6463:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var o=r(7059),s=r(4173),a=r(9580),n=r(24),i=r(5098);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){c(e,t,r[t])}))}return e}function u(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const d="select";function p(e){var t,r,c;let p=e;var m;(p.queryType||(p=u(l({},p),{queryType:i.o.AzureMonitor})),p=function(e){var t,r,s,a;let n=e;(null===(r=n.azureLogAnalytics)||void 0===r||null===(t=r.query)||void 0===t?void 0:t.match(/\$__from\s/gi))&&(n=(0,o.Ds)(n,n.azureLogAnalytics.query.replace(/\$__from\s/gi,"$__timeFrom() ")));(null===(a=n.azureLogAnalytics)||void 0===a||null===(s=a.query)||void 0===s?void 0:s.match(/\$__to\s/gi))&&(n=(0,o.Ds)(n,n.azureLogAnalytics.query.replace(/\$__to\s/gi,"$__timeTo() ")));return n}(p),p.queryType===i.o.AzureMonitor&&p.azureMonitor&&(p=function(e){var t;let r=e;if((null===(t=r.azureMonitor)||void 0===t?void 0:t.timeGrainUnit)&&"auto"!==r.azureMonitor.timeGrain){var o,a;const e=n.A.createISO8601Duration(null!==(a=r.azureMonitor.timeGrain)&&void 0!==a?a:"auto",r.azureMonitor.timeGrainUnit);r=(0,s.Jk)(r,e),null===(o=r.azureMonitor)||void 0===o||delete o.timeGrainUnit}return r}(p),p=function(e){var t,r;const o=(null===(t=e.azureMonitor)||void 0===t?void 0:t.metricNamespace)&&e.azureMonitor.metricNamespace!==d;if(!o&&(null===(r=e.azureMonitor)||void 0===r?void 0:r.metricDefinition))return u(l({},e),{azureMonitor:u(l({},e.azureMonitor),{metricNamespace:e.azureMonitor.metricDefinition,metricDefinition:void 0})});return e}(p),p=function(e){var t,r,o;let a=e;const n=null===(t=a.azureMonitor)||void 0===t?void 0:t.dimension;var i;n&&"None"!==n&&(a=(0,s.LD)(a,n,"eq",[(null===(i=a.azureMonitor)||void 0===i?void 0:i.dimensionFilter)||""]));return null===(r=a.azureMonitor)||void 0===r||delete r.dimension,null===(o=a.azureMonitor)||void 0===o||delete o.dimensionFilter,a}(p),p=function(e){const t=e.azureMonitor;if(!t)return e;const r=[],o=t.dimensionFilters;if(o&&o.length>0&&(o.forEach((e=>{const t={dimension:e.dimension,operator:e.operator};if(!e.filters&&e.filter)r.push(u(l({},t),{filters:[e.filter]}));else{let o=!1;if(e.filters&&e.filter){for(const t of e.filters)if(e.filter===t){o=!0;break}o||"*"===e.filter||e.filters.push(e.filter),r.push(u(l({},t),{filters:e.filters}))}}})),r.length>0))return u(l({},e),{azureMonitor:u(l({},t),{dimensionFilters:r})});return e}(p),p=function(e){var t;if((null===(t=e.azureMonitor)||void 0===t?void 0:t.resourceUri)&&!e.azureMonitor.resourceUri.startsWith("$")){const t=(0,a.oU)(e.azureMonitor.resourceUri),r=(null==t?void 0:t.subscription)&&(null==t?void 0:t.resourceGroup)&&(null==t?void 0:t.resourceName);return u(l({},e),{subscription:null==t?void 0:t.subscription,azureMonitor:u(l({},e.azureMonitor),{resources:[{resourceGroup:null==t?void 0:t.resourceGroup,resourceName:null==t?void 0:t.resourceName}],metricNamespace:null==t?void 0:t.metricNamespace,resourceUri:r?void 0:e.azureMonitor.resourceUri})})}return e}(p)),((null===(t=p.azureMonitor)||void 0===t?void 0:t.resourceGroup)||(null===(r=p.azureMonitor)||void 0===r?void 0:r.resourceName))&&(p=function(e){var t,r;let o=e;if((null===(t=o.azureMonitor)||void 0===t?void 0:t.resourceGroup)&&(null===(r=o.azureMonitor)||void 0===r?void 0:r.resourceName)){var s,a;o=u(l({},o),{azureMonitor:u(l({},o.azureMonitor),{resources:[{resourceGroup:o.azureMonitor.resourceGroup,resourceName:o.azureMonitor.resourceName}]})}),null===(s=o.azureMonitor)||void 0===s||delete s.resourceGroup,null===(a=o.azureMonitor)||void 0===a||delete a.resourceName}return o}(p)),null===(c=p.azureLogAnalytics)||void 0===c?void 0:c.resource)&&(p=u(l({},p),{azureLogAnalytics:u(l({},p.azureLogAnalytics),{resources:[p.azureLogAnalytics.resource]})}),null===(m=p.azureLogAnalytics)||void 0===m||delete m.resource);return p.azureLogAnalytics&&void 0===p.azureLogAnalytics.dashboardTime&&(p=p.azureLogAnalytics.intersectTime?u(l({},p),{azureLogAnalytics:u(l({},p.azureLogAnalytics),{dashboardTime:!0})}):u(l({},p),{azureLogAnalytics:u(l({},p.azureLogAnalytics),{dashboardTime:!1})})),p}},6513:(e,t,r)=>{"use strict";const o=r(4256);e.exports=(e,t)=>{const r=o(e,t);return r&&r.prerelease.length?r.prerelease:null}},6988:(e,t,r)=>{"use strict";const o=r(4708),s=r(2839);e.exports=(e,t,r)=>{let a=null,n=null,i=null;try{i=new s(t,r)}catch(e){return null}return e.forEach((e=>{i.test(e)&&(a&&-1!==n.compare(e)||(a=e,n=new o(a,r)))})),a}},7059:(e,t,r)=>{"use strict";r.d(t,{Ds:()=>i,Q$:()=>c,i6:()=>l,kF:()=>p,sX:()=>u,yg:()=>d});var o=r(5098);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){s(e,t,r[t])}))}return e}function n(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function i(e,t){return n(a({},e),{azureLogAnalytics:n(a({},e.azureLogAnalytics),{query:t})})}function c(e,t){return n(a({},e),{azureLogAnalytics:n(a({},e.azureLogAnalytics),{resultFormat:t})})}function l(e,t){return n(a({},e),{azureLogAnalytics:n(a({},e.azureLogAnalytics),{dashboardTime:"dashboard"===t})})}function u(e,t){return n(a({},e),{azureLogAnalytics:n(a({},e.azureLogAnalytics),{timeColumn:t})})}function d(e,t){return n(a({},e),{azureLogAnalytics:n(a({},e.azureLogAnalytics),{basicLogsQuery:t})})}function p(e,t,r){e.azureLogAnalytics?e.azureLogAnalytics.resultFormat||r({value:o.f.TimeSeries}):r({value:t})}},7088:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var o=r(2007),s=r(5959),a=r(5910);const n=s.forwardRef((function({items:e,renderItem:t,onChange:r},n){return s.createElement(a.C,null,e.map(((o,a)=>s.createElement("div",{key:a},t(o,(t=>((t,o)=>{const s=[...e];s[t]=o,r(s)})(a,t)),(()=>(t=>{const o=[...e];o.splice(t,1),r(o)})(a)))))),s.createElement(o.Button,{ref:n,onClick:()=>{const t=[...e,{}];r(t)},variant:"secondary",size:"md",icon:"plus","aria-label":"Add",type:"button"}))}))},7264:e=>{"use strict";var t=[];function r(e){for(var r=-1,o=0;o<t.length;o++)if(t[o].identifier===e){r=o;break}return r}function o(e,o){for(var a={},n=[],i=0;i<e.length;i++){var c=e[i],l=o.base?c[0]+o.base:c[0],u=a[l]||0,d="".concat(l," ").concat(u);a[l]=u+1;var p=r(d),m={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(m);else{var f=s(m,o);o.byIndex=i,t.splice(i,0,{identifier:d,updater:f,references:1})}n.push(d)}return n}function s(e,t){var r=t.domAPI(t);r.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,s){var a=o(e=e||[],s=s||{});return function(e){e=e||[];for(var n=0;n<a.length;n++){var i=r(a[n]);t[i].references--}for(var c=o(e,s),l=0;l<a.length;l++){var u=r(a[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}a=c}}},7379:(e,t,r)=>{"use strict";const o=r(7715);e.exports=(e,t,r)=>o(e,t,">",r)},7453:(e,t,r)=>{"use strict";const o=r(4708),s=r(2839),a=r(9308);e.exports=(e,t)=>{e=new s(e,t);let r=new o("0.0.0");if(e.test(r))return r;if(r=new o("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const s=e.set[t];let n=null;s.forEach((e=>{const t=new o(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!a(t,n)||(n=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!n||r&&!a(r,n)||(r=n)}return r&&e.test(r)?r:null}},7565:(e,t,r)=>{"use strict";const o=r(4708);e.exports=(e,t,r)=>{const s=new o(e,r),a=new o(t,r);return s.compare(a)||s.compareBuild(a)}},7618:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t,r)=>o(t,e,r)},7715:(e,t,r)=>{"use strict";const o=r(4708),s=r(9264),{ANY:a}=s,n=r(2839),i=r(3238),c=r(9308),l=r(2083),u=r(4624),d=r(3833);e.exports=(e,t,r,p)=>{let m,f,b,h,g;switch(e=new o(e,p),t=new n(t,p),r){case">":m=c,f=u,b=l,h=">",g=">=";break;case"<":m=l,f=d,b=c,h="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(i(e,t,p))return!1;for(let r=0;r<t.set.length;++r){const o=t.set[r];let n=null,i=null;if(o.forEach((e=>{e.semver===a&&(e=new s(">=0.0.0")),n=n||e,i=i||e,m(e.semver,n.semver,p)?n=e:b(e.semver,i.semver,p)&&(i=e)})),n.operator===h||n.operator===g)return!1;if((!i.operator||i.operator===h)&&f(e,i.semver))return!1;if(i.operator===g&&b(e,i.semver))return!1}return!0}},7781:e=>{"use strict";e.exports=t},7809:(e,t,r)=>{"use strict";r.d(t,{D:()=>l});var o=r(9728),s=r(4326),a=r(2007);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){n(e,t,r[t])}))}return e}function c(e,t){if(null==e)return{};var r,o,s=function(e,t){if(null==e)return{};var r,o,s={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}const l=e=>{const{labelWidth:t,inlineField:r}=e,n=c(e,["labelWidth","inlineField"]);return r?(0,o.jsx)(a.InlineField,i({labelWidth:t||18},n)):(0,o.jsx)(s.c,i({width:t||18},n))}},8044:(e,t,r)=>{"use strict";var o=r(5959),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,r){var o,a={},l=null,u=null;for(o in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)n.call(t,o)&&!c.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===a[o]&&(a[o]=t[o]);return{$$typeof:s,type:e,key:l,ref:u,props:a,_owner:i.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},8146:e=>{"use strict";e.exports=l},8285:(e,t,r)=>{"use strict";const o=r(3238),s=r(3440);e.exports=(e,t,r)=>{const a=[];let n=null,i=null;const c=e.sort(((e,t)=>s(e,t,r)));for(const e of c){o(e,t,r)?(i=e,n||(n=e)):(i&&a.push([n,i]),i=null,n=null)}n&&a.push([n,null]);const l=[];for(const[e,t]of a)e===t?l.push(e):t||e!==c[0]?t?e===c[0]?l.push(`<=${t}`):l.push(`${e} - ${t}`):l.push(`>=${e}`):l.push("*");const u=l.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},8332:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},8442:(e,t,r)=>{"use strict";r.d(t,{U:()=>i});var o=r(6089),s=r(5959),a=(r(7781),r(2007)),n=r(5910);const i=({children:e})=>{const t=(0,a.useStyles2)(c);return s.createElement("div",{className:t.root},s.createElement(n.C,{gap:2},e))},c=e=>({root:(0,o.css)({padding:e.spacing(1),backgroundColor:e.colors.background.secondary,borderRadius:e.shape.radius.default})})},8495:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var o=r(5959),s=r(6063);function a(){const[e,t]=(0,o.useState)([]),r=(0,o.useCallback)(((e,r)=>{t((t=>{const o=[...t],s=t.findIndex((([t])=>t===e));return s>-1&&o.splice(s,1),r&&o.unshift([e,r]),o}))}),[]);return[(0,o.useMemo)((()=>{const t=e[0];return t&&(0,s.G)(t[1])}),[e]),r]}},8531:e=>{"use strict";e.exports=s},8785:(e,t,r)=>{"use strict";r.d(t,{X:()=>o});var o=function(e){return e.Subscription="Subscription",e.ResourceGroup="ResourceGroup",e.Resource="Resource",e.VariableGroup="TemplateVariableGroup",e.Variable="TemplateVariable",e}({})},8840:(e,t,r)=>{"use strict";r.d(t,{A:()=>E});var o=r(9728),s=r(3241),a=r(5959),n=r(1874),i=r(3769),c=r(8442),l=r(8899),u=r(2007),d=r(3292),p=r(6344),m=r(7809);function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){f(e,t,r[t])}))}return e}function h(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const g=({query:e,onQueryChange:t})=>{var r;const s=(0,a.useCallback)((r=>{t(h(b({},e),{azureResourceGraph:h(b({},e.azureResourceGraph),{query:r})}))}),[t,e]);var n;return(0,o.jsx)(u.CodeEditor,{value:null!==(n=null===(r=e.azureResourceGraph)||void 0===r?void 0:r.query)&&void 0!==n?n:"",language:"kusto",height:200,width:"100%",showMiniMap:!1,onBlur:s,onSave:s})};var v=r(9473);function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){y(e,t,r[t])}))}return e}function O(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const j=({query:e,subscriptions:t,variableOptionGroup:r,onQueryChange:s})=>{const[i,c]=(0,a.useState)(!1),[l,d]=(0,a.useState)([]),f=(0,a.useMemo)((()=>[...t,r]),[t,r]);(0,a.useEffect)((()=>{e.subscriptions&&e.subscriptions.length>0?(d((0,v.Mz)([...t,...r.options],e.subscriptions)),c(!1)):c(!0)}),[e.subscriptions,t,r.options]);return(0,o.jsx)(m.D,{label:(0,n.t)("components.subscription-field.label-subscriptions","Subscriptions"),"data-testid":p.T.components.queryEditor.argsQueryEditor.subscriptions.input,children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.MultiSelect,{isClearable:!0,value:l,inputId:"azure-monitor-subscriptions-field",onChange:o=>{const a=o.filter((e=>"Select all subscriptions"===e.value));if(o&&0!==o.length)if(a.length>0){const r=t.map((e=>{var t;return null!==(t=e.value)&&void 0!==t?t:""})).filter((e=>"Select all subscriptions"!==e));s(O(w({},e),{subscriptions:r}))}else{const a=o.map((e=>{var t;return null!==(t=e.value)&&void 0!==t?t:""}));s(O(w({},e),{subscriptions:a})),d((0,v.Mz)([...t,...r.options],a)),c(!1)}else d([]),s(O(w({},e),{subscriptions:[]})),c(!0)},options:f,width:38}),i?(0,o.jsx)(u.FieldValidationMessage,{children:(0,o.jsx)(n.x6,{i18nKey:"components.subscription-field.validation-subscriptions",children:"At least one subscription must be chosen."})}):null]})})};function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){S(e,t,r[t])}))}return e}function k(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const A="arg-subscriptions";function P(e,t,r){let o=t||[];0===o.length&&r&&(o=[r]),0===o.length&&e.length&&(o=[e[0]]);const a=o.filter((e=>e.includes("$"))),n=(0,s.intersection)(o,e).concat(a);return e.length&&o.length>n.length&&(o=n.length>0?n:[e[0]]),o}const E=({query:e,datasource:t,subscriptionId:r,variableOptionGroup:s,onChange:f,setError:b})=>{var h,v,y;const[w,O]=(0,a.useState)([]);(0,a.useMemo)((()=>{var r;(null===(r=e.azureResourceGraph)||void 0===r?void 0:r.scope)!==d.pG.Directory&&t.getSubscriptions().then((t=>{const r=t.map((e=>({label:e.text,value:e.value,description:e.value})));O([{label:"Select all subscriptions",value:"Select all subscriptions",description:"Select all"}].concat(r)),b(A,void 0),f(k(x({},e),{subscriptions:P(r.map((e=>e.value)),e.subscriptions,e.subscription)}))})).catch((e=>b(A,e)))}),[t,null==e||null===(h=e.azureResourceGraph)||void 0===h?void 0:h.scope]);return(0,o.jsxs)("span",{"data-testid":p.T.components.queryEditor.argsQueryEditor.container.input,children:[(0,o.jsx)(i.D,{children:(0,o.jsx)(c.U,{children:(0,o.jsxs)(l.B,{children:[(0,o.jsx)(m.D,{label:(0,n.t)("components.scope-selector.label","Scope"),children:(0,o.jsx)(u.Combobox,{onChange:t=>{f(k(x({},e),{azureResourceGraph:k(x({},e.azureResourceGraph),{scope:t.value}),subscriptions:[]}))},options:[{value:d.pG.Directory,label:"Directory"},{value:d.pG.Subscription,label:"Subscription"}],value:(null===(v=e.azureResourceGraph)||void 0===v?void 0:v.scope)||d.pG.Subscription,width:20,"data-testid":p.T.components.queryEditor.argsQueryEditor.scope.input})}),(null==e||null===(y=e.azureResourceGraph)||void 0===y?void 0:y.scope)!==d.pG.Directory?(0,o.jsx)(j,{subscriptions:w,query:e,datasource:t,subscriptionId:r,variableOptionGroup:s,onQueryChange:f,setError:b}):null]})})}),(0,o.jsx)(g,{query:e,datasource:t,subscriptionId:r,variableOptionGroup:s,onQueryChange:f,setError:b})]})}},8854:(e,t,r)=>{"use strict";const o=r(4256);e.exports=(e,t)=>{const r=o(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},8899:(e,t,r)=>{"use strict";r.d(t,{B:()=>a});var o=r(5959),s=r(5910);const a=({children:e})=>o.createElement(s.C,{gap:1},e)},8954:e=>{"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),a="/*# ".concat(s," */");return[t].concat([a]).join("\n")}return[t].join("\n")}},9264:(e,t,r)=>{"use strict";const o=Symbol("SemVer ANY");class s{static get ANY(){return o}constructor(e,t){if(t=a(t),e instanceof s){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===o?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new u(r[2],this.options.loose):this.semver=o}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===o||e===o)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return c(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof s))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):(!(t=a(t)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(c(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(c(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}e.exports=s;const a=r(9547),{safeRe:n,t:i}=r(5750),c=r(4991),l=r(1064),u=r(4708),d=r(2839)},9308:(e,t,r)=>{"use strict";const o=r(3440);e.exports=(e,t,r)=>o(e,t,r)>0},9406:(e,t,r)=>{"use strict";const o=r(4708);e.exports=(e,t)=>new o(e,t).minor},9473:(e,t,r)=>{"use strict";r.d(t,{GV:()=>p,Mz:()=>i,qP:()=>l,sf:()=>d,yX:()=>u,zL:()=>c});var o=r(3241);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){s(e,t,r[t])}))}return e}function n(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const i=(e,t=[])=>{if(0===t.length)return[];const r=t.reduce(((e,t)=>(e.add(t),e)),new Set);return e.filter((e=>r.has(e.value)))},c=e=>({value:e.value,label:e.text}),l=(e,t,r)=>{const o=[...e,t],s=e.map((e=>e.value.toLowerCase())).concat(t.options.map((e=>e.value)));return r&&!s.includes(r.toLowerCase())&&o.push({label:r,value:r}),o},u={azureMonitor:"azuremonitor",logAnalytics:"loganalytics",appInsights:"appinsights",resourceGraph:"resourcegraph"};function d(e,t){if("string"==typeof e)return t.multi||t.includeAll&&!t.allValue?"'"+e+"'":e;if("number"==typeof e)return e;return(0,o.map)(e,(t=>"number"==typeof e?e:"'"+t+"'")).join(",")}function p(e,t,r){const o=[a({},t)];return Object.keys(t).forEach((t=>{const s=o[0][t];let i=[];const c=e.replace(s,r,"raw",i);if(i.length>0){for(const e of i)if(!1!==e.found)if(e.value.includes(",")){const r=e.value.split(","),i=[...o];r.forEach(((r,c)=>{i.forEach((i=>{0===c?i[t]=s.replace(e.match,r):o.push(n(a({},i),{[t]:s.replace(e.match,r)}))}))}))}else o.forEach((e=>{e[t]=c}))}else o.forEach((e=>{e[t]=c}))})),o}},9547:e=>{"use strict";const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},9580:(e,t,r)=>{"use strict";r.d(t,{pU:()=>ie,uv:()=>ne,bs:()=>ae,wr:()=>oe,Ux:()=>se,_Z:()=>Y,oU:()=>ee,U4:()=>Z,zj:()=>re,xt:()=>te,e8:()=>ce});var o=Symbol.for("immer-nothing"),s=Symbol.for("immer-draftable"),a=Symbol.for("immer-state");function n(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var i=Object.getPrototypeOf;function c(e){return!!e&&!!e[a]}function l(e){return!!e&&(d(e)||Array.isArray(e)||!!e[s]||!!e.constructor?.[s]||h(e)||g(e))}var u=Object.prototype.constructor.toString();function d(e){if(!e||"object"!=typeof e)return!1;const t=i(e);if(null===t)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===u}function p(e,t){0===m(e)?Reflect.ownKeys(e).forEach((r=>{t(r,e[r],e)})):e.forEach(((r,o)=>t(o,r,e)))}function m(e){const t=e[a];return t?t.type_:Array.isArray(e)?1:h(e)?2:g(e)?3:0}function f(e,t){return 2===m(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function b(e,t,r){const o=m(e);2===o?e.set(t,r):3===o?e.add(r):e[t]=r}function h(e){return e instanceof Map}function g(e){return e instanceof Set}function v(e){return e.copy_||e.base_}function y(e,t){if(h(e))return new Map(e);if(g(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=d(e);if(!0===t||"class_only"===t&&!r){const t=Object.getOwnPropertyDescriptors(e);delete t[a];let r=Reflect.ownKeys(t);for(let o=0;o<r.length;o++){const s=r[o],a=t[s];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[s]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[s]})}return Object.create(i(e),t)}{const t=i(e);if(null!==t&&r)return{...e};const o=Object.create(t);return Object.assign(o,e)}}function w(e,t=!1){return j(e)||c(e)||!l(e)||(m(e)>1&&(e.set=e.add=e.clear=e.delete=O),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>w(t,!0)))),e}function O(){n(2)}function j(e){return Object.isFrozen(e)}var S,x={};function k(e){const t=x[e];return t||n(0),t}function A(){return S}function P(e,t){t&&(k("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function E(e){z(e),e.drafts_.forEach(T),e.drafts_=null}function z(e){e===S&&(S=e.parent_)}function C(e){return S={drafts_:[],parent_:S,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function T(e){const t=e[a];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function D(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return void 0!==e&&e!==r?(r[a].modified_&&(E(t),n(4)),l(e)&&(e=N(t,e),t.parent_||R(t,e)),t.patches_&&k("Patches").generateReplacementPatches_(r[a].base_,e,t.patches_,t.inversePatches_)):e=N(t,r,[]),E(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==o?e:void 0}function N(e,t,r){if(j(t))return t;const o=t[a];if(!o)return p(t,((s,a)=>I(e,o,t,s,a,r))),t;if(o.scope_!==e)return t;if(!o.modified_)return R(e,o.base_,!0),o.base_;if(!o.finalized_){o.finalized_=!0,o.scope_.unfinalizedDrafts_--;const t=o.copy_;let s=t,a=!1;3===o.type_&&(s=new Set(t),t.clear(),a=!0),p(s,((s,n)=>I(e,o,t,s,n,r,a))),R(e,t,!1),r&&e.patches_&&k("Patches").generatePatches_(o,r,e.patches_,e.inversePatches_)}return o.copy_}function I(e,t,r,o,s,a,n){if(c(s)){const n=N(e,s,a&&t&&3!==t.type_&&!f(t.assigned_,o)?a.concat(o):void 0);if(b(r,o,n),!c(n))return;e.canAutoFreeze_=!1}else n&&r.add(s);if(l(s)&&!j(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;N(e,s),t&&t.scope_.parent_||"symbol"==typeof o||!Object.prototype.propertyIsEnumerable.call(r,o)||R(e,s)}}function R(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&w(t,r)}var L={get(e,t){if(t===a)return e;const r=v(e);if(!f(r,t))return function(e,t,r){const o=$(t,r);return o?"value"in o?o.value:o.get?.call(e.draft_):void 0}(e,r,t);const o=r[t];return e.finalized_||!l(o)?o:o===q(e.base_,t)?(F(e),e.copy_[t]=_(o,e)):o},has:(e,t)=>t in v(e),ownKeys:e=>Reflect.ownKeys(v(e)),set(e,t,r){const o=$(v(e),t);if(o?.set)return o.set.call(e.draft_,r),!0;if(!e.modified_){const o=q(v(e),t),i=o?.[a];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(((s=r)===(n=o)?0!==s||1/s==1/n:s!=s&&n!=n)&&(void 0!==r||f(e.base_,t)))return!0;F(e),G(e)}var s,n;return e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==q(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,F(e),G(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const r=v(e),o=Reflect.getOwnPropertyDescriptor(r,t);return o?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:o.enumerable,value:r[t]}:o},defineProperty(){n(11)},getPrototypeOf:e=>i(e.base_),setPrototypeOf(){n(12)}},M={};function q(e,t){const r=e[a];return(r?v(r):e)[t]}function $(e,t){if(!(t in e))return;let r=i(e);for(;r;){const e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=i(r)}}function G(e){e.modified_||(e.modified_=!0,e.parent_&&G(e.parent_))}function F(e){e.copy_||(e.copy_=y(e.base_,e.scope_.immer_.useStrictShallowCopy_))}p(L,((e,t)=>{M[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),M.deleteProperty=function(e,t){return M.set.call(this,e,t,void 0)},M.set=function(e,t,r){return L.set.call(this,e[0],t,r,e[0])};function _(e,t){const r=h(e)?k("MapSet").proxyMap_(e,t):g(e)?k("MapSet").proxySet_(e,t):function(e,t){const r=Array.isArray(e),o={type_:r?1:0,scope_:t?t.scope_:A(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=o,a=L;r&&(s=[o],a=M);const{revoke:n,proxy:i}=Proxy.revocable(s,a);return o.draft_=i,o.revoke_=n,i}(e,t);return(t?t.scope_:A()).drafts_.push(r),r}function V(e){if(!l(e)||j(e))return e;const t=e[a];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=y(e,t.scope_.immer_.useStrictShallowCopy_)}else r=y(e,!0);return p(r,((e,t)=>{b(r,e,V(t))})),t&&(t.finalized_=!1),r}var B=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if("function"==typeof e&&"function"!=typeof t){const r=t;t=e;const o=this;return function(e=r,...s){return o.produce(e,(e=>t.call(this,e,...s)))}}let s;if("function"!=typeof t&&n(6),void 0!==r&&"function"!=typeof r&&n(7),l(e)){const o=C(this),a=_(e,void 0);let n=!0;try{s=t(a),n=!1}finally{n?E(o):z(o)}return P(o,r),D(s,o)}if(!e||"object"!=typeof e){if(s=t(e),void 0===s&&(s=e),s===o&&(s=void 0),this.autoFreeze_&&w(s,!0),r){const t=[],o=[];k("Patches").generateReplacementPatches_(e,s,t,o),r(t,o)}return s}n(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...r)=>this.produceWithPatches(t,(t=>e(t,...r)));let r,o;return[this.produce(e,t,((e,t)=>{r=e,o=t})),r,o]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){l(e)||n(8),c(e)&&(e=function(e){c(e)||n(10);return V(e)}(e));const t=C(this),r=_(e,void 0);return r[a].isManual_=!0,z(t),r}finishDraft(e,t){const r=e&&e[a];r&&r.isManual_||n(9);const{scope_:o}=r;return P(o,t),D(void 0,o)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const o=t[r];if(0===o.path.length&&"replace"===o.op){e=o.value;break}}r>-1&&(t=t.slice(r+1));const o=k("Patches").applyPatches_;return c(e)?o(e,t):this.produce(e,(e=>o(e,t)))}},Q=B.produce;B.produceWithPatches.bind(B),B.setAutoFreeze.bind(B),B.setUseStrictShallowCopy.bind(B),B.applyPatches.bind(B),B.createDraft.bind(B),B.finishDraft.bind(B);var U=r(8531),X=r(6180);function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},o=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(t){W(e,t,r[t])}))}return e}function K(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const J=RegExp("\\/subscriptions\\/(?<subscription>[^/]+)(?:\\/resourceGroups\\/(?<resourceGroup>[^/]+)(?:\\/providers\\/(?<metricNamespaceAndResource>.+))?)?","i");function Z(e){const t=J.exec(e);var r;const o=null!==(r=null==t?void 0:t.groups)&&void 0!==r?r:{},{subscription:s,resourceGroup:a,metricNamespaceAndResource:n}=o,{metricNamespace:i,resourceName:c}=function(e){if(!e)return{};const t=e.split("/"),r=t.splice(0,2),o=t.splice(0,1);for(;t.length;){const e=t.shift();t.length%2==0?o.push(e):r.push(e)}return{metricNamespace:r.join("/"),resourceName:o.join("/")}}(n);return{subscription:s,resourceGroup:a,metricNamespace:i,resourceName:c}}function Y(e,t){return e.map((e=>ee(e,t)))}function ee(e,t){if("string"==typeof e){const r=Z(e);return t&&(r.region=t),r}return e}function te(e){return e.map((e=>re(e)))}function re(e){return e?"string"==typeof e?e:X.A.buildResourceUri((0,U.getTemplateSrv)(),e):""}function oe(e){return!!e.match(/^[A-Z0-9]+/i)}function se(e,t){var r,o,s,a;const n=ee(t),i=ee(e);return(null==i?void 0:i.subscription)===(null==n?void 0:n.subscription)&&(null==i||null===(r=i.resourceGroup)||void 0===r?void 0:r.toLowerCase())===(null==n||null===(o=n.resourceGroup)||void 0===o?void 0:o.toLowerCase())&&(c=null==i||null===(s=i.metricNamespace)||void 0===s?void 0:s.toLowerCase(),l=null==i?void 0:i.resourceName,u=null==n||null===(a=n.metricNamespace)||void 0===a?void 0:a.toLowerCase(),d=null==n?void 0:n.resourceName,(null==u?void 0:u.startsWith("microsoft.storage/storageaccounts"))&&(u="microsoft.storage/storageaccounts",(null==d?void 0:d.endsWith("/default"))&&(d=d.slice(0,-8))),c===u&&l===d);var c,l,u,d}function ae(e,t){const r=[];return t.forEach((t=>{const o=ne(e,t);o&&r.push(o)})),r}function ne(e,t){for(const r of e){if(se(r.uri,t))return r;if(r.children){const e=ne(r.children,t);if(e)return e}}}function ie(e,t,r){return Q(e,(e=>{const o=ne(e,t);o&&(o.children=r)}))}function ce(e,t,r){var o;if("logs"===t)return K(H({},e),{azureLogAnalytics:K(H({},e.azureLogAnalytics),{resources:te(r).filter((e=>""!==e))})});if("traces"===t)return K(H({},e),{azureTraces:K(H({},e.azureTraces),{resources:te(r).filter((e=>""!==e))})});const s=r.length?ee(r[0]):{};return K(H({},e),{subscription:s.subscription,azureMonitor:K(H({},e.azureMonitor),{metricNamespace:null===(o=s.metricNamespace)||void 0===o?void 0:o.toLocaleLowerCase(),region:s.region,resources:Y(r).filter((e=>""!==e.resourceName&&""!==e.metricNamespace&&""!==e.subscription&&""!==e.resourceGroup)),metricName:void 0,aggregation:void 0,timeGrain:"",dimensionFilters:[]})})}},9688:(e,t,r)=>{"use strict";function o(e,t){return!!t&&t.authType===e}r.d(t,{Yz:()=>n,qs:()=>p,Gg:()=>f,kZ:()=>i,Hc:()=>o,wo:()=>d,Wp:()=>c,lk:()=>b});var s=r(8531);const a=[{name:"AzureCloud",displayName:"Azure"},{name:"AzureChinaCloud",displayName:"Azure China"},{name:"AzureUSGovernment",displayName:"Azure US Government"}];function n(){const e=s.config.azure;return Array.isArray(e.clouds)&&e.clouds.length>0?e.clouds:a}function i(){return s.config.azure.cloud||"AzureCloud"}function c(e){if(e)switch(e){case"azuremonitor":return"AzureCloud";case"chinaazuremonitor":return"AzureChinaCloud";case"govazuremonitor":return"AzureUSGovernment";default:throw new Error(`Azure cloud '${e}' is not recognized by datasource.`)}}const l=Symbol("Concealed client secret"),u=Symbol("Concealed legacy client secret");function d(e,t=!1){const r=e.authType;switch(r){case"msi":case"workloadidentity":case"currentuser":return!0;case"clientsecret":case"clientsecret-obo":return!!(e.azureCloud&&e.tenantId&&e.clientId&&(t||e.clientSecret));case"ad-password":return!!(e.clientId&&e.password&&e.userId);default:throw new Error(`The auth type '${r}' not supported.`)}}function p(e){if("secureJsonFields"in e&&e.hasOwnProperty("secureJsonFields")){if(e.secureJsonFields.azureClientSecret)return l;if(e.secureJsonFields.clientSecret)return u;{const t=e.secureJsonData?.azureClientSecret;return"string"==typeof t&&t.length>0?t:void 0}}}function m(e){if("secureJsonFields"in e&&e.hasOwnProperty("secureJsonFields")){if(e.secureJsonFields.password)return l;{const t=e.secureJsonData?.password;return"string"==typeof t&&t.length>0?t:void 0}}}function f(e,t){const r=e.jsonData.azureCredentials;if(!r)return;const a=r.authType;switch(a){case"msi":case"workloadidentity":return"msi"===a&&s.config.azure.managedIdentityEnabled||"workloadidentity"===a&&s.config.azure.workloadIdentityEnabled?{authType:a}:void 0;case"clientsecret":case"clientsecret-obo":if("clientsecret-obo"===a&&!t)return;return{authType:a,azureCloud:r.azureCloud||i(),tenantId:r.tenantId,clientId:r.clientId,clientSecret:p(e)};case"ad-password":return{authType:a,userId:r.userId,clientId:r.clientId,password:m(e)}}if(o(a,r)){if(!s.config.azure.userIdentityEnabled)return;if(o("clientsecret",r.serviceCredentials)){const t={...r.serviceCredentials,clientSecret:p(e)};return{authType:a,serviceCredentialsEnabled:r.serviceCredentialsEnabled,serviceCredentials:t}}return{authType:a,serviceCredentialsEnabled:r.serviceCredentialsEnabled,serviceCredentials:r.serviceCredentials}}throw new Error(`The auth type '${a}' is not supported.`)}function b(e,t,r){e={...e,jsonData:{...e.jsonData,azureAuthType:void 0,cloudName:void 0,tenantId:void 0,clientId:void 0}};const a=t.authType;switch(a){case"msi":case"workloadidentity":if("msi"===a&&!s.config.azure.managedIdentityEnabled)throw new Error("Managed Identity authentication is not enabled in Grafana config.");if("workloadidentity"===a&&!s.config.azure.workloadIdentityEnabled)throw new Error("Workload Identity authentication is not enabled in Grafana config.");return e={...e,jsonData:{...e.jsonData,azureCredentials:{authType:a}}};case"clientsecret":case"clientsecret-obo":if("clientsecret-obo"===a&&!r)throw new Error("Client Secret OBO authentication is not enabled in Grafana config.");return e={...e,jsonData:{...e.jsonData,azureCredentials:{authType:a,azureCloud:t.azureCloud||i(),tenantId:t.tenantId,clientId:t.clientId}},secureJsonData:{...e.secureJsonData,azureClientSecret:"string"==typeof t.clientSecret&&t.clientSecret.length>0?t.clientSecret:void 0},secureJsonFields:{...e.secureJsonFields,azureClientSecret:t.clientSecret===l,clientSecret:t.clientSecret===u}},"clientsecret-obo"===a&&(e={...e,jsonData:{...e.jsonData,oauthPassThru:!0}}),e;case"ad-password":return e={...e,jsonData:{...e.jsonData,azureCredentials:{authType:"ad-password",userId:t.userId,clientId:t.clientId}},secureJsonData:{...e.secureJsonData,password:"string"==typeof t.password&&t.password.length>0?t.password:void 0},secureJsonFields:{...e.secureJsonFields,password:"symbol"==typeof t.password}}}if(o("currentuser",t)){if(!s.config.azure.userIdentityEnabled)throw new Error("User Identity authentication is not enabled in Grafana config.");const r=t.serviceCredentials;let a;return o("clientsecret",r)&&(a=r.clientSecret,delete r.clientSecret),e={...e,jsonData:{...e.jsonData,azureCredentials:{authType:"currentuser",serviceCredentialsEnabled:t.serviceCredentialsEnabled,serviceCredentials:r},oauthPassThru:!0,disableGrafanaCache:!0},secureJsonData:{...e.secureJsonData,azureClientSecret:"string"==typeof a&&a.length>0?a:void 0},secureJsonFields:{...e.secureJsonFields,azureClientSecret:a===l,clientSecret:a===u}}}throw new Error(`The auth type '${a}' is not supported.`)}},9728:(e,t,r)=>{"use strict";e.exports=r(8044)},9866:(e,t,r)=>{"use strict";var o=r(1308),s=r.n(o);r.p=s()&&s().uri?s().uri.slice(0,s().uri.lastIndexOf("/")+1):"public/plugins/grafana-azure-monitor-datasource/"},9881:(e,t,r)=>{"use strict";const o=r(4256);e.exports=(e,t)=>{const r=o(e,t);return r?r.version:null}}},w={};function O(e){var t=w[e];if(void 0!==t)return t.exports;var r=w[e]={id:e,exports:{}};return y[e](r,r.exports,O),r.exports}return O.m=y,p="function"==typeof Symbol,m=p?Symbol("webpack queues"):"__webpack_queues__",f=p?Symbol("webpack exports"):"__webpack_exports__",b=p?Symbol("webpack error"):"__webpack_error__",h=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},O.a=(e,t,r)=>{var o;r&&((o=[]).d=-1);var s,a,n,i=new Set,c=e.exports,l=new Promise(((e,t)=>{n=t,a=e}));l[f]=c,l[m]=e=>(o&&e(o),i.forEach(e),l.catch((e=>{}))),e.exports=l,t((e=>{var t;s=(e=>e.map((e=>{if(null!==e&&"object"==typeof e){if(e[m])return e;if(e.then){var t=[];t.d=0,e.then((e=>{r[f]=e,h(t)}),(e=>{r[b]=e,h(t)}));var r={};return r[m]=e=>e(t),r}}var o={};return o[m]=e=>{},o[f]=e,o})))(e);var r=()=>s.map((e=>{if(e[b])throw e[b];return e[f]})),a=new Promise((e=>{(t=()=>e(r)).r=0;var a=e=>e!==o&&!i.has(e)&&(i.add(e),e&&!e.d&&(t.r++,e.push(t)));s.map((e=>e[m](a)))}));return t.r?a:r()}),(e=>(e?n(l[b]=e):a(c),h(o)))),o&&o.d<0&&(o.d=0)},O.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return O.d(t,{a:t}),t},O.d=(e,t)=>{for(var r in t)O.o(t,r)&&!O.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},O.f={},O.e=e=>Promise.all(Object.keys(O.f).reduce(((t,r)=>(O.f[r](e,t),t)),[])),O.u=e=>e+".js",O.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g={},v="grafana-azure-monitor-datasource:",O.l=(e,t,r,o)=>{if(g[e])g[e].push(t);else{var s,a;if(void 0!==r)for(var n=document.getElementsByTagName("script"),i=0;i<n.length;i++){var c=n[i];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==v+r){s=c;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,O.nc&&s.setAttribute("nonce",O.nc),s.setAttribute("data-webpack",v+r),s.src=e),g[e]=[t];var l=(t,r)=>{s.onerror=s.onload=null,clearTimeout(u);var o=g[e];if(delete g[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(r))),t)return t(r)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=l.bind(null,s.onerror),s.onload=l.bind(null,s.onload),a&&document.head.appendChild(s)}},O.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},O.p="public/plugins/grafana-azure-monitor-datasource/",(()=>{var e={231:0};O.f.j=(t,r)=>{var o=O.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var s=new Promise(((r,s)=>o=e[t]=[r,s]));r.push(o[2]=s);var a=O.p+O.u(t),n=new Error;O.l(a,(r=>{if(O.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var s=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;n.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",n.name="ChunkLoadError",n.type=s,n.request=a,o[1](n)}}),"chunk-"+t,t)}};var t=(t,r)=>{var o,s,[a,n,i]=r,c=0;if(a.some((t=>0!==e[t]))){for(o in n)O.o(n,o)&&(O.m[o]=n[o]);if(i)i(O)}for(t&&t(r);c<a.length;c++)s=a[c],O.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=globalThis.webpackChunkgrafana_azure_monitor_datasource=globalThis.webpackChunkgrafana_azure_monitor_datasource||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),O.nc=void 0,O(3963)})()));
//# sourceMappingURL=module.js.map