"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1037,2182],{22488:(P,y,t)=>{t.d(y,{c:()=>d});var e=t(74848),v=t(92745),o=t(34999);function d({repo:j,items:s}){const a=f=>f?.spec?.type==="local"||!!f?.secure?.token?.name;return a(j)||s?.every(a)?null:(0,e.jsx)(o.F,{title:(0,v.t)("provisioning.inline-secure-values-warning","You need to save your access tokens again due to a system update"),severity:"error"})}},27080:(P,y,t)=>{t.r(y),t.d(y,{default:()=>ee});var e=t(74848),v=t(96540),o=t(92745),d=t(34999),j=t(71599),s=t(41654),a=t(54314),f=t(60208),u=t(13941),l=t(83793),g=t(13791),K=t(37172),S=t(90886),O=t(12737),W=t(50201),E=t(89640),B=t(30703),M=t(66404),R=t(8073),$=t(99887),I=t(45861),Z=t(69631),F=t(34145),T=t(91555),z=t(45942),G=t(31660);function V({repository:n}){const i=(0,z.rn)(n.spec?.workflows),{metadata:x,spec:r,status:p}=n,c=x?.name??"",m=()=>{const h=[];if(r?.type==="github"){const{url:C="",branch:L}=r.github??{},A=L?`${C}/tree/${L}`:C;if(h.push((0,e.jsx)(E.Y,{external:!0,href:A,children:A},"link")),p?.webhook?.id){const D=`${C}/settings/hooks/${p.webhook.id}`;h.push((0,e.jsxs)(s.B,{gap:1,direction:"row",alignItems:"center",children:[(0,e.jsx)(E.Y,{href:D,children:(0,e.jsx)(o.x6,{i18nKey:"provisioning.repository-card.get-repository-meta.webhook",children:"Webhook"})},"webhook"),(0,e.jsx)(B.I,{name:"check",className:"text-success"})]}))}}else r?.type==="local"&&h.push((0,e.jsx)(M.E,{variant:"bodySmall",children:r.local?.path??""},"path"));return h};return(0,e.jsxs)(R.Z,{noMargin:!0,children:[(0,e.jsx)(R.Z.Figure,{children:(0,e.jsx)(Z.S,{type:r?.type})}),(0,e.jsx)(R.Z.Heading,{children:(0,e.jsxs)(s.B,{gap:2,direction:"row",alignItems:"center",children:[r?.title&&(0,e.jsx)(M.E,{variant:"h3",children:r.title}),(0,e.jsx)(F.W,{repo:n}),i&&(0,e.jsx)($.E,{color:"darkgrey",text:(0,o.t)("provisioning.repository-card.read-only-badge","Read only")})]})}),(0,e.jsx)(R.Z.Description,{children:(0,e.jsxs)(s.B,{gap:2,direction:"column",children:[r?.description&&(0,e.jsx)(M.E,{children:r.description}),p?.stats?.length&&(0,e.jsx)(s.B,{gap:1,direction:"row",wrap:!0,children:p.stats.map((h,C)=>(0,e.jsxs)(I.z9,{fill:"outline",size:"md",variant:"secondary",href:Y(n,h),children:[h.count," ",h.resource]},C))})]})}),(0,e.jsx)(R.Z.Meta,{children:(0,e.jsx)(s.B,{gap:2,direction:"row",wrap:!0,children:m()})}),(0,e.jsx)(R.Z.Actions,{children:(0,e.jsxs)(s.B,{gap:1,direction:"row",children:[(0,e.jsx)(I.z9,{icon:"eye",href:`${T.mL}/${c}`,variant:"primary",size:"md",children:(0,e.jsx)(o.x6,{i18nKey:"provisioning.repository-card.view",children:"View"})}),(0,e.jsx)(G.w,{repository:n}),(0,e.jsx)(I.z9,{variant:"secondary",icon:"cog",href:`${T.mL}/${c}/edit`,size:"md",children:(0,e.jsx)(o.x6,{i18nKey:"provisioning.repository-card.settings",children:"Settings"})})]})})]},c)}function Y(n,i){return i.resource==="playlists"?"/playlists":n.spec?.sync.target==="folder"?`/dashboards/f/${n.metadata?.name}`:"/dashboards"}function U(n){return n?.length?{instanceConnected:n.some(i=>i.spec?.sync.target==="instance"),folderConnected:n.some(i=>i.spec?.sync.target==="folder"),maxReposReached:(n??[]).length>=10,repoCount:n.length}:{instanceConnected:!1,folderConnected:!1,repoCount:0,maxReposReached:!1}}var N=t(54148),H=t(88559),b=t(87063),J=t(80042),Q=t(82781);function X({items:n}){const i=U(n),x=(0,N.Zp)(),{data:r}=(0,J.F9)();if(i.instanceConnected)return null;if(i.maxReposReached)return(0,e.jsx)(d.F,{title:"",severity:"info",children:(0,e.jsxs)(o.x6,{i18nKey:"provisioning.connect-repository-button.repository-limit-info-alert",values:{count:i.repoCount},children:["Repository limit reached (","{{count}}",")"]})});const p=r?.availableRepositoryTypes||T.TD,{orderedConfigs:c}=(0,Q.fo)(p);return(0,e.jsx)(H.m,{overlay:(0,e.jsx)(b.W,{children:c.map(m=>(0,e.jsx)(b.W.Item,{icon:m.icon,label:m.label,onClick:()=>x(`${T.pd}/${m.type}`)},m.type))}),children:(0,e.jsx)(I.$n,{variant:"primary",children:(0,e.jsxs)(s.B,{alignItems:"center",children:[(0,e.jsx)(o.x6,{i18nKey:"provisioning.connect-repository-button.configure",children:"Configure"}),(0,e.jsx)(B.I,{name:"angle-down"})]})})})}function w({items:n}){const[i,x]=(0,v.useState)(""),r=n.filter(c=>c.metadata?.name?.includes(i)),{instanceConnected:p}=U(n);return(0,e.jsxs)(s.B,{direction:"column",gap:3,children:[!p&&(0,e.jsxs)(s.B,{gap:2,children:[(0,e.jsx)(O.Z,{placeholder:(0,o.t)("provisioning.folder-repository-list.placeholder-search","Search"),value:i,onChange:x}),(0,e.jsx)(X,{items:n})]}),(0,e.jsx)(s.B,{direction:"column",gap:2,children:r.length?r.map(c=>(0,e.jsx)(V,{repository:c},c.metadata?.name)):(0,e.jsx)(W.p,{variant:"not-found",message:(0,o.t)("provisioning.folder-repository-list.no-results-matching-your-query","No results matching your query")})})]})}var k=t(22488);function q(n={}){const i=(0,l.Ih)(n),x=new Intl.Collator(void 0,{numeric:!0});return[i.data?.items?.slice().sort((p,c)=>{const m=p.spec?.title??"",h=c.spec?.title??"";return x.compare(m,h)}),i.isLoading]}var _=(n=>(n.Repositories="repositories",n.GettingStarted="getting-started",n))(_||{});function ee(){const[n,i]=q({watch:!0}),x=(0,l.F9)(),[r]=(0,l.KA)(),[p,c]=(0,v.useState)(!1),[m,h]=(0,v.useState)("repositories"),C=(0,v.useMemo)(()=>[{value:"repositories",label:(0,o.t)("provisioning.home-page.tab-repositories","Repositories"),title:(0,o.t)("provisioning.home-page.tab-repositories-title","List of repositories")},{value:"getting-started",label:(0,o.t)("provisioning.home-page.tab-getting-started","Getting started"),title:(0,o.t)("provisioning.home-page.tab-getting-started-title","Getting started")}],[]);if(!n?.length&&!i)return(0,e.jsx)(S.default,{items:n??[]});const L=()=>{r({}),c(!1)},A=()=>{switch(m){case"repositories":return(0,e.jsx)(w,{items:n??[]});case"getting-started":return(0,e.jsx)(K.A,{items:n??[]});default:return null}};return(0,e.jsx)(g.Y,{navId:"provisioning",subTitle:(0,o.t)("provisioning.home-page.subtitle","View and manage your configured repositories"),children:(0,e.jsxs)(g.Y.Contents,{isLoading:i,children:[x.data?.legacyStorage&&(0,e.jsx)(d.F,{title:(0,o.t)("provisioning.home-page.title-legacy-storage-detected","Legacy storage detected"),severity:"error",buttonContent:(0,e.jsx)(o.x6,{i18nKey:"provisioning.home-page.remove-all-configured-repositories",children:"Remove all configured repositories"}),onRemove:()=>{c(!0)},children:(0,e.jsx)(o.x6,{i18nKey:"provisioning.home-page.configured-repositories-while-running-legacy-storage",children:"Configured repositories will not work while running legacy storage."})}),(0,e.jsx)(k.c,{items:n}),(0,e.jsx)(j.u,{isOpen:p,title:(0,o.t)("provisioning.home-page.title-delete-all-configured-repositories","Delete all configured repositories"),body:(0,o.t)("provisioning.home-page.confirm-delete-repositories","Are you sure you want to delete all configured repositories? This action cannot be undone."),confirmText:(0,o.t)("provisioning.home-page.button-delete-repositories","Delete repositories"),onConfirm:L,onDismiss:()=>c(!1)}),(0,e.jsxs)(s.B,{direction:"column",gap:2,children:[(0,e.jsx)(a.U,{children:C.map(D=>(0,e.jsx)(f.o,{label:D.label,active:m===D.value,onChangeTab:()=>h(D.value),title:D.title},D.value))}),(0,e.jsx)(u.J,{children:A()})]})]})})}},31660:(P,y,t)=>{t.d(y,{w:()=>u});var e=t(74848),v=t(96540),o=t(54148),d=t(92745),j=t(71599),s=t(45861),a=t(83793),f=t(91555);function u({repository:l}){const[g,K]=(0,a.bS)(),[S,O]=(0,v.useState)(!1),W=(0,o.Zp)(),E=l.metadata?.name,B=()=>{E&&(g({name:E,jobSpec:{pull:{incremental:!1}}}),O(!1))},M=!!l.status?.health.healthy;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.$n,{icon:"cloud-download",variant:"secondary",tooltip:M?void 0:(0,d.t)("provisioning.sync-repository.tooltip-unhealthy-repository","Unable to pull an unhealthy repository"),disabled:K.isLoading||!E||!M,onClick:B,children:(0,e.jsx)(d.x6,{i18nKey:"provisioning.sync-repository.pull",children:"Pull"})}),!l.spec?.sync.enabled&&(0,e.jsx)(j.u,{isOpen:S,title:(0,d.t)("provisioning.sync-repository.title-pull-not-enabled","Pull is not enabled"),body:(0,d.t)("provisioning.sync-repository.body-edit-configuration","Edit the configuration"),confirmText:(0,d.t)("provisioning.sync-repository.button-edit","Edit"),onConfirm:()=>W(`${f.mL}/${E}/edit`),onDismiss:()=>O(!1)})]})}},34145:(P,y,t)=>{t.d(y,{W:()=>s});var e=t(74848),v=t(92745),o=t(36490),d=t(99887),j=t(91555);function s({repo:a}){if(!a)return null;if(a.spec?.type!=="local"&&!a.secure?.token?.name)return(0,e.jsx)(d.E,{color:"red",icon:"exclamation-triangle",style:{cursor:"pointer"},text:(0,v.t)("provisioning.inline-token-warning-badge-text","Token needs to be saved again"),tooltip:(0,v.t)("inline-token-warning-badge-tooltip","The method to save the token is to re-enter it in the repository settings."),onClick:()=>{o.Ny.push(`${j.mL}/${a.metadata?.name}/edit`)}});let f,u="purple",l="Unknown",g="exclamation-triangle";if(a.metadata?.deletionTimestamp)u="red",l="Deleting",g="spinner";else if(!a.spec?.sync?.enabled)u="red",l="Automatic pulling disabled",g="info-circle";else if(!a.status?.sync?.state?.length)u="darkgrey",l="Pending",g="spinner",f="Waiting for health check to run";else switch(a.status?.sync?.state){case"success":g="check",l="Up-to-date",u="green";break;case"working":case"warning":u="orange",l="warning",g="exclamation-triangle";break;case"pending":u="darkgrey",l="Pulling",g="spinner";break;case"error":u="red",l="Error",g="exclamation-triangle";break;default:break}return(0,e.jsx)(d.E,{color:u,icon:g,text:l,style:{cursor:"pointer"},tooltip:f,onClick:()=>{o.Ny.push(`${j.mL}/${a.metadata?.name}/?tab=overview`)}})}},88552:(P,y,t)=>{P.exports=t.p+"static/img/provisioning.d25529e1.svg"}}]);

//# sourceMappingURL=RepositoryListPage.067cb3837b1136c29f89.js.map