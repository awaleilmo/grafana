"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4519],{1299:(R,g,t)=>{t.d(g,{D:()=>o});var s=t(74848),e=t(11594),r=t(92745),c=t(99887);function o({error:u}){const j=E(u);return(0,s.jsx)(c.E,{icon:"exclamation-triangle",text:(0,r.t)("plugins.plugin-disabled-badge.text-disabled","Disabled"),color:"red",tooltip:j})}function E(u){switch(u){case e.ZK.modifiedSignature:return"Plugin disabled due to modified content";case e.ZK.invalidSignature:return"Plugin disabled due to invalid plugin signature";case e.ZK.missingSignature:return"Plugin disabled due to missing plugin signature";case null:case void 0:return"Plugin disabled";default:return`Plugin disabled due to unknown error${u?`: ${u}`:""}`}}},6650:(R,g,t)=>{t.d(g,{A:()=>o});var s=t(74848),e=t(92745),r=t(45861);const o=({disabled:E,onUpdateAll:u,updatablePluginsLength:j})=>(0,s.jsx)(r.$n,{disabled:E,onClick:u,children:E?(0,s.jsx)(e.x6,{i18nKey:"plugins.catalog.no-updates-available",children:"No updates available"}):(0,s.jsxs)(e.x6,{i18nKey:"plugins.catalog.update-all.button",values:{length:j},children:["Update all (","{{length}}",")"]})})},23691:(R,g,t)=>{t.d(g,{A5:()=>_,wr:()=>C,m5:()=>I,PW:()=>k,F9:()=>D,ob:()=>d,sM:()=>J,xX:()=>v,XN:()=>M,pw:()=>y,Gp:()=>A,qG:()=>F,SQ:()=>K});var s=t(96540),e=t(52763),r=t(4476),c=t(37256),o=t(25508),E=t(2543),u=t(8934),j=t(27489),p=t(13660),B=t(54687);const O=a=>a.plugins,P=(0,o.Mz)(O,({items:a})=>a),{selectAll:G,selectById:L}=B.AI.getSelectors(P),Z=(0,E.debounce)(a=>{(0,j.rR)("plugins_search",{resultsCount:a,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})},300),w=a=>(0,o.Mz)(G,l=>{const h=a.keyword?(0,u.xb)(a.keyword.toLowerCase()):"",i=h!==""?(0,r.TD)(l,h):null,f=l.filter(x=>!(h&&i==null||h&&!i?.includes(x.id)||a.type&&x.type!==a.type||a.isInstalled!==void 0&&x.isInstalled!==a.isInstalled||a.isEnterprise!==void 0&&x.isEnterprise!==a.isEnterprise||a.hasUpdate!==void 0&&(x.hasUpdate!==a.hasUpdate||!(0,r.wD)(x))));return h&&Z(f.length),f}),X=a=>(0,o.Mz)(G,l=>{const h=[];for(const i of l)i.error&&(!a||i.type===a)&&h.push({pluginId:i.id,errorCode:i.error,pluginType:i.type});return h}),N=a=>(0,o.Mz)(O,({requests:l={}})=>l[a]),S=a=>(0,o.Mz)(N(a),l=>l?.status===p.IZ.Pending),W=a=>(0,o.Mz)(N(a),l=>l?.status===p.IZ.Rejected?l?.error:null),Q=a=>(0,o.Mz)(N(a),l=>l===void 0),k=(a,l=r.by.nameAsc)=>{b();const h=(0,s.useMemo)(()=>w(a),[a]),i=(0,e.d4)(h),{isLoading:f,error:x}=z(),ns=(0,r.Xc)(i,l);return{isLoading:f,error:x,plugins:ns}},J=()=>{const{isLoading:a}=I(),{plugins:l}=k({isInstalled:!0}),h=l.filter(r.wD);return{isLoading:a,updatablePlugins:h}},d=a=>(b(),Y(a),(0,e.d4)(l=>L(l,a))),T=a=>(H(),useSelector(l=>selectById(l,a))),D=a=>(b(),(0,e.d4)(X(a))),v=()=>{const a=(0,e.wA)();return(l,h,i)=>a((0,c.ai)({id:l,version:h,installType:i}))},K=()=>{const a=(0,e.wA)();return()=>a((0,c.nT)())},A=()=>{const a=(0,e.wA)();return l=>a((0,c.JC)(l))},y=()=>(0,e.d4)(W(c.JJ.typePrefix))===null,z=()=>{const a=(0,e.d4)(S("plugins/fetchLocal")),l=(0,e.d4)(W("plugins/fetchLocal"));return{isLoading:a,error:l}},I=()=>{const a=(0,e.d4)(S(c.mj.typePrefix)),l=(0,e.d4)(S("plugins/fetchLocal")),h=(0,e.d4)(S("plugins/fetchRemote")),i=a||l||h,f=(0,e.d4)(W(c.mj.typePrefix));return{isLoading:i,error:f}},C=()=>{const a=(0,e.d4)(S(c.t5.typePrefix)),l=(0,e.d4)(W(c.t5.typePrefix));return{isLoading:a,error:l}},M=()=>{const a=(0,e.d4)(S(c.ai.typePrefix)),l=(0,e.d4)(W(c.ai.typePrefix));return{isInstalling:a,error:l}},F=()=>{const a=(0,e.d4)(S(c.JC.typePrefix)),l=(0,e.d4)(W(c.JC.typePrefix));return{isUninstalling:a,error:l}},b=()=>{const a=(0,e.wA)(),l=(0,e.d4)(Q(c.mj.typePrefix));(0,s.useEffect)(()=>{l&&a((0,c.mj)())},[])},H=()=>{const a=useDispatch(),l=useSelector(selectIsRequestNotFetched(fetchAllLocal.typePrefix));useEffect(()=>{l&&a(fetchAllLocal())},[])},Y=a=>{const l=(0,e.wA)(),h=(0,e.d4)(x=>L(x,a)),f=!(0,e.d4)(S(c.t5.typePrefix))&&h&&!h.details;(0,s.useEffect)(()=>{f&&l((0,c.t5)(a))},[h])},_=()=>{const a=(0,e.wA)();return l=>a((0,c.t5)(l))}},27589:(R,g,t)=>{t.d(g,{z:()=>o});var s=t(74848),e=t(22803),r=t(92745),c=t(63142);function o({plugin:u}){const j=(0,c.of)(E);return(0,s.jsx)("p",{className:j.hasUpdate,children:(0,s.jsx)(r.x6,{i18nKey:"plugins.plugin-update-available-badge.update-available",children:"Update available!"})})}const E=u=>({hasUpdate:(0,e.css)({color:u.colors.text.secondary,fontSize:u.typography.bodySmall.fontSize,marginBottom:0})})},37761:(R,g,t)=>{t.r(g),t.d(g,{default:()=>vs});var s=t(74848),e=t(22803),r=t(96540),c=t(54148),o=t(92745),E=t(36490),u=t(63142),j=t(89640),p=t(37386),B=t(18857),O=t(77824),P=t(45967),G=t(13791),L=t(84057),Z=t(51026),w=t(26437),X=t(52763),N=t(40203),S=t(35557),W=t(43173),Q=t(50201),k=t(13943),J=t(70255),d=t(27489),T=t(30703),D=t(41654),v=t(99887),K=t(21348),A=t(13660),y=t(63509),z=t(4476),I=t(99946),C=t(1299),M=t(62061),F=t(93984);function b({plugin:n}){const m=(0,u.of)(F.X);return(0,M.a)("enterprise.plugins")?(0,s.jsx)(v.E,{text:(0,o.t)("plugins.plugin-enterprise-badge.text-enterprise","Enterprise"),color:"blue"}):(0,s.jsxs)(D.B,{wrap:"wrap",children:[(0,s.jsx)(y.B,{status:n.signature}),(0,s.jsx)(v.E,{icon:"lock",role:"img","aria-label":(0,o.t)("plugins.plugin-enterprise-badge.aria-label-enterprise","Enterprise"),text:(0,o.t)("plugins.plugin-enterprise-badge.text-enterprise","Enterprise"),color:"blue",className:m,title:(0,o.t)("plugins.plugin-enterprise-badge.title-requires-a-grafana-enterprise-license","Requires a Grafana Enterprise license")})]})}var H=t(74814),Y=t(27589);function _({plugin:n}){const m=(0,z.wD)(n);return n.isEnterprise?(0,s.jsxs)(D.B,{height:"auto",wrap:"wrap",children:[(0,s.jsx)(b,{plugin:n}),n.isDisabled&&(0,s.jsx)(C.D,{error:n.error}),m&&(0,s.jsx)(Y.z,{plugin:n})]}):(0,s.jsxs)(D.B,{height:"auto",wrap:"wrap",children:[(0,s.jsx)(y.B,{status:n.signature}),n.isDisabled&&(0,s.jsx)(C.D,{error:n.error}),n.isDeprecated&&(0,s.jsx)(I.y,{}),n.isInstalled&&(0,s.jsx)(H.J,{}),m&&(0,s.jsx)(Y.z,{plugin:n})]})}function a({alt:n,className:m,src:U,height:$}){return(0,s.jsx)("img",{src:U,className:m,alt:n,loading:"lazy",height:$})}const l="48px";function h({plugin:n,pathName:m}){const U=(0,u.of)(x),$=()=>{E.Ny.getSearchObject()?.q&&(0,d.rR)("plugins_search_user_click",{plugin_id:n.id,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"})};return(0,s.jsxs)("a",{href:`${m}/${n.id}`,className:(0,e.cx)(U.container),onClick:$,children:[(0,s.jsx)(a,{src:n.info.logos.small,className:U.pluginLogo,height:l,alt:""}),(0,s.jsx)("h2",{className:(0,e.cx)(U.name,"plugin-name"),children:n.name}),(0,s.jsxs)("div",{className:(0,e.cx)(U.content,"plugin-content"),children:[(0,s.jsx)("p",{children:(0,s.jsxs)(o.x6,{i18nKey:"plugins.plugin-list-item.label-author",values:{author:n.orgName},children:["By ","{{author}}"]})}),(0,s.jsx)(_,{plugin:n})]}),(0,s.jsx)("div",{className:U.pluginType,children:n.type&&(0,s.jsx)(T.I,{name:A.Ip[n.type],title:(0,o.t)("plugins.plugin-list-item.title-icon-plugin-type","{{pluginType}} plugin",{pluginType:n.type})})})]})}const i=({rootProps:n})=>{const m=(0,u.of)(x);return(0,s.jsxs)("div",{className:(0,e.cx)(m.container),...n,children:[(0,s.jsx)(J.A,{containerClassName:(0,e.cx)(m.pluginLogo,(0,e.css)({lineHeight:1})),width:l,height:l}),(0,s.jsx)("h2",{className:m.name,children:(0,s.jsx)(J.A,{width:100})}),(0,s.jsxs)("div",{className:m.content,children:[(0,s.jsx)("p",{children:(0,s.jsx)(J.A,{width:120})}),(0,s.jsxs)(D.B,{direction:"row",children:[(0,s.jsx)(v.E.Skeleton,{}),(0,s.jsx)(v.E.Skeleton,{})]})]}),(0,s.jsx)("div",{className:m.pluginType,children:(0,s.jsx)(J.A,{width:16,height:16})})]})},f=(0,K.j)(h,i),x=n=>({container:(0,e.css)({display:"grid",gridTemplateColumns:`${l} 1fr ${n.spacing(3)}`,gridTemplateRows:"auto",gap:n.spacing(2),gridAutoFlow:"row",background:n.colors.background.secondary,borderRadius:n.shape.radius.default,padding:n.spacing(3),[n.transitions.handleMotion("no-preference","reduce")]:{transition:n.transitions.create(["background-color","box-shadow","border-color","color"],{duration:n.transitions.duration.short})},"&:hover":{background:n.colors.emphasize(n.colors.background.secondary,.03)}}),pluginType:(0,e.css)({gridArea:"1 / 3 / 2 / 4",color:n.colors.text.secondary}),pluginLogo:(0,e.css)({gridArea:"1 / 1 / 3 / 2",maxWidth:"100%",alignSelf:"center",objectFit:"contain"}),content:(0,e.css)({gridArea:"3 / 1 / 4 / 3",color:n.colors.text.secondary}),name:(0,e.css)({gridArea:"1 / 2 / 3 / 3",alignSelf:"center",fontSize:n.typography.h4.fontSize,color:n.colors.text.primary,margin:0,wordBreak:"normal",overflowWrap:"anywhere"})}),ns=({plugins:n,isLoading:m})=>{const{pathname:U}=(0,c.zy)(),[$]=(0,S.useSearchParams)(),q=W.$.appSubUrl+(U.endsWith("/")?U.slice(0,-1):U);return $.get("filterBy")==="has-update"&&!m&&n.length===0?(0,s.jsx)(Q.p,{variant:"not-found",message:(0,o.t)("plugins.no-updates-available.message","All plugins are up to date")}):!m&&n.length===0?(0,s.jsx)(Q.p,{variant:"not-found",message:(0,o.t)("plugins.empty-state.message","No plugins found")}):(0,s.jsx)(k.x,{gap:3,minColumnWidth:34,"data-testid":"plugin-list",children:m?new Array(50).fill(null).map((ss,es)=>(0,s.jsx)(f.Skeleton,{},es)):n.map(ss=>(0,s.jsx)(f,{plugin:ss,pathName:q},ss.id))})};var gs=t(42135),ps=t(84969),hs=t(6650),fs=t(65223),xs=t(81687),ls=t(23691);function vs(){const n=(0,c.zy)(),m=(0,E.SE)(n.search),U=(0,X.d4)(V=>(0,L.tc)(V.navIndex,"plugins")),$=(0,u.of)(ms),q=(0,xs.W)(),ss=(0,ls.pw)(),es=m.q?.toString()||"",ts=m.filterBy?.toString()||"all",as=m.filterByType||"all",Es=m.sortBy||z.by.nameAsc,{isLoading:ys,error:rs,plugins:Ps}=(0,ls.PW)({keyword:es,type:as!=="all"?as:void 0,isInstalled:ts==="installed"?!0:void 0,hasUpdate:ts==="has-update"?!0:void 0},Es),is=[{value:"all",label:(0,o.t)("plugins.browse.filter-by-options.label.all","All")},{value:"installed",label:(0,o.t)("plugins.browse.filter-by-options.label.installed","Installed")},{value:"has-update",label:(0,o.t)("plugins.browse.filter-by-options.label.new-updates","New Updates")}],{isLoading:cs,updatablePlugins:os}=(0,ls.sM)(),[js,ds]=(0,r.useState)(!1),Ds=os.length<=0||cs,us=V=>{q.push({query:{filterBy:V}})},As=V=>{q.push({query:{filterByType:V.value}})},Ms=V=>{q.push({query:{filterBy:ts,filterByType:as,q:V}})},Is=()=>{ds(!0)};if(rs)return console.error(rs.message),null;const Cs=(0,s.jsx)("div",{children:(0,s.jsxs)(o.x6,{i18nKey:"plugins.browse.subtitle",children:["Extend the Grafana experience with panel plugins and apps. To find more data sources go to"," ",(0,s.jsx)(j.Y,{href:`${w.b.AddNewConnection}?cat=data-source`,children:"Connections"}),"."]})}),Bs=(0,s.jsx)(hs.A,{disabled:Ds,onUpdateAll:Is,updatablePluginsLength:os.length});return(0,s.jsx)(G.Y,{navModel:U,actions:Bs,subTitle:Cs,className:$.pageContainer,children:(0,s.jsxs)(G.Y.Contents,{children:[(0,s.jsx)(Z.l,{}),(0,s.jsx)("div",{className:$.searchContainer,children:(0,s.jsxs)(N.G,{wrap:!0,children:[(0,s.jsx)(p.D,{label:(0,o.t)("plugins.browse.label-search","Search"),children:(0,s.jsx)(ps.L,{value:es,onSearch:Ms})}),(0,s.jsxs)(N.G,{wrap:!0,className:$.actionBar,children:[(0,s.jsx)(p.D,{label:(0,o.t)("plugins.browse.label-type","Type"),children:(0,s.jsx)(B.l6,{"aria-label":(0,o.t)("plugins.browse.aria-label-plugin-type-filter","Plugin type filter"),value:as,onChange:As,width:18,options:[{value:"all",label:(0,o.t)("plugins.browse.label.all","All")},{value:"datasource",label:(0,o.t)("plugins.browse.label.data-sources","Data sources")},{value:"panel",label:(0,o.t)("plugins.browse.label.panels","Panels")},{value:"app",label:(0,o.t)("plugins.browse.label.applications","Applications")}]})}),ss?(0,s.jsx)(p.D,{label:(0,o.t)("plugins.browse.label-state","State"),children:(0,s.jsx)(O.z,{value:ts,onChange:us,options:is})}):(0,s.jsx)(P.m,{content:(0,o.t)("plugins.browse.tooltip-filter-disabled","This filter has been disabled because the Grafana server cannot access grafana.com"),placement:"top",children:(0,s.jsx)("div",{children:(0,s.jsx)(p.D,{label:(0,o.t)("plugins.browse.label-state","State"),children:(0,s.jsx)(O.z,{disabled:!0,value:ts,onChange:us,options:is})})})})]})]})}),(0,s.jsx)("div",{className:$.listWrap,children:(0,s.jsx)(ns,{plugins:Ps,isLoading:ys})}),(0,s.jsx)(gs.E,{}),(0,s.jsx)(fs.U,{isOpen:js,isLoading:cs,onDismiss:()=>ds(!1),plugins:os})]})})}const ms=n=>({pageContainer:(0,e.css)({height:"100vh",overflow:"hidden"}),searchContainer:(0,e.css)({backgroundColor:n.colors.background.primary,paddingTop:n.spacing(2),paddingBottom:n.spacing(2),borderBottom:`1px solid ${n.colors.border.weak}`,marginBottom:n.spacing(2)}),listWrap:(0,e.css)({height:"calc(100vh - 350px)",overflowY:"auto"}),actionBar:(0,e.css)({[n.breakpoints.up("xl")]:{marginLeft:"auto"}}),displayAs:(0,e.css)({svg:{marginRight:0}})})},42135:(R,g,t)=>{t.d(g,{E:()=>E});var s=t(74848),e=t(92745),r=t(27489),c=t(89640),o=t(35137);const E=()=>(0,s.jsxs)("div",{children:[(0,s.jsx)(o.$,{v:2}),(0,s.jsx)(c.Y,{href:"https://github.com/grafana/grafana/issues/new?assignees=&labels=area%2Fdatasource%2Ctype%2Fnew-plugin-request&projects=&template=3-data_source_request.yaml&title=%5BNew+Data+Source%5D%3A+%3Cname-of-service%3E",onClick:()=>(0,r.rR)("connections_data_source_request_clicked"),external:!0,children:(0,s.jsx)(e.x6,{i18nKey:"connections.connect-data.request-data-source",children:"Request a new data source"})}),(0,s.jsx)("br",{}),(0,s.jsx)(c.Y,{href:"https://github.com/orgs/grafana/projects/619/views/1?pane=info",onClick:()=>(0,r.rR)("connections_data_source_roadmap_clicked"),external:!0,children:(0,s.jsx)(e.x6,{i18nKey:"connections.connect-data.roadmap",children:"View roadmap"})})]})},51026:(R,g,t)=>{t.d(g,{l:()=>G});var s=t(74848),e=t(22803),r=t(96540),c=t(92745),o=t(43173),E=t(55315),u=t(34999),j=t(45861),p=t(63142),B=t(73427);const O=L=>({alertContent:(0,e.css)({display:"flex",flexDirection:"row",padding:0,justifyContent:"space-between",alignItems:"center"}),alertParagraph:(0,e.css)({margin:L.spacing(0,1,0,0),lineHeight:L.spacing(L.components.height.sm)})}),P=new E.X("advisor-redirect-notice");function G(){const L=(0,p.of)(O),Z=B.TP.hasRole("Admin")||B.TP.isGrafanaAdmin,[w,X]=(0,r.useState)(!1),N=Z&&o.$.featureToggles.grafanaAdvisor&&!!o.$.apps["grafana-advisor-app"];return(0,r.useEffect)(()=>{N&&P.getItem("showNotice").then(S=>{S!=="false"&&X(!0)})},[N]),w?(0,s.jsx)(u.F,{severity:"info",title:"",onRemove:()=>{P.setItem("showNotice","false"),X(!1)},children:(0,s.jsxs)("div",{className:L.alertContent,children:[(0,s.jsx)("p",{className:L.alertParagraph,children:(0,s.jsx)(c.x6,{i18nKey:"connections.advisor-redirect-notice.body",children:"Try the new Advisor to uncover potential issues with your data sources and plugins."})}),(0,s.jsx)(j.z9,{"aria-label":(0,c.t)("connections.advisor-redirect-notice.aria-label-link-to-advisor","Link to Advisor"),icon:"arrow-right",href:"/a/grafana-advisor-app",fill:"text",children:(0,s.jsx)(c.x6,{i18nKey:"connections.advisor-redirect-notice.go-to-advisor",children:"Go to Advisor"})})]})}):(0,s.jsx)(s.Fragment,{})}},65223:(R,g,t)=>{t.d(g,{U:()=>W,A:()=>J});var s=t(74848),e=t(96540),r=t(92745),c=t(27489),o=t(43173),E=t(71599),u=t(23691),j=t(13660),p=t(22803),B=t(63142),O=t(45967),P=t(30703),G=t(68079),L=t(50201),Z=t(32635);const w=d=>({table:(0,p.css)({marginTop:d.spacing(2),width:"100%",borderCollapse:"collapse"}),tableRow:(0,p.css)({borderBottom:`1px solid ${d.colors.border.weak}`,td:{paddingRight:d.spacing(1)}}),icon:(0,p.css)({display:"flex",justifyContent:"center",alignItems:"center"}),header:(0,p.css)({textAlign:"left",padding:d.spacing(1),borderBottom:`2px solid ${d.colors.border.strong}`,th:{paddingRight:d.spacing(1)}}),data:(0,p.css)({padding:"10px"}),footer:(0,p.css)({fontSize:d.typography.bodySmall.fontSize,marginTop:d.spacing(3)}),noPluginsMessage:(0,p.css)({display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}),tableContainer:(0,p.css)({overflowY:"auto",overflowX:"hidden",maxHeight:d.spacing(41),marginBottom:d.spacing(2)}),errorIcon:(0,p.css)({color:d.colors.error.main}),successIcon:(0,p.css)({color:d.colors.success.main}),pluginsInstalled:(0,p.css)({svg:{marginRight:d.spacing(1)}})}),X=({id:d,inProgress:T,isSelected:D,isInstalled:v,errorMap:K})=>{const A=(0,B.of)(w);return K&&K.has(d)?(0,s.jsx)(O.m,{content:(0,r.t)("plugins.catalog.update-all.error","Error updating plugin: {{errorMessage}}",{errorMessage:K.get(d)?.message}),children:(0,s.jsx)(P.I,{className:A.errorIcon,size:"xl",name:"exclamation-triangle"})}):v?(0,s.jsx)(P.I,{className:A.successIcon,size:"xl",name:"check"}):T&&D?(0,s.jsx)(G.y,{}):""},N=({plugins:d,pluginsNotInstalled:T,inProgress:D,selectedPlugins:v,onCheckboxChange:K,errorMap:A})=>{const y=(0,B.of)(w),z=d.length-T.size,I=d.length!==T.size&&!D;return(0,s.jsx)("div",{children:d.length===0?(0,s.jsx)(L.p,{variant:"completed",message:(0,r.t)("plugins.catalog.update-all.all-plugins-updated","All plugins updated!")}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:(0,s.jsx)(r.x6,{i18nKey:"plugins.catalog.update-all.header",children:"The following plugins have update available"})}),(0,s.jsx)("div",{className:y.tableContainer,children:(0,s.jsxs)("table",{className:y.table,children:[(0,s.jsx)("thead",{className:y.header,children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:(0,s.jsx)(r.x6,{i18nKey:"plugins.catalog.update-all.update-header",children:"Update"})}),(0,s.jsx)("th",{children:(0,s.jsx)(r.x6,{i18nKey:"plugins.catalog.update-all.name-header",children:"Name"})}),(0,s.jsx)("th",{children:(0,s.jsx)(r.x6,{i18nKey:"plugins.catalog.update-all.installed-header",children:"Installed"})}),(0,s.jsx)("th",{children:(0,s.jsx)(r.x6,{i18nKey:"plugins.catalog.update-all.available-header",children:"Available"})}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:d.map(({id:C,name:M,installedVersion:F,latestVersion:b})=>(0,s.jsxs)("tr",{className:y.tableRow,children:[(0,s.jsx)("td",{children:(0,s.jsx)(Z.S,{onChange:()=>K(C),value:v?.has(C),disabled:!T.has(C)})}),(0,s.jsx)("td",{children:M}),(0,s.jsx)("td",{children:F}),(0,s.jsx)("td",{children:b}),(0,s.jsx)("td",{className:y.icon,children:(0,s.jsx)(X,{id:C,inProgress:D,isSelected:v?.has(C)??!1,isInstalled:!T.has(C),errorMap:A})})]},C))})]})}),z>0&&I&&(0,s.jsxs)("div",{className:y.pluginsInstalled,children:[(0,s.jsx)(P.I,{className:y.successIcon,size:"lg",name:"check"}),`${z} ${(0,r.t)("plugins.catalog.update-all.update-status-text","plugins updated")}`]}),A.size>0&&I&&(0,s.jsxs)("div",{className:y.pluginsInstalled,children:[(0,s.jsx)(P.I,{className:y.errorIcon,size:"lg",name:"exclamation-triangle"}),`${A.size} ${(0,r.t)("plugins.catalog.update-all.error-status-text","failed - see error messages")}`]}),o.$.pluginAdminExternalManageEnabled&&(0,s.jsx)("footer",{className:y.footer,children:(0,s.jsx)(r.x6,{i18nKey:"plugins.catalog.update-all.cloud-update-message",children:"* It may take a few minutes for the plugins to be available for usage."})})]})})},S="plugins_update_all_clicked",W=({isOpen:d,onDismiss:T,isLoading:D,plugins:v})=>{const K=(0,u.xX)(),{error:A}=(0,u.XN)(),[y,z]=(0,e.useState)(new Map),[I,C]=(0,e.useState)(!1),[M,F]=(0,e.useState)(),b=(0,e.useRef)(v),H=(0,e.useMemo)(()=>new Set(v.map(i=>i.id)),[v]),Y=v.length;(0,e.useEffect)(()=>{b.current.length===0&&(b.current=[...v])},[v]),(0,e.useEffect)(()=>{I&&(M?.forEach(i=>{H.has(i)||F(f=>{const x=new Set(f);return x.delete(i),x})}),M?.size===0&&C(!1))},[I,H,M]),(0,e.useEffect)(()=>{if(M===void 0&&v.length>0&&!D){const i=new Set(v.map(f=>f.id));F(i)}},[D,v,M]),(0,e.useEffect)(()=>{I&&A&&!y.has(A.id)&&M?.has(A.id)&&(z(i=>{const f=new Map(i);return f.set(A.id,A),f}),F(i=>{const f=new Set(i);return f.delete(A.id),f}))},[A,y,I,M]);const _=async()=>{if(!I)if((0,c.rR)(S,{path:window.location.pathname,count:M?.size,creator_team:"grafana_plugins_catalog",schema_version:"1.0.0"}),C(!0),o.$.pluginAdminExternalManageEnabled)for(let i of v)M?.has(i.id)&&await K(i.id,i.latestVersion,j.u8.UPDATE);else v.forEach(i=>{M?.has(i.id)&&K(i.id,i.latestVersion,j.u8.UPDATE)})},a=()=>{b.current=[],z(new Map),C(!1),F(void 0),T()},l=i=>{F(f=>{const x=new Set(f);return x.has(i)?x.delete(i):x.add(i),x}),y.has(i)&&z(f=>{const x=new Map(f);return x.delete(i),x})},h=M?.size||0;return(0,s.jsx)(E.u,{isOpen:d,title:(0,r.t)("plugins.catalog.update-all.modal-title","Update Plugins"),body:(0,s.jsx)(N,{plugins:b.current,pluginsNotInstalled:H,inProgress:I,errorMap:y,onCheckboxChange:l,selectedPlugins:M}),onConfirm:Y>0?_:a,onDismiss:a,disabled:k(I,Y,h),confirmText:Q(Y,I,h),confirmButtonVariant:"primary"})};function Q(d,T,D){return T?(0,r.t)("plugins.catalog.update-all.modal-in-progress","Updating..."):d>0?(0,r.t)("plugins.catalog.update-all.modal-confirmation","Update")+` (${D})`:(0,r.t)("plugins.catalog.update-all.modal-dismiss","Close")}function k(d,T,D){return!!(d||T>0&&D===0)}const J=W},74814:(R,g,t)=>{t.d(g,{J:()=>E});var s=t(74848),e=t(92745),r=t(99887),c=t(63142),o=t(93984);function E(){const u=(0,c.of)(o.X);return(0,s.jsx)(r.E,{text:(0,e.t)("plugins.plugin-installed-badge.text-installed","Installed"),color:"orange",className:u})}},81687:(R,g,t)=>{t.d(g,{W:()=>e});var s=t(36490);const e=()=>({push:({query:r})=>{s.Ny.partial(r)}})},84969:(R,g,t)=>{t.d(g,{L:()=>u});var s=t(74848),e=t(96540),r=t(40996),c=t(92745),o=t(12737);const E=(j,p=0,B=[])=>{const O=(0,e.useRef)(!0),P=[...B,O];return(0,r.A)(()=>{if(O.current){O.current=!1;return}return j()},p,P)},u=({value:j,onSearch:p})=>{const[B,O]=(0,e.useState)(j);return E(()=>p(B??""),500,[B]),(0,s.jsx)(o.Z,{value:B,onKeyDown:P=>{(P.key==="Enter"||P.keyCode===13)&&p(P.currentTarget.value)},placeholder:(0,c.t)("plugins.search-field.placeholder-search-grafana-plugins","Search Grafana plugins"),onChange:P=>{O(P)},width:46})}},93984:(R,g,t)=>{t.d(g,{X:()=>e});var s=t(22803);const e=r=>(0,s.css)({background:r.colors.background.primary,borderColor:r.colors.border.strong,color:r.colors.text.secondary})},99946:(R,g,t)=>{t.d(g,{y:()=>c});var s=t(74848),e=t(92745),r=t(99887);function c(){return(0,s.jsx)(r.E,{icon:"exclamation-triangle",text:(0,e.t)("plugins.plugin-deprecated-badge.text-deprecated","Deprecated"),color:"orange",tooltip:(0,e.t)("plugins.plugin-deprecated-badge.tooltip-plugin-deprecated-longer-receives-updates","This plugin is deprecated and no longer receives updates.")})}}}]);

//# sourceMappingURL=PluginListPage.cf64a93d46a9dc7ecc42.js.map