{"version":3,"file":"ServiceAccountsPage.c6be90bd6b9552db7b2a.js","mappings":"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","sources":["webpack://grafana/./public/app/features/admin/OrgRolePicker.tsx","webpack://grafana/./public/app/features/serviceaccounts/components/CreateTokenModal.tsx","webpack://grafana/./public/app/features/serviceaccounts/ServiceAccountTable.tsx","webpack://grafana/./public/app/features/serviceaccounts/ServiceAccountsListPage.tsx","webpack://grafana/./public/app/features/serviceaccounts/state/actions.ts","webpack://grafana/./public/app/core/components/RolePicker/UserRolePicker.tsx"],"sourcesContent":["import { OrgRole } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { Select } from '@grafana/ui';\n\ninterface Props {\n  value: OrgRole;\n  disabled?: boolean;\n  'aria-label'?: string;\n  inputId?: string;\n  onChange: (role: OrgRole) => void;\n  autoFocus?: boolean;\n  width?: number | 'auto';\n}\n\nconst basicRoles = Object.values(OrgRole).filter((r) => r !== OrgRole.None);\nconst options = basicRoles.map((r) => ({ label: r, value: r }));\n\nexport function OrgRolePicker({ value, onChange, 'aria-label': ariaLabel, inputId, autoFocus, ...restProps }: Props) {\n  return (\n    <Select\n      inputId={inputId}\n      value={value}\n      options={options}\n      onChange={(val) => onChange(val.value ?? OrgRole.None)}\n      placeholder={t('admin.org-role-picker.placeholder-choose-role', 'Choose role...')}\n      aria-label={ariaLabel}\n      autoFocus={autoFocus}\n      {...restProps}\n    />\n  );\n}\n","import { css } from '@emotion/css';\nimport { useEffect, useState } from 'react';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { config } from '@grafana/runtime';\nimport {\n  Button,\n  ClipboardButton,\n  DatePickerWithInput,\n  Field,\n  Input,\n  Modal,\n  RadioButtonGroup,\n  useStyles2,\n} from '@grafana/ui';\n\nconst EXPIRATION_OPTIONS = [\n  { label: 'No expiration', value: false },\n  { label: 'Set expiration date', value: true },\n];\n\nexport type ServiceAccountToken = {\n  name: string;\n  secondsToLive?: number;\n};\n\ninterface Props {\n  isOpen: boolean;\n  token: string;\n  serviceAccountLogin: string;\n  onCreateToken: (token: ServiceAccountToken) => void;\n  onClose: () => void;\n}\n\nexport const CreateTokenModal = ({ isOpen, token, serviceAccountLogin, onCreateToken, onClose }: Props) => {\n  const tomorrow = new Date();\n  tomorrow.setDate(tomorrow.getDate() + 1);\n\n  const maxExpirationDate = new Date();\n  if (config.tokenExpirationDayLimit !== undefined && config.tokenExpirationDayLimit > -1) {\n    maxExpirationDate.setDate(maxExpirationDate.getDate() + config.tokenExpirationDayLimit + 1);\n  } else {\n    maxExpirationDate.setDate(8640000000000000);\n  }\n  const defaultExpirationDate = config.tokenExpirationDayLimit !== undefined && config.tokenExpirationDayLimit > 0;\n\n  const [defaultTokenName, setDefaultTokenName] = useState('');\n  const [newTokenName, setNewTokenName] = useState('');\n  const [isWithExpirationDate, setIsWithExpirationDate] = useState(defaultExpirationDate);\n  const [newTokenExpirationDate, setNewTokenExpirationDate] = useState<Date | string>(tomorrow);\n  const [isExpirationDateValid, setIsExpirationDateValid] = useState(newTokenExpirationDate !== '');\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    // Generate new token name every time we open modal\n    if (isOpen) {\n      setDefaultTokenName(`${serviceAccountLogin}-${uuidv4()}`);\n    }\n  }, [serviceAccountLogin, isOpen]);\n\n  const onExpirationDateChange = (value: Date | string) => {\n    const isValid = value !== '';\n    setIsExpirationDateValid(isValid);\n    setNewTokenExpirationDate(value);\n  };\n\n  const onGenerateToken = () => {\n    onCreateToken({\n      name: newTokenName || defaultTokenName,\n      secondsToLive: isWithExpirationDate ? getSecondsToLive(newTokenExpirationDate) : undefined,\n    });\n  };\n\n  const onCloseInternal = () => {\n    setNewTokenName('');\n    setDefaultTokenName('');\n    setIsWithExpirationDate(defaultExpirationDate);\n    setNewTokenExpirationDate(tomorrow);\n    setIsExpirationDateValid(newTokenExpirationDate !== '');\n    onClose();\n  };\n\n  const modalTitle = !token ? 'Add service account token' : 'Service account token created';\n\n  return (\n    <Modal isOpen={isOpen} title={modalTitle} onDismiss={onCloseInternal} className={styles.modal}>\n      {!token ? (\n        <div>\n          <Field\n            label={t('serviceaccounts.create-token-modal.label-display-name', 'Display name')}\n            description={t(\n              'serviceaccounts.create-token-modal.description-name-to-easily-identify-the-token',\n              'Name to easily identify the token'\n            )}\n            // for now this is required\n            // need to make this optional in backend as well\n            required={true}\n          >\n            <Input\n              name=\"tokenName\"\n              value={newTokenName}\n              placeholder={defaultTokenName}\n              onChange={(e) => {\n                setNewTokenName(e.currentTarget.value);\n              }}\n            />\n          </Field>\n          <Field label={t('serviceaccounts.create-token-modal.label-expiration', 'Expiration')}>\n            <RadioButtonGroup\n              options={EXPIRATION_OPTIONS}\n              value={isWithExpirationDate}\n              onChange={setIsWithExpirationDate}\n              size=\"md\"\n            />\n          </Field>\n          {isWithExpirationDate && (\n            <Field label={t('serviceaccounts.create-token-modal.label-expiration-date', 'Expiration date')}>\n              <DatePickerWithInput\n                onChange={onExpirationDateChange}\n                value={newTokenExpirationDate}\n                placeholder=\"\"\n                minDate={tomorrow}\n                maxDate={maxExpirationDate}\n              />\n            </Field>\n          )}\n          <Modal.ButtonRow>\n            <Button onClick={onGenerateToken} disabled={isWithExpirationDate && !isExpirationDateValid}>\n              <Trans i18nKey=\"serviceaccounts.create-token-modal.generate-token\">Generate token</Trans>\n            </Button>\n          </Modal.ButtonRow>\n        </div>\n      ) : (\n        <>\n          <Field\n            label={t('serviceaccounts.create-token-modal.label-token', 'Token')}\n            description={t(\n              'serviceaccounts.create-token-modal.description-token',\n              'Copy the token now as you will not be able to see it again. Losing a token requires creating a new one.'\n            )}\n          >\n            <div className={styles.modalTokenRow}>\n              <Input name=\"tokenValue\" value={token} readOnly />\n              <ClipboardButton\n                className={styles.modalCopyToClipboardButton}\n                variant=\"primary\"\n                size=\"md\"\n                icon=\"copy\"\n                getText={() => token}\n              >\n                <Trans i18nKey=\"serviceaccounts.create-token-modal.copy-clipboard\">Copy to clipboard</Trans>\n              </ClipboardButton>\n            </div>\n          </Field>\n          <Modal.ButtonRow>\n            <ClipboardButton variant=\"primary\" getText={() => token} onClipboardCopy={onCloseInternal}>\n              <Trans i18nKey=\"serviceaccounts.create-token-modal.copy-to-clipboard-and-close\">\n                Copy to clipboard and close\n              </Trans>\n            </ClipboardButton>\n            <Button variant=\"secondary\" onClick={onCloseInternal}>\n              <Trans i18nKey=\"serviceaccounts.create-token-modal.close\">Close</Trans>\n            </Button>\n          </Modal.ButtonRow>\n        </>\n      )}\n    </Modal>\n  );\n};\n\nconst getSecondsToLive = (date: Date | string) => {\n  const dateAsDate = new Date(date);\n  const now = new Date();\n\n  return Math.ceil((dateAsDate.getTime() - now.getTime()) / 1000);\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    modal: css({\n      width: '550px',\n    }),\n    modalTokenRow: css({\n      display: 'flex',\n    }),\n    modalCopyToClipboardButton: css({\n      marginLeft: theme.spacing(0.5),\n    }),\n  };\n};\n","import { useMemo } from 'react';\nimport Skeleton from 'react-loading-skeleton';\n\nimport { OrgRole } from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport {\n  Avatar,\n  CellProps,\n  Column,\n  InteractiveTable,\n  Pagination,\n  Stack,\n  TextLink,\n  Button,\n  IconButton,\n  Icon,\n} from '@grafana/ui';\nimport { UserRolePicker } from 'app/core/components/RolePicker/UserRolePicker';\nimport { contextSrv } from 'app/core/core';\nimport { Role, AccessControlAction } from 'app/types/accessControl';\nimport { ServiceAccountDTO } from 'app/types/serviceaccount';\n\nimport { OrgRolePicker } from '../admin/OrgRolePicker';\n\ntype Cell<T extends keyof ServiceAccountDTO = keyof ServiceAccountDTO> = CellProps<\n  ServiceAccountDTO,\n  ServiceAccountDTO[T]\n>;\n\ninterface ServiceAccountTableProps {\n  services: ServiceAccountDTO[];\n  onRoleChange: (role: OrgRole, serviceAccount: ServiceAccountDTO) => void;\n  roleOptions: Role[];\n  onRemoveButtonClick: (serviceAccount: ServiceAccountDTO) => void;\n  onDisable: (serviceAccount: ServiceAccountDTO) => void;\n  onEnable: (serviceAccount: ServiceAccountDTO) => void;\n  onAddTokenClick: (serviceAccount: ServiceAccountDTO) => void;\n  showPaging?: boolean;\n  totalPages: number;\n  onChangePage: (page: number) => void;\n  currentPage: number;\n  isLoading: boolean;\n}\n\nexport const ServiceAccountTable = ({\n  services,\n  onRoleChange,\n  roleOptions,\n  onRemoveButtonClick,\n  onDisable,\n  onEnable,\n  onAddTokenClick,\n  showPaging,\n  totalPages,\n  onChangePage,\n  currentPage,\n  isLoading,\n}: ServiceAccountTableProps) => {\n  const columns: Array<Column<ServiceAccountDTO>> = useMemo(\n    () => [\n      {\n        id: 'avatarUrl',\n        header: '',\n        cell: ({ cell: { value }, row: { original } }: Cell<'role'>) => {\n          return getCellContent(value, original, isLoading, 'avatarUrl');\n        },\n      },\n      {\n        id: 'name',\n        header: 'Account',\n        cell: ({ cell: { value }, row: { original } }: Cell<'role'>) => {\n          return getCellContent(value, original, isLoading);\n        },\n        sortType: 'string',\n      },\n      {\n        id: 'id',\n        header: 'ID',\n        cell: ({ cell: { value }, row: { original } }: Cell<'role'>) => {\n          return getCellContent(value, original, isLoading, 'id');\n        },\n      },\n      {\n        id: 'role',\n        header: 'Roles',\n        cell: ({ cell: { value }, row: { original } }: Cell<'role'>) => {\n          return getRoleCell(value, original, isLoading, roleOptions, onRoleChange);\n        },\n      },\n      {\n        id: 'tokens',\n        header: 'Tokens',\n        cell: ({ cell: { value }, row: { original } }: Cell<'role'>) => {\n          return getCellContent(value, original, isLoading, 'tokens');\n        },\n      },\n      {\n        id: 'actions',\n        header: '',\n        cell: ({ row: { original } }: Cell) => {\n          return getActionsCell(original, isLoading, onAddTokenClick, onEnable, onDisable, onRemoveButtonClick);\n        },\n      },\n    ],\n    [isLoading, onAddTokenClick, onDisable, onEnable, onRemoveButtonClick, onRoleChange, roleOptions]\n  );\n  return (\n    <Stack direction={'column'} gap={2}>\n      <InteractiveTable columns={columns} data={services} getRowId={(service) => String(service.id)} />\n      {showPaging && totalPages > 1 && (\n        <Stack justifyContent={'flex-end'}>\n          <Pagination numberOfPages={totalPages} currentPage={currentPage} onNavigate={onChangePage} />\n        </Stack>\n      )}\n    </Stack>\n  );\n};\n\nconst getCellContent = (\n  value: string,\n  original: ServiceAccountDTO,\n  isLoading: boolean,\n  columnName?: Column<ServiceAccountDTO>['id']\n) => {\n  if (isLoading) {\n    return columnName === 'avatarUrl' ? <Skeleton circle width={24} height={24} /> : <Skeleton width={100} />;\n  }\n  const href = `/org/serviceaccounts/${original.uid}`;\n  const ariaLabel = `Edit service account's ${original.name} details`;\n  switch (columnName) {\n    case 'avatarUrl':\n      return (\n        <a aria-label={ariaLabel} href={href}>\n          <Avatar src={value} alt={'User avatar'} />\n        </a>\n      );\n    case 'id':\n      return (\n        <TextLink href={href} aria-label={ariaLabel} color=\"secondary\" inline={false}>\n          {original.login}\n        </TextLink>\n      );\n    case 'tokens':\n      return (\n        <Stack alignItems=\"center\">\n          <Icon name=\"key-skeleton-alt\" />\n          <TextLink href={href} aria-label={ariaLabel} color=\"primary\" inline={false}>\n            {value || 'No tokens'}\n          </TextLink>\n        </Stack>\n      );\n    default:\n      return (\n        <TextLink href={href} aria-label={ariaLabel} color=\"primary\" inline={false}>\n          {value}\n        </TextLink>\n      );\n  }\n};\n\nconst getRoleCell = (\n  value: OrgRole,\n  original: ServiceAccountDTO,\n  isLoading: boolean,\n  roleOptions: Role[],\n  onRoleChange: (role: OrgRole, serviceAccount: ServiceAccountDTO) => void\n) => {\n  const displayRolePicker =\n    contextSrv.hasPermission(AccessControlAction.ActionRolesList) &&\n    contextSrv.hasPermission(AccessControlAction.ActionUserRolesList);\n  const canUpdateRole = contextSrv.hasPermissionInMetadata(AccessControlAction.ServiceAccountsWrite, original);\n\n  if (isLoading) {\n    return <Skeleton width={100} />;\n  } else {\n    return contextSrv.licensedAccessControlEnabled() ? (\n      displayRolePicker && (\n        <UserRolePicker\n          userId={original.id}\n          orgId={original.orgId}\n          basicRole={value}\n          roles={original.roles || []}\n          onBasicRoleChange={(newRole) => onRoleChange(newRole, original)}\n          roleOptions={roleOptions}\n          basicRoleDisabled={!canUpdateRole}\n          disabled={original.isExternal || original.isDisabled}\n          width={40}\n        />\n      )\n    ) : (\n      <OrgRolePicker\n        aria-label={t('serviceaccounts.get-role-cell.aria-label-role', 'Role')}\n        value={value}\n        disabled={original.isExternal || !canUpdateRole || original.isDisabled}\n        onChange={(newRole) => onRoleChange(newRole, original)}\n      />\n    );\n  }\n};\n\nconst getActionsCell = (\n  original: ServiceAccountDTO,\n  isLoading: boolean,\n  onAddTokenClick: (serviceAccount: ServiceAccountDTO) => void,\n  onEnable: (serviceAccount: ServiceAccountDTO) => void,\n  onDisable: (serviceAccount: ServiceAccountDTO) => void,\n  onRemoveButtonClick: (serviceAccount: ServiceAccountDTO) => void\n) => {\n  if (isLoading) {\n    return <Skeleton width={100} />;\n  } else {\n    return !original.isExternal ? (\n      <Stack alignItems=\"center\" justifyContent=\"flex-end\">\n        {contextSrv.hasPermission(AccessControlAction.ServiceAccountsWrite) && !original.tokens && (\n          <Button onClick={() => onAddTokenClick(original)} disabled={original.isDisabled}>\n            <Trans i18nKey=\"serviceaccounts.get-actions-cell.add-token\">Add token</Trans>\n          </Button>\n        )}\n        {contextSrv.hasPermissionInMetadata(AccessControlAction.ServiceAccountsWrite, original) &&\n          (original.isDisabled ? (\n            <Button variant=\"secondary\" size=\"md\" onClick={() => onEnable(original)}>\n              <Trans i18nKey=\"serviceaccounts.get-actions-cell.enable\">Enable</Trans>\n            </Button>\n          ) : (\n            <Button variant=\"secondary\" size=\"md\" onClick={() => onDisable(original)}>\n              <Trans i18nKey=\"serviceaccounts.get-actions-cell.disable\">Disable</Trans>\n            </Button>\n          ))}\n\n        {contextSrv.hasPermissionInMetadata(AccessControlAction.ServiceAccountsDelete, original) && (\n          <IconButton\n            name=\"trash-alt\"\n            aria-label={t(\n              'serviceaccounts.get-actions-cell.aria-label-delete-button',\n              'Delete service account {{serviceAccountName}}',\n              { serviceAccountName: original.name }\n            )}\n            variant=\"secondary\"\n            onClick={() => onRemoveButtonClick(original)}\n          />\n        )}\n      </Stack>\n    ) : (\n      <Stack alignItems=\"center\" justifyContent=\"flex-end\">\n        <IconButton\n          disabled={true}\n          name=\"lock\"\n          size=\"md\"\n          tooltip={t(\n            'serviceaccounts.get-actions-cell.tooltip-managed-service-account-cannot-modified',\n            'This is a managed service account and cannot be modified'\n          )}\n        />\n      </Stack>\n    );\n  }\n};\n\nServiceAccountTable.displayName = 'ServiceAccountTable';\n","import { css } from '@emotion/css';\nimport { useEffect, useState } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\n\nimport { GrafanaTheme2, OrgRole } from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport {\n  ConfirmModal,\n  FilterInput,\n  LinkButton,\n  RadioButtonGroup,\n  InlineField,\n  EmptyState,\n  Box,\n  Stack,\n  useStyles2,\n  TextLink,\n} from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\nimport config from 'app/core/config';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction } from 'app/types/accessControl';\nimport { ServiceAccountStateFilter, ServiceAccountDTO } from 'app/types/serviceaccount';\nimport { StoreState } from 'app/types/store';\n\nimport { ServiceAccountTable } from './ServiceAccountTable';\nimport { CreateTokenModal, ServiceAccountToken } from './components/CreateTokenModal';\nimport {\n  changeQuery,\n  changePage,\n  fetchACOptions,\n  fetchServiceAccounts,\n  deleteServiceAccount,\n  updateServiceAccount,\n  changeStateFilter,\n  createServiceAccountToken,\n} from './state/actions';\n\ninterface OwnProps {}\n\nexport type Props = OwnProps & ConnectedProps<typeof connector>;\n\nfunction mapStateToProps(state: StoreState) {\n  return {\n    ...state.serviceAccounts,\n  };\n}\n\nconst mapDispatchToProps = {\n  changePage,\n  changeQuery,\n  fetchACOptions,\n  fetchServiceAccounts,\n  deleteServiceAccount,\n  updateServiceAccount,\n  changeStateFilter,\n  createServiceAccountToken,\n};\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\n\nconst availableFilters = [\n  { label: 'All', value: ServiceAccountStateFilter.All },\n  { label: 'With expired tokens', value: ServiceAccountStateFilter.WithExpiredTokens },\n  { label: 'Disabled', value: ServiceAccountStateFilter.Disabled },\n];\n\nif (config.featureToggles.externalServiceAccounts) {\n  availableFilters.push({ label: 'Managed', value: ServiceAccountStateFilter.External });\n}\n\nexport const ServiceAccountsListPageUnconnected = ({\n  page,\n  changePage,\n  totalPages,\n  serviceAccounts,\n  isLoading,\n  roleOptions,\n  query,\n  serviceAccountStateFilter,\n  changeQuery,\n  fetchACOptions,\n  fetchServiceAccounts,\n  deleteServiceAccount,\n  updateServiceAccount,\n  changeStateFilter,\n  createServiceAccountToken,\n}: Props): JSX.Element => {\n  const [isAddModalOpen, setIsAddModalOpen] = useState(false);\n  const [isRemoveModalOpen, setIsRemoveModalOpen] = useState(false);\n  const [isDisableModalOpen, setIsDisableModalOpen] = useState(false);\n  const [newToken, setNewToken] = useState('');\n  const [currentServiceAccount, setCurrentServiceAccount] = useState<ServiceAccountDTO | null>(null);\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    fetchServiceAccounts({ withLoadingIndicator: true });\n    if (contextSrv.licensedAccessControlEnabled()) {\n      fetchACOptions();\n    }\n  }, [fetchACOptions, fetchServiceAccounts]);\n\n  const noServiceAccountsCreated =\n    serviceAccounts.length === 0 && serviceAccountStateFilter === ServiceAccountStateFilter.All && !query;\n\n  const onRoleChange = async (role: OrgRole, serviceAccount: ServiceAccountDTO) => {\n    const updatedServiceAccount = { ...serviceAccount, role: role };\n    updateServiceAccount(updatedServiceAccount);\n    if (contextSrv.licensedAccessControlEnabled()) {\n      fetchACOptions();\n    }\n  };\n\n  const onQueryChange = (value: string) => {\n    changeQuery(value);\n  };\n\n  const onStateFilterChange = (value: ServiceAccountStateFilter) => {\n    changeStateFilter(value);\n  };\n\n  const onRemoveButtonClick = (serviceAccount: ServiceAccountDTO) => {\n    setCurrentServiceAccount(serviceAccount);\n    setIsRemoveModalOpen(true);\n  };\n\n  const onServiceAccountRemove = async () => {\n    if (currentServiceAccount) {\n      deleteServiceAccount(currentServiceAccount.uid);\n    }\n    onRemoveModalClose();\n  };\n\n  const onDisableButtonClick = (serviceAccount: ServiceAccountDTO) => {\n    setCurrentServiceAccount(serviceAccount);\n    setIsDisableModalOpen(true);\n  };\n\n  const onDisable = () => {\n    if (currentServiceAccount) {\n      updateServiceAccount({ ...currentServiceAccount, isDisabled: true });\n    }\n    onDisableModalClose();\n  };\n\n  const onEnable = (serviceAccount: ServiceAccountDTO) => {\n    updateServiceAccount({ ...serviceAccount, isDisabled: false });\n  };\n\n  const onTokenAdd = (serviceAccount: ServiceAccountDTO) => {\n    setCurrentServiceAccount(serviceAccount);\n    setIsAddModalOpen(true);\n  };\n\n  const onTokenCreate = async (token: ServiceAccountToken) => {\n    if (currentServiceAccount) {\n      createServiceAccountToken(currentServiceAccount.uid, token, setNewToken);\n    }\n  };\n\n  const onAddModalClose = () => {\n    setIsAddModalOpen(false);\n    setCurrentServiceAccount(null);\n    setNewToken('');\n  };\n\n  const onRemoveModalClose = () => {\n    setIsRemoveModalOpen(false);\n    setCurrentServiceAccount(null);\n  };\n\n  const onDisableModalClose = () => {\n    setIsDisableModalOpen(false);\n    setCurrentServiceAccount(null);\n  };\n\n  const subTitle = (\n    <span>\n      <Trans i18nKey=\"serviceaccounts.service-accounts-list-page-unconnected.sub-title\">\n        Service accounts and their tokens can be used to authenticate against the Grafana API. Find out more in our{' '}\n        <TextLink href=\"https://grafana.com/docs/grafana/latest/administration/service-accounts/\" external>\n          documentation.\n        </TextLink>\n      </Trans>\n    </span>\n  );\n\n  return (\n    <Page\n      navId=\"serviceaccounts\"\n      subTitle={subTitle}\n      actions={\n        <>\n          {!noServiceAccountsCreated && contextSrv.hasPermission(AccessControlAction.ServiceAccountsCreate) && (\n            <LinkButton href=\"org/serviceaccounts/create\" variant=\"primary\">\n              <Trans i18nKey=\"serviceaccounts.service-accounts-list-page-unconnected.add-service-account\">\n                Add service account\n              </Trans>\n            </LinkButton>\n          )}\n        </>\n      }\n    >\n      <Page.Contents>\n        <Stack justifyContent=\"space-between\" wrap=\"wrap\">\n          <InlineField grow>\n            <FilterInput\n              className={styles.filterInput}\n              placeholder={t(\n                'serviceaccounts.service-accounts-list-page-unconnected.placeholder-search-service-account-by-name',\n                'Search service account by name'\n              )}\n              value={query}\n              onChange={onQueryChange}\n            />\n          </InlineField>\n          <Box marginBottom={1}>\n            <RadioButtonGroup\n              options={availableFilters}\n              onChange={onStateFilterChange}\n              value={serviceAccountStateFilter}\n            />\n          </Box>\n        </Stack>\n        {!isLoading && !noServiceAccountsCreated && serviceAccounts.length === 0 && (\n          <EmptyState\n            variant=\"not-found\"\n            message={t('service-accounts.empty-state.message', 'No service accounts found')}\n          />\n        )}\n        {!isLoading && noServiceAccountsCreated && (\n          <EmptyState\n            variant=\"call-to-action\"\n            button={\n              <LinkButton\n                disabled={!contextSrv.hasPermission(AccessControlAction.ServiceAccountsCreate)}\n                href=\"org/serviceaccounts/create\"\n                icon=\"key-skeleton-alt\"\n                size=\"lg\"\n              >\n                <Trans i18nKey=\"service-accounts.empty-state.button-title\">Add service account</Trans>\n              </LinkButton>\n            }\n            message={t('service-accounts.empty-state.title', \"You haven't created any service accounts yet\")}\n          >\n            <Trans i18nKey=\"service-accounts.empty-state.more-info\">\n              Remember, you can provide specific permissions for API access to other applications\n            </Trans>\n          </EmptyState>\n        )}\n\n        {(isLoading || serviceAccounts.length !== 0) && (\n          <ServiceAccountTable\n            services={serviceAccounts}\n            showPaging={true}\n            totalPages={totalPages}\n            onChangePage={changePage}\n            currentPage={page}\n            onRoleChange={onRoleChange}\n            roleOptions={roleOptions}\n            onRemoveButtonClick={onRemoveButtonClick}\n            onDisable={onDisableButtonClick}\n            onEnable={onEnable}\n            onAddTokenClick={onTokenAdd}\n            isLoading={isLoading}\n          />\n        )}\n        {currentServiceAccount && (\n          <>\n            <ConfirmModal\n              isOpen={isRemoveModalOpen}\n              body={\n                !!currentServiceAccount.tokens\n                  ? t(\n                      'serviceaccounts.service-accounts-list-page-unconnected.body-delete',\n                      'Are you sure you want to delete {{serviceAccountName}} and {{count}} accompanying tokens?',\n                      {\n                        serviceAccountName: currentServiceAccount.name,\n                        count: currentServiceAccount.tokens,\n                      }\n                    )\n                  : t(\n                      'serviceaccounts.service-accounts-list-page-unconnected.body-delete-with-tokens',\n                      'Are you sure you want to delete {{serviceAccountName}}?',\n                      {\n                        serviceAccountName: currentServiceAccount.name,\n                      }\n                    )\n              }\n              confirmText={t('serviceaccounts.service-accounts-list-page-unconnected.confirmText-delete', 'Delete')}\n              title={t(\n                'serviceaccounts.service-accounts-list-page-unconnected.title-delete-service-account',\n                'Delete service account'\n              )}\n              onConfirm={onServiceAccountRemove}\n              onDismiss={onRemoveModalClose}\n            />\n            <ConfirmModal\n              isOpen={isDisableModalOpen}\n              title={t(\n                'serviceaccounts.service-accounts-list-page-unconnected.title-disable-service-account',\n                'Disable service account'\n              )}\n              body={t(\n                'serviceaccounts.service-accounts-list-page-unconnected.body-disable-service-account',\n                \"Are you sure you want to disable '{{accountToDisable}}'?\",\n                { accountToDisable: currentServiceAccount.name }\n              )}\n              confirmText={t(\n                'serviceaccounts.service-accounts-list-page-unconnected.confirmText-disable-service-account',\n                'Disable service account'\n              )}\n              onConfirm={onDisable}\n              onDismiss={onDisableModalClose}\n            />\n            <CreateTokenModal\n              isOpen={isAddModalOpen}\n              token={newToken}\n              serviceAccountLogin={currentServiceAccount.login}\n              onCreateToken={onTokenCreate}\n              onClose={onAddModalClose}\n            />\n          </>\n        )}\n      </Page.Contents>\n    </Page>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  filterInput: css({\n    maxWidth: theme.spacing(50),\n  }),\n});\n\nconst ServiceAccountsListPage = connector(ServiceAccountsListPageUnconnected);\nexport default ServiceAccountsListPage;\n","import { debounce } from 'lodash';\n\nimport { getBackendSrv } from '@grafana/runtime';\nimport { fetchRoleOptions } from 'app/core/components/RolePicker/api';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { AccessControlAction } from 'app/types/accessControl';\nimport { ServiceAccountDTO, ServiceAccountStateFilter } from 'app/types/serviceaccount';\nimport { ThunkResult } from 'app/types/store';\n\nimport { ServiceAccountToken } from '../components/CreateTokenModal';\n\nimport {\n  acOptionsLoaded,\n  pageChanged,\n  queryChanged,\n  rolesFetchBegin,\n  rolesFetchEnd,\n  serviceAccountsFetchBegin,\n  serviceAccountsFetched,\n  serviceAccountsFetchEnd,\n  stateFilterChanged,\n} from './reducers';\n\nconst BASE_URL = `/api/serviceaccounts`;\n\nexport function fetchACOptions(): ThunkResult<void> {\n  return async (dispatch) => {\n    try {\n      if (contextSrv.licensedAccessControlEnabled() && contextSrv.hasPermission(AccessControlAction.ActionRolesList)) {\n        const options = await fetchRoleOptions();\n        dispatch(acOptionsLoaded(options));\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n}\n\ninterface FetchServiceAccountsParams {\n  withLoadingIndicator: boolean;\n}\n\nexport function fetchServiceAccounts(\n  { withLoadingIndicator }: FetchServiceAccountsParams = { withLoadingIndicator: false }\n): ThunkResult<void> {\n  return async (dispatch, getState) => {\n    try {\n      if (contextSrv.hasPermission(AccessControlAction.ServiceAccountsRead)) {\n        if (withLoadingIndicator) {\n          dispatch(serviceAccountsFetchBegin());\n        }\n        const { perPage, page, query, serviceAccountStateFilter } = getState().serviceAccounts;\n        const result = await getBackendSrv().get(\n          `/api/serviceaccounts/search?perpage=${perPage}&page=${page}&query=${query}${getStateFilter(\n            serviceAccountStateFilter\n          )}&accesscontrol=true`\n        );\n\n        if (\n          contextSrv.licensedAccessControlEnabled() &&\n          contextSrv.hasPermission(AccessControlAction.ActionUserRolesList)\n        ) {\n          dispatch(rolesFetchBegin());\n          const orgId = contextSrv.user.orgId;\n          const userIds = result?.serviceAccounts.map((u: ServiceAccountDTO) => u.id);\n          const roles = await getBackendSrv().post(`/api/access-control/users/roles/search`, { userIds, orgId });\n          result.serviceAccounts.forEach((u: ServiceAccountDTO) => {\n            u.roles = roles ? roles[u.id] || [] : [];\n          });\n          dispatch(rolesFetchEnd());\n        }\n\n        dispatch(serviceAccountsFetched(result));\n      }\n    } catch (error) {\n      console.error(error);\n    } finally {\n      dispatch(serviceAccountsFetchEnd());\n    }\n  };\n}\n\nconst fetchServiceAccountsWithDebounce = debounce((dispatch) => dispatch(fetchServiceAccounts()), 500, {\n  leading: true,\n});\n\nexport function updateServiceAccount(serviceAccount: ServiceAccountDTO): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().patch(`${BASE_URL}/${serviceAccount.uid}?accesscontrol=true`, {\n      ...serviceAccount,\n    });\n    dispatch(fetchServiceAccounts());\n  };\n}\n\nexport function deleteServiceAccount(serviceAccountUid: string): ThunkResult<void> {\n  return async (dispatch) => {\n    await getBackendSrv().delete(`${BASE_URL}/${serviceAccountUid}`);\n    dispatch(fetchServiceAccounts());\n  };\n}\n\nexport function createServiceAccountToken(\n  saUid: string,\n  token: ServiceAccountToken,\n  onTokenCreated: (key: string) => void\n): ThunkResult<void> {\n  return async (dispatch) => {\n    const result = await getBackendSrv().post(`${BASE_URL}/${saUid}/tokens`, token);\n    onTokenCreated(result.key);\n    dispatch(fetchServiceAccounts());\n  };\n}\n\n// search / filtering of serviceAccounts\nconst getStateFilter = (value: ServiceAccountStateFilter) => {\n  switch (value) {\n    case ServiceAccountStateFilter.WithExpiredTokens:\n      return '&expiredTokens=true';\n    case ServiceAccountStateFilter.Disabled:\n      return '&disabled=true';\n    case ServiceAccountStateFilter.External:\n      return '&external=true';\n    default:\n      return '';\n  }\n};\n\nexport function changeQuery(query: string): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(queryChanged(query));\n    fetchServiceAccountsWithDebounce(dispatch);\n  };\n}\n\nexport function changeStateFilter(filter: ServiceAccountStateFilter): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(stateFilterChanged(filter));\n    dispatch(fetchServiceAccounts());\n  };\n}\n\nexport function changePage(page: number): ThunkResult<void> {\n  return async (dispatch) => {\n    dispatch(pageChanged(page));\n    dispatch(fetchServiceAccounts());\n  };\n}\n","import { useEffect } from 'react';\nimport { useAsyncFn } from 'react-use';\n\nimport { OrgRole } from '@grafana/data';\nimport { contextSrv } from 'app/core/core';\nimport { Role, AccessControlAction } from 'app/types/accessControl';\n\nimport { RolePicker } from './RolePicker';\nimport { fetchUserRoles, updateUserRoles } from './api';\n\nexport interface Props {\n  basicRole: OrgRole;\n  roles?: Role[];\n  userId: number;\n  orgId?: number;\n  onBasicRoleChange: (newRole: OrgRole) => void;\n  roleOptions: Role[];\n  disabled?: boolean;\n  basicRoleDisabled?: boolean;\n  basicRoleDisabledMessage?: string;\n  /**\n   * Set whether the component should send a request with the new roles to the\n   * backend in UserRolePicker.onRolesChange (apply=false), or call {@link onApplyRoles}\n   * with the updated list of roles (apply=true).\n   *\n   * Besides it sets the RolePickerMenu's Button title to\n   *   * `Update` in case apply equals false\n   *   * `Apply` in case apply equals true\n   *\n   * @default false\n   */\n  apply?: boolean;\n  onApplyRoles?: (newRoles: Role[], userId: number, orgId: number | undefined) => void;\n  pendingRoles?: Role[];\n  maxWidth?: string | number;\n  width?: string | number;\n  isLoading?: boolean;\n}\n\nexport const UserRolePicker = ({\n  basicRole,\n  roles,\n  userId,\n  orgId,\n  onBasicRoleChange,\n  roleOptions,\n  disabled,\n  basicRoleDisabled,\n  basicRoleDisabledMessage,\n  apply = false,\n  onApplyRoles,\n  pendingRoles,\n  maxWidth,\n  width,\n  isLoading,\n}: Props) => {\n  const [{ loading, value: appliedRoles = roles || [] }, getUserRoles] = useAsyncFn(async () => {\n    try {\n      if (roles) {\n        return roles;\n      }\n      if (apply && Boolean(pendingRoles?.length)) {\n        return pendingRoles;\n      }\n\n      if (contextSrv.hasPermission(AccessControlAction.ActionUserRolesList) && userId > 0) {\n        return await fetchUserRoles(userId, orgId);\n      }\n    } catch (e) {\n      // TODO handle error\n      console.error('Error loading options');\n    }\n    return [];\n  }, [orgId, userId, pendingRoles, roles]);\n\n  useEffect(() => {\n    // only load roles when there is an Org selected\n    if (orgId) {\n      getUserRoles();\n    }\n  }, [getUserRoles, orgId]);\n\n  const onRolesChange = async (roles: Role[]) => {\n    if (!apply) {\n      await updateUserRoles(roles, userId, orgId);\n      await getUserRoles();\n    } else if (onApplyRoles) {\n      onApplyRoles(roles, userId, orgId);\n    }\n  };\n\n  const canUpdateRoles =\n    contextSrv.hasPermission(AccessControlAction.ActionUserRolesAdd) &&\n    contextSrv.hasPermission(AccessControlAction.ActionUserRolesRemove);\n\n  return (\n    <RolePicker\n      appliedRoles={appliedRoles}\n      basicRole={basicRole}\n      onRolesChange={onRolesChange}\n      onBasicRoleChange={onBasicRoleChange}\n      roleOptions={roleOptions}\n      isLoading={loading || isLoading}\n      disabled={disabled}\n      basicRoleDisabled={basicRoleDisabled}\n      basicRoleDisabledMessage={basicRoleDisabledMessage}\n      showBasicRole\n      apply={apply}\n      canUpdateRoles={canUpdateRoles}\n      maxWidth={maxWidth}\n      width={width}\n    />\n  );\n};\n"],"names":["options","r","OrgRolePicker","value","onChange","ariaLabel","inputId","autoFocus","restProps","val","EXPIRATION_OPTIONS","CreateTokenModal","isOpen","token","serviceAccountLogin","onCreateToken","onClose","tomorrow","maxExpirationDate","defaultExpirationDate","defaultTokenName","setDefaultTokenName","newTokenName","setNewTokenName","isWithExpirationDate","setIsWithExpirationDate","newTokenExpirationDate","setNewTokenExpirationDate","isExpirationDateValid","setIsExpirationDateValid","styles","getStyles","onExpirationDateChange","onGenerateToken","getSecondsToLive","onCloseInternal","modalTitle","e","date","dateAsDate","now","theme","ServiceAccountTable","services","onRoleChange","roleOptions","onRemoveButtonClick","onDisable","onEnable","onAddTokenClick","showPaging","totalPages","onChangePage","currentPage","isLoading","columns","original","getCellContent","getRoleCell","getActionsCell","Stack","InteractiveTable","service","Pagination","columnName","href","Avatar","TextLink","Icon","displayRolePicker","canUpdateRole","UserRolePicker","newRole","IconButton","Button","mapStateToProps","state","mapDispatchToProps","connector","availableFilters","config","ServiceAccountsListPageUnconnected","page","changePage","serviceAccounts","query","serviceAccountStateFilter","changeQuery","fetchACOptions","fetchServiceAccounts","deleteServiceAccount","updateServiceAccount","changeStateFilter","createServiceAccountToken","isAddModalOpen","setIsAddModalOpen","isRemoveModalOpen","setIsRemoveModalOpen","isDisableModalOpen","setIsDisableModalOpen","newToken","setNewToken","currentServiceAccount","setCurrentServiceAccount","noServiceAccountsCreated","role","serviceAccount","updatedServiceAccount","onQueryChange","onStateFilterChange","onServiceAccountRemove","onRemoveModalClose","onDisableButtonClick","onDisableModalClose","onTokenAdd","onTokenCreate","onAddModalClose","subTitle","Page","InlineField","FilterInput","Box","RadioButtonGroup","EmptyState","ConfirmModal","BASE_URL","dispatch","error","withLoadingIndicator","getState","perPage","result","getStateFilter","orgId","userIds","u","roles","fetchServiceAccountsWithDebounce","serviceAccountUid","saUid","onTokenCreated","filter","basicRole","userId","onBasicRoleChange","disabled","basicRoleDisabled","basicRoleDisabledMessage","apply","onApplyRoles","pendingRoles","maxWidth","width","loading","appliedRoles","getUserRoles","onRolesChange","canUpdateRoles"],"sourceRoot":""}