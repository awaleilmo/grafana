(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[404],{16373:(y,p,o)=>{"use strict";o.r(p),o.d(p,{plugin:()=>R});var v=o(16207),r=o(92745),l=o(74848),d=o(22803),u=o(49880),S=o.n(u),f=o(96540),M=o(40996),c=o(63704),x=o(67458),w=o(63142),b=o(50992),j=o(92807),C=o(65642),a=(t=>(t.Code="code",t.HTML="html",t.Markdown="markdown",t))(a||{}),H=(t=>(t.Go="go",t.Html="html",t.Json="json",t.Markdown="markdown",t.Plaintext="plaintext",t.Sql="sql",t.Typescript="typescript",t.Xml="xml",t.Yaml="yaml",t))(H||{});const z="plaintext",h={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},P={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"};function k(t){const s=(0,w.of)(N),[e,m]=(0,f.useState)({mode:t.options.mode,content:T(t.options,t.replaceVariables,C.Ay.disableSanitizeHtml)});if((0,M.A)(()=>{const{options:n,replaceVariables:g}=t,i=T(n,g,C.Ay.disableSanitizeHtml);(i!==e.content||n.mode!==e.mode)&&m({mode:n.mode,content:i})},100,[t]),e.mode===a.Code){const n=t.options.code??h;return(0,l.jsx)(b.B,{value:e.content,language:n.language??h.language,width:t.width,height:t.height,containerStyles:s.codeEditorContainer,showMiniMap:n.showMiniMap,showLineNumbers:n.showLineNumbers,readOnly:!0},`${n.showLineNumbers}/${n.showMiniMap}`)}return(0,l.jsx)("div",{className:s.containStrict,children:(0,l.jsx)(j.P,{minHeight:"100%",children:(0,l.jsx)(S(),{allowRerender:!0,html:e.content,className:(0,d.cx)("markdown-html",s.markdownHtml),"data-testid":"TextPanel-converted-content"})})})}function T(t,s,e){let{mode:m,content:n}=t;if(n=s(n,{},t.code?.language==="json"?"json":"html"),!n)return" ";switch(m){case a.Code:break;case a.HTML:e||(n=c.sQ.sanitizeTextPanelContent(n));break;case a.Markdown:default:n=(0,x.P)(n,{noSanitize:e})}return n}const N=t=>({codeEditorContainer:(0,d.css)({".monaco-editor .margin, .monaco-editor-background":{backgroundColor:t.colors.background.primary}}),containStrict:(0,d.css)({contain:"strict",height:"100%",display:"flex"}),markdownHtml:(0,d.css)({height:"100%"})});var B=o(70713),E=o(13477);const V=({value:t,onChange:s,context:e})=>{const m=(0,f.useMemo)(()=>e.options?.mode??a.Markdown,[e]),n=(0,w.of)(L),g=()=>e.getSuggestions?e.getSuggestions().map(i=>(0,E.O)(i)):[];return(0,l.jsx)("div",{className:(0,d.cx)(n.editorBox),children:(0,l.jsx)(B.Ay,{disableHeight:!0,children:({width:i})=>i===0?null:(0,l.jsx)(b.B,{value:t,onBlur:s,onSave:s,language:m,width:i,showMiniMap:!1,showLineNumbers:!1,height:"500px",getSuggestions:g})})})},L=t=>({editorBox:(0,d.css)({label:"editorBox",border:`1px solid ${t.colors.border.medium}`,borderRadius:t.shape.radius.default,margin:t.spacing(.5,0),width:"100%"})}),O=t=>{const s=parseFloat(t.pluginVersion||"6.1");let e=t.options;if(t.hasOwnProperty("content")&&t.hasOwnProperty("mode")){const n=t,g=n.content,i=n.mode;delete n.content,delete n.mode,s<7.1&&(e={content:g,mode:i})}return[a.Code,a.HTML,a.Markdown].find(n=>n===e.mode)||(e={...e,mode:a.Markdown}),e},R=new v.m(k).setPanelOptions(t=>{const s=[(0,r.t)("text.category-text","Text")];t.addRadio({path:"mode",name:(0,r.t)("text.name-mode","Mode"),category:s,settings:{options:[{value:a.Markdown,label:(0,r.t)("text.mode-options.label-markdown","Markdown")},{value:a.HTML,label:(0,r.t)("text.mode-options.label-html","HTML")},{value:a.Code,label:(0,r.t)("text.mode-options.label-code","Code")}]},defaultValue:P.mode}).addSelect({path:"code.language",name:(0,r.t)("text.name-language","Language"),category:s,settings:{options:Object.values(H).map(e=>({value:e,label:e}))},defaultValue:h.language,showIf:e=>e.mode===a.Code}).addBooleanSwitch({path:"code.showLineNumbers",name:(0,r.t)("text.name-show-line-numbers","Show line numbers"),category:s,defaultValue:h.showLineNumbers,showIf:e=>e.mode===a.Code}).addBooleanSwitch({path:"code.showMiniMap",name:(0,r.t)("text.name-show-mini-map","Show mini map"),category:s,defaultValue:h.showMiniMap,showIf:e=>e.mode===a.Code}).addCustomEditor({id:"content",path:"content",name:(0,r.t)("text.name-content","Content"),category:s,editor:V,defaultValue:P.content})}).setMigrationHandler(O)},49880:(y,p,o)=>{"use client";const{createElement:v,useEffect:r,useRef:l}=o(96540);function d({html:u,dangerouslySetInnerHTML:S,allowRerender:f,...M}){const c=l(null),x=l(!0);return r(()=>{if(!u||!c.current)throw new Error("html prop can't be null");if(!x.current)return;x.current=!!f;const w=document.createRange().createContextualFragment(u);c.current.innerHTML="",c.current.appendChild(w)},[u,c]),v("div",{...M,ref:c})}y.exports=d}}]);

//# sourceMappingURL=textPanel.f15d5c05ee8dda031b4a.js.map