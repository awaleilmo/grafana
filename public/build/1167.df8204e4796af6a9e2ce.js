"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1167],{6279:(k,c,r)=>{r.d(c,{L:()=>o,Y:()=>l});var e=r(92745);const a=()=>({github:{token:{label:(0,e.t)("provisioning.github.token-label","Personal Access Token"),description:(0,e.t)("provisioning.github.token-description","GitHub Personal Access Token with repository permissions"),placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx",required:!0,validation:{required:(0,e.t)("provisioning.github.token-required","GitHub token is required")}},url:{label:(0,e.t)("provisioning.github.url-label","Repository URL"),description:(0,e.t)("provisioning.github.url-description","The GitHub repository URL"),placeholder:"https://github.com/owner/repository",required:!0,validation:{required:(0,e.t)("provisioning.github.url-required","Repository URL is required"),pattern:{value:/^https:\/\/github\.com\/[^\/]+\/[^\/]+\/?$/,message:(0,e.t)("provisioning.github.url-pattern","Must be a valid GitHub repository URL")}}},branch:{label:(0,e.t)("provisioning.github.branch-label","Branch"),description:(0,e.t)("provisioning.github.branch-description","The branch to use for provisioning"),placeholder:"main",required:!0,validation:{required:(0,e.t)("provisioning.github.branch-required","Branch is required")}},path:{label:(0,e.t)("provisioning.github.path-label","Path"),description:(0,e.t)("provisioning.github.path-description","Optional subdirectory path within the repository"),placeholder:"grafana/",required:!1},prWorkflow:{label:(0,e.t)("provisioning.github.pr-workflow-label","Enable pull request option when saving"),description:(0,e.t)("provisioning.github.pr-workflow-description","Allows users to choose whether to open a pull request when saving changes. If the repository does not allow direct changes to the main branch, a pull request may still be required.")}},gitlab:{token:{label:(0,e.t)("provisioning.gitlab.token-label","Project Access Token"),description:(0,e.t)("provisioning.gitlab.token-description","GitLab Project Access Token with repository permissions"),placeholder:"glpat-xxxxxxxxxxxxxxxxxxxx",required:!0,validation:{required:(0,e.t)("provisioning.gitlab.token-required","GitLab token is required")}},url:{label:(0,e.t)("provisioning.gitlab.url-label","Repository URL"),description:(0,e.t)("provisioning.gitlab.url-description","The GitLab repository URL"),placeholder:"https://gitlab.com/owner/repository",required:!0,validation:{required:(0,e.t)("provisioning.gitlab.url-required","Repository URL is required"),pattern:{value:/^https:\/\/gitlab\.com\/[^\/]+\/[^\/]+\/?$/,message:(0,e.t)("provisioning.gitlab.url-pattern","Must be a valid GitLab repository URL")}}},branch:{label:(0,e.t)("provisioning.gitlab.branch-label","Branch"),description:(0,e.t)("provisioning.gitlab.branch-description","The branch to use for provisioning"),placeholder:"main",required:!0,validation:{required:(0,e.t)("provisioning.gitlab.branch-required","Branch is required")}},path:{label:(0,e.t)("provisioning.gitlab.path-label","Path"),description:(0,e.t)("provisioning.gitlab.path-description","Optional subdirectory path within the repository"),placeholder:"grafana/",required:!1},prWorkflow:{label:(0,e.t)("provisioning.gitlab.pr-workflow-label","Enable merge request option when saving"),description:(0,e.t)("provisioning.gitlab.pr-workflow-description","Allows users to choose whether to open a merge request when saving changes. If the repository does not allow direct changes to the main branch, a merge request may still be required.")}},bitbucket:{token:{label:(0,e.t)("provisioning.bitbucket.token-label","App Password"),description:(0,e.t)("provisioning.bitbucket.token-description","Bitbucket App Password with repository permissions"),placeholder:"ATBBxxxxxxxxxxxxxxxx",required:!0,validation:{required:(0,e.t)("provisioning.bitbucket.token-required","Bitbucket token is required")}},tokenUser:{label:(0,e.t)("provisioning.bitbucket.token-user-label","Username"),description:(0,e.t)("provisioning.bitbucket.token-user-description","The username that will be used to access the repository with the app password"),placeholder:"username",required:!0,validation:{required:(0,e.t)("provisioning.bitbucket.token-user-required","Username is required")}},url:{label:(0,e.t)("provisioning.bitbucket.url-label","Repository URL"),description:(0,e.t)("provisioning.bitbucket.url-description","The Bitbucket repository URL"),placeholder:"https://bitbucket.org/owner/repository",required:!0,validation:{required:(0,e.t)("provisioning.bitbucket.url-required","Repository URL is required"),pattern:{value:/^https:\/\/bitbucket\.org\/[^\/]+\/[^\/]+\/?$/,message:(0,e.t)("provisioning.bitbucket.url-pattern","Must be a valid Bitbucket repository URL")}}},branch:{label:(0,e.t)("provisioning.bitbucket.branch-label","Branch"),description:(0,e.t)("provisioning.bitbucket.branch-description","The branch to use for provisioning"),placeholder:"main",required:!0,validation:{required:(0,e.t)("provisioning.bitbucket.branch-required","Branch is required")}},path:{label:(0,e.t)("provisioning.bitbucket.path-label","Path"),description:(0,e.t)("provisioning.bitbucket.path-description","Optional subdirectory path within the repository"),placeholder:"grafana/",required:!1},prWorkflow:{label:(0,e.t)("provisioning.bitbucket.pr-workflow-label","Enable pull request option when saving"),description:(0,e.t)("provisioning.bitbucket.pr-workflow-description","Allows users to choose whether to open a pull request when saving changes. If the repository does not allow direct changes to the main branch, a pull request may still be required.")}},git:{token:{label:(0,e.t)("provisioning.git.token-label","Access Token"),description:(0,e.t)("provisioning.git.token-description","Git repository access token or password"),placeholder:"token or password",required:!0,validation:{required:(0,e.t)("provisioning.git.token-required","Git token is required")}},tokenUser:{label:(0,e.t)("provisioning.git.token-user-label","Username"),description:(0,e.t)("provisioning.git.token-user-description","The username that will be used to access the repository with the access token"),placeholder:"username",required:!0,validation:{required:(0,e.t)("provisioning.git.token-user-required","Username is required")}},url:{label:(0,e.t)("provisioning.git.url-label","Repository URL"),description:(0,e.t)("provisioning.git.url-description","The Git repository URL"),placeholder:"https://git.example.com/owner/repository.git",required:!0,validation:{required:(0,e.t)("provisioning.git.url-required","Repository URL is required"),pattern:{value:/^https?:\/\/.+/,message:(0,e.t)("provisioning.git.url-pattern","Must be a valid Git repository URL")}}},branch:{label:(0,e.t)("provisioning.git.branch-label","Branch"),description:(0,e.t)("provisioning.git.branch-description","The branch to use for provisioning"),placeholder:"main",required:!0,validation:{required:(0,e.t)("provisioning.git.branch-required","Branch is required")}},path:{label:(0,e.t)("provisioning.git.path-label","Path"),description:(0,e.t)("provisioning.git.path-description","Optional subdirectory path within the repository"),placeholder:"grafana/",required:!1},prWorkflow:{label:(0,e.t)("provisioning.git.pr-workflow-label","Enable pull request option when saving"),description:(0,e.t)("provisioning.git.pr-workflow-description","Allows users to choose whether to open a pull request when saving changes. If the repository does not allow direct changes to the main branch, a pull request may still be required.")}},local:{path:{label:(0,e.t)("provisioning.local.path-label","Repository Path"),description:(0,e.t)("provisioning.local.path-description","Local file system path to the repository"),placeholder:"/path/to/repository",required:!0,validation:{required:(0,e.t)("provisioning.local.path-required","Repository path is required")}}}}),o=t=>{const i=a()[t];if(!i)throw new Error(`No configuration found for repository type: ${t}`);const s=i.token,p=i.tokenUser,g=i.url,b=i.branch,d=i.path,n=i.prWorkflow;if(!s||!g||!b||!d||!n)throw new Error(`Missing required field configurations for ${t}`);return{tokenConfig:s,tokenUserConfig:p,urlConfig:g,branchConfig:b,pathConfig:d,prWorkflowConfig:n}},l=t=>{const i=a()[t];if(!i)throw new Error(`No configuration found for repository type: ${t}`);const s=i.path;if(!s)throw new Error(`Missing required field configuration for ${t}: path`);return{pathConfig:s}}},48485:(k,c,r)=>{r.d(c,{c:()=>s});var e=r(74848),a=r(22803),o=r(92745),l=r(89640),t=r(41654),i=r(63142);function s({type:n}){const u=(0,i.of)(p),{tokenText:v,createTokenLink:h,createTokenButtonText:w}=d()[n];return(0,e.jsxs)("div",{className:u.container,children:[(0,e.jsxs)(t.B,{gap:.5,wrap:"wrap",children:[(0,e.jsx)(o.x6,{i18nKey:"provisioning.token-permissions-info.go-to",children:"Go to"}),(0,e.jsx)(l.Y,{external:!0,href:h,children:v}),(0,e.jsx)(o.x6,{i18nKey:"provisioning.token-permissions-info.and-click",children:"and click"}),(0,e.jsxs)("strong",{children:['"',w,'".']}),(0,e.jsx)(o.x6,{i18nKey:"provisioning.token-permissions-info.make-sure",children:"Make sure to include these permissions"}),":"]}),(0,e.jsx)("ul",{className:u.permissionsList,children:g(n).map(f=>(0,e.jsx)(b,{label:f.name,access:f.access},f.name))})]})}function p(n){return{container:(0,a.css)({marginBottom:n.spacing(1),position:"relative",width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",padding:n.spacing(n.components.panel.padding)}),permissionsList:(0,a.css)({marginTop:n.spacing(2),marginBottom:n.spacing(1),paddingLeft:n.spacing(3),li:(0,a.css)({marginBottom:n.spacing(1)})}),accessLevel:(0,a.css)({fontFamily:n.typography.fontFamilyMonospace,background:n.colors.background.secondary,borderRadius:n.shape.radius.default,padding:n.spacing(.25,.5)})}}function g(n){switch(n){case"github":return[{name:"Contents",access:"Read and write"},{name:"Metadata",access:"Read only"},{name:"Pull requests",access:"Read and write"},{name:"Webhooks",access:"Read and write"}];case"gitlab":return[{name:(0,o.t)("provisioning.gitlab.permissions.repository-label","Repository"),access:(0,o.t)("provisioning.gitlab.permissions.repository-read-write","Read and write")},{name:(0,o.t)("provisioning.gitlab.permissions.user-label","User"),access:(0,o.t)("provisioning.gitlab.permissions.user-read","Read only")},{name:(0,o.t)("provisioning.gitlab.permissions.api","API"),access:(0,o.t)("provisioning.gitlab.permissions.api-read-write","Read and write")}];case"bitbucket":return[{name:(0,o.t)("provisioning.bitbucket.permissions.repository-label","Repositories"),access:(0,o.t)("provisioning.bitbucket.permissions.repository-read-write-admin","Read, and write")},{name:(0,o.t)("provisioning.bitbucket.permissions.pull-requests-label","Pull requests"),access:(0,o.t)("provisioning.bitbucket.permissions.pull-requests-read-write","Read and write")},{name:(0,o.t)("provisioning.bitbucket.permissions.webhooks-label","Webhooks"),access:(0,o.t)("provisioning.bitbucket.permissions.webhooks-read-write","Read and write")}];default:return[]}}function b({label:n,access:u}){const v=(0,i.of)(p);return(0,e.jsxs)("li",{children:[n,": ",(0,e.jsx)("span",{className:v.accessLevel,children:u})]})}function d(){return{bitbucket:{createTokenLink:"https://bitbucket.org/account/settings/app-passwords/",tokenText:(0,o.t)("provisioning.token-permissions-info.bitbucket.token-text","Bitbucket Personal Access Token"),createTokenButtonText:(0,o.t)("provisioning.token-permissions-info.bitbucket.create-token-button","Create App passwords")},gitlab:{createTokenLink:"https://gitlab.com/-/user_settings/personal_access_tokens",tokenText:(0,o.t)("provisioning.token-permissions-info.gitlab.token-text","GitLab Personal Access Token"),createTokenButtonText:(0,o.t)("provisioning.token-permissions-info.gitlab.create-token-button","Add new token")},github:{createTokenLink:"https://github.com/settings/personal-access-tokens/new",tokenText:"GitHub Personal Access Token",createTokenButtonText:"Fine-grained token"}}}},67170:(k,c,r)=>{r.d(c,{A:()=>o});var e=r(96540),a=r(83793);function o(t){const[i,s]=(0,a.ZL)(),[p,g]=(0,a.hD)(),[b,d]=(0,a.L)();return[(0,e.useCallback)(async(u,v)=>{const h=v?.length?{token:{create:v}}:void 0;return await b({name:t||"new",body:{spec:u,secure:h}}).unwrap(),t?p({name:t,repository:{metadata:{name:t,finalizers:["cleanup","remove-orphan-resources"]},spec:u,secure:h}}):i({repository:{metadata:l(u),spec:u,secure:h}})},[i,t,p,b]),t?g:s,d]}const l=t=>{const i=t.title.toLowerCase().replaceAll(/[^a-z0-9\-_]+/g,"");if(crypto.randomUUID&&i&&i.charAt(0)>="a"&&i.charAt(0)<="z"&&i.replaceAll(/[^a-z]/g,"").length>=3){const s=crypto.randomUUID().substring(0,7);return{name:`${i.substring(0,62-s.length)}-${s}`}}else return{generateName:"r"}}},70368:(k,c,r)=>{r.d(c,{w:()=>o});var e=r(92745),a=r(79162);function o(l){return l?(0,a.Bj)(l):{type:"github",title:(0,e.t)("provisioning.get-default-values.title.repository","Repository"),token:"",url:"",branch:"main",generateDashboardPreviews:!1,readOnly:!1,prWorkflow:!0,path:"grafana/",sync:{enabled:!1,target:"folder",intervalSeconds:60}}}},79162:(k,c,r)=>{r.d(c,{Bj:()=>o,WQ:()=>l,tB:()=>a});const e=t=>{if(t.readOnly)return[];const i=["write"];return t.prWorkflow?[...i,"branch"]:i},a=t=>{const i={type:t.type,sync:t.sync,title:t.title||"",workflows:e(t)},s={url:t.url||"",branch:t.branch,path:t.path};switch(t.type){case"github":i.github={...s,generateDashboardPreviews:t.generateDashboardPreviews};break;case"gitlab":i.gitlab=s;break;case"bitbucket":i.bitbucket=s;break;case"git":i.git=s;break;case"local":i.local={path:t.path},i.workflows=i.workflows.filter(p=>p!=="branch");break}return structuredClone(i)},o=t=>{const i=t.github||t.gitlab||t.bitbucket||t.git;return structuredClone({...t,...i,...t.local,branch:i?.branch||"",url:i?.url||"",generateDashboardPreviews:t.github?.generateDashboardPreviews||!1,readOnly:!t.workflows.length,prWorkflow:t.workflows.includes("branch")})},l=t=>{switch(t.type){case"github":return(t.url??"github").replace("https://github.com/","");case"gitlab":return(t.url??"gitlab").replace("https://gitlab.com/","");case"bitbucket":return(t.url??"bitbucket").replace("https://bitbucket.org/","");case"git":return(t.url??"git").replace(/^https?:\/\/[^\/]+\//,"");case"local":return t.path??"local";default:return""}}},83560:(k,c,r)=>{r.d(c,{X:()=>o});var e=r(96540),a=r(36490);const o=({message:l,when:t=!0})=>{const i=a.Ny.getHistory();return(0,e.useEffect)(()=>{if(!t)return;const s=i.block(l);return()=>{s()}},[t,l,i]),null}},83813:(k,c,r)=>{r.d(c,{F:()=>g});var e=r(74848),a=r(22803),o=r(96540),l=r(54148),t=r(92745),i=r(22787),s=r(45861),p=r(83560);const g=({confirmRedirect:d,onDiscard:n,onLocationChange:u})=>{const[v,h]=(0,o.useState)(!1),[w,f]=(0,o.useState)(null),[E,P]=(0,o.useState)(!1);(0,o.useEffect)(()=>{const m=_=>{d&&(_.preventDefault(),_.returnValue="")};return window.addEventListener("beforeunload",m),()=>{window.removeEventListener("beforeunload",m)}},[d]);const q=m=>{const _=window.location.pathname,T=m.pathname;if(_===T)return!0;const x=u?.(m);let y=d&&!E;return x!==void 0&&(y=y&&x),y?(h(!0),f(m),!1):(x&&n(),!0)},R=()=>{h(!1),f(null)},L=()=>{h(!1),P(!0),n()};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(p.X,{when:!0,message:q}),w&&E&&(0,e.jsx)(l.C5,{replace:!0,to:w}),(0,e.jsx)(b,{isOpen:v,onDiscard:L,onBackToForm:R})]})},b=({onDiscard:d,onBackToForm:n,isOpen:u})=>(0,e.jsxs)(i.a,{isOpen:u,title:(0,t.t)("form-prompt.title","Leave page?"),onDismiss:n,icon:"exclamation-triangle",className:(0,a.css)({width:"500px"}),children:[(0,e.jsx)("h5",{children:(0,e.jsx)(t.x6,{i18nKey:"form-prompt.description",children:"Changes that you made may not be saved."})}),(0,e.jsxs)(i.a.ButtonRow,{children:[(0,e.jsx)(s.$n,{variant:"secondary",onClick:n,fill:"outline",children:(0,e.jsx)(t.x6,{i18nKey:"form-prompt.continue-button",children:"Continue editing"})}),(0,e.jsx)(s.$n,{variant:"destructive",onClick:d,children:(0,e.jsx)(t.x6,{i18nKey:"form-prompt.discard-button",children:"Discard unsaved changes"})})]})]})}}]);

//# sourceMappingURL=1167.df8204e4796af6a9e2ce.js.map