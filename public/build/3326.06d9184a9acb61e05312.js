"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3326],{409:(Ft,at,i)=>{i.d(at,{A:()=>$,n:()=>K});var U=i(89352),p=i(49825);function $(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function K(w,T,f){const m=(0,p.qg)(w,T,f);return d(m,f)}function d(w,T){if(w instanceof p._D){if(w.type===p.mE&&typeof w.value=="string"){const m=(0,U.sH)(w.value);return function(){return m}}return function(){return w.value}}const f=w.operator;switch(f){case p.ZD.Number:case p.ZD.String:case p.ZD.Coalesce:return E(w,T);case p.ZD.Get:case p.ZD.Var:case p.ZD.Has:return l(w,T);case p.ZD.Id:return m=>m.featureId;case p.ZD.GeometryType:return m=>m.geometryType;case p.ZD.Concat:{const m=w.args.map(_=>d(_,T));return _=>"".concat(...m.map(R=>R(_).toString()))}case p.ZD.Resolution:return m=>m.resolution;case p.ZD.Any:case p.ZD.All:case p.ZD.Between:case p.ZD.In:case p.ZD.Not:return P(w,T);case p.ZD.Equal:case p.ZD.NotEqual:case p.ZD.LessThan:case p.ZD.LessThanOrEqualTo:case p.ZD.GreaterThan:case p.ZD.GreaterThanOrEqualTo:return y(w,T);case p.ZD.Multiply:case p.ZD.Divide:case p.ZD.Add:case p.ZD.Subtract:case p.ZD.Clamp:case p.ZD.Mod:case p.ZD.Pow:case p.ZD.Abs:case p.ZD.Floor:case p.ZD.Ceil:case p.ZD.Round:case p.ZD.Sin:case p.ZD.Cos:case p.ZD.Atan:case p.ZD.Sqrt:return g(w,T);case p.ZD.Case:return I(w,T);case p.ZD.Match:return s(w,T);case p.ZD.Interpolate:return e(w,T);case p.ZD.ToString:return c(w,T);default:throw new Error(`Unsupported operator ${f}`)}}function E(w,T){const f=w.operator,m=w.args.length,_=new Array(m);for(let R=0;R<m;++R)_[R]=d(w.args[R],T);switch(f){case p.ZD.Coalesce:return R=>{for(let b=0;b<m;++b){const N=_[b](R);if(typeof N<"u"&&N!==null)return N}throw new Error("Expected one of the values to be non-null")};case p.ZD.Number:case p.ZD.String:return R=>{for(let b=0;b<m;++b){const N=_[b](R);if(typeof N===f)return N}throw new Error(`Expected one of the values to be a ${f}`)};default:throw new Error(`Unsupported assertion operator ${f}`)}}function l(w,T){const m=w.args[0].value;switch(w.operator){case p.ZD.Get:return _=>{const R=w.args;let b=_.properties[m];for(let N=1,W=R.length;N<W;++N){const o=R[N].value;b=b[o]}return b};case p.ZD.Var:return _=>_.variables[m];case p.ZD.Has:return _=>{const R=w.args;if(!(m in _.properties))return!1;let b=_.properties[m];for(let N=1,W=R.length;N<W;++N){const o=R[N].value;if(!b||!Object.hasOwn(b,o))return!1;b=b[o]}return!0};default:throw new Error(`Unsupported accessor operator ${w.operator}`)}}function y(w,T){const f=w.operator,m=d(w.args[0],T),_=d(w.args[1],T);switch(f){case p.ZD.Equal:return R=>m(R)===_(R);case p.ZD.NotEqual:return R=>m(R)!==_(R);case p.ZD.LessThan:return R=>m(R)<_(R);case p.ZD.LessThanOrEqualTo:return R=>m(R)<=_(R);case p.ZD.GreaterThan:return R=>m(R)>_(R);case p.ZD.GreaterThanOrEqualTo:return R=>m(R)>=_(R);default:throw new Error(`Unsupported comparison operator ${f}`)}}function P(w,T){const f=w.operator,m=w.args.length,_=new Array(m);for(let R=0;R<m;++R)_[R]=d(w.args[R],T);switch(f){case p.ZD.Any:return R=>{for(let b=0;b<m;++b)if(_[b](R))return!0;return!1};case p.ZD.All:return R=>{for(let b=0;b<m;++b)if(!_[b](R))return!1;return!0};case p.ZD.Between:return R=>{const b=_[0](R),N=_[1](R),W=_[2](R);return b>=N&&b<=W};case p.ZD.In:return R=>{const b=_[0](R);for(let N=1;N<m;++N)if(b===_[N](R))return!0;return!1};case p.ZD.Not:return R=>!_[0](R);default:throw new Error(`Unsupported logical operator ${f}`)}}function g(w,T){const f=w.operator,m=w.args.length,_=new Array(m);for(let R=0;R<m;++R)_[R]=d(w.args[R],T);switch(f){case p.ZD.Multiply:return R=>{let b=1;for(let N=0;N<m;++N)b*=_[N](R);return b};case p.ZD.Divide:return R=>_[0](R)/_[1](R);case p.ZD.Add:return R=>{let b=0;for(let N=0;N<m;++N)b+=_[N](R);return b};case p.ZD.Subtract:return R=>_[0](R)-_[1](R);case p.ZD.Clamp:return R=>{const b=_[0](R),N=_[1](R);if(b<N)return N;const W=_[2](R);return b>W?W:b};case p.ZD.Mod:return R=>_[0](R)%_[1](R);case p.ZD.Pow:return R=>Math.pow(_[0](R),_[1](R));case p.ZD.Abs:return R=>Math.abs(_[0](R));case p.ZD.Floor:return R=>Math.floor(_[0](R));case p.ZD.Ceil:return R=>Math.ceil(_[0](R));case p.ZD.Round:return R=>Math.round(_[0](R));case p.ZD.Sin:return R=>Math.sin(_[0](R));case p.ZD.Cos:return R=>Math.cos(_[0](R));case p.ZD.Atan:return m===2?R=>Math.atan2(_[0](R),_[1](R)):R=>Math.atan(_[0](R));case p.ZD.Sqrt:return R=>Math.sqrt(_[0](R));default:throw new Error(`Unsupported numeric operator ${f}`)}}function I(w,T){const f=w.args.length,m=new Array(f);for(let _=0;_<f;++_)m[_]=d(w.args[_],T);return _=>{for(let R=0;R<f-1;R+=2)if(m[R](_))return m[R+1](_);return m[f-1](_)}}function s(w,T){const f=w.args.length,m=new Array(f);for(let _=0;_<f;++_)m[_]=d(w.args[_],T);return _=>{const R=m[0](_);for(let b=1;b<f-1;b+=2)if(R===m[b](_))return m[b+1](_);return m[f-1](_)}}function e(w,T){const f=w.args.length,m=new Array(f);for(let _=0;_<f;++_)m[_]=d(w.args[_],T);return _=>{const R=m[0](_),b=m[1](_);let N,W;for(let a=2;a<f;a+=2){const o=m[a](_);let r=m[a+1](_);const L=Array.isArray(r);if(L&&(r=(0,U.fu)(r)),o>=b)return a===2?r:L?B(R,b,N,W,o,r):G(R,b,N,W,o,r);N=o,W=r}return W}}function c(w,T){const f=w.operator,m=w.args.length,_=new Array(m);for(let R=0;R<m;++R)_[R]=d(w.args[R],T);switch(f){case p.ZD.ToString:return R=>{const b=_[0](R);return w.args[0].type===p.mE?(0,U.dI)(b):b.toString()};default:throw new Error(`Unsupported convert operator ${f}`)}}function G(w,T,f,m,_,R){const b=_-f;if(b===0)return m;const N=T-f,W=w===1?N/b:(Math.pow(w,N)-1)/(Math.pow(w,b)-1);return m+W*(R-m)}function B(w,T,f,m,_,R){if(_-f===0)return m;const N=(0,U.eE)(m),W=(0,U.eE)(R);let a=W[2]-N[2];a>180?a-=360:a<-180&&(a+=360);const o=[G(w,T,f,N[0],_,W[0]),G(w,T,f,N[1],_,W[1]),N[2]+G(w,T,f,0,_,a),G(w,T,f,m[3],_,R[3])];return(0,U.cD)(o)}},835:(Ft,at,i)=>{i.d(at,{x:()=>U});const U={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"}},953:(Ft,at,i)=>{i.d(at,{A:()=>p});class U{constructor(K){K=K||{},this.color_=K.color!==void 0?K.color:null,this.lineCap_=K.lineCap,this.lineDash_=K.lineDash!==void 0?K.lineDash:null,this.lineDashOffset_=K.lineDashOffset,this.lineJoin_=K.lineJoin,this.miterLimit_=K.miterLimit,this.width_=K.width}clone(){const K=this.getColor();return new U({color:Array.isArray(K)?K.slice():K||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(K){this.color_=K}setLineCap(K){this.lineCap_=K}setLineDash(K){this.lineDash_=K}setLineDashOffset(K){this.lineDashOffset_=K}setLineJoin(K){this.lineJoin_=K}setMiterLimit(K){this.miterLimit_=K}setWidth(K){this.width_=K}}const p=U},1486:(Ft,at,i)=>{i.d(at,{N:()=>s});var U=i(25847);function p(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const $=.985,K=null,d={vertexPosition:0,indexPosition:0};function E(e,c,G,B,w){e[c+0]=G,e[c+1]=B,e[c+2]=w}function l(e,c,G,B,w,T){const _=3+w,R=e[c+0],b=e[c+1],N=K;N.length=w;for(let r=0;r<N.length;r++)N[r]=e[c+2+r];let W=T?T.vertexPosition:0,a=T?T.indexPosition:0;const o=W/_;return E(G,W,R,b,0),N.length&&G.set(N,W+3),W+=_,E(G,W,R,b,1),N.length&&G.set(N,W+3),W+=_,E(G,W,R,b,2),N.length&&G.set(N,W+3),W+=_,E(G,W,R,b,3),N.length&&G.set(N,W+3),W+=_,B[a++]=o,B[a++]=o+1,B[a++]=o+3,B[a++]=o+1,B[a++]=o+2,B[a++]=o+3,d.vertexPosition=W,d.indexPosition=a,d}function y(e,c,G,B,w,T,f,m,_,R,b){const W=10+m.length,a=T.length/W,o=[e[c+0],e[c+1]],r=[e[G],e[G+1]],L=e[c+2],A=e[G+2],O=applyTransform(_,[...o]),u=applyTransform(_,[...r]);function x(ft,it,st){const gt=Math.sqrt((it[0]-ft[0])*(it[0]-ft[0])+(it[1]-ft[1])*(it[1]-ft[1])),Ot=[(it[0]-ft[0])/gt,(it[1]-ft[1])/gt],nt=[-Ot[1],Ot[0]],et=Math.sqrt((st[0]-ft[0])*(st[0]-ft[0])+(st[1]-ft[1])*(st[1]-ft[1])),Et=[(st[0]-ft[0])/et,(st[1]-ft[1])/et],ut=gt===0||et===0?0:Math.acos(clamp(Et[0]*Ot[0]+Et[1]*Ot[1],-1,1));return Et[0]*nt[0]+Et[1]*nt[1]>0?ut:Math.PI*2-ut}let S=-1,k=-1,tt=b;const ht=B!==null,dt=w!==null;if(ht){const ft=[e[B],e[B+1]],it=applyTransform(_,[...ft]);S=x(O,u,it),Math.cos(S)<=$&&(tt+=Math.tan((S-Math.PI)/2))}if(dt){const ft=[e[w],e[w+1]],it=applyTransform(_,[...ft]);k=x(u,O,it),Math.cos(k)<=$&&(tt+=Math.tan((Math.PI-k)/2))}function J(ft,it){return it===0?ft*1e4:Math.sign(it)*(ft*1e4+Math.abs(it))}return T.push(o[0],o[1],L,r[0],r[1],A,S,k,R,J(0,b)),T.push(...m),T.push(o[0],o[1],L,r[0],r[1],A,S,k,R,J(1,b)),T.push(...m),T.push(o[0],o[1],L,r[0],r[1],A,S,k,R,J(2,b)),T.push(...m),T.push(o[0],o[1],L,r[0],r[1],A,S,k,R,J(3,b)),T.push(...m),f.push(a,a+1,a+2,a+1,a+3,a+2),{length:R+Math.sqrt((u[0]-O[0])*(u[0]-O[0])+(u[1]-O[1])*(u[1]-O[1])),angle:tt}}function P(e,c,G,B,w){const f=2+w;let m=c;const _=e.slice(m,m+w);m+=w;const R=e[m++];let b=0;const N=new Array(R-1);for(let o=0;o<R;o++)b+=e[m++],o<R-1&&(N[o]=b);const W=e.slice(m,m+b*2),a=earcut(W,N,2);for(let o=0;o<a.length;o++)B.push(a[o]+G.length/f);for(let o=0;o<W.length;o+=2)G.push(W[o],W[o+1],..._);return m+b*2}const g=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders
`,I=p();class s{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${(0,U.$R)(I["circle-radius"])} + ${(0,U.$R)(I["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=(0,U.VO)(I["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=(0,U.$R)(I["stroke-width"]),this.strokeColorExpression_=(0,U.VO)(I["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=(0,U.Tl)("round"),this.strokeJoinExpression_=(0,U.Tl)("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.hasFill_=!1,this.fillColorExpression_=(0,U.VO)(I["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(c,G){return this.uniforms_.push({name:c,type:G}),this}addAttribute(c,G,B,w){return this.attributes_.push({name:c,type:G,varyingName:c.replace(/^a_/,"v_"),varyingType:w??G,varyingExpression:B??c}),this}setSymbolSizeExpression(c){return this.hasSymbol_=!0,this.symbolSizeExpression_=c,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(c){return this.symbolRotationExpression_=c,this}setSymbolOffsetExpression(c){return this.symbolOffsetExpression_=c,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(c){return this.hasSymbol_=!0,this.symbolColorExpression_=c,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(c){return this.texCoordExpression_=c,this}setFragmentDiscardExpression(c){return this.discardExpression_=c,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(c){return this.symbolRotateWithView_=c,this}setStrokeWidthExpression(c){return this.hasStroke_=!0,this.strokeWidthExpression_=c,this}setStrokeColorExpression(c){return this.hasStroke_=!0,this.strokeColorExpression_=c,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(c){return this.strokeOffsetExpression_=c,this}setStrokeCapExpression(c){return this.strokeCapExpression_=c,this}setStrokeJoinExpression(c){return this.strokeJoinExpression_=c,this}setStrokeMiterLimitExpression(c){return this.strokeMiterLimitExpression_=c,this}setStrokeDistanceFieldExpression(c){return this.strokeDistanceFieldExpression_=c,this}setFillColorExpression(c){return this.hasFill_=!0,this.fillColorExpression_=c,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(c){return this.vertexShaderFunctions_.includes(c)?this:(this.vertexShaderFunctions_.push(c),this)}addFragmentShaderFunction(c){return this.fragmentShaderFunctions_.includes(c)?this:(this.fragmentShaderFunctions_.push(c),this)}getSymbolVertexShader(){return this.hasSymbol_?`${g}
${this.uniforms_.map(c=>`uniform ${c.type} ${c.name};`).join(`
`)}
attribute vec2 a_position;
attribute float a_index;
attribute vec4 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(c=>`attribute ${c.type} ${c.name};
varying ${c.varyingType} ${c.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx;
  if (a_index == 0.0) {
    offsetPx -= halfSizePx;
  } else if (a_index == 1.0) {
    offsetPx += halfSizePx * vec2(1., -1.);
  } else if (a_index == 2.0) {
    offsetPx += halfSizePx;
  } else {
    offsetPx += halfSizePx * vec2(-1., 1.);
  }
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;
  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;
  v_texCoord = vec2(u, v);
  v_hitColor = a_hitColor;
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(c=>`  ${c.varyingName} = ${c.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${g}
${this.uniforms_.map(c=>`uniform ${c.type} ${c.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(c=>`varying ${c.varyingType} ${c.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(c=>`  ${c.varyingType} ${c.name} = ${c.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${g}
${this.uniforms_.map(c=>`uniform ${c.type} ${c.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_parameters;
attribute float a_distance;
attribute vec2 a_joinAngles;
attribute vec4 a_hitColor;

varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(c=>`attribute ${c.type} ${c.name};
varying ${c.varyingType} ${c.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float vertexNumber = floor(abs(a_parameters) / 10000. + 0.5);
  currentLineMetric = vertexNumber < 1.5 ? a_measureStart : a_measureEnd;
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)
  float angleTangentSum = fract(abs(a_parameters) / 10000.) * 10000. * sign(a_parameters);

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = vertexNumber < 0.5 || (vertexNumber > 1.5 && vertexNumber < 2.5) ? 1.0 : -1.0;
  float tangentDir = vertexNumber < 1.5 ? 1.0 : -1.0;
  float angle = vertexNumber < 1.5 ? v_angleStart : v_angleEnd;
  vec2 joinDirection;
  vec2 positionPx = vertexNumber < 1.5 ? segmentStartPx : segmentEndPx;
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${$} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStart = segmentStartPx;
  v_segmentEnd = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = a_hitColor;
  v_distanceOffsetPx = a_distance / u_resolution - (lineOffsetPx * angleTangentSum);
  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(c=>`  ${c.varyingName} = ${c.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${g}
${this.uniforms_.map(c=>`uniform ${c.type} ${c.name};`).join(`
`)}
varying vec2 v_segmentStart;
varying vec2 v_segmentEnd;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distanceOffsetPx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(c=>`varying ${c.varyingType} ${c.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${$}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${(0,U.Tl)("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${(0,U.Tl)("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${(0,U.Tl)("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${(0,U.Tl)("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(c=>`  ${c.varyingType} ${c.name} = ${c.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPoint = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPoint);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLength = length(v_segmentEnd - v_segmentStart);
  vec2 segmentTangent = (v_segmentEnd - v_segmentStart) / segmentLength;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPoint = currentPoint - v_segmentStart;
  float lengthToPoint = max(0., min(dot(segmentTangent, startToPoint), segmentLength));
  float currentLengthPx = lengthToPoint + v_distanceOffsetPx;
  float currentRadiusPx = distanceFromSegment(currentPoint, v_segmentStart, v_segmentEnd);
  float currentRadiusRatio = dot(segmentNormal, startToPoint) * 2. / v_width;
  currentLineMetric = mix(
    v_measureStart,
    v_measureEnd,
    lengthToPoint / max(segmentLength, 1.17549429e-38)
  );

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPoint, v_segmentStart, v_segmentEnd, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPoint, v_segmentEnd, v_segmentStart, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPoint, v_segmentStart, v_segmentEnd, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${g}
${this.uniforms_.map(c=>`uniform ${c.type} ${c.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec4 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(c=>`attribute ${c.type} ${c.name};
varying ${c.varyingType} ${c.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = a_hitColor;
${this.attributes_.map(c=>`  ${c.varyingName} = ${c.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${g}
${this.uniforms_.map(c=>`uniform ${c.type} ${c.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(c=>`varying ${c.varyingType} ${c.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(c=>`  ${c.varyingType} ${c.name} = ${c.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}},3422:(Ft,at,i)=>{i.d(at,{L:()=>p,b:()=>U});function U($,K){K=K||[];const d=256,E=d-1;return K[0]=Math.floor($/d/d/d)/E,K[1]=Math.floor($/d/d)%d/E,K[2]=Math.floor($/d)%d/E,K[3]=$%d/E,K}function p($){let K=0;const d=256,E=d-1;return K+=Math.round($[0]*d*d*d*E),K+=Math.round($[1]*d*d*E),K+=Math.round($[2]*d*E),K+=Math.round($[3]*E),K}},5986:(Ft,at,i)=>{i.d(at,{A:()=>l});var U=i(6141),p=i(11854),$=i(6837),K=i(4087);const d=5;class E extends p.A{constructor(P){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=P,this.staleKeys_=new Array,this.maxStaleKeys=d}getStaleKeys(){return this.staleKeys_}prependStaleKey(P){this.staleKeys_.unshift(P),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(P){return(0,K.b0)()}getData(P){return null}prepareFrame(P){return(0,K.b0)()}renderFrame(P,g){return(0,K.b0)()}forEachFeatureAtCoordinate(P,g,I,s,e){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(P){const g=P.target;(g.getState()===U.A.LOADED||g.getState()===U.A.ERROR)&&this.renderIfReadyAndVisible()}loadImage(P){let g=P.getState();return g!=U.A.LOADED&&g!=U.A.ERROR&&P.addEventListener($.A.CHANGE,this.boundHandleImageChange_),g==U.A.IDLE&&(P.load(),g=P.getState()),g==U.A.LOADED}renderIfReadyAndVisible(){const P=this.getLayer();P&&P.getVisible()&&P.getSourceState()==="ready"&&P.changed()}renderDeferred(P){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const l=E},6141:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},6292:(Ft,at,i)=>{i.d(at,{Ay:()=>l,D2:()=>E,e4:()=>d});var U=i(34120),p=i(93474),$=i(82187);class K extends U.A{constructor(P){super(),this.on,this.once,this.un,P&&P.handleEvent&&(this.handleEvent=P.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get($.A.ACTIVE)}getMap(){return this.map_}handleEvent(P){return!0}setActive(P){this.set($.A.ACTIVE,P)}setMap(P){this.map_=P}}function d(y,P,g){const I=y.getCenterInternal();if(I){const s=[I[0]+P[0],I[1]+P[1]];y.animateInternal({duration:g!==void 0?g:250,easing:p.sn,center:y.getConstrainedCenter(s)})}}function E(y,P,g,I){const s=y.getZoom();if(s===void 0)return;const e=y.getConstrainedZoom(s+P),c=y.getResolutionForZoom(e);y.getAnimating()&&y.cancelAnimations(),y.animate({resolution:c,anchor:g,duration:I!==void 0?I:250,easing:p.vT})}const l=K},6782:(Ft,at,i)=>{i.d(at,{Ie:()=>p,hs:()=>$,xq:()=>K});function U(d,E,l){return l===void 0&&(l=[0,0]),l[0]=d[0]+2*E,l[1]=d[1]+2*E,l}function p(d){return d[0]>0&&d[1]>0}function $(d,E,l){return l===void 0&&(l=[0,0]),l[0]=d[0]*E+.5|0,l[1]=d[1]*E+.5|0,l}function K(d,E){return Array.isArray(d)?d:(E===void 0?E=[d,d]:(E[0]=d,E[1]=d),E)}},7771:(Ft,at,i)=>{i.d(at,{DT:()=>y,FT:()=>g,Wl:()=>l,XM:()=>P,cr:()=>E,ew:()=>d,j:()=>K,oF:()=>$});const U=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",$=U.includes("safari")&&!U.includes("chrom")&&(U.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(U)),K=U.includes("webkit")&&!U.includes("edge"),d=U.includes("macintosh"),E=typeof devicePixelRatio<"u"?devicePixelRatio:1,l=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,y=typeof Image<"u"&&Image.prototype.decode,P=typeof createImageBitmap=="function",g=function(){let I=!1;try{const s=Object.defineProperty({},"passive",{get:function(){I=!0}});window.addEventListener("_",null,s),window.removeEventListener("_",null,s)}catch{}return I}()},8143:(Ft,at,i)=>{i.d(at,{A:()=>l});var U=i(11078),p=i(93474),$=i(6837),K=i(79332),d=i(4087);class E extends K.A{constructor(P,g,I){super(),I=I||{},this.tileCoord=P,this.state=g,this.key="",this.transition_=I.transition===void 0?250:I.transition,this.transitionStarts_={},this.interpolate=!!I.interpolate}changed(){this.dispatchEvent($.A.CHANGE)}release(){this.setState(U.A.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(P){if(this.state!==U.A.EMPTY){if(this.state!==U.A.ERROR&&this.state>P)throw new Error("Tile load sequence violation");this.state=P,this.changed()}}load(){(0,d.b0)()}getAlpha(P,g){if(!this.transition_)return 1;let I=this.transitionStarts_[P];if(!I)I=g,this.transitionStarts_[P]=I;else if(I===-1)return 1;const s=g-I+1e3/60;return s>=this.transition_?1:(0,p.a6)(s/this.transition_)}inTransition(P){return this.transition_?this.transitionStarts_[P]!==-1:!1}endTransition(P){this.transition_&&(this.transitionStarts_[P]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}const l=E},9777:(Ft,at,i)=>{i.d(at,{jQ:()=>c,M8:()=>e,Ay:()=>N});var U=i(90025),p=i(43530),$=i(9703),K=i(4087),d=i(83954);const E={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};var l=i(90130);const y=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,P=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class g{constructor(a){this.gl_=a.webGlContext;const o=this.gl_;this.scaleRatio_=a.scaleRatio||1,this.renderTargetTexture_=o.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=o.createFramebuffer(),this.depthBuffer_=o.createRenderbuffer();const r=o.createShader(o.VERTEX_SHADER);o.shaderSource(r,a.vertexShader||y),o.compileShader(r);const L=o.createShader(o.FRAGMENT_SHADER);o.shaderSource(L,a.fragmentShader||P),o.compileShader(L),this.renderTargetProgram_=o.createProgram(),o.attachShader(this.renderTargetProgram_,r),o.attachShader(this.renderTargetProgram_,L),o.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=o.createBuffer();const A=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];o.bindBuffer(o.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),o.bufferData(o.ARRAY_BUFFER,new Float32Array(A),o.STATIC_DRAW),this.renderTargetAttribLocation_=o.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=o.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=o.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=o.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],a.uniforms&&Object.keys(a.uniforms).forEach(O=>{this.uniforms_.push({value:a.uniforms[O],location:o.getUniformLocation(this.renderTargetProgram_,O)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(a){const o=this.getGL(),r=[o.drawingBufferWidth*this.scaleRatio_,o.drawingBufferHeight*this.scaleRatio_];if(o.bindFramebuffer(o.FRAMEBUFFER,this.getFrameBuffer()),o.bindRenderbuffer(o.RENDERBUFFER,this.getDepthBuffer()),o.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const L=0,A=o.RGBA,O=0,u=o.RGBA,x=o.UNSIGNED_BYTE,S=null;o.bindTexture(o.TEXTURE_2D,this.renderTargetTexture_),o.texImage2D(o.TEXTURE_2D,L,A,r[0],r[1],O,u,x,S),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.renderTargetTexture_,0),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,r[0],r[1]),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,this.depthBuffer_)}}apply(a,o,r,L){const A=this.getGL(),O=a.size;if(A.bindFramebuffer(A.FRAMEBUFFER,o?o.getFrameBuffer():null),A.activeTexture(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,this.renderTargetTexture_),!o){const x=(0,K.v6)(A.canvas);if(!a.renderTargets[x]){const S=A.getContextAttributes();S&&S.preserveDrawingBuffer&&(A.clearColor(0,0,0,0),A.clearDepth(1),A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT)),a.renderTargets[x]=!0}}A.disable(A.DEPTH_TEST),A.enable(A.BLEND),A.blendFunc(A.ONE,A.ONE_MINUS_SRC_ALPHA),A.viewport(0,0,A.drawingBufferWidth,A.drawingBufferHeight),A.bindBuffer(A.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),A.useProgram(this.renderTargetProgram_),A.enableVertexAttribArray(this.renderTargetAttribLocation_),A.vertexAttribPointer(this.renderTargetAttribLocation_,2,A.FLOAT,!1,0,0),A.uniform2f(this.renderTargetUniformLocation_,O[0],O[1]),A.uniform1i(this.renderTargetTextureLocation_,0);const u=a.layerStatesArray[a.layerIndex].opacity;A.uniform1f(this.renderTargetOpacityLocation_,u),this.applyUniforms(a),r&&r(A,a),A.drawArrays(A.TRIANGLES,0,6),L&&L(A,a)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(a){const o=this.getGL();let r,L=1;this.uniforms_.forEach(function(A){if(r=typeof A.value=="function"?A.value(a):A.value,r instanceof HTMLCanvasElement||r instanceof ImageData)A.texture||(A.texture=o.createTexture()),o.activeTexture(o[`TEXTURE${L}`]),o.bindTexture(o.TEXTURE_2D,A.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),r instanceof ImageData?o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,r.width,r.height,0,o.UNSIGNED_BYTE,new Uint8Array(r.data)):o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,r),o.uniform1i(A.location,L++);else if(Array.isArray(r))switch(r.length){case 2:o.uniform2f(A.location,r[0],r[1]);return;case 3:o.uniform3f(A.location,r[0],r[1],r[2]);return;case 4:o.uniform4f(A.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&o.uniform1f(A.location,r)})}}const I=g,s={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633},e={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},c={UNSIGNED_BYTE:l.l4,UNSIGNED_SHORT:l.JL,UNSIGNED_INT:l.UD,FLOAT:l.zH},G={};function B(W){return"shared/"+W}let w=0;function T(){const W="unique/"+w;return w+=1,W}function f(W){let a=G[W];if(!a){const o=document.createElement("canvas");o.width=1,o.height=1,o.style.position="absolute",o.style.left="0",a={users:0,context:(0,l.SD)(o)},G[W]=a}return a.users+=1,a.context}function m(W){const a=G[W];if(!a||(a.users-=1,a.users>0))return;const o=a.context,r=o.getExtension("WEBGL_lose_context");r&&r.loseContext();const L=o.canvas;L.width=1,L.height=1,delete G[W]}class _ extends U.A{constructor(a){super(),a=a||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=a.canvasCacheKey?B(a.canvasCacheKey):T(),this.gl_=f(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const o=this.gl_.canvas;o.addEventListener(E.LOST,this.boundHandleWebGLContextLost_),o.addEventListener(E.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=(0,$.vt)(),this.offsetScaleMatrix_=(0,$.vt)(),this.tmpMat4_=(0,d.vt)(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],a.uniforms&&this.setUniforms(a.uniforms),this.postProcessPasses_=a.postProcesses?a.postProcesses.map(r=>new I({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new I({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(a){this.uniforms_=[],this.addUniforms(a)}addUniforms(a){for(const o in a)this.uniforms_.push({name:o,value:a[o]})}canvasCacheKeyMatches(a){return this.canvasCacheKey_===B(a)}getExtension(a){if(a in this.extensionCache_)return this.extensionCache_[a];const o=this.gl_.getExtension(a);return this.extensionCache_[a]=o,o}bindBuffer(a){const o=this.gl_,r=(0,K.v6)(a);let L=this.bufferCache_[r];if(!L){const A=o.createBuffer();L={buffer:a,webGlBuffer:A},this.bufferCache_[r]=L}o.bindBuffer(a.getType(),L.webGlBuffer)}flushBufferData(a){const o=this.gl_;this.bindBuffer(a),o.bufferData(a.getType(),a.getArray(),a.getUsage())}deleteBuffer(a){const o=(0,K.v6)(a);delete this.bufferCache_[o]}disposeInternal(){const a=this.gl_.canvas;a.removeEventListener(E.LOST,this.boundHandleWebGLContextLost_),a.removeEventListener(E.RESTORED,this.boundHandleWebGLContextRestored_),m(this.canvasCacheKey_),delete this.gl_}prepareDraw(a,o,r){const L=this.gl_,A=this.getCanvas(),O=a.size,u=a.pixelRatio;(A.width!==O[0]*u||A.height!==O[1]*u)&&(A.width=O[0]*u,A.height=O[1]*u,A.style.width=O[0]+"px",A.style.height=O[1]+"px");for(let x=this.postProcessPasses_.length-1;x>=0;x--)this.postProcessPasses_[x].init(a);L.bindTexture(L.TEXTURE_2D,null),L.clearColor(0,0,0,0),L.depthRange(0,1),L.clearDepth(1),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),L.enable(L.BLEND),L.blendFunc(L.ONE,o?L.ZERO:L.ONE_MINUS_SRC_ALPHA),r?(L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL)):L.disable(L.DEPTH_TEST)}bindFrameBuffer(a,o){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,a),o&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0)}bindInitialFrameBuffer(){const a=this.getGL(),o=this.postProcessPasses_[0].getFrameBuffer();a.bindFramebuffer(a.FRAMEBUFFER,o);const r=this.postProcessPasses_[0].getRenderTargetTexture();a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,r,0)}bindTexture(a,o,r){const L=this.gl_;L.activeTexture(L.TEXTURE0+o),L.bindTexture(L.TEXTURE_2D,a),L.uniform1i(this.getUniformLocation(r),o)}bindAttribute(a,o,r){const L=this.getGL();this.bindBuffer(a);const A=this.getAttributeLocation(o);L.enableVertexAttribArray(A),L.vertexAttribPointer(A,r,L.FLOAT,!1,0,0)}prepareDrawToRenderTarget(a,o,r,L){const A=this.gl_,O=o.getSize();A.bindFramebuffer(A.FRAMEBUFFER,o.getFramebuffer()),A.bindRenderbuffer(A.RENDERBUFFER,o.getDepthbuffer()),A.viewport(0,0,O[0],O[1]),A.bindTexture(A.TEXTURE_2D,o.getTexture()),A.clearColor(0,0,0,0),A.depthRange(0,1),A.clearDepth(1),A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT),A.enable(A.BLEND),A.blendFunc(A.ONE,r?A.ZERO:A.ONE_MINUS_SRC_ALPHA),L?(A.enable(A.DEPTH_TEST),A.depthFunc(A.LEQUAL)):A.disable(A.DEPTH_TEST)}drawElements(a,o){const r=this.gl_;this.getExtension("OES_element_index_uint");const L=r.UNSIGNED_INT,A=4,O=o-a,u=a*A;r.drawElements(r.TRIANGLES,O,L,u)}finalizeDraw(a,o,r){for(let L=0,A=this.postProcessPasses_.length;L<A;L++)L===A-1?this.postProcessPasses_[L].apply(a,null,o,r):this.postProcessPasses_[L].apply(a,this.postProcessPasses_[L+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(a){const o=a.size,r=a.viewState.rotation,L=a.pixelRatio;this.setUniformFloatValue(e.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(e.ZOOM,a.viewState.zoom),this.setUniformFloatValue(e.RESOLUTION,a.viewState.resolution),this.setUniformFloatValue(e.PIXEL_RATIO,L),this.setUniformFloatVec2(e.VIEWPORT_SIZE_PX,[o[0],o[1]]),this.setUniformFloatValue(e.ROTATION,r)}applyHitDetectionUniform(a){const o=this.getUniformLocation(e.HIT_DETECTION);this.getGL().uniform1i(o,a?1:0),a&&this.setUniformFloatValue(e.PIXEL_RATIO,.5)}applyUniforms(a){const o=this.gl_;let r,L=0;this.uniforms_.forEach(A=>{if(r=typeof A.value=="function"?A.value(a):A.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!A.texture?(A.prevValue=void 0,A.texture=r):A.texture||(A.prevValue=void 0,A.texture=o.createTexture()),this.bindTexture(A.texture,L,A.name),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE);const O=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&O&&A.prevValue!==r&&(A.prevValue=r,o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,r)),L++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(A.name,(0,d.Z1)(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:o.uniform2f(this.getUniformLocation(A.name),r[0],r[1]);return;case 3:o.uniform3f(this.getUniformLocation(A.name),r[0],r[1],r[2]);return;case 4:o.uniform4f(this.getUniformLocation(A.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&o.uniform1f(this.getUniformLocation(A.name),r)})}useProgram(a,o){this.disableAllAttributes_(),this.gl_.useProgram(a),this.currentProgram_=a,o&&(this.applyFrameState(o),this.applyUniforms(o))}compileShader(a,o){const r=this.gl_,L=r.createShader(o);return r.shaderSource(L,a),r.compileShader(L),L}getProgram(a,o){const r=this.gl_,L=this.compileShader(a,r.FRAGMENT_SHADER),A=this.compileShader(o,r.VERTEX_SHADER),O=r.createProgram();if(r.attachShader(O,L),r.attachShader(O,A),r.linkProgram(O),!r.getShaderParameter(L,r.COMPILE_STATUS)){const u=`Fragment shader compilation failed: ${r.getShaderInfoLog(L)}`;throw new Error(u)}if(r.deleteShader(L),!r.getShaderParameter(A,r.COMPILE_STATUS)){const u=`Vertex shader compilation failed: ${r.getShaderInfoLog(A)}`;throw new Error(u)}if(r.deleteShader(A),!r.getProgramParameter(O,r.LINK_STATUS)){const u=`GL program linking failed: ${r.getProgramInfoLog(O)}`;throw new Error(u)}return O}getUniformLocation(a){const o=(0,K.v6)(this.currentProgram_);return this.uniformLocationsByProgram_[o]===void 0&&(this.uniformLocationsByProgram_[o]={}),this.uniformLocationsByProgram_[o][a]===void 0&&(this.uniformLocationsByProgram_[o][a]=this.gl_.getUniformLocation(this.currentProgram_,a)),this.uniformLocationsByProgram_[o][a]}getAttributeLocation(a){const o=(0,K.v6)(this.currentProgram_);return this.attribLocationsByProgram_[o]===void 0&&(this.attribLocationsByProgram_[o]={}),this.attribLocationsByProgram_[o][a]===void 0&&(this.attribLocationsByProgram_[o][a]=this.gl_.getAttribLocation(this.currentProgram_,a)),this.attribLocationsByProgram_[o][a]}makeProjectionTransform(a,o){const r=a.size,L=a.viewState.rotation,A=a.viewState.resolution,O=a.viewState.center;return(0,$.Zz)(o,0,0,2/(A*r[0]),2/(A*r[1]),-L,-O[0],-O[1]),o}setUniformFloatValue(a,o){this.gl_.uniform1f(this.getUniformLocation(a),o)}setUniformFloatVec2(a,o){this.gl_.uniform2fv(this.getUniformLocation(a),o)}setUniformFloatVec4(a,o){this.gl_.uniform4fv(this.getUniformLocation(a),o)}setUniformMatrixValue(a,o){this.gl_.uniformMatrix4fv(this.getUniformLocation(a),!1,o)}disableAllAttributes_(){for(let a=0;a<this.maxAttributeCount_;a++)this.gl_.disableVertexAttribArray(a)}enableAttributeArray_(a,o,r,L,A){const O=this.getAttributeLocation(a);O<0||(this.gl_.enableVertexAttribArray(O),this.gl_.vertexAttribPointer(O,o,r,!1,L,A))}enableAttributes(a){const o=R(a);let r=0;for(let L=0;L<a.length;L++){const A=a[L];this.enableAttributeArray_(A.name,A.size,A.type||l.zH,o,r),r+=A.size*b(A.type)}}handleWebGLContextLost(a){(0,p.I)(this.bufferCache_),this.currentProgram_=null,a.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(a,o,r,L){const A=this.gl_;r=r||A.createTexture();const O=L?A.NEAREST:A.LINEAR;A.bindTexture(A.TEXTURE_2D,r),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,O),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,O),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE);const u=0,x=A.RGBA,S=0,k=A.RGBA,tt=A.UNSIGNED_BYTE;return o instanceof Uint8Array?A.texImage2D(A.TEXTURE_2D,u,x,a[0],a[1],S,k,tt,o):o?A.texImage2D(A.TEXTURE_2D,u,x,k,tt,o):A.texImage2D(A.TEXTURE_2D,u,x,a[0],a[1],S,k,tt,null),r}}function R(W){let a=0;for(let o=0;o<W.length;o++){const r=W[o];a+=r.size*b(r.type)}return a}function b(W){switch(W){case c.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case c.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case c.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case c.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}const N=_},10277:(Ft,at,i)=>{i.d(at,{A:()=>$});var U=i(95801);class p extends U.A{constructor(d,E,l,y,P,g){super(d,E,P),this.originalEvent=l,this.pixel_=null,this.coordinate_=null,this.dragging=y!==void 0?y:!1,this.activePointers=g}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(d){this.pixel_=d}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(d){this.coordinate_=d}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const $=p},10940:(Ft,at,i)=>{i.d(at,{A:()=>K});var U=i(6782),p=i(4087);class ${constructor(E){this.opacity_=E.opacity,this.rotateWithView_=E.rotateWithView,this.rotation_=E.rotation,this.scale_=E.scale,this.scaleArray_=(0,U.xq)(E.scale),this.displacement_=E.displacement,this.declutterMode_=E.declutterMode}clone(){const E=this.getScale();return new $({opacity:this.getOpacity(),scale:Array.isArray(E)?E.slice():E,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return(0,p.b0)()}getImage(E){return(0,p.b0)()}getHitDetectionImage(){return(0,p.b0)()}getPixelRatio(E){return 1}getImageState(){return(0,p.b0)()}getImageSize(){return(0,p.b0)()}getOrigin(){return(0,p.b0)()}getSize(){return(0,p.b0)()}setDisplacement(E){this.displacement_=E}setOpacity(E){this.opacity_=E}setRotateWithView(E){this.rotateWithView_=E}setRotation(E){this.rotation_=E}setScale(E){this.scale_=E,this.scaleArray_=(0,U.xq)(E)}listenImageChange(E){(0,p.b0)()}load(){(0,p.b0)()}unlistenImageChange(E){(0,p.b0)()}ready(){return Promise.resolve()}}const K=$},10972:(Ft,at,i)=>{i.d(at,{A:()=>E});var U=i(82585),p=i(34120),$=i(9438),K=i(74238);class d extends p.A{constructor(y){super();const P=y.element;P&&!y.target&&!P.style.pointerEvents&&(P.style.pointerEvents="auto"),this.element=P||null,this.target_=null,this.map_=null,this.listenerKeys=[],y.render&&(this.render=y.render),y.target&&this.setTarget(y.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(y){this.map_&&this.element?.remove();for(let P=0,g=this.listenerKeys.length;P<g;++P)(0,$.JH)(this.listenerKeys[P]);if(this.listenerKeys.length=0,this.map_=y,y){const P=this.target_??y.getOverlayContainerStopEvent();this.element&&P.appendChild(this.element),this.render!==K.tV&&this.listenerKeys.push((0,$.KT)(y,U.A.POSTRENDER,this.render,this)),y.render()}}render(y){}setTarget(y){this.target_=typeof y=="string"?document.getElementById(y):y}}const E=d},11078:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},13326:(Ft,at,i)=>{i.d(at,{T:()=>g,e:()=>I});var U=i(74848),p=i(22803),$=i(16515),K=i(55386),d=i(92745),E=i(89640),l=i(63142),y=i(53049),P=i(16913);function g(e,c,G){const B=e.fields.filter((f,m)=>!f.config.custom?.hideFrom?.tooltip&&(G==null||m===G));if(B.length===0)return null;const w=[],T=[];for(const f of B){const m=f.values[c],_=f.display?f.display(m):{text:`${m}`,numeric:+m};T.push(...(0,P.u6)(f,c)),w.push({name:(0,$.Ct)(f,e),value:m,valueString:(0,K.cN)(_)})}return{displayValues:w,links:T}}const I=({data:e,rowIndex:c,header:G,padding:B=0})=>{const w=(0,l.of)(s,B);if(!e||c==null)return null;const T=g(e,c);if(T==null)return null;const{displayValues:f,links:m}=T;return(0,U.jsxs)("div",{className:w.wrapper,children:[G&&(0,U.jsx)("div",{className:w.header,children:(0,U.jsx)("span",{className:w.title,children:G})}),(0,U.jsx)("table",{className:w.infoWrap,children:(0,U.jsxs)("tbody",{children:[f.map((_,R)=>(0,U.jsxs)("tr",{children:[(0,U.jsx)("th",{children:_.name}),(0,U.jsx)("td",{children:(0,y.A)(_.valueString)})]},`${R}/${c}`)),m.map((_,R)=>(0,U.jsxs)("tr",{children:[(0,U.jsx)("th",{children:(0,U.jsx)(d.x6,{i18nKey:"visualization.data-hover-view.link",children:"Link"})}),(0,U.jsx)("td",{colSpan:2,children:(0,U.jsx)(E.Y,{href:_.href,external:_.target==="_blank",weight:"medium",inline:!1,children:_.title})})]},R))]})})]})},s=(e,c=0)=>({wrapper:(0,p.css)({padding:`${c}px`,background:e.components.tooltip.background,borderRadius:e.shape.borderRadius(2)}),header:(0,p.css)({background:e.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:e.spacing(1)}),title:(0,p.css)({fontWeight:e.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,p.css)({padding:e.spacing(1),background:"transparent",border:"none",th:{fontWeight:e.typography.fontWeightMedium,padding:e.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${e.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,p.css)({color:e.colors.text.link})})},13504:(Ft,at,i)=>{i.d(at,{A:()=>a});var U=i(49988),p=i(40190),$=i(91110),K=i(11078),d=i(66514),E=i(70915),l=i(43067),y=i(32963),P=i(6782),g=i(14969),I=i(40186),s=i(9703),e=i(4087),c=i(96769);function G(o,r,L,A,O){return`${(0,e.v6)(o)},${r},${(0,I.dp)(L,A,O)}`}function B(o,r,L){if(!(L in o))return o[L]=new Set([r]),!0;const A=o[L],O=A.has(r);return O||A.add(r),!O}function w(o,r,L){const A=o[L];return A?A.delete(r):!1}function T(o,r){const L=o.layerStatesArray[o.layerIndex];L.extent&&(r=(0,E._N)(r,(0,l.SD)(L.extent,o.viewState.projection)));const A=L.layer.getRenderSource();if(!A.getWrapX()){const O=A.getTileGridForProjection(o.viewState.projection).getExtent();O&&(r=(0,E._N)(r,O))}return r}class f extends c.A{constructor(r,L){super(r),L=L||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=(0,E.S5)(),this.tempTileRange_=new $.A(0,0,0,0),this.tempTileCoord_=(0,I.N)(0,0,0);const A=L.cacheSize!==void 0?L.cacheSize:512;this.tileCache_=new g.A(A),this.maxStaleKeys=A*.5}getTileCache(){return this.tileCache_}getOrCreateTile(r,L,A,O){const u=this.tileCache_,S=this.getLayer().getSource(),k=G(S,S.getKey(),r,L,A);let tt;if(u.containsKey(k))tt=u.get(k);else{if(tt=S.getTile(r,L,A,O.pixelRatio,O.viewState.projection),!tt)return null;u.set(k,tt)}return tt}getTile(r,L,A,O){const u=this.getOrCreateTile(r,L,A,O);return u||null}getData(r){const L=this.frameState;if(!L)return null;const A=this.getLayer(),O=(0,s.Bb)(L.pixelToCoordinateTransform,r.slice()),u=A.getExtent();if(u&&!(0,E.Ym)(u,O))return null;const x=L.viewState,S=A.getRenderSource(),k=S.getTileGridForProjection(x.projection),tt=S.getTilePixelRatio(L.pixelRatio);for(let ht=k.getZForResolution(x.resolution);ht>=k.getMinZoom();--ht){const dt=k.getTileCoordForCoordAndZ(O,ht),J=this.getTile(ht,dt[1],dt[2],L);if(!J||J.getState()!==K.A.LOADED)continue;const ft=k.getOrigin(ht),it=(0,P.xq)(k.getTileSize(ht)),st=k.getResolution(ht);let gt;if(J instanceof p.A||J instanceof y.A)gt=J.getImage();else if(J instanceof U.Ay){if(gt=(0,U.xo)(J.getData()),!gt)continue}else continue;const Ot=Math.floor(tt*((O[0]-ft[0])/st-dt[1]*it[0])),nt=Math.floor(tt*((ft[1]-O[1])/st-dt[2]*it[1])),et=Math.round(tt*S.getGutterForProjection(x.projection));return this.getImageData(gt,Ot+et,nt+et)}return null}prepareFrame(r){this.renderedProjection?r.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=r.viewState.projection):this.renderedProjection=r.viewState.projection;const L=this.getLayer().getSource();if(!L)return!1;const A=L.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==A&&(this.renderedSourceRevision_=A,this.renderedSourceKey_===L.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=A,!0}enqueueTiles(r,L,A,O,u){const x=r.viewState,S=this.getLayer(),k=S.getRenderSource(),tt=k.getTileGridForProjection(x.projection),ht=(0,e.v6)(k);ht in r.wantedTiles||(r.wantedTiles[ht]={});const dt=r.wantedTiles[ht],J=S.getMapInternal(),ft=Math.max(A-u,tt.getMinZoom(),tt.getZForResolution(Math.min(S.getMaxResolution(),J?J.getView().getResolutionForZoom(Math.max(S.getMinZoom(),0)):tt.getResolution(0)),k.zDirection)),it=x.rotation,st=it?(0,E.Yw)(x.center,x.resolution,it,r.size):void 0;for(let gt=A;gt>=ft;--gt){const Ot=tt.getTileRangeForExtentAndZ(L,gt,this.tempTileRange_),nt=tt.getResolution(gt);for(let et=Ot.minX;et<=Ot.maxX;++et)for(let Et=Ot.minY;Et<=Ot.maxY;++Et){if(it&&!tt.tileCoordIntersectsViewport([gt,et,Et],st))continue;const ut=this.getTile(gt,et,Et,r);if(!ut||!B(O,ut,gt))continue;const Mt=ut.getKey();if(dt[Mt]=!0,ut.getState()===K.A.IDLE&&!r.tileQueue.isKeyQueued(Mt)){const jt=(0,I.N)(gt,et,Et,this.tempTileCoord_);r.tileQueue.enqueue([ut,ht,tt.getTileCoordCenter(jt),nt])}}}}findStaleTile_(r,L){const A=this.tileCache_,O=r[0],u=r[1],x=r[2],S=this.getStaleKeys();for(let k=0;k<S.length;++k){const tt=G(this.getLayer().getSource(),S[k],O,u,x);if(A.containsKey(tt)){const ht=A.peek(tt);if(ht.getState()===K.A.LOADED)return ht.endTransition((0,e.v6)(this)),B(L,ht,O),!0}}return!1}findAltTiles_(r,L,A,O){const u=r.getTileRangeForTileCoordAndZ(L,A,this.tempTileRange_);if(!u)return!1;let x=!0;const S=this.tileCache_,k=this.getLayer().getRenderSource(),tt=k.getKey();for(let ht=u.minX;ht<=u.maxX;++ht)for(let dt=u.minY;dt<=u.maxY;++dt){const J=G(k,tt,A,ht,dt);let ft=!1;if(S.containsKey(J)){const it=S.peek(J);it.getState()===K.A.LOADED&&(B(O,it,A),ft=!0)}ft||(x=!1)}return x}renderFrame(r,L){this.renderComplete=!0;const A=r.layerStatesArray[r.layerIndex],O=r.viewState,u=O.projection,x=O.resolution,S=O.center,k=r.pixelRatio,tt=this.getLayer(),ht=tt.getSource(),dt=ht.getTileGridForProjection(u),J=dt.getZForResolution(x,ht.zDirection),ft=dt.getResolution(J),it=ht.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==it&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=it):this.renderedSourceKey_=it;let st=r.extent;const gt=ht.getTilePixelRatio(k);this.prepareContainer(r,L);const Ot=this.context.canvas.width,nt=this.context.canvas.height,et=A.extent&&(0,l.SD)(A.extent,u);et&&(st=(0,E._N)(st,(0,l.SD)(A.extent,u)));const Et=ft*Ot/2/gt,ut=ft*nt/2/gt,Rt=[S[0]-Et,S[1]-ut,S[0]+Et,S[1]+ut],Mt={};this.renderedTiles.length=0;const jt=tt.getPreload();if(r.nextExtent){const Xt=dt.getZForResolution(O.nextResolution,ht.zDirection),ee=T(r,r.nextExtent);this.enqueueTiles(r,ee,Xt,Mt,jt)}const ie=T(r,st);if(this.enqueueTiles(r,ie,J,Mt,0),jt>0&&setTimeout(()=>{this.enqueueTiles(r,ie,J-1,Mt,jt-1)},0),!(J in Mt))return this.container;const Qt=(0,e.v6)(this),Y=r.time;for(const Xt of Mt[J]){const ee=Xt.getState();if(ee===K.A.EMPTY)continue;const ne=Xt.tileCoord;if(ee===K.A.LOADED&&Xt.getAlpha(Qt,Y)===1){Xt.endTransition(Qt);continue}if(ee!==K.A.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ne,Mt)){w(Mt,Xt,J),r.animate=!0;continue}if(this.findAltTiles_(dt,ne,J+1,Mt))continue;const Kt=dt.getMinZoom();for(let Ce=J-1;Ce>=Kt&&!this.findAltTiles_(dt,ne,Ce,Mt);--Ce);}const H=ft/x*k/gt,q=this.getRenderContext(r);(0,s.Zz)(this.tempTransform,Ot/2,nt/2,H,H,0,-Ot/2,-nt/2),A.extent&&this.clipUnrotated(q,r,et),ht.getInterpolate()||(q.imageSmoothingEnabled=!1),this.preRender(q,r);const Lt=Object.keys(Mt).map(Number);Lt.sort(d.V_);let Dt;const zt=[],Yt=[];for(let Xt=Lt.length-1;Xt>=0;--Xt){const ee=Lt[Xt],ne=ht.getTilePixelSize(ee,k,u),ue=dt.getResolution(ee)/ft,Kt=ne[0]*ue*H,Ce=ne[1]*ue*H,de=dt.getTileCoordForCoordAndZ((0,E.Py)(Rt),ee),V=dt.getTileCoordExtent(de),F=(0,s.Bb)(this.tempTransform,[gt*(V[0]-Rt[0])/ft,gt*(Rt[3]-V[3])/ft]),lt=gt*ht.getGutterForProjection(u);for(const mt of Mt[ee]){if(mt.getState()!==K.A.LOADED)continue;const It=mt.tileCoord,Nt=de[1]-It[1],St=Math.round(F[0]-(Nt-1)*Kt),Zt=de[2]-It[2],qt=Math.round(F[1]-(Zt-1)*Ce),At=Math.round(F[0]-Nt*Kt),kt=Math.round(F[1]-Zt*Ce),Wt=St-At,oe=qt-kt,te=Lt.length===1;let _e=!1;Dt=[At,kt,At+Wt,kt,At+Wt,kt+oe,At,kt+oe];for(let ye=0,Pe=zt.length;ye<Pe;++ye)if(!te&&ee<Yt[ye]){const Te=zt[ye];(0,E.HY)([At,kt,At+Wt,kt+oe],[Te[0],Te[3],Te[4],Te[7]])&&(_e||(q.save(),_e=!0),q.beginPath(),q.moveTo(Dt[0],Dt[1]),q.lineTo(Dt[2],Dt[3]),q.lineTo(Dt[4],Dt[5]),q.lineTo(Dt[6],Dt[7]),q.moveTo(Te[6],Te[7]),q.lineTo(Te[4],Te[5]),q.lineTo(Te[2],Te[3]),q.lineTo(Te[0],Te[1]),q.clip())}zt.push(Dt),Yt.push(ee),this.drawTile(mt,r,At,kt,Wt,oe,lt,te),_e&&q.restore(),this.renderedTiles.unshift(mt),this.updateUsedTiles(r.usedTiles,ht,mt)}}if(this.renderedResolution=ft,this.extentChanged=!this.renderedExtent_||!(0,E.aI)(this.renderedExtent_,Rt),this.renderedExtent_=Rt,this.renderedPixelRatio=k,this.postRender(this.context,r),A.extent&&q.restore(),q.imageSmoothingEnabled=!0,this.renderComplete){const Xt=(ee,ne)=>{const Jt=(0,e.v6)(ht),ue=ne.wantedTiles[Jt],Kt=ue?Object.keys(ue).length:0;this.updateCacheSize(Kt),this.tileCache_.expireCache()};r.postRenderFunctions.push(Xt)}return this.container}updateCacheSize(r){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,r*2)}drawTile(r,L,A,O,u,x,S,k){let tt;if(r instanceof U.Ay){if(tt=(0,U.xo)(r.getData()),!tt)throw new Error("Rendering array data is not yet supported")}else tt=this.getTileImage(r);if(!tt)return;const ht=this.getRenderContext(L),dt=(0,e.v6)(this),J=L.layerStatesArray[L.layerIndex],ft=J.opacity*(k?r.getAlpha(dt,L.time):1),it=ft!==ht.globalAlpha;it&&(ht.save(),ht.globalAlpha=ft),ht.drawImage(tt,S,S,tt.width-2*S,tt.height-2*S,A,O,u,x),it&&ht.restore(),ft!==J.opacity?L.animate=!0:k&&r.endTransition(dt)}getImage(){const r=this.context;return r?r.canvas:null}getTileImage(r){return r.getImage()}updateUsedTiles(r,L,A){const O=(0,e.v6)(L);O in r||(r[O]={}),r[O][A.getKey()]=!0}}const m=f;var _=i(60764);const R={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class b extends _.A{constructor(r){r=r||{};const L=Object.assign({},r),A=r.cacheSize;delete r.cacheSize,delete L.preload,delete L.useInterimTilesOnError,super(L),this.on,this.once,this.un,this.cacheSize_=A,this.setPreload(r.preload!==void 0?r.preload:0),this.setUseInterimTilesOnError(r.useInterimTilesOnError!==void 0?r.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(R.PRELOAD)}setPreload(r){this.set(R.PRELOAD,r)}getUseInterimTilesOnError(){return this.get(R.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(r){this.set(R.USE_INTERIM_TILES_ON_ERROR,r)}getData(r){return super.getData(r)}}const N=b;class W extends N{constructor(r){super(r)}createRenderer(){return new m(this,{cacheSize:this.getCacheSize()})}}const a=W},13628:(Ft,at,i)=>{i.d(at,{A:()=>E});var U=i(6141),p=i(89352),$=i(4087),K=i(97907);class d{constructor(y){y=y||{},this.patternImage_=null,this.color_=null,y.color!==void 0&&this.setColor(y.color)}clone(){const y=this.getColor();return new d({color:Array.isArray(y)?y.slice():y||void 0})}getColor(){return this.color_}setColor(y){if(y!==null&&typeof y=="object"&&"src"in y){const P=(0,K.J)(null,y.src,"anonymous",void 0,y.offset?null:y.color?y.color:null,!(y.offset&&y.size));P.ready().then(()=>{this.patternImage_=null}),P.getImageState()===U.A.IDLE&&P.load(),P.getImageState()===U.A.LOADING&&(this.patternImage_=P)}this.color_=y}getKey(){const y=this.getColor();return y?y instanceof CanvasPattern||y instanceof CanvasGradient?(0,$.v6)(y):typeof y=="object"&&"src"in y?y.src+":"+y.offset:(0,p._j)(y).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}const E=d},14969:(Ft,at,i)=>{i.d(at,{A:()=>K});var U=i(90025),p=i(90588);class ${constructor(E){this.highWaterMark=E!==void 0?E:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const E=this.pop();E instanceof U.A&&E.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(E){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(E){return this.entries_.hasOwnProperty(E)}forEach(E){let l=this.oldest_;for(;l;)E(l.value_,l.key_,this),l=l.newer}get(E,l){const y=this.entries_[E];return(0,p.v)(y!==void 0,"Tried to get a value for a key that does not exist in the cache"),y===this.newest_||(y===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(y.newer.older=y.older,y.older.newer=y.newer),y.newer=null,y.older=this.newest_,this.newest_.newer=y,this.newest_=y),y.value_}remove(E){const l=this.entries_[E];return(0,p.v)(l!==void 0,"Tried to get a value for a key that does not exist in the cache"),l===this.newest_?(this.newest_=l.older,this.newest_&&(this.newest_.newer=null)):l===this.oldest_?(this.oldest_=l.newer,this.oldest_&&(this.oldest_.older=null)):(l.newer.older=l.older,l.older.newer=l.newer),delete this.entries_[E],--this.count_,l.value_}getCount(){return this.count_}getKeys(){const E=new Array(this.count_);let l=0,y;for(y=this.newest_;y;y=y.older)E[l++]=y.key_;return E}getValues(){const E=new Array(this.count_);let l=0,y;for(y=this.newest_;y;y=y.older)E[l++]=y.value_;return E}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(E){return this.entries_[E]?.value_}pop(){const E=this.oldest_;return delete this.entries_[E.key_],E.newer&&(E.newer.older=null),this.oldest_=E.newer,this.oldest_||(this.newest_=null),--this.count_,E.value_}replace(E,l){this.get(E),this.entries_[E].value_=l}set(E,l){(0,p.v)(!(E in this.entries_),"Tried to set a value for a key that is used already");const y={key_:E,newer:null,older:this.newest_,value_:l};this.newest_?this.newest_.newer=y:this.oldest_=y,this.newest_=y,this.entries_[E]=y,++this.count_}setSize(E){this.highWaterMark=E}}const K=$},16913:(Ft,at,i)=>{i.d(at,{OG:()=>K,u6:()=>p});var U=i(73163);const p=(d,E)=>{const l=[];if((d.config.links?.length??0)>0&&d.getLinks!=null){const y=d.values[E],P=d.display?d.display(y):{text:`${y}`,numeric:+y},g=new Set;d.getLinks({calculatedValue:P,valueRowIndex:E}).forEach(I=>{const s=`${I.title}/${I.href}`;g.has(s)||(l.push(I),g.add(s))})}return l},$=d=>{},K=(d,E,l,y)=>{const P=[],g=new Set;return(0,U.ko)(d,E,E.state.scopedVars,l,E.config.actions??[],{valueRowIndex:y}).forEach(s=>{const e=`${s.title}`;g.has(e)||(P.push(s),g.add(e))}),P}},20259:(Ft,at,i)=>{i.d(at,{Ay:()=>E});var U=i(90588),p=i(90130);const $={STATIC_DRAW:p.Ek,STREAM_DRAW:p.Ss,DYNAMIC_DRAW:p.Be};class K{constructor(y,P){this.array_=null,this.type_=y,(0,U.v)(y===p.H7||y===p.IP,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=P!==void 0?P:$.STATIC_DRAW}ofSize(y){return this.array_=new(d(this.type_))(y),this}fromArray(y){return this.array_=d(this.type_).from(y),this}fromArrayBuffer(y){return this.array_=new(d(this.type_))(y),this}getType(){return this.type_}getArray(){return this.array_}setArray(y){const P=d(this.type_);if(!(y instanceof P))throw new Error(`Expected ${P}`);this.array_=y}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function d(l){switch(l){case p.H7:return Float32Array;case p.IP:return Uint32Array;default:return Float32Array}}const E=K},21409:(Ft,at,i)=>{i.d(at,{A:()=>d,v:()=>K});var U=i(73445),p=i(6292);class $ extends p.Ay{constructor(l){l=l||{},super(l),l.handleDownEvent&&(this.handleDownEvent=l.handleDownEvent),l.handleDragEvent&&(this.handleDragEvent=l.handleDragEvent),l.handleMoveEvent&&(this.handleMoveEvent=l.handleMoveEvent),l.handleUpEvent&&(this.handleUpEvent=l.handleUpEvent),l.stopDown&&(this.stopDown=l.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(l){return!1}handleDragEvent(l){}handleEvent(l){if(!l.originalEvent)return!0;let y=!1;if(this.updateTrackedPointers_(l),this.handlingDownUpSequence){if(l.type==U.A.POINTERDRAG)this.handleDragEvent(l),l.originalEvent.preventDefault();else if(l.type==U.A.POINTERUP){const P=this.handleUpEvent(l);this.handlingDownUpSequence=P&&this.targetPointers.length>0}}else if(l.type==U.A.POINTERDOWN){const P=this.handleDownEvent(l);this.handlingDownUpSequence=P,y=this.stopDown(P)}else l.type==U.A.POINTERMOVE&&this.handleMoveEvent(l);return!y}handleMoveEvent(l){}handleUpEvent(l){return!1}stopDown(l){return l}updateTrackedPointers_(l){l.activePointers&&(this.targetPointers=l.activePointers)}}function K(E){const l=E.length;let y=0,P=0;for(let g=0;g<l;g++)y+=E[g].clientX,P+=E[g].clientY;return{clientX:y/l,clientY:P/l}}const d=$},24498:(Ft,at,i)=>{i.d(at,{a$:()=>K,b8:()=>p,cq:()=>d,dv:()=>$});var U=i(61597);function p(E){if(E!==void 0)return 0}function $(E){if(E!==void 0)return E}function K(E){const l=2*Math.PI/E;return function(y,P){if(P)return y;if(y!==void 0)return y=Math.floor(y/l+.5)*l,y}}function d(E){const l=E===void 0?(0,U.eh)(5):E;return function(y,P){return P||y===void 0?y:Math.abs(y)<=l?0:y}}},25176:(Ft,at,i)=>{i.d(at,{$N:()=>d,K5:()=>g,NM:()=>P,Si:()=>U,XI:()=>$,nT:()=>E});const U="ol-hidden",p="ol-selectable",$="ol-unselectable",K="ol-unsupported",d="ol-control",E="ol-collapsed",l=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),y=["style","variant","weight","size","lineHeight","family"],P={normal:400,bold:700},g=function(I){const s=I.match(l);if(!s)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let c=0,G=y.length;c<G;++c){const B=s[c+1];B!==void 0&&(e[y[c]]=typeof B=="string"?B.trim():B)}return isNaN(Number(e.weight))&&e.weight in P&&(e.weight=P[e.weight]),e.families=e.family.split(/,\s?/).map(c=>c.trim().replace(/^['"]|['"]$/g,"")),e}},25847:(Ft,at,i)=>{i.d(at,{L$:()=>ee,M7:()=>ne,t7:()=>Jt,nR:()=>ue,VO:()=>ie,Lm:()=>q,z0:()=>zt,$R:()=>Mt,Tl:()=>Lt,Sl:()=>Dt});var U=i(89352),p=i(11078),$=i(70915),K=i(43067),d=i(6782),E=i(9703),l=i(83954),y=i(20259),P=i(9777),g=i(49988),I=i(40190),s=i(68711),e=i(32963),c=i(90130),G=i(6837),B=i(79332),w=i(4087);class T extends B.A{constructor(F){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter=F.gutter||0,this.helper=F.helper,this.loaded=!1,this.ready=!1}setTile(F){if(F!==this.tile)if(this.tile&&this.tile.removeEventListener(G.A.CHANGE,this.handleTileChange_),this.tile=F,this.loaded=F.getState()===p.A.LOADED,this.loaded)this.uploadTile();else{if(F instanceof I.A){const lt=F.getImage();lt instanceof Image&&!lt.crossOrigin&&(lt.crossOrigin="anonymous")}F.addEventListener(G.A.CHANGE,this.handleTileChange_)}}uploadTile(){(0,w.b0)()}setReady(){this.ready=!0,this.dispatchEvent(G.A.CHANGE)}handleTileChange_(){this.tile.getState()===p.A.LOADED&&(this.loaded=!0,this.uploadTile())}setHelper(F){this.helper=F,this.helper&&this.loaded&&this.uploadTile()}disposeInternal(){this.setHelper(null),this.tile.removeEventListener(G.A.CHANGE,this.handleTileChange_)}}const f=T;function m(V,F,lt){const mt=lt?V.LINEAR:V.NEAREST;V.bindTexture(V.TEXTURE_2D,F),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,mt),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,mt)}function _(V,F,lt,mt){m(V,F,mt),V.texImage2D(V.TEXTURE_2D,0,V.RGBA,V.RGBA,V.UNSIGNED_BYTE,lt)}function R(V,F,lt,mt,It,Nt){const St=V.getGL();let Zt,qt;lt instanceof Float32Array?(Zt=St.FLOAT,V.getExtension("OES_texture_float"),qt=V.getExtension("OES_texture_float_linear")!==null):(Zt=St.UNSIGNED_BYTE,qt=!0),m(St,F,Nt&&qt);const At=lt.byteLength/mt[1];let kt=1;At%8===0?kt=8:At%4===0?kt=4:At%2===0&&(kt=2);let Wt;switch(It){case 1:{Wt=St.LUMINANCE;break}case 2:{Wt=St.LUMINANCE_ALPHA;break}case 3:{Wt=St.RGB;break}case 4:{Wt=St.RGBA;break}default:throw new Error(`Unsupported number of bands: ${It}`)}const oe=St.getParameter(St.UNPACK_ALIGNMENT);St.pixelStorei(St.UNPACK_ALIGNMENT,kt),St.texImage2D(St.TEXTURE_2D,0,Wt,mt[0],mt[1],0,Wt,Zt,lt),St.pixelStorei(St.UNPACK_ALIGNMENT,oe)}let b=null;function N(){b=(0,s.Y)(1,1,void 0,{willReadFrequently:!0})}class W extends f{constructor(F){super(F),this.textures=[],this.renderSize_=(0,d.xq)(F.grid.getTileSize(F.tile.tileCoord[0])),this.bandCount=NaN;const lt=new y.Ay(c.H7,c.Ek);lt.fromArray([0,1,1,1,1,0,0,0]),this.helper.flushBufferData(lt),this.coords=lt,this.setTile(F.tile)}setHelper(F){const lt=this.helper?.getGL();if(lt){this.helper.deleteBuffer(this.coords);for(let mt=0;mt<this.textures.length;++mt)lt.deleteTexture(this.textures[mt])}super.setHelper(F),F&&F.flushBufferData(this.coords)}uploadTile(){const F=this.helper,lt=F.getGL(),mt=this.tile;this.textures.length=0;let It;mt instanceof I.A||mt instanceof e.A?It=mt.getImage():It=mt.getData();const Nt=(0,g.xo)(It);if(Nt){const he=lt.createTexture();this.textures.push(he),this.bandCount=4,_(lt,he,Nt,mt.interpolate),this.setReady();return}It=(0,g.bL)(It);const St=mt.getSize(),Zt=[St[0]+2*this.gutter,St[1]+2*this.gutter],qt=It instanceof Float32Array,At=Zt[0]*Zt[1],kt=qt?Float32Array:Uint8Array,Wt=kt.BYTES_PER_ELEMENT,oe=It.byteLength/Zt[1];this.bandCount=Math.floor(oe/Wt/Zt[0]);const te=Math.ceil(this.bandCount/4);if(te===1){const he=lt.createTexture();this.textures.push(he),R(F,he,It,Zt,this.bandCount,mt.interpolate),this.setReady();return}const _e=new Array(te);for(let he=0;he<te;++he){const le=lt.createTexture();this.textures.push(le);const ve=he<te-1?4:(this.bandCount-1)%4+1;_e[he]=new kt(At*ve)}let ye=0,Pe=0;const Te=Zt[0]*this.bandCount;for(let he=0;he<Zt[1];++he){for(let le=0;le<Te;++le){const ve=It[Pe+le],Ee=Math.floor(ye/this.bandCount),pt=le%this.bandCount,t=Math.floor(pt/4),h=_e[t],v=h.length/At,C=pt%4;h[Ee*v+C]=ve,++ye}Pe+=oe/Wt}for(let he=0;he<te;++he){const le=this.textures[he],ve=_e[he],Ee=ve.length/At;R(F,le,ve,Zt,Ee,mt.interpolate)}this.setReady()}getImagePixelData_(F,lt,mt){const It=this.gutter,Nt=this.renderSize_[0],St=this.renderSize_[1];b||N(),b.clearRect(0,0,1,1);const Zt=F.width,qt=F.height,At=Zt-2*It,kt=qt-2*It,Wt=It+Math.floor(At*(lt/Nt)),oe=It+Math.floor(kt*(mt/St));let te;try{b.drawImage(F,Wt,oe,1,1,0,0,1,1),te=b.getImageData(0,0,1,1).data}catch{return b=null,null}return te}getArrayPixelData_(F,lt,mt,It){const Nt=this.gutter,St=this.renderSize_[0],Zt=this.renderSize_[1],qt=lt[0],At=lt[1],kt=qt+2*Nt,Wt=At+2*Nt,oe=Nt+Math.floor(qt*(mt/St)),te=Nt+Math.floor(At*(It/Zt));if(F instanceof DataView){const ye=F.byteLength/(kt*Wt),Pe=ye*(te*kt+oe),Te=F.buffer.slice(Pe,Pe+ye);return new DataView(Te)}const _e=this.bandCount*(te*kt+oe);return F.slice(_e,_e+this.bandCount)}getPixelData(F,lt){if(!this.loaded)return null;if(this.tile instanceof g.Ay){const mt=this.tile.getData(),It=(0,g.bL)(mt);if(It){const Nt=this.tile.getSize();return this.getArrayPixelData_(It,Nt,F,lt)}return this.getImagePixelData_((0,g.xo)(mt),F,lt)}return this.getImagePixelData_(this.tile.getImage(),F,lt)}}const a=W;var o=i(91110),r=i(66514),L=i(14969),A=i(40186),O=i(38111);const u={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"};function x(V){return 1/(V+2)}function S(){return{tileIds:new Set,representationsByZ:{}}}function k(V,F){return V.tileIds.has((0,w.v6)(F))}function tt(V,F,lt){const mt=V.representationsByZ;lt in mt||(mt[lt]=new Set),mt[lt].add(F),V.tileIds.add((0,w.v6)(F.tile))}function ht(V,F){const lt=V.layerStatesArray[V.layerIndex];lt.extent&&(F=(0,$._N)(F,(0,K.SD)(lt.extent,V.viewState.projection)));const mt=lt.layer.getRenderSource();if(!mt.getWrapX()){const It=mt.getTileGridForProjection(V.viewState.projection).getExtent();It&&(F=(0,$._N)(F,It))}return F}function dt(V,F){return`${(0,w.v6)(V)},${V.getKey()},${V.getRevision()},${(0,A.i7)(F)}`}class J extends O.A{constructor(F,lt){super(F,{uniforms:lt.uniforms,postProcesses:lt.postProcesses}),this.renderComplete=!1,this.tileTransform_=(0,E.vt)(),this.tempMat4=(0,l.vt)(),this.tempTileRange_=new o.A(0,0,0,0),this.tempTileCoord_=(0,A.N)(0,0,0),this.tempSize_=[0,0];const mt=lt.cacheSize!==void 0?lt.cacheSize:512;this.tileRepresentationCache=new L.A(mt),this.frameState=null,this.renderedProjection_=void 0}reset(F){super.reset({uniforms:F.uniforms})}prepareFrameInternal(F){this.renderedProjection_?F.viewState.projection!==this.renderedProjection_&&(this.clearCache(),this.renderedProjection_=F.viewState.projection):this.renderedProjection_=F.viewState.projection;const mt=this.getLayer().getRenderSource();return!mt||(0,$.Im)(ht(F,F.extent))?!1:mt.getState()==="ready"}createTileRepresentation(F){return(0,w.b0)()}enqueueTiles(F,lt,mt,It,Nt){const St=F.viewState,Zt=this.getLayer(),qt=Zt.getRenderSource(),At=qt.getTileGridForProjection(St.projection),kt=qt.getGutterForProjection(St.projection),Wt=(0,w.v6)(qt);Wt in F.wantedTiles||(F.wantedTiles[Wt]={});const oe=F.wantedTiles[Wt],te=this.tileRepresentationCache,_e=Zt.getMapInternal(),ye=Math.max(mt-Nt,At.getMinZoom(),At.getZForResolution(Math.min(Zt.getMaxResolution(),_e?_e.getView().getResolutionForZoom(Math.max(Zt.getMinZoom(),0)):At.getResolution(0)),qt.zDirection)),Pe=St.rotation,Te=Pe?(0,$.Yw)(St.center,St.resolution,Pe,F.size):void 0;for(let he=mt;he>=ye;--he){const le=At.getTileRangeForExtentAndZ(lt,he,this.tempTileRange_),ve=At.getResolution(he);for(let Ee=le.minX;Ee<=le.maxX;++Ee)for(let pt=le.minY;pt<=le.maxY;++pt){if(Pe&&!At.tileCoordIntersectsViewport([he,Ee,pt],Te))continue;const t=(0,A.N)(he,Ee,pt,this.tempTileCoord_),h=dt(qt,t);let v,C;if(te.containsKey(h)&&(v=te.get(h),C=v.tile),(!v||v.tile.key!==qt.getKey())&&(C=qt.getTile(he,Ee,pt,F.pixelRatio,St.projection),!C)||k(It,C))continue;v?v.setTile(C):(v=this.createTileRepresentation({tile:C,grid:At,helper:this.helper,gutter:kt}),te.set(h,v)),tt(It,v,he);const j=C.getKey();oe[j]=!0,C.getState()===p.A.IDLE&&(F.tileQueue.isKeyQueued(j)||F.tileQueue.enqueue([C,Wt,At.getTileCoordCenter(t),ve]))}}}beforeTilesRender(F,lt){this.helper.prepareDraw(this.frameState,!lt,!0)}beforeTilesMaskRender(F){return!1}renderTile(F,lt,mt,It,Nt,St,Zt,qt,At,kt,Wt){}renderTileMask(F,lt,mt,It){}drawTile_(F,lt,mt,It,Nt,St,Zt){if(!lt.ready)return;const At=lt.tile.tileCoord,kt=(0,A.i7)(At),Wt=kt in St?St[kt]:1,oe=Zt.getResolution(mt),te=(0,d.xq)(Zt.getTileSize(mt),this.tempSize_),_e=Zt.getOrigin(mt),ye=Zt.getTileCoordExtent(At),Pe=Wt<1?-1:x(mt);Wt<1&&(F.animate=!0);const Te=F.viewState,he=Te.center[0],le=Te.center[1],ve=te[0]+2*It,Ee=te[1]+2*It,pt=ve/Ee,t=(he-_e[0])/(te[0]*oe),h=(_e[1]-le)/(te[1]*oe),v=Te.resolution/oe,C=At[1],j=At[2];(0,E.cL)(this.tileTransform_),(0,E.hs)(this.tileTransform_,2/(F.size[0]*v/ve),-2/(F.size[1]*v/ve)),(0,E.e$)(this.tileTransform_,Te.rotation),(0,E.hs)(this.tileTransform_,1,1/pt),(0,E.Tl)(this.tileTransform_,(te[0]*(C-t)-It)/ve,(te[1]*(j-h)-It)/Ee),this.renderTile(lt,this.tileTransform_,F,Nt,oe,te,_e,ye,Pe,It,Wt)}renderFrame(F){this.frameState=F,this.renderComplete=!0;const lt=this.helper.getGL();this.preRender(lt,F);const mt=F.viewState,It=this.getLayer(),Nt=It.getRenderSource(),St=Nt.getTileGridForProjection(mt.projection),Zt=Nt.getGutterForProjection(mt.projection),qt=ht(F,F.extent),At=St.getZForResolution(mt.resolution,Nt.zDirection),kt=S(),Wt=It.getPreload();if(F.nextExtent){const le=St.getZForResolution(mt.nextResolution,Nt.zDirection),ve=ht(F,F.nextExtent);this.enqueueTiles(F,ve,le,kt,Wt)}this.enqueueTiles(F,qt,At,kt,0),Wt>0&&setTimeout(()=>{this.enqueueTiles(F,qt,At-1,kt,Wt-1)},0);const oe={};let te=!1;const _e=kt.representationsByZ;if(At in _e){const le=(0,w.v6)(this),ve=F.time;for(const Ee of _e[At]){const pt=Ee.tile;if(pt.getState()===p.A.EMPTY)continue;const t=pt.tileCoord;if(Ee.ready){const C=pt.getAlpha(le,ve);if(C===1){pt.endTransition(le);continue}te=!0;const j=(0,A.i7)(t);oe[j]=C}if(this.renderComplete=!1,this.findAltTiles_(St,t,At+1,kt))continue;const v=St.getMinZoom();for(let C=At-1;C>=v&&!this.findAltTiles_(St,t,C,kt);--C);}}const ye=Object.keys(_e).map(Number).sort(r.rG);if(this.beforeTilesMaskRender(F))for(let le=0,ve=ye.length;le<ve;++le){const Ee=ye[le];for(const pt of _e[Ee]){const t=pt.tile.tileCoord;if((0,A.i7)(t)in oe)continue;const v=St.getTileCoordExtent(t);this.renderTileMask(pt,Ee,v,x(Ee))}}this.beforeTilesRender(F,te);for(let le=0,ve=ye.length;le<ve;++le){const Ee=ye[le];for(const pt of _e[Ee]){const t=pt.tile.tileCoord;(0,A.i7)(t)in oe||this.drawTile_(F,pt,Ee,Zt,qt,oe,St)}}if(At in _e)for(const le of _e[At]){const ve=le.tile.tileCoord;(0,A.i7)(ve)in oe&&this.drawTile_(F,le,At,Zt,qt,oe,St)}this.beforeFinalize(F),this.helper.finalizeDraw(F,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const Te=this.helper.getCanvas(),he=this.tileRepresentationCache;for(;he.canExpireCache();)he.pop().dispose();return this.postRender(lt,F),Te}beforeFinalize(F){}findAltTiles_(F,lt,mt,It){const Nt=F.getTileRangeForTileCoordAndZ(lt,mt,this.tempTileRange_);if(!Nt)return!1;let St=!0;const Zt=this.tileRepresentationCache,qt=this.getLayer().getRenderSource();for(let At=Nt.minX;At<=Nt.maxX;++At)for(let kt=Nt.minY;kt<=Nt.maxY;++kt){const Wt=dt(qt,[mt,At,kt]);let oe=!1;if(Zt.containsKey(Wt)){const te=Zt.get(Wt);te.ready&&!k(It,te.tile)&&(tt(It,te,mt),oe=!0)}oe||(St=!1)}return St}clearCache(){super.clearCache();const F=this.tileRepresentationCache;F.forEach(lt=>lt.dispose()),F.clear()}afterHelperCreated(){super.afterHelperCreated(),this.tileRepresentationCache.forEach(F=>F.setHelper(this.helper))}disposeInternal(){super.disposeInternal(),delete this.frameState}}const ft=J,it={...u,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"},gt=[{name:{TEXTURE_COORD:"a_textureCoord"}.TEXTURE_COORD,size:2,type:P.jQ.FLOAT}];class Ot extends ft{constructor(F,lt){super(F,lt),this.program_,this.vertexShader_=lt.vertexShader,this.fragmentShader_=lt.fragmentShader,this.indices_=new y.Ay(c.IP,c.Ek),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=lt.paletteTextures||[]}reset(F){if(super.reset(F),this.helper){const lt=this.helper.getGL();for(const mt of this.paletteTextures_)mt.delete(lt)}if(this.vertexShader_=F.vertexShader,this.fragmentShader_=F.fragmentShader,this.paletteTextures_=F.paletteTextures||[],this.helper){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_);const lt=this.helper.getGL();for(const mt of this.paletteTextures_)mt.getTexture(lt)}}afterHelperCreated(){super.afterHelperCreated();const F=this.helper.getGL();for(const lt of this.paletteTextures_)lt.getTexture(F);this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}removeHelper(){if(this.helper){const F=this.helper.getGL();for(const lt of this.paletteTextures_)lt.delete(F)}super.removeHelper()}createTileRepresentation(F){return new a(F)}beforeTilesRender(F,lt){super.beforeTilesRender(F,lt),this.helper.useProgram(this.program_,F)}renderTile(F,lt,mt,It,Nt,St,Zt,qt,At,kt,Wt){const oe=this.helper.getGL();this.helper.bindBuffer(F.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(gt);let te=0;for(;te<F.textures.length;){const pt=`${it.TILE_TEXTURE_ARRAY}[${te}]`;this.helper.bindTexture(F.textures[te],te,pt),++te}for(let pt=0;pt<this.paletteTextures_.length;++pt){const t=this.paletteTextures_[pt],h=t.getTexture(oe);this.helper.bindTexture(h,te,t.name),++te}const _e=mt.viewState,ye=St[0]+2*kt,Pe=St[1]+2*kt,he=F.tile.tileCoord,le=he[1],ve=he[2];this.helper.setUniformMatrixValue(it.TILE_TRANSFORM,(0,l.Z1)(this.tempMat4,lt)),this.helper.setUniformFloatValue(it.TRANSITION_ALPHA,Wt),this.helper.setUniformFloatValue(it.DEPTH,At);let Ee=It;kt>0&&(Ee=qt,(0,$._N)(Ee,It,Ee)),this.helper.setUniformFloatVec4(it.RENDER_EXTENT,Ee),this.helper.setUniformFloatValue(it.RESOLUTION,_e.resolution),this.helper.setUniformFloatValue(it.ZOOM,_e.zoom),this.helper.setUniformFloatValue(it.TEXTURE_PIXEL_WIDTH,ye),this.helper.setUniformFloatValue(it.TEXTURE_PIXEL_HEIGHT,Pe),this.helper.setUniformFloatValue(it.TEXTURE_RESOLUTION,Nt),this.helper.setUniformFloatValue(it.TEXTURE_ORIGIN_X,Zt[0]+le*St[0]*Nt-kt*Nt),this.helper.setUniformFloatValue(it.TEXTURE_ORIGIN_Y,Zt[1]-ve*St[1]*Nt+kt*Nt),this.helper.drawElements(0,this.indices_.getSize())}getData(F){if(!this.helper.getGL())return null;const mt=this.frameState;if(!mt)return null;const It=this.getLayer(),Nt=(0,E.Bb)(mt.pixelToCoordinateTransform,F.slice()),St=mt.viewState,Zt=It.getExtent();if(Zt&&!(0,$.Ym)((0,K.SD)(Zt,St.projection),Nt))return null;const qt=It.getSources((0,$.Tr)([Nt]),St.resolution);let At,kt,Wt;for(At=qt.length-1;At>=0;--At)if(kt=qt[At],kt.getState()==="ready"){if(Wt=kt.getTileGridForProjection(St.projection),kt.getWrapX())break;const te=Wt.getExtent();if(!te||(0,$.Ym)(te,Nt))break}if(At<0)return null;const oe=this.tileRepresentationCache;for(let te=Wt.getZForResolution(St.resolution);te>=Wt.getMinZoom();--te){const _e=Wt.getTileCoordForCoordAndZ(Nt,te),ye=dt(kt,_e);if(!oe.containsKey(ye))continue;const Pe=oe.get(ye);if(Pe.tile.getState()===p.A.EMPTY)return null;if(!Pe.loaded)continue;const he=Wt.getOrigin(te),le=(0,d.xq)(Wt.getTileSize(te)),ve=Wt.getResolution(te),Ee=(Nt[0]-he[0])/ve-_e[1]*le[0],pt=(he[1]-Nt[1])/ve-_e[2]*le[1];return Pe.getPixelData(Ee,pt)}return null}disposeInternal(){const F=this.helper;if(F){const lt=F.getGL();for(const mt of this.paletteTextures_)mt.delete(lt);this.paletteTextures_.length=0,lt.deleteProgram(this.program_),delete this.program_,F.deleteBuffer(this.indices_)}super.disposeInternal(),delete this.indices_}}const nt=null;class et{constructor(F,lt){this.name=F,this.data=lt,this.texture_=null}getTexture(F){if(!this.texture_){const lt=F.createTexture();F.bindTexture(F.TEXTURE_2D,lt),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,F.NEAREST),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,F.NEAREST),F.texImage2D(F.TEXTURE_2D,0,F.RGBA,this.data.length/4,1,0,F.RGBA,F.UNSIGNED_BYTE,this.data),this.texture_=lt}return this.texture_}delete(F){this.texture_&&F.deleteTexture(this.texture_),this.texture_=null}}const Et=et;var ut=i(49825);function Rt(V,F){return`operator_${V}_${Object.keys(F.functions).length}`}function Mt(V){const F=V.toString();return F.includes(".")?F:F+".0"}function jt(V){if(V.length<2||V.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${V.length}(${V.map(Mt).join(", ")})`}function ie(V){const F=(0,U._j)(V),lt=F.length>3?F[3]:1;return jt([F[0]/255,F[1]/255,F[2]/255,lt])}function Qt(V){const F=(0,d.xq)(V);return jt(F)}const Y={};let H=0;function q(V){return V in Y||(Y[V]=H++),Y[V]}function Lt(V){return Mt(q(V))}function Dt(V){return"u_var_"+V}function zt(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const Yt="getBandValue",Xt="u_paletteTextures",ee="featureId",ne="geometryType",Jt=-9999999;function ue(V,F,lt,mt){const It=(0,ut.qg)(V,F,lt);return de(It,F,mt)}function Kt(V){return(F,lt,mt)=>{const It=lt.args.length,Nt=new Array(It);for(let St=0;St<It;++St)Nt[St]=de(lt.args[St],mt,F);return V(Nt,F)}}const Ce={[ut.ZD.Get]:(V,F)=>{const mt=F.args[0].value;return mt in V.properties||(V.properties[mt]={name:mt,type:F.type}),"a_prop_"+mt},[ut.ZD.Id]:V=>(V.featureId=!0,"a_"+ee),[ut.ZD.GeometryType]:V=>(V.geometryType=!0,"a_"+ne),[ut.ZD.LineMetric]:()=>"currentLineMetric",[ut.ZD.Var]:(V,F)=>{const mt=F.args[0].value;return mt in V.variables||(V.variables[mt]={name:mt,type:F.type}),Dt(mt)},[ut.ZD.Has]:(V,F)=>{const mt=F.args[0].value;return mt in V.properties||(V.properties[mt]={name:mt,type:F.type}),`(a_prop_${mt} != ${Mt(Jt)})`},[ut.ZD.Resolution]:()=>"u_resolution",[ut.ZD.Zoom]:()=>"u_zoom",[ut.ZD.Time]:()=>"u_time",[ut.ZD.Any]:Kt(V=>`(${V.join(" || ")})`),[ut.ZD.All]:Kt(V=>`(${V.join(" && ")})`),[ut.ZD.Not]:Kt(([V])=>`(!${V})`),[ut.ZD.Equal]:Kt(([V,F])=>`(${V} == ${F})`),[ut.ZD.NotEqual]:Kt(([V,F])=>`(${V} != ${F})`),[ut.ZD.GreaterThan]:Kt(([V,F])=>`(${V} > ${F})`),[ut.ZD.GreaterThanOrEqualTo]:Kt(([V,F])=>`(${V} >= ${F})`),[ut.ZD.LessThan]:Kt(([V,F])=>`(${V} < ${F})`),[ut.ZD.LessThanOrEqualTo]:Kt(([V,F])=>`(${V} <= ${F})`),[ut.ZD.Multiply]:Kt(V=>`(${V.join(" * ")})`),[ut.ZD.Divide]:Kt(([V,F])=>`(${V} / ${F})`),[ut.ZD.Add]:Kt(V=>`(${V.join(" + ")})`),[ut.ZD.Subtract]:Kt(([V,F])=>`(${V} - ${F})`),[ut.ZD.Clamp]:Kt(([V,F,lt])=>`clamp(${V}, ${F}, ${lt})`),[ut.ZD.Mod]:Kt(([V,F])=>`mod(${V}, ${F})`),[ut.ZD.Pow]:Kt(([V,F])=>`pow(${V}, ${F})`),[ut.ZD.Abs]:Kt(([V])=>`abs(${V})`),[ut.ZD.Floor]:Kt(([V])=>`floor(${V})`),[ut.ZD.Ceil]:Kt(([V])=>`ceil(${V})`),[ut.ZD.Round]:Kt(([V])=>`floor(${V} + 0.5)`),[ut.ZD.Sin]:Kt(([V])=>`sin(${V})`),[ut.ZD.Cos]:Kt(([V])=>`cos(${V})`),[ut.ZD.Atan]:Kt(([V,F])=>F!==void 0?`atan(${V}, ${F})`:`atan(${V})`),[ut.ZD.Sqrt]:Kt(([V])=>`sqrt(${V})`),[ut.ZD.Match]:Kt(V=>{const F=V[0],lt=V[V.length-1];let mt=null;for(let It=V.length-3;It>=1;It-=2){const Nt=V[It],St=V[It+1];mt=`(${F} == ${Nt} ? ${St} : ${mt||lt})`}return mt}),[ut.ZD.Between]:Kt(([V,F,lt])=>`(${V} >= ${F} && ${V} <= ${lt})`),[ut.ZD.Interpolate]:Kt(([V,F,...lt])=>{let mt="";for(let It=0;It<lt.length-2;It+=2){const Nt=lt[It],St=mt||lt[It+1],Zt=lt[It+2],qt=lt[It+3];let At;V===Mt(1)?At=`(${F} - ${Nt}) / (${Zt} - ${Nt})`:At=`(pow(${V}, (${F} - ${Nt})) - 1.0) / (pow(${V}, (${Zt} - ${Nt})) - 1.0)`,mt=`mix(${St}, ${qt}, clamp(${At}, 0.0, 1.0))`}return mt}),[ut.ZD.Case]:Kt(V=>{const F=V[V.length-1];let lt=null;for(let mt=V.length-3;mt>=0;mt-=2){const It=V[mt],Nt=V[mt+1];lt=`(${It} ? ${Nt} : ${lt||F})`}return lt}),[ut.ZD.In]:Kt(([V,...F],lt)=>{const mt=Rt("in",lt),It=[];for(let Nt=0;Nt<F.length;Nt+=1)It.push(`  if (inputValue == ${F[Nt]}) { return true; }`);return lt.functions[mt]=`bool ${mt}(float inputValue) {
${It.join(`
`)}
  return false;
}`,`${mt}(${V})`}),[ut.ZD.Array]:Kt(V=>`vec${V.length}(${V.join(", ")})`),[ut.ZD.Color]:Kt(V=>{if(V.length===1)return`vec4(vec3(${V[0]} / 255.0), 1.0)`;if(V.length===2)return`vec4(vec3(${V[0]} / 255.0), ${V[1]})`;const F=V.slice(0,3).map(mt=>`${mt} / 255.0`);if(V.length===3)return`vec4(${F.join(", ")}, 1.0)`;const lt=V[3];return`vec4(${F.join(", ")}, ${lt})`}),[ut.ZD.Band]:Kt(([V,F,lt],mt)=>{if(!(Yt in mt.functions)){let It="";const Nt=mt.bandCount||1;for(let St=0;St<Nt;St++){const Zt=Math.floor(St/4);let qt=St%4;St===Nt-1&&qt===1&&(qt=3);const At=`${it.TILE_TEXTURE_ARRAY}[${Zt}]`;It+=`  if (band == ${St+1}.0) {
    return texture2D(${At}, v_textureCoord + vec2(dx, dy))[${qt}];
  }
`}mt.functions[Yt]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${it.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${it.TEXTURE_PIXEL_HEIGHT};
${It}
}`}return`${Yt}(${V}, ${F??"0.0"}, ${lt??"0.0"})`}),[ut.ZD.Palette]:(V,F)=>{const[lt,...mt]=F.args,It=mt.length,Nt=new Uint8Array(It*4);for(let At=0;At<mt.length;At++){const kt=mt[At].value,Wt=(0,U._j)(kt),oe=At*4;Nt[oe]=Wt[0],Nt[oe+1]=Wt[1],Nt[oe+2]=Wt[2],Nt[oe+3]=Wt[3]*255}V.paletteTextures||(V.paletteTextures=[]);const St=`${Xt}[${V.paletteTextures.length}]`,Zt=new Et(St,Nt);V.paletteTextures.push(Zt);const qt=de(lt,ut.wl,V);return`texture2D(${St}, vec2((${qt} + 0.5) / ${It}.0, 0.5))`}};function de(V,F,lt){if(V instanceof ut.DG){const mt=Ce[V.operator];if(mt===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(V.operator)}`);return mt(lt,V,F)}if((V.type&ut.wl)>0)return Mt(V.value);if((V.type&ut.T8)>0)return V.value.toString();if((V.type&ut.cT)>0)return Lt(V.value.toString());if((V.type&ut.mE)>0)return ie(V.value);if((V.type&ut.Fq)>0)return jt(V.value);if((V.type&ut.qA)>0)return Qt(V.value);throw new Error(`Unexpected expression ${V.value} (expected type ${(0,ut.go)(F)})`)}},27733:(Ft,at,i)=>{i.d(at,{A:()=>$});var U=i(86936);class p extends U.A{constructor(d){d=d||{radius:5},super({points:1/0,fill:d.fill,radius:d.radius,stroke:d.stroke,scale:d.scale!==void 0?d.scale:1,rotation:d.rotation!==void 0?d.rotation:0,rotateWithView:d.rotateWithView!==void 0?d.rotateWithView:!1,displacement:d.displacement!==void 0?d.displacement:[0,0],declutterMode:d.declutterMode})}clone(){const d=this.getScale(),E=new p({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(d)?d.slice():d,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return E.setOpacity(this.getOpacity()),E}setRadius(d){this.radius=d,this.render()}}const $=p},29276:(Ft,at,i)=>{i.d(at,{Ay:()=>I,d1:()=>y,mC:()=>E,mY:()=>P});var U=i(90588),p=i(27733),$=i(13628),K=i(953);class d{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=g,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new d({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(c){return c.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=g,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function E(s){let e;if(typeof s=="function")e=s;else{let c;Array.isArray(s)?c=s:((0,U.v)(typeof s.getZIndex=="function","Expected an `Style` or an array of `Style`"),c=[s]),e=function(){return c}}return e}let l=null;function y(s,e){if(!l){const c=new $.A({color:"rgba(255,255,255,0.4)"}),G=new K.A({color:"#3399CC",width:1.25});l=[new d({image:new p.A({fill:c,stroke:G,radius:5}),fill:c,stroke:G})]}return l}function P(){const s={},e=[255,255,255,1],c=[0,153,255,1],G=3;return s.Polygon=[new d({fill:new $.A({color:[255,255,255,.5]})})],s.MultiPolygon=s.Polygon,s.LineString=[new d({stroke:new K.A({color:e,width:G+2})}),new d({stroke:new K.A({color:c,width:G})})],s.MultiLineString=s.LineString,s.Circle=s.Polygon.concat(s.LineString),s.Point=[new d({image:new p.A({radius:G*2,fill:new $.A({color:c}),stroke:new K.A({color:e,width:G/2})}),zIndex:1/0})],s.MultiPoint=s.Point,s.GeometryCollection=s.Polygon.concat(s.LineString,s.Point),s}function g(s){return s.getGeometry()}const I=d},32135:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={ADD:"add",REMOVE:"remove"}},32963:(Ft,at,i)=>{i.d(at,{A:()=>N});var U=i(8143),p=i(11078),$=i(68711),K=i(6837),d=i(9438),E=i(70915),l=i(61597),y=i(43067);let P;const g=[];function I(W,a,o,r,L){W.beginPath(),W.moveTo(0,0),W.lineTo(a,o),W.lineTo(r,L),W.closePath(),W.save(),W.clip(),W.fillRect(0,0,Math.max(a,r)+1,Math.max(o,L)),W.restore()}function s(W,a){return Math.abs(W[a*4]-210)>2||Math.abs(W[a*4+3]-.75*255)>2}function e(){if(P===void 0){const W=(0,$.Y)(6,6,g);W.globalCompositeOperation="lighter",W.fillStyle="rgba(210, 0, 0, 0.75)",I(W,4,5,4,0),I(W,4,5,0,5);const a=W.getImageData(0,0,3,3).data;P=s(a,0)||s(a,4)||s(a,8),(0,$.Yg)(W),g.push(W.canvas)}return P}function c(W,a,o,r){const L=(0,y.pd)(o,a,W);let A=(0,y.hO)(a,r,o);const O=a.getMetersPerUnit();O!==void 0&&(A*=O);const u=W.getMetersPerUnit();u!==void 0&&(A/=u);const x=W.getExtent();if(!x||(0,E.Ym)(x,L)){const S=(0,y.hO)(W,A,L)/A;isFinite(S)&&S>0&&(A/=S)}return A}function G(W,a,o,r){const L=(0,E.q1)(o);let A=c(W,a,L,r);return(!isFinite(A)||A<=0)&&(0,E.sB)(o,function(O){return A=c(W,a,O,r),isFinite(A)&&A>0}),A}function B(W,a,o,r,L,A,O,u,x,S,k,tt,ht,dt){const J=(0,$.Y)(Math.round(o*W),Math.round(o*a),g);if(tt||(J.imageSmoothingEnabled=!1),x.length===0)return J.canvas;J.scale(o,o);function ft(et){return Math.round(et*o)/o}J.globalCompositeOperation="lighter";const it=(0,E.S5)();x.forEach(function(et,Et,ut){(0,E.X$)(it,et.extent)});let st;const gt=o/r,Ot=(tt?1:1+Math.pow(2,-24))/gt;if(!ht||x.length!==1||S!==0){if(st=(0,$.Y)(Math.round((0,E.RG)(it)*gt),Math.round((0,E.Oq)(it)*gt),g),tt||(st.imageSmoothingEnabled=!1),L&&dt){const et=(L[0]-it[0])*gt,Et=-(L[3]-it[3])*gt,ut=(0,E.RG)(L)*gt,Rt=(0,E.Oq)(L)*gt;st.rect(et,Et,ut,Rt),st.clip()}x.forEach(function(et,Et,ut){if(et.image.width>0&&et.image.height>0){if(et.clipExtent){st.save();const Qt=(et.clipExtent[0]-it[0])*gt,Y=-(et.clipExtent[3]-it[3])*gt,H=(0,E.RG)(et.clipExtent)*gt,q=(0,E.Oq)(et.clipExtent)*gt;st.rect(tt?Qt:Math.round(Qt),tt?Y:Math.round(Y),tt?H:Math.round(Qt+H)-Math.round(Qt),tt?q:Math.round(Y+q)-Math.round(Y)),st.clip()}const Rt=(et.extent[0]-it[0])*gt,Mt=-(et.extent[3]-it[3])*gt,jt=(0,E.RG)(et.extent)*gt,ie=(0,E.Oq)(et.extent)*gt;st.drawImage(et.image,S,S,et.image.width-2*S,et.image.height-2*S,tt?Rt:Math.round(Rt),tt?Mt:Math.round(Mt),tt?jt:Math.round(Rt+jt)-Math.round(Rt),tt?ie:Math.round(Mt+ie)-Math.round(Mt)),et.clipExtent&&st.restore()}})}const nt=(0,E.Py)(O);return u.getTriangles().forEach(function(et,Et,ut){const Rt=et.source,Mt=et.target;let jt=Rt[0][0],ie=Rt[0][1],Qt=Rt[1][0],Y=Rt[1][1],H=Rt[2][0],q=Rt[2][1];const Lt=ft((Mt[0][0]-nt[0])/A),Dt=ft(-(Mt[0][1]-nt[1])/A),zt=ft((Mt[1][0]-nt[0])/A),Yt=ft(-(Mt[1][1]-nt[1])/A),Xt=ft((Mt[2][0]-nt[0])/A),ee=ft(-(Mt[2][1]-nt[1])/A),ne=jt,Jt=ie;jt=0,ie=0,Qt-=ne,Y-=Jt,H-=ne,q-=Jt;const ue=[[Qt,Y,0,0,zt-Lt],[H,q,0,0,Xt-Lt],[0,0,Qt,Y,Yt-Dt],[0,0,H,q,ee-Dt]],Kt=(0,l.KU)(ue);if(!Kt)return;if(J.save(),J.beginPath(),e()||!tt){J.moveTo(zt,Yt);const de=4,V=Lt-zt,F=Dt-Yt;for(let lt=0;lt<de;lt++)J.lineTo(zt+ft((lt+1)*V/de),Yt+ft(lt*F/(de-1))),lt!=de-1&&J.lineTo(zt+ft((lt+1)*V/de),Yt+ft((lt+1)*F/(de-1)));J.lineTo(Xt,ee)}else J.moveTo(zt,Yt),J.lineTo(Lt,Dt),J.lineTo(Xt,ee);J.clip(),J.transform(Kt[0],Kt[2],Kt[1],Kt[3],Lt,Dt),J.translate(it[0]-ne,it[3]-Jt);let Ce;if(st)Ce=st.canvas,J.scale(Ot,-Ot);else{const de=x[0],V=de.extent;Ce=de.image,J.scale((0,E.RG)(V)/Ce.width,-(0,E.Oq)(V)/Ce.height)}J.drawImage(Ce,0,0),J.restore()}),st&&((0,$.Yg)(st),g.push(st.canvas)),k&&(J.save(),J.globalCompositeOperation="source-over",J.strokeStyle="black",J.lineWidth=1,u.getTriangles().forEach(function(et,Et,ut){const Rt=et.target,Mt=(Rt[0][0]-nt[0])/A,jt=-(Rt[0][1]-nt[1])/A,ie=(Rt[1][0]-nt[0])/A,Qt=-(Rt[1][1]-nt[1])/A,Y=(Rt[2][0]-nt[0])/A,H=-(Rt[2][1]-nt[1])/A;J.beginPath(),J.moveTo(ie,Qt),J.lineTo(Mt,jt),J.lineTo(Y,H),J.closePath(),J.stroke()}),J.restore()),J.canvas}var w=i(9703);const T=10,f=.25;class m{constructor(a,o,r,L,A,O,u){this.sourceProj_=a,this.targetProj_=o;let x={};const S=u?(0,y.HU)(Ot=>(0,w.Bb)(u,(0,y.pd)(Ot,this.targetProj_,this.sourceProj_))):(0,y.RG)(this.targetProj_,this.sourceProj_);this.transformInv_=function(Ot){const nt=Ot[0]+"/"+Ot[1];return x[nt]||(x[nt]=S(Ot)),x[nt]},this.maxSourceExtent_=L,this.errorThresholdSquared_=A*A,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!L&&!!this.sourceProj_.getExtent()&&(0,E.RG)(L)>=(0,E.RG)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,E.RG)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,E.RG)(this.targetProj_.getExtent()):null;const k=(0,E.Py)(r),tt=(0,E.WU)(r),ht=(0,E.k_)(r),dt=(0,E.R)(r),J=this.transformInv_(k),ft=this.transformInv_(tt),it=this.transformInv_(ht),st=this.transformInv_(dt),gt=T+(O?Math.max(0,Math.ceil(Math.log2((0,E.UG)(r)/(O*O*256*256)))):0);if(this.addQuad_(k,tt,ht,dt,J,ft,it,st,gt),this.wrapsXInSource_){let Ot=1/0;this.triangles_.forEach(function(nt,et,Et){Ot=Math.min(Ot,nt.source[0][0],nt.source[1][0],nt.source[2][0])}),this.triangles_.forEach(nt=>{if(Math.max(nt.source[0][0],nt.source[1][0],nt.source[2][0])-Ot>this.sourceWorldWidth_/2){const et=[[nt.source[0][0],nt.source[0][1]],[nt.source[1][0],nt.source[1][1]],[nt.source[2][0],nt.source[2][1]]];et[0][0]-Ot>this.sourceWorldWidth_/2&&(et[0][0]-=this.sourceWorldWidth_),et[1][0]-Ot>this.sourceWorldWidth_/2&&(et[1][0]-=this.sourceWorldWidth_),et[2][0]-Ot>this.sourceWorldWidth_/2&&(et[2][0]-=this.sourceWorldWidth_);const Et=Math.min(et[0][0],et[1][0],et[2][0]);Math.max(et[0][0],et[1][0],et[2][0])-Et<this.sourceWorldWidth_/2&&(nt.source=et)}})}x={}}addTriangle_(a,o,r,L,A,O){this.triangles_.push({source:[L,A,O],target:[a,o,r]})}addQuad_(a,o,r,L,A,O,u,x,S){const k=(0,E.Tr)([A,O,u,x]),tt=this.sourceWorldWidth_?(0,E.RG)(k)/this.sourceWorldWidth_:null,ht=this.sourceWorldWidth_,dt=this.sourceProj_.canWrapX()&&tt>.5&&tt<1;let J=!1;if(S>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const it=(0,E.Tr)([a,o,r,L]);J=(0,E.RG)(it)/this.targetWorldWidth_>f||J}!dt&&this.sourceProj_.isGlobal()&&tt&&(J=tt>f||J)}if(!J&&this.maxSourceExtent_&&isFinite(k[0])&&isFinite(k[1])&&isFinite(k[2])&&isFinite(k[3])&&!(0,E.HY)(k,this.maxSourceExtent_))return;let ft=0;if(!J&&(!isFinite(A[0])||!isFinite(A[1])||!isFinite(O[0])||!isFinite(O[1])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(x[0])||!isFinite(x[1]))){if(S>0)J=!0;else if(ft=(!isFinite(A[0])||!isFinite(A[1])?8:0)+(!isFinite(O[0])||!isFinite(O[1])?4:0)+(!isFinite(u[0])||!isFinite(u[1])?2:0)+(!isFinite(x[0])||!isFinite(x[1])?1:0),ft!=1&&ft!=2&&ft!=4&&ft!=8)return}if(S>0){if(!J){const it=[(a[0]+r[0])/2,(a[1]+r[1])/2],st=this.transformInv_(it);let gt;dt?gt=((0,l.xP)(A[0],ht)+(0,l.xP)(u[0],ht))/2-(0,l.xP)(st[0],ht):gt=(A[0]+u[0])/2-st[0];const Ot=(A[1]+u[1])/2-st[1];J=gt*gt+Ot*Ot>this.errorThresholdSquared_}if(J){if(Math.abs(a[0]-r[0])<=Math.abs(a[1]-r[1])){const it=[(o[0]+r[0])/2,(o[1]+r[1])/2],st=this.transformInv_(it),gt=[(L[0]+a[0])/2,(L[1]+a[1])/2],Ot=this.transformInv_(gt);this.addQuad_(a,o,it,gt,A,O,st,Ot,S-1),this.addQuad_(gt,it,r,L,Ot,st,u,x,S-1)}else{const it=[(a[0]+o[0])/2,(a[1]+o[1])/2],st=this.transformInv_(it),gt=[(r[0]+L[0])/2,(r[1]+L[1])/2],Ot=this.transformInv_(gt);this.addQuad_(a,it,gt,L,A,st,Ot,x,S-1),this.addQuad_(it,o,r,gt,st,O,u,Ot,S-1)}return}}if(dt){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(ft&11)==0&&this.addTriangle_(a,r,L,A,u,x),(ft&14)==0&&this.addTriangle_(a,r,o,A,u,O),ft&&((ft&13)==0&&this.addTriangle_(o,L,a,O,x,A),(ft&7)==0&&this.addTriangle_(o,L,r,O,x,u))}calculateSourceExtent(){const a=(0,E.S5)();return this.triangles_.forEach(function(o,r,L){const A=o.source;(0,E.$C)(a,A[0]),(0,E.$C)(a,A[1]),(0,E.$C)(a,A[2])}),a}getTriangles(){return this.triangles_}}const _=m,R=.5;class b extends U.A{constructor(a,o,r,L,A,O,u,x,S,k,tt,ht){super(A,p.A.IDLE,ht),this.renderEdges_=tt!==void 0?tt:!1,this.pixelRatio_=u,this.gutter_=x,this.canvas_=null,this.sourceTileGrid_=o,this.targetTileGrid_=L,this.wrappedTileCoord_=O||A,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=a.canWrapX()?a.getExtent():void 0;const dt=L.getTileCoordExtent(this.wrappedTileCoord_),J=this.targetTileGrid_.getExtent();let ft=this.sourceTileGrid_.getExtent();const it=J?(0,E._N)(dt,J):dt;if((0,E.UG)(it)===0){this.state=p.A.EMPTY;return}const st=a.getExtent();st&&(ft?ft=(0,E._N)(ft,st):ft=st);const gt=L.getResolution(this.wrappedTileCoord_[0]),Ot=G(a,r,it,gt);if(!isFinite(Ot)||Ot<=0){this.state=p.A.EMPTY;return}const nt=k!==void 0?k:R;if(this.triangulation_=new _(a,r,it,ft,Ot*nt,gt),this.triangulation_.getTriangles().length===0){this.state=p.A.EMPTY;return}this.sourceZ_=o.getZForResolution(Ot);let et=this.triangulation_.calculateSourceExtent();if(ft&&(a.canWrapX()?(et[1]=(0,l.qE)(et[1],ft[1],ft[3]),et[3]=(0,l.qE)(et[3],ft[1],ft[3])):et=(0,E._N)(et,ft)),!(0,E.UG)(et))this.state=p.A.EMPTY;else{let Et=0,ut=0;a.canWrapX()&&(Et=(0,E.RG)(st),ut=Math.floor((et[0]-st[0])/Et)),(0,E.QJ)(et.slice(),a,!0).forEach(Mt=>{const jt=o.getTileRangeForExtentAndZ(Mt,this.sourceZ_);for(let ie=jt.minX;ie<=jt.maxX;ie++)for(let Qt=jt.minY;Qt<=jt.maxY;Qt++){const Y=S(this.sourceZ_,ie,Qt,u);if(Y){const H=ut*Et;this.sourceTiles_.push({tile:Y,offset:H})}}++ut}),this.sourceTiles_.length===0&&(this.state=p.A.EMPTY)}}getImage(){return this.canvas_}reproject_(){const a=[];if(this.sourceTiles_.forEach(o=>{const r=o.tile;if(r&&r.getState()==p.A.LOADED){const L=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);L[0]+=o.offset,L[2]+=o.offset;const A=this.clipExtent_?.slice();A&&(A[0]+=o.offset,A[2]+=o.offset),a.push({extent:L,clipExtent:A,image:r.getImage()})}}),this.sourceTiles_.length=0,a.length===0)this.state=p.A.ERROR;else{const o=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(o),L=typeof r=="number"?r:r[0],A=typeof r=="number"?r:r[1],O=this.targetTileGrid_.getResolution(o),u=this.sourceTileGrid_.getResolution(this.sourceZ_),x=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=B(L,A,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),O,x,this.triangulation_,a,this.gutter_,this.renderEdges_,this.interpolate),this.state=p.A.LOADED}this.changed()}load(){if(this.state==p.A.IDLE){this.state=p.A.LOADING,this.changed();let a=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:o})=>{const r=o.getState();if(r==p.A.IDLE||r==p.A.LOADING){a++;const L=(0,d.KT)(o,K.A.CHANGE,A=>{const O=o.getState();(O==p.A.LOADED||O==p.A.ERROR||O==p.A.EMPTY)&&((0,d.JH)(L),a--,a===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(L)}}),a===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:o},r,L){o.getState()==p.A.IDLE&&o.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(d.JH),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,$.Yg)(this.canvas_.getContext("2d")),g.push(this.canvas_),this.canvas_=null),super.release()}}const N=b},34835:(Ft,at,i)=>{i.d(at,{Qi:()=>l,T0:()=>y,kc:()=>g,mf:()=>P,mh:()=>I,s2:()=>K});var U=i(89352),p=i(49825),$=i(25847);function K(s,e,c){const G=(0,p.SR)();return(0,$.nR)(e,c,G,s)}function d(s){const e=(0,U._j)(s),c=e[0]*256,G=e[1],B=e[2]*256,w=Math.round(e[3]*255);return[c+G,B+w]}const E=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    fract(floor(packedColor[0] / 256.0) / 256.0),
    fract(packedColor[0] / 256.0),
    fract(floor(packedColor[1] / 256.0) / 256.0),
    fract(packedColor[1] / 256.0)
  );
}`;function l(s){return s===p.mE||s===p.qA?2:s===p.Fq?4:1}function y(s){const e=l(s);return e>1?`vec${e}`:"float"}function P(s,e){for(const c in e.variables){const G=e.variables[c],B=(0,$.Sl)(G.name);let w=y(G.type);G.type===p.mE&&(w="vec4"),s.addUniform(B,w)}for(const c in e.properties){const G=e.properties[c],B=y(G.type),w=`a_prop_${G.name}`;G.type===p.mE?(s.addAttribute(w,B,`unpackColor(${w})`,"vec4"),s.addVertexShaderFunction(E)):s.addAttribute(w,B)}for(const c in e.functions)s.addVertexShaderFunction(e.functions[c]),s.addFragmentShaderFunction(e.functions[c])}function g(s,e){const c={};for(const G in s.variables){const B=s.variables[G],w=(0,$.Sl)(B.name);c[w]=()=>{const T=e[B.name];if(typeof T=="number")return T;if(typeof T=="boolean")return T?1:0;if(B.type===p.mE){const f=[...(0,U._j)(T||"#eee")];return f[0]/=255,f[1]/=255,f[2]/=255,f[3]??=1,f}return typeof T=="string"?(0,$.Lm)(T):T}}return c}function I(s){const e={};for(const c in s.properties){const G=s.properties[c],B=w=>{const T=w.get(G.name);return G.type===p.mE?d([...(0,U._j)(T||"#eee")]):typeof T=="string"?(0,$.Lm)(T):typeof T=="boolean"?T?1:0:T};e[`prop_${G.name}`]={size:l(G.type),callback:B}}return e}},35339:(Ft,at,i)=>{i.d(at,{v:()=>p});var U=i(48287).Buffer;function p(){const $='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let u=e(t,0,i,x,!0);const l=[];if(!u||u.next===u.prev)return l;let c,h,y;if(o&&(u=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const u=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);u===u.next&&(u.steiner=!0),o.push(a(u))}o.sort(f);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,u,x)),t.length>80*x){c=1/0,h=1/0;let e=-1/0,n=-1/0;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<h&&(h=o),x>e&&(e=x),o>n&&(n=o)}y=Math.max(e-c,n-h),y=0!==y?32767/y:0}return r(u,l,x,c,h,y,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=w(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=w(x/r|0,t[x],t[x+1],o);return o&&g(o,o.next)&&(A(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!g(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(A(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,f,s,l,a,h){if(!t)return;!h&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,u=0;for(let t=0;t<n&&(u++,i=i.nextZ,i);t++);let f=n;for(;u>0||f>0&&i;)0!==u&&(0===f||!i||x.z<=i.z)?(r=x,x=x.nextZ,u--):(r=i,i=i.nextZ,f--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let y=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),A(t),t=p.next,y=p.next;else if((t=p)===y){h?1===h?r(t=i(n(t),e),e,f,s,l,a,2):2===h&&u(t,e,f,s,l,a):r(n(t),e,f,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,u=e.y,f=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(u,f,s),a=Math.max(x,o,i),h=Math.max(u,f,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=h&&y(x,u,o,f,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const u=x.x,f=o.x,s=i.x,l=x.y,a=o.y,h=i.y,p=Math.min(u,f,s),g=Math.min(l,a,h),b=Math.max(u,f,s),M=Math.max(l,a,h),m=c(p,g,e,n,r),Z=c(b,M,e,n,r);let d=t.prevZ,w=t.nextZ;for(;d&&d.z>=m&&w&&w.z<=Z;){if(d.x>=p&&d.x<=b&&d.y>=g&&d.y<=M&&d!==x&&d!==i&&y(u,l,f,a,s,h,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,w.x>=p&&w.x<=b&&w.y>=g&&w.y<=M&&w!==x&&w!==i&&y(u,l,f,a,s,h,w.x,w.y)&&v(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;d&&d.z>=m;){if(d.x>=p&&d.x<=b&&d.y>=g&&d.y<=M&&d!==x&&d!==i&&y(u,l,f,a,s,h,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;w&&w.z<=Z;){if(w.x>=p&&w.x<=b&&w.y>=g&&w.y<=M&&w!==x&&w!==i&&y(u,l,f,a,s,h,w.x,w.y)&&v(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!g(n,x)&&b(n,r,r.next,x)&&Z(n,x)&&Z(x,n)&&(e.push(n.i,r.i,x.i),A(r),A(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function u(t,e,x,o,i,u){let f=t;do{let t=f.next.next;for(;t!==f.prev;){if(f.i!==t.i&&p(f,t)){let s=d(f,t);return f=n(f,f.next),s=n(s,s.next),r(f,e,x,o,i,u,0),void r(s,e,x,o,i,u,0)}t=t.next}f=f.next}while(f!==t)}function f(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(g(t,n))return n;do{if(g(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const u=o,f=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=f&&r!==n.x&&h(x<s?r:i,x,f,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);Z(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==u);return o}(t,e);if(!r)return e;const x=d(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function h(t,e,n,r,x,o,i,u){return(x-i)*(e-u)>=(t-i)*(o-u)&&(t-i)*(r-u)>=(n-i)*(e-u)&&(n-i)*(o-u)>=(x-i)*(r-u)}function y(t,e,n,r,x,o,i,u){return!(t===i&&e===u)&&h(t,e,n,r,x,o,i,u)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Z(t,e)&&Z(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||g(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function g(t,e){return t.x===e.x&&t.y===e.y}function b(t,e,n,r){const x=m(v(t,e,n)),o=m(v(t,e,r)),i=m(v(n,r,t)),u=m(v(n,r,e));return x!==o&&i!==u||(!(0!==x||!M(t,n,e))||(!(0!==o||!M(t,r,e))||(!(0!==i||!M(n,t,r))||!(0!==u||!M(n,e,r)))))}function M(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function m(t){return t>0?1:t<0?-1:0}function Z(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function d(t,e){const n=E(t.i,t.x,t.y),r=E(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function w(t,e,n,r){const x=E(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function I(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function z(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],u=e[3],f=e[4],s=e[5];return t[0]=u/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-u*f)/n,t[5]=-(x*s-o*f)/n,t}new Array(6);const F=[],P={vertexPosition:0,indexPosition:0};function B(t,e,n,r,x){t[e+0]=n,t[e+1]=r,t[e+2]=x}function N(t,e,n,r,x,o){const i=3+x,u=t[e+0],f=t[e+1],s=F;s.length=x;for(let n=0;n<s.length;n++)s[n]=t[e+2+n];let l=o?o.vertexPosition:0,c=o?o.indexPosition:0;const a=l/i;return B(n,l,u,f,0),s.length&&n.set(s,l+3),l+=i,B(n,l,u,f,1),s.length&&n.set(s,l+3),l+=i,B(n,l,u,f,2),s.length&&n.set(s,l+3),l+=i,B(n,l,u,f,3),s.length&&n.set(s,l+3),l+=i,r[c++]=a,r[c++]=a+1,r[c++]=a+3,r[c++]=a+1,r[c++]=a+2,r[c++]=a+3,P.vertexPosition=l,P.indexPosition=c,P}function R(t,e,n,r,x,o,i,u,f,s,l){const c=10+u.length,a=o.length/c,h=[t[e+0],t[e+1]],y=[t[n],t[n+1]],p=t[e+2],v=t[n+2],g=I(f,[...h]),b=I(f,[...y]);function M(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),u=[(n[0]-t[0])/i,(n[1]-t[1])/i],f=0===r||0===i?0:Math.acos((s=u[0]*x[0]+u[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;return u[0]*o[0]+u[1]*o[1]>0?f:2*Math.PI-f}let m=-1,Z=-1,d=l;const w=null!==x;if(null!==r){m=M(g,b,I(f,[...[t[r],t[r+1]]])),Math.cos(m)<=.985&&(d+=Math.tan((m-Math.PI)/2))}if(w){Z=M(b,g,I(f,[...[t[x],t[x+1]]])),Math.cos(Z)<=.985&&(d+=Math.tan((Math.PI-Z)/2))}function A(t,e){return 0===e?1e4*t:Math.sign(e)*(1e4*t+Math.abs(e))}return o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(0,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(1,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(2,l)),o.push(...u),o.push(h[0],h[1],p,y[0],y[1],v,m,Z,s,A(3,l)),o.push(...u),i.push(a,a+1,a+2,a+1,a+3,a+2),{length:s+Math.sqrt((b[0]-g[0])*(b[0]-g[0])+(b[1]-g[1])*(b[1]-g[1])),angle:d}}function S(e,n,r,x,o){const i=2+o;let u=n;const f=e.slice(u,u+o);u+=o;const s=e[u++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[u++],t<s-1&&(c[t]=l);const a=e.slice(u,u+2*l),h=t(a,c,2);for(let t=0;t<h.length;t++)x.push(h[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...f);return u+2*l}const T="GENERATE_POLYGON_BUFFERS",_="GENERATE_POINT_BUFFERS",O="GENERATE_LINE_STRING_BUFFERS",U=self;U.onmessage=t=>{const e=t.data;switch(e.type){case _:{const t=3,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x,u=4*i*(r+t),f=new Uint32Array(6*i),s=new Float32Array(u);let l;for(let t=0;t<o.length;t+=x)l=N(o,t,s,f,r,l);const c=Object.assign({vertexBuffer:s.buffer,indexBuffer:f.buffer,renderInstructions:o.buffer},e);U.postMessage(c,[s.buffer,f.buffer,o.buffer]);break}case O:{const t=[],n=[],r=e.customAttributesSize,x=3,o=new Float32Array(e.renderInstructions);let i=0;const u=[1,0,0,1,0,0];let f,s;for(z(u,e.renderInstructionsTransform);i<o.length;){s=Array.from(o.slice(i,i+r)),i+=r,f=o[i++];const e=i,l=i+(f-1)*x,c=o[e]===o[l]&&o[e+1]===o[l+1];let a=0,h=0;for(let r=0;r<f-1;r++){let y=null;r>0?y=i+(r-1)*x:c&&(y=l-x);let p=null;r<f-2?p=i+(r+2)*x:c&&(p=e+x);const v=R(o,i+r*x,i+(r+1)*x,y,p,t,n,s,u,a,h);a=v.length,h=v.angle}i+=f*x}const l=Uint32Array.from(n),c=Float32Array.from(t),a=Object.assign({vertexBuffer:c.buffer,indexBuffer:l.buffer,renderInstructions:o.buffer},e);U.postMessage(a,[c.buffer,l.buffer,o.buffer]);break}case T:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=S(x,o,t,n,r);const i=Uint32Array.from(n),u=Float32Array.from(t),f=Object.assign({vertexBuffer:u.buffer,indexBuffer:i.buffer,renderInstructions:x.buffer},e);U.postMessage(f,[u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+U.from($,"binary").toString("base64"):URL.createObjectURL(new Blob([$],{type:"application/javascript"})))}},35598:(Ft,at,i)=>{i.d(at,{A:()=>G,i:()=>s});var U=i(50071),p=i(32135),$=i(28450),K=i(90588),d=i(1685),E=i(6837),l=i(9438),y=i(70915),P=i(43530),g=i(4087),I=i(58620);class s extends d.Ay{constructor(w,T){super(w),this.layer=T}}const e={LAYERS:"layers"};class c extends I.A{constructor(w){w=w||{};const T=Object.assign({},w);delete T.layers;let f=w.layers;super(T),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(e.LAYERS,this.handleLayersChanged_),f?Array.isArray(f)?f=new U.A(f.slice(),{unique:!0}):(0,K.v)(typeof f.getArray=="function","Expected `layers` to be an array or a `Collection`"):f=new U.A(void 0,{unique:!0}),this.setLayers(f)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(l.JH),this.layersListenerKeys_.length=0;const w=this.getLayers();this.layersListenerKeys_.push((0,l.KT)(w,p.A.ADD,this.handleLayersAdd_,this),(0,l.KT)(w,p.A.REMOVE,this.handleLayersRemove_,this));for(const f in this.listenerKeys_)this.listenerKeys_[f].forEach(l.JH);(0,P.I)(this.listenerKeys_);const T=w.getArray();for(let f=0,m=T.length;f<m;f++){const _=T[f];this.registerLayerListeners_(_),this.dispatchEvent(new s("addlayer",_))}this.changed()}registerLayerListeners_(w){const T=[(0,l.KT)(w,$.A.PROPERTYCHANGE,this.handleLayerChange_,this),(0,l.KT)(w,E.A.CHANGE,this.handleLayerChange_,this)];w instanceof c&&T.push((0,l.KT)(w,"addlayer",this.handleLayerGroupAdd_,this),(0,l.KT)(w,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[(0,g.v6)(w)]=T}handleLayerGroupAdd_(w){this.dispatchEvent(new s("addlayer",w.layer))}handleLayerGroupRemove_(w){this.dispatchEvent(new s("removelayer",w.layer))}handleLayersAdd_(w){const T=w.element;this.registerLayerListeners_(T),this.dispatchEvent(new s("addlayer",T)),this.changed()}handleLayersRemove_(w){const T=w.element,f=(0,g.v6)(T);this.listenerKeys_[f].forEach(l.JH),delete this.listenerKeys_[f],this.dispatchEvent(new s("removelayer",T)),this.changed()}getLayers(){return this.get(e.LAYERS)}setLayers(w){const T=this.getLayers();if(T){const f=T.getArray();for(let m=0,_=f.length;m<_;++m)this.dispatchEvent(new s("removelayer",f[m]))}this.set(e.LAYERS,w)}getLayersArray(w){return w=w!==void 0?w:[],this.getLayers().forEach(function(T){T.getLayersArray(w)}),w}getLayerStatesArray(w){const T=w!==void 0?w:[],f=T.length;this.getLayers().forEach(function(R){R.getLayerStatesArray(T)});const m=this.getLayerState();let _=m.zIndex;!w&&m.zIndex===void 0&&(_=0);for(let R=f,b=T.length;R<b;R++){const N=T[R];N.opacity*=m.opacity,N.visible=N.visible&&m.visible,N.maxResolution=Math.min(N.maxResolution,m.maxResolution),N.minResolution=Math.max(N.minResolution,m.minResolution),N.minZoom=Math.max(N.minZoom,m.minZoom),N.maxZoom=Math.min(N.maxZoom,m.maxZoom),m.extent!==void 0&&(N.extent!==void 0?N.extent=(0,y._N)(N.extent,m.extent):N.extent=m.extent),N.zIndex===void 0&&(N.zIndex=_)}return T}getSourceState(){return"ready"}}const G=c},38111:(Ft,at,i)=>{i.d(at,{A:()=>y});var U=i(75332),p=i(87579),$=i(83984),K=i(9703),d=i(9777),E=i(5986);class l extends E.A{constructor(g,I){super(g),I=I||{},this.inversePixelTransform_=(0,K.vt)(),this.postProcesses_=I.postProcesses,this.uniforms_=I.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},g.addChangeListener(U.A.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(g,I){const s=this.getLayer();if(s.hasListener($.A.PRECOMPOSE)){const e=new p.A($.A.PRECOMPOSE,void 0,I,g);s.dispatchEvent(e)}}dispatchPostComposeEvent(g,I){const s=this.getLayer();if(s.hasListener($.A.POSTCOMPOSE)){const e=new p.A($.A.POSTCOMPOSE,void 0,I,g);s.dispatchEvent(e)}}reset(g){this.uniforms_=g.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(g){if(this.getLayer().getRenderSource()){let I=!0,s=-1,e;for(let G=0,B=g.layerStatesArray.length;G<B;G++){const w=g.layerStatesArray[G].layer,T=w.getRenderer();if(!(T instanceof l)){I=!0;continue}const f=w.getClassName();if((I||f!==e)&&(s+=1,I=!1),e=f,T===this)break}const c="map/"+g.mapId+"/group/"+s;(!this.helper||!this.helper.canvasCacheKeyMatches(c)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new d.Ay({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:c}),e&&(this.helper.getCanvas().className=e),this.afterHelperCreated())}return this.prepareFrameInternal(g)}afterHelperCreated(){}prepareFrameInternal(g){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(U.A.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(g,I,s){const e=this.getLayer();if(e.hasListener(g)){(0,K.Zz)(this.inversePixelTransform_,0,0,s.pixelRatio,-s.pixelRatio,0,0,-s.size[1]);const c=new p.A(g,this.inversePixelTransform_,s,I);e.dispatchEvent(c)}}preRender(g,I){this.dispatchRenderEvent_($.A.PRERENDER,g,I)}postRender(g,I){this.dispatchRenderEvent_($.A.POSTRENDER,g,I)}}const y=l},38774:(Ft,at,i)=>{i.d(at,{Jw:()=>O,M8:()=>G,MY:()=>c,NT:()=>e,Oq:()=>P,TA:()=>r,Tq:()=>B,ZV:()=>E,_K:()=>I,_m:()=>y,aq:()=>w,eL:()=>s,fZ:()=>N,jT:()=>L,qY:()=>l,vk:()=>g,yY:()=>T});var U=i(34120),p=i(25176),$=i(68711),K=i(7771),d=i(43530);const E="10px sans-serif",l="#000",y="round",P=[],g=0,I="round",s=10,e="#000",c="center",G="middle",B=[0,0,0,0],w=1,T=new U.A;let f=null,m;const _={},R=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function b(x,S,k){return`${x} ${S} 16px "${k}"`}const N=function(){let S,k;async function tt(dt){await k.ready;const J=await k.load(dt);if(J.length===0)return!1;const ft=(0,p.K5)(dt),it=ft.families[0].toLowerCase(),st=ft.weight;return J.some(gt=>{const Ot=gt.family.replace(/^['"]|['"]$/g,"").toLowerCase(),nt=p.NM[gt.weight]||gt.weight;return Ot===it&&gt.style===ft.style&&nt==st})}async function ht(){await k.ready;let dt=!0;const J=T.getProperties(),ft=Object.keys(J).filter(it=>J[it]<100);for(let it=ft.length-1;it>=0;--it){const st=ft[it];let gt=J[st];gt<100&&(await tt(st)?((0,d.I)(_),T.set(st,100)):(gt+=10,T.set(st,gt,!0),gt<100&&(dt=!1)))}S=void 0,dt||(S=setTimeout(ht,100))}return async function(dt){k||(k=K.Wl?self.fonts:document.fonts);const J=(0,p.K5)(dt);if(!J)return;const ft=J.families;let it=!1;for(const st of ft){if(R.has(st))continue;const gt=b(J.style,J.weight,st);T.get(gt)===void 0&&(T.set(gt,0,!0),it=!0)}it&&(clearTimeout(S),S=setTimeout(ht,100))}}(),W=function(){let x;return function(S){let k=_[S];if(k==null){if(K.Wl){const tt=(0,p.K5)(S),ht=a(S,"\u017Dg");k=(isNaN(Number(tt.lineHeight))?1.2:Number(tt.lineHeight))*(ht.actualBoundingBoxAscent+ht.actualBoundingBoxDescent)}else x||(x=document.createElement("div"),x.innerHTML="M",x.style.minHeight="0",x.style.maxHeight="none",x.style.height="auto",x.style.padding="0",x.style.border="none",x.style.position="absolute",x.style.display="block",x.style.left="-99999px"),x.style.font=S,document.body.appendChild(x),k=x.offsetHeight,document.body.removeChild(x);_[S]=k}return k}}();function a(x,S){return f||(f=(0,$.Y)(1,1)),x!=m&&(f.font=x,m=f.font),f.measureText(S)}function o(x,S){return a(x,S).width}function r(x,S,k){if(S in k)return k[S];const tt=S.split(`
`).reduce((ht,dt)=>Math.max(ht,o(x,dt)),0);return k[S]=tt,tt}function L(x,S){const k=[],tt=[],ht=[];let dt=0,J=0,ft=0,it=0;for(let st=0,gt=S.length;st<=gt;st+=2){const Ot=S[st];if(Ot===`
`||st===gt){dt=Math.max(dt,J),ht.push(J),J=0,ft+=it,it=0;continue}const nt=S[st+1]||x.font,et=o(nt,Ot);k.push(et),J+=et;const Et=W(nt);tt.push(Et),it=Math.max(it,Et)}return{width:dt,height:ft,widths:k,heights:tt,lineWidths:ht}}function A(x,S,k,tt){S!==0&&(x.translate(k,tt),x.rotate(S),x.translate(-k,-tt))}function O(x,S,k,tt,ht,dt,J,ft,it,st,gt){x.save(),k!==1&&(x.globalAlpha===void 0?x.globalAlpha=Ot=>Ot.globalAlpha*=k:x.globalAlpha*=k),S&&x.transform.apply(x,S),tt.contextInstructions?(x.translate(it,st),x.scale(gt[0],gt[1]),u(tt,x)):gt[0]<0||gt[1]<0?(x.translate(it,st),x.scale(gt[0],gt[1]),x.drawImage(tt,ht,dt,J,ft,0,0,J,ft)):x.drawImage(tt,ht,dt,J,ft,it,st,J*gt[0],ft*gt[1]),x.restore()}function u(x,S){const k=x.contextInstructions;for(let tt=0,ht=k.length;tt<ht;tt+=2)Array.isArray(k[tt+1])?S[k[tt]].apply(S,k[tt+1]):S[k[tt]]=k[tt+1]}},40186:(Ft,at,i)=>{i.d(at,{N:()=>U,N5:()=>y,dp:()=>p,i7:()=>$,tW:()=>E});function U(P,g,I,s){return s!==void 0?(s[0]=P,s[1]=g,s[2]=I,s):[P,g,I]}function p(P,g,I){return P+"/"+g+"/"+I}function $(P){return p(P[0],P[1],P[2])}function K(P){const[g,I,s]=P.substring(P.lastIndexOf("/")+1,P.length).split(",").map(Number);return p(g,I,s)}function d(P){return P.split("/").map(Number)}function E(P){return l(P[0],P[1],P[2])}function l(P,g,I){return(g<<P)+I}function y(P,g){const I=P[0],s=P[1],e=P[2];if(g.getMinZoom()>I||I>g.getMaxZoom())return!1;const c=g.getFullTileRange(I);return c?c.containsXY(s,e):!0}},40190:(Ft,at,i)=>{i.d(at,{A:()=>l});var U=i(43938),p=i(8143),$=i(11078),K=i(68711);class d extends p.A{constructor(P,g,I,s,e,c){super(P,g,c),this.crossOrigin_=s,this.src_=I,this.key=I,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=e}getImage(){return this.image_}setImage(P){this.image_=P,this.state=$.A.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=$.A.ERROR,this.unlistenImage_(),this.image_=E(),this.changed()}handleImageLoad_(){const P=this.image_;P.naturalWidth&&P.naturalHeight?this.state=$.A.LOADED:this.state=$.A.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==$.A.ERROR&&(this.state=$.A.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==$.A.IDLE&&(this.state=$.A.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,U.f6)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function E(){const y=(0,K.Y)(1,1);return y.fillStyle="rgba(0,0,0,0)",y.fillRect(0,0,1,1),y.canvas}const l=d},40808:(Ft,at,i)=>{i.d(at,{A:()=>$});var U=i(68711);class p{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy((0,U.lr)(),{get:(d,E)=>{if(typeof(0,U.lr)()[E]=="function")return this.push_(E),this.pushMethodArgs_},set:(d,E,l)=>(this.push_(E,l),!0)})}push_(...d){const E=this.instructions_,l=this.zIndex+this.offset_;E[l]||(E[l]=[]),E[l].push(...d)}pushMethodArgs_=(...d)=>(this.push_(d),this);pushFunction(d){this.push_(d)}getContext(){return this.context_}draw(d){this.instructions_.forEach(E=>{for(let l=0,y=E.length;l<y;++l){const P=E[l];if(typeof P=="function"){P(d);continue}const g=E[++l];if(typeof d[P]=="function")d[P](...g);else{if(typeof g=="function"){d[P]=g(d);continue}d[P]=g}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const $=p},42375:(Ft,at,i)=>{i.d(at,{A:()=>K});function U(f,m,_=0,R=f.length-1,b=$){for(;R>_;){if(R-_>600){const o=R-_+1,r=m-_+1,L=Math.log(o),A=.5*Math.exp(2*L/3),O=.5*Math.sqrt(L*A*(o-A)/o)*(r-o/2<0?-1:1),u=Math.max(_,Math.floor(m-r*A/o+O)),x=Math.min(R,Math.floor(m+(o-r)*A/o+O));U(f,m,u,x,b)}const N=f[m];let W=_,a=R;for(p(f,_,m),b(f[R],N)>0&&p(f,_,R);W<a;){for(p(f,W,a),W++,a--;b(f[W],N)<0;)W++;for(;b(f[a],N)>0;)a--}b(f[_],N)===0?p(f,_,a):(a++,p(f,a,R)),a<=m&&(_=a+1),m<=a&&(R=a-1)}}function p(f,m,_){const R=f[m];f[m]=f[_],f[_]=R}function $(f,m){return f<m?-1:f>m?1:0}class K{constructor(m=9){this._maxEntries=Math.max(4,m),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(m){let _=this.data;const R=[];if(!B(m,_))return R;const b=this.toBBox,N=[];for(;_;){for(let W=0;W<_.children.length;W++){const a=_.children[W],o=_.leaf?b(a):a;B(m,o)&&(_.leaf?R.push(a):G(m,o)?this._all(a,R):N.push(a))}_=N.pop()}return R}collides(m){let _=this.data;if(!B(m,_))return!1;const R=[];for(;_;){for(let b=0;b<_.children.length;b++){const N=_.children[b],W=_.leaf?this.toBBox(N):N;if(B(m,W)){if(_.leaf||G(m,W))return!0;R.push(N)}}_=R.pop()}return!1}load(m){if(!(m&&m.length))return this;if(m.length<this._minEntries){for(let R=0;R<m.length;R++)this.insert(m[R]);return this}let _=this._build(m.slice(),0,m.length-1,0);if(!this.data.children.length)this.data=_;else if(this.data.height===_.height)this._splitRoot(this.data,_);else{if(this.data.height<_.height){const R=this.data;this.data=_,_=R}this._insert(_,this.data.height-_.height-1,!0)}return this}insert(m){return m&&this._insert(m,this.data.height-1),this}clear(){return this.data=w([]),this}remove(m,_){if(!m)return this;let R=this.data;const b=this.toBBox(m),N=[],W=[];let a,o,r;for(;R||N.length;){if(R||(R=N.pop(),o=N[N.length-1],a=W.pop(),r=!0),R.leaf){const L=d(m,R.children,_);if(L!==-1)return R.children.splice(L,1),N.push(R),this._condense(N),this}!r&&!R.leaf&&G(R,b)?(N.push(R),W.push(a),a=0,o=R,R=R.children[0]):o?(a++,R=o.children[a],r=!1):R=null}return this}toBBox(m){return m}compareMinX(m,_){return m.minX-_.minX}compareMinY(m,_){return m.minY-_.minY}toJSON(){return this.data}fromJSON(m){return this.data=m,this}_all(m,_){const R=[];for(;m;)m.leaf?_.push(...m.children):R.push(...m.children),m=R.pop();return _}_build(m,_,R,b){const N=R-_+1;let W=this._maxEntries,a;if(N<=W)return a=w(m.slice(_,R+1)),E(a,this.toBBox),a;b||(b=Math.ceil(Math.log(N)/Math.log(W)),W=Math.ceil(N/Math.pow(W,b-1))),a=w([]),a.leaf=!1,a.height=b;const o=Math.ceil(N/W),r=o*Math.ceil(Math.sqrt(W));T(m,_,R,r,this.compareMinX);for(let L=_;L<=R;L+=r){const A=Math.min(L+r-1,R);T(m,L,A,o,this.compareMinY);for(let O=L;O<=A;O+=o){const u=Math.min(O+o-1,A);a.children.push(this._build(m,O,u,b-1))}}return E(a,this.toBBox),a}_chooseSubtree(m,_,R,b){for(;b.push(_),!(_.leaf||b.length-1===R);){let N=1/0,W=1/0,a;for(let o=0;o<_.children.length;o++){const r=_.children[o],L=I(r),A=e(m,r)-L;A<W?(W=A,N=L<N?L:N,a=r):A===W&&L<N&&(N=L,a=r)}_=a||_.children[0]}return _}_insert(m,_,R){const b=R?m:this.toBBox(m),N=[],W=this._chooseSubtree(b,this.data,_,N);for(W.children.push(m),y(W,b);_>=0&&N[_].children.length>this._maxEntries;)this._split(N,_),_--;this._adjustParentBBoxes(b,N,_)}_split(m,_){const R=m[_],b=R.children.length,N=this._minEntries;this._chooseSplitAxis(R,N,b);const W=this._chooseSplitIndex(R,N,b),a=w(R.children.splice(W,R.children.length-W));a.height=R.height,a.leaf=R.leaf,E(R,this.toBBox),E(a,this.toBBox),_?m[_-1].children.push(a):this._splitRoot(R,a)}_splitRoot(m,_){this.data=w([m,_]),this.data.height=m.height+1,this.data.leaf=!1,E(this.data,this.toBBox)}_chooseSplitIndex(m,_,R){let b,N=1/0,W=1/0;for(let a=_;a<=R-_;a++){const o=l(m,0,a,this.toBBox),r=l(m,a,R,this.toBBox),L=c(o,r),A=I(o)+I(r);L<N?(N=L,b=a,W=A<W?A:W):L===N&&A<W&&(W=A,b=a)}return b||R-_}_chooseSplitAxis(m,_,R){const b=m.leaf?this.compareMinX:P,N=m.leaf?this.compareMinY:g,W=this._allDistMargin(m,_,R,b),a=this._allDistMargin(m,_,R,N);W<a&&m.children.sort(b)}_allDistMargin(m,_,R,b){m.children.sort(b);const N=this.toBBox,W=l(m,0,_,N),a=l(m,R-_,R,N);let o=s(W)+s(a);for(let r=_;r<R-_;r++){const L=m.children[r];y(W,m.leaf?N(L):L),o+=s(W)}for(let r=R-_-1;r>=_;r--){const L=m.children[r];y(a,m.leaf?N(L):L),o+=s(a)}return o}_adjustParentBBoxes(m,_,R){for(let b=R;b>=0;b--)y(_[b],m)}_condense(m){for(let _=m.length-1,R;_>=0;_--)m[_].children.length===0?_>0?(R=m[_-1].children,R.splice(R.indexOf(m[_]),1)):this.clear():E(m[_],this.toBBox)}}function d(f,m,_){if(!_)return m.indexOf(f);for(let R=0;R<m.length;R++)if(_(f,m[R]))return R;return-1}function E(f,m){l(f,0,f.children.length,m,f)}function l(f,m,_,R,b){b||(b=w(null)),b.minX=1/0,b.minY=1/0,b.maxX=-1/0,b.maxY=-1/0;for(let N=m;N<_;N++){const W=f.children[N];y(b,f.leaf?R(W):W)}return b}function y(f,m){return f.minX=Math.min(f.minX,m.minX),f.minY=Math.min(f.minY,m.minY),f.maxX=Math.max(f.maxX,m.maxX),f.maxY=Math.max(f.maxY,m.maxY),f}function P(f,m){return f.minX-m.minX}function g(f,m){return f.minY-m.minY}function I(f){return(f.maxX-f.minX)*(f.maxY-f.minY)}function s(f){return f.maxX-f.minX+(f.maxY-f.minY)}function e(f,m){return(Math.max(m.maxX,f.maxX)-Math.min(m.minX,f.minX))*(Math.max(m.maxY,f.maxY)-Math.min(m.minY,f.minY))}function c(f,m){const _=Math.max(f.minX,m.minX),R=Math.max(f.minY,m.minY),b=Math.min(f.maxX,m.maxX),N=Math.min(f.maxY,m.maxY);return Math.max(0,b-_)*Math.max(0,N-R)}function G(f,m){return f.minX<=m.minX&&f.minY<=m.minY&&m.maxX<=f.maxX&&m.maxY<=f.maxY}function B(f,m){return m.minX<=f.maxX&&m.minY<=f.maxY&&m.maxX>=f.minX&&m.maxY>=f.minY}function w(f){return{children:f,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(f,m,_,R,b){const N=[m,_];for(;N.length;){if(_=N.pop(),m=N.pop(),_-m<=R)continue;const W=m+Math.ceil((_-m)/R/2)*R;U(f,W,m,_,b),N.push(m,W,W,_)}}},43938:(Ft,at,i)=>{i.d(at,{Ay:()=>s,RA:()=>g,f6:()=>y});var U=i(6141),p=i(6837),$=i(79332),K=i(9438),d=i(74238),E=i(7771);class l extends $.A{constructor(c,G,B,w){super(),this.extent=c,this.pixelRatio_=B,this.resolution=G,this.state=typeof w=="function"?U.A.IDLE:w,this.image_=null,this.loader=typeof w=="function"?w:null}changed(){this.dispatchEvent(p.A.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==U.A.IDLE&&this.loader){this.state=U.A.LOADING,this.changed();const c=this.getResolution(),G=Array.isArray(c)?c[0]:c;(0,d.hq)(()=>this.loader(this.getExtent(),G,this.getPixelRatio())).then(B=>{"image"in B&&(this.image_=B.image),"extent"in B&&(this.extent=B.extent),"resolution"in B&&(this.resolution=B.resolution),"pixelRatio"in B&&(this.pixelRatio_=B.pixelRatio),(B instanceof HTMLImageElement||E.XM&&B instanceof ImageBitmap||B instanceof HTMLCanvasElement||B instanceof HTMLVideoElement)&&(this.image_=B),this.state=U.A.LOADED}).catch(B=>{this.state=U.A.ERROR,console.error(B)}).finally(()=>this.changed())}}setImage(c){this.image_=c}setResolution(c){this.resolution=c}}function y(e,c,G){const B=e;let w=!0,T=!1,f=!1;const m=[(0,K.Jz)(B,p.A.LOAD,function(){f=!0,T||c()})];return B.src&&E.DT?(T=!0,B.decode().then(function(){w&&c()}).catch(function(_){w&&(f?c():G())})):m.push((0,K.Jz)(B,p.A.ERROR,G)),function(){w=!1,m.forEach(K.JH)}}function P(e,c){return new Promise((G,B)=>{function w(){f(),G(e)}function T(){f(),B(new Error("Image load error"))}function f(){e.removeEventListener("load",w),e.removeEventListener("error",T)}e.addEventListener("load",w),e.addEventListener("error",T),c&&(e.src=c)})}function g(e,c){return c&&(e.src=c),e.src&&E.DT?new Promise((G,B)=>e.decode().then(()=>G(e)).catch(w=>e.complete&&e.width?G(e):B(w))):P(e)}function I(e,c){return c&&(e.src=c),e.src&&IMAGE_DECODE&&CREATE_IMAGE_BITMAP?e.decode().then(()=>createImageBitmap(e)).catch(G=>{if(e.complete&&e.width)return e;throw G}):g(e)}const s=l},46300:(Ft,at,i)=>{i.d(at,{rd:()=>fe,q:()=>ge,G_:()=>ae,ue:()=>re,sN:()=>pe,cA:()=>Re,o3:()=>me,gU:()=>se,Bz:()=>Ie,Lc:()=>Ae});var U=i(50071),p=i(32135),$=i(10277),K=i(73445),d=i(6837),E=i(79332),l=i(9438),y=i(7771);const P={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class g extends E.A{constructor(n,D){super(n),this.map_=n,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=D===void 0?1:D,this.down_=null;const M=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=M,this.pointerdownListenerKey_=(0,l.KT)(M,P.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=(0,l.KT)(M,P.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(d.A.TOUCHMOVE,this.boundHandleTouchMove_,y.FT?{passive:!1}:!1)}emulateClick_(n){let D=new $.A(K.A.CLICK,this.map_,n);this.dispatchEvent(D),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,D=new $.A(K.A.DBLCLICK,this.map_,n),this.dispatchEvent(D)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const M=new $.A(K.A.SINGLECLICK,this.map_,n);this.dispatchEvent(M)},250)}updateActivePointers_(n){const D=n,M=D.pointerId;if(D.type==K.A.POINTERUP||D.type==K.A.POINTERCANCEL){delete this.trackedTouches_[M];for(const Q in this.trackedTouches_)if(this.trackedTouches_[Q].target!==D.target){delete this.trackedTouches_[Q];break}}else(D.type==K.A.POINTERDOWN||D.type==K.A.POINTERMOVE)&&(this.trackedTouches_[M]=D);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(n){this.updateActivePointers_(n);const D=new $.A(K.A.POINTERUP,this.map_,n,void 0,void 0,this.activePointers_);this.dispatchEvent(D),this.emulateClicks_&&!D.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(n)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(l.JH),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(n){return n.button===0}handlePointerDown_(n){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(n);const D=new $.A(K.A.POINTERDOWN,this.map_,n,void 0,void 0,this.activePointers_);if(this.dispatchEvent(D),this.down_=new PointerEvent(n.type,n),Object.defineProperty(this.down_,"target",{writable:!1,value:n.target}),this.dragListenerKeys_.length===0){const M=this.map_.getOwnerDocument();this.dragListenerKeys_.push((0,l.KT)(M,K.A.POINTERMOVE,this.handlePointerMove_,this),(0,l.KT)(M,K.A.POINTERUP,this.handlePointerUp_,this),(0,l.KT)(this.element_,K.A.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==M&&this.dragListenerKeys_.push((0,l.KT)(this.element_.getRootNode(),K.A.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(n){if(this.isMoving_(n)){this.updateActivePointers_(n),this.dragging_=!0;const D=new $.A(K.A.POINTERDRAG,this.map_,n,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(D)}}relayMoveEvent_(n){this.originalPointerMoveEvent_=n;const D=!!(this.down_&&this.isMoving_(n));this.dispatchEvent(new $.A(K.A.POINTERMOVE,this.map_,n,D))}handleTouchMove_(n){const D=this.originalPointerMoveEvent_;(!D||D.defaultPrevented)&&(typeof n.cancelable!="boolean"||n.cancelable===!0)&&n.preventDefault()}isMoving_(n){return this.dragging_||Math.abs(n.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(n.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&((0,l.JH)(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(d.A.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&((0,l.JH)(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(l.JH),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const I=g;var s=i(95801),e=i(82585);const c={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var G=i(34120),B=i(28450),w=i(11078),T=i(90588),f=i(43530);const m=1/0;class _{constructor(n,D){this.priorityFunction_=n,this.keyFunction_=D,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,(0,f.I)(this.queuedElements_)}dequeue(){const n=this.elements_,D=this.priorities_,M=n[0];n.length==1?(n.length=0,D.length=0):(n[0]=n.pop(),D[0]=D.pop(),this.siftUp_(0));const Q=this.keyFunction_(M);return delete this.queuedElements_[Q],M}enqueue(n){(0,T.v)(!(this.keyFunction_(n)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const D=this.priorityFunction_(n);return D!=m?(this.elements_.push(n),this.priorities_.push(D),this.queuedElements_[this.keyFunction_(n)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(n){return n*2+1}getRightChildIndex_(n){return n*2+2}getParentIndex_(n){return n-1>>1}heapify_(){let n;for(n=(this.elements_.length>>1)-1;n>=0;n--)this.siftUp_(n)}isEmpty(){return this.elements_.length===0}isKeyQueued(n){return n in this.queuedElements_}isQueued(n){return this.isKeyQueued(this.keyFunction_(n))}siftUp_(n){const D=this.elements_,M=this.priorities_,Q=D.length,yt=D[n],Tt=M[n],wt=n;for(;n<Q>>1;){const xe=this.getLeftChildIndex_(n),Se=this.getRightChildIndex_(n),Oe=Se<Q&&M[Se]<M[xe]?Se:xe;D[n]=D[Oe],M[n]=M[Oe],n=Oe}D[n]=yt,M[n]=Tt,this.siftDown_(wt,n)}siftDown_(n,D){const M=this.elements_,Q=this.priorities_,yt=M[D],Tt=Q[D];for(;D>n;){const wt=this.getParentIndex_(D);if(Q[wt]>Tt)M[D]=M[wt],Q[D]=Q[wt],D=wt;else break}M[D]=yt,Q[D]=Tt}reprioritize(){const n=this.priorityFunction_,D=this.elements_,M=this.priorities_;let Q=0;const yt=D.length;let Tt,wt,xe;for(wt=0;wt<yt;++wt)Tt=D[wt],xe=n(Tt),xe==m?delete this.queuedElements_[this.keyFunction_(Tt)]:(M[Q]=xe,D[Q++]=Tt);D.length=Q,M.length=Q,this.heapify_()}}const R=_;class b extends R{constructor(n,D){super(M=>n.apply(null,M),M=>M[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=D,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(n){const D=super.enqueue(n);return D&&n[0].addEventListener(d.A.CHANGE,this.boundHandleTileChange_),D}getTilesLoading(){return this.tilesLoading_}handleTileChange(n){const D=n.target,M=D.getState();if(M===w.A.LOADED||M===w.A.ERROR||M===w.A.EMPTY){M!==w.A.ERROR&&D.removeEventListener(d.A.CHANGE,this.boundHandleTileChange_);const Q=D.getKey();Q in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[Q],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(n,D){let M=0;for(;this.tilesLoading_<n&&M<D&&this.getCount()>0;){const Q=this.dequeue()[0],yt=Q.getKey();Q.getState()===w.A.IDLE&&!(yt in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[yt]=!0,++this.tilesLoading_,++M,Q.load())}}}const N=b;function W(ot,n,D,M,Q){if(!ot||!(D in ot.wantedTiles)||!ot.wantedTiles[D][n.getKey()])return m;const yt=ot.viewState.center,Tt=M[0]-yt[0],wt=M[1]-yt[1];return 65536*Math.log(Q)+Math.sqrt(Tt*Tt+wt*wt)/Q}var a=i(91765),o=i(62703),r=i(66514),L=i(54422),A=i(57456),O=i(25176),u=i(93474),x=i(10972);class S extends x.A{constructor(n){n=n||{},super({element:document.createElement("div"),render:n.render,target:n.target});const D=n.className!==void 0?n.className:"ol-rotate",M=n.label!==void 0?n.label:"\u21E7",Q=n.compassClassName!==void 0?n.compassClassName:"ol-compass";this.label_=null,typeof M=="string"?(this.label_=document.createElement("span"),this.label_.className=Q,this.label_.textContent=M):(this.label_=M,this.label_.classList.add(Q));const yt=n.tipLabel?n.tipLabel:"Reset rotation",Tt=document.createElement("button");Tt.className=D+"-reset",Tt.setAttribute("type","button"),Tt.title=yt,Tt.appendChild(this.label_),Tt.addEventListener(d.A.CLICK,this.handleClick_.bind(this),!1);const wt=D+" "+O.XI+" "+O.$N,xe=this.element;xe.className=wt,xe.appendChild(Tt),this.callResetNorth_=n.resetNorth?n.resetNorth:void 0,this.duration_=n.duration!==void 0?n.duration:250,this.autoHide_=n.autoHide!==void 0?n.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(O.Si)}handleClick_(n){n.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const D=this.getMap().getView();if(!D)return;const M=D.getRotation();M!==void 0&&(this.duration_>0&&M%(2*Math.PI)!==0?D.animate({rotation:0,duration:this.duration_,easing:u.vT}):D.setRotation(0))}render(n){const D=n.frameState;if(!D)return;const M=D.viewState.rotation;if(M!=this.rotation_){const Q="rotate("+M+"rad)";if(this.autoHide_){const yt=this.element.classList.contains(O.Si);!yt&&M===0?this.element.classList.add(O.Si):yt&&M!==0&&this.element.classList.remove(O.Si)}this.label_.style.transform=Q}this.rotation_=M}}const k=S;var tt=i(69186);function ht(ot){ot=ot||{};const n=new U.A;return(ot.zoom!==void 0?ot.zoom:!0)&&n.push(new tt.A(ot.zoomOptions)),(ot.rotate!==void 0?ot.rotate:!0)&&n.push(new k(ot.rotateOptions)),(ot.attribution!==void 0?ot.attribution:!0)&&n.push(new A.A(ot.attributionOptions)),n}var dt=i(70915),J=i(74238);class ft{constructor(n,D,M){this.decay_=n,this.minVelocity_=D,this.delay_=M,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(n,D){this.points_.push(n,D,Date.now())}end(){if(this.points_.length<6)return!1;const n=Date.now()-this.delay_,D=this.points_.length-3;if(this.points_[D+2]<n)return!1;let M=D-3;for(;M>0&&this.points_[M+2]>n;)M-=3;const Q=this.points_[D+2]-this.points_[M+2];if(Q<1e3/60)return!1;const yt=this.points_[D]-this.points_[M],Tt=this.points_[D+1]-this.points_[M+1];return this.angle_=Math.atan2(Tt,yt),this.initialVelocity_=Math.sqrt(yt*yt+Tt*Tt)/Q,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const it=ft;var st=i(6292);class gt extends st.Ay{constructor(n){super(),n=n||{},this.delta_=n.delta?n.delta:1,this.duration_=n.duration!==void 0?n.duration:250}handleEvent(n){let D=!1;if(n.type==K.A.DBLCLICK){const M=n.originalEvent,Q=n.map,yt=n.coordinate,Tt=M.shiftKey?-this.delta_:this.delta_,wt=Q.getView();(0,st.D2)(wt,Tt,yt,this.duration_),M.preventDefault(),D=!0}return!D}}const Ot=gt;var nt=i(6933),et=i(58704),Et=i(21409);class ut extends Et.A{constructor(n){super({stopDown:J.W8}),n=n||{},this.kinetic_=n.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const D=n.condition?n.condition:(0,et.Q7)(et.TS,et.fs);this.condition_=n.onFocusOnly?(0,et.Q7)(et.eL,D):D,this.noKinetic_=!1}handleDragEvent(n){const D=n.map;this.panning_||(this.panning_=!0,D.getView().beginInteraction());const M=this.targetPointers,Q=D.getEventPixel((0,Et.v)(M));if(M.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(Q[0],Q[1]),this.lastCentroid){const yt=[this.lastCentroid[0]-Q[0],Q[1]-this.lastCentroid[1]],wt=n.map.getView();(0,nt.hs)(yt,wt.getResolution()),(0,nt.e$)(yt,wt.getRotation()),wt.adjustCenterInternal(yt)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=Q,this.lastPointersCount_=M.length,n.originalEvent.preventDefault()}handleUpEvent(n){const D=n.map,M=D.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const Q=this.kinetic_.getDistance(),yt=this.kinetic_.getAngle(),Tt=M.getCenterInternal(),wt=D.getPixelFromCoordinateInternal(Tt),xe=D.getCoordinateFromPixelInternal([wt[0]-Q*Math.cos(yt),wt[1]-Q*Math.sin(yt)]);M.animateInternal({center:M.getConstrainedCenter(xe),duration:500,easing:u.vT})}return this.panning_&&(this.panning_=!1,M.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(n){if(this.targetPointers.length>0&&this.condition_(n)){const M=n.map.getView();return this.lastCentroid=null,M.getAnimating()&&M.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}const Rt=ut;var Mt=i(24498);class jt extends Et.A{constructor(n){n=n||{},super({stopDown:J.W8}),this.condition_=n.condition?n.condition:et.IO,this.lastAngle_=void 0,this.duration_=n.duration!==void 0?n.duration:250}handleDragEvent(n){if(!(0,et.A4)(n))return;const D=n.map,M=D.getView();if(M.getConstraints().rotation===Mt.b8)return;const Q=D.getSize(),yt=n.pixel,Tt=Math.atan2(Q[1]/2-yt[1],yt[0]-Q[0]/2);if(this.lastAngle_!==void 0){const wt=Tt-this.lastAngle_;M.adjustRotationInternal(-wt)}this.lastAngle_=Tt}handleUpEvent(n){return(0,et.A4)(n)?(n.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(n){return(0,et.A4)(n)&&(0,et.at)(n)&&this.condition_(n)?(n.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}const ie=jt;var Qt=i(1685),Y=i(90025),H=i(71064);class q extends Y.A{constructor(n){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+n,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const n=this.startPixel_,D=this.endPixel_,M="px",Q=this.element_.style;Q.left=Math.min(n[0],D[0])+M,Q.top=Math.min(n[1],D[1])+M,Q.width=Math.abs(D[0]-n[0])+M,Q.height=Math.abs(D[1]-n[1])+M}setMap(n){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const D=this.element_.style;D.left="inherit",D.top="inherit",D.width="inherit",D.height="inherit"}this.map_=n,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(n,D){this.startPixel_=n,this.endPixel_=D,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const n=this.startPixel_,D=this.endPixel_,Q=[n,[n[0],D[1]],D,[D[0],n[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);Q[4]=Q[0].slice(),this.geometry_?this.geometry_.setCoordinates([Q]):this.geometry_=new H.Ay([Q])}getGeometry(){return this.geometry_}}const Lt=q,Dt={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class zt extends Qt.Ay{constructor(n,D,M){super(n),this.coordinate=D,this.mapBrowserEvent=M}}class Yt extends Et.A{constructor(n){super(),this.on,this.once,this.un,n=n??{},this.box_=new Lt(n.className||"ol-dragbox"),this.minArea_=n.minArea??64,n.onBoxEnd&&(this.onBoxEnd=n.onBoxEnd),this.startPixel_=null,this.condition_=n.condition??et.at,this.boxEndCondition_=n.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(n,D,M){const Q=M[0]-D[0],yt=M[1]-D[1];return Q*Q+yt*yt>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(n){this.startPixel_&&(this.box_.setPixels(this.startPixel_,n.pixel),this.dispatchEvent(new zt(Dt.BOXDRAG,n.coordinate,n)))}handleUpEvent(n){if(!this.startPixel_)return!1;const D=this.boxEndCondition_(n,this.startPixel_,n.pixel);return D&&this.onBoxEnd(n),this.dispatchEvent(new zt(D?Dt.BOXEND:Dt.BOXCANCEL,n.coordinate,n)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(n){return this.condition_(n)?(this.startPixel_=n.pixel,this.box_.setMap(n.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new zt(Dt.BOXSTART,n.coordinate,n)),!0):!1}onBoxEnd(n){}setActive(n){n||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new zt(Dt.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(n)}setMap(n){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new zt(Dt.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(n)}}const Xt=Yt;class ee extends Xt{constructor(n){n=n||{};const D=n.condition?n.condition:et.Kg;super({condition:D,className:n.className||"ol-dragzoom",minArea:n.minArea}),this.duration_=n.duration!==void 0?n.duration:200,this.out_=n.out!==void 0?n.out:!1}onBoxEnd(n){const M=this.getMap().getView();let Q=this.getGeometry();if(this.out_){const yt=M.rotatedExtentForGeometry(Q),Tt=M.getResolutionForExtentInternal(yt),wt=M.getResolution()/Tt;Q=Q.clone(),Q.scale(wt*wt)}M.fitInternal(Q,{duration:this.duration_,easing:u.vT})}}const ne=ee,Jt={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class ue extends st.Ay{constructor(n){super(),n=n||{},this.defaultCondition_=function(D){return(0,et.TS)(D)&&(0,et.tE)(D)},this.condition_=n.condition!==void 0?n.condition:this.defaultCondition_,this.duration_=n.duration!==void 0?n.duration:100,this.pixelDelta_=n.pixelDelta!==void 0?n.pixelDelta:128}handleEvent(n){let D=!1;if(n.type==d.A.KEYDOWN){const M=n.originalEvent,Q=M.key;if(this.condition_(n)&&(Q==Jt.DOWN||Q==Jt.LEFT||Q==Jt.RIGHT||Q==Jt.UP)){const Tt=n.map.getView(),wt=Tt.getResolution()*this.pixelDelta_;let xe=0,Se=0;Q==Jt.DOWN?Se=-wt:Q==Jt.LEFT?xe=-wt:Q==Jt.RIGHT?xe=wt:Se=wt;const Oe=[xe,Se];(0,nt.e$)(Oe,Tt.getRotation()),(0,st.e4)(Tt,Oe,this.duration_),M.preventDefault(),D=!0}}return!D}}const Kt=ue;class Ce extends st.Ay{constructor(n){super(),n=n||{},this.condition_=n.condition?n.condition:function(D){return!(0,et.GB)(D)&&(0,et.tE)(D)},this.delta_=n.delta?n.delta:1,this.duration_=n.duration!==void 0?n.duration:100}handleEvent(n){let D=!1;if(n.type==d.A.KEYDOWN||n.type==d.A.KEYPRESS){const M=n.originalEvent,Q=M.key;if(this.condition_(n)&&(Q==="+"||Q==="-")){const yt=n.map,Tt=Q==="+"?this.delta_:-this.delta_,wt=yt.getView();(0,st.D2)(wt,Tt,void 0,this.duration_),M.preventDefault(),D=!0}}return!D}}const de=Ce;var V=i(88751);class F extends Et.A{constructor(n){n=n||{};const D=n;D.stopDown||(D.stopDown=J.W8),super(D),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=n.threshold!==void 0?n.threshold:.3,this.duration_=n.duration!==void 0?n.duration:250}handleDragEvent(n){let D=0;const M=this.targetPointers[0],Q=this.targetPointers[1],yt=Math.atan2(Q.clientY-M.clientY,Q.clientX-M.clientX);if(this.lastAngle_!==void 0){const xe=yt-this.lastAngle_;this.rotationDelta_+=xe,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),D=xe}this.lastAngle_=yt;const Tt=n.map,wt=Tt.getView();wt.getConstraints().rotation!==Mt.b8&&(this.anchor_=Tt.getCoordinateFromPixelInternal(Tt.getEventPixel((0,Et.v)(this.targetPointers))),this.rotating_&&(Tt.render(),wt.adjustRotationInternal(D,this.anchor_)))}handleUpEvent(n){return this.targetPointers.length<2?(n.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(n){if(this.targetPointers.length>=2){const D=n.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||D.getView().beginInteraction(),!0}return!1}}const lt=F;class mt extends Et.A{constructor(n){n=n||{};const D=n;D.stopDown||(D.stopDown=J.W8),super(D),this.anchor_=null,this.duration_=n.duration!==void 0?n.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(n){let D=1;const M=this.targetPointers[0],Q=this.targetPointers[1],yt=M.clientX-Q.clientX,Tt=M.clientY-Q.clientY,wt=Math.sqrt(yt*yt+Tt*Tt);this.lastDistance_!==void 0&&(D=this.lastDistance_/wt),this.lastDistance_=wt;const xe=n.map,Se=xe.getView();D!=1&&(this.lastScaleDelta_=D),this.anchor_=xe.getCoordinateFromPixelInternal(xe.getEventPixel((0,Et.v)(this.targetPointers))),xe.render(),Se.adjustResolutionInternal(D,this.anchor_)}handleUpEvent(n){if(this.targetPointers.length<2){const M=n.map.getView(),Q=this.lastScaleDelta_>1?1:-1;return M.endInteraction(this.duration_,Q),!1}return!0}handleDownEvent(n){if(this.targetPointers.length>=2){const D=n.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||D.getView().beginInteraction(),!0}return!1}}const It=mt;function Nt(ot){ot=ot||{};const n=new U.A,D=new it(-.005,.05,100);return(ot.altShiftDragRotate!==void 0?ot.altShiftDragRotate:!0)&&n.push(new ie),(ot.doubleClickZoom!==void 0?ot.doubleClickZoom:!0)&&n.push(new Ot({delta:ot.zoomDelta,duration:ot.zoomDuration})),(ot.dragPan!==void 0?ot.dragPan:!0)&&n.push(new Rt({onFocusOnly:ot.onFocusOnly,kinetic:D})),(ot.pinchRotate!==void 0?ot.pinchRotate:!0)&&n.push(new lt),(ot.pinchZoom!==void 0?ot.pinchZoom:!0)&&n.push(new It({duration:ot.zoomDuration})),(ot.keyboard!==void 0?ot.keyboard:!0)&&(n.push(new Kt),n.push(new de({delta:ot.zoomDelta,duration:ot.zoomDuration}))),(ot.mouseWheelZoom!==void 0?ot.mouseWheelZoom:!0)&&n.push(new V.A({onFocusOnly:ot.onFocusOnly,duration:ot.zoomDuration})),(ot.shiftDragZoom!==void 0?ot.shiftDragZoom:!0)&&n.push(new ne({duration:ot.zoomDuration})),n}var St=i(35598),Zt=i(60764),qt=i(43067),At=i(83984),kt=i(68711),Wt=i(94720),oe=i(87579),te=i(38774),_e=i(82241),ye=i(9703),Pe=i(4087);class Te extends Y.A{constructor(n){super(),this.map_=n}dispatchRenderEvent(n,D){(0,Pe.b0)()}calculateMatrices2D(n){const D=n.viewState,M=n.coordinateToPixelTransform,Q=n.pixelToCoordinateTransform;(0,ye.Zz)(M,n.size[0]/2,n.size[1]/2,1/D.resolution,-1/D.resolution,-D.rotation,-D.center[0],-D.center[1]),(0,ye.T9)(Q,M)}forEachFeatureAtCoordinate(n,D,M,Q,yt,Tt,wt,xe){let Se;const Oe=D.viewState;function Xe(Me,we,Ve,We){return yt.call(Tt,we,Me?Ve:null,We)}const Ue=Oe.projection,an=(0,nt.Li)(n.slice(),Ue),Ye=[[0,0]];if(Ue.canWrapX()&&Q){const Me=Ue.getExtent(),we=(0,dt.RG)(Me);Ye.push([-we,0],[we,0])}const Ge=D.layerStatesArray,tn=Ge.length,$e=[],en=[];for(let Me=0;Me<Ye.length;Me++)for(let we=tn-1;we>=0;--we){const Ve=Ge[we],We=Ve.layer;if(We.hasRenderer()&&(0,Zt.l)(Ve,Oe)&&wt.call(xe,We)){const Ze=We.getRenderer(),Je=We.getSource();if(Ze&&Je){const Qe=Je.getWrapX()?an:n,qe=Xe.bind(null,Ve.managed);en[0]=Qe[0]+Ye[Me][0],en[1]=Qe[1]+Ye[Me][1],Se=Ze.forEachFeatureAtCoordinate(en,D,M,qe,$e)}if(Se)return Se}}if($e.length===0)return;const ln=1/$e.length;return $e.forEach((Me,we)=>Me.distanceSq+=we*ln),$e.sort((Me,we)=>Me.distanceSq-we.distanceSq),$e.some(Me=>Se=Me.callback(Me.feature,Me.layer,Me.geometry)),Se}hasFeatureAtCoordinate(n,D,M,Q,yt,Tt){return this.forEachFeatureAtCoordinate(n,D,M,Q,J.rT,this,yt,Tt)!==void 0}getMap(){return this.map_}renderFrame(n){(0,Pe.b0)()}scheduleExpireIconCache(n){_e.ue.canExpireCache()&&n.postRenderFunctions.push(he)}}function he(ot,n){_e.ue.expire()}const le=Te;class ve extends le{constructor(n){super(n),this.fontChangeListenerKey_=(0,l.KT)(te.yY,B.A.PROPERTYCHANGE,n.redrawText,n),this.element_=document.createElement("div");const D=this.element_.style;D.position="absolute",D.width="100%",D.height="100%",D.zIndex="0",this.element_.className=O.XI+" ol-layers";const M=n.getViewport();M.insertBefore(this.element_,M.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(n,D){const M=this.getMap();if(M.hasListener(n)){const Q=new oe.A(n,void 0,D);M.dispatchEvent(Q)}}disposeInternal(){(0,l.JH)(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(n){if(!n){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(n),this.dispatchRenderEvent(At.A.PRECOMPOSE,n);const D=n.layerStatesArray.sort((wt,xe)=>wt.zIndex-xe.zIndex);D.some(wt=>wt.layer instanceof Wt.A&&wt.layer.getDeclutter())&&(n.declutter={});const Q=n.viewState;this.children_.length=0;const yt=[];let Tt=null;for(let wt=0,xe=D.length;wt<xe;++wt){const Se=D[wt];n.layerIndex=wt;const Oe=Se.layer,Xe=Oe.getSourceState();if(!(0,Zt.l)(Se,Q)||Xe!="ready"&&Xe!="undefined"){Oe.unrender();continue}const Ue=Oe.render(n,Tt);Ue&&(Ue!==Tt&&(this.children_.push(Ue),Tt=Ue),yt.push(Se))}this.declutter(n,yt),(0,kt.WM)(this.element_,this.children_),this.dispatchRenderEvent(At.A.POSTCOMPOSE,n),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(n)}declutter(n,D){if(n.declutter){for(let M=D.length-1;M>=0;--M){const Q=D[M],yt=Q.layer;yt.getDeclutter()&&yt.renderDeclutter(n,Q)}D.forEach(M=>M.layer.renderDeferred(n))}}}const Ee=ve;var pt=i(6782);function t(ot){if(ot instanceof Zt.A){ot.setMapInternal(null);return}ot instanceof St.A&&ot.getLayers().forEach(t)}function h(ot,n){if(ot instanceof Zt.A){ot.setMapInternal(n);return}if(ot instanceof St.A){const D=ot.getLayers().getArray();for(let M=0,Q=D.length;M<Q;++M)h(D[M],n)}}class v extends G.A{constructor(n){super(),n=n||{},this.on,this.once,this.un;const D=C(n);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=n.maxTilesLoading!==void 0?n.maxTilesLoading:16,this.pixelRatio_=n.pixelRatio!==void 0?n.pixelRatio:y.cr,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=(0,ye.vt)(),this.pixelToCoordinateTransform_=(0,ye.vt)(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=n.moveTolerance,this.keyboardEventTarget_=D.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=D.controls||ht(),this.interactions=D.interactions||Nt({onFocusOnly:!0}),this.overlays_=D.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new N(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(c.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(c.VIEW,this.handleViewChanged_),this.addChangeListener(c.SIZE,this.handleSizeChanged_),this.addChangeListener(c.TARGET,this.handleTargetChanged_),this.setProperties(D.values);const M=this;n.view&&!(n.view instanceof a.Ay)&&n.view.then(function(Q){M.setView(new a.Ay(Q))}),this.controls.addEventListener(p.A.ADD,Q=>{Q.element.setMap(this)}),this.controls.addEventListener(p.A.REMOVE,Q=>{Q.element.setMap(null)}),this.interactions.addEventListener(p.A.ADD,Q=>{Q.element.setMap(this)}),this.interactions.addEventListener(p.A.REMOVE,Q=>{Q.element.setMap(null)}),this.overlays_.addEventListener(p.A.ADD,Q=>{this.addOverlayInternal_(Q.element)}),this.overlays_.addEventListener(p.A.REMOVE,Q=>{const yt=Q.element.getId();yt!==void 0&&delete this.overlayIdIndex_[yt.toString()],Q.element.setMap(null)}),this.controls.forEach(Q=>{Q.setMap(this)}),this.interactions.forEach(Q=>{Q.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(n){this.getControls().push(n)}addInteraction(n){this.getInteractions().push(n)}addLayer(n){this.getLayerGroup().getLayers().push(n)}handleLayerAdd_(n){h(n.layer,this)}addOverlay(n){this.getOverlays().push(n)}addOverlayInternal_(n){const D=n.getId();D!==void 0&&(this.overlayIdIndex_[D.toString()]=n),n.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(n,D,M){if(!this.frameState_||!this.renderer_)return;const Q=this.getCoordinateFromPixelInternal(n);M=M!==void 0?M:{};const yt=M.hitTolerance!==void 0?M.hitTolerance:0,Tt=M.layerFilter!==void 0?M.layerFilter:J.rT,wt=M.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(Q,this.frameState_,yt,wt,D,null,Tt,null)}getFeaturesAtPixel(n,D){const M=[];return this.forEachFeatureAtPixel(n,function(Q){M.push(Q)},D),M}getAllLayers(){const n=[];function D(M){M.forEach(function(Q){Q instanceof St.A?D(Q.getLayers()):n.push(Q)})}return D(this.getLayers()),n}hasFeatureAtPixel(n,D){if(!this.frameState_||!this.renderer_)return!1;const M=this.getCoordinateFromPixelInternal(n);D=D!==void 0?D:{};const Q=D.layerFilter!==void 0?D.layerFilter:J.rT,yt=D.hitTolerance!==void 0?D.hitTolerance:0,Tt=D.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(M,this.frameState_,yt,Tt,Q,null)}getEventCoordinate(n){return this.getCoordinateFromPixel(this.getEventPixel(n))}getEventCoordinateInternal(n){return this.getCoordinateFromPixelInternal(this.getEventPixel(n))}getEventPixel(n){const M=this.viewport_.getBoundingClientRect(),Q=this.getSize(),yt=M.width/Q[0],Tt=M.height/Q[1],wt="changedTouches"in n?n.changedTouches[0]:n;return[(wt.clientX-M.left)/yt,(wt.clientY-M.top)/Tt]}getTarget(){return this.get(c.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(n){return(0,qt.te)(this.getCoordinateFromPixelInternal(n),this.getView().getProjection())}getCoordinateFromPixelInternal(n){const D=this.frameState_;return D?(0,ye.Bb)(D.pixelToCoordinateTransform,n.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(n){const D=this.overlayIdIndex_[n.toString()];return D!==void 0?D:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(c.LAYERGROUP)}setLayers(n){const D=this.getLayerGroup();if(n instanceof U.A){D.setLayers(n);return}const M=D.getLayers();M.clear(),M.extend(n)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const n=this.getLayerGroup().getLayerStatesArray();for(let D=0,M=n.length;D<M;++D){const Q=n[D];if(!Q.visible)continue;const yt=Q.layer.getRenderer();if(yt&&!yt.ready)return!0;const Tt=Q.layer.getSource();if(Tt&&Tt.loading)return!0}return!1}getPixelFromCoordinate(n){const D=(0,qt.Ad)(n,this.getView().getProjection());return this.getPixelFromCoordinateInternal(D)}getPixelFromCoordinateInternal(n){const D=this.frameState_;return D?(0,ye.Bb)(D.coordinateToPixelTransform,n.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(c.SIZE)}getView(){return this.get(c.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const n=this.getTargetElement();return n?n.ownerDocument:document}getTilePriority(n,D,M,Q){return W(this.frameState_,n,D,M,Q)}handleBrowserEvent(n,D){D=D||n.type;const M=new $.A(D,this,n);this.handleMapBrowserEvent(M)}handleMapBrowserEvent(n){if(!this.frameState_)return;const D=n.originalEvent,M=D.type;if(M===P.POINTERDOWN||M===d.A.WHEEL||M===d.A.KEYDOWN){const Q=this.getOwnerDocument(),yt=this.viewport_.getRootNode?this.viewport_.getRootNode():Q,Tt=D.target,wt=yt instanceof ShadowRoot?yt.host===Tt?yt.host.ownerDocument:yt:yt===Q?Q.documentElement:yt;if(this.overlayContainerStopEvent_.contains(Tt)||!wt.contains(Tt))return}if(n.frameState=this.frameState_,this.dispatchEvent(n)!==!1){const Q=this.getInteractions().getArray().slice();for(let yt=Q.length-1;yt>=0;yt--){const Tt=Q[yt];if(Tt.getMap()!==this||!Tt.getActive()||!this.getTargetElement())continue;if(!Tt.handleEvent(n)||n.propagationStopped)break}}}handlePostRender(){const n=this.frameState_,D=this.tileQueue_;if(!D.isEmpty()){let Q=this.maxTilesLoading_,yt=Q;if(n){const Tt=n.viewHints;if(Tt[o.A.ANIMATING]||Tt[o.A.INTERACTING]){const wt=Date.now()-n.time>8;Q=wt?0:8,yt=wt?0:2}}D.getTilesLoading()<Q&&(D.reprioritize(),D.loadMoreTiles(Q,yt))}n&&this.renderer_&&!n.animate&&(this.renderComplete_?(this.hasListener(At.A.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(At.A.RENDERCOMPLETE,n),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new s.A(e.A.LOADEND,this,n)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new s.A(e.A.LOADSTART,this,n))));const M=this.postRenderFunctions_;if(n)for(let Q=0,yt=M.length;Q<yt;++Q)M[Q](this,n);M.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let M=0,Q=this.targetChangeHandlerKeys_.length;M<Q;++M)(0,l.JH)(this.targetChangeHandlerKeys_[M]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(d.A.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(d.A.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const M=this.targetElement_.getRootNode();M instanceof ShadowRoot&&this.resizeObserver_.unobserve(M.host),this.setSize(void 0)}const n=this.getTarget(),D=typeof n=="string"?document.getElementById(n):n;if(this.targetElement_=D,!D)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{D.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Ee(this)),this.mapBrowserEventHandler_=new I(this,this.moveTolerance_);for(const yt in K.A)this.mapBrowserEventHandler_.addEventListener(K.A[yt],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(d.A.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(d.A.WHEEL,this.boundHandleBrowserEvent_,y.FT?{passive:!1}:!1);let M;if(this.keyboardEventTarget_)M=this.keyboardEventTarget_;else{const yt=D.getRootNode();M=yt instanceof ShadowRoot?yt.host:D}this.targetChangeHandlerKeys_=[(0,l.KT)(M,d.A.KEYDOWN,this.handleBrowserEvent,this),(0,l.KT)(M,d.A.KEYPRESS,this.handleBrowserEvent,this)];const Q=D.getRootNode();Q instanceof ShadowRoot&&this.resizeObserver_.observe(Q.host),this.resizeObserver_.observe(D)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&((0,l.JH)(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&((0,l.JH)(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const n=this.getView();n&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=(0,l.KT)(n,B.A.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=(0,l.KT)(n,d.A.CHANGE,this.handleViewPropertyChanged_,this),n.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(l.JH),this.layerGroupPropertyListenerKeys_=null);const n=this.getLayerGroup();n&&(this.handleLayerAdd_(new St.i("addlayer",n)),this.layerGroupPropertyListenerKeys_=[(0,l.KT)(n,B.A.PROPERTYCHANGE,this.render,this),(0,l.KT)(n,d.A.CHANGE,this.render,this),(0,l.KT)(n,"addlayer",this.handleLayerAdd_,this),(0,l.KT)(n,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const n=this.frameState_.layerStatesArray;for(let D=0,M=n.length;D<M;++D){const Q=n[D].layer;Q.hasRenderer()&&Q.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(n){return this.getControls().remove(n)}removeInteraction(n){return this.getInteractions().remove(n)}removeLayer(n){return this.getLayerGroup().getLayers().remove(n)}handleLayerRemove_(n){t(n.layer)}removeOverlay(n){return this.getOverlays().remove(n)}renderFrame_(n){const D=this.getSize(),M=this.getView(),Q=this.frameState_;let yt=null;if(D!==void 0&&(0,pt.Ie)(D)&&M&&M.isDef()){const Tt=M.getHints(this.frameState_?this.frameState_.viewHints:void 0),wt=M.getState();if(yt={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:(0,dt.Bg)(wt.center,wt.resolution,wt.rotation,D),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:D,tileQueue:this.tileQueue_,time:n,usedTiles:{},viewState:wt,viewHints:Tt,wantedTiles:{},mapId:(0,Pe.v6)(this),renderTargets:{}},wt.nextCenter&&wt.nextResolution){const xe=isNaN(wt.nextRotation)?wt.rotation:wt.nextRotation;yt.nextExtent=(0,dt.Bg)(wt.nextCenter,wt.nextResolution,xe,D)}}this.frameState_=yt,this.renderer_.renderFrame(yt),yt&&(yt.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,yt.postRenderFunctions),Q&&(!this.previousExtent_||!(0,dt.Im)(this.previousExtent_)&&!(0,dt.aI)(yt.extent,this.previousExtent_))&&(this.dispatchEvent(new s.A(e.A.MOVESTART,this,Q)),this.previousExtent_=(0,dt.aZ)(this.previousExtent_)),this.previousExtent_&&!yt.viewHints[o.A.ANIMATING]&&!yt.viewHints[o.A.INTERACTING]&&!(0,dt.aI)(yt.extent,this.previousExtent_)&&(this.dispatchEvent(new s.A(e.A.MOVEEND,this,yt)),(0,dt.o8)(yt.extent,this.previousExtent_))),this.dispatchEvent(new s.A(e.A.POSTRENDER,this,yt)),this.renderComplete_=(this.hasListener(e.A.LOADSTART)||this.hasListener(e.A.LOADEND)||this.hasListener(At.A.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(n){const D=this.getLayerGroup();D&&this.handleLayerRemove_(new St.i("removelayer",D)),this.set(c.LAYERGROUP,n)}setSize(n){this.set(c.SIZE,n)}setTarget(n){this.set(c.TARGET,n)}setView(n){if(!n||n instanceof a.Ay){this.set(c.VIEW,n);return}this.set(c.VIEW,new a.Ay);const D=this;n.then(function(M){D.setView(new a.Ay(M))})}updateSize(){const n=this.getTargetElement();let D;if(n){const Q=getComputedStyle(n),yt=n.offsetWidth-parseFloat(Q.borderLeftWidth)-parseFloat(Q.paddingLeft)-parseFloat(Q.paddingRight)-parseFloat(Q.borderRightWidth),Tt=n.offsetHeight-parseFloat(Q.borderTopWidth)-parseFloat(Q.paddingTop)-parseFloat(Q.paddingBottom)-parseFloat(Q.borderBottomWidth);!isNaN(yt)&&!isNaN(Tt)&&(D=[Math.max(0,yt),Math.max(0,Tt)],!(0,pt.Ie)(D)&&(n.offsetWidth||n.offsetHeight||n.getClientRects().length)&&(0,L.R8)("No map visible because the map container's width or height are 0."))}const M=this.getSize();D&&(!M||!(0,r.aI)(D,M))&&(this.setSize(D),this.updateViewportSize_(D))}updateViewportSize_(n){const D=this.getView();D&&D.setViewportSize(n)}}function C(ot){let n=null;ot.keyboardEventTarget!==void 0&&(n=typeof ot.keyboardEventTarget=="string"?document.getElementById(ot.keyboardEventTarget):ot.keyboardEventTarget);const D={},M=ot.layers&&typeof ot.layers.getLayers=="function"?ot.layers:new St.A({layers:ot.layers});D[c.LAYERGROUP]=M,D[c.TARGET]=ot.target,D[c.VIEW]=ot.view instanceof a.Ay?ot.view:new a.Ay;let Q;ot.controls!==void 0&&(Array.isArray(ot.controls)?Q=new U.A(ot.controls.slice()):((0,T.v)(typeof ot.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),Q=ot.controls));let yt;ot.interactions!==void 0&&(Array.isArray(ot.interactions)?yt=new U.A(ot.interactions.slice()):((0,T.v)(typeof ot.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),yt=ot.interactions));let Tt;return ot.overlays!==void 0?Array.isArray(ot.overlays)?Tt=new U.A(ot.overlays.slice()):((0,T.v)(typeof ot.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),Tt=ot.overlays):Tt=new U.A,{controls:Q,interactions:yt,keyboardEventTarget:n,overlays:Tt,values:D}}const j=v;var z=i(69796);class Z extends Zt.A{constructor(n){n=n||{},super(n)}}const X=Z;class ct extends X{constructor(n){super(n)}createRenderer(){return new z.A(this)}getData(n){return super.getData(n)}}const rt=ct;var _t=i(13504),vt=i(82986),xt=i(48997),Pt=i(63425),Bt=i(92745),Ct=i(2863),bt=i(54825),Gt=i(57444),$t=i(88011),Ut=i(28807),Vt=i(16310),Ht=i(53497);function re(ot,n,D,M){const Q={};return M&&Object.keys(M).length?(Q.color=(0,bt.K)(ot,M.color??Ht.T5.color,D),Q.size=(0,$t.hX)(ot,M.size??Ht.T5.size),Q.rotation=(0,Gt.H)(ot,M.rotation??Ht.T5.rotation),M.text&&(M.text.field||M.text.fixed)&&(Q.text=(0,Ut.E)(ot,M.text))):n.fields&&(n.fields.color&&(Q.color=(0,bt.K)(ot,n.config.color??Ht.T5.color,D)),n.fields.size&&(Q.size=(0,$t.hX)(ot,n.config.size??Ht.T5.size)),n.fields.text&&(Q.text=(0,Ut.E)(ot,n.config.text)),n.fields.rotation&&(Q.rotation=(0,Gt.H)(ot,n.config.rotation??Ht.T5.rotation))),Q}let ce;function ae(){return ce||(ce=[],De()),ce}async function De(){const ot=await(0,Vt.o)();for(let n of["maps","gazetteer"])ot.listFiles(n).subscribe({next:D=>{D.forEach(M=>{if(M.name.endsWith(".geojson")){const Q=`public/${n}/${M.name}`;ce.push({value:Q,label:Q})}})}})}const Re=ot=>(0,Ct.w)().containsTemplate(JSON.stringify(ot)),fe=(ot,n,D)=>{const M=ot.initMapView(n.view);return ot.map=new j({view:M,pixelRatio:window.devicePixelRatio,layers:[],controls:[],target:D,interactions:Nt({mouseWheelZoom:!1})})},Ae=(ot,n)=>{ot.initControls(n.controls),ot.forceUpdate()},Ie=(ot,n,D)=>{ot.panelContext&&ot.panelContext.onInstanceStateChange&&ot.panelContext.onInstanceStateChange({map:ot.map,layers:n,selected:D,actions:ot.actions})},ge=ot=>{let n=ot.layers.length;for(;n<100;){const D=(0,Bt.t)("geomap.utils.get-next-layer-name","Layer {{name}}",{name:n++});if(!ot.byName.has(D))return D}return(0,Bt.t)("geomap.utils.get-next-layer-name","Layer {{name}}",{name:Date.now()})};function me(ot,n,D,M){const Q=ot.getPixelFromCoordinate(D),yt=ot.getPixelFromCoordinate(M),Tt=Math.abs(Q[0]-yt[0]),wt=Math.abs(Q[1]-yt[1]);return Tt>n||wt>n}const se=ot=>{try{return new URL(ot).protocol.includes("http")}catch{return!1}};function pe(ot){if(ot instanceof St.A)return ot.getLayers().getArray().some(n=>pe(n));if(ot instanceof vt.A||ot instanceof xt.A){const n=ot.getSource();return n!=null&&n.getFeatures().length>0}if(ot instanceof Pt.A){const n=ot.getSource();return n!=null&&n.getFeatures().length>0}return ot instanceof _t.A||ot instanceof rt?!!ot.getSource():!1}},48997:(Ft,at,i)=>{i.d(at,{A:()=>w});var U=i(42375),p=i(43938),$=i(6141);class K extends p.Ay{constructor(f,m,_,R,b){const N=b!==void 0?$.A.IDLE:$.A.LOADED;super(f,m,_,N),this.loader_=b!==void 0?b:null,this.canvas_=R,this.error_=null}getError(){return this.error_}handleLoad_(f){f?(this.error_=f,this.state=$.A.ERROR):this.state=$.A.LOADED,this.changed()}load(){this.state==$.A.IDLE&&(this.state=$.A.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}}const d=K;var E=i(62703),l=i(6837),y=i(70915);function P(T){return Array.isArray(T)?Math.min(...T):T}var g=i(9703),I=i(69796),s=i(65896);class e extends I.A{constructor(f){super(f),this.vectorRenderer_=new s.A(f),this.layerImageRatio_=f.getImageRatio(),this.coordinateToVectorPixelTransform_=(0,g.vt)(),this.renderedPixelToCoordinateTransform_=null}disposeInternal(){this.vectorRenderer_.dispose(),super.disposeInternal()}getFeatures(f){if(!this.vectorRenderer_)return Promise.resolve([]);const m=(0,g.Bb)(this.coordinateToVectorPixelTransform_,(0,g.Bb)(this.renderedPixelToCoordinateTransform_,f.slice()));return this.vectorRenderer_.getFeatures(m)}handleFontsChanged(){this.vectorRenderer_.handleFontsChanged()}prepareFrame(f){const m=f.pixelRatio,_=f.viewState,R=_.resolution,b=f.viewHints,N=this.vectorRenderer_;let W=f.extent;this.layerImageRatio_!==1&&(W=W.slice(0),(0,y.Af)(W,this.layerImageRatio_));const a=(0,y.RG)(W)/R,o=(0,y.Oq)(W)/R;if(!b[E.A.ANIMATING]&&!b[E.A.INTERACTING]&&!(0,y.Im)(W)){N.useContainer(null,null);const r=N.context,L=f.layerStatesArray[f.layerIndex],A=Object.assign({},L,{opacity:1}),O=Object.assign({},f,{extent:W,size:[a,o],viewState:Object.assign({},f.viewState,{rotation:0}),layerStatesArray:[A],layerIndex:0,declutter:null}),u=this.getLayer().getDeclutter();u&&(O.declutter={[u]:new U.A(9)});const x=new d(W,R,m,r.canvas,function(S){N.prepareFrame(O)&&N.replayGroupChanged&&(N.clipping=!1,N.renderFrame(O,null),N.renderDeclutter(O),N.renderDeferred(O),S())});x.addEventListener(l.A.CHANGE,()=>{if(x.getState()!==$.A.LOADED)return;this.image=x;const S=x.getPixelRatio(),k=P(x.getResolution())*m/S;this.renderedResolution=k,this.coordinateToVectorPixelTransform_=(0,g.Zz)(this.coordinateToVectorPixelTransform_,a/2,o/2,1/k,-1/k,0,-_.center[0],-_.center[1])}),x.load()}return this.image&&(this.renderedPixelToCoordinateTransform_=f.pixelToCoordinateTransform.slice()),!this.getLayer().getSource()?.loading&&!!this.image}preRender(){}postRender(){}renderDeclutter(){}forEachFeatureAtCoordinate(f,m,_,R,b){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(f,m,_,R,b):super.forEachFeatureAtCoordinate(f,m,_,R,b)}}const c=e;var G=i(94720);class B extends G.A{constructor(f){f=f||{};const m=Object.assign({},f);delete m.imageRatio,super(m),this.imageRatio_=f.imageRatio!==void 0?f.imageRatio:1}getImageRatio(){return this.imageRatio_}createRenderer(){return new c(this)}}const w=B},49189:(Ft,at,i)=>{i.d(at,{v:()=>p});var U=i(70915);function p($,K){const d=$.viewState.projection,l=K.getSource().getWrapX()&&d.canWrapX(),y=d.getExtent(),P=$.extent,g=l?(0,U.RG)(y):null,I=l?Math.ceil((P[2]-y[2])/g)+1:1;return[l?Math.floor((P[0]-y[0])/g):0,I,g]}},49700:(Ft,at,i)=>{i.d(at,{A:()=>g});var U=i(6141),p=i(90588),$=i(89352),K=i(6837),d=i(4087),E=i(97907),l=i(10940);function y(I,s,e,c){return e!==void 0&&c!==void 0?[e/I,c/s]:e!==void 0?e/I:c!==void 0?c/s:1}class P extends l.A{constructor(s){s=s||{};const e=s.opacity!==void 0?s.opacity:1,c=s.rotation!==void 0?s.rotation:0,G=s.scale!==void 0?s.scale:1,B=s.rotateWithView!==void 0?s.rotateWithView:!1;super({opacity:e,rotation:c,scale:G,displacement:s.displacement!==void 0?s.displacement:[0,0],rotateWithView:B,declutterMode:s.declutterMode}),this.anchor_=s.anchor!==void 0?s.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=s.anchorOrigin!==void 0?s.anchorOrigin:"top-left",this.anchorXUnits_=s.anchorXUnits!==void 0?s.anchorXUnits:"fraction",this.anchorYUnits_=s.anchorYUnits!==void 0?s.anchorYUnits:"fraction",this.crossOrigin_=s.crossOrigin!==void 0?s.crossOrigin:null;const w=s.img!==void 0?s.img:null;let T=s.src;(0,p.v)(!(T!==void 0&&w),"`image` and `src` cannot be provided at the same time"),(T===void 0||T.length===0)&&w&&(T=w.src||(0,d.v6)(w)),(0,p.v)(T!==void 0&&T.length>0,"A defined and non-empty `src` or `image` must be provided"),(0,p.v)(!((s.width!==void 0||s.height!==void 0)&&s.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let f;if(s.src!==void 0?f=U.A.IDLE:w!==void 0&&("complete"in w?w.complete?f=w.src?U.A.LOADED:U.A.IDLE:f=U.A.LOADING:f=U.A.LOADED),this.color_=s.color!==void 0?(0,$._j)(s.color):null,this.iconImage_=(0,E.J)(w,T,this.crossOrigin_,f,this.color_),this.offset_=s.offset!==void 0?s.offset:[0,0],this.offsetOrigin_=s.offsetOrigin!==void 0?s.offsetOrigin:"top-left",this.origin_=null,this.size_=s.size!==void 0?s.size:null,this.initialOptions_,s.width!==void 0||s.height!==void 0){let m,_;if(s.size)[m,_]=s.size;else{const R=this.getImage(1);if(R.width&&R.height)m=R.width,_=R.height;else if(R instanceof HTMLImageElement){this.initialOptions_=s;const b=()=>{if(this.unlistenImageChange(b),!this.initialOptions_)return;const N=this.iconImage_.getSize();this.setScale(y(N[0],N[1],s.width,s.height))};this.listenImageChange(b);return}}m!==void 0&&this.setScale(y(m,_,s.width,s.height))}}clone(){let s,e,c;return this.initialOptions_?(e=this.initialOptions_.width,c=this.initialOptions_.height):(s=this.getScale(),s=Array.isArray(s)?s.slice():s),new P({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:s,width:e,height:c,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let s=this.normalizedAnchor_;if(!s){s=this.anchor_;const G=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!G)return null;s=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(s[0]*=G[0]),this.anchorYUnits_=="fraction"&&(s[1]*=G[1])}if(this.anchorOrigin_!="top-left"){if(!G)return null;s===this.anchor_&&(s=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(s[0]=-s[0]+G[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(s[1]=-s[1]+G[1])}this.normalizedAnchor_=s}const e=this.getDisplacement(),c=this.getScaleArray();return[s[0]-e[0]/c[0],s[1]+e[1]/c[1]]}setAnchor(s){this.anchor_=s,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(s){return this.iconImage_.getImage(s)}getPixelRatio(s){return this.iconImage_.getPixelRatio(s)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let s=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),c=this.iconImage_.getSize();if(!e||!c)return null;s=s.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(s[0]=c[0]-e[0]-s[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(s[1]=c[1]-e[1]-s[1])}return this.origin_=s,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const s=this.getScaleArray();if(this.size_)return this.size_[0]*s[0];if(this.iconImage_.getImageState()==U.A.LOADED)return this.iconImage_.getSize()[0]*s[0]}getHeight(){const s=this.getScaleArray();if(this.size_)return this.size_[1]*s[1];if(this.iconImage_.getImageState()==U.A.LOADED)return this.iconImage_.getSize()[1]*s[1]}setScale(s){delete this.initialOptions_,super.setScale(s)}listenImageChange(s){this.iconImage_.addEventListener(K.A.CHANGE,s)}load(){this.iconImage_.load()}unlistenImageChange(s){this.iconImage_.removeEventListener(K.A.CHANGE,s)}ready(){return this.iconImage_.ready()}}const g=P},49825:(Ft,at,i)=>{i.d(at,{DG:()=>_,Fq:()=>g,SR:()=>R,T8:()=>E,Ye:()=>Ot,ZD:()=>N,_D:()=>m,cT:()=>y,go:()=>B,mE:()=>P,qA:()=>I,qg:()=>b,wl:()=>l});var U=i(66514),p=i(89352),$=i(6782);let K=0;const d=0,E=1<<K++,l=1<<K++,y=1<<K++,P=1<<K++,g=1<<K++,I=1<<K++,s=Math.pow(2,K)-1,e={[E]:"boolean",[l]:"number",[y]:"string",[P]:"color",[g]:"number[]",[I]:"size"},c=Object.keys(e).map(Number).sort(U.V_);function G(nt){return nt in e}function B(nt){const et=[];for(const Et of c)w(nt,Et)&&et.push(e[Et]);return et.length===0?"untyped":et.length<3?et.join(" or "):et.slice(0,-1).join(", ")+", or "+et[et.length-1]}function w(nt,et){return(nt&et)===et}function T(nt,et){return!!(nt&et)}function f(nt,et){return nt===et}class m{constructor(et,Et){if(!G(et))throw new Error(`literal expressions must have a specific type, got ${B(et)}`);this.type=et,this.value=Et}}class _{constructor(et,Et,...ut){this.type=et,this.operator=Et,this.args=ut}}function R(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function b(nt,et,Et){switch(typeof nt){case"boolean":{if(f(et,y))return new m(y,nt?"true":"false");if(!w(et,E))throw new Error(`got a boolean, but expected ${B(et)}`);return new m(E,nt)}case"number":{if(f(et,I))return new m(I,(0,$.xq)(nt));if(f(et,E))return new m(E,!!nt);if(f(et,y))return new m(y,nt.toString());if(!w(et,l))throw new Error(`got a number, but expected ${B(et)}`);return new m(l,nt)}case"string":{if(f(et,P))return new m(P,(0,p.sH)(nt));if(f(et,E))return new m(E,!!nt);if(!w(et,y))throw new Error(`got a string, but expected ${B(et)}`);return new m(y,nt)}default:}if(!Array.isArray(nt))throw new Error("expression must be an array or a primitive value");if(nt.length===0)throw new Error("empty expression");if(typeof nt[0]=="string")return gt(nt,et,Et);for(const ut of nt)if(typeof ut!="number")throw new Error("expected an array of numbers");if(f(et,I)){if(nt.length!==2)throw new Error(`expected an array of two values for a size, got ${nt.length}`);return new m(I,nt)}if(f(et,P)){if(nt.length===3)return new m(P,[...nt,1]);if(nt.length===4)return new m(P,nt);throw new Error(`expected an array of 3 or 4 values for a color, got ${nt.length}`)}if(!w(et,g))throw new Error(`got an array of numbers, but expected ${B(et)}`);return new m(g,nt)}const N={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},W={[N.Get]:st(u(1,1/0),a),[N.Var]:st(u(1,1),o),[N.Has]:st(u(1,1/0),a),[N.Id]:st(r,O),[N.Concat]:st(u(2,1/0),S(y)),[N.GeometryType]:st(L,O),[N.LineMetric]:st(O),[N.Resolution]:st(A,O),[N.Zoom]:st(A,O),[N.Time]:st(A,O),[N.Any]:st(u(2,1/0),S(E)),[N.All]:st(u(2,1/0),S(E)),[N.Not]:st(u(1,1),S(E)),[N.Equal]:st(u(2,2),S(s)),[N.NotEqual]:st(u(2,2),S(s)),[N.GreaterThan]:st(u(2,2),S(l)),[N.GreaterThanOrEqualTo]:st(u(2,2),S(l)),[N.LessThan]:st(u(2,2),S(l)),[N.LessThanOrEqualTo]:st(u(2,2),S(l)),[N.Multiply]:st(u(2,1/0),x),[N.Coalesce]:st(u(2,1/0),x),[N.Divide]:st(u(2,2),S(l)),[N.Add]:st(u(2,1/0),S(l)),[N.Subtract]:st(u(2,2),S(l)),[N.Clamp]:st(u(3,3),S(l)),[N.Mod]:st(u(2,2),S(l)),[N.Pow]:st(u(2,2),S(l)),[N.Abs]:st(u(1,1),S(l)),[N.Floor]:st(u(1,1),S(l)),[N.Ceil]:st(u(1,1),S(l)),[N.Round]:st(u(1,1),S(l)),[N.Sin]:st(u(1,1),S(l)),[N.Cos]:st(u(1,1),S(l)),[N.Atan]:st(u(1,2),S(l)),[N.Sqrt]:st(u(1,1),S(l)),[N.Match]:st(u(4,1/0),tt,ht),[N.Between]:st(u(3,3),S(l)),[N.Interpolate]:st(u(6,1/0),tt,dt),[N.Case]:st(u(3,1/0),k,J),[N.In]:st(u(2,2),ft),[N.Number]:st(u(1,1/0),S(s)),[N.String]:st(u(1,1/0),S(s)),[N.Array]:st(u(1,1/0),S(l)),[N.Color]:st(u(1,4),S(l)),[N.Band]:st(u(1,3),S(l)),[N.Palette]:st(u(2,2),it),[N.ToString]:st(u(1,1),S(E|l|y|P))};function a(nt,et,Et){const ut=nt.length-1,Rt=new Array(ut);for(let Mt=0;Mt<ut;++Mt){const jt=nt[Mt+1];switch(typeof jt){case"number":{Rt[Mt]=new m(l,jt);break}case"string":{Rt[Mt]=new m(y,jt);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${jt}`)}Mt===0&&Et.properties.add(String(jt))}return Rt}function o(nt,et,Et){const ut=nt[1];if(typeof ut!="string")throw new Error("expected a string argument for var operation");return Et.variables.add(ut),[new m(y,ut)]}function r(nt,et,Et){Et.featureId=!0}function L(nt,et,Et){Et.geometryType=!0}function A(nt,et,Et){Et.mapState=!0}function O(nt,et,Et){const ut=nt[0];if(nt.length!==1)throw new Error(`expected no arguments for ${ut} operation`);return[]}function u(nt,et){return function(Et,ut,Rt){const Mt=Et[0],jt=Et.length-1;if(nt===et){if(jt!==nt){const ie=nt===1?"":"s";throw new Error(`expected ${nt} argument${ie} for ${Mt}, got ${jt}`)}}else if(jt<nt||jt>et){const ie=et===1/0?`${nt} or more`:`${nt} to ${et}`;throw new Error(`expected ${ie} arguments for ${Mt}, got ${jt}`)}}}function x(nt,et,Et){const ut=nt.length-1,Rt=new Array(ut);for(let Mt=0;Mt<ut;++Mt){const jt=b(nt[Mt+1],et,Et);Rt[Mt]=jt}return Rt}function S(nt){return function(et,Et,ut){const Rt=et.length-1,Mt=new Array(Rt);for(let jt=0;jt<Rt;++jt){const ie=b(et[jt+1],nt,ut);Mt[jt]=ie}return Mt}}function k(nt,et,Et){const ut=nt[0],Rt=nt.length-1;if(Rt%2===0)throw new Error(`expected an odd number of arguments for ${ut}, got ${Rt} instead`)}function tt(nt,et,Et){const ut=nt[0],Rt=nt.length-1;if(Rt%2===1)throw new Error(`expected an even number of arguments for operation ${ut}, got ${Rt} instead`)}function ht(nt,et,Et){const ut=nt.length-1,Rt=y|l|E,Mt=b(nt[1],Rt,Et),jt=b(nt[nt.length-1],et,Et),ie=new Array(ut-2);for(let Qt=0;Qt<ut-2;Qt+=2){try{const Y=b(nt[Qt+2],Mt.type,Et);ie[Qt]=Y}catch(Y){throw new Error(`failed to parse argument ${Qt+1} of match expression: ${Y.message}`)}try{const Y=b(nt[Qt+3],jt.type,Et);ie[Qt+1]=Y}catch(Y){throw new Error(`failed to parse argument ${Qt+2} of match expression: ${Y.message}`)}}return[Mt,...ie,jt]}function dt(nt,et,Et){const ut=nt[1];let Rt;switch(ut[0]){case"linear":Rt=1;break;case"exponential":const Qt=ut[1];if(typeof Qt!="number"||Qt<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(Qt)} instead`);Rt=Qt;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(ut)}`)}const Mt=new m(l,Rt);let jt;try{jt=b(nt[2],l,Et)}catch(Qt){throw new Error(`failed to parse argument 1 in interpolate expression: ${Qt.message}`)}const ie=new Array(nt.length-3);for(let Qt=0;Qt<ie.length;Qt+=2){try{const Y=b(nt[Qt+3],l,Et);ie[Qt]=Y}catch(Y){throw new Error(`failed to parse argument ${Qt+2} for interpolate expression: ${Y.message}`)}try{const Y=b(nt[Qt+4],et,Et);ie[Qt+1]=Y}catch(Y){throw new Error(`failed to parse argument ${Qt+3} for interpolate expression: ${Y.message}`)}}return[Mt,jt,...ie]}function J(nt,et,Et){const ut=b(nt[nt.length-1],et,Et),Rt=new Array(nt.length-1);for(let Mt=0;Mt<Rt.length-1;Mt+=2){try{const jt=b(nt[Mt+1],E,Et);Rt[Mt]=jt}catch(jt){throw new Error(`failed to parse argument ${Mt} of case expression: ${jt.message}`)}try{const jt=b(nt[Mt+2],ut.type,Et);Rt[Mt+1]=jt}catch(jt){throw new Error(`failed to parse argument ${Mt+1} of case expression: ${jt.message}`)}}return Rt[Rt.length-1]=ut,Rt}function ft(nt,et,Et){let ut=nt[2];if(!Array.isArray(ut))throw new Error('the second argument for the "in" operator must be an array');let Rt;if(typeof ut[0]=="string"){if(ut[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(ut[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');ut=ut[1],Rt=y}else Rt=l;const Mt=new Array(ut.length);for(let ie=0;ie<Mt.length;ie++)try{const Qt=b(ut[ie],Rt,Et);Mt[ie]=Qt}catch(Qt){throw new Error(`failed to parse haystack item ${ie} for "in" expression: ${Qt.message}`)}return[b(nt[1],Rt,Et),...Mt]}function it(nt,et,Et){let ut;try{ut=b(nt[1],l,Et)}catch(jt){throw new Error(`failed to parse first argument in palette expression: ${jt.message}`)}const Rt=nt[2];if(!Array.isArray(Rt))throw new Error("the second argument of palette must be an array");const Mt=new Array(Rt.length);for(let jt=0;jt<Mt.length;jt++){let ie;try{ie=b(Rt[jt],P,Et)}catch(Qt){throw new Error(`failed to parse color at index ${jt} in palette expression: ${Qt.message}`)}if(!(ie instanceof m))throw new Error(`the palette color at index ${jt} must be a literal value`);Mt[jt]=ie}return[ut,...Mt]}function st(...nt){return function(et,Et,ut){const Rt=et[0];let Mt;for(let jt=0;jt<nt.length;jt++){const ie=nt[jt](et,Et,ut);if(jt==nt.length-1){if(!ie)throw new Error("expected last argument validator to return the parsed args");Mt=ie}}return new _(Et,Rt,...Mt)}}function gt(nt,et,Et){const ut=nt[0],Rt=W[ut];if(!Rt)throw new Error(`unknown operator: ${ut}`);return Rt(nt,et,Et)}function Ot(nt){if(!nt)return"";const et=nt.getType();switch(et){case"Point":case"LineString":case"Polygon":return et;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return et.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Ot(nt.getGeometries()[0]);default:return""}}},49988:(Ft,at,i)=>{i.d(at,{Ay:()=>g,bL:()=>K,xo:()=>$});var U=i(8143),p=i(11078);function $(I){return I instanceof Image||I instanceof HTMLCanvasElement||I instanceof HTMLVideoElement||I instanceof ImageBitmap?I:null}function K(I){return I instanceof Uint8Array||I instanceof Uint8ClampedArray||I instanceof Float32Array||I instanceof DataView?I:null}const d=new Error("disposed");let E=null;function l(I){E||(E=createCanvasContext2D(I.width,I.height,void 0,{willReadFrequently:!0}));const s=E.canvas,e=I.width;s.width!==e&&(s.width=e);const c=I.height;return s.height!==c&&(s.height=c),E.clearRect(0,0,e,c),E.drawImage(I,0,0),E.getImageData(0,0,e,c).data}const y=[256,256];class P extends U.A{constructor(s){const e=p.A.IDLE;super(s.tileCoord,e,{transition:s.transition,interpolate:s.interpolate}),this.loader_=s.loader,this.data_=null,this.error_=null,this.size_=s.size||null,this.controller_=s.controller||null}getSize(){if(this.size_)return this.size_;const s=$(this.data_);return s?[s.width,s.height]:y}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==p.A.IDLE&&this.state!==p.A.ERROR)return;this.state=p.A.LOADING,this.changed();const s=this;this.loader_().then(function(e){s.data_=e,s.state=p.A.LOADED,s.changed()}).catch(function(e){s.error_=e,s.state=p.A.ERROR,s.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(d),this.controller_=null),super.disposeInternal()}}const g=P},50071:(Ft,at,i)=>{i.d(at,{A:()=>l});var U=i(32135),p=i(34120),$=i(1685);const K={LENGTH:"length"};class d extends $.Ay{constructor(P,g,I){super(P),this.element=g,this.index=I}}class E extends p.A{constructor(P,g){if(super(),this.on,this.once,this.un,g=g||{},this.unique_=!!g.unique,this.array_=P||[],this.unique_)for(let I=0,s=this.array_.length;I<s;++I)this.assertUnique_(this.array_[I],I);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(P){for(let g=0,I=P.length;g<I;++g)this.push(P[g]);return this}forEach(P){const g=this.array_;for(let I=0,s=g.length;I<s;++I)P(g[I],I,g)}getArray(){return this.array_}item(P){return this.array_[P]}getLength(){return this.get(K.LENGTH)}insertAt(P,g){if(P<0||P>this.getLength())throw new Error("Index out of bounds: "+P);this.unique_&&this.assertUnique_(g),this.array_.splice(P,0,g),this.updateLength_(),this.dispatchEvent(new d(U.A.ADD,g,P))}pop(){return this.removeAt(this.getLength()-1)}push(P){this.unique_&&this.assertUnique_(P);const g=this.getLength();return this.insertAt(g,P),this.getLength()}remove(P){const g=this.array_;for(let I=0,s=g.length;I<s;++I)if(g[I]===P)return this.removeAt(I)}removeAt(P){if(P<0||P>=this.getLength())return;const g=this.array_[P];return this.array_.splice(P,1),this.updateLength_(),this.dispatchEvent(new d(U.A.REMOVE,g,P)),g}setAt(P,g){const I=this.getLength();if(P>=I){this.insertAt(P,g);return}if(P<0)throw new Error("Index out of bounds: "+P);this.unique_&&this.assertUnique_(g,P);const s=this.array_[P];this.array_[P]=g,this.dispatchEvent(new d(U.A.REMOVE,s,P)),this.dispatchEvent(new d(U.A.ADD,g,P))}updateLength_(){this.set(K.LENGTH,this.array_.length)}assertUnique_(P,g){for(let I=0,s=this.array_.length;I<s;++I)if(this.array_[I]===P&&I!==g)throw new Error("Duplicate item added to a unique collection")}}const l=E},53049:(Ft,at,i)=>{i.d(at,{A:()=>K});var U=i(74848),p=i(22803),$=i(46300);const K=d=>(0,$.gU)(d)?(0,U.jsx)("a",{href:d,target:"_blank",className:(0,p.cx)("external-link"),rel:"noreferrer",children:d}):d},53497:(Ft,at,i)=>{i.d(at,{DY:()=>K,G4:()=>l,Sq:()=>P,T5:()=>y,W_:()=>p,_7:()=>$,fX:()=>d,wq:()=>E,yQ:()=>g,yu:()=>I});var U=i(739),p=(s=>(s.Point="point",s.Line="line",s.Polygon="polygon",s.Any="*any*",s))(p||{});const $=5;var K=(s=>(s.Left="left",s.Center="center",s.Right="right",s))(K||{}),d=(s=>(s.Top="top",s.Middle="middle",s.Bottom="bottom",s))(d||{}),E=(s=>(s.Left="left",s.Center="center",s.Right="right",s))(E||{}),l=(s=>(s.Top="top",s.Center="center",s.Bottom="bottom",s))(l||{});const y=Object.freeze({size:{fixed:$,min:2,max:15},color:{fixed:"dark-green"},opacity:.4,symbol:{mode:U.q_.Fixed,fixed:"build/img/icons/marker/circle.svg"},symbolAlign:{horizontal:"center",vertical:"center"},textConfig:{fontSize:12,textAlign:"center",textBaseline:"middle",offsetX:0,offsetY:0},rotation:{fixed:0,mode:U.WQ.Mod,min:-360,max:360}});var P=(s=>(s.color="fill",s.opacity="fill-opacity",s.lineWidth="stroke-width",s))(P||{}),g=(s=>(s.color="marker-color",s.size="marker-size",s))(g||{}),I=(s=>(s.color="stroke",s.lineWidth="stroke-width",s))(I||{})},57115:(Ft,at,i)=>{i.d(at,{L:()=>U,R:()=>p});const U=42,p=256},57456:(Ft,at,i)=>{i.d(at,{A:()=>y});var U=i(66514),p=i(25176),$=i(68711),K=i(6837),d=i(74238),E=i(10972);class l extends E.A{constructor(g){g=g||{},super({element:document.createElement("div"),render:g.render,target:g.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=g.collapsed!==void 0?g.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=g.collapsible!==void 0,this.collapsible_=g.collapsible!==void 0?g.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=g.attributions;const I=g.className!==void 0?g.className:"ol-attribution",s=g.tipLabel!==void 0?g.tipLabel:"Attributions",e=g.expandClassName!==void 0?g.expandClassName:I+"-expand",c=g.collapseLabel!==void 0?g.collapseLabel:"\u203A",G=g.collapseClassName!==void 0?g.collapseClassName:I+"-collapse";typeof c=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=c,this.collapseLabel_.className=G):this.collapseLabel_=c;const B=g.label!==void 0?g.label:"i";typeof B=="string"?(this.label_=document.createElement("span"),this.label_.textContent=B,this.label_.className=e):this.label_=B;const w=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=s,this.toggleButton_.appendChild(w),this.toggleButton_.addEventListener(K.A.CLICK,this.handleClick_.bind(this),!1);const T=I+" "+p.XI+" "+p.$N+(this.collapsed_&&this.collapsible_?" "+p.nT:"")+(this.collapsible_?"":" ol-uncollapsible"),f=this.element;f.className=T,f.appendChild(this.toggleButton_),f.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(g){const I=this.getMap().getAllLayers(),s=new Set(I.flatMap(e=>e.getAttributions(g)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(e=>s.add(e)):s.add(this.attributions_)),!this.overrideCollapsible_){const e=!I.some(c=>c.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(e)}return Array.from(s)}async updateElement_(g){if(!g){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const I=await Promise.all(this.collectSourceAttributions_(g).map(e=>(0,d.hq)(()=>e))),s=I.length>0;if(this.renderedVisible_!=s&&(this.element.style.display=s?"":"none",this.renderedVisible_=s),!(0,U.aI)(I,this.renderedAttributions_)){(0,$.gS)(this.ulElement_);for(let e=0,c=I.length;e<c;++e){const G=document.createElement("li");G.innerHTML=I[e],this.ulElement_.appendChild(G)}this.renderedAttributions_=I}}handleClick_(g){g.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(p.nT),this.collapsed_?(0,$.fo)(this.collapseLabel_,this.label_):(0,$.fo)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(g){this.collapsible_!==g&&(this.collapsible_=g,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(g){this.userCollapsed_=g,!(!this.collapsible_||this.collapsed_===g)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(g){this.updateElement_(g.frameState)}}const y=l},58620:(Ft,at,i)=>{i.d(at,{A:()=>l});var U=i(34120),p=i(90588),$=i(61597),K=i(4087),d=i(75332);class E extends U.A{constructor(P){super(),this.on,this.once,this.un,this.background_=P.background;const g=Object.assign({},P);typeof P.properties=="object"&&(delete g.properties,Object.assign(g,P.properties)),g[d.A.OPACITY]=P.opacity!==void 0?P.opacity:1,(0,p.v)(typeof g[d.A.OPACITY]=="number","Layer opacity must be a number"),g[d.A.VISIBLE]=P.visible!==void 0?P.visible:!0,g[d.A.Z_INDEX]=P.zIndex,g[d.A.MAX_RESOLUTION]=P.maxResolution!==void 0?P.maxResolution:1/0,g[d.A.MIN_RESOLUTION]=P.minResolution!==void 0?P.minResolution:0,g[d.A.MIN_ZOOM]=P.minZoom!==void 0?P.minZoom:-1/0,g[d.A.MAX_ZOOM]=P.maxZoom!==void 0?P.maxZoom:1/0,this.className_=g.className!==void 0?g.className:"ol-layer",delete g.className,this.setProperties(g),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(P){const g=this.state_||{layer:this,managed:P===void 0?!0:P},I=this.getZIndex();return g.opacity=(0,$.qE)(Math.round(this.getOpacity()*100)/100,0,1),g.visible=this.getVisible(),g.extent=this.getExtent(),g.zIndex=I===void 0&&!g.managed?1/0:I,g.maxResolution=this.getMaxResolution(),g.minResolution=Math.max(this.getMinResolution(),0),g.minZoom=this.getMinZoom(),g.maxZoom=this.getMaxZoom(),this.state_=g,g}getLayersArray(P){return(0,K.b0)()}getLayerStatesArray(P){return(0,K.b0)()}getExtent(){return this.get(d.A.EXTENT)}getMaxResolution(){return this.get(d.A.MAX_RESOLUTION)}getMinResolution(){return this.get(d.A.MIN_RESOLUTION)}getMinZoom(){return this.get(d.A.MIN_ZOOM)}getMaxZoom(){return this.get(d.A.MAX_ZOOM)}getOpacity(){return this.get(d.A.OPACITY)}getSourceState(){return(0,K.b0)()}getVisible(){return this.get(d.A.VISIBLE)}getZIndex(){return this.get(d.A.Z_INDEX)}setBackground(P){this.background_=P,this.changed()}setExtent(P){this.set(d.A.EXTENT,P)}setMaxResolution(P){this.set(d.A.MAX_RESOLUTION,P)}setMinResolution(P){this.set(d.A.MIN_RESOLUTION,P)}setMaxZoom(P){this.set(d.A.MAX_ZOOM,P)}setMinZoom(P){this.set(d.A.MIN_ZOOM,P)}setOpacity(P){(0,p.v)(typeof P=="number","Layer opacity must be a number"),this.set(d.A.OPACITY,P)}setVisible(P){this.set(d.A.VISIBLE,P)}setZIndex(P){this.set(d.A.Z_INDEX,P)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const l=E},58704:(Ft,at,i)=>{i.d(at,{A4:()=>_,GB:()=>T,Gk:()=>P,IO:()=>E,Js:()=>d,Kg:()=>f,Q7:()=>K,TS:()=>B,Zm:()=>s,at:()=>I,eL:()=>y,fs:()=>N,t5:()=>c,tE:()=>m});var U=i(73445),p=i(74238),$=i(7771);function K(W){const a=arguments;return function(o){let r=!0;for(let L=0,A=a.length;L<A&&(r=r&&a[L](o),!!r);++L);return r}}const d=function(W){const a=W.originalEvent;return a.altKey&&!(a.metaKey||a.ctrlKey)&&!a.shiftKey},E=function(W){const a=W.originalEvent;return a.altKey&&!(a.metaKey||a.ctrlKey)&&a.shiftKey},l=function(W){const a=W.map.getTargetElement(),o=a.getRootNode(),r=W.map.getOwnerDocument().activeElement;return o instanceof ShadowRoot?o.host.contains(r):a.contains(r)},y=function(W){const a=W.map.getTargetElement(),o=a.getRootNode();return(o instanceof ShadowRoot?o.host:a).hasAttribute("tabindex")?l(W):!0},P=p.rT,g=function(W){return W.type==MapBrowserEventType.CLICK},I=function(W){const a=W.originalEvent;return"pointerId"in a&&a.button==0&&!($.j&&$.ew&&a.ctrlKey)},s=p.W8,e=function(W){return W.type=="pointermove"},c=function(W){return W.type==U.A.SINGLECLICK},G=function(W){return W.type==MapBrowserEventType.DBLCLICK},B=function(W){const a=W.originalEvent;return!a.altKey&&!(a.metaKey||a.ctrlKey)&&!a.shiftKey},w=function(W){const a=W.originalEvent;return!a.altKey&&(MAC?a.metaKey:a.ctrlKey)&&!a.shiftKey},T=function(W){const a=W.originalEvent;return $.ew?a.metaKey:a.ctrlKey},f=function(W){const a=W.originalEvent;return!a.altKey&&!(a.metaKey||a.ctrlKey)&&a.shiftKey},m=function(W){const a=W.originalEvent,o=a.target.tagName;return o!=="INPUT"&&o!=="SELECT"&&o!=="TEXTAREA"&&!a.target.isContentEditable},_=function(W){const a=W.originalEvent;return"pointerId"in a&&a.pointerType=="mouse"},R=function(W){const a=W.originalEvent;return"pointerId"in a&&a.pointerType==="touch"},b=function(W){const a=W.originalEvent;return"pointerId"in a&&a.pointerType==="pen"},N=function(W){const a=W.originalEvent;return"pointerId"in a&&a.isPrimary&&a.button===0}},60764:(Ft,at,i)=>{i.d(at,{A:()=>I,l:()=>g});var U=i(91765),p=i(90588),$=i(6837),K=i(9438),d=i(70915),E=i(83984),l=i(58620),y=i(75332);class P extends l.A{constructor(e){const c=Object.assign({},e);delete c.source,super(c),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(y.A.SOURCE,this.handleSourcePropertyChange_);const G=e.source?e.source:null;this.setSource(G)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(y.A.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&((0,K.JH)(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=(0,K.KT)(e,$.A.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let c;const G=this.getMapInternal();!e&&G&&(e=G.getView()),e instanceof U.Ay?c={viewState:e.getState(),extent:e.calculateExtent()}:c=e,!c.layerStatesArray&&G&&(c.layerStatesArray=G.getLayerGroup().getLayerStatesArray());let B;if(c.layerStatesArray){if(B=c.layerStatesArray.find(T=>T.layer===this),!B)return!1}else B=this.getLayerState();const w=this.getExtent();return g(B,c.viewState)&&(!w||(0,d.HY)(w,c.extent))}getAttributions(e){if(!this.isVisible(e))return[];const c=this.getSource()?.getAttributions();if(!c)return[];const G=e instanceof U.Ay?e.getViewStateAndExtent():e;let B=c(G);return Array.isArray(B)||(B=[B]),B}render(e,c){const G=this.getRenderer();return G.prepareFrame(e)?(this.rendered=!0,G.renderFrame(e,c)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,c){}renderDeferred(e){const c=this.getRenderer();c&&c.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(y.A.MAP,e)}getMapInternal(){return this.get(y.A.MAP)}setMap(e){this.mapPrecomposeKey_&&((0,K.JH)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&((0,K.JH)(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=(0,K.KT)(e,E.A.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=(0,K.KT)(this,$.A.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const c=e.frameState.layerStatesArray,G=this.getLayerState(!1);(0,p.v)(!c.some(B=>B.layer===G.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),c.push(G)}setSource(e){this.set(y.A.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function g(s,e){if(!s.visible)return!1;const c=e.resolution;if(c<s.minResolution||c>=s.maxResolution)return!1;const G=e.zoom;return G>s.minZoom&&G<=s.maxZoom}const I=P},62703:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={ANIMATING:0,INTERACTING:1}},63425:(Ft,at,i)=>{i.d(at,{A:()=>N});var U=i(71259),p=i(62703),$=i(90588),K=i(9438),d=i(70915),E=i(94720),l=i(43067),y=i(835),P=i(3422),g=i(88280),I=i(9703),s=i(4087),e=i(20259),c=i(9777),G=i(89940),B=i(90130),w=i(35339),T=i(38111),f=i(49189);class m extends T.A{constructor(a,o){const r=o.uniforms||{},L=(0,I.vt)();r[c.M8.PROJECTION_MATRIX]=L,super(a,{uniforms:r,postProcesses:o.postProcesses}),this.sourceRevision_=-1,this.verticesBuffer_=new e.Ay(B.H7,B.Be),this.indicesBuffer_=new e.Ay(B.IP,B.Be),this.vertexShader_=o.vertexShader,this.fragmentShader_=o.fragmentShader,this.program_,this.hitDetectionEnabled_=o.hitDetectionEnabled??!0;const A=o.attributes?o.attributes.map(function(u){return{name:"a_"+u.name,size:1,type:c.jQ.FLOAT}}):[];this.attributes=[{name:"a_position",size:2,type:c.jQ.FLOAT},{name:"a_index",size:1,type:c.jQ.FLOAT}],this.hitDetectionEnabled_&&(this.attributes.push({name:"a_hitColor",size:4,type:c.jQ.FLOAT}),this.attributes.push({name:"a_featureUid",size:1,type:c.jQ.FLOAT})),this.attributes.push(...A),this.customAttributes=o.attributes?o.attributes:[],this.previousExtent_=(0,d.S5)(),this.currentTransform_=L,this.renderTransform_=(0,I.vt)(),this.invertRenderTransform_=(0,I.vt)(),this.renderInstructions_=new Float32Array(0),this.hitRenderTarget_,this.lastSentId=0,this.worker_=(0,w.v)(),this.worker_.addEventListener("message",u=>{const x=u.data;if(x.type===y.x.GENERATE_POINT_BUFFERS){const S=x.projectionTransform;this.verticesBuffer_.fromArrayBuffer(x.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.fromArrayBuffer(x.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=S,(0,I.T9)(this.invertRenderTransform_,this.renderTransform_),this.renderInstructions_=new Float32Array(u.data.renderInstructions),x.id===this.lastSentId&&(this.ready=!0),this.getLayer().changed()}}),this.featureCache_={},this.featureCount_=0;const O=this.getLayer().getSource();this.sourceListenKeys_=[(0,K.KT)(O,g.A.ADDFEATURE,this.handleSourceFeatureAdded_,this),(0,K.KT)(O,g.A.CHANGEFEATURE,this.handleSourceFeatureChanged_,this),(0,K.KT)(O,g.A.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),(0,K.KT)(O,g.A.CLEAR,this.handleSourceFeatureClear_,this)],O.forEachFeature(u=>{const x=u.getGeometry();x&&x.getType()==="Point"&&(this.featureCache_[(0,s.v6)(u)]={feature:u,properties:u.getProperties(),flatCoordinates:x.getFlatCoordinates()},this.featureCount_++)})}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new G.A(this.helper)),this.verticesBuffer_.getArray()&&this.helper.flushBufferData(this.verticesBuffer_),this.indicesBuffer_.getArray()&&this.helper.flushBufferData(this.indicesBuffer_)}handleSourceFeatureAdded_(a){const o=a.feature,r=o.getGeometry();r&&r.getType()==="Point"&&(this.featureCache_[(0,s.v6)(o)]={feature:o,properties:o.getProperties(),flatCoordinates:r.getFlatCoordinates()},this.featureCount_++)}handleSourceFeatureChanged_(a){const o=a.feature,r=(0,s.v6)(o),L=this.featureCache_[r],A=o.getGeometry();L?A&&A.getType()==="Point"?(L.properties=o.getProperties(),L.flatCoordinates=A.getFlatCoordinates()):(delete this.featureCache_[r],this.featureCount_--):A&&A.getType()==="Point"&&(this.featureCache_[r]={feature:o,properties:o.getProperties(),flatCoordinates:A.getFlatCoordinates()},this.featureCount_++)}handleSourceFeatureDelete_(a){const o=a.feature,r=(0,s.v6)(o);r in this.featureCache_&&(delete this.featureCache_[r],this.featureCount_--)}handleSourceFeatureClear_(){this.featureCache_={},this.featureCount_=0}renderFrame(a){const o=this.helper.getGL();this.preRender(o,a);const[r,L,A]=(0,f.v)(a,this.getLayer());return this.renderWorlds(a,!1,r,L,A),this.helper.finalizeDraw(a,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent),this.hitDetectionEnabled_&&(this.renderWorlds(a,!0,r,L,A),this.hitRenderTarget_.clearCachedData()),this.postRender(o,a),this.helper.getCanvas()}prepareFrameInternal(a){const o=this.getLayer(),r=o.getSource(),L=a.viewState,A=!a.viewHints[p.A.ANIMATING]&&!a.viewHints[p.A.INTERACTING],O=!(0,d.aI)(this.previousExtent_,a.extent),u=this.sourceRevision_<r.getRevision();if(u&&(this.sourceRevision_=r.getRevision()),A&&(O||u)){const x=L.projection,S=L.resolution,k=o instanceof E.A?o.getRenderBuffer():0,tt=(0,d.r)(a.extent,k*S);r.loadFeatures(tt,S,x),this.rebuildBuffers_(a),this.previousExtent_=a.extent.slice()}return this.helper.useProgram(this.program_,a),this.helper.prepareDraw(a),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0}rebuildBuffers_(a){const o=(0,I.vt)();this.helper.makeProjectionTransform(a,o);const r=(0,l.Tf)(),A=(this.hitDetectionEnabled_?7:2)+this.customAttributes.length,O=A*this.featureCount_,u=this.renderInstructions_&&this.renderInstructions_.length===O?this.renderInstructions_:new Float32Array(O);this.renderInstructions_=null;let x=[];const S=[];let k=-1;const tt=a.viewState.projection;for(const dt in this.featureCache_){const J=this.featureCache_[dt];if(r?x=(0,l.Ad)(J.flatCoordinates,tt):(x[0]=J.flatCoordinates[0],x[1]=J.flatCoordinates[1]),(0,I.Bb)(o,x),u[++k]=x[0],u[++k]=x[1],this.hitDetectionEnabled_){const ft=(0,P.b)(k+5,S);u[++k]=ft[0],u[++k]=ft[1],u[++k]=ft[2],u[++k]=ft[3],u[++k]=Number(dt)}for(let ft=0;ft<this.customAttributes.length;ft++){const it=this.customAttributes[ft].callback(J.feature,J.properties);u[++k]=it}}const ht={id:++this.lastSentId,type:y.x.GENERATE_POINT_BUFFERS,renderInstructions:u.buffer,customAttributesSize:A-2};ht.projectionTransform=o,this.ready=!1,this.worker_.postMessage(ht,[u.buffer])}forEachFeatureAtCoordinate(a,o,r,L,A){if((0,$.v)(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.renderInstructions_||!this.hitDetectionEnabled_)return;const O=(0,I.Bb)(o.coordinateToPixelTransform,a.slice()),u=this.hitRenderTarget_.readPixel(O[0]/2,O[1]/2),x=[u[0]/255,u[1]/255,u[2]/255,u[3]/255],S=(0,P.L)(x),k=this.renderInstructions_[S],tt=Math.floor(k).toString(),dt=this.getLayer().getSource().getFeatureByUid(tt);if(dt)return L(dt,this.getLayer(),null)}renderWorlds(a,o,r,L,A){let O=r;this.helper.useProgram(this.program_,a),o&&(this.hitRenderTarget_.setSize([Math.floor(a.size[0]/2),Math.floor(a.size[1]/2)]),this.helper.prepareDrawToRenderTarget(a,this.hitRenderTarget_,!0)),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes);do{this.helper.makeProjectionTransform(a,this.currentTransform_),(0,I.Tl)(this.currentTransform_,O*A,0),(0,I.lw)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(a),this.helper.applyHitDetectionUniform(o);const u=this.indicesBuffer_.getSize();this.helper.drawElements(0,u)}while(++O<L)}disposeInternal(){this.worker_.terminate(),this.sourceListenKeys_.forEach(function(a){(0,K.JH)(a)}),this.sourceListenKeys_=null,super.disposeInternal()}renderDeclutter(){}}const _=m;var R=i(60764);class b extends R.A{constructor(a){const o=Object.assign({},a);super(o),this.styleVariables_=a.variables||{},this.parseResult_=(0,U.my)(a.style,this.styleVariables_,a.filter),this.hitDetectionDisabled_=!!a.disableHitDetection}createRenderer(){const a=Object.keys(this.parseResult_.attributes).map(o=>({name:o,...this.parseResult_.attributes[o]}));return new _(this,{vertexShader:this.parseResult_.builder.getSymbolVertexShader(),fragmentShader:this.parseResult_.builder.getSymbolFragmentShader(),hitDetectionEnabled:!this.hitDetectionDisabled_,uniforms:this.parseResult_.uniforms,attributes:a})}updateStyleVariables(a){Object.assign(this.styleVariables_,a),this.changed()}}const N=b},65896:(Ft,at,i)=>{i.d(at,{A:()=>Ee});var U=i(62703),p=i(66514),$=i(6933),K=i(68711),d=i(70915),E=i(43067),l=i(83984),y=i(99676),P=i(11580),g=i(56361);class I{drawCustom(t,h,v,C,j){}drawGeometry(t){}setStyle(t){}drawCircle(t,h,v){}drawFeature(t,h,v){}drawGeometryCollection(t,h,v){}drawLineString(t,h,v){}drawMultiLineString(t,h,v){}drawMultiPoint(t,h,v){}drawMultiPolygon(t,h,v){}drawPoint(t,h,v){}drawPolygon(t,h,v){}drawText(t,h,v){}setFillStrokeStyle(t,h){}setImageStyle(t,h){}setTextStyle(t,h){}}const s=I;var e=i(38774);const c={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},G=[c.FILL],B=[c.STROKE],w=[c.BEGIN_PATH],T=[c.CLOSE_PATH],f=c;class m extends s{constructor(t,h,v,C){super(),this.tolerance=t,this.maxExtent=h,this.pixelRatio=C,this.maxLineWidth=0,this.resolution=v,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const h=this.pixelRatio;return h==1?t:t.map(function(v){return v*h})}appendFlatPointCoordinates(t,h){const v=this.getBufferedMaxExtent(),C=this.tmpCoordinate_,j=this.coordinates;let z=j.length;for(let Z=0,X=t.length;Z<X;Z+=h)C[0]=t[Z],C[1]=t[Z+1],(0,d.Ym)(v,C)&&(j[z++]=C[0],j[z++]=C[1]);return z}appendFlatLineCoordinates(t,h,v,C,j,z){const Z=this.coordinates;let X=Z.length;const ct=this.getBufferedMaxExtent();z&&(h+=C);let rt=t[h],_t=t[h+1];const vt=this.tmpCoordinate_;let xt=!0,Pt,Bt,Ct;for(Pt=h+C;Pt<v;Pt+=C)vt[0]=t[Pt],vt[1]=t[Pt+1],Ct=(0,d.vz)(ct,vt),Ct!==Bt?(xt&&(Z[X++]=rt,Z[X++]=_t,xt=!1),Z[X++]=vt[0],Z[X++]=vt[1]):Ct===P.A.INTERSECTING?(Z[X++]=vt[0],Z[X++]=vt[1],xt=!1):xt=!0,rt=vt[0],_t=vt[1],Bt=Ct;return(j&&xt||Pt===h+C)&&(Z[X++]=rt,Z[X++]=_t),X}drawCustomCoordinates_(t,h,v,C,j){for(let z=0,Z=v.length;z<Z;++z){const X=v[z],ct=this.appendFlatLineCoordinates(t,h,X,C,!1,!1);j.push(ct),h=X}return h}drawCustom(t,h,v,C,j){this.beginGeometry(t,h,j);const z=t.getType(),Z=t.getStride(),X=this.coordinates.length;let ct,rt,_t,vt,xt;switch(z){case"MultiPolygon":ct=t.getOrientedFlatCoordinates(),vt=[];const Pt=t.getEndss();xt=0;for(let Bt=0,Ct=Pt.length;Bt<Ct;++Bt){const bt=[];xt=this.drawCustomCoordinates_(ct,xt,Pt[Bt],Z,bt),vt.push(bt)}this.instructions.push([f.CUSTOM,X,vt,t,v,g.Dz,j]),this.hitDetectionInstructions.push([f.CUSTOM,X,vt,t,C||v,g.Dz,j]);break;case"Polygon":case"MultiLineString":_t=[],ct=z=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),xt=this.drawCustomCoordinates_(ct,0,t.getEnds(),Z,_t),this.instructions.push([f.CUSTOM,X,_t,t,v,g.cD,j]),this.hitDetectionInstructions.push([f.CUSTOM,X,_t,t,C||v,g.cD,j]);break;case"LineString":case"Circle":ct=t.getFlatCoordinates(),rt=this.appendFlatLineCoordinates(ct,0,ct.length,Z,!1,!1),this.instructions.push([f.CUSTOM,X,rt,t,v,g.n2,j]),this.hitDetectionInstructions.push([f.CUSTOM,X,rt,t,C||v,g.n2,j]);break;case"MultiPoint":ct=t.getFlatCoordinates(),rt=this.appendFlatPointCoordinates(ct,Z),rt>X&&(this.instructions.push([f.CUSTOM,X,rt,t,v,g.n2,j]),this.hitDetectionInstructions.push([f.CUSTOM,X,rt,t,C||v,g.n2,j]));break;case"Point":ct=t.getFlatCoordinates(),this.coordinates.push(ct[0],ct[1]),rt=this.coordinates.length,this.instructions.push([f.CUSTOM,X,rt,t,v,void 0,j]),this.hitDetectionInstructions.push([f.CUSTOM,X,rt,t,C||v,void 0,j]);break;default:}this.endGeometry(h)}beginGeometry(t,h,v){this.beginGeometryInstruction1_=[f.BEGIN_GEOMETRY,h,0,t,v],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[f.BEGIN_GEOMETRY,h,0,t,v],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let h;const v=t.length;let C,j,z=-1;for(h=0;h<v;++h)C=t[h],j=C[0],j==f.END_GEOMETRY?z=h:j==f.BEGIN_GEOMETRY&&(C[2]=h,(0,p.gI)(this.hitDetectionInstructions,z,h),z=-1)}fillStyleToState(t,h={}){if(t){const v=t.getColor();h.fillPatternScale=v&&typeof v=="object"&&"src"in v?this.pixelRatio:1,h.fillStyle=(0,y.F)(v||e.qY)}else h.fillStyle=void 0;return h}strokeStyleToState(t,h={}){if(t){const v=t.getColor();h.strokeStyle=(0,y.F)(v||e.NT);const C=t.getLineCap();h.lineCap=C!==void 0?C:e._m;const j=t.getLineDash();h.lineDash=j?j.slice():e.Oq;const z=t.getLineDashOffset();h.lineDashOffset=z||e.vk;const Z=t.getLineJoin();h.lineJoin=Z!==void 0?Z:e._K;const X=t.getWidth();h.lineWidth=X!==void 0?X:e.aq;const ct=t.getMiterLimit();h.miterLimit=ct!==void 0?ct:e.eL,h.lineWidth>this.maxLineWidth&&(this.maxLineWidth=h.lineWidth,this.bufferedMaxExtent_=null)}else h.strokeStyle=void 0,h.lineCap=void 0,h.lineDash=null,h.lineDashOffset=void 0,h.lineJoin=void 0,h.lineWidth=void 0,h.miterLimit=void 0;return h}setFillStrokeStyle(t,h){const v=this.state;this.fillStyleToState(t,v),this.strokeStyleToState(h,v)}createFill(t){const h=t.fillStyle,v=[f.SET_FILL_STYLE,h];return typeof h!="string"&&v.push(t.fillPatternScale),v}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[f.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,h){const v=t.fillStyle;(typeof v!="string"||t.currentFillStyle!=v)&&(this.instructions.push(h.call(this,t)),t.currentFillStyle=v)}updateStrokeStyle(t,h){const v=t.strokeStyle,C=t.lineCap,j=t.lineDash,z=t.lineDashOffset,Z=t.lineJoin,X=t.lineWidth,ct=t.miterLimit;(t.currentStrokeStyle!=v||t.currentLineCap!=C||j!=t.currentLineDash&&!(0,p.aI)(t.currentLineDash,j)||t.currentLineDashOffset!=z||t.currentLineJoin!=Z||t.currentLineWidth!=X||t.currentMiterLimit!=ct)&&(h.call(this,t),t.currentStrokeStyle=v,t.currentLineCap=C,t.currentLineDash=j,t.currentLineDashOffset=z,t.currentLineJoin=Z,t.currentLineWidth=X,t.currentMiterLimit=ct)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const h=[f.END_GEOMETRY,t];this.instructions.push(h),this.hitDetectionInstructions.push(h)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,d.o8)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,d.r)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const _=m;class R extends _{constructor(t,h,v,C){super(t,h,v,C),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,h,v){if(!this.image_||this.maxExtent&&!(0,d.Ym)(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,h,v);const C=t.getFlatCoordinates(),j=t.getStride(),z=this.coordinates.length,Z=this.appendFlatPointCoordinates(C,j);this.instructions.push([f.DRAW_IMAGE,z,Z,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([f.DRAW_IMAGE,z,Z,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(h)}drawMultiPoint(t,h,v){if(!this.image_)return;this.beginGeometry(t,h,v);const C=t.getFlatCoordinates(),j=[];for(let X=0,ct=C.length;X<ct;X+=t.getStride())(!this.maxExtent||(0,d.Ym)(this.maxExtent,C.slice(X,X+2)))&&j.push(C[X],C[X+1]);const z=this.coordinates.length,Z=this.appendFlatPointCoordinates(j,2);this.instructions.push([f.DRAW_IMAGE,z,Z,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([f.DRAW_IMAGE,z,Z,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(h)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,h){const v=t.getAnchor(),C=t.getSize(),j=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=v[0],this.anchorY_=v[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=C[1],this.opacity_=t.getOpacity(),this.originX_=j[0],this.originY_=j[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=C[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=h}}const b=R;class N extends _{constructor(t,h,v,C){super(t,h,v,C)}drawFlatCoordinates_(t,h,v,C){const j=this.coordinates.length,z=this.appendFlatLineCoordinates(t,h,v,C,!1,!1),Z=[f.MOVE_TO_LINE_TO,j,z];return this.instructions.push(Z),this.hitDetectionInstructions.push(Z),v}drawLineString(t,h,v){const C=this.state,j=C.strokeStyle,z=C.lineWidth;if(j===void 0||z===void 0)return;this.updateStrokeStyle(C,this.applyStroke),this.beginGeometry(t,h,v),this.hitDetectionInstructions.push([f.SET_STROKE_STYLE,C.strokeStyle,C.lineWidth,C.lineCap,C.lineJoin,C.miterLimit,e.Oq,e.vk],w);const Z=t.getFlatCoordinates(),X=t.getStride();this.drawFlatCoordinates_(Z,0,Z.length,X),this.hitDetectionInstructions.push(B),this.endGeometry(h)}drawMultiLineString(t,h,v){const C=this.state,j=C.strokeStyle,z=C.lineWidth;if(j===void 0||z===void 0)return;this.updateStrokeStyle(C,this.applyStroke),this.beginGeometry(t,h,v),this.hitDetectionInstructions.push([f.SET_STROKE_STYLE,C.strokeStyle,C.lineWidth,C.lineCap,C.lineJoin,C.miterLimit,e.Oq,e.vk],w);const Z=t.getEnds(),X=t.getFlatCoordinates(),ct=t.getStride();let rt=0;for(let _t=0,vt=Z.length;_t<vt;++_t)rt=this.drawFlatCoordinates_(X,rt,Z[_t],ct);this.hitDetectionInstructions.push(B),this.endGeometry(h)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(B),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(B),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(w)}}const W=N;var a=i(83671);class o extends _{constructor(t,h,v,C){super(t,h,v,C)}drawFlatCoordinatess_(t,h,v,C){const j=this.state,z=j.fillStyle!==void 0,Z=j.strokeStyle!==void 0,X=v.length;this.instructions.push(w),this.hitDetectionInstructions.push(w);for(let ct=0;ct<X;++ct){const rt=v[ct],_t=this.coordinates.length,vt=this.appendFlatLineCoordinates(t,h,rt,C,!0,!Z),xt=[f.MOVE_TO_LINE_TO,_t,vt];this.instructions.push(xt),this.hitDetectionInstructions.push(xt),Z&&(this.instructions.push(T),this.hitDetectionInstructions.push(T)),h=rt}return z&&(this.instructions.push(G),this.hitDetectionInstructions.push(G)),Z&&(this.instructions.push(B),this.hitDetectionInstructions.push(B)),h}drawCircle(t,h,v){const C=this.state,j=C.fillStyle,z=C.strokeStyle;if(j===void 0&&z===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,h,v),C.fillStyle!==void 0&&this.hitDetectionInstructions.push([f.SET_FILL_STYLE,e.qY]),C.strokeStyle!==void 0&&this.hitDetectionInstructions.push([f.SET_STROKE_STYLE,C.strokeStyle,C.lineWidth,C.lineCap,C.lineJoin,C.miterLimit,e.Oq,e.vk]);const Z=t.getFlatCoordinates(),X=t.getStride(),ct=this.coordinates.length;this.appendFlatLineCoordinates(Z,0,Z.length,X,!1,!1);const rt=[f.CIRCLE,ct];this.instructions.push(w,rt),this.hitDetectionInstructions.push(w,rt),C.fillStyle!==void 0&&(this.instructions.push(G),this.hitDetectionInstructions.push(G)),C.strokeStyle!==void 0&&(this.instructions.push(B),this.hitDetectionInstructions.push(B)),this.endGeometry(h)}drawPolygon(t,h,v){const C=this.state,j=C.fillStyle,z=C.strokeStyle;if(j===void 0&&z===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,h,v),C.fillStyle!==void 0&&this.hitDetectionInstructions.push([f.SET_FILL_STYLE,e.qY]),C.strokeStyle!==void 0&&this.hitDetectionInstructions.push([f.SET_STROKE_STYLE,C.strokeStyle,C.lineWidth,C.lineCap,C.lineJoin,C.miterLimit,e.Oq,e.vk]);const Z=t.getEnds(),X=t.getOrientedFlatCoordinates(),ct=t.getStride();this.drawFlatCoordinatess_(X,0,Z,ct),this.endGeometry(h)}drawMultiPolygon(t,h,v){const C=this.state,j=C.fillStyle,z=C.strokeStyle;if(j===void 0&&z===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,h,v),C.fillStyle!==void 0&&this.hitDetectionInstructions.push([f.SET_FILL_STYLE,e.qY]),C.strokeStyle!==void 0&&this.hitDetectionInstructions.push([f.SET_STROKE_STYLE,C.strokeStyle,C.lineWidth,C.lineCap,C.lineJoin,C.miterLimit,e.Oq,e.vk]);const Z=t.getEndss(),X=t.getOrientedFlatCoordinates(),ct=t.getStride();let rt=0;for(let _t=0,vt=Z.length;_t<vt;++_t)rt=this.drawFlatCoordinatess_(X,rt,Z[_t],ct);this.endGeometry(h)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const h=this.coordinates;for(let v=0,C=h.length;v<C;++v)h[v]=(0,a.n$)(h[v],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;this.updateFillStyle(t,this.createFill),this.updateStrokeStyle(t,this.applyStroke)}}const r=o;var L=i(61597);function A(pt,t,h,v,C){const j=[];let z=h,Z=0,X=t.slice(h,2);for(;Z<pt&&z+C<v;){const[ct,rt]=X.slice(-2),_t=t[z+C],vt=t[z+C+1],xt=Math.sqrt((_t-ct)*(_t-ct)+(vt-rt)*(vt-rt));if(Z+=xt,Z>=pt){const Pt=(pt-Z+xt)/xt,Bt=(0,L.Cc)(ct,_t,Pt),Ct=(0,L.Cc)(rt,vt,Pt);X.push(Bt,Ct),j.push(X),X=[Bt,Ct],Z==pt&&(z+=C),Z=0}else if(Z<pt)X.push(t[z+C],t[z+C+1]),z+=C;else{const Pt=xt-Z,Bt=(0,L.Cc)(ct,_t,Pt/xt),Ct=(0,L.Cc)(rt,vt,Pt/xt);X.push(Bt,Ct),j.push(X),X=[Bt,Ct],Z=0,z+=C}}return Z>0&&j.push(X),j}function O(pt,t,h,v,C){let j=h,z=h,Z=0,X=0,ct=h,rt,_t,vt,xt,Pt,Bt,Ct,bt,Gt,$t;for(_t=h;_t<v;_t+=C){const Ut=t[_t],Vt=t[_t+1];Pt!==void 0&&(Gt=Ut-Pt,$t=Vt-Bt,xt=Math.sqrt(Gt*Gt+$t*$t),Ct!==void 0&&(X+=vt,rt=Math.acos((Ct*Gt+bt*$t)/(vt*xt)),rt>pt&&(X>Z&&(Z=X,j=ct,z=_t),X=0,ct=_t-C)),vt=xt,Ct=Gt,bt=$t),Pt=Ut,Bt=Vt}return X+=xt,X>Z?[ct,_t]:[j,z]}var u=i(4087);const x={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class S extends _{constructor(t,h,v,C){super(t,h,v,C),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[e.qY]={fillStyle:e.qY},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,h,v){const C=this.textFillState_,j=this.textStrokeState_,z=this.textState_;if(this.text_===""||!z||!C&&!j)return;const Z=this.coordinates;let X=Z.length;const ct=t.getType();let rt=null,_t=t.getStride();if(z.placement==="line"&&(ct=="LineString"||ct=="MultiLineString"||ct=="Polygon"||ct=="MultiPolygon")){if(!(0,d.HY)(this.maxExtent,t.getExtent()))return;let vt;if(rt=t.getFlatCoordinates(),ct=="LineString")vt=[rt.length];else if(ct=="MultiLineString")vt=t.getEnds();else if(ct=="Polygon")vt=t.getEnds().slice(0,1);else if(ct=="MultiPolygon"){const Ct=t.getEndss();vt=[];for(let bt=0,Gt=Ct.length;bt<Gt;++bt)vt.push(Ct[bt][0])}this.beginGeometry(t,h,v);const xt=z.repeat,Pt=xt?void 0:z.textAlign;let Bt=0;for(let Ct=0,bt=vt.length;Ct<bt;++Ct){let Gt;xt?Gt=A(xt*this.resolution,rt,Bt,vt[Ct],_t):Gt=[rt.slice(Bt,vt[Ct])];for(let $t=0,Ut=Gt.length;$t<Ut;++$t){const Vt=Gt[$t];let Ht=0,re=Vt.length;if(Pt==null){const ae=O(z.maxAngle,Vt,0,Vt.length,2);Ht=ae[0],re=ae[1]}for(let ae=Ht;ae<re;ae+=_t)Z.push(Vt[ae],Vt[ae+1]);const ce=Z.length;Bt=vt[Ct],this.drawChars_(X,ce),X=ce}}this.endGeometry(h)}else{let vt=z.overflow?null:[];switch(ct){case"Point":case"MultiPoint":rt=t.getFlatCoordinates();break;case"LineString":rt=t.getFlatMidpoint();break;case"Circle":rt=t.getCenter();break;case"MultiLineString":rt=t.getFlatMidpoints(),_t=2;break;case"Polygon":rt=t.getFlatInteriorPoint(),z.overflow||vt.push(rt[2]/this.resolution),_t=3;break;case"MultiPolygon":const Ut=t.getFlatInteriorPoints();rt=[];for(let Vt=0,Ht=Ut.length;Vt<Ht;Vt+=3)z.overflow||vt.push(Ut[Vt+2]/this.resolution),rt.push(Ut[Vt],Ut[Vt+1]);if(rt.length===0)return;_t=2;break;default:}const xt=this.appendFlatPointCoordinates(rt,_t);if(xt===X)return;if(vt&&(xt-X)/2!==rt.length/_t){let Ut=X/2;vt=vt.filter((Vt,Ht)=>{const re=Z[(Ut+Ht)*2]===rt[Ht*_t]&&Z[(Ut+Ht)*2+1]===rt[Ht*_t+1];return re||--Ut,re})}this.saveTextStates_();const Pt=z.backgroundFill?this.createFill(this.fillStyleToState(z.backgroundFill)):null,Bt=z.backgroundStroke?this.createStroke(this.strokeStyleToState(z.backgroundStroke)):null;this.beginGeometry(t,h,v);let Ct=z.padding;if(Ct!=e.Tq&&(z.scale[0]<0||z.scale[1]<0)){let Ut=z.padding[0],Vt=z.padding[1],Ht=z.padding[2],re=z.padding[3];z.scale[0]<0&&(Vt=-Vt,re=-re),z.scale[1]<0&&(Ut=-Ut,Ht=-Ht),Ct=[Ut,Vt,Ht,re]}const bt=this.pixelRatio;this.instructions.push([f.DRAW_IMAGE,X,xt,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,Ct==e.Tq?e.Tq:Ct.map(function(Ut){return Ut*bt}),Pt,Bt,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,vt]);const Gt=1/bt,$t=Pt?Pt.slice(0):null;$t&&($t[1]=e.qY),this.hitDetectionInstructions.push([f.DRAW_IMAGE,X,xt,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[Gt,Gt],NaN,this.declutterMode_,this.declutterImageWithText_,Ct,$t,Bt,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?e.qY:this.fillKey_,this.textOffsetX_,this.textOffsetY_,vt]),this.endGeometry(h)}}saveTextStates_(){const t=this.textStrokeState_,h=this.textState_,v=this.textFillState_,C=this.strokeKey_;t&&(C in this.strokeStates||(this.strokeStates[C]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const j=this.textKey_;j in this.textStates||(this.textStates[j]={font:h.font,textAlign:h.textAlign||e.MY,justify:h.justify,textBaseline:h.textBaseline||e.M8,scale:h.scale});const z=this.fillKey_;v&&(z in this.fillStates||(this.fillStates[z]={fillStyle:v.fillStyle}))}drawChars_(t,h){const v=this.textStrokeState_,C=this.textState_,j=this.strokeKey_,z=this.textKey_,Z=this.fillKey_;this.saveTextStates_();const X=this.pixelRatio,ct=x[C.textBaseline],rt=this.textOffsetY_*X,_t=this.text_,vt=v?v.lineWidth*Math.abs(C.scale[0])/2:0;this.instructions.push([f.DRAW_CHARS,t,h,ct,C.overflow,Z,C.maxAngle,X,rt,j,vt*X,_t,z,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([f.DRAW_CHARS,t,h,ct,C.overflow,Z&&e.qY,C.maxAngle,X,rt,j,vt*X,_t,z,1/X,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,h){let v,C,j;if(!t)this.text_="";else{const z=t.getFill();z?(C=this.textFillState_,C||(C={},this.textFillState_=C),C.fillStyle=(0,y.F)(z.getColor()||e.qY)):(C=null,this.textFillState_=C);const Z=t.getStroke();if(!Z)j=null,this.textStrokeState_=j;else{j=this.textStrokeState_,j||(j={},this.textStrokeState_=j);const Bt=Z.getLineDash(),Ct=Z.getLineDashOffset(),bt=Z.getWidth(),Gt=Z.getMiterLimit();j.lineCap=Z.getLineCap()||e._m,j.lineDash=Bt?Bt.slice():e.Oq,j.lineDashOffset=Ct===void 0?e.vk:Ct,j.lineJoin=Z.getLineJoin()||e._K,j.lineWidth=bt===void 0?e.aq:bt,j.miterLimit=Gt===void 0?e.eL:Gt,j.strokeStyle=(0,y.F)(Z.getColor()||e.NT)}v=this.textState_;const X=t.getFont()||e.ZV;(0,e.fZ)(X);const ct=t.getScaleArray();v.overflow=t.getOverflow(),v.font=X,v.maxAngle=t.getMaxAngle(),v.placement=t.getPlacement(),v.textAlign=t.getTextAlign(),v.repeat=t.getRepeat(),v.justify=t.getJustify(),v.textBaseline=t.getTextBaseline()||e.M8,v.backgroundFill=t.getBackgroundFill(),v.backgroundStroke=t.getBackgroundStroke(),v.padding=t.getPadding()||e.Tq,v.scale=ct===void 0?[1,1]:ct;const rt=t.getOffsetX(),_t=t.getOffsetY(),vt=t.getRotateWithView(),xt=t.getKeepUpright(),Pt=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=rt===void 0?0:rt,this.textOffsetY_=_t===void 0?0:_t,this.textRotateWithView_=vt===void 0?!1:vt,this.textKeepUpright_=xt===void 0?!0:xt,this.textRotation_=Pt===void 0?0:Pt,this.strokeKey_=j?(typeof j.strokeStyle=="string"?j.strokeStyle:(0,u.v6)(j.strokeStyle))+j.lineCap+j.lineDashOffset+"|"+j.lineWidth+j.lineJoin+j.miterLimit+"["+j.lineDash.join()+"]":"",this.textKey_=v.font+v.scale+(v.textAlign||"?")+(v.repeat||"?")+(v.justify||"?")+(v.textBaseline||"?"),this.fillKey_=C&&C.fillStyle?typeof C.fillStyle=="string"?C.fillStyle:"|"+(0,u.v6)(C.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=h}}const tt={Circle:r,Default:_,Image:b,LineString:W,Polygon:r,Text:S};class ht{constructor(t,h,v,C){this.tolerance_=t,this.maxExtent_=h,this.pixelRatio_=C,this.resolution_=v,this.buildersByZIndex_={}}finish(){const t={};for(const h in this.buildersByZIndex_){t[h]=t[h]||{};const v=this.buildersByZIndex_[h];for(const C in v){const j=v[C].finish();t[h][C]=j}}return t}getBuilder(t,h){const v=t!==void 0?t.toString():"0";let C=this.buildersByZIndex_[v];C===void 0&&(C={},this.buildersByZIndex_[v]=C);let j=C[h];if(j===void 0){const z=tt[h];j=new z(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),C[h]=j}return j}}const dt=ht;var J=i(87622),ft=i(43530),it=i(9703),st=i(50904);function gt(pt,t,h,v,C,j,z,Z,X,ct,rt,_t,vt=!0){let xt=pt[t],Pt=pt[t+1],Bt=0,Ct=0,bt=0,Gt=0;function $t(){Bt=xt,Ct=Pt,t+=v,xt=pt[t],Pt=pt[t+1],Gt+=bt,bt=Math.sqrt((xt-Bt)*(xt-Bt)+(Pt-Ct)*(Pt-Ct))}do $t();while(t<h-v&&Gt+bt<j);let Ut=bt===0?0:(j-Gt)/bt;const Vt=(0,L.Cc)(Bt,xt,Ut),Ht=(0,L.Cc)(Ct,Pt,Ut),re=t-v,ce=Gt,ae=j+Z*X(ct,C,rt);for(;t<h-v&&Gt+bt<ae;)$t();Ut=bt===0?0:(ae-Gt)/bt;const De=(0,L.Cc)(Bt,xt,Ut),Re=(0,L.Cc)(Ct,Pt,Ut);let fe=!1;if(vt)if(_t){const se=[Vt,Ht,De,Re];(0,J.e$)(se,0,4,2,_t,se,se),fe=se[0]>se[2]}else fe=Vt>De;const Ae=Math.PI,Ie=[],ge=re+v===t;t=re,bt=0,Gt=ce,xt=pt[t],Pt=pt[t+1];let me;if(ge){$t(),me=Math.atan2(Pt-Ct,xt-Bt),fe&&(me+=me>0?-Ae:Ae);const se=(De+Vt)/2,pe=(Re+Ht)/2;return Ie[0]=[se,pe,(ae-j)/2,me,C],Ie}C=C.replace(/\n/g," ");for(let se=0,pe=C.length;se<pe;){$t();let ot=Math.atan2(Pt-Ct,xt-Bt);if(fe&&(ot+=ot>0?-Ae:Ae),me!==void 0){let Tt=ot-me;if(Tt+=Tt>Ae?-2*Ae:Tt<-Ae?2*Ae:0,Math.abs(Tt)>z)return null}me=ot;const n=se;let D=0;for(;se<pe;++se){const Tt=fe?pe-se-1:se,wt=Z*X(ct,C[Tt],rt);if(t+v<h&&Gt+bt<j+D+wt/2)break;D+=wt}if(se===n)continue;const M=fe?C.substring(pe-n,pe-se):C.substring(n,se);Ut=bt===0?0:(j+D/2-Gt)/bt;const Q=(0,L.Cc)(Bt,xt,Ut),yt=(0,L.Cc)(Ct,Pt,Ut);Ie.push([Q,yt,D/2,ot,M]),j+=D}return Ie}var Ot=i(40808);const nt=(0,d.S5)(),et=[],Et=[],ut=[],Rt=[];function Mt(pt){return pt[3].declutterBox}const jt=new RegExp("[\u0591-\u08FF\uFB1D-\uFDFF\uFE70-\uFEFC\u0800-\u0FFF\uE800-\uEFFF]");function ie(pt,t){return t==="start"?t=jt.test(pt)?"right":"left":t==="end"&&(t=jt.test(pt)?"left":"right"),x[t]}function Qt(pt,t,h){return h>0&&pt.push(`
`,""),pt.push(t,""),pt}function Y(pt,t,h){return h%2===0&&(pt+=t),pt}class H{constructor(t,h,v,C,j){this.overlaps=v,this.pixelRatio=h,this.resolution=t,this.alignAndScaleFill_,this.instructions=C.instructions,this.coordinates=C.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,it.vt)(),this.hitDetectionInstructions=C.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=C.fillStates||{},this.strokeStates=C.strokeStates||{},this.textStates=C.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=j?new Ot.A:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,h,v,C){const j=t+h+v+C;if(this.labels_[j])return this.labels_[j];const z=C?this.strokeStates[C]:null,Z=v?this.fillStates[v]:null,X=this.textStates[h],ct=this.pixelRatio,rt=[X.scale[0]*ct,X.scale[1]*ct],_t=X.justify?x[X.justify]:ie(Array.isArray(t)?t[0]:t,X.textAlign||e.MY),vt=C&&z.lineWidth?z.lineWidth:0,xt=Array.isArray(t)?t:String(t).split(`
`).reduce(Qt,[]),{width:Pt,height:Bt,widths:Ct,heights:bt,lineWidths:Gt}=(0,e.jT)(X,xt),$t=Pt+vt,Ut=[],Vt=($t+2)*rt[0],Ht=(Bt+vt)*rt[1],re={width:Vt<0?Math.floor(Vt):Math.ceil(Vt),height:Ht<0?Math.floor(Ht):Math.ceil(Ht),contextInstructions:Ut};(rt[0]!=1||rt[1]!=1)&&Ut.push("scale",rt),C&&(Ut.push("strokeStyle",z.strokeStyle),Ut.push("lineWidth",vt),Ut.push("lineCap",z.lineCap),Ut.push("lineJoin",z.lineJoin),Ut.push("miterLimit",z.miterLimit),Ut.push("setLineDash",[z.lineDash]),Ut.push("lineDashOffset",z.lineDashOffset)),v&&Ut.push("fillStyle",Z.fillStyle),Ut.push("textBaseline","middle"),Ut.push("textAlign","center");const ce=.5-_t;let ae=_t*$t+ce*vt;const De=[],Re=[];let fe=0,Ae=0,Ie=0,ge=0,me;for(let se=0,pe=xt.length;se<pe;se+=2){const ot=xt[se];if(ot===`
`){Ae+=fe,fe=0,ae=_t*$t+ce*vt,++ge;continue}const n=xt[se+1]||X.font;n!==me&&(C&&De.push("font",n),v&&Re.push("font",n),me=n),fe=Math.max(fe,bt[Ie]);const D=[ot,ae+ce*Ct[Ie]+_t*(Ct[Ie]-Gt[ge]),.5*(vt+fe)+Ae];ae+=Ct[Ie],C&&De.push("strokeText",D),v&&Re.push("fillText",D),++Ie}return Array.prototype.push.apply(Ut,De),Array.prototype.push.apply(Ut,Re),this.labels_[j]=re,re}replayTextBackground_(t,h,v,C,j,z,Z){t.beginPath(),t.moveTo.apply(t,h),t.lineTo.apply(t,v),t.lineTo.apply(t,C),t.lineTo.apply(t,j),t.lineTo.apply(t,h),z&&(this.alignAndScaleFill_=z[2],t.fillStyle=z[1],this.fill_(t)),Z&&(this.setStrokeStyle_(t,Z),t.stroke())}calculateImageOrLabelDimensions_(t,h,v,C,j,z,Z,X,ct,rt,_t,vt,xt,Pt,Bt,Ct){Z*=vt[0],X*=vt[1];let bt=v-Z,Gt=C-X;const $t=j+ct>t?t-ct:j,Ut=z+rt>h?h-rt:z,Vt=Pt[3]+$t*vt[0]+Pt[1],Ht=Pt[0]+Ut*vt[1]+Pt[2],re=bt-Pt[3],ce=Gt-Pt[0];(Bt||_t!==0)&&(et[0]=re,Rt[0]=re,et[1]=ce,Et[1]=ce,Et[0]=re+Vt,ut[0]=Et[0],ut[1]=ce+Ht,Rt[1]=ut[1]);let ae;return _t!==0?(ae=(0,it.Zz)((0,it.vt)(),v,C,1,1,_t,-v,-C),(0,it.Bb)(ae,et),(0,it.Bb)(ae,Et),(0,it.Bb)(ae,ut),(0,it.Bb)(ae,Rt),(0,d.N)(Math.min(et[0],Et[0],ut[0],Rt[0]),Math.min(et[1],Et[1],ut[1],Rt[1]),Math.max(et[0],Et[0],ut[0],Rt[0]),Math.max(et[1],Et[1],ut[1],Rt[1]),nt)):(0,d.N)(Math.min(re,re+Vt),Math.min(ce,ce+Ht),Math.max(re,re+Vt),Math.max(ce,ce+Ht),nt),xt&&(bt=Math.round(bt),Gt=Math.round(Gt)),{drawImageX:bt,drawImageY:Gt,drawImageW:$t,drawImageH:Ut,originX:ct,originY:rt,declutterBox:{minX:nt[0],minY:nt[1],maxX:nt[2],maxY:nt[3],value:Ct},canvasTransform:ae,scale:vt}}replayImageOrLabel_(t,h,v,C,j,z,Z){const X=!!(z||Z),ct=C.declutterBox,rt=Z?Z[2]*C.scale[0]/2:0;return ct.minX-rt<=h[0]&&ct.maxX+rt>=0&&ct.minY-rt<=h[1]&&ct.maxY+rt>=0&&(X&&this.replayTextBackground_(t,et,Et,ut,Rt,z,Z),(0,e.Jw)(t,C.canvasTransform,j,v,C.originX,C.originY,C.drawImageW,C.drawImageH,C.drawImageX,C.drawImageY,C.scale)),!0}fill_(t){const h=this.alignAndScaleFill_;if(h){const v=(0,it.Bb)(this.renderedTransform_,[0,0]),C=512*this.pixelRatio;t.save(),t.translate(v[0]%C,v[1]%C),h!==1&&t.scale(h,h),t.rotate(this.viewRotation_)}t.fill(),h&&t.restore()}setStrokeStyle_(t,h){t.strokeStyle=h[1],h[1]&&(t.lineWidth=h[2],t.lineCap=h[3],t.lineJoin=h[4],t.miterLimit=h[5],t.lineDashOffset=h[7],t.setLineDash(h[6]))}drawLabelWithPointPlacement_(t,h,v,C){const j=this.textStates[h],z=this.createLabel(t,h,C,v),Z=this.strokeStates[v],X=this.pixelRatio,ct=ie(Array.isArray(t)?t[0]:t,j.textAlign||e.MY),rt=x[j.textBaseline||e.M8],_t=Z&&Z.lineWidth?Z.lineWidth:0,vt=z.width/X-2*j.scale[0],xt=ct*vt+2*(.5-ct)*_t,Pt=rt*z.height/X+2*(.5-rt)*_t;return{label:z,anchorX:xt,anchorY:Pt}}execute_(t,h,v,C,j,z,Z,X){const ct=this.zIndexContext_;let rt;this.pixelCoordinates_&&(0,p.aI)(v,this.renderedTransform_)?rt=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),rt=(0,J.Rc)(this.coordinates,0,this.coordinates.length,2,v,this.pixelCoordinates_),(0,it.k3)(this.renderedTransform_,v));let _t=0;const vt=C.length;let xt=0,Pt,Bt,Ct,bt,Gt,$t,Ut,Vt,Ht,re,ce,ae,De,Re=0,fe=0;const Ae=this.coordinateCache_,Ie=this.viewRotation_,ge=Math.round(Math.atan2(-v[1],v[0])*1e12)/1e12,me={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Ie},se=this.instructions!=C||this.overlaps?0:200;let pe,ot,n,D;for(;_t<vt;){const M=C[_t];switch(M[0]){case f.BEGIN_GEOMETRY:pe=M[1],D=M[3],pe.getGeometry()?Z!==void 0&&!(0,d.HY)(Z,D.getExtent())?_t=M[2]+1:++_t:_t=M[2],ct&&(ct.zIndex=M[4]);break;case f.BEGIN_PATH:Re>se&&(this.fill_(t),Re=0),fe>se&&(t.stroke(),fe=0),!Re&&!fe&&(t.beginPath(),Gt=NaN,$t=NaN),++_t;break;case f.CIRCLE:xt=M[1];const yt=rt[xt],Tt=rt[xt+1],wt=rt[xt+2],xe=rt[xt+3],Se=wt-yt,Oe=xe-Tt,Xe=Math.sqrt(Se*Se+Oe*Oe);t.moveTo(yt+Xe,Tt),t.arc(yt,Tt,Xe,0,2*Math.PI,!0),++_t;break;case f.CLOSE_PATH:t.closePath(),++_t;break;case f.CUSTOM:xt=M[1],Pt=M[2];const Ue=M[3],an=M[4],Ye=M[5];me.geometry=Ue,me.feature=pe,_t in Ae||(Ae[_t]=[]);const Ge=Ae[_t];Ye?Ye(rt,xt,Pt,2,Ge):(Ge[0]=rt[xt],Ge[1]=rt[xt+1],Ge.length=2),ct&&(ct.zIndex=M[6]),an(Ge,me),++_t;break;case f.DRAW_IMAGE:xt=M[1],Pt=M[2],Ht=M[3],Bt=M[4],Ct=M[5];let tn=M[6];const $e=M[7],en=M[8],ln=M[9],Me=M[10];let we=M[11];const Ve=M[12];let We=M[13];bt=M[14]||"declutter";const Ze=M[15];if(!Ht&&M.length>=20){re=M[19],ce=M[20],ae=M[21],De=M[22];const Fe=this.drawLabelWithPointPlacement_(re,ce,ae,De);Ht=Fe.label,M[3]=Ht;const He=M[23];Bt=(Fe.anchorX-He)*this.pixelRatio,M[4]=Bt;const Be=M[24];Ct=(Fe.anchorY-Be)*this.pixelRatio,M[5]=Ct,tn=Ht.height,M[6]=tn,We=Ht.width,M[13]=We}let Je;M.length>25&&(Je=M[25]);let Qe,qe,on;M.length>17?(Qe=M[16],qe=M[17],on=M[18]):(Qe=e.Tq,qe=null,on=null),Me&&ge?we+=Ie:!Me&&!ge&&(we-=Ie);let xn=0;for(;xt<Pt;xt+=2){if(Je&&Je[xn++]<We/this.pixelRatio)continue;const Fe=this.calculateImageOrLabelDimensions_(Ht.width,Ht.height,rt[xt],rt[xt+1],We,tn,Bt,Ct,en,ln,we,Ve,j,Qe,!!qe||!!on,pe),He=[t,h,Ht,Fe,$e,qe,on];if(X){let Be,Ke,Ne;if(Ze){const Le=Pt-xt;if(!Ze[Le]){Ze[Le]={args:He,declutterMode:bt};continue}const be=Ze[Le];Be=be.args,Ke=be.declutterMode,delete Ze[Le],Ne=Mt(Be)}let ke,je;if(Be&&(Ke!=="declutter"||!X.collides(Ne))&&(ke=!0),(bt!=="declutter"||!X.collides(Fe.declutterBox))&&(je=!0),Ke==="declutter"&&bt==="declutter"){const Le=ke&&je;ke=Le,je=Le}ke&&(Ke!=="none"&&X.insert(Ne),this.replayImageOrLabel_.apply(this,Be)),je&&(bt!=="none"&&X.insert(Fe.declutterBox),this.replayImageOrLabel_.apply(this,He))}else this.replayImageOrLabel_.apply(this,He)}++_t;break;case f.DRAW_CHARS:const dn=M[1],fn=M[2],hn=M[3],yn=M[4];De=M[5];const vn=M[6],_n=M[7],gn=M[8];ae=M[9];const cn=M[10];re=M[11],Array.isArray(re)&&(re=re.reduce(Y,"")),ce=M[12];const mn=[M[13],M[13]];bt=M[14]||"declutter";const Tn=M[15],un=this.textStates[ce],nn=un.font,sn=[un.scale[0]*_n,un.scale[1]*_n];let rn;nn in this.widths_?rn=this.widths_[nn]:(rn={},this.widths_[nn]=rn);const pn=(0,st.k)(rt,dn,fn,2),En=Math.abs(sn[0])*(0,e.TA)(nn,re,rn);if(yn||En<=pn){const Fe=this.textStates[ce].textAlign,He=(pn-En)*ie(re,Fe),Be=gt(rt,dn,fn,2,re,He,vn,Math.abs(sn[0]),e.TA,nn,rn,ge?0:this.viewRotation_,Tn);t:if(Be){const Ke=[];let Ne,ke,je,Le,be;if(ae)for(Ne=0,ke=Be.length;Ne<ke;++Ne){be=Be[Ne],je=be[4],Le=this.createLabel(je,ce,"",ae),Bt=be[2]+(sn[0]<0?-cn:cn),Ct=hn*Le.height+(.5-hn)*2*cn*sn[1]/sn[0]-gn;const ze=this.calculateImageOrLabelDimensions_(Le.width,Le.height,be[0],be[1],Le.width,Le.height,Bt,Ct,0,0,be[3],mn,!1,e.Tq,!1,pe);if(X&&bt==="declutter"&&X.collides(ze.declutterBox))break t;Ke.push([t,h,Le,ze,1,null,null])}if(De)for(Ne=0,ke=Be.length;Ne<ke;++Ne){be=Be[Ne],je=be[4],Le=this.createLabel(je,ce,De,""),Bt=be[2],Ct=hn*Le.height-gn;const ze=this.calculateImageOrLabelDimensions_(Le.width,Le.height,be[0],be[1],Le.width,Le.height,Bt,Ct,0,0,be[3],mn,!1,e.Tq,!1,pe);if(X&&bt==="declutter"&&X.collides(ze.declutterBox))break t;Ke.push([t,h,Le,ze,1,null,null])}X&&bt!=="none"&&X.load(Ke.map(Mt));for(let ze=0,An=Ke.length;ze<An;++ze)this.replayImageOrLabel_.apply(this,Ke[ze])}}++_t;break;case f.END_GEOMETRY:if(z!==void 0){pe=M[1];const Fe=z(pe,D,bt);if(Fe)return Fe}++_t;break;case f.FILL:se?Re++:this.fill_(t),++_t;break;case f.MOVE_TO_LINE_TO:for(xt=M[1],Pt=M[2],ot=rt[xt],n=rt[xt+1],t.moveTo(ot,n),Gt=ot+.5|0,$t=n+.5|0,xt+=2;xt<Pt;xt+=2)ot=rt[xt],n=rt[xt+1],Ut=ot+.5|0,Vt=n+.5|0,(xt==Pt-2||Ut!==Gt||Vt!==$t)&&(t.lineTo(ot,n),Gt=Ut,$t=Vt);++_t;break;case f.SET_FILL_STYLE:this.alignAndScaleFill_=M[2],Re&&(this.fill_(t),Re=0,fe&&(t.stroke(),fe=0)),t.fillStyle=M[1],++_t;break;case f.SET_STROKE_STYLE:fe&&(t.stroke(),fe=0),this.setStrokeStyle_(t,M),++_t;break;case f.STROKE:se?fe++:t.stroke(),++_t;break;default:++_t;break}}Re&&this.fill_(t),fe&&t.stroke()}execute(t,h,v,C,j,z){this.viewRotation_=C,this.execute_(t,h,v,this.instructions,j,void 0,void 0,z)}executeHitDetection(t,h,v,C,j){return this.viewRotation_=v,this.execute_(t,[t.canvas.width,t.canvas.height],h,this.hitDetectionInstructions,!0,C,j)}}const q=H,Lt=["Polygon","Circle","LineString","Image","Text","Default"],Dt=["Image","Text"],zt=Lt.filter(pt=>!Dt.includes(pt));class Yt{constructor(t,h,v,C,j,z,Z){this.maxExtent_=t,this.overlaps_=C,this.pixelRatio_=v,this.resolution_=h,this.renderBuffer_=z,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,it.vt)(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(j,Z)}clip(t,h){const v=this.getClipCoords(h);t.beginPath(),t.moveTo(v[0],v[1]),t.lineTo(v[2],v[3]),t.lineTo(v[4],v[5]),t.lineTo(v[6],v[7]),t.clip()}createExecutors_(t,h){for(const v in t){let C=this.executorsByZIndex_[v];C===void 0&&(C={},this.executorsByZIndex_[v]=C);const j=t[v];for(const z in j){const Z=j[z];C[z]=new q(this.resolution_,this.pixelRatio_,this.overlaps_,Z,h)}}}hasExecutors(t){for(const h in this.executorsByZIndex_){const v=this.executorsByZIndex_[h];for(let C=0,j=t.length;C<j;++C)if(t[C]in v)return!0}return!1}forEachFeatureAtCoordinate(t,h,v,C,j,z){C=Math.round(C);const Z=C*2+1,X=(0,it.Zz)(this.hitDetectionTransform_,C+.5,C+.5,1/h,-1/h,-v,-t[0],-t[1]),ct=!this.hitDetectionContext_;ct&&(this.hitDetectionContext_=(0,K.Y)(Z,Z));const rt=this.hitDetectionContext_;rt.canvas.width!==Z||rt.canvas.height!==Z?(rt.canvas.width=Z,rt.canvas.height=Z):ct||rt.clearRect(0,0,Z,Z);let _t;this.renderBuffer_!==void 0&&(_t=(0,d.S5)(),(0,d.$C)(_t,t),(0,d.r)(_t,h*(this.renderBuffer_+C),_t));const vt=ee(C);let xt;function Pt(Vt,Ht,re){const ce=rt.getImageData(0,0,Z,Z).data;for(let ae=0,De=vt.length;ae<De;ae++)if(ce[vt[ae]]>0){if(!z||re==="none"||xt!=="Image"&&xt!=="Text"||z.includes(Vt)){const Re=(vt[ae]-3)/4,fe=C-Re%Z,Ae=C-(Re/Z|0),Ie=j(Vt,Ht,fe*fe+Ae*Ae);if(Ie)return Ie}rt.clearRect(0,0,Z,Z);break}}const Bt=Object.keys(this.executorsByZIndex_).map(Number);Bt.sort(p.V_);let Ct,bt,Gt,$t,Ut;for(Ct=Bt.length-1;Ct>=0;--Ct){const Vt=Bt[Ct].toString();for(Gt=this.executorsByZIndex_[Vt],bt=Lt.length-1;bt>=0;--bt)if(xt=Lt[bt],$t=Gt[xt],$t!==void 0&&(Ut=$t.executeHitDetection(rt,X,v,Pt,_t),Ut))return Ut}}getClipCoords(t){const h=this.maxExtent_;if(!h)return null;const v=h[0],C=h[1],j=h[2],z=h[3],Z=[v,C,v,z,j,z,j,C];return(0,J.Rc)(Z,0,8,2,t,Z),Z}isEmpty(){return(0,ft.p)(this.executorsByZIndex_)}execute(t,h,v,C,j,z,Z){const X=Object.keys(this.executorsByZIndex_).map(Number);X.sort(Z?p.rG:p.V_),z=z||Lt;const ct=Lt.length;for(let rt=0,_t=X.length;rt<_t;++rt){const vt=X[rt].toString(),xt=this.executorsByZIndex_[vt];for(let Pt=0,Bt=z.length;Pt<Bt;++Pt){const Ct=z[Pt],bt=xt[Ct];if(bt!==void 0){const Gt=Z===null?void 0:bt.getZIndexContext(),$t=Gt?Gt.getContext():t,Ut=this.maxExtent_&&Ct!=="Image"&&Ct!=="Text";if(Ut&&($t.save(),this.clip($t,v)),!Gt||Ct==="Text"||Ct==="Image"?bt.execute($t,h,v,C,j,Z):Gt.pushFunction(Vt=>bt.execute(Vt,h,v,C,j,Z)),Ut&&$t.restore(),Gt){Gt.offset();const Vt=X[rt]*ct+Lt.indexOf(Ct);this.deferredZIndexContexts_[Vt]||(this.deferredZIndexContexts_[Vt]=[]),this.deferredZIndexContexts_[Vt].push(Gt)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,h=Object.keys(t).map(Number).sort(p.V_);for(let v=0,C=h.length;v<C;++v)t[h[v]].forEach(j=>{j.draw(this.renderedContext_),j.clear()}),t[h[v]].length=0}}const Xt={};function ee(pt){if(Xt[pt]!==void 0)return Xt[pt];const t=pt*2+1,h=pt*pt,v=new Array(h+1);for(let j=0;j<=pt;++j)for(let z=0;z<=pt;++z){const Z=j*j+z*z;if(Z>h)break;let X=v[Z];X||(X=[],v[Z]=X),X.push(((pt+j)*t+(pt+z))*4+3),j>0&&X.push(((pt-j)*t+(pt+z))*4+3),z>0&&(X.push(((pt+j)*t+(pt-z))*4+3),j>0&&X.push(((pt-j)*t+(pt-z))*4+3))}const C=[];for(let j=0,z=v.length;j<z;++j)v[j]&&C.push(...v[j]);return Xt[pt]=C,C}const ne=Yt;var Jt=i(49700),ue=i(62096);class Kt extends s{constructor(t,h,v,C,j,z,Z){super(),this.context_=t,this.pixelRatio_=h,this.extent_=v,this.transform_=C,this.transformRotation_=C?(0,L.Mg)(Math.atan2(C[1],C[0]),10):0,this.viewRotation_=j,this.squaredTolerance_=z,this.userTransform_=Z,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,it.vt)()}drawImages_(t,h,v,C){if(!this.image_)return;const j=(0,J.Rc)(t,h,v,C,this.transform_,this.pixelCoordinates_),z=this.context_,Z=this.tmpLocalTransform_,X=z.globalAlpha;this.imageOpacity_!=1&&(z.globalAlpha=X*this.imageOpacity_);let ct=this.imageRotation_;this.transformRotation_===0&&(ct-=this.viewRotation_),this.imageRotateWithView_&&(ct+=this.viewRotation_);for(let rt=0,_t=j.length;rt<_t;rt+=2){const vt=j[rt]-this.imageAnchorX_,xt=j[rt+1]-this.imageAnchorY_;if(ct!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const Pt=vt+this.imageAnchorX_,Bt=xt+this.imageAnchorY_;(0,it.Zz)(Z,Pt,Bt,1,1,ct,-Pt,-Bt),z.save(),z.transform.apply(z,Z),z.translate(Pt,Bt),z.scale(this.imageScale_[0],this.imageScale_[1]),z.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),z.restore()}else z.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,vt,xt,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(z.globalAlpha=X)}drawText_(t,h,v,C){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const j=(0,J.Rc)(t,h,v,C,this.transform_,this.pixelCoordinates_),z=this.context_;let Z=this.textRotation_;for(this.transformRotation_===0&&(Z-=this.viewRotation_),this.textRotateWithView_&&(Z+=this.viewRotation_);h<v;h+=C){const X=j[h]+this.textOffsetX_,ct=j[h+1]+this.textOffsetY_;Z!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(z.save(),z.translate(X-this.textOffsetX_,ct-this.textOffsetY_),z.rotate(Z),z.translate(this.textOffsetX_,this.textOffsetY_),z.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&z.strokeText(this.text_,0,0),this.textFillState_&&z.fillText(this.text_,0,0),z.restore()):(this.textStrokeState_&&z.strokeText(this.text_,X,ct),this.textFillState_&&z.fillText(this.text_,X,ct))}}moveToLineTo_(t,h,v,C,j){const z=this.context_,Z=(0,J.Rc)(t,h,v,C,this.transform_,this.pixelCoordinates_);z.moveTo(Z[0],Z[1]);let X=Z.length;j&&(X-=2);for(let ct=2;ct<X;ct+=2)z.lineTo(Z[ct],Z[ct+1]);return j&&z.closePath(),v}drawRings_(t,h,v,C){for(let j=0,z=v.length;j<z;++j)h=this.moveToLineTo_(t,h,v[j],C,!0);return h}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,d.HY)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const h=(0,ue.v7)(t,this.transform_,this.pixelCoordinates_),v=h[2]-h[0],C=h[3]-h[1],j=Math.sqrt(v*v+C*C),z=this.context_;z.beginPath(),z.arc(h[0],h[1],j,0,2*Math.PI),this.fillState_&&z.fill(),this.strokeState_&&z.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break;default:}}drawFeature(t,h){const v=h.getGeometryFunction()(t);v&&(this.setStyle(h),this.drawGeometry(v))}drawGeometryCollection(t){const h=t.getGeometriesArray();for(let v=0,C=h.length;v<C;++v)this.drawGeometry(h[v])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const h=t.getFlatCoordinates(),v=t.getStride();this.image_&&this.drawImages_(h,0,h.length,v),this.text_!==""&&this.drawText_(h,0,h.length,v)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const h=t.getFlatCoordinates(),v=t.getStride();this.image_&&this.drawImages_(h,0,h.length,v),this.text_!==""&&this.drawText_(h,0,h.length,v)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,d.HY)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const h=this.context_,v=t.getFlatCoordinates();h.beginPath(),this.moveToLineTo_(v,0,v.length,t.getStride(),!1),h.stroke()}if(this.text_!==""){const h=t.getFlatMidpoint();this.drawText_(h,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const h=t.getExtent();if((0,d.HY)(this.extent_,h)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const v=this.context_,C=t.getFlatCoordinates();let j=0;const z=t.getEnds(),Z=t.getStride();v.beginPath();for(let X=0,ct=z.length;X<ct;++X)j=this.moveToLineTo_(C,j,z[X],Z,!1);v.stroke()}if(this.text_!==""){const v=t.getFlatMidpoints();this.drawText_(v,0,v.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,d.HY)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const h=this.context_;h.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&h.fill(),this.strokeState_&&h.stroke()}if(this.text_!==""){const h=t.getFlatInteriorPoint();this.drawText_(h,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!(0,d.HY)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const h=this.context_,v=t.getOrientedFlatCoordinates();let C=0;const j=t.getEndss(),z=t.getStride();h.beginPath();for(let Z=0,X=j.length;Z<X;++Z){const ct=j[Z];C=this.drawRings_(v,C,ct,z)}this.fillState_&&h.fill(),this.strokeState_&&h.stroke()}if(this.text_!==""){const h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}}setContextFillState_(t){const h=this.context_,v=this.contextFillState_;v?v.fillStyle!=t.fillStyle&&(v.fillStyle=t.fillStyle,h.fillStyle=t.fillStyle):(h.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const h=this.context_,v=this.contextStrokeState_;v?(v.lineCap!=t.lineCap&&(v.lineCap=t.lineCap,h.lineCap=t.lineCap),(0,p.aI)(v.lineDash,t.lineDash)||h.setLineDash(v.lineDash=t.lineDash),v.lineDashOffset!=t.lineDashOffset&&(v.lineDashOffset=t.lineDashOffset,h.lineDashOffset=t.lineDashOffset),v.lineJoin!=t.lineJoin&&(v.lineJoin=t.lineJoin,h.lineJoin=t.lineJoin),v.lineWidth!=t.lineWidth&&(v.lineWidth=t.lineWidth,h.lineWidth=t.lineWidth),v.miterLimit!=t.miterLimit&&(v.miterLimit=t.miterLimit,h.miterLimit=t.miterLimit),v.strokeStyle!=t.strokeStyle&&(v.strokeStyle=t.strokeStyle,h.strokeStyle=t.strokeStyle)):(h.lineCap=t.lineCap,h.setLineDash(t.lineDash),h.lineDashOffset=t.lineDashOffset,h.lineJoin=t.lineJoin,h.lineWidth=t.lineWidth,h.miterLimit=t.miterLimit,h.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const h=this.context_,v=this.contextTextState_,C=t.textAlign?t.textAlign:e.MY;v?(v.font!=t.font&&(v.font=t.font,h.font=t.font),v.textAlign!=C&&(v.textAlign=C,h.textAlign=C),v.textBaseline!=t.textBaseline&&(v.textBaseline=t.textBaseline,h.textBaseline=t.textBaseline)):(h.font=t.font,h.textAlign=C,h.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:C,textBaseline:t.textBaseline})}setFillStrokeStyle(t,h){if(!t)this.fillState_=null;else{const v=t.getColor();this.fillState_={fillStyle:(0,y.F)(v||e.qY)}}if(!h)this.strokeState_=null;else{const v=h.getColor(),C=h.getLineCap(),j=h.getLineDash(),z=h.getLineDashOffset(),Z=h.getLineJoin(),X=h.getWidth(),ct=h.getMiterLimit(),rt=j||e.Oq;this.strokeState_={lineCap:C!==void 0?C:e._m,lineDash:this.pixelRatio_===1?rt:rt.map(_t=>_t*this.pixelRatio_),lineDashOffset:(z||e.vk)*this.pixelRatio_,lineJoin:Z!==void 0?Z:e._K,lineWidth:(X!==void 0?X:e.aq)*this.pixelRatio_,miterLimit:ct!==void 0?ct:e.eL,strokeStyle:(0,y.F)(v||e.NT)}}}setImageStyle(t){let h;if(!t||!(h=t.getSize())){this.image_=null;return}const v=t.getPixelRatio(this.pixelRatio_),C=t.getAnchor(),j=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=C[0]*v,this.imageAnchorY_=C[1]*v,this.imageHeight_=h[1]*v,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=j[0],this.imageOriginY_=j[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const z=t.getScaleArray();this.imageScale_=[z[0]*this.pixelRatio_/v,z[1]*this.pixelRatio_/v],this.imageWidth_=h[0]*v}setTextStyle(t){if(!t)this.text_="";else{const h=t.getFill();if(!h)this.textFillState_=null;else{const xt=h.getColor();this.textFillState_={fillStyle:(0,y.F)(xt||e.qY)}}const v=t.getStroke();if(!v)this.textStrokeState_=null;else{const xt=v.getColor(),Pt=v.getLineCap(),Bt=v.getLineDash(),Ct=v.getLineDashOffset(),bt=v.getLineJoin(),Gt=v.getWidth(),$t=v.getMiterLimit();this.textStrokeState_={lineCap:Pt!==void 0?Pt:e._m,lineDash:Bt||e.Oq,lineDashOffset:Ct||e.vk,lineJoin:bt!==void 0?bt:e._K,lineWidth:Gt!==void 0?Gt:e.aq,miterLimit:$t!==void 0?$t:e.eL,strokeStyle:(0,y.F)(xt||e.NT)}}const C=t.getFont(),j=t.getOffsetX(),z=t.getOffsetY(),Z=t.getRotateWithView(),X=t.getRotation(),ct=t.getScaleArray(),rt=t.getText(),_t=t.getTextAlign(),vt=t.getTextBaseline();this.textState_={font:C!==void 0?C:e.ZV,textAlign:_t!==void 0?_t:e.MY,textBaseline:vt!==void 0?vt:e.M8},this.text_=rt!==void 0?Array.isArray(rt)?rt.reduce((xt,Pt,Bt)=>xt+=Bt%2?" ":Pt,""):rt:"",this.textOffsetX_=j!==void 0?this.pixelRatio_*j:0,this.textOffsetY_=z!==void 0?this.pixelRatio_*z:0,this.textRotateWithView_=Z!==void 0?Z:!1,this.textRotation_=X!==void 0?X:0,this.textScale_=[this.pixelRatio_*ct[0],this.pixelRatio_*ct[1]]}}}const Ce=Kt,de=.5;function V(pt,t,h,v,C,j,z,Z,X){const ct=X?(0,E.JR)(C,X):C,rt=pt[0]*de,_t=pt[1]*de,vt=(0,K.Y)(rt,_t);vt.imageSmoothingEnabled=!1;const xt=vt.canvas,Pt=new Ce(vt,de,C,null,z,Z,X?(0,E.FO)((0,E.Tf)(),X):null),Bt=h.length,Ct=Math.floor((256*256*256-1)/Bt),bt={};for(let $t=1;$t<=Bt;++$t){const Ut=h[$t-1],Vt=Ut.getStyleFunction()||v;if(!Vt)continue;let Ht=Vt(Ut,j);if(!Ht)continue;Array.isArray(Ht)||(Ht=[Ht]);const ce=($t*Ct).toString(16).padStart(7,"#00000");for(let ae=0,De=Ht.length;ae<De;++ae){const Re=Ht[ae],fe=Re.getGeometryFunction()(Ut);if(!fe||!(0,d.HY)(ct,fe.getExtent()))continue;const Ae=Re.clone(),Ie=Ae.getFill();Ie&&Ie.setColor(ce);const ge=Ae.getStroke();ge&&(ge.setColor(ce),ge.setLineDash(null)),Ae.setText(void 0);const me=Re.getImage();if(me){const n=me.getImageSize();if(!n)continue;const D=(0,K.Y)(n[0],n[1],void 0,{alpha:!1}),M=D.canvas;D.fillStyle=ce,D.fillRect(0,0,M.width,M.height),Ae.setImage(new Jt.A({img:M,anchor:me.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:me.getOrigin(),opacity:1,size:me.getSize(),scale:me.getScale(),rotation:me.getRotation(),rotateWithView:me.getRotateWithView()}))}const se=Ae.getZIndex()||0;let pe=bt[se];pe||(pe={},bt[se]=pe,pe.Polygon=[],pe.Circle=[],pe.LineString=[],pe.Point=[]);const ot=fe.getType();if(ot==="GeometryCollection"){const n=fe.getGeometriesArrayRecursive();for(let D=0,M=n.length;D<M;++D){const Q=n[D];pe[Q.getType().replace("Multi","")].push(Q,Ae)}}else pe[ot.replace("Multi","")].push(fe,Ae)}}const Gt=Object.keys(bt).map(Number).sort(p.V_);for(let $t=0,Ut=Gt.length;$t<Ut;++$t){const Vt=bt[Gt[$t]];for(const Ht in Vt){const re=Vt[Ht];for(let ce=0,ae=re.length;ce<ae;ce+=2){Pt.setStyle(re[ce+1]);for(let De=0,Re=t.length;De<Re;++De)Pt.setTransform(t[De]),Pt.drawGeometry(re[ce])}}}return vt.getImageData(0,0,xt.width,xt.height)}function F(pt,t,h){const v=[];if(h){const C=Math.floor(Math.round(pt[0])*de),j=Math.floor(Math.round(pt[1])*de),z=((0,L.qE)(C,0,h.width-1)+(0,L.qE)(j,0,h.height-1)*h.width)*4,Z=h.data[z],X=h.data[z+1],rt=h.data[z+2]+256*(X+256*Z),_t=Math.floor((256*256*256-1)/t.length);rt&&rt%_t===0&&v.push(t[rt/_t-1])}return v}var lt=i(6141);const mt=.5,It={Point:Pe,LineString:te,Polygon:he,MultiPoint:Te,MultiLineString:_e,MultiPolygon:ye,GeometryCollection:oe,Circle:qt};function Nt(pt,t){return parseInt((0,u.v6)(pt),10)-parseInt((0,u.v6)(t),10)}function St(pt,t){const h=Zt(pt,t);return h*h}function Zt(pt,t){return mt*pt/t}function qt(pt,t,h,v,C){const j=h.getFill(),z=h.getStroke();if(j||z){const X=pt.getBuilder(h.getZIndex(),"Circle");X.setFillStrokeStyle(j,z),X.drawCircle(t,v,C)}const Z=h.getText();if(Z&&Z.getText()){const X=pt.getBuilder(h.getZIndex(),"Text");X.setTextStyle(Z),X.drawText(t,v)}}function At(pt,t,h,v,C,j,z,Z){const X=[],ct=h.getImage();if(ct){let vt=!0;const xt=ct.getImageState();xt==lt.A.LOADED||xt==lt.A.ERROR?vt=!1:xt==lt.A.IDLE&&ct.load(),vt&&X.push(ct.ready())}const rt=h.getFill();rt&&rt.loading()&&X.push(rt.ready());const _t=X.length>0;return _t&&Promise.all(X).then(()=>C(null)),kt(pt,t,h,v,j,z,Z),_t}function kt(pt,t,h,v,C,j,z){const Z=h.getGeometryFunction()(t);if(!Z)return;const X=Z.simplifyTransformed(v,C);if(h.getRenderer())Wt(pt,X,h,t,z);else{const rt=It[X.getType()];rt(pt,X,h,t,z,j)}}function Wt(pt,t,h,v,C){if(t.getType()=="GeometryCollection"){const z=t.getGeometries();for(let Z=0,X=z.length;Z<X;++Z)Wt(pt,z[Z],h,v,C);return}pt.getBuilder(h.getZIndex(),"Default").drawCustom(t,v,h.getRenderer(),h.getHitDetectionRenderer(),C)}function oe(pt,t,h,v,C,j){const z=t.getGeometriesArray();let Z,X;for(Z=0,X=z.length;Z<X;++Z){const ct=It[z[Z].getType()];ct(pt,z[Z],h,v,C,j)}}function te(pt,t,h,v,C){const j=h.getStroke();if(j){const Z=pt.getBuilder(h.getZIndex(),"LineString");Z.setFillStrokeStyle(null,j),Z.drawLineString(t,v,C)}const z=h.getText();if(z&&z.getText()){const Z=pt.getBuilder(h.getZIndex(),"Text");Z.setTextStyle(z),Z.drawText(t,v,C)}}function _e(pt,t,h,v,C){const j=h.getStroke();if(j){const Z=pt.getBuilder(h.getZIndex(),"LineString");Z.setFillStrokeStyle(null,j),Z.drawMultiLineString(t,v,C)}const z=h.getText();if(z&&z.getText()){const Z=pt.getBuilder(h.getZIndex(),"Text");Z.setTextStyle(z),Z.drawText(t,v,C)}}function ye(pt,t,h,v,C){const j=h.getFill(),z=h.getStroke();if(z||j){const X=pt.getBuilder(h.getZIndex(),"Polygon");X.setFillStrokeStyle(j,z),X.drawMultiPolygon(t,v,C)}const Z=h.getText();if(Z&&Z.getText()){const X=pt.getBuilder(h.getZIndex(),"Text");X.setTextStyle(Z),X.drawText(t,v,C)}}function Pe(pt,t,h,v,C,j){const z=h.getImage(),Z=h.getText(),X=Z&&Z.getText(),ct=j&&z&&X?{}:void 0;if(z){if(z.getImageState()!=lt.A.LOADED)return;const rt=pt.getBuilder(h.getZIndex(),"Image");rt.setImageStyle(z,ct),rt.drawPoint(t,v,C)}if(X){const rt=pt.getBuilder(h.getZIndex(),"Text");rt.setTextStyle(Z,ct),rt.drawText(t,v,C)}}function Te(pt,t,h,v,C,j){const z=h.getImage(),Z=z&&z.getOpacity()!==0,X=h.getText(),ct=X&&X.getText(),rt=j&&Z&&ct?{}:void 0;if(Z){if(z.getImageState()!=lt.A.LOADED)return;const _t=pt.getBuilder(h.getZIndex(),"Image");_t.setImageStyle(z,rt),_t.drawMultiPoint(t,v,C)}if(ct){const _t=pt.getBuilder(h.getZIndex(),"Text");_t.setTextStyle(X,rt),_t.drawText(t,v,C)}}function he(pt,t,h,v,C){const j=h.getFill(),z=h.getStroke();if(j||z){const X=pt.getBuilder(h.getZIndex(),"Polygon");X.setFillStrokeStyle(j,z),X.drawPolygon(t,v,C)}const Z=h.getText();if(Z&&Z.getText()){const X=pt.getBuilder(h.getZIndex(),"Text");X.setTextStyle(Z),X.drawText(t,v,C)}}var le=i(96769);class ve extends le.A{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,d.S5)(),this.wrappedRenderedExtent_=(0,d.S5)(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,h,v){const C=h.extent,j=h.viewState,z=j.center,Z=j.resolution,X=j.projection,ct=j.rotation,rt=X.getExtent(),_t=this.getLayer().getSource(),vt=this.getLayer().getDeclutter(),xt=h.pixelRatio,Pt=h.viewHints,Bt=!(Pt[U.A.ANIMATING]||Pt[U.A.INTERACTING]),Ct=this.context,bt=Math.round((0,d.RG)(C)/Z*xt),Gt=Math.round((0,d.Oq)(C)/Z*xt),$t=_t.getWrapX()&&X.canWrapX(),Ut=$t?(0,d.RG)(rt):null,Vt=$t?Math.ceil((C[2]-rt[2])/Ut)+1:1;let Ht=$t?Math.floor((C[0]-rt[0])/Ut):0;do{let re=this.getRenderTransform(z,Z,0,xt,bt,Gt,Ht*Ut);h.declutter&&(re=re.slice(0)),t.execute(Ct,[Ct.canvas.width,Ct.canvas.height],re,ct,Bt,v===void 0?Lt:v?Dt:zt,v?vt&&h.declutter[vt]:void 0)}while(++Ht<Vt)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=(0,K.Y)(this.context.canvas.width,this.context.canvas.height,le.B))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,(0,K.Yg)(this.context),le.B.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,h){const v=t.layerStatesArray[t.layerIndex];this.opacity_=v.opacity;const C=t.viewState;this.prepareContainer(t,h);const j=this.context,z=this.replayGroup_;let Z=z&&!z.isEmpty();if(!Z&&!(this.getLayer().hasListener(l.A.PRERENDER)||this.getLayer().hasListener(l.A.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(j,t);const X=C.projection;if(this.clipped_=!1,Z&&v.extent&&this.clipping){const ct=(0,E.SD)(v.extent,X);Z=(0,d.HY)(ct,t.extent),this.clipped_=Z&&!(0,d.ms)(ct,t.extent),this.clipped_&&this.clipUnrotated(j,t,ct)}return Z&&this.renderWorlds(z,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&j.restore(),this.postRender(j,t),this.renderedRotation_!==C.rotation&&(this.renderedRotation_=C.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(h=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const v=this.frameState.size.slice(),C=this.renderedCenter_,j=this.renderedResolution_,z=this.renderedRotation_,Z=this.renderedProjection_,X=this.wrappedRenderedExtent_,ct=this.getLayer(),rt=[],_t=v[0]*de,vt=v[1]*de;rt.push(this.getRenderTransform(C,j,z,de,_t,vt,0).slice());const xt=ct.getSource(),Pt=Z.getExtent();if(xt.getWrapX()&&Z.canWrapX()&&!(0,d.ms)(Pt,X)){let Ct=X[0];const bt=(0,d.RG)(Pt);let Gt=0,$t;for(;Ct<Pt[0];)--Gt,$t=bt*Gt,rt.push(this.getRenderTransform(C,j,z,de,_t,vt,$t).slice()),Ct+=bt;for(Gt=0,Ct=X[2];Ct>Pt[2];)++Gt,$t=bt*Gt,rt.push(this.getRenderTransform(C,j,z,de,_t,vt,$t).slice()),Ct-=bt}const Bt=(0,E.Tf)();this.hitDetectionImageData_=V(v,rt,this.renderedFeatures_,ct.getStyleFunction(),X,j,z,St(j,this.renderedPixelRatio_),Bt?Z:null)}h(F(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,h,v,C,j){if(!this.replayGroup_)return;const z=h.viewState.resolution,Z=h.viewState.rotation,X=this.getLayer(),ct={},rt=function(vt,xt,Pt){const Bt=(0,u.v6)(vt),Ct=ct[Bt];if(Ct){if(Ct!==!0&&Pt<Ct.distanceSq){if(Pt===0)return ct[Bt]=!0,j.splice(j.lastIndexOf(Ct),1),C(vt,X,xt);Ct.geometry=xt,Ct.distanceSq=Pt}}else{if(Pt===0)return ct[Bt]=!0,C(vt,X,xt);j.push(ct[Bt]={feature:vt,layer:X,geometry:xt,distanceSq:Pt,callback:C})}},_t=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,z,Z,v,rt,_t?h.declutter?.[_t]?.all().map(vt=>vt.value):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const h=this.getLayer(),v=h.getSource();if(!v)return!1;const C=t.viewHints[U.A.ANIMATING],j=t.viewHints[U.A.INTERACTING],z=h.getUpdateWhileAnimating(),Z=h.getUpdateWhileInteracting();if(this.ready&&!z&&C||!Z&&j)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const X=t.extent,ct=t.viewState,rt=ct.projection,_t=ct.resolution,vt=t.pixelRatio,xt=h.getRevision(),Pt=h.getRenderBuffer();let Bt=h.getRenderOrder();Bt===void 0&&(Bt=Nt);const Ct=ct.center.slice(),bt=(0,d.r)(X,Pt*_t),Gt=bt.slice(),$t=[bt.slice()],Ut=rt.getExtent();if(v.getWrapX()&&rt.canWrapX()&&!(0,d.ms)(Ut,t.extent)){const ge=(0,d.RG)(Ut),me=Math.max((0,d.RG)(bt)/2,ge);bt[0]=Ut[0]-me,bt[2]=Ut[2]+me,(0,$.Li)(Ct,rt);const se=(0,d.Li)($t[0],rt);se[0]<Ut[0]&&se[2]<Ut[2]?$t.push([se[0]+ge,se[1],se[2]+ge,se[3]]):se[0]>Ut[0]&&se[2]>Ut[2]&&$t.push([se[0]-ge,se[1],se[2]-ge,se[3]])}if(this.ready&&this.renderedResolution_==_t&&this.renderedRevision_==xt&&this.renderedRenderOrder_==Bt&&this.renderedFrameDeclutter_===!!t.declutter&&(0,d.ms)(this.wrappedRenderedExtent_,bt))return(0,p.aI)(this.renderedExtent_,Gt)||(this.hitDetectionImageData_=null,this.renderedExtent_=Gt),this.renderedCenter_=Ct,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const Vt=new dt(Zt(_t,vt),bt,_t,vt),Ht=(0,E.Tf)();let re;if(Ht){for(let ge=0,me=$t.length;ge<me;++ge){const se=$t[ge],pe=(0,E.JR)(se,rt);v.loadFeatures(pe,(0,E.vN)(_t,rt),Ht)}re=(0,E.FO)(Ht,rt)}else for(let ge=0,me=$t.length;ge<me;++ge)v.loadFeatures($t[ge],_t,rt);const ce=St(_t,vt);let ae=!0;const De=(ge,me)=>{let se;const pe=ge.getStyleFunction()||h.getStyleFunction();if(pe&&(se=pe(ge,_t)),se){const ot=this.renderFeature(ge,ce,se,Vt,re,this.getLayer().getDeclutter(),me);ae=ae&&!ot}},Re=(0,E.JR)(bt,rt),fe=v.getFeaturesInExtent(Re);Bt&&fe.sort(Bt);for(let ge=0,me=fe.length;ge<me;++ge)De(fe[ge],ge);this.renderedFeatures_=fe,this.ready=ae;const Ae=Vt.finish(),Ie=new ne(bt,_t,vt,v.getOverlaps(),Ae,h.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=_t,this.renderedRevision_=xt,this.renderedRenderOrder_=Bt,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=Gt,this.wrappedRenderedExtent_=bt,this.renderedCenter_=Ct,this.renderedProjection_=rt,this.renderedPixelRatio_=vt,this.replayGroup_=Ie,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,h,v,C,j,z,Z){if(!v)return!1;let X=!1;if(Array.isArray(v))for(let ct=0,rt=v.length;ct<rt;++ct)X=At(C,t,v[ct],h,this.boundHandleStyleImageChange_,j,z,Z)||X;else X=At(C,t,v,h,this.boundHandleStyleImageChange_,j,z,Z);return X}}const Ee=ve},68711:(Ft,at,i)=>{i.d(at,{WM:()=>g,Y:()=>p,Yg:()=>d,fo:()=>y,gS:()=>P,lr:()=>K});var U=i(7771);function p(I,s,e,c){let G;return e&&e.length?G=e.shift():U.Wl?G=new OffscreenCanvas(I||300,s||300):G=document.createElement("canvas"),I&&(G.width=I),s&&(G.height=s),G.getContext("2d",c)}let $;function K(){return $||($=p(1,1)),$}function d(I){const s=I.canvas;s.width=1,s.height=1,I.clearRect(0,0,1,1)}function E(I){let s=I.offsetWidth;const e=getComputedStyle(I);return s+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),s}function l(I){let s=I.offsetHeight;const e=getComputedStyle(I);return s+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),s}function y(I,s){const e=s.parentNode;e&&e.replaceChild(I,s)}function P(I){for(;I.lastChild;)I.lastChild.remove()}function g(I,s){const e=I.childNodes;for(let c=0;;++c){const G=e[c],B=s[c];if(!G&&!B)break;if(G!==B){if(!G){I.appendChild(B);continue}if(!B){I.removeChild(G),--c;continue}I.insertBefore(B,G)}}}},69186:(Ft,at,i)=>{i.d(at,{A:()=>E});var U=i(25176),p=i(93474),$=i(6837),K=i(10972);class d extends K.A{constructor(y){y=y||{},super({element:document.createElement("div"),target:y.target});const P=y.className!==void 0?y.className:"ol-zoom",g=y.delta!==void 0?y.delta:1,I=y.zoomInClassName!==void 0?y.zoomInClassName:P+"-in",s=y.zoomOutClassName!==void 0?y.zoomOutClassName:P+"-out",e=y.zoomInLabel!==void 0?y.zoomInLabel:"+",c=y.zoomOutLabel!==void 0?y.zoomOutLabel:"\u2013",G=y.zoomInTipLabel!==void 0?y.zoomInTipLabel:"Zoom in",B=y.zoomOutTipLabel!==void 0?y.zoomOutTipLabel:"Zoom out",w=document.createElement("button");w.className=I,w.setAttribute("type","button"),w.title=G,w.appendChild(typeof e=="string"?document.createTextNode(e):e),w.addEventListener($.A.CLICK,this.handleClick_.bind(this,g),!1);const T=document.createElement("button");T.className=s,T.setAttribute("type","button"),T.title=B,T.appendChild(typeof c=="string"?document.createTextNode(c):c),T.addEventListener($.A.CLICK,this.handleClick_.bind(this,-g),!1);const f=P+" "+U.XI+" "+U.$N,m=this.element;m.className=f,m.appendChild(w),m.appendChild(T),this.duration_=y.duration!==void 0?y.duration:250}handleClick_(y,P){P.preventDefault(),this.zoomByDelta_(y)}zoomByDelta_(y){const g=this.getMap().getView();if(!g)return;const I=g.getZoom();if(I!==void 0){const s=g.getConstrainedZoom(I+y);this.duration_>0?(g.getAnimating()&&g.cancelAnimations(),g.animate({zoom:s,duration:this.duration_,easing:p.vT})):g.setZoom(s)}}}const E=d},69796:(Ft,at,i)=>{i.d(at,{A:()=>y});var U=i(6141),p=i(62703),$=i(70915),K=i(43067),d=i(9703),E=i(96769);class l extends E.A{constructor(g){super(g),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(g){const I=g.layerStatesArray[g.layerIndex],s=g.pixelRatio,e=g.viewState,c=e.resolution,G=this.getLayer().getSource(),B=g.viewHints;let w=g.extent;if(I.extent!==void 0&&(w=(0,$._N)(w,(0,K.SD)(I.extent,e.projection))),!B[p.A.ANIMATING]&&!B[p.A.INTERACTING]&&!(0,$.Im)(w))if(G){const T=e.projection,f=G.getImage(w,c,s,T);f&&(this.loadImage(f)?this.image=f:f.getState()===U.A.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(g){const I=this.frameState;if(!I)return null;const s=this.getLayer(),e=(0,d.Bb)(I.pixelToCoordinateTransform,g.slice()),c=s.getExtent();if(c&&!(0,$.Ym)(c,e))return null;const G=this.image.getExtent(),B=this.image.getImage(),w=(0,$.RG)(G),T=Math.floor(B.width*((e[0]-G[0])/w));if(T<0||T>=B.width)return null;const f=(0,$.Oq)(G),m=Math.floor(B.height*((G[3]-e[1])/f));return m<0||m>=B.height?null:this.getImageData(B,T,m)}renderFrame(g,I){const s=this.image,e=s.getExtent(),c=s.getResolution(),[G,B]=Array.isArray(c)?c:[c,c],w=s.getPixelRatio(),T=g.layerStatesArray[g.layerIndex],f=g.pixelRatio,m=g.viewState,_=m.center,R=m.resolution,b=f*G/(R*w),N=f*B/(R*w);this.prepareContainer(g,I);const W=this.context.canvas.width,a=this.context.canvas.height,o=this.getRenderContext(g);let r=!1,L=!0;if(T.extent){const S=(0,K.SD)(T.extent,m.projection);L=(0,$.HY)(S,g.extent),r=L&&!(0,$.ms)(S,g.extent),r&&this.clipUnrotated(o,g,S)}const A=s.getImage(),O=(0,d.Zz)(this.tempTransform,W/2,a/2,b,N,0,w*(e[0]-_[0])/G,w*(_[1]-e[3])/B);this.renderedResolution=B*f/w;const u=A.width*O[0],x=A.height*O[3];if(this.getLayer().getSource().getInterpolate()||(o.imageSmoothingEnabled=!1),this.preRender(o,g),L&&u>=.5&&x>=.5){const S=O[4],k=O[5],tt=T.opacity;tt!==1&&(o.save(),o.globalAlpha=tt),o.drawImage(A,0,0,+A.width,+A.height,S,k,u,x),tt!==1&&o.restore()}return this.postRender(this.context,g),r&&o.restore(),o.imageSmoothingEnabled=!0,this.container}}const y=l},71259:(Ft,at,i)=>{i.d(at,{iA:()=>w,my:()=>B});var U=i(90588),p=i(49825),$=i(25847),K=i(1486),d=i(34835);function E(T){return(JSON.stringify(T).split("").reduce((m,_)=>(m<<5)-m+_.charCodeAt(0),0)>>>0).toString()}function l(T,f,m,_){if(`${_}radius`in T&&_!=="icon-"){let R=(0,d.s2)(m,T[`${_}radius`],p.wl);if(`${_}radius2`in T){const b=(0,d.s2)(m,T[`${_}radius2`],p.wl);R=`max(${R}, ${b})`}`${_}stroke-width`in T&&(R=`(${R} + ${(0,d.s2)(m,T[`${_}stroke-width`],p.wl)} * 0.5)`),f.setSymbolSizeExpression(`vec2(${R} * 2. + 0.5)`)}if(`${_}scale`in T){const R=(0,d.s2)(m,T[`${_}scale`],p.qA);f.setSymbolSizeExpression(`${f.getSymbolSizeExpression()} * ${R}`)}`${_}displacement`in T&&f.setSymbolOffsetExpression((0,d.s2)(m,T[`${_}displacement`],p.Fq)),`${_}rotation`in T&&f.setSymbolRotationExpression((0,d.s2)(m,T[`${_}rotation`],p.wl)),`${_}rotate-with-view`in T&&f.setSymbolRotateWithView(!!T[`${_}rotate-with-view`])}function y(T,f,m,_,R){let b="vec4(0.)";if(f!==null&&(b=f),m!==null&&_!==null){const a=`smoothstep(-${_} + 0.63, -${_} - 0.58, ${T})`;b=`mix(${m}, ${b}, ${a})`}const N=`(1.0 - smoothstep(-0.63, 0.58, ${T}))`;let W=`${b} * vec4(1.0, 1.0, 1.0, ${N})`;return R!==null&&(W=`${W} * vec4(1.0, 1.0, 1.0, ${R})`),W}function P(T,f,m,_,R){const b=new Image;b.crossOrigin=T[`${_}cross-origin`]===void 0?"anonymous":T[`${_}cross-origin`],(0,U.v)(typeof T[`${_}src`]=="string",`WebGL layers do not support expressions for the ${_}src style property`),b.src=T[`${_}src`],m[`u_texture${R}_size`]=()=>b.complete?[b.width,b.height]:[0,0],f.addUniform(`u_texture${R}_size`,"vec2");const N=`u_texture${R}_size`;return m[`u_texture${R}`]=b,f.addUniform(`u_texture${R}`,"sampler2D"),N}function g(T,f,m,_,R){let b=(0,d.s2)(m,T[`${f}offset`],p.qA);if(`${f}offset-origin`in T)switch(T[`${f}offset-origin`]){case"top-right":b=`vec2(${_}.x, 0.) + ${R} * vec2(-1., 0.) + ${b} * vec2(-1., 1.)`;break;case"bottom-left":b=`vec2(0., ${_}.y) + ${R} * vec2(0., -1.) + ${b} * vec2(1., -1.)`;break;case"bottom-right":b=`${_} - ${R} - ${b}`;break;default:}return b}function I(T,f,m,_){_.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,l(T,f,_,"circle-");let R=null;"circle-opacity"in T&&(R=(0,d.s2)(_,T["circle-opacity"],p.wl));let b="coordsPx";"circle-scale"in T&&(b=`coordsPx / ${(0,d.s2)(_,T["circle-scale"],p.qA)}`);let N=null;"circle-fill-color"in T&&(N=(0,d.s2)(_,T["circle-fill-color"],p.mE));let W=null;"circle-stroke-color"in T&&(W=(0,d.s2)(_,T["circle-stroke-color"],p.mE));let a=(0,d.s2)(_,T["circle-radius"],p.wl),o=null;"circle-stroke-width"in T&&(o=(0,d.s2)(_,T["circle-stroke-width"],p.wl),a=`(${a} + ${o} * 0.5)`);const r=`circleDistanceField(${b}, ${a})`,L=y(r,N,W,o,R);f.setSymbolColorExpression(L)}function s(T,f,m,_){_.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,_.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,_.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,l(T,f,_,"shape-");let R=null;"shape-opacity"in T&&(R=(0,d.s2)(_,T["shape-opacity"],p.wl));let b="coordsPx";"shape-scale"in T&&(b=`coordsPx / ${(0,d.s2)(_,T["shape-scale"],p.qA)}`);let N=null;"shape-fill-color"in T&&(N=(0,d.s2)(_,T["shape-fill-color"],p.mE));let W=null;"shape-stroke-color"in T&&(W=(0,d.s2)(_,T["shape-stroke-color"],p.mE));let a=null;"shape-stroke-width"in T&&(a=(0,d.s2)(_,T["shape-stroke-width"],p.wl));const o=(0,d.s2)(_,T["shape-points"],p.wl);let r="0.";"shape-angle"in T&&(r=(0,d.s2)(_,T["shape-angle"],p.wl));let L,A=(0,d.s2)(_,T["shape-radius"],p.wl);if(a!==null&&(A=`${A} + ${a} * 0.5`),"shape-radius2"in T){let u=(0,d.s2)(_,T["shape-radius2"],p.wl);a!==null&&(u=`${u} + ${a} * 0.5`),L=`starDistanceField(${b}, ${o}, ${A}, ${u}, ${r})`}else L=`regularDistanceField(${b}, ${o}, ${A}, ${r})`;const O=y(L,N,W,a,R);f.setSymbolColorExpression(O)}function e(T,f,m,_){let R="vec4(1.0)";"icon-color"in T&&(R=(0,d.s2)(_,T["icon-color"],p.mE)),"icon-opacity"in T&&(R=`${R} * vec4(1.0, 1.0, 1.0, ${(0,d.s2)(_,T["icon-opacity"],p.wl)})`);const b=E(T["icon-src"]),N=P(T,f,m,"icon-",b);if(f.setSymbolColorExpression(`${R} * texture2D(u_texture${b}, v_texCoord)`).setSymbolSizeExpression(N),"icon-width"in T&&"icon-height"in T&&f.setSymbolSizeExpression(`vec2(${(0,d.s2)(_,T["icon-width"],p.wl)}, ${(0,d.s2)(_,T["icon-height"],p.wl)})`),"icon-offset"in T&&"icon-size"in T){const W=(0,d.s2)(_,T["icon-size"],p.Fq),a=f.getSymbolSizeExpression();f.setSymbolSizeExpression(W);const o=g(T,"icon-",_,"v_quadSizePx",W);f.setTextureCoordinateExpression(`(vec4((${o}).xyxy) + vec4(0., 0., ${W})) / (${a}).xyxy`)}if(l(T,f,_,"icon-"),"icon-anchor"in T){const W=(0,d.s2)(_,T["icon-anchor"],p.Fq);let a="1.0";"icon-scale"in T&&(a=(0,d.s2)(_,T["icon-scale"],p.qA));let o;T["icon-anchor-x-units"]==="pixels"&&T["icon-anchor-y-units"]==="pixels"?o=`${W} * ${a}`:T["icon-anchor-x-units"]==="pixels"?o=`${W} * vec2(vec2(${a}).x, v_quadSizePx.y)`:T["icon-anchor-y-units"]==="pixels"?o=`${W} * vec2(v_quadSizePx.x, vec2(${a}).x)`:o=`${W} * v_quadSizePx`;let r=`v_quadSizePx * vec2(0.5, -0.5) + ${o} * vec2(-1., 1.)`;if("icon-anchor-origin"in T)switch(T["icon-anchor-origin"]){case"top-right":r=`v_quadSizePx * -0.5 + ${o}`;break;case"bottom-left":r=`v_quadSizePx * 0.5 - ${o}`;break;case"bottom-right":r=`v_quadSizePx * vec2(-0.5, 0.5) + ${o} * vec2(1., -1.)`;break;default:}f.setSymbolOffsetExpression(`${f.getSymbolOffsetExpression()} + ${r}`)}}function c(T,f,m,_){if("stroke-color"in T&&f.setStrokeColorExpression((0,d.s2)(_,T["stroke-color"],p.mE)),"stroke-pattern-src"in T){const R=E(T["stroke-pattern-src"]),b=P(T,f,m,"stroke-pattern-",R);let N=b,W="vec2(0.)";"stroke-pattern-offset"in T&&"stroke-pattern-size"in T&&(N=(0,d.s2)(_,T["stroke-pattern-size"],p.Fq),W=g(T,"stroke-pattern-",_,b,N));let a="0.";"stroke-pattern-spacing"in T&&(a=(0,d.s2)(_,T["stroke-pattern-spacing"],p.wl)),_.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = currentLengthPx * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord);
}`;const o=`u_texture${R}`;let r="1.";"stroke-color"in T&&(r=f.getStrokeColorExpression()),f.setStrokeColorExpression(`${r} * sampleStrokePattern(${o}, ${b}, ${W}, ${N}, ${a}, currentLengthPx, currentRadiusRatio, v_width)`)}if("stroke-width"in T&&f.setStrokeWidthExpression((0,d.s2)(_,T["stroke-width"],p.wl)),"stroke-offset"in T&&f.setStrokeOffsetExpression((0,d.s2)(_,T["stroke-offset"],p.wl)),"stroke-line-cap"in T&&f.setStrokeCapExpression((0,d.s2)(_,T["stroke-line-cap"],p.cT)),"stroke-line-join"in T&&f.setStrokeJoinExpression((0,d.s2)(_,T["stroke-line-join"],p.cT)),"stroke-miter-limit"in T&&f.setStrokeMiterLimitExpression((0,d.s2)(_,T["stroke-miter-limit"],p.wl)),"stroke-line-dash"in T){_.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${(0,$.Tl)("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${(0,$.Tl)("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let R=T["stroke-line-dash"].map(O=>(0,d.s2)(_,O,p.wl));R.length%2===1&&(R=[...R,...R]);let b="0.";"stroke-line-dash-offset"in T&&(b=(0,d.s2)(_,T["stroke-line-dash-offset"],p.wl));const W=`dashDistanceField_${E(T["stroke-line-dash"])}`,a=R.map((O,u)=>`float dashLength${u}`).join(", "),o=R.map((O,u)=>`dashLength${u}`).join(" + ");let r="0.",L=`getSingleDashDistance(distance, radius, ${r}, dashLength0, totalDashLength, capType, lineWidth)`;for(let O=2;O<R.length;O+=2)r=`${r} + dashLength${O-2} + dashLength${O-1}`,L=`min(${L}, getSingleDashDistance(distance, radius, ${r}, dashLength${O}, totalDashLength, capType, lineWidth))`;_.functions[W]=`float ${W}(float distance, float radius, float capType, float lineWidth, ${a}) {
  float totalDashLength = ${o};
  return ${L};
}`;const A=R.map((O,u)=>`${O}`).join(", ");f.setStrokeDistanceFieldExpression(`${W}(currentLengthPx + ${b}, currentRadiusPx, capType, v_width, ${A})`)}}function G(T,f,m,_){if("fill-color"in T&&f.setFillColorExpression((0,d.s2)(_,T["fill-color"],p.mE)),"fill-pattern-src"in T){const R=E(T["fill-pattern-src"]),b=P(T,f,m,"fill-pattern-",R);let N=b,W="vec2(0.)";"fill-pattern-offset"in T&&"fill-pattern-size"in T&&(N=(0,d.s2)(_,T["fill-pattern-size"],p.Fq),W=g(T,"fill-pattern-",_,b,N)),_.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const a=`u_texture${R}`;let o="1.";"fill-color"in T&&(o=f.getFillColorExpression()),f.setFillColorExpression(`${o} * sampleFillPattern(${a}, ${b}, ${W}, ${N}, pxOrigin, pxPos)`)}}function B(T,f,m){const _=(0,$.z0)(),R=new K.N,b={};if("icon-src"in T?e(T,R,b,_):"shape-points"in T?s(T,R,b,_):"circle-radius"in T&&I(T,R,b,_),c(T,R,b,_),G(T,R,b,_),m){const a=(0,d.s2)(_,m,p.T8);R.setFragmentDiscardExpression(`!${a}`)}const N={};function W(a,o,r,L){if(!_[a])return;const A=(0,d.T0)(r),O=(0,d.Qi)(r);R.addAttribute(`a_${o}`,A),N[o]={size:O,callback:L}}return W("geometryType",$.M7,p.cT,a=>(0,$.Lm)((0,p.Ye)(a.getGeometry()))),W("featureId",$.L$,p.cT|p.wl,a=>{const o=a.getId()??null;return typeof o=="string"?(0,$.Lm)(o):o}),(0,d.mf)(R,_),{builder:R,attributes:{...N,...(0,d.mh)(_)},uniforms:{...b,...(0,d.kc)(_,f)}}}function w(T){const f=Array.isArray(T)?T:[T];if("style"in f[0]){const m=[],_=f,R=[];for(const b of _){const N=Array.isArray(b.style)?b.style:[b.style];let W=b.filter;b.else&&R.length&&(W=["all",...R.map(o=>["!",o])],b.filter&&W.push(b.filter),W.length<3&&(W=W[1])),b.filter&&R.push(b.filter);const a=N.map(o=>({style:o,...W&&{filter:W}}));m.push(...a)}return m}return"builder"in f[0]?f:f.map(m=>({style:m}))}},73445:(Ft,at,i)=>{i.d(at,{A:()=>p});var U=i(6837);const p={SINGLECLICK:"singleclick",CLICK:U.A.CLICK,DBLCLICK:U.A.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},75332:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"}},81426:(Ft,at,i)=>{i.d(at,{A:()=>d});var U=i(6782),p=i(13628);const $="#333";class K{constructor(l){l=l||{},this.font_=l.font,this.rotation_=l.rotation,this.rotateWithView_=l.rotateWithView,this.keepUpright_=l.keepUpright,this.scale_=l.scale,this.scaleArray_=(0,U.xq)(l.scale!==void 0?l.scale:1),this.text_=l.text,this.textAlign_=l.textAlign,this.justify_=l.justify,this.repeat_=l.repeat,this.textBaseline_=l.textBaseline,this.fill_=l.fill!==void 0?l.fill:new p.A({color:$}),this.maxAngle_=l.maxAngle!==void 0?l.maxAngle:Math.PI/4,this.placement_=l.placement!==void 0?l.placement:"point",this.overflow_=!!l.overflow,this.stroke_=l.stroke!==void 0?l.stroke:null,this.offsetX_=l.offsetX!==void 0?l.offsetX:0,this.offsetY_=l.offsetY!==void 0?l.offsetY:0,this.backgroundFill_=l.backgroundFill?l.backgroundFill:null,this.backgroundStroke_=l.backgroundStroke?l.backgroundStroke:null,this.padding_=l.padding===void 0?null:l.padding,this.declutterMode_=l.declutterMode}clone(){const l=this.getScale();return new K({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(l)?l.slice():l,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(l){this.overflow_=l}setFont(l){this.font_=l}setMaxAngle(l){this.maxAngle_=l}setOffsetX(l){this.offsetX_=l}setOffsetY(l){this.offsetY_=l}setPlacement(l){this.placement_=l}setRepeat(l){this.repeat_=l}setRotateWithView(l){this.rotateWithView_=l}setKeepUpright(l){this.keepUpright_=l}setFill(l){this.fill_=l}setRotation(l){this.rotation_=l}setScale(l){this.scale_=l,this.scaleArray_=(0,U.xq)(l!==void 0?l:1)}setStroke(l){this.stroke_=l}setText(l){this.text_=l}setTextAlign(l){this.textAlign_=l}setJustify(l){this.justify_=l}setTextBaseline(l){this.textBaseline_=l}setBackgroundFill(l){this.backgroundFill_=l}setBackgroundStroke(l){this.backgroundStroke_=l}setPadding(l){this.padding_=l}}const d=K},82187:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={ACTIVE:"active"}},82241:(Ft,at,i)=>{i.d(at,{ue:()=>l});var U=i(6141),p=i(89352),$=i(68711);class K{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let P=0;for(const g in this.cache_){const I=this.cache_[g];(P++&3)===0&&!I.hasListener()&&(delete this.cache_[g],delete this.patternCache_[g],--this.cacheSize_)}}}get(P,g,I){const s=d(P,g,I);return s in this.cache_?this.cache_[s]:null}getPattern(P,g,I){const s=d(P,g,I);return s in this.patternCache_?this.patternCache_[s]:null}set(P,g,I,s,e){const c=d(P,g,I),G=c in this.cache_;this.cache_[c]=s,e&&(s.getImageState()===U.A.IDLE&&s.load(),s.getImageState()===U.A.LOADING?s.ready().then(()=>{this.patternCache_[c]=(0,$.lr)().createPattern(s.getImage(1),"repeat")}):this.patternCache_[c]=(0,$.lr)().createPattern(s.getImage(1),"repeat")),G||++this.cacheSize_}setSize(P){this.maxCacheSize_=P,this.expire()}}function d(y,P,g){const I=g?(0,p._j)(g):"null";return P+":"+y+":"+I}var E=null;const l=new K},82585:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"}},82986:(Ft,at,i)=>{i.d(at,{A:()=>K});var U=i(65896),p=i(94720);class $ extends p.A{constructor(E){super(E)}createRenderer(){return new U.A(this)}}const K=$},83954:(Ft,at,i)=>{i.d(at,{Z1:()=>p,vt:()=>U});function U(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function p(l,y){return l[0]=y[0],l[1]=y[1],l[4]=y[2],l[5]=y[3],l[12]=y[4],l[13]=y[5],l}function $(l,y,P,g,I,s,e){e=e??U();const c=1/(l-y),G=1/(P-g),B=1/(I-s);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*G,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*B,e[11]=0,e[12]=(l+y)*c,e[13]=(g+P)*G,e[14]=(s+I)*B,e[15]=1,e}function K(l,y,P,g,I){return I=I??U(),I[0]=l[0]*y,I[1]=l[1]*y,I[2]=l[2]*y,I[3]=l[3]*y,I[4]=l[4]*P,I[5]=l[5]*P,I[6]=l[6]*P,I[7]=l[7]*P,I[8]=l[8]*g,I[9]=l[9]*g,I[10]=l[10]*g,I[11]=l[11]*g,I[12]=l[12],I[13]=l[13],I[14]=l[14],I[15]=l[15],I}function d(l,y,P,g,I){I=I??U();let s,e,c,G,B,w,T,f,m,_,R,b;return l===I?(I[12]=l[0]*y+l[4]*P+l[8]*g+l[12],I[13]=l[1]*y+l[5]*P+l[9]*g+l[13],I[14]=l[2]*y+l[6]*P+l[10]*g+l[14],I[15]=l[3]*y+l[7]*P+l[11]*g+l[15]):(s=l[0],e=l[1],c=l[2],G=l[3],B=l[4],w=l[5],T=l[6],f=l[7],m=l[8],_=l[9],R=l[10],b=l[11],I[0]=s,I[1]=e,I[2]=c,I[3]=G,I[4]=B,I[5]=w,I[6]=T,I[7]=f,I[8]=m,I[9]=_,I[10]=R,I[11]=b,I[12]=s*y+B*P+m*g+l[12],I[13]=e*y+w*P+_*g+l[13],I[14]=c*y+T*P+R*g+l[14],I[15]=G*y+f*P+b*g+l[15]),I}function E(l,y,P,g){return g=g??U(),g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=l,g[13]=y,g[14]=P,g[15]=1,g}},83984:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"}},86936:(Ft,at,i)=>{i.d(at,{A:()=>g});var U=i(6141),p=i(89352),$=i(99676),K=i(68711),d=i(38774),E=i(97907),l=i(82241),y=i(10940);class P extends y.A{constructor(s){super({opacity:1,rotateWithView:s.rotateWithView!==void 0?s.rotateWithView:!1,rotation:s.rotation!==void 0?s.rotation:0,scale:s.scale!==void 0?s.scale:1,displacement:s.displacement!==void 0?s.displacement:[0,0],declutterMode:s.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=s.fill!==void 0?s.fill:null,this.origin_=[0,0],this.points_=s.points,this.radius=s.radius,this.radius2_=s.radius2,this.angle_=s.angle!==void 0?s.angle:0,this.stroke_=s.stroke!==void 0?s.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?U.A.LOADING:U.A.LOADED,this.imageState_===U.A.LOADING&&this.ready().then(()=>this.imageState_=U.A.LOADED),this.render()}clone(){const s=this.getScale(),e=new P({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(s)?s.slice():s,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const s=this.size_,e=this.getDisplacement(),c=this.getScaleArray();return[s[0]/2-e[0]/c[0],s[1]/2+e[1]/c[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(s){this.fill_=s,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(s){const e=this.fill_?.getKey(),c=`${s},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let G=l.ue.get(c,null,null)?.getImage(1);if(!G){const B=this.renderOptions_,w=Math.ceil(B.size*s),T=(0,K.Y)(w,w);this.draw_(B,T,s),G=T.canvas,l.ue.set(c,null,null,new E.A(G,void 0,null,U.A.LOADED,null))}return G}getPixelRatio(s){return s}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(s){this.stroke_=s,this.render()}listenImageChange(s){}load(){}unlistenImageChange(s){}calculateLineJoinSize_(s,e,c){if(e===0||this.points_===1/0||s!=="bevel"&&s!=="miter")return e;let G=this.radius,B=this.radius2_===void 0?G:this.radius2_;if(G<B){const x=G;G=B,B=x}const w=this.radius2_===void 0?this.points_:this.points_*2,T=2*Math.PI/w,f=B*Math.sin(T),m=Math.sqrt(B*B-f*f),_=G-m,R=Math.sqrt(f*f+_*_),b=R/f;if(s==="miter"&&b<=c)return b*e;const N=e/2/b,W=e/2*(_/R),o=Math.sqrt((G+N)*(G+N)+W*W)-G;if(this.radius2_===void 0||s==="bevel")return o*2;const r=G*Math.sin(T),L=Math.sqrt(G*G-r*r),A=B-L,u=Math.sqrt(r*r+A*A)/r;if(u<=c){const x=u*e/2-B-G;return 2*Math.max(o,x)}return o*2}createRenderOptions(){let s=d._m,e=d._K,c=0,G=null,B=0,w,T=0;this.stroke_&&(w=(0,$.F)(this.stroke_.getColor()??d.NT),T=this.stroke_.getWidth()??d.aq,G=this.stroke_.getLineDash(),B=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??d._K,s=this.stroke_.getLineCap()??d._m,c=this.stroke_.getMiterLimit()??d.eL);const f=this.calculateLineJoinSize_(e,T,c),m=Math.max(this.radius,this.radius2_||0),_=Math.ceil(2*m+f);return{strokeStyle:w,strokeWidth:T,size:_,lineCap:s,lineDash:G,lineDashOffset:B,lineJoin:e,miterLimit:c}}render(){this.renderOptions_=this.createRenderOptions();const s=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[s,s]}draw_(s,e,c){if(e.scale(c,c),e.translate(s.size/2,s.size/2),this.createPath_(e),this.fill_){let G=this.fill_.getColor();G===null&&(G=d.qY),e.fillStyle=(0,$.F)(G),e.fill()}s.strokeStyle&&(e.strokeStyle=s.strokeStyle,e.lineWidth=s.strokeWidth,s.lineDash&&(e.setLineDash(s.lineDash),e.lineDashOffset=s.lineDashOffset),e.lineCap=s.lineCap,e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.stroke())}createHitDetectionCanvas_(s){let e;if(this.fill_){let c=this.fill_.getColor(),G=0;typeof c=="string"&&(c=(0,p._j)(c)),c===null?G=1:Array.isArray(c)&&(G=c.length===4?c[3]:1),G===0&&(e=(0,K.Y)(s.size,s.size),this.drawHitDetectionCanvas_(s,e))}return e?e.canvas:this.getImage(1)}createPath_(s){let e=this.points_;const c=this.radius;if(e===1/0)s.arc(0,0,c,0,2*Math.PI);else{const G=this.radius2_===void 0?c:this.radius2_;this.radius2_!==void 0&&(e*=2);const B=this.angle_-Math.PI/2,w=2*Math.PI/e;for(let T=0;T<e;T++){const f=B+T*w,m=T%2===0?c:G;s.lineTo(m*Math.cos(f),m*Math.sin(f))}s.closePath()}}drawHitDetectionCanvas_(s,e){e.translate(s.size/2,s.size/2),this.createPath_(e),e.fillStyle=d.qY,e.fill(),s.strokeStyle&&(e.strokeStyle=s.strokeStyle,e.lineWidth=s.strokeWidth,s.lineDash&&(e.setLineDash(s.lineDash),e.lineDashOffset=s.lineDashOffset),e.lineJoin=s.lineJoin,e.miterLimit=s.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}const g=P},87579:(Ft,at,i)=>{i.d(at,{A:()=>$});var U=i(1685);class p extends U.Ay{constructor(d,E,l,y){super(d),this.inversePixelTransform=E,this.frameState=l,this.context=y}}const $=p},88280:(Ft,at,i)=>{i.d(at,{A:()=>U});const U={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"}},88751:(Ft,at,i)=>{i.d(at,{A:()=>y});var U=i(6837),p=i(58704),$=i(61597),K=i(6292);const d=40,E=300;class l extends K.Ay{constructor(g){g=g||{},super(g),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=g.maxDelta!==void 0?g.maxDelta:1,this.duration_=g.duration!==void 0?g.duration:250,this.timeout_=g.timeout!==void 0?g.timeout:80,this.useAnchor_=g.useAnchor!==void 0?g.useAnchor:!0,this.constrainResolution_=g.constrainResolution!==void 0?g.constrainResolution:!1;const I=g.condition?g.condition:p.Gk;this.condition_=g.onFocusOnly?(0,p.Q7)(p.eL,I):I,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const g=this.getMap();if(!g)return;g.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?g.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(g){if(!this.condition_(g)||g.type!==U.A.WHEEL)return!0;const s=g.map,e=g.originalEvent;e.preventDefault(),this.useAnchor_&&(this.lastAnchor_=g.pixel);let c=e.deltaY;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:c*=d;break;case WheelEvent.DOM_DELTA_PAGE:c*=E;break;default:}if(c===0)return!1;this.lastDelta_=c;const G=Date.now();this.startTime_===void 0&&(this.startTime_=G),(!this.mode_||G-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(c)<4?"trackpad":"wheel");const B=s.getView();if(this.mode_==="trackpad"&&!(B.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(B.getAnimating()&&B.cancelAnimations(),B.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),B.adjustZoom(-c/this.deltaPerZoom_,this.lastAnchor_?s.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=G,!1;this.totalDelta_+=c;const w=Math.max(this.timeout_-(G-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,s),w),!1}handleWheelZoom_(g){const I=g.getView();I.getAnimating()&&I.cancelAnimations();let s=-(0,$.qE)(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(I.getConstrainResolution()||this.constrainResolution_)&&(s=s?s>0?1:-1:0),(0,K.D2)(I,s,this.lastAnchor_?g.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(g){this.useAnchor_=g,g||(this.lastAnchor_=null)}}const y=l},89352:(Ft,at,i)=>{i.d(at,{_j:()=>W,cD:()=>b,dI:()=>a,eE:()=>R,fu:()=>w,oJ:()=>e,qV:()=>$,sH:()=>N});var U=i(68711),p=i(61597);const $=[NaN,NaN,NaN,0];let K;function d(){return K||(K=(0,U.Y)(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),K}const E=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,l=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,y=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,P=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function g(r,L){return r.endsWith("%")?Number(r.substring(0,r.length-1))/L:Number(r)}function I(r){throw new Error('failed to parse "'+r+'" as color')}function s(r){if(r.toLowerCase().startsWith("rgb")){const x=r.match(l)||r.match(E)||r.match(y);if(x){const S=x[4],k=100/255;return[(0,p.qE)(g(x[1],k)+.5|0,0,255),(0,p.qE)(g(x[2],k)+.5|0,0,255),(0,p.qE)(g(x[3],k)+.5|0,0,255),S!==void 0?(0,p.qE)(g(S,100),0,1):1]}I(r)}if(r.startsWith("#")){if(P.test(r)){const x=r.substring(1),S=x.length<=4?1:2,k=[0,0,0,255];for(let tt=0,ht=x.length;tt<ht;tt+=S){let dt=parseInt(x.substring(tt,tt+S),16);S===1&&(dt+=dt<<4),k[tt/S]=dt}return k[3]=k[3]/255,k}I(r)}const L=d();L.fillStyle="#abcdef";let A=L.fillStyle;L.fillStyle=r,L.fillStyle===A&&(L.fillStyle="#fedcba",A=L.fillStyle,L.fillStyle=r,L.fillStyle===A&&I(r));const O=L.fillStyle;if(O.startsWith("#")||O.startsWith("rgba"))return s(O);L.clearRect(0,0,1,1),L.fillRect(0,0,1,1);const u=Array.from(L.getImageData(0,0,1,1).data);return u[3]=(0,p.Mg)(u[3]/255,3),u}function e(r){return typeof r=="string"?r:a(r)}const c=1024,G={};let B=0;function w(r){if(r.length===4)return r;const L=r.slice();return L[3]=1,L}function T(r){return r>.0031308?Math.pow(r,1/2.4)*269.025-14.025:r*3294.6}function f(r){return r>.2068965?Math.pow(r,3):(r-4/29)*(108/841)}function m(r){return r>10.314724?Math.pow((r+14.025)/269.025,2.4):r/3294.6}function _(r){return r>.0088564?Math.pow(r,1/3):r/(108/841)+4/29}function R(r){const L=m(r[0]),A=m(r[1]),O=m(r[2]),u=_(L*.222488403+A*.716873169+O*.06060791),x=500*(_(L*.452247074+A*.399439023+O*.148375274)-u),S=200*(u-_(L*.016863605+A*.117638439+O*.865350722)),k=Math.atan2(S,x)*(180/Math.PI);return[116*u-16,Math.sqrt(x*x+S*S),k<0?k+360:k,r[3]]}function b(r){const L=(r[0]+16)/116,A=r[1],O=r[2]*Math.PI/180,u=f(L),x=f(L+A/500*Math.cos(O)),S=f(L-A/200*Math.sin(O)),k=T(x*3.021973625-u*1.617392459-S*.404875592),tt=T(x*-.943766287+u*1.916279586+S*.027607165),ht=T(x*.069407491-u*.22898585+S*1.159737864);return[(0,p.qE)(k+.5|0,0,255),(0,p.qE)(tt+.5|0,0,255),(0,p.qE)(ht+.5|0,0,255),r[3]]}function N(r){if(r==="none")return $;if(G.hasOwnProperty(r))return G[r];if(B>=c){let A=0;for(const O in G)(A++&3)===0&&(delete G[O],--B)}const L=s(r);L.length!==4&&I(r);for(const A of L)isNaN(A)&&I(r);return G[r]=L,++B,L}function W(r){return Array.isArray(r)?r:N(r)}function a(r){let L=r[0];L!=(L|0)&&(L=L+.5|0);let A=r[1];A!=(A|0)&&(A=A+.5|0);let O=r[2];O!=(O|0)&&(O=O+.5|0);const u=r[3]===void 0?1:Math.round(r[3]*1e3)/1e3;return"rgba("+L+","+A+","+O+","+u+")"}function o(r){try{return N(r),!0}catch{return!1}}},89940:(Ft,at,i)=>{i.d(at,{A:()=>K});var U=i(66514);const p=new Uint8Array(4);class ${constructor(E,l){this.helper_=E;const y=E.getGL();this.texture_=y.createTexture(),this.framebuffer_=y.createFramebuffer(),this.depthbuffer_=y.createRenderbuffer(),this.size_=l||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(E){(0,U.aI)(E,this.size_)||(this.size_[0]=E[0],this.size_[1]=E[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const E=this.size_,l=this.helper_.getGL();l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer_),l.readPixels(0,0,E[0],E[1],l.RGBA,l.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(E,l){if(E<0||l<0||E>this.size_[0]||l>=this.size_[1])return p[0]=0,p[1]=0,p[2]=0,p[3]=0,p;this.readAll();const y=Math.floor(E)+(this.size_[1]-Math.floor(l)-1)*this.size_[0];return p[0]=this.data_[y*4],p[1]=this.data_[y*4+1],p[2]=this.data_[y*4+2],p[3]=this.data_[y*4+3],p}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const E=this.size_,l=this.helper_.getGL();this.texture_=this.helper_.createTexture(E,null,this.texture_),l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer_),l.viewport(0,0,E[0],E[1]),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,this.texture_,0),l.bindRenderbuffer(l.RENDERBUFFER,this.depthbuffer_),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,E[0],E[1]),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(E[0]*E[1]*4)}}const K=$},90130:(Ft,at,i)=>{i.d(at,{Be:()=>E,Ek:()=>d,H7:()=>p,IP:()=>$,JL:()=>y,SD:()=>s,Ss:()=>K,UD:()=>P,l4:()=>l,zH:()=>g});var U=i(7771);const p=34962,$=34963,K=35040,d=35044,E=35048,l=5121,y=5123,P=5125,g=5126,I=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function s(G,B){B=Object.assign({preserveDrawingBuffer:!0,antialias:!U.oF},B);const w=I.length;for(let T=0;T<w;++T)try{const f=G.getContext(I[T],B);if(f)return f}catch{}return null}let e=null;function c(){if(!e){const G=document.createElement("canvas"),B=s(G);B&&(e=B.getSupportedExtensions())}return e}},91110:(Ft,at,i)=>{i.d(at,{A:()=>$,N:()=>p});class U{constructor(d,E,l,y){this.minX=d,this.maxX=E,this.minY=l,this.maxY=y}contains(d){return this.containsXY(d[1],d[2])}containsTileRange(d){return this.minX<=d.minX&&d.maxX<=this.maxX&&this.minY<=d.minY&&d.maxY<=this.maxY}containsXY(d,E){return this.minX<=d&&d<=this.maxX&&this.minY<=E&&E<=this.maxY}equals(d){return this.minX==d.minX&&this.minY==d.minY&&this.maxX==d.maxX&&this.maxY==d.maxY}extend(d){d.minX<this.minX&&(this.minX=d.minX),d.maxX>this.maxX&&(this.maxX=d.maxX),d.minY<this.minY&&(this.minY=d.minY),d.maxY>this.maxY&&(this.maxY=d.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(d){return this.minX<=d.maxX&&this.maxX>=d.minX&&this.minY<=d.maxY&&this.maxY>=d.minY}}function p(K,d,E,l,y){return y!==void 0?(y.minX=K,y.maxX=d,y.minY=E,y.maxY=l,y):new U(K,d,E,l)}const $=U},91765:(Ft,at,i)=>{i.d(at,{Ay:()=>A});var U=i(34120),p=i(62703);const $={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var K=i(66514),d=i(90588),E=i(61597);function l(O,u,x){return function(S,k,tt,ht,dt){if(!S)return;if(!k&&!u)return S;const J=u?0:tt[0]*k,ft=u?0:tt[1]*k,it=dt?dt[0]:0,st=dt?dt[1]:0;let gt=O[0]+J/2+it,Ot=O[2]-J/2+it,nt=O[1]+ft/2+st,et=O[3]-ft/2+st;gt>Ot&&(gt=(Ot+gt)/2,Ot=gt),nt>et&&(nt=(et+nt)/2,et=nt);let Et=(0,E.qE)(S[0],gt,Ot),ut=(0,E.qE)(S[1],nt,et);if(ht&&x&&k){const Rt=30*k;Et+=-Rt*Math.log(1+Math.max(0,gt-S[0])/Rt)+Rt*Math.log(1+Math.max(0,S[0]-Ot)/Rt),ut+=-Rt*Math.log(1+Math.max(0,nt-S[1])/Rt)+Rt*Math.log(1+Math.max(0,S[1]-et)/Rt)}return[Et,ut]}}function y(O){return O}var P=i(6933),g=i(93474),I=i(70915),s=i(74238),e=i(71064),c=i(43067);function G(O,u,x,S){const k=(0,I.RG)(u)/x[0],tt=(0,I.Oq)(u)/x[1];return S?Math.min(O,Math.max(k,tt)):Math.min(O,Math.min(k,tt))}function B(O,u,x){let S=Math.min(O,u);const k=50;return S*=Math.log(1+k*Math.max(0,O/u-1))/k+1,x&&(S=Math.max(S,x),S/=Math.log(1+k*Math.max(0,x/O-1))/k+1),(0,E.qE)(S,x/2,u*2)}function w(O,u,x,S){return u=u!==void 0?u:!0,function(k,tt,ht,dt){if(k!==void 0){const J=O[0],ft=O[O.length-1],it=x?G(J,x,ht,S):J;if(dt)return u?B(k,it,ft):(0,E.qE)(k,ft,it);const st=Math.min(it,k),gt=Math.floor((0,K.FT)(O,st,tt));return O[gt]>it&&gt<O.length-1?O[gt+1]:O[gt]}}}function T(O,u,x,S,k,tt){return S=S!==void 0?S:!0,x=x!==void 0?x:0,function(ht,dt,J,ft){if(ht!==void 0){const it=k?G(u,k,J,tt):u;if(ft)return S?B(ht,it,x):(0,E.qE)(ht,x,it);const st=1e-9,gt=Math.ceil(Math.log(u/it)/Math.log(O)-st),Ot=-dt*(.5-st)+.5,nt=Math.min(it,ht),et=Math.floor(Math.log(u/nt)/Math.log(O)+Ot),Et=Math.max(gt,et),ut=u/Math.pow(O,Et);return(0,E.qE)(ut,x,it)}}}function f(O,u,x,S,k){return x=x!==void 0?x:!0,function(tt,ht,dt,J){if(tt!==void 0){const ft=S?G(O,S,dt,k):O;return!x||!J?(0,E.qE)(tt,u,ft):B(tt,ft,u)}}}var m=i(24498),_=i(57115);const R=0;class b extends U.A{constructor(u){super(),this.on,this.once,this.un,u=Object.assign({},u),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=(0,c.Av)(u.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,u.projection&&(0,c.RJ)(),u.center&&(u.center=(0,c.Ad)(u.center,this.projection_)),u.extent&&(u.extent=(0,c.SD)(u.extent,this.projection_)),this.applyOptions_(u)}applyOptions_(u){const x=Object.assign({},u);for(const dt in $)delete x[dt];this.setProperties(x,!0);const S=a(u);this.maxResolution_=S.maxResolution,this.minResolution_=S.minResolution,this.zoomFactor_=S.zoomFactor,this.resolutions_=u.resolutions,this.padding_=u.padding,this.minZoom_=S.minZoom;const k=W(u),tt=S.constraint,ht=o(u);this.constraints_={center:k,resolution:tt,rotation:ht},this.setRotation(u.rotation!==void 0?u.rotation:0),this.setCenterInternal(u.center!==void 0?u.center:null),u.resolution!==void 0?this.setResolution(u.resolution):u.zoom!==void 0&&this.setZoom(u.zoom)}get padding(){return this.padding_}set padding(u){let x=this.padding_;this.padding_=u;const S=this.getCenterInternal();if(S){const k=u||[0,0,0,0];x=x||[0,0,0,0];const tt=this.getResolution(),ht=tt/2*(k[3]-x[3]+x[1]-k[1]),dt=tt/2*(k[0]-x[0]+x[2]-k[2]);this.setCenterInternal([S[0]+ht,S[1]-dt])}}getUpdatedOptions_(u){const x=this.getProperties();return x.resolution!==void 0?x.resolution=this.getResolution():x.zoom=this.getZoom(),x.center=this.getCenterInternal(),x.rotation=this.getRotation(),Object.assign({},x,u)}animate(u){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const x=new Array(arguments.length);for(let S=0;S<x.length;++S){let k=arguments[S];k.center&&(k=Object.assign({},k),k.center=(0,c.Ad)(k.center,this.getProjection())),k.anchor&&(k=Object.assign({},k),k.anchor=(0,c.Ad)(k.anchor,this.getProjection())),x[S]=k}this.animateInternal.apply(this,x)}animateInternal(u){let x=arguments.length,S;x>1&&typeof arguments[x-1]=="function"&&(S=arguments[x-1],--x);let k=0;for(;k<x&&!this.isDef();++k){const it=arguments[k];it.center&&this.setCenterInternal(it.center),it.zoom!==void 0?this.setZoom(it.zoom):it.resolution&&this.setResolution(it.resolution),it.rotation!==void 0&&this.setRotation(it.rotation)}if(k===x){S&&N(S,!0);return}let tt=Date.now(),ht=this.targetCenter_.slice(),dt=this.targetResolution_,J=this.targetRotation_;const ft=[];for(;k<x;++k){const it=arguments[k],st={start:tt,complete:!1,anchor:it.anchor,duration:it.duration!==void 0?it.duration:1e3,easing:it.easing||g.T9,callback:S};if(it.center&&(st.sourceCenter=ht,st.targetCenter=it.center.slice(),ht=st.targetCenter),it.zoom!==void 0?(st.sourceResolution=dt,st.targetResolution=this.getResolutionForZoom(it.zoom),dt=st.targetResolution):it.resolution&&(st.sourceResolution=dt,st.targetResolution=it.resolution,dt=st.targetResolution),it.rotation!==void 0){st.sourceRotation=J;const gt=(0,E.xP)(it.rotation-J+Math.PI,2*Math.PI)-Math.PI;st.targetRotation=J+gt,J=st.targetRotation}r(st)?st.complete=!0:tt+=st.duration,ft.push(st)}this.animations_.push(ft),this.setHint(p.A.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[p.A.ANIMATING]>0}getInteracting(){return this.hints_[p.A.INTERACTING]>0}cancelAnimations(){this.setHint(p.A.ANIMATING,-this.hints_[p.A.ANIMATING]);let u;for(let x=0,S=this.animations_.length;x<S;++x){const k=this.animations_[x];if(k[0].callback&&N(k[0].callback,!1),!u)for(let tt=0,ht=k.length;tt<ht;++tt){const dt=k[tt];if(!dt.complete){u=dt.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=u,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const u=Date.now();let x=!1;for(let S=this.animations_.length-1;S>=0;--S){const k=this.animations_[S];let tt=!0;for(let ht=0,dt=k.length;ht<dt;++ht){const J=k[ht];if(J.complete)continue;const ft=u-J.start;let it=J.duration>0?ft/J.duration:1;it>=1?(J.complete=!0,it=1):tt=!1;const st=J.easing(it);if(J.sourceCenter){const gt=J.sourceCenter[0],Ot=J.sourceCenter[1],nt=J.targetCenter[0],et=J.targetCenter[1];this.nextCenter_=J.targetCenter;const Et=gt+st*(nt-gt),ut=Ot+st*(et-Ot);this.targetCenter_=[Et,ut]}if(J.sourceResolution&&J.targetResolution){const gt=st===1?J.targetResolution:J.sourceResolution+st*(J.targetResolution-J.sourceResolution);if(J.anchor){const Ot=this.getViewportSize_(this.getRotation()),nt=this.constraints_.resolution(gt,0,Ot,!0);this.targetCenter_=this.calculateCenterZoom(nt,J.anchor)}this.nextResolution_=J.targetResolution,this.targetResolution_=gt,this.applyTargetState_(!0)}if(J.sourceRotation!==void 0&&J.targetRotation!==void 0){const gt=st===1?(0,E.xP)(J.targetRotation+Math.PI,2*Math.PI)-Math.PI:J.sourceRotation+st*(J.targetRotation-J.sourceRotation);if(J.anchor){const Ot=this.constraints_.rotation(gt,!0);this.targetCenter_=this.calculateCenterRotate(Ot,J.anchor)}this.nextRotation_=J.targetRotation,this.targetRotation_=gt}if(this.applyTargetState_(!0),x=!0,!J.complete)break}if(tt){this.animations_[S]=null,this.setHint(p.A.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const ht=k[0].callback;ht&&N(ht,!0)}}this.animations_=this.animations_.filter(Boolean),x&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(u,x){let S;const k=this.getCenterInternal();return k!==void 0&&(S=[k[0]-x[0],k[1]-x[1]],(0,P.e$)(S,u-this.getRotation()),(0,P.WQ)(S,x)),S}calculateCenterZoom(u,x){let S;const k=this.getCenterInternal(),tt=this.getResolution();if(k!==void 0&&tt!==void 0){const ht=x[0]-u*(x[0]-k[0])/tt,dt=x[1]-u*(x[1]-k[1])/tt;S=[ht,dt]}return S}getViewportSize_(u){const x=this.viewportSize_;if(u){const S=x[0],k=x[1];return[Math.abs(S*Math.cos(u))+Math.abs(k*Math.sin(u)),Math.abs(S*Math.sin(u))+Math.abs(k*Math.cos(u))]}return x}setViewportSize(u){this.viewportSize_=Array.isArray(u)?u.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const u=this.getCenterInternal();return u&&(0,c.te)(u,this.getProjection())}getCenterInternal(){return this.get($.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(u){return u!==void 0?(u[0]=this.hints_[0],u[1]=this.hints_[1],u):this.hints_.slice()}calculateExtent(u){const x=this.calculateExtentInternal(u);return(0,c.JR)(x,this.getProjection())}calculateExtentInternal(u){u=u||this.getViewportSizeMinusPadding_();const x=this.getCenterInternal();(0,d.v)(x,"The view center is not defined");const S=this.getResolution();(0,d.v)(S!==void 0,"The view resolution is not defined");const k=this.getRotation();return(0,d.v)(k!==void 0,"The view rotation is not defined"),(0,I.Bg)(x,S,k,u)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(u){this.applyOptions_(this.getUpdatedOptions_({maxZoom:u}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(u){this.applyOptions_(this.getUpdatedOptions_({minZoom:u}))}setConstrainResolution(u){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:u}))}getProjection(){return this.projection_}getResolution(){return this.get($.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(u,x){return this.getResolutionForExtentInternal((0,c.SD)(u,this.getProjection()),x)}getResolutionForExtentInternal(u,x){x=x||this.getViewportSizeMinusPadding_();const S=(0,I.RG)(u)/x[0],k=(0,I.Oq)(u)/x[1];return Math.max(S,k)}getResolutionForValueFunction(u){u=u||2;const x=this.getConstrainedResolution(this.maxResolution_),S=this.minResolution_,k=Math.log(x/S)/Math.log(u);return function(tt){return x/Math.pow(u,tt*k)}}getRotation(){return this.get($.ROTATION)}getValueForResolutionFunction(u){const x=Math.log(u||2),S=this.getConstrainedResolution(this.maxResolution_),k=this.minResolution_,tt=Math.log(S/k)/x;return function(ht){return Math.log(S/ht)/x/tt}}getViewportSizeMinusPadding_(u){let x=this.getViewportSize_(u);const S=this.padding_;return S&&(x=[x[0]-S[1]-S[3],x[1]-S[0]-S[2]]),x}getState(){const u=this.getProjection(),x=this.getResolution(),S=this.getRotation();let k=this.getCenterInternal();const tt=this.padding_;if(tt){const ht=this.getViewportSizeMinusPadding_();k=L(k,this.getViewportSize_(),[ht[0]/2+tt[3],ht[1]/2+tt[0]],x,S)}return{center:k.slice(0),projection:u!==void 0?u:null,resolution:x,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:S,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let u;const x=this.getResolution();return x!==void 0&&(u=this.getZoomForResolution(x)),u}getZoomForResolution(u){let x=this.minZoom_||0,S,k;if(this.resolutions_){const tt=(0,K.FT)(this.resolutions_,u,1);x=tt,S=this.resolutions_[tt],tt==this.resolutions_.length-1?k=2:k=S/this.resolutions_[tt+1]}else S=this.maxResolution_,k=this.zoomFactor_;return x+Math.log(S/u)/Math.log(k)}getResolutionForZoom(u){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const x=(0,E.qE)(Math.floor(u),0,this.resolutions_.length-2),S=this.resolutions_[x]/this.resolutions_[x+1];return this.resolutions_[x]/Math.pow(S,(0,E.qE)(u-x,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,u-this.minZoom_)}fit(u,x){let S;if((0,d.v)(Array.isArray(u)||typeof u.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(u)){(0,d.v)(!(0,I.Im)(u),"Cannot fit empty extent provided as `geometry`");const k=(0,c.SD)(u,this.getProjection());S=(0,e.VY)(k)}else if(u.getType()==="Circle"){const k=(0,c.SD)(u.getExtent(),this.getProjection());S=(0,e.VY)(k),S.rotate(this.getRotation(),(0,I.q1)(k))}else{const k=(0,c.Tf)();k?S=u.clone().transform(k,this.getProjection()):S=u}this.fitInternal(S,x)}rotatedExtentForGeometry(u){const x=this.getRotation(),S=Math.cos(x),k=Math.sin(-x),tt=u.getFlatCoordinates(),ht=u.getStride();let dt=1/0,J=1/0,ft=-1/0,it=-1/0;for(let st=0,gt=tt.length;st<gt;st+=ht){const Ot=tt[st]*S-tt[st+1]*k,nt=tt[st]*k+tt[st+1]*S;dt=Math.min(dt,Ot),J=Math.min(J,nt),ft=Math.max(ft,Ot),it=Math.max(it,nt)}return[dt,J,ft,it]}fitInternal(u,x){x=x||{};let S=x.size;S||(S=this.getViewportSizeMinusPadding_());const k=x.padding!==void 0?x.padding:[0,0,0,0],tt=x.nearest!==void 0?x.nearest:!1;let ht;x.minResolution!==void 0?ht=x.minResolution:x.maxZoom!==void 0?ht=this.getResolutionForZoom(x.maxZoom):ht=0;const dt=this.rotatedExtentForGeometry(u);let J=this.getResolutionForExtentInternal(dt,[S[0]-k[1]-k[3],S[1]-k[0]-k[2]]);J=isNaN(J)?ht:Math.max(J,ht),J=this.getConstrainedResolution(J,tt?0:1);const ft=this.getRotation(),it=Math.sin(ft),st=Math.cos(ft),gt=(0,I.q1)(dt);gt[0]+=(k[1]-k[3])/2*J,gt[1]+=(k[0]-k[2])/2*J;const Ot=gt[0]*st-gt[1]*it,nt=gt[1]*st+gt[0]*it,et=this.getConstrainedCenter([Ot,nt],J),Et=x.callback?x.callback:s.tV;x.duration!==void 0?this.animateInternal({resolution:J,center:et,duration:x.duration,easing:x.easing},Et):(this.targetResolution_=J,this.targetCenter_=et,this.applyTargetState_(!1,!0),N(Et,!0))}centerOn(u,x,S){this.centerOnInternal((0,c.Ad)(u,this.getProjection()),x,S)}centerOnInternal(u,x,S){this.setCenterInternal(L(u,x,S,this.getResolution(),this.getRotation()))}calculateCenterShift(u,x,S,k){let tt;const ht=this.padding_;if(ht&&u){const dt=this.getViewportSizeMinusPadding_(-S),J=L(u,k,[dt[0]/2+ht[3],dt[1]/2+ht[0]],x,S);tt=[u[0]-J[0],u[1]-J[1]]}return tt}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(u){const x=(0,c.te)(this.targetCenter_,this.getProjection());this.setCenter([x[0]+u[0],x[1]+u[1]])}adjustCenterInternal(u){const x=this.targetCenter_;this.setCenterInternal([x[0]+u[0],x[1]+u[1]])}adjustResolution(u,x){x=x&&(0,c.Ad)(x,this.getProjection()),this.adjustResolutionInternal(u,x)}adjustResolutionInternal(u,x){const S=this.getAnimating()||this.getInteracting(),k=this.getViewportSize_(this.getRotation()),tt=this.constraints_.resolution(this.targetResolution_*u,0,k,S);x&&(this.targetCenter_=this.calculateCenterZoom(tt,x)),this.targetResolution_*=u,this.applyTargetState_()}adjustZoom(u,x){this.adjustResolution(Math.pow(this.zoomFactor_,-u),x)}adjustRotation(u,x){x&&(x=(0,c.Ad)(x,this.getProjection())),this.adjustRotationInternal(u,x)}adjustRotationInternal(u,x){const S=this.getAnimating()||this.getInteracting(),k=this.constraints_.rotation(this.targetRotation_+u,S);x&&(this.targetCenter_=this.calculateCenterRotate(k,x)),this.targetRotation_+=u,this.applyTargetState_()}setCenter(u){this.setCenterInternal(u&&(0,c.Ad)(u,this.getProjection()))}setCenterInternal(u){this.targetCenter_=u,this.applyTargetState_()}setHint(u,x){return this.hints_[u]+=x,this.changed(),this.hints_[u]}setResolution(u){this.targetResolution_=u,this.applyTargetState_()}setRotation(u){this.targetRotation_=u,this.applyTargetState_()}setZoom(u){this.setResolution(this.getResolutionForZoom(u))}applyTargetState_(u,x){const S=this.getAnimating()||this.getInteracting()||x,k=this.constraints_.rotation(this.targetRotation_,S),tt=this.getViewportSize_(k),ht=this.constraints_.resolution(this.targetResolution_,0,tt,S),dt=this.constraints_.center(this.targetCenter_,ht,tt,S,this.calculateCenterShift(this.targetCenter_,ht,k,tt));this.get($.ROTATION)!==k&&this.set($.ROTATION,k),this.get($.RESOLUTION)!==ht&&(this.set($.RESOLUTION,ht),this.set("zoom",this.getZoom(),!0)),(!dt||!this.get($.CENTER)||!(0,P.aI)(this.get($.CENTER),dt))&&this.set($.CENTER,dt),this.getAnimating()&&!u&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(u,x,S){u=u!==void 0?u:200;const k=x||0,tt=this.constraints_.rotation(this.targetRotation_),ht=this.getViewportSize_(tt),dt=this.constraints_.resolution(this.targetResolution_,k,ht),J=this.constraints_.center(this.targetCenter_,dt,ht,!1,this.calculateCenterShift(this.targetCenter_,dt,tt,ht));if(u===0&&!this.cancelAnchor_){this.targetResolution_=dt,this.targetRotation_=tt,this.targetCenter_=J,this.applyTargetState_();return}S=S||(u===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==dt||this.getRotation()!==tt||!this.getCenterInternal()||!(0,P.aI)(this.getCenterInternal(),J))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:tt,center:J,resolution:dt,duration:u,easing:g.vT,anchor:S}))}beginInteraction(){this.resolveConstraints(0),this.setHint(p.A.INTERACTING,1)}endInteraction(u,x,S){S=S&&(0,c.Ad)(S,this.getProjection()),this.endInteractionInternal(u,x,S)}endInteractionInternal(u,x,S){this.getInteracting()&&(this.setHint(p.A.INTERACTING,-1),this.resolveConstraints(u,x,S))}getConstrainedCenter(u,x){const S=this.getViewportSize_(this.getRotation());return this.constraints_.center(u,x||this.getResolution(),S)}getConstrainedZoom(u,x){const S=this.getResolutionForZoom(u);return this.getZoomForResolution(this.getConstrainedResolution(S,x))}getConstrainedResolution(u,x){x=x||0;const S=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(u,x,S)}}function N(O,u){setTimeout(function(){O(u)},0)}function W(O){if(O.extent!==void 0){const x=O.smoothExtentConstraint!==void 0?O.smoothExtentConstraint:!0;return l(O.extent,O.constrainOnlyCenter,x)}const u=(0,c.Av)(O.projection,"EPSG:3857");if(O.multiWorld!==!0&&u.isGlobal()){const x=u.getExtent().slice();return x[0]=-1/0,x[2]=1/0,l(x,!1,!1)}return y}function a(O){let u,x,S,ht=O.minZoom!==void 0?O.minZoom:R,dt=O.maxZoom!==void 0?O.maxZoom:28;const J=O.zoomFactor!==void 0?O.zoomFactor:2,ft=O.multiWorld!==void 0?O.multiWorld:!1,it=O.smoothResolutionConstraint!==void 0?O.smoothResolutionConstraint:!0,st=O.showFullExtent!==void 0?O.showFullExtent:!1,gt=(0,c.Av)(O.projection,"EPSG:3857"),Ot=gt.getExtent();let nt=O.constrainOnlyCenter,et=O.extent;if(!ft&&!et&&gt.isGlobal()&&(nt=!1,et=Ot),O.resolutions!==void 0){const Et=O.resolutions;x=Et[ht],S=Et[dt]!==void 0?Et[dt]:Et[Et.length-1],O.constrainResolution?u=w(Et,it,!nt&&et,st):u=f(x,S,it,!nt&&et,st)}else{const ut=(Ot?Math.max((0,I.RG)(Ot),(0,I.Oq)(Ot)):360*c.Ig.degrees/gt.getMetersPerUnit())/_.R/Math.pow(2,R),Rt=ut/Math.pow(2,28-R);x=O.maxResolution,x!==void 0?ht=0:x=ut/Math.pow(J,ht),S=O.minResolution,S===void 0&&(O.maxZoom!==void 0?O.maxResolution!==void 0?S=x/Math.pow(J,dt):S=ut/Math.pow(J,dt):S=Rt),dt=ht+Math.floor(Math.log(x/S)/Math.log(J)),S=x/Math.pow(J,dt-ht),O.constrainResolution?u=T(J,x,S,it,!nt&&et,st):u=f(x,S,it,!nt&&et,st)}return{constraint:u,maxResolution:x,minResolution:S,minZoom:ht,zoomFactor:J}}function o(O){if(O.enableRotation!==void 0?O.enableRotation:!0){const x=O.constrainRotation;return x===void 0||x===!0?(0,m.cq)():x===!1?m.dv:typeof x=="number"?(0,m.a$)(x):m.dv}return m.b8}function r(O){return!(O.sourceCenter&&O.targetCenter&&!(0,P.aI)(O.sourceCenter,O.targetCenter)||O.sourceResolution!==O.targetResolution||O.sourceRotation!==O.targetRotation)}function L(O,u,x,S,k){const tt=Math.cos(-k);let ht=Math.sin(-k),dt=O[0]*tt-O[1]*ht,J=O[1]*tt+O[0]*ht;dt+=(u[0]/2-x[0])*S,J+=(x[1]-u[1]/2)*S,ht=-ht;const ft=dt*tt-J*ht,it=J*tt+dt*ht;return[ft,it]}const A=b},93474:(Ft,at,i)=>{i.d(at,{T9:()=>$,a6:()=>U,sn:()=>K,vT:()=>p});function U(E){return Math.pow(E,3)}function p(E){return 1-U(1-E)}function $(E){return 3*E*E-2*E*E*E}function K(E){return E}function d(E){return E<.5?$(2*E):1-$(2*(E-.5))}},94720:(Ft,at,i)=>{i.d(at,{A:()=>Qt});var U=i(42375),p=i(89352),$=i(409),K=i(49825),d=i(43530),E=i(6782),l=i(27733),y=i(13628),P=i(49700),g=i(86936),I=i(953),s=i(29276),e=i(81426);function c(Y){return!0}function G(Y){const H=(0,K.SR)(),q=w(Y,H),Lt=(0,$.A)();return function(Dt,zt){if(Lt.properties=Dt.getPropertiesInternal(),Lt.resolution=zt,H.featureId){const Yt=Dt.getId();Yt!==void 0?Lt.featureId=Yt:Lt.featureId=null}return H.geometryType&&(Lt.geometryType=(0,K.Ye)(Dt.getGeometry())),q(Lt)}}function B(Y){const H=(0,K.SR)(),q=Y.length,Lt=new Array(q);for(let Yt=0;Yt<q;++Yt)Lt[Yt]=T(Y[Yt],H);const Dt=(0,$.A)(),zt=new Array(q);return function(Yt,Xt){if(Dt.properties=Yt.getPropertiesInternal(),Dt.resolution=Xt,H.featureId){const ne=Yt.getId();ne!==void 0?Dt.featureId=ne:Dt.featureId=null}let ee=0;for(let ne=0;ne<q;++ne){const Jt=Lt[ne](Dt);Jt&&(zt[ee]=Jt,ee+=1)}return zt.length=ee,zt}}function w(Y,H){const q=Y.length,Lt=new Array(q);for(let Dt=0;Dt<q;++Dt){const zt=Y[Dt],Yt="filter"in zt?(0,$.n)(zt.filter,K.T8,H):c;let Xt;if(Array.isArray(zt.style)){const ee=zt.style.length;Xt=new Array(ee);for(let ne=0;ne<ee;++ne)Xt[ne]=T(zt.style[ne],H)}else Xt=[T(zt.style,H)];Lt[Dt]={filter:Yt,styles:Xt}}return function(Dt){const zt=[];let Yt=!1;for(let Xt=0;Xt<q;++Xt){const ee=Lt[Xt].filter;if(ee(Dt)&&!(Y[Xt].else&&Yt)){Yt=!0;for(const ne of Lt[Xt].styles){const Jt=ne(Dt);Jt&&zt.push(Jt)}}}return zt}}function T(Y,H){const q=f(Y,"",H),Lt=m(Y,"",H),Dt=_(Y,H),zt=R(Y,H),Yt=a(Y,"z-index",H);if(!q&&!Lt&&!Dt&&!zt&&!(0,d.p)(Y))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(Y));const Xt=new s.Ay;return function(ee){let ne=!0;if(q){const Jt=q(ee);Jt&&(ne=!1),Xt.setFill(Jt)}if(Lt){const Jt=Lt(ee);Jt&&(ne=!1),Xt.setStroke(Jt)}if(Dt){const Jt=Dt(ee);Jt&&(ne=!1),Xt.setText(Jt)}if(zt){const Jt=zt(ee);Jt&&(ne=!1),Xt.setImage(Jt)}return Yt&&Xt.setZIndex(Yt(ee)),ne?null:Xt}}function f(Y,H,q){let Lt;if(H+"fill-pattern-src"in Y)Lt=r(Y,H+"fill-",q);else{if(Y[H+"fill-color"]==="none")return zt=>null;Lt=A(Y,H+"fill-color",q)}if(!Lt)return null;const Dt=new y.A;return function(zt){const Yt=Lt(zt);return Yt===p.qV?null:(Dt.setColor(Yt),Dt)}}function m(Y,H,q){const Lt=a(Y,H+"stroke-width",q),Dt=A(Y,H+"stroke-color",q);if(!Lt&&!Dt)return null;const zt=o(Y,H+"stroke-line-cap",q),Yt=o(Y,H+"stroke-line-join",q),Xt=O(Y,H+"stroke-line-dash",q),ee=a(Y,H+"stroke-line-dash-offset",q),ne=a(Y,H+"stroke-miter-limit",q),Jt=new I.A;return function(ue){if(Dt){const Kt=Dt(ue);if(Kt===p.qV)return null;Jt.setColor(Kt)}if(Lt&&Jt.setWidth(Lt(ue)),zt){const Kt=zt(ue);if(Kt!=="butt"&&Kt!=="round"&&Kt!=="square")throw new Error("Expected butt, round, or square line cap");Jt.setLineCap(Kt)}if(Yt){const Kt=Yt(ue);if(Kt!=="bevel"&&Kt!=="round"&&Kt!=="miter")throw new Error("Expected bevel, round, or miter line join");Jt.setLineJoin(Kt)}return Xt&&Jt.setLineDash(Xt(ue)),ee&&Jt.setLineDashOffset(ee(ue)),ne&&Jt.setMiterLimit(ne(ue)),Jt}}function _(Y,H){const q="text-",Lt=o(Y,q+"value",H);if(!Lt)return null;const Dt=f(Y,q,H),zt=f(Y,q+"background-",H),Yt=m(Y,q,H),Xt=m(Y,q+"background-",H),ee=o(Y,q+"font",H),ne=a(Y,q+"max-angle",H),Jt=a(Y,q+"offset-x",H),ue=a(Y,q+"offset-y",H),Kt=L(Y,q+"overflow",H),Ce=o(Y,q+"placement",H),de=a(Y,q+"repeat",H),V=S(Y,q+"scale",H),F=L(Y,q+"rotate-with-view",H),lt=a(Y,q+"rotation",H),mt=o(Y,q+"align",H),It=o(Y,q+"justify",H),Nt=o(Y,q+"baseline",H),St=L(Y,q+"keep-upright",H),Zt=O(Y,q+"padding",H),qt=it(Y,q+"declutter-mode"),At=new e.A({declutterMode:qt});return function(kt){if(At.setText(Lt(kt)),Dt&&At.setFill(Dt(kt)),zt&&At.setBackgroundFill(zt(kt)),Yt&&At.setStroke(Yt(kt)),Xt&&At.setBackgroundStroke(Xt(kt)),ee&&At.setFont(ee(kt)),ne&&At.setMaxAngle(ne(kt)),Jt&&At.setOffsetX(Jt(kt)),ue&&At.setOffsetY(ue(kt)),Kt&&At.setOverflow(Kt(kt)),Ce){const Wt=Ce(kt);if(Wt!=="point"&&Wt!=="line")throw new Error("Expected point or line for text-placement");At.setPlacement(Wt)}if(de&&At.setRepeat(de(kt)),V&&At.setScale(V(kt)),F&&At.setRotateWithView(F(kt)),lt&&At.setRotation(lt(kt)),mt){const Wt=mt(kt);if(Wt!=="left"&&Wt!=="center"&&Wt!=="right"&&Wt!=="end"&&Wt!=="start")throw new Error("Expected left, right, center, start, or end for text-align");At.setTextAlign(Wt)}if(It){const Wt=It(kt);if(Wt!=="left"&&Wt!=="right"&&Wt!=="center")throw new Error("Expected left, right, or center for text-justify");At.setJustify(Wt)}if(Nt){const Wt=Nt(kt);if(Wt!=="bottom"&&Wt!=="top"&&Wt!=="middle"&&Wt!=="alphabetic"&&Wt!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");At.setTextBaseline(Wt)}return Zt&&At.setPadding(Zt(kt)),St&&At.setKeepUpright(St(kt)),At}}function R(Y,H){return"icon-src"in Y?b(Y,H):"shape-points"in Y?N(Y,H):"circle-radius"in Y?W(Y,H):null}function b(Y,H){const q="icon-",Lt=q+"src",Dt=Ot(Y[Lt],Lt),zt=u(Y,q+"anchor",H),Yt=S(Y,q+"scale",H),Xt=a(Y,q+"opacity",H),ee=u(Y,q+"displacement",H),ne=a(Y,q+"rotation",H),Jt=L(Y,q+"rotate-with-view",H),ue=dt(Y,q+"anchor-origin"),Kt=J(Y,q+"anchor-x-units"),Ce=J(Y,q+"anchor-y-units"),de=st(Y,q+"color"),V=ht(Y,q+"cross-origin"),F=ft(Y,q+"offset"),lt=dt(Y,q+"offset-origin"),mt=k(Y,q+"width"),It=k(Y,q+"height"),Nt=tt(Y,q+"size"),St=it(Y,q+"declutter-mode"),Zt=new P.A({src:Dt,anchorOrigin:ue,anchorXUnits:Kt,anchorYUnits:Ce,color:de,crossOrigin:V,offset:F,offsetOrigin:lt,height:It,width:mt,size:Nt,declutterMode:St});return function(qt){return Xt&&Zt.setOpacity(Xt(qt)),ee&&Zt.setDisplacement(ee(qt)),ne&&Zt.setRotation(ne(qt)),Jt&&Zt.setRotateWithView(Jt(qt)),Yt&&Zt.setScale(Yt(qt)),zt&&Zt.setAnchor(zt(qt)),Zt}}function N(Y,H){const q="shape-",Lt=q+"points",Dt=q+"radius",zt=nt(Y[Lt],Lt),Yt=nt(Y[Dt],Dt),Xt=f(Y,q,H),ee=m(Y,q,H),ne=S(Y,q+"scale",H),Jt=u(Y,q+"displacement",H),ue=a(Y,q+"rotation",H),Kt=L(Y,q+"rotate-with-view",H),Ce=k(Y,q+"radius2"),de=k(Y,q+"angle"),V=it(Y,q+"declutter-mode"),F=new g.A({points:zt,radius:Yt,radius2:Ce,angle:de,declutterMode:V});return function(lt){return Xt&&F.setFill(Xt(lt)),ee&&F.setStroke(ee(lt)),Jt&&F.setDisplacement(Jt(lt)),ue&&F.setRotation(ue(lt)),Kt&&F.setRotateWithView(Kt(lt)),ne&&F.setScale(ne(lt)),F}}function W(Y,H){const q="circle-",Lt=f(Y,q,H),Dt=m(Y,q,H),zt=a(Y,q+"radius",H),Yt=S(Y,q+"scale",H),Xt=u(Y,q+"displacement",H),ee=a(Y,q+"rotation",H),ne=L(Y,q+"rotate-with-view",H),Jt=it(Y,q+"declutter-mode"),ue=new l.A({radius:5,declutterMode:Jt});return function(Kt){return zt&&ue.setRadius(zt(Kt)),Lt&&ue.setFill(Lt(Kt)),Dt&&ue.setStroke(Dt(Kt)),Xt&&ue.setDisplacement(Xt(Kt)),ee&&ue.setRotation(ee(Kt)),ne&&ue.setRotateWithView(ne(Kt)),Yt&&ue.setScale(Yt(Kt)),ue}}function a(Y,H,q){if(!(H in Y))return;const Lt=(0,$.n)(Y[H],K.wl,q);return function(Dt){return nt(Lt(Dt),H)}}function o(Y,H,q){if(!(H in Y))return null;const Lt=(0,$.n)(Y[H],K.cT,q);return function(Dt){return Ot(Lt(Dt),H)}}function r(Y,H,q){const Lt=o(Y,H+"pattern-src",q),Dt=x(Y,H+"pattern-offset",q),zt=x(Y,H+"pattern-size",q),Yt=A(Y,H+"color",q);return function(Xt){return{src:Lt(Xt),offset:Dt&&Dt(Xt),size:zt&&zt(Xt),color:Yt&&Yt(Xt)}}}function L(Y,H,q){if(!(H in Y))return null;const Lt=(0,$.n)(Y[H],K.T8,q);return function(Dt){const zt=Lt(Dt);if(typeof zt!="boolean")throw new Error(`Expected a boolean for ${H}`);return zt}}function A(Y,H,q){if(!(H in Y))return null;const Lt=(0,$.n)(Y[H],K.mE,q);return function(Dt){return et(Lt(Dt),H)}}function O(Y,H,q){if(!(H in Y))return null;const Lt=(0,$.n)(Y[H],K.Fq,q);return function(Dt){return gt(Lt(Dt),H)}}function u(Y,H,q){if(!(H in Y))return null;const Lt=(0,$.n)(Y[H],K.Fq,q);return function(Dt){const zt=gt(Lt(Dt),H);if(zt.length!==2)throw new Error(`Expected two numbers for ${H}`);return zt}}function x(Y,H,q){if(!(H in Y))return null;const Lt=(0,$.n)(Y[H],K.Fq,q);return function(Dt){return Et(Lt(Dt),H)}}function S(Y,H,q){if(!(H in Y))return null;const Lt=(0,$.n)(Y[H],K.Fq|K.wl,q);return function(Dt){return ut(Lt(Dt),H)}}function k(Y,H){const q=Y[H];if(q!==void 0){if(typeof q!="number")throw new Error(`Expected a number for ${H}`);return q}}function tt(Y,H){const q=Y[H];if(q!==void 0){if(typeof q=="number")return(0,E.xq)(q);if(!Array.isArray(q))throw new Error(`Expected a number or size array for ${H}`);if(q.length!==2||typeof q[0]!="number"||typeof q[1]!="number")throw new Error(`Expected a number or size array for ${H}`);return q}}function ht(Y,H){const q=Y[H];if(q!==void 0){if(typeof q!="string")throw new Error(`Expected a string for ${H}`);return q}}function dt(Y,H){const q=Y[H];if(q!==void 0){if(q!=="bottom-left"&&q!=="bottom-right"&&q!=="top-left"&&q!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${H}`);return q}}function J(Y,H){const q=Y[H];if(q!==void 0){if(q!=="pixels"&&q!=="fraction")throw new Error(`Expected pixels or fraction for ${H}`);return q}}function ft(Y,H){const q=Y[H];if(q!==void 0)return gt(q,H)}function it(Y,H){const q=Y[H];if(q!==void 0){if(typeof q!="string")throw new Error(`Expected a string for ${H}`);if(q!=="declutter"&&q!=="obstacle"&&q!=="none")throw new Error(`Expected declutter, obstacle, or none for ${H}`);return q}}function st(Y,H){const q=Y[H];if(q!==void 0)return et(q,H)}function gt(Y,H){if(!Array.isArray(Y))throw new Error(`Expected an array for ${H}`);const q=Y.length;for(let Lt=0;Lt<q;++Lt)if(typeof Y[Lt]!="number")throw new Error(`Expected an array of numbers for ${H}`);return Y}function Ot(Y,H){if(typeof Y!="string")throw new Error(`Expected a string for ${H}`);return Y}function nt(Y,H){if(typeof Y!="number")throw new Error(`Expected a number for ${H}`);return Y}function et(Y,H){if(typeof Y=="string")return Y;const q=gt(Y,H),Lt=q.length;if(Lt<3||Lt>4)throw new Error(`Expected a color with 3 or 4 values for ${H}`);return q}function Et(Y,H){const q=gt(Y,H);if(q.length!==2)throw new Error(`Expected an array of two numbers for ${H}`);return q}function ut(Y,H){return typeof Y=="number"?Y:Et(Y,H)}var Rt=i(60764);const Mt={RENDER_ORDER:"renderOrder"};class jt extends Rt.A{constructor(H){H=H||{};const q=Object.assign({},H);delete q.style,delete q.renderBuffer,delete q.updateWhileAnimating,delete q.updateWhileInteracting,super(q),this.declutter_=H.declutter?String(H.declutter):void 0,this.renderBuffer_=H.renderBuffer!==void 0?H.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(H.style),this.updateWhileAnimating_=H.updateWhileAnimating!==void 0?H.updateWhileAnimating:!1,this.updateWhileInteracting_=H.updateWhileInteracting!==void 0?H.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(H){return super.getFeatures(H)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Mt.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(H,q){const Lt=this.getDeclutter();Lt in H.declutter||(H.declutter[Lt]=new U.A(9)),this.getRenderer().renderDeclutter(H,q)}setRenderOrder(H){this.set(Mt.RENDER_ORDER,H)}setStyle(H){this.style_=H===void 0?s.d1:H;const q=ie(H);this.styleFunction_=H===null?void 0:(0,s.mC)(q),this.changed()}setDeclutter(H){this.declutter_=H?String(H):void 0,this.changed()}}function ie(Y){if(Y===void 0)return s.d1;if(!Y)return null;if(typeof Y=="function"||Y instanceof s.Ay)return Y;if(!Array.isArray(Y))return B([Y]);if(Y.length===0)return[];const H=Y.length,q=Y[0];if(q instanceof s.Ay){const Dt=new Array(H);for(let zt=0;zt<H;++zt){const Yt=Y[zt];if(!(Yt instanceof s.Ay))throw new Error("Expected a list of style instances");Dt[zt]=Yt}return Dt}if("style"in q){const Dt=new Array(H);for(let zt=0;zt<H;++zt){const Yt=Y[zt];if(!("style"in Yt))throw new Error("Expected a list of rules with a style property");Dt[zt]=Yt}return G(Dt)}return B(Y)}const Qt=jt},95801:(Ft,at,i)=>{i.d(at,{A:()=>$});var U=i(1685);class p extends U.Ay{constructor(d,E,l){super(d),this.map=E,this.frameState=l!==void 0?l:null}}const $=p},96769:(Ft,at,i)=>{i.d(at,{A:()=>c,B:()=>g});var U=i(66514),p=i(89352),$=i(68711),K=i(70915),d=i(87579),E=i(83984),l=i(40808),y=i(9703),P=i(5986);const g=[];let I=null;function s(){I=(0,$.Y)(1,1,void 0,{willReadFrequently:!0})}class e extends P.A{constructor(B){super(B),this.container=null,this.renderedResolution,this.tempTransform=(0,y.vt)(),this.pixelTransform=(0,y.vt)(),this.inversePixelTransform=(0,y.vt)(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(B,w,T){I||s(),I.clearRect(0,0,1,1);let f;try{I.drawImage(B,w,T,1,1,0,0,1,1),f=I.getImageData(0,0,1,1).data}catch{return I=null,null}return f}getBackground(B){let T=this.getLayer().getBackground();return typeof T=="function"&&(T=T(B.viewState.resolution)),T||void 0}useContainer(B,w,T){const f=this.getLayer().getClassName();let m,_;if(B&&B.className===f&&(!T||B&&B.style.backgroundColor&&(0,U.aI)((0,p._j)(B.style.backgroundColor),(0,p._j)(T)))){const R=B.firstElementChild;R instanceof HTMLCanvasElement&&(_=R.getContext("2d"))}if(_&&(0,y.tI)(_.canvas.style.transform,w)?(this.container=B,this.context=_,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){m=document.createElement("div"),m.className=f;let R=m.style;R.position="absolute",R.width="100%",R.height="100%",_=(0,$.Y)();const b=_.canvas;m.appendChild(b),R=b.style,R.position="absolute",R.left="0",R.transformOrigin="top left",this.container=m,this.context=_}!this.containerReused&&T&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=T)}clipUnrotated(B,w,T){const f=(0,K.Py)(T),m=(0,K.WU)(T),_=(0,K.k_)(T),R=(0,K.R)(T);(0,y.Bb)(w.coordinateToPixelTransform,f),(0,y.Bb)(w.coordinateToPixelTransform,m),(0,y.Bb)(w.coordinateToPixelTransform,_),(0,y.Bb)(w.coordinateToPixelTransform,R);const b=this.inversePixelTransform;(0,y.Bb)(b,f),(0,y.Bb)(b,m),(0,y.Bb)(b,_),(0,y.Bb)(b,R),B.save(),B.beginPath(),B.moveTo(Math.round(f[0]),Math.round(f[1])),B.lineTo(Math.round(m[0]),Math.round(m[1])),B.lineTo(Math.round(_[0]),Math.round(_[1])),B.lineTo(Math.round(R[0]),Math.round(R[1])),B.clip()}prepareContainer(B,w){const T=B.extent,f=B.viewState.resolution,m=B.viewState.rotation,_=B.pixelRatio,R=Math.round((0,K.RG)(T)/f*_),b=Math.round((0,K.Oq)(T)/f*_);(0,y.Zz)(this.pixelTransform,B.size[0]/2,B.size[1]/2,1/_,1/_,m,-R/2,-b/2),(0,y.T9)(this.inversePixelTransform,this.pixelTransform);const N=(0,y.dI)(this.pixelTransform);if(this.useContainer(w,N,this.getBackground(B)),!this.containerReused){const W=this.context.canvas;W.width!=R||W.height!=b?(W.width=R,W.height=b):this.context.clearRect(0,0,R,b),N!==W.style.transform&&(W.style.transform=N)}}dispatchRenderEvent_(B,w,T){const f=this.getLayer();if(f.hasListener(B)){const m=new d.A(B,this.inversePixelTransform,T,w);f.dispatchEvent(m)}}preRender(B,w){this.frameState=w,!w.declutter&&this.dispatchRenderEvent_(E.A.PRERENDER,B,w)}postRender(B,w){w.declutter||this.dispatchRenderEvent_(E.A.POSTRENDER,B,w)}renderDeferredInternal(B){}getRenderContext(B){return B.declutter&&!this.deferredContext_&&(this.deferredContext_=new l.A),B.declutter?this.deferredContext_.getContext():this.context}renderDeferred(B){B.declutter&&(this.dispatchRenderEvent_(E.A.PRERENDER,this.context,B),B.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(B),this.dispatchRenderEvent_(E.A.POSTRENDER,this.context,B))}getRenderTransform(B,w,T,f,m,_,R){const b=m/2,N=_/2,W=f/w,a=-W,o=-B[0]+R,r=-B[1];return(0,y.Zz)(this.tempTransform,b,N,W,a,-T,o,r)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const c=e},97907:(Ft,at,i)=>{i.d(at,{A:()=>I,J:()=>g});var U=i(43938),p=i(6141),$=i(89352),K=i(68711),d=i(6837),E=i(79332),l=i(82241);let y=null;class P extends E.A{constructor(e,c,G,B,w){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=G,this.canvas_={},this.color_=w,this.imageState_=B===void 0?p.A.IDLE:B,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=c,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===p.A.LOADED){y||(y=(0,K.Y)(1,1,void 0,{willReadFrequently:!0})),y.drawImage(this.image_,0,0);try{y.getImageData(0,0,1,1),this.tainted_=!1}catch{y=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(d.A.CHANGE)}handleImageError_(){this.imageState_=p.A.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=p.A.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],c=this.size_[1],G=(0,K.Y)(e,c);G.fillRect(0,0,e,c),this.hitDetectionImage_=G.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===p.A.IDLE){this.image_||this.initializeImage_(),this.imageState_=p.A.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(0,U.RA)(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==p.A.LOADED)return;const c=this.image_,G=(0,K.Y)(Math.ceil(c.width*e),Math.ceil(c.height*e)),B=G.canvas;G.scale(e,e),G.drawImage(c,0,0),G.globalCompositeOperation="multiply",G.fillStyle=(0,$.oJ)(this.color_),G.fillRect(0,0,B.width/e,B.height/e),G.globalCompositeOperation="destination-in",G.drawImage(c,0,0),this.canvas_[e]=B}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===p.A.LOADED||this.imageState_===p.A.ERROR)e();else{const c=()=>{(this.imageState_===p.A.LOADED||this.imageState_===p.A.ERROR)&&(this.removeEventListener(d.A.CHANGE,c),e())};this.addEventListener(d.A.CHANGE,c)}})),this.ready_}}function g(s,e,c,G,B,w){let T=e===void 0?void 0:l.ue.get(e,c,B);return T||(T=new P(s,s&&"src"in s?s.src||void 0:e,c,G,B),l.ue.set(e,c,B,T,w)),w&&T&&!l.ue.getPattern(e,c,B)&&l.ue.set(e,c,B,T,w),T}const I=P},99676:(Ft,at,i)=>{i.d(at,{F:()=>E});var U=i(6141),p=i(89352),$=i(68711),K=i(97907),d=i(82241);function E(y){return y?Array.isArray(y)?(0,p.dI)(y):typeof y=="object"&&"src"in y?l(y):y:null}function l(y){if(!y.offset||!y.size)return d.ue.getPattern(y.src,"anonymous",y.color);const P=y.src+":"+y.offset,g=d.ue.getPattern(P,void 0,y.color);if(g)return g;const I=d.ue.get(y.src,"anonymous",null);if(I.getImageState()!==U.A.LOADED)return null;const s=(0,$.Y)(y.size[0],y.size[1]);return s.drawImage(I.getImage(1),y.offset[0],y.offset[1],y.size[0],y.size[1],0,0,y.size[0],y.size[1]),(0,K.J)(s.canvas,P,void 0,U.A.LOADED,y.color,!0),d.ue.getPattern(P,void 0,y.color)}}}]);

//# sourceMappingURL=3326.06d9184a9acb61e05312.js.map