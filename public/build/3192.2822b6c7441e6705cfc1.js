"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3192],{51686:(oa,H,i)=>{i.d(H,{XW:()=>X,gB:()=>ta,zm:()=>ea,Ad:()=>aa,SD:()=>ia,br:()=>Z});var a=i(96540),T=i(91984),D=i(5709);const r=["TimeInterval"],x=D.H.enhanceEndpoints({addTagTypes:r}).injectEndpoints({endpoints:s=>({listNamespacedTimeInterval:s.query({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals`,params:{pretty:e.pretty,allowWatchBookmarks:e.allowWatchBookmarks,continue:e.continue,fieldSelector:e.fieldSelector,labelSelector:e.labelSelector,limit:e.limit,resourceVersion:e.resourceVersion,resourceVersionMatch:e.resourceVersionMatch,sendInitialEvents:e.sendInitialEvents,timeoutSeconds:e.timeoutSeconds,watch:e.watch}}),providesTags:["TimeInterval"]}),createNamespacedTimeInterval:s.mutation({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals`,method:"POST",body:e.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:e.pretty,dryRun:e.dryRun,fieldManager:e.fieldManager,fieldValidation:e.fieldValidation}}),invalidatesTags:["TimeInterval"]}),replaceNamespacedTimeInterval:s.mutation({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals/${e.name}`,method:"PUT",body:e.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:e.pretty,dryRun:e.dryRun,fieldManager:e.fieldManager,fieldValidation:e.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deleteNamespacedTimeInterval:s.mutation({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals/${e.name}`,method:"DELETE",body:e.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:e.pretty,dryRun:e.dryRun,gracePeriodSeconds:e.gracePeriodSeconds,orphanDependents:e.orphanDependents,propagationPolicy:e.propagationPolicy}}),invalidatesTags:["TimeInterval"]})}),overrideExisting:!1});var R=i(78747),w=i(22628),S=i(56476),v=i(85618),E=i(80218),n=i(43100),m=i(72748);const{useLazyGetAlertmanagerConfigurationQuery:P}=T.m,{useLazyListNamespacedTimeIntervalQuery:y,useCreateNamespacedTimeIntervalMutation:l,useReplaceNamespacedTimeIntervalMutation:U,useDeleteNamespacedTimeIntervalMutation:L}=x,V=s=>{const{metadata:e,spec:u}=s;return{...u,id:u.name,metadata:e,provisioned:(0,S.Uo)(s)}},O=(s,e)=>({...s,id:s.name,provisioned:!!(e&&e!==w.rh)}),$=()=>P({selectFromResult:({data:s,...e})=>{if(!s)return{data:s,...e};const{alertmanager_config:u}=s,b=u.muteTimeProvenances??{};return{data:(0,R.IT)(u).map(p=>O(p,b[p.name])),...e}}}),z=()=>y({selectFromResult:({data:s,...e})=>({data:s?.items.map(u=>V(u)),...e})}),aa=({alertmanager:s,skip:e})=>{const u=(0,S.dM)(s),[b,I]=z(),[j,p]=$();return(0,a.useEffect)(()=>{if(!e)if(u){const c=(0,v.Ge)();b({namespace:c})}else j(s)},[s,j,b,e,u]),u?I:p},X=({alertmanager:s})=>{const e=(0,S.dM)(s),[u]=l(),[b]=(0,n.d)(),I=(0,E.Yb)(({interval:p})=>{const c=(0,v.Ge)();return u({namespace:c,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{metadata:{},spec:p}}).unwrap()}),j=(0,E.Yb)(({interval:p})=>{const c=(0,m.X9)({interval:p});return b(c)});return e?I:j},ea=({alertmanager:s,name:e})=>{const u=(0,S.dM)(s),[b,I]=y({selectFromResult:({data:c,...g})=>c?c.items.length===0?{...g,data:void 0,isError:!0}:{data:V(c.items[0]),...g}:{data:c,...g}}),[j,p]=P({selectFromResult:({data:c,...g})=>{if(!c)return{data:c,...g};const ra=c?.alertmanager_config??{},_=(0,R.IT)(ra).find(({name:na})=>na===e);if(_){const na=ra?.muteTimeProvenances??{};return{data:O(_,na[_.name]),...g}}return{...g,data:void 0,isError:!0}}});return(0,a.useEffect)(()=>{if(u){const c=(0,v.Ge)(),g=(0,S.O)(e);b({namespace:c,fieldSelector:`spec.name=${g}`},!0)}else j(s,!0)},[s,j,b,e,u]),u?I:p},ia=({alertmanager:s})=>{const e=(0,S.dM)(s),[u]=U(),[b]=(0,n.d)(),I=(0,E.Yb)(async({interval:p,originalName:c})=>{const g=(0,v.Ge)();return u({name:c,namespace:g,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{spec:p,metadata:{name:c}}}).unwrap()}),j=(0,E.Yb)(async({interval:p,originalName:c})=>{const g=(0,m.ov)({interval:p,originalName:c});return b(g)});return e?I:j},ta=({alertmanager:s})=>{const e=(0,S.dM)(s),[u,b]=(0,n.d)(),[I]=L(),j=(0,E.Yb)(async({name:c})=>{const g=(0,m.$8)({name:c});return u(g)}),p=(0,E.Yb)(async({name:c})=>{const g=(0,v.Ge)();await I({name:c,namespace:g,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{}}).unwrap()});return e?p:j},Z=({alertmanager:s})=>{const e=(0,S.dM)(s),[u]=$();return e?()=>{}:async(b,I)=>{if(!I)return u(s).unwrap().then(j=>!!(0,R.IT)(j.alertmanager_config)?.find(g=>g.name===b)?`Mute timing already exists with name "${b}"`:void 0)}}},78747:(oa,H,i)=>{i.d(H,{Hy:()=>w,IT:()=>S,av:()=>E,oB:()=>v});var a=i(74848),T=i(95093),D=i.n(T),r=i(96540),Q=i(41654),x=i(86017);const R=/^((([01][0-9])|(2[0-3])):[0-5][0-9])$|(^24:00$)/,w=n=>n?R.test(n):!0,S=n=>[...n.mute_time_intervals??[],...n.time_intervals??[]],v=(n,m)=>{if(!n&&!m)return!0;if(!n&&m||n&&!m)return!1;const P="HH:mm",y=D()().startOf("day").add(n,P),l=D()().startOf("day").add(m,P);return!!(n&&m&&y.isBefore(l)||n&&m&&l.isAfter(y))};function E(n){const P=n.time_intervals.map((y,l)=>{const{times:U,weekdays:L,days_of_month:V,months:O,years:$,location:z}=y,aa=(0,x.Dm)(U,z),X=(0,x.uH)(L),ea=(0,x.UL)(V),ia=(0,x.$P)(O),ta=(0,x.mP)($);return(0,a.jsx)(r.Fragment,{children:(0,a.jsxs)("div",{children:[`${aa} ${X}`,(0,a.jsx)("br",{}),[ea,ia,ta].join(" | "),(0,a.jsx)("br",{})]})},JSON.stringify(y)+l)});return(0,a.jsx)(Q.B,{direction:"column",gap:1,children:P})}},83192:(oa,H,i)=>{i.d(H,{A:()=>ga});var a=i(74848),T=i(22803),D=i(49785),r=i(92745),Q=i(36490),x=i(63142),R=i(6975),w=i(34999),S=i(16780),v=i(37386),E=i(63527),n=i(45861),m=i(51686),P=i(5358),y=i(77256),l=i(97539),U=i(1972),L=i(2543),V=i(96540),O=i(41654),$=i(30703),z=i(21285),aa=i(97095),X=i(18027),ea=i(76319),ia=i(45967),ta=i(10427),Z=i(78747);const s="Times must be between 00:00 and 24:00 UTC",e=({intervalIndex:t})=>{const d=(0,x.of)(u),{register:o,formState:h,getValues:C,watch:F}=(0,D.xW)(),K=F(`time_intervals.${t}.disable`),{fields:B,append:M,remove:A}=(0,D.jz)({name:`time_intervals.${t}.times`}),k=h.errors.time_intervals?.[t],N=k?.times?.some?.(f=>f?.start_time||f?.end_time)??!1;return(0,a.jsxs)("div",{children:[(0,a.jsx)(v.D,{className:d.field,label:(0,r.t)("alerting.mute-timing-time-range.label-time-range","Time range"),description:(0,r.t)("alerting.mute-timing-time-range.description-time-range","The time inclusive of the start and exclusive of the end time (in UTC if no location has been selected, otherwise local time)"),invalid:N,children:(0,a.jsx)(a.Fragment,{children:B.map((f,G)=>{const Y=k?.times?.[G],sa=`time_intervals.${t}.times.${G}.start_time`,q=`time_intervals.${t}.times.${G}.end_time`,J=()=>{const W=C(sa),ca=C(q);return[W,ca]};return(0,a.jsx)("div",{className:d.timeRange,children:(0,a.jsxs)(aa.C,{children:[(0,a.jsx)(X.I,{label:(0,r.t)("alerting.mute-timing-time-range.label-start-time","Start time"),invalid:!!Y?.start_time,error:Y?.start_time?.message,children:(0,a.jsx)(E.p,{...o(sa,{validate:W=>{if(!(0,Z.Hy)(W))return s;const[ma,la]=J();if(!(0,Z.oB)(ma,la))return"Start time must be before end time"}}),className:d.timeRangeInput,maxLength:5,readOnly:K,suffix:(0,a.jsx)($.I,{name:"clock-nine"}),defaultValue:f.start_time,placeholder:(0,r.t)("alerting.mute-timing-time-range.mute-timing-starts-at-placeholder-hhmm","HH:mm"),"data-testid":"mute-timing-starts-at"})}),(0,a.jsx)(X.I,{label:(0,r.t)("alerting.mute-timing-time-range.label-end-time","End time"),invalid:!!Y?.end_time,error:Y?.end_time?.message,children:(0,a.jsx)(E.p,{...o(`time_intervals.${t}.times.${G}.end_time`,{validate:W=>{if(!(0,Z.Hy)(W))return s;const[ma,la]=J();if(!(0,Z.oB)(ma,la))return"End time must be after start time"}}),className:d.timeRangeInput,maxLength:5,readOnly:K,suffix:(0,a.jsx)($.I,{name:"clock-nine"}),defaultValue:f.end_time,placeholder:(0,r.t)("alerting.mute-timing-time-range.mute-timing-ends-at-placeholder-hhmm","HH:mm"),"data-testid":"mute-timing-ends-at"})}),(0,a.jsx)(ea.K,{className:d.deleteTimeRange,title:(0,r.t)("alerting.mute-timing-time-range.title-remove","Remove"),name:"trash-alt",onClick:W=>{W.preventDefault(),A(G)},tooltip:(0,r.t)("alerting.mute-timing-time-range.tooltip-remove-time-range","Remove time range")})]})},f.id)})})}),(0,a.jsx)(ta.A,{shouldWrap:K,wrap:f=>(0,a.jsx)(ia.m,{content:(0,r.t)("alerting.mute-timing-time-range.content-this-time-interval-is-disabled","This time interval is disabled"),placement:"right-start",children:f}),children:(0,a.jsx)(n.$n,{className:d.addTimeRange,variant:"secondary",type:"button",icon:"plus",disabled:K,onClick:()=>M({start_time:"",end_time:""}),children:(0,a.jsx)(r.x6,{i18nKey:"alerting.mute-timing-time-range.add-another-time-range",children:"Add another time range"})})})]})},u=t=>({field:(0,T.css)({marginBottom:0}),timeRange:(0,T.css)({marginBottom:t.spacing(1)}),timeRangeInput:(0,T.css)({width:"90px"}),deleteTimeRange:(0,T.css)({margin:`${t.spacing(1)} 0 0 ${t.spacing(.5)}`}),addTimeRange:(0,T.css)({marginBottom:t.spacing(2)})});var b=i(18857);const I=["Africa/Abidjan","Africa/Accra","Africa/Addis_Ababa","Africa/Algiers","Africa/Asmara","Africa/Bamako","Africa/Bangui","Africa/Banjul","Africa/Bissau","Africa/Blantyre","Africa/Brazzaville","Africa/Bujumbura","Africa/Cairo","Africa/Casablanca","Africa/Ceuta","Africa/Conakry","Africa/Dakar","Africa/Dar_es_Salaam","Africa/Djibouti","Africa/Douala","Africa/El_Aaiun","Africa/Freetown","Africa/Gaborone","Africa/Harare","Africa/Johannesburg","Africa/Juba","Africa/Kampala","Africa/Khartoum","Africa/Kigali","Africa/Kinshasa","Africa/Lagos","Africa/Libreville","Africa/Lome","Africa/Luanda","Africa/Lubumbashi","Africa/Lusaka","Africa/Malabo","Africa/Maputo","Africa/Maseru","Africa/Mbabane","Africa/Mogadishu","Africa/Monrovia","Africa/Nairobi","Africa/Ndjamena","Africa/Niamey","Africa/Nouakchott","Africa/Ouagadougou","Africa/Porto-Novo","Africa/Sao_Tome","Africa/Tripoli","Africa/Tunis","Africa/Windhoek","America/Adak","America/Anchorage","America/Anguilla","America/Antigua","America/Araguaina","America/Argentina/Buenos_Aires","America/Argentina/Catamarca","America/Argentina/Cordoba","America/Argentina/Jujuy","America/Argentina/La_Rioja","America/Argentina/Mendoza","America/Argentina/Rio_Gallegos","America/Argentina/Salta","America/Argentina/San_Juan","America/Argentina/San_Luis","America/Argentina/Tucuman","America/Argentina/Ushuaia","America/Aruba","America/Asuncion","America/Atikokan","America/Bahia","America/Bahia_Banderas","America/Barbados","America/Belem","America/Belize","America/Blanc-Sablon","America/Boa_Vista","America/Bogota","America/Boise","America/Cambridge_Bay","America/Campo_Grande","America/Cancun","America/Caracas","America/Cayenne","America/Cayman","America/Chicago","America/Chihuahua","America/Ciudad_Juarez","America/Costa_Rica","America/Creston","America/Cuiaba","America/Curacao","America/Danmarkshavn","America/Dawson","America/Dawson_Creek","America/Denver","America/Detroit","America/Dominica","America/Edmonton","America/Eirunepe","America/El_Salvador","America/Fort_Nelson","America/Fortaleza","America/Glace_Bay","America/Godthab","America/Goose_Bay","America/Grand_Turk","America/Grenada","America/Guadeloupe","America/Guatemala","America/Guayaquil","America/Guyana","America/Halifax","America/Havana","America/Hermosillo","America/Indiana/Indianapolis","America/Indiana/Knox","America/Indiana/Marengo","America/Indiana/Petersburg","America/Indiana/Tell_City","America/Indiana/Vevay","America/Indiana/Vincennes","America/Indiana/Winamac","America/Inuvik","America/Iqaluit","America/Jamaica","America/Juneau","America/Kentucky/Louisville","America/Kentucky/Monticello","America/Kralendijk","America/La_Paz","America/Lima","America/Los_Angeles","America/Lower_Princes","America/Maceio","America/Managua","America/Manaus","America/Marigot","America/Martinique","America/Matamoros","America/Mazatlan","America/Menominee","America/Merida","America/Metlakatla","America/Mexico_City","America/Miquelon","America/Moncton","America/Monterrey","America/Montevideo","America/Montreal","America/Montserrat","America/Nassau","America/New_York","America/Nipigon","America/Nome","America/Noronha","America/North_Dakota/Beulah","America/North_Dakota/Center","America/North_Dakota/New_Salem","America/Nuuk","America/Ojinaga","America/Panama","America/Pangnirtung","America/Paramaribo","America/Phoenix","America/Port-au-Prince","America/Port_of_Spain","America/Porto_Velho","America/Puerto_Rico","America/Punta_Arenas","America/Rainy_River","America/Rankin_Inlet","America/Recife","America/Regina","America/Resolute","America/Rio_Branco","America/Santa_Isabel","America/Santarem","America/Santiago","America/Santo_Domingo","America/Sao_Paulo","America/Scoresbysund","America/Shiprock","America/Sitka","America/St_Barthelemy","America/St_Johns","America/St_Kitts","America/St_Lucia","America/St_Thomas","America/St_Vincent","America/Swift_Current","America/Tegucigalpa","America/Thule","America/Thunder_Bay","America/Tijuana","America/Toronto","America/Tortola","America/Vancouver","America/Whitehorse","America/Winnipeg","America/Yakutat","America/Yellowknife","Antarctica/Casey","Antarctica/Davis","Antarctica/DumontDUrville","Antarctica/Macquarie","Antarctica/Mawson","Antarctica/McMurdo","Antarctica/Palmer","Antarctica/Rothera","Antarctica/South_Pole","Antarctica/Syowa","Antarctica/Troll","Antarctica/Vostok","Arctic/Longyearbyen","Asia/Aden","Asia/Almaty","Asia/Amman","Asia/Anadyr","Asia/Aqtau","Asia/Aqtobe","Asia/Ashgabat","Asia/Atyrau","Asia/Baghdad","Asia/Bahrain","Asia/Baku","Asia/Bangkok","Asia/Barnaul","Asia/Beirut","Asia/Bishkek","Asia/Brunei","Asia/Calcutta","Asia/Chita","Asia/Choibalsan","Asia/Chongqing","Asia/Colombo","Asia/Damascus","Asia/Dhaka","Asia/Dili","Asia/Dubai","Asia/Dushanbe","Asia/Famagusta","Asia/Gaza","Asia/Harbin","Asia/Hebron","Asia/Ho_Chi_Minh","Asia/Hong_Kong","Asia/Hovd","Asia/Irkutsk","Asia/Jakarta","Asia/Jayapura","Asia/Jerusalem","Asia/Kabul","Asia/Kamchatka","Asia/Karachi","Asia/Kashgar","Asia/Kathmandu","Asia/Katmandu","Asia/Khandyga","Asia/Krasnoyarsk","Asia/Kuala_Lumpur","Asia/Kuching","Asia/Kuwait","Asia/Macau","Asia/Magadan","Asia/Makassar","Asia/Manila","Asia/Muscat","Asia/Nicosia","Asia/Novokuznetsk","Asia/Novosibirsk","Asia/Omsk","Asia/Oral","Asia/Phnom_Penh","Asia/Pontianak","Asia/Pyongyang","Asia/Qatar","Asia/Qostanay","Asia/Qyzylorda","Asia/Rangoon","Asia/Riyadh","Asia/Sakhalin","Asia/Samarkand","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Srednekolymsk","Asia/Taipei","Asia/Tashkent","Asia/Tbilisi","Asia/Tehran","Asia/Thimphu","Asia/Tokyo","Asia/Tomsk","Asia/Ulaanbaatar","Asia/Urumqi","Asia/Ust-Nera","Asia/Vientiane","Asia/Vladivostok","Asia/Yakutsk","Asia/Yangon","Asia/Yekaterinburg","Asia/Yerevan","Atlantic/Azores","Atlantic/Bermuda","Atlantic/Canary","Atlantic/Cape_Verde","Atlantic/Faroe","Atlantic/Madeira","Atlantic/Reykjavik","Atlantic/South_Georgia","Atlantic/St_Helena","Atlantic/Stanley","Australia/Adelaide","Australia/Brisbane","Australia/Broken_Hill","Australia/Currie","Australia/Darwin","Australia/Eucla","Australia/Hobart","Australia/Lindeman","Australia/Lord_Howe","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Andorra","Europe/Astrakhan","Europe/Athens","Europe/Belgrade","Europe/Berlin","Europe/Bratislava","Europe/Brussels","Europe/Bucharest","Europe/Budapest","Europe/Busingen","Europe/Chisinau","Europe/Copenhagen","Europe/Dublin","Europe/Gibraltar","Europe/Guernsey","Europe/Helsinki","Europe/Isle_of_Man","Europe/Istanbul","Europe/Jersey","Europe/Kaliningrad","Europe/Kiev","Europe/Kirov","Europe/Kyiv","Europe/Lisbon","Europe/Ljubljana","Europe/London","Europe/Luxembourg","Europe/Madrid","Europe/Malta","Europe/Mariehamn","Europe/Minsk","Europe/Monaco","Europe/Moscow","Europe/Oslo","Europe/Paris","Europe/Podgorica","Europe/Prague","Europe/Riga","Europe/Rome","Europe/Samara","Europe/San_Marino","Europe/Sarajevo","Europe/Saratov","Europe/Simferopol","Europe/Skopje","Europe/Sofia","Europe/Stockholm","Europe/Tallinn","Europe/Tirane","Europe/Ulyanovsk","Europe/Uzhgorod","Europe/Vaduz","Europe/Vatican","Europe/Vienna","Europe/Vilnius","Europe/Volgograd","Europe/Warsaw","Europe/Zagreb","Europe/Zaporozhye","Europe/Zurich","GMT","Indian/Antananarivo","Indian/Chagos","Indian/Christmas","Indian/Cocos","Indian/Comoro","Indian/Kerguelen","Indian/Mahe","Indian/Maldives","Indian/Mauritius","Indian/Mayotte","Indian/Reunion","Local","Pacific/Apia","Pacific/Auckland","Pacific/Bougainville","Pacific/Chatham","Pacific/Chuuk","Pacific/Easter","Pacific/Efate","Pacific/Enderbury","Pacific/Fakaofo","Pacific/Fiji","Pacific/Funafuti","Pacific/Galapagos","Pacific/Gambier","Pacific/Guadalcanal","Pacific/Guam","Pacific/Honolulu","Pacific/Johnston","Pacific/Kanton","Pacific/Kiritimati","Pacific/Kosrae","Pacific/Kwajalein","Pacific/Majuro","Pacific/Marquesas","Pacific/Midway","Pacific/Nauru","Pacific/Niue","Pacific/Norfolk","Pacific/Noumea","Pacific/Pago_Pago","Pacific/Palau","Pacific/Pitcairn","Pacific/Pohnpei","Pacific/Ponape","Pacific/Port_Moresby","Pacific/Rarotonga","Pacific/Saipan","Pacific/Tahiti","Pacific/Tarawa","Pacific/Tongatapu","Pacific/Truk","Pacific/Wake","Pacific/Wallis","UTC"],j=t=>{const d=I.map(o=>({label:o,value:o}));return(0,a.jsx)(b.l6,{...t,options:d})},p=()=>{const t=(0,x.of)(_),{formState:d,register:o,setValue:h}=(0,D.xW)(),{fields:C,append:F,remove:K}=(0,D.jz)({name:"time_intervals"}),{isGrafanaAlertmanager:B}=(0,P.VI)();return(0,a.jsx)(S.n,{label:(0,r.t)("alerting.mute-timing-time-interval.label-time-intervals","Time intervals"),children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:(0,a.jsx)(r.x6,{i18nKey:"alerting.mute-timing-time-interval.description",children:"A time interval item is a definition for a moment in time. All fields are lists, and at least one list element must be satisfied to match the field. If a field is left blank, any moment of time will match the field. For an instant of time to match a complete time interval, all fields must match. A time interval can contain multiple time interval items."})}),(0,a.jsx)(O.B,{direction:"column",gap:2,children:C.map((M,A)=>{const k=d.errors;return o(`time_intervals.${A}.location`),(0,a.jsxs)("div",{className:t.timeIntervalSection,children:[(0,a.jsx)(e,{intervalIndex:A}),(0,a.jsx)(v.D,{label:(0,r.t)("alerting.mute-timing-time-interval.label-location","Location"),invalid:!!k.time_intervals?.[A]?.location,error:k.time_intervals?.[A]?.location?.message,children:(0,a.jsx)(j,{prefix:(0,a.jsx)($.I,{name:"map-marker"}),width:50,onChange:N=>{h(`time_intervals.${A}.location`,N.value)},defaultValue:{label:M.location,value:M.location},"data-testid":"mute-timing-location"})}),(0,a.jsx)(v.D,{label:(0,r.t)("alerting.mute-timing-time-interval.label-days-of-the-week","Days of the week"),children:(0,a.jsx)(ua,{onChange:N=>{h(`time_intervals.${A}.weekdays`,N)},defaultValue:M.weekdays})}),(0,a.jsx)(v.D,{label:(0,r.t)("alerting.mute-timing-time-interval.label-days-of-the-month","Days of the month"),description:(0,r.t)("alerting.mute-timing-time-interval.description-dats-of-the-month","The days of the month, 1:31, of a month. Negative values can be used to represent days which begin at the end of the month"),invalid:!!k.time_intervals?.[A]?.days_of_month,error:k.time_intervals?.[A]?.days_of_month?.message,children:(0,a.jsx)(E.p,{...o(`time_intervals.${A}.days_of_month`,{validate:g}),width:50,defaultValue:M.days_of_month,placeholder:(0,r.t)("alerting.mute-timing-time-interval.mute-timing-days-placeholder-example","Example: 1, 14:16, -1"),"data-testid":"mute-timing-days"})}),(0,a.jsx)(v.D,{label:(0,r.t)("alerting.mute-timing-time-interval.label-months","Months"),description:(0,r.t)("alerting.mute-timing-time-interval.description-months","The months of the year in either numerical or the full calendar month"),invalid:!!k.time_intervals?.[A]?.months,error:k.time_intervals?.[A]?.months?.message,children:(0,a.jsx)(E.p,{...o(`time_intervals.${A}.months`,{validate:N=>(0,l.Ww)(N,f=>l.KR.includes(f)||parseInt(f,10)<13&&parseInt(f,10)>0,"Invalid month")}),width:50,placeholder:(0,r.t)("alerting.mute-timing-time-interval.mute-timing-months-placeholder-example-mayaugust-december","Example: 1:3, may:august, december"),defaultValue:M.months,"data-testid":"mute-timing-months"})}),(0,a.jsx)(v.D,{label:(0,r.t)("alerting.mute-timing-time-interval.label-years","Years"),invalid:!!k.time_intervals?.[A]?.years,error:k.time_intervals?.[A]?.years?.message??"",children:(0,a.jsx)(E.p,{...o(`time_intervals.${A}.years`,{validate:N=>(0,l.Ww)(N,f=>/^\d{4}$/.test(f),"Invalid year")}),width:50,placeholder:(0,r.t)("alerting.mute-timing-time-interval.mute-timing-years-placeholder-example","Example: 2021:2022, 2030"),defaultValue:M.years,"data-testid":"mute-timing-years"})}),(0,a.jsxs)(O.B,{direction:"row",gap:2,children:[(0,a.jsx)(n.$n,{type:"button",variant:"destructive",fill:"outline",icon:"trash-alt",onClick:()=>K(A),children:(0,a.jsx)(r.x6,{i18nKey:"alerting.mute-timing-time-interval.remove-time-interval",children:"Remove time interval"})}),!B&&(0,a.jsx)(z.K,{id:`time_intervals.${A}.disable`,label:(0,r.t)("alerting.mute-timing-time-interval.label-disable","Disable"),showLabel:!0,transparent:!0,...o(`time_intervals.${A}.disable`)})]})]},M.id)})}),(0,a.jsx)(n.$n,{type:"button",variant:"secondary",className:t.removeTimeIntervalButton,onClick:()=>{F(l.oU)},icon:"plus",children:(0,a.jsx)(r.x6,{i18nKey:"alerting.mute-timing-time-interval.add-another-time-interval-item",children:"Add another time interval item"})})]})})},c=t=>{const d=t.split(",").map(o=>o.trim()).flatMap(o=>o.includes(":")?ra(o):o).map(o=>o.toLowerCase()).filter(o=>l.jU.includes(o));return(0,L.uniq)(d)};function g(t){return(0,l.Ww)(t,d=>{if(!/^-?\d+$/.test(d))return!1;const o=parseInt(d,10);return o>-31&&o<0||o>0&&o<32},"Invalid day")}function ra(t){const[d="",o=""]=t.split(":"),h=l.jU.indexOf(d),C=l.jU.indexOf(o);return l.jU.slice(h,C+1)}const ua=({defaultValue:t="",onChange:d})=>{const o=(0,x.of)(_),h=c(t),[C,F]=(0,V.useState)(h),K=B=>{C.includes(B)?F(M=>(0,L.without)(M,B)):F(M=>(0,L.concat)(M,B))};return(0,V.useEffect)(()=>{d(C.join(", "))},[C,d]),(0,a.jsx)("div",{"data-testid":"mute-timing-weekdays",children:(0,a.jsx)(O.B,{gap:1,children:l.jU.map(B=>{const M=(0,T.cx)(o.dayOfTheWeek,C.includes(B)&&"selected"),A=B.slice(0,3);return(0,a.jsx)("button",{type:"button",className:M,onClick:()=>K(B),children:(0,L.upperFirst)(A)},B)})})})},_=t=>({input:(0,T.css)({width:"400px"}),timeIntervalSection:(0,T.css)({backgroundColor:t.colors.background.secondary,padding:t.spacing(2)}),removeTimeIntervalButton:(0,T.css)({marginTop:t.spacing(2)}),dayOfTheWeek:(0,T.css)({cursor:"pointer",userSelect:"none",padding:`${t.spacing(1)} ${t.spacing(3)}`,border:`solid 1px ${t.colors.border.medium}`,background:"none",borderRadius:t.shape.radius.default,color:t.colors.text.secondary,"&.selected":{fontWeight:t.typography.fontWeightBold,color:t.colors.primary.text,borderColor:t.colors.primary.border,background:t.colors.primary.transparent}})}),na=t=>{const d={name:"",time_intervals:[l.oU]};if(!t)return d;const o=t.time_intervals.map(h=>({times:h.times,weekdays:h.weekdays?.join(", "),days_of_month:h.days_of_month?.join(", "),months:h.months?.join(", "),years:h.years?.join(", "),location:h.location??l.oU.location,disable:(0,l.jb)(h)}));return{name:t.name,time_intervals:o}},da=({muteTiming:t,showError:d,loading:o,provisioned:h,editMode:C})=>{const{selectedAlertmanager:F}=(0,P.VI)(),K={alertmanager:F},[B]=(0,m.XW)(K),[M]=(0,m.SD)(K),A=(0,m.br)(K),k=(0,x.of)(Aa),N=na(t),f=(0,D.mN)({defaultValues:N,values:N}),G=f.formState.isSubmitting,Y=(0,y.nL)("/alerting/routes/",F,{tab:"time_intervals"}),sa=async q=>{const J=(0,l.iF)(q);return(async()=>C?M.execute({interval:J,originalName:t?.metadata?.name||t.name}):B.execute({interval:J}))().then(()=>{Q.Ny.push(Y)})};return o?(0,a.jsx)(R._,{text:(0,r.t)("alerting.time-interval-form.text-loading-time-interval","Loading time interval")}):d?(0,a.jsx)(w.F,{title:(0,r.t)("alerting.time-interval-form.title-no-matching-time-interval-found","No matching time interval found")}):(0,a.jsxs)(a.Fragment,{children:[h&&(0,a.jsx)(U.Yi,{resource:U.hk.MuteTiming}),(0,a.jsx)(D.Op,{...f,children:(0,a.jsx)("form",{onSubmit:f.handleSubmit(sa),"data-testid":"mute-timing-form",children:(0,a.jsxs)(S.n,{disabled:h||G,children:[(0,a.jsx)(v.D,{required:!0,label:(0,r.t)("alerting.mute-timing-form.label-name","Name"),description:(0,r.t)("alerting.time-interval-form.description-unique-time-interval","A unique name for the time interval"),invalid:!!f.formState.errors?.name,error:f.formState.errors.name?.message,children:(0,a.jsx)(E.p,{...f.register("name",{required:!0,validate:async q=>{const J=C&&q===t?.name;return A(q,J)}}),className:k.input,"data-testid":"mute-timing-name"})}),(0,a.jsx)(p,{}),(0,a.jsx)(n.$n,{type:"submit",className:k.submitButton,disabled:G,icon:G?"spinner":void 0,children:G?(0,a.jsx)(r.x6,{i18nKey:"alerting.time-interval.saving",children:"Saving time interval"}):(0,a.jsx)(r.x6,{i18nKey:"alerting.time-interval.save",children:"Save time interval"})}),(0,a.jsx)(n.z9,{type:"button",variant:"secondary",fill:"outline",href:Y,disabled:G,children:(0,a.jsx)(r.x6,{i18nKey:"alerting.common.cancel",children:"Cancel"})})]})})})]})},Aa=t=>({input:(0,T.css)({width:"400px"}),submitButton:(0,T.css)({marginRight:t.spacing(1)})}),ga=da},97539:(oa,H,i)=>{i.d(H,{KR:()=>r,Ww:()=>x,d6:()=>E,iF:()=>w,jU:()=>D,jb:()=>v,oU:()=>Q});var a=i(2543),T=i.n(a);const D=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],r=["january","february","march","april","may","june","july","august","september","october","november","december"],Q={times:[{start_time:"",end_time:""}],weekdays:"",days_of_month:"",months:"",years:"",location:"",disable:!1},x=(n,m,P)=>n?n.split(",").map(y=>y.trim()).every(y=>y.split(":").every(m))||P:!0,R=n=>n?n.split(",").map(m=>m.trim()):void 0,w=n=>{const m=n.time_intervals.map(({times:P,weekdays:y,days_of_month:l,months:U,years:L,location:V,disable:O})=>{const $={times:S(P,O),weekdays:R(y)?.map(z=>z.toLowerCase()),days_of_month:R(l),months:R(U),years:R(L),location:V||void 0};return(0,a.omitBy)($,a.isUndefined)});return{name:n.name,time_intervals:m}};function S(n,m){if(m)return[];const P=n?.filter(({start_time:y,end_time:l})=>!!y&&!!l);return P?.length?P:void 0}function v(n){return n.times?.length===0||n.weekdays?.length===0||n.days_of_month?.length===0||n.months?.length===0||n.years?.length===0}function E(n){return n.time_intervals.every(m=>v(m))}}}]);

//# sourceMappingURL=3192.2822b6c7441e6705cfc1.js.map