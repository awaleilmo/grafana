{"version":3,"file":"xychart.00fad3433af8e002a728.js","mappings":"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","sources":["webpack://grafana/./public/app/plugins/panel/status-history/utils.ts","webpack://grafana/./public/app/core/components/Layers/LayerName.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipHeader.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipContent.tsx","webpack://grafana/./public/app/plugins/panel/xychart/panelcfg.gen.ts","webpack://grafana/./public/app/plugins/panel/xychart/SeriesEditor.tsx","webpack://grafana/./public/app/plugins/panel/xychart/utils.ts","webpack://grafana/./public/app/plugins/panel/xychart/XYChartTooltip.tsx","webpack://grafana/./public/app/plugins/panel/xychart/scatter.ts","webpack://grafana/./public/app/plugins/panel/xychart/XYChartPanel.tsx","webpack://grafana/./public/app/plugins/panel/xychart/config.ts","webpack://grafana/./public/app/plugins/panel/xychart/panelcfgold.gen.ts","webpack://grafana/./public/app/plugins/panel/xychart/migrations.ts","webpack://grafana/./public/app/plugins/panel/xychart/module.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipColorIndicator.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipRow.tsx"],"sourcesContent":["import { DataFrame, ActionModel, Field, InterpolateFunction, LinkModel } from '@grafana/data';\nimport { getActions } from 'app/features/actions/utils';\n\nexport const getDataLinks = (field: Field, rowIdx: number) => {\n  const links: Array<LinkModel<Field>> = [];\n\n  if ((field.config.links?.length ?? 0) > 0 && field.getLinks != null) {\n    const v = field.values[rowIdx];\n    const disp = field.display ? field.display(v) : { text: `${v}`, numeric: +v };\n\n    const linkLookup = new Set<string>();\n\n    field.getLinks({ calculatedValue: disp, valueRowIndex: rowIdx }).forEach((link) => {\n      const key = `${link.title}/${link.href}`;\n      if (!linkLookup.has(key)) {\n        links.push(link);\n        linkLookup.add(key);\n      }\n    });\n  }\n\n  return links;\n};\n\nexport const getAllFrameActions = (dataFrame: DataFrame) => {};\n\nexport const getFieldActions = (\n  dataFrame: DataFrame,\n  field: Field,\n  replaceVars: InterpolateFunction,\n  rowIndex: number\n) => {\n  const actions: Array<ActionModel<Field>> = [];\n  const actionLookup = new Set<string>();\n\n  const actionsModel = getActions(dataFrame, field, field.state!.scopedVars!, replaceVars, field.config.actions ?? [], {\n    valueRowIndex: rowIndex,\n  });\n\n  actionsModel.forEach((action) => {\n    const key = `${action.title}`;\n    if (!actionLookup.has(key)) {\n      actions.push(action);\n      actionLookup.add(key);\n    }\n  });\n\n  return actions;\n};\n","import { css, cx } from '@emotion/css';\nimport { useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { Icon, Input, FieldValidationMessage, useStyles2 } from '@grafana/ui';\n\nexport interface LayerNameProps {\n  name: string;\n  onChange: (v: string) => void;\n  verifyLayerNameUniqueness?: (nameToCheck: string) => boolean;\n  overrideStyles?: boolean;\n}\n\nexport const LayerName = ({ name, onChange, verifyLayerNameUniqueness, overrideStyles }: LayerNameProps) => {\n  const styles = useStyles2(getStyles);\n\n  const [isEditing, setIsEditing] = useState<boolean>(false);\n  const [validationError, setValidationError] = useState<string | null>(null);\n\n  const onEditLayer = (event: React.SyntheticEvent) => {\n    setIsEditing(true);\n  };\n\n  const onEndEditName = (newName: string) => {\n    setIsEditing(false);\n\n    if (validationError) {\n      setValidationError(null);\n      return;\n    }\n\n    if (name !== newName) {\n      onChange(newName);\n    }\n  };\n\n  const onInputChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    const newName = event.currentTarget.value.trim();\n\n    if (newName.length === 0) {\n      setValidationError('An empty layer name is not allowed');\n      return;\n    }\n\n    if (verifyLayerNameUniqueness && !verifyLayerNameUniqueness(newName) && newName !== name) {\n      setValidationError('Layer name already exists');\n      return;\n    }\n\n    if (validationError) {\n      setValidationError(null);\n    }\n  };\n\n  const onEditLayerBlur = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    onEndEditName(event.currentTarget.value.trim());\n  };\n\n  const onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === 'Enter') {\n      onEndEditName(event.currentTarget.value);\n    }\n  };\n\n  const onFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n    event.target.select();\n  };\n\n  return (\n    <>\n      <div className={styles.wrapper}>\n        {!isEditing && (\n          <button\n            className={styles.layerNameWrapper}\n            title={t('layers.layer-name.edit-layer-title', 'Edit layer name')}\n            onClick={onEditLayer}\n            data-testid=\"layer-name-div\"\n          >\n            <span className={overrideStyles ? '' : styles.layerName}>{name}</span>\n            <Icon name=\"pen\" className={styles.layerEditIcon} size=\"sm\" />\n          </button>\n        )}\n\n        {isEditing && (\n          <>\n            <Input\n              type=\"text\"\n              defaultValue={name}\n              onBlur={onEditLayerBlur}\n              autoFocus\n              onKeyDown={onKeyDown}\n              onFocus={onFocus}\n              invalid={validationError !== null}\n              onChange={onInputChange}\n              className={styles.layerNameInput}\n              data-testid=\"layer-name-input\"\n            />\n            {validationError && <FieldValidationMessage horizontal>{validationError}</FieldValidationMessage>}\n          </>\n        )}\n      </div>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    wrapper: css({\n      label: 'Wrapper',\n      display: 'flex',\n      alignItems: 'center',\n      marginLeft: theme.spacing(0.5),\n    }),\n    layerNameWrapper: css({\n      display: 'flex',\n      cursor: 'pointer',\n      border: '1px solid transparent',\n      borderRadius: theme.shape.radius.default,\n      alignItems: 'center',\n      padding: `0 0 0 ${theme.spacing(0.5)}`,\n      margin: 0,\n      background: 'transparent',\n\n      '&:hover': {\n        background: theme.colors.action.hover,\n        border: `1px dashed ${theme.colors.border.strong}`,\n      },\n\n      '&:focus': {\n        border: `2px solid ${theme.colors.primary.border}`,\n      },\n\n      '&:hover, &:focus': {\n        '.query-name-edit-icon': {\n          visibility: 'visible',\n        },\n      },\n    }),\n    layerName: css({\n      fontWeight: theme.typography.fontWeightMedium,\n      color: theme.colors.primary.text,\n      cursor: 'pointer',\n      overflow: 'hidden',\n      marginLeft: theme.spacing(0.5),\n    }),\n    layerEditIcon: cx(\n      css({\n        marginLeft: theme.spacing(2),\n        visibility: 'hidden',\n      }),\n      'query-name-edit-icon'\n    ),\n    layerNameInput: css({\n      maxWidth: '300px',\n      margin: '-4px 0',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface Props {\n  item: VizTooltipItem;\n  isPinned: boolean;\n}\nexport const VizTooltipHeader = ({ item, isPinned }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const { label, value, color, colorIndicator } = item;\n\n  return (\n    <div className={styles.wrapper}>\n      <VizTooltipRow\n        label={label}\n        value={value}\n        color={color}\n        colorIndicator={colorIndicator}\n        marginRight={'22px'}\n        isPinned={isPinned}\n      />\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    padding: theme.spacing(1),\n    lineHeight: 1,\n  }),\n});\n","import { css } from '@emotion/css';\nimport { CSSProperties, ReactNode } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface VizTooltipContentProps {\n  items: VizTooltipItem[];\n  children?: ReactNode;\n  scrollable?: boolean;\n  isPinned: boolean;\n  maxHeight?: number;\n}\n\nexport const VizTooltipContent = ({\n  items,\n  children,\n  isPinned,\n  scrollable = false,\n  maxHeight,\n}: VizTooltipContentProps) => {\n  const styles = useStyles2(getStyles);\n\n  const scrollableStyle: CSSProperties = scrollable\n    ? {\n        maxHeight: maxHeight,\n        overflowY: 'auto',\n      }\n    : {};\n\n  return (\n    <div className={styles.wrapper} style={scrollableStyle}>\n      {items.map(({ label, value, color, colorIndicator, colorPlacement, isActive, lineStyle, isHiddenFromViz }, i) => (\n        <VizTooltipRow\n          key={i}\n          label={label}\n          value={value}\n          color={color}\n          colorIndicator={colorIndicator}\n          colorPlacement={colorPlacement}\n          isActive={isActive}\n          justify={'space-between'}\n          isPinned={isPinned}\n          lineStyle={lineStyle}\n          showValueScroll={!scrollable}\n          isHiddenFromViz={isHiddenFromViz}\n        />\n      ))}\n      {children}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    gap: 2,\n    borderTop: `1px solid ${theme.colors.border.weak}`,\n    padding: theme.spacing(1),\n  }),\n});\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\nexport enum PointShape {\n  Circle = 'circle',\n  Square = 'square',\n}\n\nexport enum SeriesMapping {\n  Auto = 'auto',\n  Manual = 'manual',\n}\n\nexport enum XYShowMode {\n  Lines = 'lines',\n  Points = 'points',\n  PointsAndLines = 'points+lines',\n}\n\n/**\n * NOTE: (copied from dashboard_kind.cue, since not exported)\n * Matcher is a predicate configuration. Based on the config a set of field(s) or values is filtered in order to apply override / transformation.\n * It comes with in id ( to resolve implementation from registry) and a configuration thatâ€™s specific to a particular matcher type.\n */\nexport interface MatcherConfig {\n  /**\n   * The matcher id. This is used to find the matcher implementation from registry.\n   */\n  id: string;\n  /**\n   * The matcher options. This is specific to the matcher implementation.\n   */\n  options?: unknown;\n}\n\nexport const defaultMatcherConfig: Partial<MatcherConfig> = {\n  id: '',\n};\n\nexport interface FieldConfig extends common.HideableFieldConfig, common.AxisConfig {\n  fillOpacity?: number;\n  lineStyle?: common.LineStyle;\n  lineWidth?: number;\n  pointShape?: PointShape;\n  pointSize?: {\n    fixed?: number;\n    min?: number;\n    max?: number;\n  };\n  pointStrokeWidth?: number;\n  show?: XYShowMode;\n}\n\nexport const defaultFieldConfig: Partial<FieldConfig> = {\n  fillOpacity: 50,\n  show: XYShowMode.Points,\n};\n\nexport interface XYSeriesConfig {\n  color?: {\n    matcher: MatcherConfig;\n  };\n  frame?: {\n    matcher: MatcherConfig;\n  };\n  name?: {\n    fixed?: string;\n  };\n  size?: {\n    matcher: MatcherConfig;\n  };\n  x?: {\n    matcher: MatcherConfig;\n  };\n  y?: {\n    matcher: MatcherConfig;\n  };\n}\n\nexport interface Options extends common.OptionsWithLegend, common.OptionsWithTooltip {\n  mapping: SeriesMapping;\n  series: Array<XYSeriesConfig>;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  series: [],\n};\n","import { css, cx } from '@emotion/css';\nimport { Fragment, useId, useState } from 'react';\nimport { usePrevious } from 'react-use';\n\nimport {\n  getFrameDisplayName,\n  StandardEditorProps,\n  // getFieldDisplayName,\n  FrameMatcherID,\n  FieldMatcherID,\n  FieldNamePickerBaseNameMode,\n  FieldType,\n  GrafanaTheme2,\n} from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { Button, Field, IconButton, Select, useStyles2 } from '@grafana/ui';\nimport { FieldNamePicker } from '@grafana/ui/internal';\nimport { LayerName } from 'app/core/components/Layers/LayerName';\n\nimport { Options, SeriesMapping, XYSeriesConfig } from './panelcfg.gen';\n\nexport const SeriesEditor = ({\n  value: seriesCfg,\n  onChange,\n  context,\n}: StandardEditorProps<XYSeriesConfig[], unknown, Options>) => {\n  const style = useStyles2(getStyles);\n\n  // reset opts when mapping changes (no way to do this in panel opts builder?)\n  const mapping = context.options?.mapping;\n  const prevMapping = usePrevious(mapping);\n  const mappingChanged = prevMapping != null && mapping !== prevMapping;\n\n  const defaultFrame = { frame: { matcher: { id: FrameMatcherID.byIndex, options: 0 } } };\n  const [selectedIdx, setSelectedIdx] = useState(0);\n\n  if (mappingChanged || seriesCfg == null) {\n    seriesCfg = [{ ...defaultFrame }];\n    onChange([...seriesCfg]);\n\n    if (selectedIdx > 0) {\n      setSelectedIdx(0);\n    }\n  }\n\n  const addSeries = () => {\n    seriesCfg = seriesCfg.concat({ ...defaultFrame });\n    setSelectedIdx(seriesCfg.length - 1);\n    onChange([...seriesCfg]);\n  };\n\n  const deleteSeries = (index: number) => {\n    seriesCfg = seriesCfg.filter((s, i) => i !== index);\n    setSelectedIdx(0);\n    onChange([...seriesCfg]);\n  };\n\n  const series = seriesCfg[selectedIdx];\n  const formKey = `${mapping}${selectedIdx}`;\n\n  const baseNameMode =\n    mapping === SeriesMapping.Manual\n      ? FieldNamePickerBaseNameMode.ExcludeBaseNames\n      : context.data.length === 1\n        ? FieldNamePickerBaseNameMode.IncludeAll\n        : FieldNamePickerBaseNameMode.OnlyBaseNames;\n\n  context.data.forEach((frame, frameIndex) => {\n    frame.fields.forEach((field, fieldIndex) => {\n      field.state = {\n        ...field.state,\n        origin: {\n          frameIndex,\n          fieldIndex,\n        },\n      };\n    });\n  });\n\n  const frameInputId = useId();\n  const xFieldInputId = useId();\n  const yFieldInputId = useId();\n  const sizeFieldInputId = useId();\n  const colorFieldInputId = useId();\n\n  return (\n    <>\n      {mapping === SeriesMapping.Manual && (\n        <>\n          <Button icon=\"plus\" size=\"sm\" variant=\"secondary\" onClick={addSeries} className={style.marginBot}>\n            <Trans i18nKey=\"xychart.series-editor.add-series\">Add series</Trans>\n          </Button>\n\n          <div className={style.marginBot}>\n            {seriesCfg.map((series, index) => {\n              return (\n                <div\n                  key={`series/${index}`}\n                  className={index === selectedIdx ? `${style.row} ${style.sel}` : style.row}\n                  onClick={() => setSelectedIdx(index)}\n                  role=\"button\"\n                  aria-label={t('xychart.series-editor.aria-label-select-series', 'Select series {{seriesNum}}', {\n                    seriesNum: index + 1,\n                  })}\n                  tabIndex={0}\n                  onKeyPress={(e) => {\n                    if (e.key === 'Enter') {\n                      setSelectedIdx(index);\n                    }\n                  }}\n                >\n                  <LayerName\n                    name={series.name?.fixed ?? `Series ${index + 1}`}\n                    onChange={(v) => {\n                      series.name = {\n                        fixed: v === '' || v === `Series ${index + 1}` ? undefined : v,\n                      };\n                      onChange([...seriesCfg]);\n                    }}\n                  />\n                  <IconButton\n                    name=\"trash-alt\"\n                    className={cx(style.actionIcon)}\n                    onClick={() => deleteSeries(index)}\n                    tooltip={t('xychart.series-editor.tooltip-delete-series', 'Delete series')}\n                  />\n                </div>\n              );\n            })}\n          </div>\n        </>\n      )}\n\n      {selectedIdx >= 0 && series != null && (\n        <Fragment key={formKey}>\n          <Field label={t('xychart.series-editor.label-frame', 'Frame')}>\n            <Select\n              inputId={frameInputId}\n              placeholder={\n                mapping === SeriesMapping.Auto\n                  ? t('xychart.series-editor.placeholder-all-frames', 'All frames')\n                  : t('xychart.series-editor.placeholder-select-frame', 'Select frame')\n              }\n              isClearable={true}\n              options={context.data.map((frame, index) => ({\n                value: index,\n                label: `${getFrameDisplayName(frame, index)} (index: ${index}, rows: ${frame.length})`,\n              }))}\n              value={series.frame?.matcher.options}\n              onChange={(opt) => {\n                if (opt == null) {\n                  delete series.frame;\n                } else {\n                  series.frame = {\n                    matcher: {\n                      id: FrameMatcherID.byIndex,\n                      options: Number(opt.value),\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-x-field', 'X field')}>\n            <FieldNamePicker\n              id={xFieldInputId}\n              value={series.x?.matcher.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.x;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.x = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'x',\n                name: 'x',\n                settings: {\n                  filter: (field) =>\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    (field.type === FieldType.number || field.type === FieldType.time) &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText:\n                    mapping === SeriesMapping.Auto\n                      ? t('xychart.series-editor.placeholder-x-field', 'First number or time field in each frame')\n                      : undefined,\n                },\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-y-field', 'Y field')}>\n            <FieldNamePicker\n              id={yFieldInputId}\n              value={series.y?.matcher?.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.y;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.y = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'y',\n                name: 'y',\n                settings: {\n                  // TODO: filter out series.y?.exclude.options, series.size.matcher.options, series.color.matcher.options\n                  filter: (field) =>\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    field.type === FieldType.number &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText:\n                    mapping === SeriesMapping.Auto\n                      ? t('xychart.series-editor.placeholder-y-field', 'Remaining number fields in each frame')\n                      : undefined,\n                },\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-size-field', 'Size field')}>\n            <FieldNamePicker\n              id={sizeFieldInputId}\n              value={series.size?.matcher?.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.size;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.size = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'size',\n                name: 'size',\n                settings: {\n                  // TODO: filter out series.y?.exclude.options, series.size.matcher.options, series.color.matcher.options\n                  filter: (field) =>\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    field.type === FieldType.number &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText: '',\n                },\n              }}\n            />\n          </Field>\n          <Field label={t('xychart.series-editor.label-color-field', 'Color field')}>\n            <FieldNamePicker\n              id={colorFieldInputId}\n              value={series.color?.matcher?.options as string}\n              context={context}\n              onChange={(fieldName) => {\n                if (fieldName == null) {\n                  delete series.color;\n                } else {\n                  // TODO: reset any other dim that was set to fieldName\n                  series.color = {\n                    matcher: {\n                      id: FieldMatcherID.byName,\n                      options: fieldName,\n                    },\n                  };\n                }\n\n                onChange([...seriesCfg]);\n              }}\n              item={{\n                id: 'color',\n                name: 'color',\n                settings: {\n                  // TODO: filter out series.y?.exclude.options, series.size.matcher.options, series.color.matcher.options\n                  filter: (field) =>\n                    (mapping === SeriesMapping.Auto ||\n                      field.state?.origin?.frameIndex === series.frame?.matcher.options) &&\n                    field.type === FieldType.number &&\n                    !field.config.custom?.hideFrom?.viz,\n                  baseNameMode,\n                  placeholderText: '',\n                },\n              }}\n            />\n          </Field>\n        </Fragment>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  marginBot: css({\n    marginBottom: '20px',\n  }),\n  row: css({\n    padding: `${theme.spacing(0.5, 1)}`,\n    borderRadius: `${theme.shape.radius.default}`,\n    background: `${theme.colors.background.secondary}`,\n    minHeight: `${theme.spacing(4)}`,\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    marginBottom: '3px',\n    cursor: 'pointer',\n\n    border: `1px solid ${theme.components.input.borderColor}`,\n    '&:hover': {\n      border: `1px solid ${theme.components.input.borderHover}`,\n    },\n  }),\n  sel: css({\n    border: `1px solid ${theme.colors.primary.border}`,\n    '&:hover': {\n      border: `1px solid ${theme.colors.primary.border}`,\n    },\n  }),\n  actionIcon: css({\n    color: `${theme.colors.text.secondary}`,\n    '&:hover': {\n      color: `${theme.colors.text}`,\n    },\n  }),\n});\n","import {\n  Field,\n  formattedValueToString,\n  getFieldMatcher,\n  FieldType,\n  getFieldDisplayName,\n  DataFrame,\n  FrameMatcherID,\n  MatcherConfig,\n  FieldColorModeId,\n  cacheFieldDisplayNames,\n  FieldMatcherID,\n  FieldConfigSource,\n} from '@grafana/data';\nimport { decoupleHideFromState } from '@grafana/data/internal';\nimport { config } from '@grafana/runtime';\nimport { VisibilityMode } from '@grafana/schema';\n\nimport { XYShowMode, SeriesMapping, XYSeriesConfig } from './panelcfg.gen';\nimport { XYSeries } from './types2';\n\nexport function fmt(field: Field, val: number): string {\n  if (field.display) {\n    return formattedValueToString(field.display(val));\n  }\n\n  return `${val}`;\n}\n\n// cause we dont have a proper matcher for this currently\nfunction getFrameMatcher2(config: MatcherConfig) {\n  if (config.id === FrameMatcherID.byIndex) {\n    return (frame: DataFrame, index: number) => index === config.options;\n  }\n\n  return () => false;\n}\n\nexport function prepSeries(\n  mapping: SeriesMapping,\n  mappedSeries: XYSeriesConfig[],\n  frames: DataFrame[],\n  fieldConfig: FieldConfigSource\n) {\n  cacheFieldDisplayNames(frames);\n  decoupleHideFromState(frames, fieldConfig);\n\n  let series: XYSeries[] = [];\n\n  if (mappedSeries.length === 0) {\n    mappedSeries = [{}];\n  }\n\n  const { palette, getColorByName } = config.theme2.visualization;\n\n  mappedSeries.forEach((seriesCfg, seriesIdx) => {\n    if (mapping === SeriesMapping.Manual) {\n      if (seriesCfg.frame?.matcher == null || seriesCfg.x?.matcher == null || seriesCfg.y?.matcher == null) {\n        return;\n      }\n    }\n\n    let xMatcher = getFieldMatcher(\n      seriesCfg.x?.matcher ?? {\n        id: FieldMatcherID.byType,\n        options: 'number',\n      }\n    );\n    let yMatcher = getFieldMatcher(\n      seriesCfg.y?.matcher ?? {\n        id: FieldMatcherID.byType,\n        options: 'number',\n      }\n    );\n    let colorMatcher = seriesCfg.color ? getFieldMatcher(seriesCfg.color.matcher) : null;\n    let sizeMatcher = seriesCfg.size ? getFieldMatcher(seriesCfg.size.matcher) : null;\n    // let frameMatcher = seriesCfg.frame ? getFrameMatchers(seriesCfg.frame) : null;\n    let frameMatcher = seriesCfg.frame ? getFrameMatcher2(seriesCfg.frame.matcher) : null;\n\n    // loop over all frames and fields, adding a new series for each y dim\n    frames.forEach((frame, frameIdx) => {\n      // must match frame in manual mode\n      if (frameMatcher != null && !frameMatcher(frame, frameIdx)) {\n        return;\n      }\n\n      // shared across each series in this frame\n      let restFields: Field[] = [];\n\n      let frameSeries: XYSeries[] = [];\n\n      let onlyNumTimeFields = frame.fields.filter(\n        (field) => field.type === FieldType.number || field.type === FieldType.time\n      );\n\n      // only one of these per frame\n      let x = onlyNumTimeFields.find((field) => xMatcher(field, frame, frames));\n\n      // only grabbing number fields (exclude time, string, enum, other)\n      let onlyNumFields = onlyNumTimeFields.filter((field) => field.type === FieldType.number);\n\n      let color = colorMatcher != null ? onlyNumFields.find((field) => colorMatcher(field, frame, frames)) : undefined;\n      let size = sizeMatcher != null ? onlyNumFields.find((field) => sizeMatcher(field, frame, frames)) : undefined;\n\n      // x field is required\n      if (x != null) {\n        // match y fields and create series\n        onlyNumFields.forEach((field) => {\n          if (field === x) {\n            return;\n          }\n\n          // in auto mode don't reuse already-mapped fields\n          if (mapping === SeriesMapping.Auto && (field === color || field === size)) {\n            return;\n          }\n\n          // in manual mode only add single series for this config\n          if (mapping === SeriesMapping.Manual && frameSeries.length > 0) {\n            return;\n          }\n\n          // if we match non-excluded y, create series\n          if (yMatcher(field, frame, frames) && !field.config.custom?.hideFrom?.viz) {\n            let y = field;\n            let name = seriesCfg.name?.fixed ?? getFieldDisplayName(y, frame, frames);\n\n            let ser: XYSeries = {\n              // these typically come from y field\n              name: {\n                value: name,\n              },\n\n              showPoints: y.config.custom.show === XYShowMode.Lines ? VisibilityMode.Never : VisibilityMode.Always,\n              pointShape: y.config.custom.pointShape,\n              pointStrokeWidth: y.config.custom.pointStrokeWidth,\n              fillOpacity: y.config.custom.fillOpacity,\n\n              showLine: y.config.custom.show !== XYShowMode.Points,\n              lineWidth: y.config.custom.lineWidth ?? 2,\n              lineStyle: y.config.custom.lineStyle,\n\n              x: {\n                field: x!,\n              },\n              y: {\n                field: y,\n              },\n              color: {},\n              size: {},\n              _rest: restFields,\n            };\n\n            if (color != null) {\n              ser.color.field = color;\n            }\n\n            if (size != null) {\n              ser.size.field = size;\n              ser.size.min = size.config.custom.pointSize?.min ?? 5;\n              ser.size.max = size.config.custom.pointSize?.max ?? 100;\n              // ser.size.mode =\n            }\n\n            frameSeries.push(ser);\n          }\n        });\n\n        if (frameSeries.length === 0) {\n          // TODO: could not create series, skip & show error?\n        }\n\n        // populate rest fields\n        frame.fields.forEach((field) => {\n          let isUsedField = frameSeries.some(\n            ({ x, y, color, size }) =>\n              x.field === field || y.field === field || color.field === field || size.field === field\n          );\n\n          if (!isUsedField) {\n            restFields.push(field);\n          }\n        });\n\n        series.push(...frameSeries);\n      } else {\n        // x is missing in this frame!\n      }\n    });\n  });\n\n  if (series.length === 0) {\n    // TODO: could not create series, skip & show error?\n  } else {\n    // assign classic palette colors by index, as fallbacks for all series\n\n    let paletteIdx = 0;\n\n    // todo: populate min, max, mode from field + hints\n    series.forEach((s, i) => {\n      if (s.color.field == null) {\n        // derive fixed color from y field config\n        let colorCfg = s.y.field.config.color ?? { mode: FieldColorModeId.PaletteClassic };\n\n        let value = '';\n\n        if (colorCfg.mode === FieldColorModeId.PaletteClassic) {\n          value = getColorByName(palette[paletteIdx++ % palette.length]); // todo: do this via state.seriesIdx and re-init displayProcessor\n        } else if (colorCfg.mode === FieldColorModeId.Fixed) {\n          value = getColorByName(colorCfg.fixedColor!);\n        }\n\n        s.color.fixed = value;\n      }\n\n      if (s.size.field == null) {\n        // derive fixed size from y field config\n        s.size.fixed = s.y.field.config.custom.pointSize?.fixed ?? 5;\n        // ser.size.mode =\n      }\n    });\n\n    autoNameSeries(series);\n\n    // TODO: re-assign y display names?\n    // y.state = {\n    //   ...y.state,\n    //   seriesIndex: series.length + ,\n    // };\n    // y.display = getDisplayProcessor({ field, theme });\n  }\n\n  return series;\n}\n\n// strip common prefixes and suffixes from y field names\nfunction autoNameSeries(series: XYSeries[]) {\n  let names = series.map((s) => s.name.value.split(/\\s+/g));\n\n  const { prefix, suffix } = findCommonPrefixSuffixLengths(names);\n\n  if (prefix < Infinity || suffix < Infinity) {\n    series.forEach((s, i) => {\n      s.name.value = names[i].slice(prefix, names[i].length - suffix).join(' ');\n    });\n  }\n}\n\nexport function getCommonPrefixSuffix(strs: string[]) {\n  let names = strs.map((s) => s.split(/\\s+/g));\n\n  let { prefix, suffix } = findCommonPrefixSuffixLengths(names);\n\n  let n = names[0];\n\n  if (n.length === 1 && prefix === 1 && suffix === 1) {\n    return '';\n  }\n\n  let parts = [];\n\n  if (prefix > 0) {\n    parts.push(...n.slice(0, prefix));\n  }\n\n  if (suffix > 0) {\n    parts.push(...n.slice(-suffix));\n  }\n\n  return parts.join(' ');\n}\n\n// lengths are in number of tokens (segments) in a phrase\nfunction findCommonPrefixSuffixLengths(names: string[][]) {\n  let commonPrefixLen = Infinity;\n  let commonSuffixLen = Infinity;\n\n  // if auto naming strategy, rename fields by stripping common prefixes and suffixes\n  let segs0: string[] = names[0];\n\n  for (let i = 1; i < names.length; i++) {\n    if (names[i].length < segs0.length) {\n      segs0 = names[i];\n    }\n  }\n\n  for (let i = 1; i < names.length; i++) {\n    let segs = names[i];\n\n    if (segs !== segs0) {\n      // prefixes\n      let preLen = 0;\n      for (let j = 0; j < segs0.length; j++) {\n        if (segs[j] === segs0[j]) {\n          preLen++;\n        } else {\n          break;\n        }\n      }\n\n      if (preLen < commonPrefixLen) {\n        commonPrefixLen = preLen;\n      }\n\n      // suffixes\n      let sufLen = 0;\n      for (let j = segs0.length - 1; j >= 0; j--) {\n        if (segs[j] === segs0[j]) {\n          sufLen++;\n        } else {\n          break;\n        }\n      }\n\n      if (sufLen < commonSuffixLen) {\n        commonSuffixLen = sufLen;\n      }\n    }\n  }\n\n  return {\n    prefix: commonPrefixLen,\n    suffix: commonSuffixLen,\n  };\n}\n","import { ReactNode } from 'react';\n\nimport { colorManipulator, DataFrame, Field, InterpolateFunction, LinkModel } from '@grafana/data';\nimport {\n  VizTooltipContent,\n  VizTooltipFooter,\n  VizTooltipHeader,\n  VizTooltipWrapper,\n  ColorIndicator,\n  VizTooltipItem,\n} from '@grafana/ui/internal';\n\nimport { getFieldActions } from '../status-history/utils';\n\nimport { XYSeries } from './types2';\nimport { fmt } from './utils';\n\nexport interface Props {\n  dataIdxs: Array<number | null>;\n  seriesIdx: number | null | undefined;\n  isPinned: boolean;\n  dismiss: () => void;\n  data: DataFrame[];\n  xySeries: XYSeries[];\n  replaceVariables: InterpolateFunction;\n  dataLinks: LinkModel[];\n  canExecuteActions?: boolean;\n}\n\nfunction stripSeriesName(fieldName: string, seriesName: string) {\n  if (fieldName !== seriesName && fieldName.includes(' ')) {\n    fieldName = fieldName.replace(seriesName, '').trim();\n  }\n\n  return fieldName;\n}\n\nfunction hideFromTooltip(field: Field) {\n  return field.config.custom.hideFrom?.tooltip ?? false;\n}\n\nfunction getFieldName(field: Field) {\n  return field.state?.displayName ?? field.name;\n}\n\nexport const XYChartTooltip = ({\n  dataIdxs,\n  seriesIdx,\n  data,\n  xySeries,\n  dismiss,\n  isPinned,\n  replaceVariables,\n  dataLinks,\n  canExecuteActions,\n}: Props) => {\n  const rowIndex = dataIdxs.find((idx) => idx !== null)!;\n\n  const series = xySeries[seriesIdx! - 1];\n  const xField = series.x.field;\n  const yField = series.y.field;\n\n  const sizeField = series.size.field;\n  const colorField = series.color.field;\n\n  let label = series.name.value;\n\n  let seriesColor = colorField?.display?.(colorField.values[rowIndex]).color ?? series.color.fixed ?? '#fff';\n  let fillOpacity = colorField?.config.custom?.fillOpacity;\n\n  // TODO: skip this if seriesColor already has an alpha component, such as opacity-by-value or opacity gradient schemes\n  if (fillOpacity != null) {\n    seriesColor = colorManipulator.alpha(seriesColor, fillOpacity / 100);\n  }\n\n  const headerItem: VizTooltipItem = {\n    label,\n    value: '',\n    color: seriesColor,\n    colorIndicator: ColorIndicator.marker_md,\n  };\n\n  const contentItems: VizTooltipItem[] = [];\n  const addedFields = new Set<Field>();\n\n  if (!hideFromTooltip(xField)) {\n    contentItems.push({\n      label: stripSeriesName(getFieldName(xField), label),\n      value: fmt(xField, xField.values[rowIndex]),\n    });\n    addedFields.add(xField);\n  }\n\n  if (!hideFromTooltip(yField)) {\n    contentItems.push({\n      label: stripSeriesName(getFieldName(yField), label),\n      value: fmt(yField, yField.values[rowIndex]),\n    });\n    addedFields.add(yField);\n  }\n\n  // mapped fields for size/color\n  if (sizeField != null && !addedFields.has(sizeField) && !hideFromTooltip(sizeField)) {\n    contentItems.push({\n      label: stripSeriesName(getFieldName(sizeField), label),\n      value: fmt(sizeField, sizeField.values[rowIndex]),\n    });\n    addedFields.add(sizeField);\n  }\n\n  if (colorField != null && !addedFields.has(colorField) && !hideFromTooltip(colorField)) {\n    contentItems.push({\n      label: stripSeriesName(getFieldName(colorField), label),\n      value: fmt(colorField, colorField.values[rowIndex]),\n    });\n    addedFields.add(colorField);\n  }\n\n  series._rest.forEach((field) => {\n    if (!hideFromTooltip(field)) {\n      contentItems.push({\n        label: stripSeriesName(field.state?.displayName ?? field.name, label),\n        value: fmt(field, field.values[rowIndex]),\n      });\n    }\n  });\n\n  let footer: ReactNode;\n\n  if (seriesIdx != null) {\n    const hasOneClickLink = dataLinks?.some((dataLink) => dataLink.oneClick === true);\n\n    if (isPinned || hasOneClickLink) {\n      const yFieldFrame = data.find((frame) => frame.fields.includes(yField))!;\n      const actions = canExecuteActions ? getFieldActions(yFieldFrame, yField, replaceVariables, rowIndex) : [];\n\n      footer = <VizTooltipFooter dataLinks={dataLinks} actions={actions} />;\n    }\n  }\n\n  return (\n    <VizTooltipWrapper>\n      <VizTooltipHeader item={headerItem} isPinned={isPinned} />\n      <VizTooltipContent items={contentItems} isPinned={isPinned} />\n      {footer}\n    </VizTooltipWrapper>\n  );\n};\n","import tinycolor from 'tinycolor2';\nimport uPlot from 'uplot';\n\nimport {\n  FALLBACK_COLOR,\n  Field,\n  FieldType,\n  formattedValueToString,\n  getFieldColorModeForField,\n  GrafanaTheme2,\n  MappingType,\n  SpecialValueMatch,\n  ThresholdsMode,\n  colorManipulator,\n} from '@grafana/data';\nimport { AxisPlacement, FieldColorModeId, ScaleDirection, ScaleOrientation, VisibilityMode } from '@grafana/schema';\nimport { UPlotConfigBuilder } from '@grafana/ui';\nimport { FacetedData, FacetSeries } from '@grafana/ui/internal';\n\nimport { pointWithin, Quadtree, Rect } from '../barchart/quadtree';\nimport { valuesToFills } from '../heatmap/utils';\n\nimport { PointShape } from './panelcfg.gen';\nimport { XYSeries } from './types2';\nimport { getCommonPrefixSuffix } from './utils';\n\ninterface DrawBubblesOpts {\n  each: (u: uPlot, seriesIdx: number, dataIdx: number, lft: number, top: number, wid: number, hgt: number) => void;\n  disp: {\n    //unit: 3,\n    size: {\n      values: (u: uPlot, seriesIdx: number) => number[];\n    };\n    color: {\n      values: (u: uPlot, seriesIdx: number) => string[];\n    };\n  };\n}\n\nexport const prepConfig = (xySeries: XYSeries[], theme: GrafanaTheme2) => {\n  if (xySeries.length === 0) {\n    return { builder: null, prepData: () => [] };\n  }\n\n  let qt: Quadtree;\n  let hRect: Rect | null;\n\n  function drawBubblesFactory(opts: DrawBubblesOpts) {\n    const drawBubbles: uPlot.Series.PathBuilder = (u, seriesIdx, idx0, idx1) => {\n      uPlot.orient(\n        u,\n        seriesIdx,\n        (\n          series,\n          dataX,\n          dataY,\n          scaleX,\n          scaleY,\n          valToPosX,\n          valToPosY,\n          xOff,\n          yOff,\n          xDim,\n          yDim,\n          moveTo,\n          lineTo,\n          rect,\n          arc\n        ) => {\n          const pxRatio = uPlot.pxRatio;\n          const scatterInfo = xySeries[seriesIdx - 1];\n          let d = u.data[seriesIdx] as unknown as FacetSeries;\n\n          // showLine: boolean;\n          // lineStyle: common.LineStyle;\n          // showPoints: common.VisibilityMode;\n\n          let showLine = scatterInfo.showLine;\n          let showPoints = scatterInfo.showPoints === VisibilityMode.Always;\n          let strokeWidth = scatterInfo.pointStrokeWidth ?? 0;\n\n          u.ctx.save();\n\n          u.ctx.rect(u.bbox.left, u.bbox.top, u.bbox.width, u.bbox.height);\n          u.ctx.clip();\n\n          let pointAlpha = scatterInfo.fillOpacity / 100;\n\n          u.ctx.fillStyle = colorManipulator.alpha((series.fill as any)(), pointAlpha);\n          u.ctx.strokeStyle = colorManipulator.alpha((series.stroke as any)(), 1);\n          u.ctx.lineWidth = strokeWidth;\n\n          let deg360 = 2 * Math.PI;\n\n          let xKey = scaleX.key!;\n          let yKey = scaleY.key!;\n\n          //const colorMode = getFieldColorModeForField(field); // isByValue\n          const pointSize = scatterInfo.y.field.config.custom.pointSize;\n          const colorByValue = scatterInfo.color.field != null; // && colorMode.isByValue;\n\n          let maxSize = (pointSize.max ?? pointSize.fixed) * pxRatio;\n\n          // todo: this depends on direction & orientation\n          // todo: calc once per redraw, not per path\n          let filtLft = u.posToVal(-maxSize / 2, xKey);\n          let filtRgt = u.posToVal(u.bbox.width / pxRatio + maxSize / 2, xKey);\n          let filtBtm = u.posToVal(u.bbox.height / pxRatio + maxSize / 2, yKey);\n          let filtTop = u.posToVal(-maxSize / 2, yKey);\n\n          let sizes = opts.disp.size.values(u, seriesIdx);\n          // let pointColors = opts.disp.color.values(u, seriesIdx);\n          let pointColors = dispColors[seriesIdx - 1].values; // idxs\n          let pointPalette = dispColors[seriesIdx - 1].index as Array<CanvasRenderingContext2D['fillStyle']>;\n          let paletteHasAlpha = dispColors[seriesIdx - 1].hasAlpha;\n\n          let isSquare = scatterInfo.pointShape === PointShape.Square;\n\n          let linePath: Path2D | null = showLine ? new Path2D() : null;\n\n          let curColorIdx = -1;\n\n          for (let i = 0; i < d[0].length; i++) {\n            let xVal = d[0][i];\n            let yVal = d[1][i];\n\n            if (xVal >= filtLft && xVal <= filtRgt && yVal >= filtBtm && yVal <= filtTop) {\n              let size = Math.round(sizes[i] * pxRatio);\n              let cx = valToPosX(xVal, scaleX, xDim, xOff);\n              let cy = valToPosY(yVal, scaleY, yDim, yOff);\n\n              if (showLine) {\n                linePath!.lineTo(cx, cy);\n              }\n\n              if (showPoints) {\n                if (colorByValue) {\n                  if (pointColors[i] !== curColorIdx) {\n                    curColorIdx = pointColors[i];\n                    let c = curColorIdx === -1 ? FALLBACK_COLOR : pointPalette[curColorIdx];\n                    u.ctx.fillStyle = paletteHasAlpha ? c : colorManipulator.alpha(c as string, pointAlpha);\n                    u.ctx.strokeStyle = colorManipulator.alpha(c as string, 1);\n                  }\n                }\n\n                if (isSquare) {\n                  let x = Math.round(cx - size / 2);\n                  let y = Math.round(cy - size / 2);\n\n                  if (colorByValue || pointAlpha > 0) {\n                    u.ctx.fillRect(x, y, size, size);\n                  }\n\n                  if (strokeWidth > 0) {\n                    u.ctx.strokeRect(x, y, size, size);\n                  }\n                } else {\n                  u.ctx.beginPath();\n                  u.ctx.arc(cx, cy, size / 2, 0, deg360);\n\n                  if (colorByValue || pointAlpha > 0) {\n                    u.ctx.fill();\n                  }\n\n                  if (strokeWidth > 0) {\n                    u.ctx.stroke();\n                  }\n                }\n\n                opts.each(\n                  u,\n                  seriesIdx,\n                  i,\n                  cx - size / 2 - strokeWidth / 2,\n                  cy - size / 2 - strokeWidth / 2,\n                  size + strokeWidth,\n                  size + strokeWidth\n                );\n              }\n            }\n          }\n\n          if (showLine) {\n            u.ctx.strokeStyle = scatterInfo.color.fixed!;\n            u.ctx.lineWidth = scatterInfo.lineWidth * pxRatio;\n\n            const { lineStyle } = scatterInfo;\n            if (lineStyle && lineStyle.fill !== 'solid') {\n              if (lineStyle.fill === 'dot') {\n                u.ctx.lineCap = 'round';\n              }\n              u.ctx.setLineDash(lineStyle.dash ?? [10, 10]);\n            }\n\n            u.ctx.stroke(linePath!);\n          }\n\n          u.ctx.restore();\n        }\n      );\n\n      return null;\n    };\n\n    return drawBubbles;\n  }\n\n  let drawBubbles = drawBubblesFactory({\n    disp: {\n      size: {\n        //unit: 3, // raw CSS pixels\n        values: (u, seriesIdx) => {\n          return u.data[seriesIdx][2] as any; // already contains final pixel geometry\n          //let [minValue, maxValue] = getSizeMinMax(u);\n          //return u.data[seriesIdx][2].map(v => getSize(v, minValue, maxValue));\n        },\n      },\n      color: {\n        // string values\n        values: (u, seriesIdx) => {\n          return u.data[seriesIdx][3] as any;\n        },\n      },\n    },\n    each: (u, seriesIdx, dataIdx, lft, top, wid, hgt) => {\n      // we get back raw canvas coords (included axes & padding). translate to the plotting area origin\n      lft -= u.bbox.left;\n      top -= u.bbox.top;\n      qt.add({ x: lft, y: top, w: wid, h: hgt, sidx: seriesIdx, didx: dataIdx });\n    },\n  });\n\n  const builder = new UPlotConfigBuilder();\n\n  builder.setCursor({\n    drag: { setScale: true },\n    dataIdx: (u, seriesIdx) => {\n      if (seriesIdx === 1) {\n        const pxRatio = uPlot.pxRatio;\n\n        hRect = null;\n\n        let dist = Infinity;\n        let cx = u.cursor.left! * pxRatio;\n        let cy = u.cursor.top! * pxRatio;\n\n        qt.get(cx, cy, 1, 1, (o) => {\n          if (pointWithin(cx, cy, o.x, o.y, o.x + o.w, o.y + o.h)) {\n            let ocx = o.x + o.w / 2;\n            let ocy = o.y + o.h / 2;\n\n            let dx = ocx - cx;\n            let dy = ocy - cy;\n\n            let d = Math.sqrt(dx ** 2 + dy ** 2);\n\n            // test against radius for actual hover\n            if (d <= o.w / 2) {\n              // only hover bbox with closest distance\n              if (d <= dist) {\n                dist = d;\n                hRect = o;\n              }\n            }\n          }\n        });\n      }\n\n      return hRect && seriesIdx === hRect.sidx ? hRect.didx : null;\n    },\n    points: {\n      size: (u, seriesIdx) => {\n        return hRect && seriesIdx === hRect.sidx ? hRect.w / uPlot.pxRatio : 0;\n      },\n      fill: (u, seriesIdx) => 'rgba(255,255,255,0.4)',\n    },\n  });\n\n  // clip hover points/bubbles to plotting area\n  builder.addHook('init', (u, r) => {\n    u.over.style.overflow = 'hidden';\n  });\n\n  builder.addHook('drawClear', (u) => {\n    qt = qt || new Quadtree(0, 0, u.bbox.width, u.bbox.height);\n\n    qt.clear();\n\n    // force-clear the path cache to cause drawBars() to rebuild new quadtree\n    u.series.forEach((s, i) => {\n      if (i > 0) {\n        // @ts-ignore\n        s._paths = null;\n      }\n    });\n  });\n\n  builder.setMode(2);\n\n  let xField = xySeries[0].x.field;\n  let xIsTime = xField.type === FieldType.time;\n\n  let fieldConfig = xField.config;\n  let customConfig = fieldConfig.custom;\n  let scaleDistr = customConfig?.scaleDistribution;\n\n  builder.addScale({\n    scaleKey: 'x',\n    isTime: xIsTime,\n    auto: true,\n    orientation: ScaleOrientation.Horizontal,\n    direction: ScaleDirection.Right,\n    distribution: scaleDistr?.type,\n    log: scaleDistr?.log,\n    linearThreshold: scaleDistr?.linearThreshold,\n    min: fieldConfig.min,\n    max: fieldConfig.max,\n    softMin: customConfig?.axisSoftMin,\n    softMax: customConfig?.axisSoftMax,\n    centeredZero: customConfig?.axisCenteredZero,\n    decimals: fieldConfig.decimals,\n    range: xIsTime ? (u, min, max) => [min, max] : undefined,\n  });\n\n  // why does this fall back to '' instead of null or undef?\n  let xAxisLabel = customConfig.axisLabel;\n\n  if (xAxisLabel == null || xAxisLabel === '') {\n    let dispNames = xySeries.map((s) => s.x.field.state?.displayName ?? '');\n\n    let xAxisAutoLabel =\n      xySeries.length === 1\n        ? (xField.state?.displayName ?? xField.name)\n        : new Set(dispNames).size === 1\n          ? dispNames[0]\n          : getCommonPrefixSuffix(dispNames);\n\n    if (xAxisAutoLabel !== '') {\n      xAxisLabel = xAxisAutoLabel;\n    }\n  }\n\n  builder.addAxis({\n    scaleKey: 'x',\n    isTime: xIsTime,\n    placement: customConfig?.axisPlacement !== AxisPlacement.Hidden ? AxisPlacement.Bottom : AxisPlacement.Hidden,\n    show: customConfig?.axisPlacement !== AxisPlacement.Hidden,\n    grid: { show: customConfig?.axisGridShow },\n    border: { show: customConfig?.axisBorderShow },\n    theme,\n    label: xAxisLabel,\n    formatValue: xIsTime ? undefined : (v, decimals) => formattedValueToString(xField.display!(v, decimals)),\n  });\n\n  xySeries.forEach((s, si) => {\n    let field = s.y.field;\n\n    const lineColor = s.color.fixed;\n    const pointColor = s.color.fixed;\n    //const lineColor = s.lineColor(frame);\n    //const lineWidth = s.lineWidth;\n\n    let scaleKey = field.config.unit ?? 'y';\n    let config = field.config;\n    let customConfig = config.custom;\n    let scaleDistr = customConfig?.scaleDistribution;\n\n    builder.addScale({\n      scaleKey,\n      orientation: ScaleOrientation.Vertical,\n      direction: ScaleDirection.Up,\n      distribution: scaleDistr?.type,\n      log: scaleDistr?.log,\n      linearThreshold: scaleDistr?.linearThreshold,\n      min: config.min,\n      max: config.max,\n      softMin: customConfig?.axisSoftMin,\n      softMax: customConfig?.axisSoftMax,\n      centeredZero: customConfig?.axisCenteredZero,\n      decimals: config.decimals,\n    });\n\n    // why does this fall back to '' instead of null or undef?\n    let yAxisLabel = customConfig.axisLabel;\n\n    if (yAxisLabel == null || yAxisLabel === '') {\n      let dispNames = xySeries.map((s) => s.y.field.state?.displayName ?? '');\n\n      let yAxisAutoLabel =\n        xySeries.length === 1\n          ? (field.state?.displayName ?? field.name)\n          : new Set(dispNames).size === 1\n            ? dispNames[0]\n            : getCommonPrefixSuffix(dispNames);\n\n      if (yAxisAutoLabel !== '') {\n        yAxisLabel = yAxisAutoLabel;\n      }\n    }\n\n    builder.addAxis({\n      scaleKey,\n      theme,\n      placement: customConfig?.axisPlacement === AxisPlacement.Auto ? AxisPlacement.Left : customConfig?.axisPlacement,\n      show: customConfig?.axisPlacement !== AxisPlacement.Hidden,\n      grid: { show: customConfig?.axisGridShow },\n      border: { show: customConfig?.axisBorderShow },\n      size: customConfig?.axisWidth,\n      // label: yAxisLabel == null || yAxisLabel === '' ? fieldDisplayName : yAxisLabel,\n      label: yAxisLabel,\n      formatValue: (v, decimals) => formattedValueToString(field.display!(v, decimals)),\n    });\n\n    builder.addSeries({\n      facets: [\n        {\n          scale: 'x',\n          auto: true,\n        },\n        {\n          scale: scaleKey,\n          auto: true,\n        },\n      ],\n      pathBuilder: drawBubbles, // drawBubbles({disp: {size: {values: () => }}})\n      theme,\n      scaleKey: '', // facets' scales used (above)\n      lineColor: colorManipulator.alpha(lineColor ?? '#ffff', 1),\n      fillColor: colorManipulator.alpha(pointColor ?? '#ffff', 0.5),\n      show: !field.state?.hideFrom?.viz,\n    });\n  });\n\n  const dispColors = xySeries.map((s): FieldColorValuesWithCache => {\n    const cfg: FieldColorValuesWithCache = {\n      index: [],\n      getAll: () => [],\n      getOne: () => -1,\n      // cache for renderer, refreshed in prepData()\n      values: [],\n      hasAlpha: false,\n    };\n\n    const f = s.color.field;\n\n    if (f != null) {\n      Object.assign(cfg, fieldValueColors(f, theme));\n      cfg.hasAlpha = cfg.index.some((v) => !(v as string).endsWith('ff'));\n    }\n\n    return cfg;\n  });\n\n  function prepData(xySeries: XYSeries[]): FacetedData {\n    // if (info.error || !data.length) {\n    //   return [null];\n    // }\n\n    const { size: sizeRange, color: colorRange } = getGlobalRanges(xySeries);\n\n    xySeries.forEach((s, i) => {\n      dispColors[i].values = dispColors[i].getAll(s.color.field?.values ?? [], colorRange.min, colorRange.max);\n    });\n\n    return [\n      null,\n      ...xySeries.map((s, idx) => {\n        let len = s.x.field.values.length;\n\n        let diams: number[];\n\n        if (s.size.field != null) {\n          let { min, max } = s.size;\n\n          // todo: this scaling should be in renderer from raw values (not by passing css pixel diams via data)\n          let minPx = min! ** 2;\n          let maxPx = max! ** 2;\n          // use quadratic size scaling in byValue modes\n          let pxRange = maxPx - minPx;\n\n          let vals = s.size.field.values;\n          let minVal = sizeRange.min;\n          let maxVal = sizeRange.max;\n          let valRange = maxVal - minVal;\n\n          diams = Array(len);\n\n          for (let i = 0; i < vals.length; i++) {\n            let val = vals[i];\n\n            let valPct = (val - minVal) / valRange;\n            let pxArea = minPx + valPct * pxRange;\n            diams[i] = pxArea ** 0.5;\n          }\n        } else {\n          diams = Array(len).fill(s.size.fixed!);\n        }\n\n        return [\n          s.x.field.values, // X\n          s.y.field.values, // Y\n          diams,\n          Array(len).fill(s.color.fixed!), // TODO: fails for by value\n        ];\n      }),\n    ];\n  }\n\n  return { builder, prepData };\n};\n\nexport type PrepData = (xySeries: XYSeries[]) => FacetedData;\n\nconst getGlobalRanges = (xySeries: XYSeries[]) => {\n  const ranges = {\n    size: {\n      min: Infinity,\n      max: -Infinity,\n    },\n    color: {\n      min: Infinity,\n      max: -Infinity,\n    },\n  };\n\n  xySeries.forEach((series) => {\n    [series.size, series.color].forEach((facet, fi) => {\n      if (facet.field != null) {\n        let range = fi === 0 ? ranges.size : ranges.color;\n\n        const vals = facet.field.values;\n\n        for (let i = 0; i < vals.length; i++) {\n          const v = vals[i];\n\n          if (v != null) {\n            if (v < range.min) {\n              range.min = v;\n            }\n\n            if (v > range.max) {\n              range.max = v;\n            }\n          }\n        }\n      }\n    });\n  });\n\n  return ranges;\n};\n\nfunction getHex8Color(color: string, theme: GrafanaTheme2) {\n  return tinycolor(theme.visualization.getColorByName(color)).toHex8String();\n}\n\ninterface FieldColorValues {\n  index: unknown[];\n  getOne: GetOneValue;\n  getAll: GetAllValues;\n}\ninterface FieldColorValuesWithCache extends FieldColorValues {\n  values: number[];\n  hasAlpha: boolean;\n}\ntype GetAllValues = (values: unknown[], min?: number, max?: number) => number[];\ntype GetOneValue = (value: unknown, min?: number, max?: number) => number;\n\n/** compiler for values to palette color idxs (from thresholds, mappings, by-value gradients) */\nfunction fieldValueColors(f: Field, theme: GrafanaTheme2): FieldColorValues {\n  let index: unknown[] = [];\n  let getAll: GetAllValues = () => [];\n  let getOne: GetOneValue = () => -1;\n\n  let conds = '';\n\n  // if any mappings exist, use them regardless of other settings\n  if (f.config.mappings?.length ?? 0 > 0) {\n    let mappings = f.config.mappings!;\n\n    for (let i = 0; i < mappings.length; i++) {\n      let m = mappings[i];\n\n      if (m.type === MappingType.ValueToText) {\n        for (let k in m.options) {\n          let { color } = m.options[k];\n\n          if (color != null) {\n            let rhs = f.type === FieldType.string ? JSON.stringify(k) : Number(k);\n            conds += `v === ${rhs} ? ${index.length} : `;\n            index.push(getHex8Color(color, theme));\n          }\n        }\n      } else if (m.options.result.color != null) {\n        let { color } = m.options.result;\n\n        if (m.type === MappingType.RangeToText) {\n          let range = [];\n\n          if (m.options.from != null) {\n            range.push(`v >= ${Number(m.options.from)}`);\n          }\n\n          if (m.options.to != null) {\n            range.push(`v <= ${Number(m.options.to)}`);\n          }\n\n          if (range.length > 0) {\n            conds += `${range.join(' && ')} ? ${index.length} : `;\n            index.push(getHex8Color(color, theme));\n          }\n        } else if (m.type === MappingType.SpecialValue) {\n          let spl = m.options.match;\n\n          if (spl === SpecialValueMatch.NaN) {\n            conds += `isNaN(v)`;\n          } else if (spl === SpecialValueMatch.NullAndNaN) {\n            conds += `v == null || isNaN(v)`;\n          } else {\n            conds += `v ${\n              spl === SpecialValueMatch.True\n                ? '=== true'\n                : spl === SpecialValueMatch.False\n                  ? '=== false'\n                  : spl === SpecialValueMatch.Null\n                    ? '== null'\n                    : spl === SpecialValueMatch.Empty\n                      ? '=== \"\"'\n                      : '== null'\n            }`;\n          }\n\n          conds += ` ? ${index.length} : `;\n          index.push(getHex8Color(color, theme));\n        } else if (m.type === MappingType.RegexToText) {\n          // TODO\n        }\n      }\n    }\n\n    conds += '-1'; // ?? what default here? null? FALLBACK_COLOR?\n  } else if (f.config.color?.mode === FieldColorModeId.Thresholds) {\n    if (f.config.thresholds?.mode === ThresholdsMode.Absolute) {\n      let steps = f.config.thresholds.steps;\n      let lasti = steps.length - 1;\n\n      for (let i = lasti; i > 0; i--) {\n        let rhs = Number(steps[i].value);\n        conds += `v >= ${rhs} ? ${i} : `;\n      }\n\n      conds += '0';\n\n      index = steps.map((s) => getHex8Color(s.color, theme));\n    } else {\n      // TODO: percent thresholds?\n    }\n  } else if (f.config.color?.mode?.startsWith('continuous')) {\n    let calc = getFieldColorModeForField(f).getCalculator(f, theme);\n\n    index = Array(32);\n\n    for (let i = 0; i < index.length; i++) {\n      let pct = i / (index.length - 1);\n      index[i] = getHex8Color(calc(pct, pct), theme);\n    }\n\n    getAll = (vals, min, max) => valuesToFills(vals as number[], index as string[], min!, max!);\n  }\n\n  if (conds !== '') {\n    getOne = new Function('v', `return ${conds};`) as GetOneValue;\n\n    getAll = new Function(\n      'vals',\n      `\n      let idxs = Array(vals.length);\n\n      for (let i = 0; i < vals.length; i++) {\n        let v = vals[i];\n        idxs[i] = ${conds};\n      }\n\n      return idxs;\n    `\n    ) as GetAllValues;\n  }\n\n  return {\n    index,\n    getOne,\n    getAll,\n  };\n}\n","import { css } from '@emotion/css';\nimport { useMemo } from 'react';\n\nimport { colorManipulator, FALLBACK_COLOR, PanelProps } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport {\n  TooltipDisplayMode,\n  TooltipPlugin2,\n  UPlotChart,\n  VizLayout,\n  VizLegend,\n  VizLegendItem,\n  useStyles2,\n  useTheme2,\n  usePanelContext,\n} from '@grafana/ui';\nimport { getDisplayValuesForCalcs, TooltipHoverMode } from '@grafana/ui/internal';\n\nimport { getDataLinks } from '../status-history/utils';\n\nimport { XYChartTooltip } from './XYChartTooltip';\nimport { Options } from './panelcfg.gen';\nimport { prepConfig } from './scatter';\nimport { prepSeries } from './utils';\n\ntype Props2 = PanelProps<Options>;\n\nexport const XYChartPanel2 = (props: Props2) => {\n  const styles = useStyles2(getStyles);\n  const theme = useTheme2();\n\n  const { canExecuteActions } = usePanelContext();\n  const userCanExecuteActions = useMemo(() => canExecuteActions?.() ?? false, [canExecuteActions]);\n\n  let { mapping, series: mappedSeries } = props.options;\n\n  // regenerate series schema when mappings or data changes\n  let series = useMemo(\n    () => prepSeries(mapping, mappedSeries, props.data.series, props.fieldConfig),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [mapping, mappedSeries, props.data.series, props.fieldConfig]\n  );\n\n  // if series changed due to mappings or data structure, re-init config & renderers\n  let { builder, prepData } = useMemo(\n    () => prepConfig(series, config.theme2),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [mapping, mappedSeries, props.data.structureRev, props.fieldConfig, props.options.tooltip]\n  );\n\n  // generate data struct for uPlot mode: 2\n  let data = useMemo(\n    () => prepData(series),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [series]\n  );\n\n  // todo: handle errors\n  let error = builder == null || data.length === 0 ? 'Err' : '';\n\n  // TODO: React.memo()\n  const renderLegend = () => {\n    if (!props.options.legend.showLegend) {\n      return null;\n    }\n\n    const items: VizLegendItem[] = [];\n\n    series.forEach((s, idx) => {\n      let yField = s.y.field;\n      let config = yField.config;\n      let custom = config.custom;\n\n      if (!custom.hideFrom?.legend) {\n        items.push({\n          yAxis: 1, // TODO: pull from y field\n          label: s.name.value,\n          color: colorManipulator.alpha(s.color.fixed ?? FALLBACK_COLOR, 1),\n          getItemKey: () => `${idx}-${s.name.value}`,\n          fieldName: yField.state?.displayName ?? yField.name,\n          disabled: yField.state?.hideFrom?.viz ?? false,\n          getDisplayValues: () => getDisplayValuesForCalcs(props.options.legend.calcs, yField, theme),\n        });\n      }\n    });\n\n    const { placement, displayMode, width, sortBy, sortDesc } = props.options.legend;\n\n    return (\n      <VizLayout.Legend placement={placement} width={width}>\n        <VizLegend\n          className={styles.legend}\n          placement={placement}\n          items={items}\n          displayMode={displayMode}\n          sortBy={sortBy}\n          sortDesc={sortDesc}\n          isSortable={true}\n        />\n      </VizLayout.Legend>\n    );\n  };\n\n  if (error) {\n    return (\n      <div className=\"panel-empty\">\n        <p>{error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <VizLayout width={props.width} height={props.height} legend={renderLegend()}>\n      {(vizWidth: number, vizHeight: number) => (\n        <UPlotChart config={builder!} data={data} width={vizWidth} height={vizHeight}>\n          {props.options.tooltip.mode !== TooltipDisplayMode.None && (\n            <TooltipPlugin2\n              config={builder!}\n              hoverMode={TooltipHoverMode.xyOne}\n              getDataLinks={(seriesIdx, dataIdx) => {\n                const xySeries = series[seriesIdx - 1];\n                return getDataLinks(xySeries.y.field, dataIdx);\n              }}\n              render={(u, dataIdxs, seriesIdx, isPinned, dismiss, timeRange2, viaSync, dataLinks) => {\n                return (\n                  <XYChartTooltip\n                    data={props.data.series}\n                    dataIdxs={dataIdxs}\n                    xySeries={series}\n                    dismiss={dismiss}\n                    isPinned={isPinned}\n                    seriesIdx={seriesIdx!}\n                    replaceVariables={props.replaceVariables}\n                    dataLinks={dataLinks}\n                    canExecuteActions={userCanExecuteActions}\n                  />\n                );\n              }}\n              maxWidth={props.options.tooltip.maxWidth}\n            />\n          )}\n        </UPlotChart>\n      )}\n    </VizLayout>\n  );\n};\n\nconst getStyles = () => ({\n  legend: css({\n    div: {\n      justifyContent: 'flex-start',\n    },\n  }),\n});\n","import {\n  FieldColorModeId,\n  FieldConfigProperty,\n  FieldType,\n  identityOverrideProcessor,\n  SetFieldConfigOptionsArgs,\n} from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { LineStyle } from '@grafana/schema';\nimport { commonOptionsBuilder } from '@grafana/ui';\n\nimport { LineStyleEditor } from '../timeseries/LineStyleEditor';\n\nimport { FieldConfig, XYShowMode, PointShape } from './panelcfg.gen';\n\nexport const DEFAULT_POINT_SIZE = 5;\n\nexport function getScatterFieldConfig(cfg: FieldConfig): SetFieldConfigOptionsArgs<FieldConfig> {\n  return {\n    standardOptions: {\n      [FieldConfigProperty.Min]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.Max]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.Unit]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.Decimals]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.NoValue]: {\n        hideFromDefaults: true,\n      },\n      [FieldConfigProperty.DisplayName]: {\n        hideFromDefaults: true,\n      },\n      // TODO: this still leaves Color series by: [ Last | Min | Max ]\n      // because item.settings?.bySeriesSupport && colorMode.isByValue\n      [FieldConfigProperty.Color]: {\n        settings: {\n          byValueSupport: true,\n          bySeriesSupport: true,\n          preferThresholdsMode: false,\n        },\n        defaultValue: {\n          mode: FieldColorModeId.PaletteClassic,\n        },\n      },\n      [FieldConfigProperty.Links]: {\n        settings: {\n          showOneClick: true,\n        },\n      },\n      [FieldConfigProperty.Actions]: {\n        hideFromDefaults: false,\n      },\n    },\n\n    useCustomConfig: (builder) => {\n      const category = [t('xychart.category-xychart', 'XY Chart')];\n      builder\n        .addRadio({\n          path: 'show',\n          name: t('xychart.name-show', 'Show'),\n          category,\n          defaultValue: cfg.show,\n          settings: {\n            options: [\n              { label: t('xychart.show-options.label-points', 'Points'), value: XYShowMode.Points },\n              { label: t('xychart.show-options.label-lines', 'Lines'), value: XYShowMode.Lines },\n              { label: t('xychart.show-options.label-both', 'Both'), value: XYShowMode.PointsAndLines },\n            ],\n          },\n        })\n        // .addGenericEditor(\n        //   {\n        //     path: 'pointSymbol',\n        //     name: 'Point symbol',\n        //     defaultValue: defaultFieldConfig.pointSymbol ?? {\n        //       mode: 'fixed',\n        //       fixed: 'img/icons/marker/circle.svg',\n        //     },\n        //     settings: {\n        //       resourceType: MediaType.Icon,\n        //       folderName: ResourceFolderName.Marker,\n        //       placeholderText: 'Select a symbol',\n        //       placeholderValue: 'img/icons/marker/circle.svg',\n        //       showSourceRadio: false,\n        //     },\n        //     showIf: (c) => c.show !== ScatterShow.Lines,\n        //   },\n        //   SymbolEditor // ResourceDimensionEditor\n        // )\n        .addSliderInput({\n          path: 'pointSize.fixed',\n          name: t('xychart.name-point-size', 'Point size'),\n          category,\n          defaultValue: cfg.pointSize?.fixed ?? DEFAULT_POINT_SIZE,\n          settings: {\n            min: 1,\n            max: 100,\n            step: 1,\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addNumberInput({\n          path: 'pointSize.min',\n          name: t('xychart.name-min-point-size', 'Min point size'),\n          category,\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addNumberInput({\n          path: 'pointSize.max',\n          name: t('xychart.name-max-point-size', 'Max point size'),\n          category,\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addRadio({\n          path: 'pointShape',\n          name: t('xychart.name-point-shape', 'Point shape'),\n          category,\n          defaultValue: PointShape.Circle,\n          settings: {\n            options: [\n              { value: PointShape.Circle, label: t('xychart.point-shape-options.label-circle', 'Circle') },\n              { value: PointShape.Square, label: t('xychart.point-shape-options.label-square', 'Square') },\n            ],\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addSliderInput({\n          path: 'pointStrokeWidth',\n          name: t('xychart.name-point-stroke-width', 'Point stroke width'),\n          category,\n          defaultValue: 1,\n          settings: {\n            min: 0,\n            max: 10,\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addSliderInput({\n          path: 'fillOpacity',\n          name: t('xychart.name-fill-opacity', 'Fill opacity'),\n          category,\n          defaultValue: 50,\n          settings: {\n            min: 0,\n            max: 100,\n            step: 1,\n          },\n          showIf: (c) => c.show !== XYShowMode.Lines,\n        })\n        .addCustomEditor<void, LineStyle>({\n          id: 'lineStyle',\n          path: 'lineStyle',\n          name: t('xychart.name-line-style', 'Line style'),\n          category,\n          showIf: (c) => c.show !== XYShowMode.Points,\n          editor: LineStyleEditor,\n          override: LineStyleEditor,\n          process: identityOverrideProcessor,\n          shouldApply: (f) => f.type === FieldType.number,\n        })\n        .addSliderInput({\n          path: 'lineWidth',\n          name: t('xychart.name-line-width', 'Line width'),\n          category,\n          defaultValue: cfg.lineWidth,\n          settings: {\n            min: 0,\n            max: 10,\n            step: 1,\n          },\n          showIf: (c) => c.show !== XYShowMode.Points,\n        });\n\n      commonOptionsBuilder.addAxisConfig(builder, cfg);\n      commonOptionsBuilder.addHideFrom(builder);\n    },\n  };\n}\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\n/**\n * Auto is \"table\" in the UI\n */\nexport enum SeriesMapping {\n  Auto = 'auto',\n  Manual = 'manual',\n}\n\nexport enum ScatterShow {\n  Lines = 'lines',\n  Points = 'points',\n  PointsAndLines = 'points+lines',\n}\n\n/**\n * Configuration for the Table/Auto mode\n */\nexport interface XYDimensionConfig {\n  exclude?: Array<string>;\n  frame: number;\n  x?: string;\n}\n\nexport const defaultXYDimensionConfig: Partial<XYDimensionConfig> = {\n  exclude: [],\n};\n\nexport interface FieldConfig extends common.HideableFieldConfig, common.AxisConfig {\n  label?: common.VisibilityMode;\n  labelValue?: common.TextDimensionConfig;\n  lineColor?: common.ColorDimensionConfig;\n  lineStyle?: common.LineStyle;\n  lineWidth?: number;\n  pointColor?: common.ColorDimensionConfig;\n  pointSize?: common.ScaleDimensionConfig;\n  show?: ScatterShow;\n}\n\nexport const defaultFieldConfig: Partial<FieldConfig> = {\n  label: common.VisibilityMode.Auto,\n  show: ScatterShow.Points,\n};\n\nexport interface ScatterSeriesConfig extends FieldConfig {\n  frame?: number;\n  name?: string;\n  x?: string;\n  y?: string;\n}\n\nexport interface Options extends common.OptionsWithLegend, common.OptionsWithTooltip {\n  /**\n   * Table Mode (auto)\n   */\n  dims: XYDimensionConfig;\n  /**\n   * Manual Mode\n   */\n  series: Array<ScatterSeriesConfig>;\n  seriesMapping?: SeriesMapping;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  series: [],\n};\n","import { FieldMatcherID, FrameMatcherID, MatcherConfig, PanelModel } from '@grafana/data';\n\nimport { XYSeriesConfig, Options } from './panelcfg.gen';\nimport { ScatterSeriesConfig, SeriesMapping, XYDimensionConfig, Options as PrevOptions } from './panelcfgold.gen';\n\nexport const xyChartMigrationHandler = (panel: PanelModel): Options => {\n  const pluginVersion = panel?.pluginVersion ?? '';\n\n  if (pluginVersion === '' || parseFloat(pluginVersion) < 11.1) {\n    return migrateOptions(panel);\n  }\n\n  return panel.options;\n};\n\nfunction migrateOptions(panel: PanelModel): Options {\n  const { dims, seriesMapping, series: oldSeries, ...cleanedOpts } = panel.options as PrevOptions;\n  const { exclude = [], frame: frameShared, x: xShared }: XYDimensionConfig = dims ?? {};\n\n  const custDefaults = panel.fieldConfig.defaults.custom;\n\n  let oldSeries2 = oldSeries;\n\n  if (seriesMapping === SeriesMapping.Auto) {\n    oldSeries2 = [\n      {\n        x: undefined,\n        y: undefined,\n      },\n    ];\n  }\n\n  /*\n  // old manual mode example\n  \"series\": [\n    {\n      \"pointColor\": {\n        \"fixed\": \"purple\"       // this becomes override for y field.config.custom.pointColor.fixed, (or config.color?)\n        \"field\": \"BMI Male\",    // ...unless another field is mapped, then ignore\n      },\n      \"pointSize\": {\n        \"field\": \"Weight Male\",\n        \"max\": 40,              // this becomes override for y field.config.custom.pointSize.max\n        \"min\": 1,               // ...and .min\n        \"fixed\": 50.5\n      },\n      \"frame\": 0,               // byIndex frame matcher\n      \"x\": \"Height Male\",       // byName field matcher, falls back to byType/number field matcher\n      \"y\": \"Weight Male\"        // byName field matcher, falls back to byType/number field matcher\n    }\n  ],\n*/\n  let i = 0;\n\n  const newSeries: XYSeriesConfig[] = oldSeries2.map(({ x, y, pointColor, pointSize, frame }: ScatterSeriesConfig) => {\n    const { fixed: colorFixed, field: colorField } = pointColor ?? {};\n    const { fixed: sizeFixed, field: sizeField, min: sizeMin, max: sizeMax } = pointSize ?? {};\n\n    let xMatcherConfig: MatcherConfig;\n    let yMatcherConfig: MatcherConfig;\n\n    // old auto mode did not require x field defined\n    if (x == null && xShared == null) {\n      // TODO: this should just be the internal default. no need to store on save model\n      xMatcherConfig = {\n        id: FieldMatcherID.byType,\n        options: 'number',\n      };\n    } else {\n      xMatcherConfig = {\n        id: FieldMatcherID.byName,\n        options: x ?? xShared,\n      };\n    }\n\n    if (y == null) {\n      // TODO: this should just be the internal default. no need to store on save model\n      yMatcherConfig = {\n        id: FieldMatcherID.byType,\n        options: 'number',\n      };\n    } else {\n      yMatcherConfig = {\n        id: FieldMatcherID.byName,\n        options: y,\n      };\n    }\n\n    if (colorField == null && colorFixed && custDefaults.pointColor?.fixed !== colorFixed) {\n      // NOTE: intentionally not using custom.pointColor.fixed\n      let hasOverride = panel.fieldConfig.overrides.some(\n        (o) =>\n          o.matcher.id === yMatcherConfig.id &&\n          o.matcher.options === yMatcherConfig.options &&\n          o.properties.some((p) => p.id === 'color')\n      );\n\n      if (!hasOverride) {\n        panel.fieldConfig.overrides.push({\n          matcher: yMatcherConfig,\n          properties: [\n            {\n              id: 'color',\n              value: {\n                mode: 'fixed',\n                fixedColor: colorFixed,\n              },\n            },\n          ],\n        });\n      }\n    }\n\n    // add field overrides for custom pointSize.fixed\n    if (sizeField == null && sizeFixed && custDefaults.pointSize?.fixed !== sizeFixed) {\n      let hasOverride = panel.fieldConfig.overrides.some(\n        (o) =>\n          o.matcher.id === yMatcherConfig.id &&\n          o.matcher.options === yMatcherConfig.options &&\n          o.properties.some((p) => p.id === 'custom.pointSize.fixed')\n      );\n\n      if (!hasOverride) {\n        panel.fieldConfig.overrides.push({\n          matcher: yMatcherConfig,\n          properties: [\n            {\n              id: 'custom.pointSize.fixed',\n              value: sizeFixed,\n            },\n          ],\n        });\n      }\n    }\n\n    if (sizeField != null) {\n      // add field overrides for custom pointSize.min\n      if (sizeMin && custDefaults.pointSize?.min !== sizeMin) {\n        let hasOverride = panel.fieldConfig.overrides.some(\n          (o) =>\n            o.matcher.id === yMatcherConfig.id &&\n            o.matcher.options === yMatcherConfig.options &&\n            o.properties.some((p) => p.id === 'custom.pointSize.min')\n        );\n\n        if (!hasOverride) {\n          panel.fieldConfig.overrides.push({\n            matcher: {\n              id: FieldMatcherID.byName,\n              options: sizeField,\n            },\n            properties: [\n              {\n                id: 'custom.pointSize.min',\n                value: sizeMin,\n              },\n            ],\n          });\n        }\n      }\n      // add field overrides for custom pointSize.min\n      if (sizeMax && custDefaults.pointSize?.max !== sizeMax) {\n        let hasOverride = panel.fieldConfig.overrides.some(\n          (o) =>\n            o.matcher.id === yMatcherConfig.id &&\n            o.matcher.options === yMatcherConfig.options &&\n            o.properties.some((p) => p.id === 'custom.pointSize.max')\n        );\n\n        if (!hasOverride) {\n          panel.fieldConfig.overrides.push({\n            matcher: {\n              id: FieldMatcherID.byName,\n              options: sizeField,\n            },\n            properties: [\n              {\n                id: 'custom.pointSize.max',\n                value: sizeMax,\n              },\n            ],\n          });\n        }\n      }\n    }\n\n    return {\n      frame: {\n        matcher: {\n          id: FrameMatcherID.byIndex,\n          options: frame ?? (seriesMapping === SeriesMapping.Manual ? i++ : (frameShared ?? 0)),\n        },\n      },\n      x: {\n        matcher: xMatcherConfig,\n      },\n      y: {\n        matcher: yMatcherConfig,\n        ...(exclude.length && {\n          exclude: {\n            id: FieldMatcherID.byNames,\n            options: exclude,\n          },\n        }),\n      },\n      ...(colorField && {\n        color: {\n          matcher: {\n            id: FieldMatcherID.byName,\n            options: colorField,\n          },\n        },\n      }),\n      ...(sizeField && {\n        size: {\n          matcher: {\n            id: FieldMatcherID.byName,\n            options: sizeField,\n          },\n        },\n      }),\n    };\n  });\n\n  const newOptions: Options = {\n    ...cleanedOpts,\n    mapping: seriesMapping === SeriesMapping.Auto ? SeriesMapping.Auto : SeriesMapping.Manual,\n    series: newSeries,\n  };\n\n  return newOptions;\n}\n","import { PanelPlugin } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { commonOptionsBuilder } from '@grafana/ui';\n\nimport { SeriesEditor } from './SeriesEditor';\nimport { XYChartPanel2 } from './XYChartPanel';\nimport { getScatterFieldConfig } from './config';\nimport { xyChartMigrationHandler } from './migrations';\nimport { FieldConfig, defaultFieldConfig, Options } from './panelcfg.gen';\n\nexport const plugin = new PanelPlugin<Options, FieldConfig>(XYChartPanel2)\n  // .setPanelChangeHandler(xyChartChangeHandler)\n  .setMigrationHandler(xyChartMigrationHandler)\n  .useFieldConfig(getScatterFieldConfig(defaultFieldConfig))\n  .setPanelOptions((builder) => {\n    const category = [t('xychart.category-xychart', 'XY Chart')];\n    builder\n      .addRadio({\n        path: 'mapping',\n        name: t('xychart.name-series-mapping', 'Series mapping'),\n        category,\n        defaultValue: 'auto',\n        settings: {\n          options: [\n            { value: 'auto', label: t('xychart.series-mapping-options.label-auto', 'Auto') },\n            { value: 'manual', label: t('xychart.series-mapping-options.label-manual', 'Manual') },\n          ],\n        },\n      })\n      .addCustomEditor({\n        id: 'series',\n        path: 'series',\n        name: '',\n        category,\n        editor: SeriesEditor,\n        defaultValue: [{}],\n      });\n\n    commonOptionsBuilder.addTooltipOptions(builder, true);\n    commonOptionsBuilder.addLegendOptions(builder);\n  });\n","import { css, cx } from '@emotion/css';\n\nimport { FALLBACK_COLOR, GrafanaTheme2 } from '@grafana/data';\nimport { LineStyle } from '@grafana/schema';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { SeriesIcon } from '../VizLegend/SeriesIcon';\n\nimport { ColorIndicator, DEFAULT_COLOR_INDICATOR } from './types';\nimport { getColorIndicatorClass } from './utils';\n\nexport enum ColorIndicatorPosition {\n  Leading,\n  Trailing,\n}\n\ninterface Props {\n  color?: string;\n  colorIndicator?: ColorIndicator;\n  position?: ColorIndicatorPosition;\n  lineStyle?: LineStyle;\n  isHollow?: boolean;\n}\n\nexport type ColorIndicatorStyles = ReturnType<typeof getStyles>;\n\nexport const VizTooltipColorIndicator = ({\n  color = FALLBACK_COLOR,\n  colorIndicator = DEFAULT_COLOR_INDICATOR,\n  position = ColorIndicatorPosition.Leading,\n  lineStyle,\n  isHollow,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n\n  if (isHollow) {\n    return (\n      <div\n        style={{ border: `1px solid ${color}` }}\n        className={cx(\n          position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing,\n          getColorIndicatorClass(colorIndicator, styles)\n        )}\n      />\n    );\n  }\n\n  if (colorIndicator === ColorIndicator.series) {\n    return (\n      <SeriesIcon\n        color={color}\n        lineStyle={lineStyle}\n        className={position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing}\n      />\n    );\n  }\n\n  return (\n    <span\n      style={{ backgroundColor: color }}\n      className={cx(\n        position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing,\n        getColorIndicatorClass(colorIndicator, styles)\n      )}\n    />\n  );\n};\n\n// @TODO Update classes/add svgs\nconst getStyles = (theme: GrafanaTheme2) => ({\n  leading: css({\n    marginRight: theme.spacing(0.5),\n  }),\n  trailing: css({\n    marginLeft: theme.spacing(0.5),\n  }),\n  series: css({\n    width: '14px',\n    height: '4px',\n    borderRadius: theme.shape.radius.pill,\n    minWidth: '14px',\n  }),\n  value: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.default,\n    fontWeight: 500,\n    minWidth: '12px',\n  }),\n  hexagon: css({}),\n  pie_1_4: css({}),\n  pie_2_4: css({}),\n  pie_3_4: css({}),\n  marker_sm: css({\n    width: '4px',\n    height: '4px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '4px',\n  }),\n  marker_md: css({\n    width: '8px',\n    height: '8px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '8px',\n  }),\n  marker_lg: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '12px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { CSSProperties, ReactNode, useEffect, useRef, useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { InlineToast } from '../InlineToast/InlineToast';\nimport { Tooltip } from '../Tooltip/Tooltip';\n\nimport { ColorIndicatorPosition, VizTooltipColorIndicator } from './VizTooltipColorIndicator';\nimport { ColorPlacement, VizTooltipItem } from './types';\n\ninterface VizTooltipRowProps extends Omit<VizTooltipItem, 'value'> {\n  value: string | number | null | ReactNode;\n  justify?: string;\n  isActive?: boolean; // for series list\n  marginRight?: string;\n  isPinned: boolean;\n  showValueScroll?: boolean;\n  isHiddenFromViz?: boolean;\n}\n\nenum LabelValueTypes {\n  label = 'label',\n  value = 'value',\n}\n\nconst SUCCESSFULLY_COPIED_TEXT = 'Copied to clipboard';\nconst SHOW_SUCCESS_DURATION = 2 * 1000;\nconst HORIZONTAL_PX_PER_CHAR = 7;\n\nexport const VizTooltipRow = ({\n  label,\n  value,\n  color,\n  colorIndicator,\n  colorPlacement = ColorPlacement.first,\n  justify = 'flex-start',\n  isActive = false,\n  marginRight = '0px',\n  isPinned,\n  lineStyle,\n  showValueScroll,\n  isHiddenFromViz,\n}: VizTooltipRowProps) => {\n  const styles = useStyles2(getStyles, justify, marginRight);\n\n  const innerValueScrollStyle: CSSProperties = showValueScroll\n    ? {\n        maxHeight: 55,\n        whiteSpace: 'wrap',\n        wordBreak: 'break-word',\n        overflowY: 'auto',\n      }\n    : {\n        whiteSpace: 'pre-line',\n        wordBreak: 'break-word',\n        lineHeight: 1.2,\n      };\n\n  const [showLabelTooltip, setShowLabelTooltip] = useState(false);\n\n  const [copiedText, setCopiedText] = useState<Record<string, string> | null>(null);\n  const [showCopySuccess, setShowCopySuccess] = useState(false);\n\n  const labelRef = useRef<null | HTMLDivElement>(null);\n  const valueRef = useRef<null | HTMLDivElement>(null);\n\n  useEffect(() => {\n    let timeoutId: ReturnType<typeof setTimeout>;\n\n    if (showCopySuccess) {\n      timeoutId = setTimeout(() => {\n        setShowCopySuccess(false);\n      }, SHOW_SUCCESS_DURATION);\n    }\n\n    return () => {\n      window.clearTimeout(timeoutId);\n    };\n  }, [showCopySuccess]);\n\n  const copyToClipboard = async (text: string, type: LabelValueTypes) => {\n    if (!(navigator?.clipboard && window.isSecureContext)) {\n      fallbackCopyToClipboard(text, type);\n      return;\n    }\n\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopiedText({ [`${type}`]: text });\n      setShowCopySuccess(true);\n    } catch (error) {\n      setCopiedText(null);\n    }\n  };\n\n  const fallbackCopyToClipboard = (text: string, type: LabelValueTypes) => {\n    // Use a fallback method for browsers/contexts that don't support the Clipboard API.\n    const textarea = document.createElement('textarea');\n    labelRef.current?.appendChild(textarea);\n    textarea.value = text;\n    textarea.focus();\n    textarea.select();\n    try {\n      const successful = document.execCommand('copy');\n      if (successful) {\n        setCopiedText({ [`${type}`]: text });\n        setShowCopySuccess(true);\n      }\n    } catch (err) {\n      console.error('Unable to copy to clipboard', err);\n    }\n\n    textarea.remove();\n  };\n\n  const onMouseEnterLabel = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (event.currentTarget.offsetWidth < event.currentTarget.scrollWidth) {\n      setShowLabelTooltip(true);\n    }\n  };\n\n  const onMouseLeaveLabel = () => setShowLabelTooltip(false);\n\n  // if label is > 50% window width, try to put label/value pairs on new lines\n  if (label.length * HORIZONTAL_PX_PER_CHAR > window.innerWidth / 2) {\n    label = label.replaceAll('{', '{\\n  ').replaceAll('}', '\\n}').replaceAll(', ', ',\\n  ');\n  }\n\n  return (\n    <div className={styles.contentWrapper}>\n      {(color || label) && (\n        <div className={styles.valueWrapper}>\n          {color && colorPlacement === ColorPlacement.first && (\n            <VizTooltipColorIndicator\n              color={color}\n              colorIndicator={colorIndicator}\n              lineStyle={lineStyle}\n              isHollow={isHiddenFromViz}\n            />\n          )}\n          {!isPinned ? (\n            <div className={cx(styles.label, isActive && styles.activeSeries)}>{label}</div>\n          ) : (\n            <>\n              <Tooltip content={label} interactive={false} show={showLabelTooltip}>\n                <>\n                  {showCopySuccess && copiedText?.label && (\n                    <InlineToast placement=\"top\" referenceElement={labelRef.current}>\n                      {SUCCESSFULLY_COPIED_TEXT}\n                    </InlineToast>\n                  )}\n                  {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n                  <div\n                    className={cx(styles.label, isActive && styles.activeSeries, navigator?.clipboard && styles.copy)}\n                    onMouseEnter={onMouseEnterLabel}\n                    onMouseLeave={onMouseLeaveLabel}\n                    onClick={() => copyToClipboard(label, LabelValueTypes.label)}\n                    ref={labelRef}\n                  >\n                    {label}\n                  </div>\n                </>\n              </Tooltip>\n            </>\n          )}\n        </div>\n      )}\n\n      <div className={styles.valueWrapper}>\n        {color && colorPlacement === ColorPlacement.leading && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Leading}\n            lineStyle={lineStyle}\n          />\n        )}\n\n        {!isPinned ? (\n          <div className={cx(styles.value, isActive)} style={innerValueScrollStyle}>\n            {value}\n          </div>\n        ) : (\n          <>\n            {showCopySuccess && copiedText?.value && (\n              <InlineToast placement=\"top\" referenceElement={valueRef.current}>\n                {SUCCESSFULLY_COPIED_TEXT}\n              </InlineToast>\n            )}\n            {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n            <div\n              className={cx(styles.value, isActive, navigator?.clipboard && styles.copy)}\n              style={innerValueScrollStyle}\n              onClick={() => copyToClipboard(value ? value.toString() : '', LabelValueTypes.value)}\n              ref={valueRef}\n            >\n              {value}\n            </div>\n          </>\n        )}\n\n        {color && colorPlacement === ColorPlacement.trailing && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Trailing}\n            lineStyle={lineStyle}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2, justify: string, marginRight: string) => ({\n  contentWrapper: css({\n    display: 'flex',\n    alignItems: 'start',\n    justifyContent: justify,\n    marginRight: marginRight,\n  }),\n  label: css({\n    color: theme.colors.text.secondary,\n    fontWeight: 400,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    marginRight: theme.spacing(2),\n  }),\n  value: css({\n    fontWeight: 500,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n  }),\n  valueWrapper: css({\n    display: 'flex',\n    alignItems: 'center',\n  }),\n  activeSeries: css({\n    fontWeight: theme.typography.fontWeightBold,\n    color: theme.colors.text.maxContrast,\n  }),\n  copy: css({\n    cursor: 'pointer',\n  }),\n});\n"],"names":["getDataLinks","field","rowIdx","links","v","disp","linkLookup","link","key","getAllFrameActions","dataFrame","getFieldActions","replaceVars","rowIndex","actions","actionLookup","action","LayerName","name","onChange","verifyLayerNameUniqueness","overrideStyles","styles","getStyles","isEditing","setIsEditing","validationError","setValidationError","onEditLayer","event","onEndEditName","newName","onInputChange","onEditLayerBlur","onKeyDown","onFocus","theme","VizTooltipHeader","item","isPinned","label","value","color","colorIndicator","VizTooltipContent","items","children","scrollable","maxHeight","scrollableStyle","colorPlacement","isActive","lineStyle","isHiddenFromViz","i","PointShape","SeriesMapping","XYShowMode","defaultMatcherConfig","defaultFieldConfig","defaultOptions","SeriesEditor","seriesCfg","context","style","mapping","prevMapping","usePrevious","mappingChanged","defaultFrame","selectedIdx","setSelectedIdx","addSeries","deleteSeries","index","s","series","formKey","baseNameMode","frame","frameIndex","fieldIndex","frameInputId","xFieldInputId","yFieldInputId","sizeFieldInputId","colorFieldInputId","Button","e","IconButton","Fragment","Field","Select","opt","FieldNamePicker","fieldName","fmt","val","getFrameMatcher2","config","prepSeries","mappedSeries","frames","fieldConfig","palette","getColorByName","seriesIdx","xMatcher","yMatcher","colorMatcher","sizeMatcher","frameMatcher","frameIdx","restFields","frameSeries","onlyNumTimeFields","x","onlyNumFields","size","y","ser","paletteIdx","colorCfg","autoNameSeries","names","prefix","suffix","findCommonPrefixSuffixLengths","getCommonPrefixSuffix","strs","n","parts","commonPrefixLen","commonSuffixLen","segs0","segs","preLen","j","sufLen","stripSeriesName","seriesName","hideFromTooltip","getFieldName","XYChartTooltip","dataIdxs","data","xySeries","dismiss","replaceVariables","dataLinks","canExecuteActions","idx","xField","yField","sizeField","colorField","seriesColor","fillOpacity","colorManipulator","headerItem","contentItems","addedFields","footer","hasOneClickLink","dataLink","yFieldFrame","VizTooltipFooter","VizTooltipWrapper","prepConfig","qt","hRect","drawBubblesFactory","opts","u","idx0","idx1","dataX","dataY","scaleX","scaleY","valToPosX","valToPosY","xOff","yOff","xDim","yDim","moveTo","lineTo","rect","arc","pxRatio","scatterInfo","d","showLine","showPoints","strokeWidth","pointAlpha","deg360","xKey","yKey","pointSize","colorByValue","maxSize","filtLft","filtRgt","filtBtm","filtTop","sizes","pointColors","dispColors","pointPalette","paletteHasAlpha","isSquare","linePath","curColorIdx","xVal","yVal","cx","cy","c","drawBubbles","dataIdx","lft","top","wid","hgt","builder","UPlotConfigBuilder","dist","o","ocx","ocy","dx","dy","r","xIsTime","customConfig","scaleDistr","min","max","xAxisLabel","dispNames","xAxisAutoLabel","decimals","si","lineColor","pointColor","scaleKey","yAxisLabel","yAxisAutoLabel","cfg","f","fieldValueColors","prepData","sizeRange","colorRange","getGlobalRanges","len","diams","minPx","pxRange","vals","minVal","valRange","valPct","pxArea","ranges","facet","fi","range","getHex8Color","tinycolor","getAll","getOne","conds","mappings","m","k","rhs","spl","steps","lasti","calc","pct","XYChartPanel2","props","userCanExecuteActions","error","renderLegend","placement","displayMode","width","sortBy","sortDesc","VizLayout","VizLegend","vizWidth","vizHeight","TooltipPlugin2","timeRange2","viaSync","DEFAULT_POINT_SIZE","getScatterFieldConfig","category","LineStyleEditor","ScatterShow","defaultXYDimensionConfig","xyChartMigrationHandler","panel","pluginVersion","migrateOptions","dims","seriesMapping","oldSeries","cleanedOpts","exclude","frameShared","xShared","custDefaults","oldSeries2","newSeries","colorFixed","sizeFixed","sizeMin","sizeMax","xMatcherConfig","yMatcherConfig","p","PanelPlugin","ColorIndicatorPosition","VizTooltipColorIndicator","position","isHollow","SeriesIcon","LabelValueTypes","SUCCESSFULLY_COPIED_TEXT","SHOW_SUCCESS_DURATION","HORIZONTAL_PX_PER_CHAR","VizTooltipRow","justify","marginRight","showValueScroll","innerValueScrollStyle","showLabelTooltip","setShowLabelTooltip","copiedText","setCopiedText","showCopySuccess","setShowCopySuccess","labelRef","valueRef","timeoutId","copyToClipboard","text","type","fallbackCopyToClipboard","textarea","err","onMouseEnterLabel","onMouseLeaveLabel","Tooltip","InlineToast"],"sourceRoot":""}