"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2550],{25650:(fa,J,o)=>{o.r(J),o.d(J,{default:()=>ue});var e=o(74848),U=o(22803),I=o(96540),F=o(71468),K=o(32899),L=o(28105),O=o(51898),i=o(92745),E=o(27489),M=o(43173),$=o(89640),C=o(40279),x=o(37386),W=o(72636),S=o(63527),j=o(45861),w=o(87105),R=o(41654),ba=o(68079),X=o(63142),ga=o(65240),va=o(45229),A=o(74410),k=o(13791),B=o(8535),ya=o(20018),xa=o(92138),z=o(36490),Da=o(11393),q=o(13956),_=o(68143),ja=o(78282),Ia=o(6890),Sa=o(64762),Na=o(15203),Pa=o(28998),Oa=o(30124),aa=o(97583),b=o(2559);function Ea(t){return async a=>{try{a((0,b.f7)());const r=await(0,_.AI)().get(`/api/gnet/dashboards/${t}`);await a(sa(r.json)),await a(La(r)),a(ta())}catch(r){a((0,b.oQ)()),(0,_.NF)(r)&&a((0,Ia.dx)((0,Sa.gi)(r.data.message||r)))}}}function Ta(t){return async a=>{await a(sa(t)),await a(Ca(t)),a(ta())}}function G(t){return async a=>{a((0,b.dd)(t)),a(Ra(t))}}const Ua=(t,a)=>t?.usage?.libraryPanels?.filter(r=>a.inputs.libraryPanels.some(n=>n.state!==b.J7.Exists&&n.model.uid===r.uid));function ea(t,a){let r=t.__inputs;if(a.inputs.libraryPanels?.length){const n=[];t.__inputs?.forEach(s=>{if(!s?.usage?.libraryPanels){n.push(s);return}const d=Ua(s,a);s.usage={libraryPanels:d},!!d?.length&&n.push(s)}),r=n}return{...t,__inputs:r}}function La(t){return(a,r)=>{const n=r().importDashboard,s=ea(t.json,n);a((0,b.Rp)({...t,json:s}))}}function Ca(t){return(a,r)=>{const n=r().importDashboard,s=ea(t,n);a((0,b.dd)(s))}}function ta(){return(t,a)=>{const r=a().importDashboard.dashboard;if(r&&r.__inputs){const n=[];r.__inputs.forEach(s=>{const d={name:s.name,label:s.label,info:s.description,value:s.value,type:s.type,pluginId:s.pluginId,options:[]};d.description=Aa(s),s.type===b.NZ.DataSource?$a(s,d):d.info||(d.info="Specify a string constant"),n.push(d)}),t((0,b.y3)(n))}}}function sa(t){return async function(a){const r=await Ja(t);a((0,b.dW)(r))}}function Ra(t){return async function(a){const{elements:r,variables:n,annotations:s}=t;let d={};for(const h of Object.values(r)){if(h.kind!=="Panel")throw new Error("Only panels are currenlty supported in v2 dashboards");if(h.spec.data.spec.queries.length>0)for(const v of h.spec.data.spec.queries)d=await H(v.spec,d)}for(const h of n)h.kind==="QueryVariable"&&(d=await H(h.spec,d));for(const h of s)d=await H(h.spec,d);a((0,b.y3)(Object.values(d)))}}async function Ja(t){if(!t||!t.__elements)return[];const a=[];for(const r of Object.values(t.__elements)){if(r.kind!==aa.i.Panel)continue;const n=r.model,{type:s,description:d}=n,{uid:h,name:v}=r,m={model:{model:n,uid:h,name:v,version:0,type:s,kind:aa.i.Panel,description:d},state:b.J7.New};try{const D=await(0,Oa.Yr)(h,!0);m.state=b.J7.Exists,m.model=D}catch(D){if(D.status!==404)throw D}a.push(m)}return a}function ra(){return t=>{t((0,b.SN)())}}function Fa(t){return async(a,r)=>{const n=r().importDashboard.dashboard,s=r().importDashboard.inputs,d=[];t.dataSources?.forEach((h,v)=>{const m=s.dataSources[v];d.push({name:m.name,type:m.type,pluginId:m.pluginId,value:h.uid})}),t.constants?.forEach((h,v)=>{const m=s.constants[v];d.push({value:h,name:m.name,type:m.type})}),a(Na.cU.endpoints.importDashboard.initiate({dashboard:{...n,title:t.title,uid:t.uid||n.uid},overwrite:!0,inputs:d,folderUid:t.folder.uid}))}}const $a=(t,a)=>{(0,ja.l)().getList({pluginId:t.pluginId}).length===0?a.info="No data sources of type "+t.pluginName+" found":a.info||(a.info="Select a "+t.pluginName+" data source")},Aa=t=>{if(t.usage&&t.usage.libraryPanels)return`List of affected library panels: ${t.usage.libraryPanels.reduce((r,n,s)=>s===0?n.name:`${r}, ${n.name}`,"")}`};async function H(t,a={}){const r=t.query.datasource;let n;const s=t.query.group;if(!r&&(s==="grafana"||s==="datasource"))return a;const d=await(0,Pa.tR)().get({type:s});return d?(n={name:d.name,label:d.name,info:`Select a ${d.name} data source`,value:d.uid,type:b.NZ.DataSource,pluginId:d.meta?.id},a[d.meta?.id]=n):(n={name:s,label:s,info:`No data sources of type ${s} found`,value:"",type:b.NZ.DataSource,pluginId:s},a[s]=n),a}var Q=o(52763),V=o(49785),oa=o(36580),na=o(91156),da=o(76792),Ba=o(75735),Ga=o(60171),Va=o(89223);const Ka=t=>{let a;try{a=JSON.parse(t)}catch{return(0,i.t)("dashboard.validation.invalid-json","Not valid JSON")}if(a&&a.hasOwnProperty("tags"))if(Array.isArray(a.tags)){if(a.tags.some(n=>typeof n!="string"))return(0,i.t)("dashboard.validation.tags-expected-strings","tags expected array of strings")}else return(0,i.t)("dashboard.validation.tags-expected-array","tags expected array");return!0},Ma=t=>{const a=/(^\d+$)|dashboards\/(\d+)/.exec(t);return a&&(a[1]||a[2])?!0:(0,i.t)("dashboard.validation.invalid-dashboard-id","Could not find a valid Grafana.com ID")},ia=(t,a)=>Va.P.validateNewDashboardName(a,t).then(()=>!0).catch(r=>{if(r.type==="EXISTING")return r.message}),la=t=>(0,q.n)().getDashboardDTO(t).then(a=>{const r=(0,Ga.HG)(a),n=r?a.spec:a.dashboard,s=r?a.metadata.annotations?.[Ba.w2]:a.meta.folderTitle;return`Dashboard named '${n.title}' in folder '${s}' has the same UID`}).catch(a=>(a.isHandled=!0,a.status===403?"Dashboard with the same UID already exists":!0)),Wa=({register:t,errors:a,control:r,inputs:n,getValues:s,uidReset:d,onUidReset:h,onCancel:v,onSubmit:m,watch:D})=>{const[p,P]=(0,I.useState)(!1),[T,c]=(0,I.useState)({});return(0,I.useEffect)(()=>{if(p&&(a.dashboard?.title||a.k8s?.name)){const l=s();m({...l,dashboard:{...l.dashboard,title:l.dashboard.title}})}},[a,s,p,m]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(i.x6,{i18nKey:"manage-dashboards.import-dashboard-form.options",children:"Options"}),(0,e.jsx)(x.D,{label:(0,i.t)("manage-dashboards.import-dashboard-form.label-name","Name"),invalid:!!a.dashboard?.title,error:a.dashboard?.title&&a.dashboard?.title.message,children:(0,e.jsx)(S.p,{...t("dashboard.title",{required:"Name is required",validate:async l=>await ia(l,s().folderUid??"")}),type:"text","data-testid":O.Tp.components.ImportDashboardForm.name})}),(0,e.jsx)(x.D,{label:(0,i.t)("dashboard-scene.import-dashboard-form-v2.label-folder","Folder"),children:(0,e.jsx)(V.xI,{render:({field:{ref:l,value:g,onChange:u,...f}})=>(0,e.jsx)(na.d,{...f,onChange:(y,N)=>{u(y,N)},value:g}),name:"folderUid",control:r})}),n.dataSources&&n.dataSources.map(l=>{if(l.pluginId===oa.dR.type)return null;const g=`datasource-${l.pluginId}`;return(0,e.jsx)(x.D,{label:l.label,description:l.description,invalid:!!a[g],error:a[g]?"Please select a data source":void 0,children:(0,e.jsx)(V.xI,{name:g,render:({field:{ref:u,...f}})=>(0,e.jsx)(da.sk,{...f,noDefault:!0,placeholder:l.info,pluginId:l.pluginId,current:T[l.pluginId],onChange:y=>{f.onChange(y),c(N=>({...N,[l.pluginId]:{uid:y.uid,type:y.type}}))}}),control:r,rules:{required:!0}})},l.pluginId)}),(0,e.jsxs)(R.B,{children:[(0,e.jsx)(j.$n,{type:"submit","data-testid":O.Tp.components.ImportDashboardForm.submit,variant:wa(a),onClick:()=>{P(!0)},children:za(a)}),(0,e.jsx)(j.$n,{type:"reset",variant:"secondary",onClick:v,children:(0,e.jsx)(i.x6,{i18nKey:"dashboard-scene.import-dashboard-form-v2.cancel",children:"Cancel"})})]})]})};function wa(t){return t&&(t.dashboard?.title||t.k8s?.name)?"destructive":"primary"}function za(t){return t&&(t.dashboard?.title||t.k8s?.name)?"Import (Overwrite)":"Import"}const Ha="dashboard_import_imported";function Qa(){const[t,a]=(0,I.useState)(!1),r=(0,Q.wA)(),n=z.Ny.getSearchObject(),s=(0,Q.d4)(p=>p.importDashboard.dashboard),d=(0,Q.d4)(p=>p.importDashboard.inputs),h=n.folderUid?{uid:String(n.folderUid)}:{uid:""};function v(){a(!0)}function m(){r(ra())}async function D(p){(0,E.rR)(Ha);const P={...s,title:p.dashboard.title,annotations:s.annotations?.map(c=>{const l=c.spec.query?.spec.group;if(l&&p[`datasource-${l}`]){const g=p[`datasource-${l}`];return{...c,spec:{...c.spec,query:{kind:"DataQuery",group:l,version:(0,Da.iM)().version,datasource:{name:g.uid},spec:{...c.spec.query?.spec}}}}}return c}),variables:s.variables?.map(c=>{if(c.kind==="QueryVariable"){const l=c.spec.query?.spec.group;if(l&&p[`datasource-${l}`]){const g=p[`datasource-${l}`];return{...c,spec:{...c.spec,query:{...c.spec.query,spec:{...c.spec.query.spec,group:g.type,datasource:{name:g.uid}}},options:[],current:{text:"",value:""},refresh:"onDashboardLoad"}}}}else if(c.kind==="DatasourceVariable")return{...c,spec:{...c.spec,current:{text:"",value:""}}};return c}),elements:Object.fromEntries(Object.entries(s.elements).map(([c,l])=>{if(l.kind==="Panel"){const g={...l.spec};if(g.data?.kind==="QueryGroup"){const u=g.data.spec.queries.map(f=>{if(f.kind==="PanelQuery"){const y=f.spec.query?.kind;if(y&&p[`datasource-${y}`]){const N=p[`datasource-${y}`];return{...f,spec:{...f.spec,datasource:{uid:N.uid,type:N.type}}}}}return f});g.data={...g.data,spec:{...g.data.spec,queries:u}}}return[c,{kind:l.kind,spec:g}]}return[c,l]}))},T=await(0,q.n)("v2").saveDashboard({...p,dashboard:P});if(T.url){const c=xa.I.stripBaseFromUrl(T.url);z.Ny.push(c)}}return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(A.l,{onSubmit:D,defaultValues:{dashboard:s,k8s:{annotations:{"grafana.app/folder":h.uid}}},validateOnMount:!0,validateOn:"onChange",children:({register:p,errors:P,control:T,watch:c,getValues:l})=>(0,e.jsx)(Wa,{register:p,inputs:d,errors:P,control:T,getValues:l,uidReset:t,onCancel:m,onUidReset:v,onSubmit:D,watch:c})})})}var Ya=o(80011),Za=o(31286),ca=o(53487),Xa=o(70905);function ha({inputs:t,label:a,description:r,folderName:n}){const s=(0,X.of)(ka);return t?.length?(0,e.jsx)("div",{className:s.spacer,children:(0,e.jsx)(x.D,{label:a,description:r,children:(0,e.jsx)(e.Fragment,{children:t.map((d,h)=>{const v=`elements[${h}]`,m=d.state===b.J7.New?{...d.model,meta:{...d.model.meta,folderName:n??"Dashboards"}}:{...d.model};return(0,e.jsx)("div",{className:s.item,children:(0,e.jsx)(Xa.E,{libraryPanel:m,onClick:()=>{}})},v)})})})}):null}function ka(t){return{spacer:(0,U.css)({marginBottom:t.spacing(2)}),item:(0,U.css)({marginBottom:t.spacing(1)})}}const qa=({register:t,errors:a,control:r,getValues:n,uidReset:s,inputs:d,onUidReset:h,onCancel:v,onSubmit:m,watch:D})=>{const[p,P]=(0,I.useState)(!1),T=D("dataSources"),c=D("folder");(0,I.useEffect)(()=>{p&&(a.title||a.uid)&&m(n())},[a,n,p,m]);const l=d?.libraryPanels?.filter(u=>u.state===b.J7.New)??[],g=d?.libraryPanels?.filter(u=>u.state===b.J7.Exists)??[];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ca.s,{children:(0,e.jsx)(i.x6,{i18nKey:"manage-dashboards.import-dashboard-form.options",children:"Options"})}),(0,e.jsx)(x.D,{label:(0,i.t)("manage-dashboards.import-dashboard-form.label-name","Name"),invalid:!!a.title,error:a.title&&a.title.message,children:(0,e.jsx)(S.p,{...t("title",{required:"Name is required",validate:async u=>await ia(u,n().folder.uid)}),type:"text","data-testid":O.Tp.components.ImportDashboardForm.name})}),(0,e.jsx)(x.D,{label:(0,i.t)("manage-dashboards.import-dashboard-form.label-folder","Folder"),children:(0,e.jsx)(V.xI,{render:({field:{ref:u,value:f,onChange:y,...N}})=>(0,e.jsx)(na.d,{...N,onChange:(pa,Z)=>y({uid:pa,title:Z}),value:f.uid}),name:"folder",control:r})}),(0,e.jsx)(x.D,{label:(0,i.t)("manage-dashboards.import-dashboard-form.label-unique-identifier-uid","Unique identifier (UID)"),description:(0,i.t)("manage-dashboards.import-dashboard-form.description-unique-identifier-uid","The unique identifier (UID) of a dashboard can be used for uniquely identify a dashboard between multiple Grafana installs. The UID allows having consistent URLs for accessing dashboards so changing the title of a dashboard will not break any bookmarked links to that dashboard."),invalid:!!a.uid,error:a.uid&&a.uid.message,children:(0,e.jsx)(e.Fragment,{children:s?(0,e.jsx)(S.p,{...t("uid",{required:!0,validate:async u=>await la(u)})}):(0,e.jsx)(S.p,{disabled:!0,...t("uid",{validate:async u=>await la(u)}),addonAfter:!s&&(0,e.jsx)(j.$n,{onClick:h,children:(0,e.jsx)(i.x6,{i18nKey:"manage-dashboards.import-dashboard-form.change-uid",children:"Change uid"})})})})}),d.dataSources&&d.dataSources.map((u,f)=>{if(u.pluginId===oa.dR.type)return null;const y=`dataSources.${f}`,N=T??[];return(0,e.jsx)(x.D,{label:u.label,description:u.description,invalid:a.dataSources&&!!a.dataSources[f],error:a.dataSources&&a.dataSources[f]&&"A data source is required",children:(0,e.jsx)(V.xI,{name:y,render:({field:{ref:pa,...Z}})=>(0,e.jsx)(da.sk,{...Z,noDefault:!0,placeholder:u.info,pluginId:u.pluginId,current:N[f]?.uid}),control:r,rules:{required:!0}})},y)}),d.constants&&d.constants.map((u,f)=>{const y=`constants.${f}`;return(0,e.jsx)(x.D,{label:u.label,error:a.constants&&a.constants[f]&&`${u.label} needs a value`,invalid:a.constants&&!!a.constants[f],children:(0,e.jsx)(S.p,{...t(y,{required:!0}),defaultValue:u.value})},y)}),(0,e.jsx)(ha,{inputs:l,label:(0,i.t)("manage-dashboards.import-dashboard-form.label-new-library-panels","New library panels"),description:(0,i.t)("manage-dashboards.import-dashboard-form.description-library-panels-imported","List of new library panels that will get imported."),folderName:c.title}),(0,e.jsx)(ha,{inputs:g,label:(0,i.t)("manage-dashboards.import-dashboard-form.label-existing-library-panels","Existing library panels"),description:(0,i.t)("manage-dashbaords.import-dashboard-form.description-existing-library-panels","List of existing library panels. These panels are not affected by the import."),folderName:c.title}),(0,e.jsxs)(R.B,{children:[(0,e.jsx)(j.$n,{type:"submit","data-testid":O.Tp.components.ImportDashboardForm.submit,variant:_a(a),onClick:()=>{P(!0)},children:ae(a)}),(0,e.jsx)(j.$n,{type:"reset",variant:"secondary",onClick:v,children:(0,e.jsx)(i.x6,{i18nKey:"manage-dashboards.import-dashboard-form.cancel",children:"Cancel"})})]})]})};function _a(t){return t&&(t.title||t.uid)?"destructive":"primary"}function ae(t){return t&&(t.title||t.uid)?"Import (Overwrite)":"Import"}const ee="dashboard_import_imported",te=t=>{const a=z.Ny.getSearchObject();return{dashboard:t.importDashboard.dashboard,meta:t.importDashboard.meta,source:t.importDashboard.source,inputs:t.importDashboard.inputs,folder:a.folderUid?{uid:String(a.folderUid)}:{uid:""}}},se={clearLoadedDashboard:ra,importDashboard:Fa},re=(0,F.connect)(te,se);class oe extends I.PureComponent{constructor(){super(...arguments),this.state={uidReset:!1},this.onSubmit=a=>{(0,E.rR)(ee),this.props.importDashboard(a)},this.onCancel=()=>{this.props.clearLoadedDashboard()},this.onUidReset=()=>{this.setState({uidReset:!0})}}render(){const{dashboard:a,inputs:r,meta:n,source:s,folder:d}=this.props,{uidReset:h}=this.state;return(0,e.jsxs)(e.Fragment,{children:[s===b.qx.Gcom&&(0,e.jsxs)(Za.a,{marginBottom:3,children:[(0,e.jsx)("div",{children:(0,e.jsx)(ca.s,{children:(0,e.jsxs)(i.x6,{i18nKey:"manage-dashboards.import-dashboard-overview-un-connected.importing-from",children:["Importing dashboard from"," ",(0,e.jsx)($.Y,{href:`https://grafana.com/dashboards/${a.gnetId}`,children:"Grafana.com"})]})})}),(0,e.jsx)("table",{className:"filter-table form-inline",children:(0,e.jsxs)("tbody",{children:[(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)(i.x6,{i18nKey:"manage-dashboards.import-dashboard-overview-un-connected.published-by",children:"Published by"})}),(0,e.jsx)("td",{children:n.orgName})]}),(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)(i.x6,{i18nKey:"manage-dashboards.import-dashboard-overview-un-connected.updated-on",children:"Updated on"})}),(0,e.jsx)("td",{children:(0,Ya.LE)(n.updatedAt)})]})]})})]}),(0,e.jsx)(A.l,{onSubmit:this.onSubmit,defaultValues:{...a,constants:[],dataSources:[],elements:[],folder:d},validateOnMount:!0,validateFieldsOnMount:["title","uid"],validateOn:"onChange",children:({register:v,errors:m,control:D,watch:p,getValues:P})=>(0,e.jsx)(qa,{register:v,errors:m,control:D,getValues:P,uidReset:h,inputs:r,onCancel:this.onCancel,onUidReset:this.onUidReset,onSubmit:this.onSubmit,watch:p})})]})}}const ua=re(oe);ua.displayName="ImportDashboardOverview";const Y="dashboard_import_loaded",ne=`{
    "title": "Example - Repeating Dictionary variables",
    "uid": "_0HnEoN4z",
    "panels": [...]
    ...
}
`,de=t=>({loadingState:t.importDashboard.state,dashboard:t.importDashboard.dashboard}),ie={fetchGcomDashboard:Ea,importDashboardJson:Ta,cleanUpAction:ya.N},le=(0,F.connect)(de,ie);class ce extends I.PureComponent{constructor(a){super(a),this.fileListRenderer=(n,s)=>null,this.onFileUpload=n=>{(0,E.rR)(Y,{import_source:"json_uploaded"});try{const s=JSON.parse(String(n));if(s.spec?.elements){(0,B.JD)(G(s.spec));return}else if(s.elements){(0,B.JD)(G(s));return}if(s.spec){this.props.importDashboardJson(s.spec);return}this.props.importDashboardJson(s)}catch(s){s instanceof Error&&va.A.emit(K.r1.alertError,["Import failed","JSON -> JS Serialization failed: "+s.message]);return}},this.getDashboardFromJson=n=>{(0,E.rR)(Y,{import_source:"json_pasted"});const s=JSON.parse(n.dashboardJson);if(s.spec?.elements){(0,B.JD)(G(s.spec));return}else if(s.elements){(0,B.JD)(G(s));return}if(s.spec){this.props.importDashboardJson(s.spec);return}this.props.importDashboardJson(s)},this.getGcomDashboard=n=>{(0,E.rR)(Y,{import_source:"gcom"});let s;const d=/(^\d+$)|dashboards\/(\d+)/.exec(n.gcomDashboard);d&&d[1]?s=d[1]:d&&d[2]&&(s=d[2]),s&&this.props.fetchGcomDashboard(s)},this.pageNav={text:(0,i.t)("manage-dashboards.unthemed-dashboard-import.text.import-dashboard","Import dashboard"),subTitle:(0,i.t)("manage-dashboards.unthemed-dashboard-import.subTitle.import-dashboard-from-file-or-grafanacom","Import dashboard from file or Grafana.com")};const{gcomDashboardId:r}=this.props.queryParams;if(r){this.getGcomDashboard({gcomDashboard:r});return}}componentWillUnmount(){this.props.cleanUpAction({cleanupAction:a=>a.importDashboard=b.V9})}renderImportForm(){const a=me(this.props.theme),r=()=>(0,e.jsx)($.Y,{variant:"bodySmall",href:"https://grafana.com/grafana/dashboards/",external:!0,children:"grafana.com/dashboards"});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:a.option,children:(0,e.jsx)(C.gH,{options:{multiple:!1,accept:[".json",".txt"]},readAs:"readAsText",fileListRenderer:this.fileListRenderer,onLoad:this.onFileUpload,children:(0,e.jsx)(C.wI,{primaryText:(0,i.t)("dashboard-import.file-dropzone.primary-text","Upload dashboard JSON file"),secondaryText:(0,i.t)("dashboard-import.file-dropzone.secondary-text","Drag and drop here or click to browse")})})}),(0,e.jsx)("div",{className:a.option,children:(0,e.jsx)(A.l,{onSubmit:this.getGcomDashboard,defaultValues:{gcomDashboard:""},children:({register:n,errors:s})=>(0,e.jsx)(x.D,{label:(0,e.jsx)(W.J,{className:a.labelWithLink,htmlFor:"url-input",children:(0,e.jsx)("span",{children:(0,e.jsxs)(i.x6,{i18nKey:"dashboard-import.gcom-field.label",children:["Find and import dashboards for common applications at ",(0,e.jsx)(r,{})]})})}),invalid:!!s.gcomDashboard,error:s.gcomDashboard&&s.gcomDashboard.message,children:(0,e.jsx)(S.p,{id:"url-input",placeholder:(0,i.t)("dashboard-import.gcom-field.placeholder","Grafana.com dashboard URL or ID"),type:"text",...n("gcomDashboard",{required:(0,i.t)("dashboard-import.gcom-field.validation-required","A Grafana dashboard URL or ID is required"),validate:Ma}),addonAfter:(0,e.jsx)(j.$n,{type:"submit",children:(0,e.jsx)(i.x6,{i18nKey:"dashboard-import.gcom-field.load-button",children:"Load"})})})})})}),(0,e.jsx)("div",{className:a.option,children:(0,e.jsx)(A.l,{onSubmit:this.getDashboardFromJson,defaultValues:{dashboardJson:""},children:({register:n,errors:s})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(x.D,{label:(0,i.t)("dashboard-import.json-field.label","Import via dashboard JSON model"),invalid:!!s.dashboardJson,error:s.dashboardJson&&s.dashboardJson.message,children:(0,e.jsx)(w.f,{...n("dashboardJson",{required:(0,i.t)("dashboard-import.json-field.validation-required","Need a dashboard JSON model"),validate:Ka}),"data-testid":O.Tp.components.DashboardImportPage.textarea,id:"dashboard-json-textarea",rows:10,placeholder:ne})}),(0,e.jsxs)(R.B,{children:[(0,e.jsx)(j.$n,{type:"submit","data-testid":O.Tp.components.DashboardImportPage.submit,children:(0,e.jsx)(i.x6,{i18nKey:"dashboard-import.form-actions.load",children:"Load"})}),(0,e.jsx)(j.z9,{variant:"secondary",href:`${M.$.appSubUrl}/dashboards`,children:(0,e.jsx)(i.x6,{i18nKey:"dashboard-import.form-actions.cancel",children:"Cancel"})})]})]})})})]})}getDashboardOverview(){const{loadingState:a,dashboard:r}=this.props;return a===L.Gu.Done?r.elements||r.spec?.elements?(0,e.jsx)(Qa,{}):(0,e.jsx)(ua,{}):null}render(){const{loadingState:a}=this.props;return(0,e.jsx)(k.Y,{navId:"dashboards/browse",pageNav:this.pageNav,children:(0,e.jsxs)(k.Y.Contents,{children:[a===L.Gu.Loading&&(0,e.jsx)(R.B,{direction:"column",justifyContent:"center",children:(0,e.jsx)(R.B,{justifyContent:"center",children:(0,e.jsx)(ba.y,{size:"xxl"})})}),[L.Gu.Error,L.Gu.NotStarted].includes(a)&&this.renderImportForm(),this.getDashboardOverview()]})})}}const he=(0,X.cV)(ce),ma=le(he);ma.displayName="DashboardImport";const ue=ma,me=(0,ga.N)(t=>({option:(0,U.css)({marginBottom:t.spacing(4),maxWidth:"600px"}),labelWithLink:(0,U.css)({maxWidth:"100%"}),linkWithinLabel:(0,U.css)({fontSize:"inherit"})}))},74410:(fa,J,o)=>{o.d(J,{l:()=>K});var e=o(74848),U=o(22803),I=o(96540),F=o(49785);function K({defaultValues:L,onSubmit:O,validateOnMount:i=!1,validateFieldsOnMount:E,children:M,validateOn:$="onSubmit",maxWidth:C=600,...x}){const{handleSubmit:W,trigger:S,formState:j,...w}=(0,F.mN)({mode:$,defaultValues:L});return(0,I.useEffect)(()=>{i&&S(E)},[S,E,i]),(0,e.jsx)("form",{className:(0,U.css)({maxWidth:C!=="none"?C+"px":C,width:"100%"}),onSubmit:W(O),...x,children:M({errors:j.errors,formState:j,trigger:S,...w})})}}}]);

//# sourceMappingURL=DashboardImport.fa363e5e0176049aa884.js.map