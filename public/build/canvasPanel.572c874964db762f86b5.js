"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[7523],{16913:(Ni,un,j)=>{j.d(un,{OG:()=>De,u6:()=>Vt});var $t=j(73163);const Vt=(ft,y)=>{const ne=[];if((ft.config.links?.length??0)>0&&ft.getLinks!=null){const F=ft.values[y],ge=ft.display?ft.display(F):{text:`${F}`,numeric:+F},me=new Set;ft.getLinks({calculatedValue:ge,valueRowIndex:y}).forEach($=>{const Kt=`${$.title}/${$.href}`;me.has(Kt)||(ne.push($),me.add(Kt))})}return ne},A=ft=>{},De=(ft,y,ne,F)=>{const ge=[],me=new Set;return(0,$t.ko)(ft,y,y.state.scopedVars,ne,y.config.actions??[],{valueRowIndex:F}).forEach(Kt=>{const ve=`${Kt.title}`;me.has(ve)||(ge.push(Kt),me.add(ve))}),ge}},41530:(Ni,un,j)=>{j.d(un,{A:()=>ft});var $t=j(74848),Vt=j(22803),A=j(63142),De=j(77239);const ft=({item:ne,isPinned:F})=>{const ge=(0,A.of)(y),{label:me,value:$,color:Kt,colorIndicator:ve}=ne;return(0,$t.jsx)("div",{className:ge.wrapper,children:(0,$t.jsx)(De.B,{label:me,value:$,color:Kt,colorIndicator:ve,marginRight:"22px",isPinned:F})})},y=ne=>({wrapper:(0,Vt.css)({display:"flex",flexDirection:"column",flex:1,padding:ne.spacing(1),lineHeight:1})})},47466:(Ni,un,j)=>{j.d(un,{o:()=>ft});var $t=j(74848),Vt=j(22803),A=j(63142),De=j(77239);const ft=({items:ne,children:F,isPinned:ge,scrollable:me=!1,maxHeight:$})=>{const Kt=(0,A.of)(y),ve=me?{maxHeight:$,overflowY:"auto"}:{};return(0,$t.jsxs)("div",{className:Kt.wrapper,style:ve,children:[ne.map(({label:je,value:Sn,color:En,colorIndicator:mr,colorPlacement:xr,isActive:yr,lineStyle:ot,isHiddenFromViz:Pe},Q)=>(0,$t.jsx)(De.B,{label:je,value:Sn,color:En,colorIndicator:mr,colorPlacement:xr,isActive:yr,justify:"space-between",isPinned:ge,lineStyle:ot,showValueScroll:!me,isHiddenFromViz:Pe},Q)),F]})},y=ne=>({wrapper:(0,Vt.css)({display:"flex",flexDirection:"column",flex:1,gap:2,borderTop:`1px solid ${ne.colors.border.weak}`,padding:ne.spacing(1)})})},75016:(Ni,un,j)=>{j.r(un),j.d(un,{addStandardCanvasEditorOptions:()=>gl,plugin:()=>oy});var $t=j(16207),Vt=j(83340),A=j(92745),De=j(43173),ft=j(739),y=j(74848),ne=j(2543),F=j(96540);class ge extends F.PureComponent{render(){const{config:e}=this.props;return(0,y.jsx)("div",{children:(0,y.jsxs)(A.x6,{i18nKey:"canvas.not-found-display.not-found",components:{config:(0,y.jsx)("pre",{children:JSON.stringify(e,null,2)})},children:[(0,y.jsx)("h3",{children:"Not found: "}),"<config />"]})})}}const me={id:"not-found",name:"Not found",description:"Display when element type is not found in the registry",display:ge,defaultSize:{width:100,height:100},getNewOptions:()=>({config:{}})};var $=j(86967),Kt=(t=>(t.Delete="delete",t.Duplicate="duplicate",t.MoveTop="move-top",t.MoveBottom="move-bottom",t))(Kt||{}),ve=(t=>(t.ElementManagement="element-management",t.SelectedElement="selected-element",t.SelectedConnection="selected-connection",t))(ve||{}),je=(t=>(t.Solid="solid",t.Dashed="dashed",t.Dotted="dotted",t))(je||{}),Sn=(t=>(t.Solid="0",t.Dashed="8 8",t.Dotted="3",t))(Sn||{}),En=j(32899),mr=j(11594),xr=j(16515),yr=j(45229),ot=j(65642),Pe=j(42954),Q=j(22803),Pt=j(63142),dn=j(45861),We=j(68079),fe=j(87405),fn=j(22001),Bi=j(50275),Ve=j(97095),tn=j(18027),br=j(77824),xe=j(18857),wn=j(37386),ti=j(41185),Fe=j(41654),Ln=j(63527),Me=j(76319);const Xn=({value:t,onChange:e})=>{const[n,r]=(0,F.useState)(""),[i,a]=(0,F.useState)(""),o=({currentTarget:d})=>{a(d.value)},s=({currentTarget:d})=>{r(d.value)},l=d=>()=>{const f=t.filter(h=>h[0]!==d);e(f)},c=()=>{const d=n;let f;t?f=t.filter(h=>h[0]!==d):f=[],f.push([d,i]),f.sort((h,v)=>h[0].localeCompare(v[0])),r(""),a(""),e(f)},u=!n&&!i;return(0,y.jsxs)("div",{children:[(0,y.jsxs)(Fe.B,{direction:"row",children:[(0,y.jsx)(Ln.p,{placeholder:(0,A.t)("canvas.params-editor.placeholder-key","Key"),value:n,onChange:s}),(0,y.jsx)(Ln.p,{placeholder:(0,A.t)("canvas.params-editor.placeholder-value","Value"),value:i,onChange:o}),(0,y.jsx)(Me.K,{"aria-label":(0,A.t)("canvas.params-editor.aria-label-add","Add"),name:"plus-circle",onClick:c,disabled:u})]}),(0,y.jsx)(Fe.B,{direction:"column",children:Array.from(t||[]).map(d=>(0,y.jsxs)(Fe.B,{direction:"row",children:[(0,y.jsx)(Ln.p,{disabled:!0,value:d[0]}),(0,y.jsx)(Ln.p,{disabled:!0,value:d[1]}),(0,y.jsx)(Me.K,{"aria-label":(0,A.t)("canvas.params-editor.aria-label-delete","Delete"),onClick:l(d[0]),name:"trash-alt"})]},d[0]))})]})};var ei=j(63704),ni=j(68143),ji=j(2863),Cr=j(73427),eo=j(92367),Vi=j(22429);const Fi=(t,e)=>{if(!t.endpoint){Cr.lE.emit(En.r1.alertError,["API endpoint is not defined."]);return}const n=Sr(t);(0,ni.AI)().fetch(n).subscribe({error:r=>{Cr.lE.emit(En.r1.alertError,["An error has occurred. Check console output for more details."]),console.error("API call error: ",r),e&&e(!1)},complete:()=>{Cr.lE.emit(En.r1.alertSuccess,["API call was successful"]),e&&e(!1)}})},le=t=>{const e=(0,Vi.UA)().getCurrent()?.panelInEdit;return(0,ji.w)().replace(t,e?.scopedVars)},Sr=t=>{const e=Gi(le(t.endpoint)),n=new URL(e),r={};let i={url:n.toString(),method:t.method,data:_n(t),headers:r};return t.headerParams&&t.headerParams.forEach(([a,o])=>{r[le(a)]=le(o)}),t.queryParams&&(t.queryParams?.forEach(([a,o])=>{n.searchParams.append(le(a),le(o))}),i.url=n.toString()),t.method===$.DO.POST&&(r["Content-Type"]=t.contentType),r["X-Grafana-Action"]="1",i.headers=r,i},_n=t=>{let e=t.data?le(t.data):"{}";return t.method===$.DO.GET&&(e=void 0),e},Gi=t=>{if(t.startsWith("/")){const n=ei.sQ.sanitizeUrl(t);t=(0,eo.z)(n,[])}return t},ml={id:"",name:"",description:"",editor:ti.g,settings:{}},Gf=[{label:$.DO.GET,value:$.DO.GET},{label:$.DO.POST,value:$.DO.POST},{label:$.DO.PUT,value:$.DO.PUT}],$f=[{label:"JSON",value:"application/json"},{label:"Text",value:"text/plain"},{label:"JavaScript",value:"application/javascript"},{label:"HTML",value:"text/html"},{label:"XML",value:"application/XML"},{label:"x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}];function Wf({value:t,context:e,onChange:n}){t||(t=ri);const i=(0,F.useCallback)((h="")=>{n({...t,endpoint:h})},[n,t]),a=(0,F.useCallback)(h=>{n({...t,data:h})},[n,t]),o=(0,F.useCallback)(h=>{n({...t,method:h})},[n,t]),s=(0,F.useCallback)(h=>{n({...t,contentType:h?.value})},[n,t]),l=h=>h,c=(0,F.useCallback)(h=>{n({...t,queryParams:h})},[n,t]),u=(0,F.useCallback)(h=>{n({...t,headerParams:h})},[n,t]),d=h=>{try{const v=JSON.parse(le(h));return(0,y.jsx)(Bi.B,{json:v})}catch(v){return v instanceof Error?`Invalid JSON provided: ${v.message}`:"Invalid JSON provided"}},f=h=>{if(h&&h.endpoint)return(0,y.jsx)(dn.$n,{onClick:()=>Fi(h),title:(0,A.t)("canvas.apieditor.render-test-apibutton.title-test-api","Test API"),children:(0,y.jsx)(A.x6,{i18nKey:"canvas.apieditor.render-test-apibutton.test-api",children:"Test API"})})};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:(0,A.t)("canvas.apieditor.label-endpoint","Endpoint"),labelWidth:13,grow:!0,children:(0,y.jsx)(ti.g,{context:e,value:t?.endpoint,onChange:i,item:ml})})}),(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:(0,A.t)("canvas.apieditor.label-method","Method"),labelWidth:13,grow:!0,children:(0,y.jsx)(br.z,{value:t?.method,options:Gf,onChange:o,fullWidth:!0})})}),t?.method!==$.DO.GET&&(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:"Content-Type",labelWidth:13,grow:!0,children:(0,y.jsx)(xe.l6,{options:$f,allowCustomValue:!0,formatCreateLabel:l,value:t?.contentType,onChange:s})})}),(0,y.jsx)("br",{}),(0,y.jsx)(wn.D,{label:(0,A.t)("canvas.apieditor.label-query-parameters","Query parameters"),children:(0,y.jsx)(Xn,{value:t?.queryParams??[],onChange:c})}),(0,y.jsx)(wn.D,{label:(0,A.t)("canvas.apieditor.label-header-parameters","Header parameters"),children:(0,y.jsx)(Xn,{value:t?.headerParams??[],onChange:u})}),t?.method!==$.DO.GET&&t?.contentType&&(0,y.jsx)(wn.D,{label:(0,A.t)("canvas.apieditor.label-payload","Payload"),children:(0,y.jsx)(ti.g,{context:e,value:t?.data??"{}",onChange:a,item:{...ml,settings:{useTextarea:!0}}})}),f(t),(0,y.jsx)("br",{}),t?.method!==$.DO.GET&&t?.contentType===ri.contentType&&d(t?.data??"{}")]})}const Hf=[{label:"primary",value:"primary"},{label:"secondary",value:"secondary"},{label:"success",value:"success"},{label:"destructive",value:"destructive"}],Yf=({value:t,onChange:e})=>{t||(t=$i);const n=(0,F.useCallback)(r=>{e({...t,variant:r?.value??$i.variant})},[e,t]);return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:(0,A.t)("canvas.button-style-editor.label-variant","Variant"),grow:!0,children:(0,y.jsx)(xe.l6,{options:Hf,value:t?.variant,onChange:n})})})})};var no=(t=>(t.Straight="straight",t))(no||{}),Kf=(t=>(t.Forward="forward",t.Reverse="reverse",t.Both="both",t.None="none",t))(Kf||{});const Zt="#D9D9D9",Er="#000000",Xf="#F0F4FD",Uf=ot.$W.theme2.colors.text.primary;var Ge=(t=>(t.Top="top",t.Bottom="bottom",t.Left="left",t.Right="right",t.HorizontalCenter="hcenter",t.VerticalCenter="vcenter",t))(Ge||{}),st=(t=>(t.Left="left",t.Center="center",t.Right="right",t))(st||{}),ct=(t=>(t.Top="top",t.Middle="middle",t.Bottom="bottom",t))(ct||{});const ri={endpoint:"",method:$.DO.POST,data:"{}",contentType:"application/json",queryParams:[],headerParams:[]},$i={variant:"primary"},Zf=({data:t})=>{const e=(0,Pt.of)(Qf,t),[n,r]=(0,F.useState)(!1),i=o=>{r(o)},a=()=>{t?.api&&t?.api?.endpoint&&(r(!0),Fi(t.api,i))};return(0,y.jsx)(dn.$n,{type:"submit",variant:t?.style?.variant,onClick:a,className:e.button,children:(0,y.jsxs)("span",{children:[n&&(0,y.jsx)(We.y,{inline:!0,className:e.buttonSpinner}),t?.text]})})},Qf=(t,e)=>({button:(0,Q.css)({height:"100%",width:"100%",display:"grid","> span":{display:"inline-grid",gridAutoFlow:"column",textAlign:e?.align,fontSize:`${e?.size}px`,color:e?.color}}),buttonSpinner:(0,Q.css)({marginRight:t.spacing(.5)})}),qf={id:"button",name:"Button",description:"Button",state:mr.pn.beta,standardEditorConfig:{background:!1},display:Zf,defaultSize:{width:150,height:45},getNewOptions:t=>({...t,config:{text:{mode:ft.RU.Fixed,fixed:"Button"},align:st.Center,color:{fixed:Xf},size:14,api:ri,style:$i},background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??32,height:t?.placement?.height??78,top:t?.placement?.top??100,left:t?.placement?.left??100,rotation:t?.placement?.rotation??0}}),prepareData:(t,e)=>{const n=e.config,r=()=>{if(n?.api)return n.api={...n.api,method:n.api.method??ri.method,contentType:n.api.contentType??ri.contentType},n.api},i={text:n?.text?t.getText(n.text).value():"",align:n?.align??st.Center,size:n?.size??14,api:r(),style:n?.style??$i};return n?.color&&(i.color=t.getColor(n.color).value()),i},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.button-item.category-button","Button")];t.addCustomEditor({category:e,id:"styleSelector",path:"config.style",name:(0,A.t)("canvas.button-item.name-style","Style"),editor:Yf}).addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.button-item.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.button-item.name-text-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.button-item.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.button-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.button-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.button-item.label.right","Right")}]},defaultValue:st.Left}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.button-item.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.button-item.placeholder.auto","Auto")}}).addCustomEditor({category:e,id:"apiSelector",path:"config.api",name:(0,A.t)("canvas.button-item.name-api","API"),editor:Wf})}};var Wi=j(24726);const Jf={id:"cloud",name:"Cloud",description:"Cloud",display:t=>{const{data:e}=t,n=th(ot.$W.theme2,e),r=(0,Wi.A)();return(0,y.jsxs)("div",{className:n.container,children:[(0,y.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 110 70",width:"100%",height:"100%",preserveAspectRatio:"none",children:[(0,y.jsxs)("defs",{children:[(0,y.jsx)("pattern",{id:`image-${r}`,patternUnits:"userSpaceOnUse",width:"110",height:"70",children:(0,y.jsx)("image",{xlinkHref:e?.backgroundImage,x:"-50",y:"-50",width:"300",height:"300"})}),(0,y.jsx)("clipPath",{id:`cloudClip-${r}`,children:(0,y.jsx)("path",{d:"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z"})})]}),(0,y.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",clipPath:`url(#cloudClip-${r})`,style:{fill:"none"}}),(0,y.jsx)("path",{d:"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z",style:{fill:e?.backgroundImage?`url(#image-${r})`:e?.backgroundColor}}),(0,y.jsx)("path",{d:"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z",clipPath:`url(#cloudClip-${r})`,className:n.elementBorder})]}),(0,y.jsx)("span",{className:n.text,children:e?.text})]})},defaultSize:{width:110,height:70},getNewOptions:t=>({...t,background:{color:{fixed:Zt}},config:{align:st.Center,valign:ct.Middle,color:{fixed:Er}},placement:{width:t?.placement?.width??110,height:t?.placement?.height??70,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config,r={text:n?.text?t.getText(n.text).value():"",field:n?.text?.field,align:n?.align??st.Center,valign:n?.valign??ct.Middle,size:n?.size};n?.color&&(r.color=t.getColor(n.color).value());const{background:i,border:a}=e;return r.backgroundColor=i?.color?t.getColor(i.color).value():Zt,r.borderColor=a?.color?t.getColor(a.color).value():Zt,r.borderWidth=a?.width??0,r.backgroundImage=i?.image?t.getResource(i.image).value():void 0,r},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.cloud-item.category-cloud","Cloud")];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.cloud-item.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.cloud-item.name-text-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.cloud-item.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.cloud-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.cloud-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.cloud-item.label.right","Right")}]},defaultValue:st.Left}).addRadio({category:e,path:"config.valign",name:(0,A.t)("canvas.cloud-item.name-vertical-align","Vertical align"),settings:{options:[{value:ct.Top,label:(0,A.t)("canvas.cloud-item.label.top","Top")},{value:ct.Middle,label:(0,A.t)("canvas.cloud-item.label.middle","Middle")},{value:ct.Bottom,label:(0,A.t)("canvas.cloud-item.label.bottom","Bottom")}]},defaultValue:ct.Middle}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.cloud-item.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.cloud-item.placeholder.auto","Auto")}})},customConnectionAnchors:[{x:-.58,y:.63},{x:-.22,y:.99},{x:.235,y:.75},{x:.8,y:.6},{x:.785,y:.06},{x:.91,y:-.51},{x:.62,y:-.635},{x:.05,y:-.98},{x:-.45,y:-.635},{x:-.8,y:-.58},{x:-.78,y:-.06},{x:-.9,y:.48}]},th=(t,e)=>{const n=e?.valign===ct.Middle?"50%":e?.valign===ct.Top?"10%":"90%",r=e?.align===st.Center?"50%":e?.align===st.Left?"10%":"90%",i=`translate(${e?.align===st.Center?"-50%":e?.align===st.Left?"10%":"-90%"}, ${e?.valign===ct.Middle?"-50%":e?.valign===ct.Top?"10%":"-90%"})`;return{container:(0,Q.css)({height:"100%",width:"100%"}),text:(0,Q.css)({position:"absolute",top:n,left:r,transform:i,fontSize:`${e?.size}px`,color:e?.color}),elementBorder:(0,Q.css)({fill:"none",stroke:e?.borderColor??"none",strokeWidth:e?.borderWidth??0,strokeLinejoin:"round"})}};var Dn=j(68694);const eh={id:"droneFront",name:"Drone Front",description:"Drone front",display:({data:t})=>{const e=(0,Pt.of)(nh),n=`rotate(${t?.rollAngle?t.rollAngle:0}deg)`;return(0,y.jsxs)("svg",{className:e.droneFront,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 1300 290",style:{transform:n,stroke:Zt},children:[(0,y.jsxs)("g",{className:"arms",stroke:Zt,strokeWidth:"28px",children:[(0,y.jsx)("line",{x1:"510",x2:"320",y1:"100",y2:"150"}),(0,y.jsx)("line",{x1:"510",x2:"320",y1:"190",y2:"210"}),(0,y.jsx)("line",{x1:"790",x2:"980",y1:"190",y2:"210"}),(0,y.jsx)("line",{x1:"790",x2:"980",y1:"100",y2:"150"})]}),(0,y.jsxs)("g",{className:"body",stroke:Zt,strokeWidth:"28px",children:[(0,y.jsx)("path",{fill:"none",d:" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z "}),(0,y.jsx)("circle",{cx:"650",cy:"160",r:"40",fill:"none"})]}),(0,y.jsxs)("g",{className:"motors",stroke:Zt,strokeWidth:"28px",children:[(0,y.jsx)("path",{className:"motor",fill:"none",d:" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z "}),(0,y.jsx)("path",{className:"motor",fill:"none",d:" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z "})]}),(0,y.jsxs)("g",{className:"propellers",fill:Zt,children:[(0,y.jsx)("path",{className:"prop",d:" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z "}),(0,y.jsx)("path",{className:"prop",d:" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z "})]})]})},defaultSize:{width:100,height:26},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??26,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config;return{rollAngle:n?.rollAngle?t.getScalar(n.rollAngle).value():0}},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.drone-front-item.category-drone-front","Drone Front")];t.addCustomEditor({category:e,id:"rollAngle",path:"config.rollAngle",name:(0,A.t)("canvas.drone-front-item.name-roll-angle","Roll Angle"),editor:Dn.A})}},nh=t=>({droneFront:(0,Q.css)({transition:"transform 0.4s"})}),rh={id:"droneSide",name:"Drone Side",description:"Drone Side",display:({data:t})=>{const e=(0,Pt.of)(ih),n=`rotate(${t?.pitchAngle?t.pitchAngle:0}deg)`;return(0,y.jsxs)("svg",{className:e.droneSide,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 1300 290",style:{transform:n,stroke:Zt},children:[(0,y.jsxs)("g",{className:"arms",stroke:Zt,strokeWidth:"28px",children:[(0,y.jsx)("line",{x1:"510",x2:"320",y1:"100",y2:"150"}),(0,y.jsx)("line",{x1:"510",x2:"320",y1:"190",y2:"210"}),(0,y.jsx)("line",{x1:"790",x2:"980",y1:"190",y2:"210"}),(0,y.jsx)("line",{x1:"790",x2:"980",y1:"100",y2:"150"})]}),(0,y.jsx)("g",{className:"body",stroke:Zt,strokeWidth:"28px",children:(0,y.jsx)("path",{fill:"none",d:" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z "})}),(0,y.jsxs)("g",{className:"motors",stroke:Zt,strokeWidth:"28px",children:[(0,y.jsx)("path",{className:"motor",fill:"none",d:" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z "}),(0,y.jsx)("path",{className:"motor",fill:"none",d:" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z "})]}),(0,y.jsxs)("g",{className:"propellers",fill:Zt,children:[(0,y.jsx)("path",{className:"prop",d:" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z "}),(0,y.jsx)("path",{className:"prop",d:" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z "})]})]})},defaultSize:{width:100,height:26},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??26,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config;return{pitchAngle:n?.pitchAngle?t.getScalar(n.pitchAngle).value():0}},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.drone-side-item.category-drone-side","Drone Side")];t.addCustomEditor({category:e,id:"pitchAngle",path:"config.pitchAngle",name:(0,A.t)("canvas.drone-side-item.name-pitch-angle","Pitch Angle"),editor:Dn.A})}},ih=t=>({droneSide:(0,Q.css)({transition:"transform 0.4s"})}),ah={id:"droneTop",name:"Drone Top",description:"Drone top",display:({data:t})=>{const e=(0,Pt.of)(oh),n=`spin ${t?.fRightRotorRPM?60/Math.abs(t.fRightRotorRPM):0}s linear infinite`,r=`spin ${t?.fLeftRotorRPM?60/Math.abs(t.fLeftRotorRPM):0}s linear infinite`,i=`spin ${t?.bRightRotorRPM?60/Math.abs(t.bRightRotorRPM):0}s linear infinite`,a=`spin ${t?.bLeftRotorRPM?60/Math.abs(t.bLeftRotorRPM):0}s linear infinite`,o=`rotate(${t?.yawAngle?t.yawAngle:0}deg)`;return(0,y.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"-43 -43 640 640",xmlSpace:"preserve",style:{transform:o,fill:Zt},children:[(0,y.jsx)("path",{fillRule:"evenodd",d:" M 137.95 127.967 C 137.14 127.157 136.189 126.58 135.178 126.218 C 138.173 121.545 139.967 116.036 140.125 110.123 L 217.64 151.862 C 214.049 157.411 211.8 163.922 211.386 170.95 L 209.694 199.712 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 Z  M 134.268 426.981 C 130.211 421.314 124.328 417.045 117.482 415.041 L 201.999 330.523 L 201.385 340.955 C 200.67 353.107 202.829 364.914 207.563 375.673 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 Z  M 324.765 373.673 L 228.527 373.673 Q 215.374 358.611 216.361 341.835 L 226.361 171.832 C 226.825 163.94 231.012 157.096 237.146 152.957 L 316.146 152.957 C 322.28 157.096 326.466 163.94 326.931 171.832 L 336.931 341.835 Q 337.918 358.611 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 Z  M 435.81 415.041 C 428.964 417.045 423.081 421.314 419.024 426.981 L 345.727 375.673 C 350.461 364.914 352.62 353.107 351.905 340.955 L 351.291 330.523 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 Z  M 343.596 199.713 L 341.904 170.951 C 341.49 163.923 339.242 157.411 335.651 151.863 L 413.167 110.124 C 413.325 116.037 415.119 121.546 418.114 126.219 C 417.103 126.581 416.152 127.158 415.342 127.968 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 Z  M 444.646 92.771 C 453.744 92.771 461.146 100.172 461.146 109.271 C 461.146 118.369 453.744 125.771 444.646 125.771 C 435.548 125.771 428.146 118.369 428.146 109.271 C 428.146 100.172 435.548 92.771 444.646 92.771 L 444.646 92.771 L 444.646 92.771 L 444.646 92.771 Z  M 108.647 92.771 C 117.745 92.771 125.147 100.172 125.147 109.271 C 125.147 118.369 117.745 125.771 108.647 125.771 C 99.549 125.771 92.147 118.369 92.147 109.271 C 92.147 100.172 99.549 92.771 108.647 92.771 L 108.647 92.771 L 108.647 92.771 Z  M 108.647 461.771 C 99.549 461.771 92.147 454.369 92.147 445.271 C 92.147 436.172 99.549 428.771 108.647 428.771 C 117.745 428.771 125.147 436.172 125.147 445.271 C 125.147 454.369 117.745 461.771 108.647 461.771 L 108.647 461.771 Z  M 92.322 136.202 C 97.086 139.1 102.675 140.771 108.647 140.771 C 114.883 140.771 120.697 138.941 125.594 135.802 C 125.956 136.813 126.534 137.764 127.343 138.573 L 207.342 218.573 C 207.711 218.942 208.109 219.264 208.528 219.54 L 203.212 309.908 C 201.794 310.182 200.44 310.869 199.342 311.967 L 95.343 415.967 C 94.954 416.356 94.62 416.779 94.335 417.224 C 93.651 417.575 92.976 417.942 92.322 418.34 Q 84.615 424.182 81.716 428.946 C 78.817 433.71 77.147 439.299 77.147 445.271 C 77.147 462.64 91.278 476.771 108.647 476.771 C 114.619 476.771 120.208 475.1 124.972 472.202 C 129.736 469.304 132.678 466.36 135.577 461.596 C 138.476 456.832 140.147 451.243 140.147 445.271 C 140.147 443.943 140.055 442.637 139.895 441.352 L 214.997 388.78 C 217.05 391.677 336.242 391.678 338.295 388.78 L 413.398 441.352 C 413.238 442.637 413.146 443.943 413.146 445.271 C 413.146 451.243 414.817 456.832 417.715 461.596 C 420.613 466.36 423.557 469.304 428.321 472.202 C 433.085 475.1 438.674 476.771 444.646 476.771 C 462.015 476.771 476.146 462.64 476.146 445.271 C 476.146 439.299 474.475 433.71 471.577 428.946 C 468.679 424.182 459.642 417.575 458.958 417.224 C 458.672 416.779 458.339 416.356 457.95 415.967 L 353.95 311.967 C 352.852 310.869 351.498 310.182 350.08 309.908 L 344.764 219.54 C 345.183 219.264 345.581 218.942 345.95 218.573 L 425.95 138.573 C 426.76 137.763 427.337 136.812 427.699 135.802 C 432.596 138.941 438.409 140.771 444.646 140.771 C 450.618 140.771 456.207 139.1 460.971 136.202 C 465.735 133.304 468.679 130.36 471.577 125.596 C 474.475 120.832 476.146 115.243 476.146 109.271 C 476.146 91.903 462.015 77.772 444.646 77.772 C 438.674 77.772 433.085 79.442 428.321 82.34 L 416.215 91.446 L 324.765 140.688 C 318.402 136.324 310.718 133.771 302.473 133.771 L 250.819 133.771 C 242.574 133.771 234.89 136.324 228.527 140.688 L 137.078 91.446 L 124.972 82.34 C 120.208 79.442 114.619 77.772 108.647 77.772 C 91.278 77.772 77.147 91.903 77.147 109.271 C 77.147 115.243 78.818 120.832 81.716 125.595 C 84.614 130.358 87.558 133.304 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 Z  M 444.646 461.771 C 435.548 461.771 428.146 454.369 428.146 445.271 C 428.146 436.172 435.548 428.771 444.646 428.771 C 453.744 428.771 461.146 436.172 461.146 445.271 C 461.146 454.369 453.744 461.771 444.646 461.771 Z "}),(0,y.jsx)("path",{fillRule:"evenodd",d:" M 259.458 334.235 L 259.458 337.211 L 254.514 337.211 L 254.514 350.795 L 250.842 350.795 L 250.842 337.211 L 245.898 337.211 L 245.898 334.235 L 259.458 334.235 Z  M 266.226 347.939 L 272.586 347.939 L 272.754 350.627 L 272.754 350.627 Q 270.498 350.867 265.074 350.867 L 265.074 350.867 L 265.074 350.867 Q 263.418 350.867 262.434 349.967 L 262.434 349.967 L 262.434 349.967 Q 261.45 349.067 261.426 347.531 L 261.426 347.531 L 261.426 337.499 L 261.426 337.499 Q 261.45 335.963 262.434 335.063 L 262.434 335.063 L 262.434 335.063 Q 263.418 334.163 265.074 334.163 L 265.074 334.163 L 265.074 334.163 Q 270.498 334.163 272.754 334.403 L 272.754 334.403 L 272.586 337.115 L 266.226 337.115 L 266.226 337.115 Q 265.626 337.115 265.362 337.403 L 265.362 337.403 L 265.362 337.403 Q 265.098 337.691 265.098 338.339 L 265.098 338.339 L 265.098 340.859 L 271.698 340.859 L 271.698 343.499 L 265.098 343.499 L 265.098 346.691 L 265.098 346.691 Q 265.098 347.363 265.362 347.651 L 265.362 347.651 L 265.362 347.651 Q 265.626 347.939 266.226 347.939 L 266.226 347.939 Z  M 275.202 333.995 L 278.73 333.995 L 278.73 346.931 L 278.73 346.931 Q 278.73 348.131 280.074 348.131 L 280.074 348.131 L 281.034 348.131 L 281.442 350.603 L 281.442 350.603 Q 280.53 351.083 278.61 351.083 L 278.61 351.083 L 278.61 351.083 Q 277.026 351.083 276.114 350.231 L 276.114 350.231 L 276.114 350.231 Q 275.202 349.379 275.202 347.819 L 275.202 347.819 L 275.202 333.995 Z  M 283.05 333.995 L 286.578 333.995 L 286.578 346.931 L 286.578 346.931 Q 286.578 348.131 287.922 348.131 L 287.922 348.131 L 288.882 348.131 L 289.29 350.603 L 289.29 350.603 Q 288.378 351.083 286.458 351.083 L 286.458 351.083 L 286.458 351.083 Q 284.874 351.083 283.962 350.231 L 283.962 350.231 L 283.962 350.231 Q 283.05 349.379 283.05 347.819 L 283.05 347.819 L 283.05 333.995 Z  M 292.086 335.759 L 292.086 335.759 L 292.086 335.759 Q 293.634 333.923 297.618 333.923 L 297.618 333.923 L 297.618 333.923 Q 301.602 333.923 303.162 335.759 L 303.162 335.759 L 303.162 335.759 Q 304.722 337.595 304.722 342.515 L 304.722 342.515 L 304.722 342.515 Q 304.722 347.435 303.162 349.271 L 303.162 349.271 L 303.162 349.271 Q 301.602 351.107 297.618 351.107 L 297.618 351.107 L 297.618 351.107 Q 293.634 351.107 292.086 349.271 L 292.086 349.271 L 292.086 349.271 Q 290.538 347.435 290.538 342.515 L 290.538 342.515 L 290.538 342.515 Q 290.538 337.595 292.086 335.759 Z  M 300.174 338.051 L 300.174 338.051 L 300.174 338.051 Q 299.49 336.875 297.618 336.875 L 297.618 336.875 L 297.618 336.875 Q 295.746 336.875 295.062 338.051 L 295.062 338.051 L 295.062 338.051 Q 294.378 339.227 294.378 342.515 L 294.378 342.515 L 294.378 342.515 Q 294.378 345.803 295.062 346.979 L 295.062 346.979 L 295.062 346.979 Q 295.746 348.155 297.618 348.155 L 297.618 348.155 L 297.618 348.155 Q 299.49 348.155 300.174 346.979 L 300.174 346.979 L 300.174 346.979 Q 300.858 345.803 300.858 342.515 L 300.858 342.515 L 300.858 342.515 Q 300.858 339.227 300.174 338.051 Z "}),(0,y.jsxs)("g",{className:"propeller-group",children:[(0,y.jsx)("path",{className:`${e.propeller} ${e.propellerCW}`,style:{animation:i},d:" M 461.563 418.77 L 463.992 416.34 Q 465.495 407.116 466.461 400.395 C 467.426 393.675 469.363 388.087 474.731 383.284 Q 533.862 341.514 538.196 338.859 C 542.529 336.203 548.345 334.299 551.492 338.29 C 554.639 342.282 553.481 346.02 549.419 350.082 L 471.147 428.354 L 461.563 418.77 Z  M 427.729 471.772 L 425.299 474.202 Q 423.797 483.426 422.831 490.146 C 421.866 496.867 419.929 502.454 414.561 507.257 Q 355.43 549.028 351.096 551.683 C 346.763 554.338 340.947 556.243 337.8 552.251 C 334.653 548.26 335.811 544.522 339.873 540.46 L 418.145 462.187 L 427.729 471.772 Z "}),(0,y.jsx)("path",{className:`${e.propeller} ${e.propellerCCW}`,style:{animation:n},d:" M 461.563 135.773 L 463.992 138.203 Q 465.495 147.426 466.461 154.147 C 467.426 160.868 469.363 166.455 474.731 171.258 Q 533.862 213.028 538.196 215.684 C 542.529 218.339 548.345 220.244 551.492 216.252 C 554.639 212.26 553.481 208.523 549.419 204.46 L 471.147 126.188 L 461.563 135.773 Z  M 427.729 82.77 L 425.299 80.34 Q 423.797 71.117 422.831 64.396 C 421.866 57.675 419.929 52.088 414.561 47.285 Q 355.43 5.515 351.096 2.859 C 346.763 0.204 340.947 -1.701 337.8 2.291 C 334.653 6.282 335.811 10.02 339.873 14.082 L 418.145 92.355 L 427.729 82.77 Z "}),(0,y.jsx)("path",{className:`${e.propeller} ${e.propellerCCW}`,style:{animation:a},d:" M 125.563 471.772 L 127.993 474.202 Q 129.496 483.426 130.461 490.146 C 131.427 496.867 133.363 502.454 138.731 507.257 Q 197.863 549.028 202.196 551.683 C 206.53 554.338 212.345 556.243 215.492 552.251 C 218.639 548.26 217.482 544.522 213.419 540.46 L 135.148 462.187 L 125.563 471.772 Z  M 91.73 418.77 L 89.3 416.34 Q 87.797 407.116 86.832 400.395 C 85.866 393.675 83.93 388.087 78.562 383.284 Q 19.431 341.514 15.097 338.859 C 10.763 336.203 4.948 334.299 1.801 338.29 C -1.346 342.282 -0.189 346.02 3.874 350.082 L 82.146 428.354 L 91.73 418.77 Z "}),(0,y.jsx)("path",{className:`${e.propeller} ${e.propellerCW}`,style:{animation:r},d:" M 125.563 82.77 L 127.993 80.34 Q 129.496 71.117 130.461 64.396 C 131.427 57.675 133.363 52.088 138.731 47.285 Q 197.863 5.515 202.196 2.859 C 206.53 0.204 212.345 -1.701 215.492 2.291 C 218.639 6.282 217.482 10.02 213.419 14.083 L 135.147 92.355 L 125.563 82.77 Z  M 91.73 135.773 L 89.3 138.203 Q 87.797 147.426 86.832 154.147 C 85.866 160.868 83.93 166.455 78.562 171.258 Q 19.431 213.028 15.097 215.684 C 10.763 218.339 4.948 220.243 1.801 216.252 C -1.346 212.26 -0.189 208.523 3.874 204.46 L 82.146 126.188 L 91.73 135.773 Z "})]})]})},defaultSize:{width:100,height:100},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config;return{bRightRotorRPM:n?.bRightRotorRPM?t.getScalar(n.bRightRotorRPM).value():0,bLeftRotorRPM:n?.bLeftRotorRPM?t.getScalar(n.bLeftRotorRPM).value():0,fRightRotorRPM:n?.fRightRotorRPM?t.getScalar(n.fRightRotorRPM).value():0,fLeftRotorRPM:n?.fLeftRotorRPM?t.getScalar(n.fLeftRotorRPM).value():0,yawAngle:n?.yawAngle?t.getScalar(n.yawAngle).value():0}},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.drone-top-item.category-drone-top","Drone Top")];t.addCustomEditor({category:e,id:"yawAngle",path:"config.yawAngle",name:(0,A.t)("canvas.drone-top-item.name-yaw-angle","Yaw Angle"),editor:Dn.A}).addCustomEditor({category:e,id:"fRightRotorRPM",path:"config.fRightRotorRPM",name:(0,A.t)("canvas.drone-top-item.name-front-right-rotor-rpm","Front Right Rotor RPM"),editor:Dn.A}).addCustomEditor({category:e,id:"fLeftRotorRPM",path:"config.fLeftRotorRPM",name:(0,A.t)("canvas.drone-top-item.name-front-left-rotor-rpm","Front Left Rotor RPM"),editor:Dn.A}).addCustomEditor({category:e,id:"bRightRotorRPM",path:"config.bRightRotorRPM",name:(0,A.t)("canvas.drone-top-item.name-back-right-rotor-rpm","Back Right Rotor RPM"),editor:Dn.A}).addCustomEditor({category:e,id:"bLeftRotorRPM",path:"config.bLeftRotorRPM",name:(0,A.t)("canvas.drone-top-item.name-back-left-rotor-rpm","Back Left Rotor RPM"),editor:Dn.A})}},oh=t=>({propeller:(0,Q.css)({transformOrigin:"50% 50%",transformBox:"fill-box",display:"block","@keyframes spin":{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}}),propellerCW:(0,Q.css)({animationDirection:"normal"}),propellerCCW:(0,Q.css)({animationDirection:"reverse"})}),sh={id:"ellipse",name:"Ellipse",description:"Ellipse",display:t=>{const{data:e}=t,n=lh(ot.$W.theme2,e),r=(0,Wi.A)();return(0,y.jsxs)("div",{className:n.container,children:[(0,y.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200",width:"100%",height:"100%",preserveAspectRatio:"none",children:[(0,y.jsxs)("defs",{children:[(0,y.jsx)("pattern",{id:`image-${r}`,patternUnits:"userSpaceOnUse",width:"200",height:"200",children:(0,y.jsx)("image",{xlinkHref:e?.backgroundImage,x:"-50",y:"-50",width:"300",height:"300"})}),(0,y.jsx)("clipPath",{id:`ellipseClip-${r}`,children:(0,y.jsx)("ellipse",{cx:"50%",cy:"50%",rx:"50%",ry:"50%"})})]}),(0,y.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",clipPath:`url(#ellipseClip-${r})`,style:{fill:"none"}}),(0,y.jsx)("ellipse",{cx:"50%",cy:"50%",rx:"50%",ry:"50%",style:{fill:e?.backgroundImage?`url(#image-${r})`:e?.backgroundColor}}),(0,y.jsx)("ellipse",{cx:"50%",cy:"50%",rx:"50%",ry:"50%",clipPath:`url(#ellipseClip-${r})`,className:n.elementBorder})]}),(0,y.jsx)("span",{className:n.text,children:e?.text})]})},defaultSize:{width:160,height:160},getNewOptions:t=>({...t,background:{color:{fixed:Zt}},config:{align:st.Center,valign:ct.Middle,color:{fixed:Er}},placement:{width:t?.placement?.width??160,height:t?.placement?.height??138,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config,r={text:n?.text?t.getText(n.text).value():"",field:n?.text?.field,align:n?.align??st.Center,valign:n?.valign??ct.Middle,size:n?.size};n?.color&&(r.color=t.getColor(n.color).value());const{background:i,border:a}=e;return r.backgroundColor=i?.color?t.getColor(i.color).value():Zt,r.borderColor=a?.color?t.getColor(a.color).value():Zt,r.borderWidth=a?.width??0,r.backgroundImage=i?.image?t.getResource(i.image).value():void 0,r},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.ellipse-item.category-ellipse","Ellipse")];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.ellipse-item.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.ellipse-item.name-text-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.ellipse-item.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.ellipse-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.ellipse-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.ellipse-item.label.right","Right")}]},defaultValue:st.Left}).addRadio({category:e,path:"config.valign",name:(0,A.t)("canvas.ellipse-item.name-vertical-align","Vertical align"),settings:{options:[{value:ct.Top,label:(0,A.t)("canvas.ellipse-item.label.top","Top")},{value:ct.Middle,label:(0,A.t)("canvas.ellipse-item.label.middle","Middle")},{value:ct.Bottom,label:(0,A.t)("canvas.ellipse-item.label.bottom","Bottom")}]},defaultValue:ct.Middle}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.ellipse-item.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.ellipse-item.placeholder.auto","Auto")}})},customConnectionAnchors:[{x:-1,y:0},{x:-.7,y:.7},{x:0,y:1},{x:.7,y:.7},{x:1,y:0},{x:.7,y:-.7},{x:0,y:-1},{x:-.7,y:-.7}]},lh=(t,e)=>{const n=e?.valign===ct.Middle?"50%":e?.valign===ct.Top?"10%":"90%",r=e?.align===st.Center?"50%":e?.align===st.Left?"10%":"90%",i=`translate(${e?.align===st.Center?"-50%":e?.align===st.Left?"10%":"-90%"}, ${e?.valign===ct.Middle?"-50%":e?.valign===ct.Top?"10%":"-90%"})`;return{container:(0,Q.css)({height:"100%",width:"100%"}),text:(0,Q.css)({position:"absolute",top:n,left:r,transform:i,fontSize:`${e?.size}px`,color:e?.color}),elementBorder:(0,Q.css)({fill:"none",stroke:e?.borderColor??"none",strokeWidth:e?.borderWidth??0,strokeLinejoin:"round"})}};var ch=j(30868),xl=j(44798),uh=j(20012);const dh=(0,Q.css)({path:{vectorEffect:"non-scaling-stroke"}});function fh(t){const{data:e}=t;if(!e?.path)return null;const n={fill:e?.fill,stroke:e?.strokeColor,strokeWidth:e?.stroke,height:"100%",width:"100%"};return(0,y.jsx)(ch.y,{src:e.path,style:n,className:n.strokeWidth?dh:void 0})}const hh={id:"icon",name:"Icon",description:"SVG Icon display",display:fh,getNewOptions:t=>({...t,config:{path:{mode:ft.q_.Fixed,fixed:"img/icons/unicons/question-circle.svg"},fill:{fixed:Zt}},background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??100,top:t?.placement?.top??100,left:t?.placement?.left??100,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config;let r;n?.path&&(r=t.getResource(n.path).value()),(!r||!(0,ne.isString)(r))&&(r=(0,uh.D)("img/icons/unicons/question-circle.svg"));const i={path:r,fill:n?.fill?t.getColor(n.fill).value():Zt};return n?.stroke?.width&&n?.stroke.color&&n.stroke.width>0&&(i.stroke=n.stroke?.width,i.strokeColor=t.getColor(n.stroke.color).value()),i},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.icon-item.category-icon","Icon")];t.addCustomEditor({category:e,id:"iconSelector",path:"config.path",name:(0,A.t)("canvas.icon-item.name-svg-path","SVG Path"),editor:xl.m,settings:{resourceType:"icon",maxFiles:2e3}}).addCustomEditor({category:e,id:"config.fill",path:"config.fill",name:(0,A.t)("canvas.icon-item.name-fill-color","Fill color"),editor:fe.N,settings:{},defaultValue:{fixed:"grey"}})}};var Hi=j(24120),yl=j(62467),wr=j(64400),bl=j(56755),Cl=j(48457);const vh={settings:{}},ph=t=>{const{data:e,isSelected:n,config:r}=t,i=(0,Pt.of)(Sl(e)),a=(0,wr.d2)(),o=a.instanceState?.scene;let s;s=a.instanceState?.scene?.data.series;const l=(0,Hi.A)(o?.editModeEnabled??(0,yl.of)(!1)),c=()=>s&&r.text?.field&&u()?"Field not found":s&&r.text?.field&&!e?.text?"No data":e?.text?e.text:"Double click to set field",u=()=>{const d=(0,bl.BP)(s);return!(0,bl.v3)(r.text?.field,d)};return l&&n?(0,y.jsx)(gh,{...t}):(0,y.jsx)("div",{className:i.container,children:(0,y.jsx)("span",{className:i.span,children:c()})})},gh=t=>{let{data:e,config:n}=t;const r=(0,wr.d2)();let i;i=r.instanceState?.scene?.data.series;const a=(0,F.useCallback)(s=>{let l;if(l=r.instanceState?.selected[0],l){const c=l.options;l.onChange({...c,config:{...c.config,text:{fixed:"",field:s,mode:ft.RU.Field}},background:{color:{field:s,fixed:c.background?.color?.fixed??""}}});const u=r.instanceState?.scene;u&&(u.editModeEnabled.next(!1),u.updateData(u.data))}},[r.instanceState?.scene,r.instanceState?.selected]),o=(0,Pt.of)(Sl(e));return(0,y.jsx)("div",{className:o.inlineEditorContainer,children:i&&(0,y.jsx)(Cl.O,{context:{data:i},value:n.text?.field??"",onChange:a,item:vh})})},Sl=t=>e=>({container:(0,Q.css)({position:"absolute",height:"100%",width:"100%",display:"table"}),inlineEditorContainer:(0,Q.css)({height:"100%",width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1)}),span:(0,Q.css)({display:"table-cell",verticalAlign:t?.valign,textAlign:t?.align,fontSize:`${t?.size}px`,color:t?.color})}),ii={id:"metric-value",name:"Metric Value",description:"Display a field value",display:ph,hasEditMode:!0,defaultSize:{width:260,height:50},getNewOptions:t=>({...t,config:{align:st.Center,valign:ct.Middle,color:{fixed:Er},text:{mode:ft.RU.Field,fixed:"",field:""},size:20},background:{color:{fixed:Zt}},placement:{width:t?.placement?.width,height:t?.placement?.height,top:t?.placement?.top??100,left:t?.placement?.left??100,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config,r={text:n?.text?t.getText(n.text).value():"",field:n?.text?.field,align:n?.align??st.Center,valign:n?.valign??ct.Middle,size:n?.size};return n?.color&&(r.color=t.getColor(n.color).value()),r},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.category-metric-value","Metric value")];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.name-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.metric-value-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.metric-value-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.metric-value-item.label.right","Right")}]},defaultValue:st.Left}).addRadio({category:e,path:"config.valign",name:(0,A.t)("canvas.name-vertical-align","Vertical align"),settings:{options:[{value:ct.Top,label:(0,A.t)("canvas.metric-value-item.label.top","Top")},{value:ct.Middle,label:(0,A.t)("canvas.metric-value-item.label.middle","Middle")},{value:ct.Bottom,label:(0,A.t)("canvas.metric-value-item.label.bottom","Bottom")}]},defaultValue:ct.Middle}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.metric-value-item.placeholder.auto","Auto")}})}},mh={id:"parallelogram",name:"Parallelogram",description:"Parallelogram",display:t=>{const{data:e}=t,n=xh(ot.$W.theme2,e),r=(0,Wi.A)();return(0,y.jsxs)("div",{className:n.container,children:[(0,y.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 250 150",width:"100%",height:"100%",preserveAspectRatio:"none",children:[(0,y.jsxs)("defs",{children:[(0,y.jsx)("pattern",{id:`image-${r}`,patternUnits:"userSpaceOnUse",width:"250",height:"150",children:(0,y.jsx)("image",{xlinkHref:e?.backgroundImage,x:"-50",y:"-50",width:"350",height:"200"})}),(0,y.jsx)("clipPath",{id:`parallelogramClip-${r}`,children:(0,y.jsx)("polygon",{points:"0,150 50,0 250,0 200,150"})})]}),(0,y.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",clipPath:`url(#parallelogramClip-${r})`,style:{fill:"none"}}),(0,y.jsx)("polygon",{points:"0,150 50,0 250,0 200,150",style:{fill:e?.backgroundImage?`url(#image-${r})`:e?.backgroundColor}}),(0,y.jsx)("polygon",{points:"0,150 50,0 250,0 200,150",clipPath:`url(#parallelogramClip-${r})`,className:n.elementBorder})]}),(0,y.jsx)("span",{className:n.text,children:e?.text})]})},defaultSize:{width:250,height:150},getNewOptions:t=>({...t,background:{color:{fixed:Zt}},config:{align:st.Center,valign:ct.Middle,color:{fixed:Er}},placement:{width:t?.placement?.width??250,height:t?.placement?.height??150,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config,r={text:n?.text?t.getText(n.text).value():"",field:n?.text?.field,align:n?.align??st.Center,valign:n?.valign??ct.Middle,size:n?.size};n?.color&&(r.color=t.getColor(n.color).value());const{background:i,border:a}=e;return r.backgroundColor=i?.color?t.getColor(i.color).value():Zt,r.borderColor=a?.color?t.getColor(a.color).value():Zt,r.borderWidth=a?.width??0,r.backgroundImage=i?.image?t.getResource(i.image).value():void 0,r},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.parallelogram-item.category-parallelogram","Parallelogram")];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.parallelogram-item.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.parallelogram-item.name-text-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.parallelogram-item.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.parallelogram-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.parallelogram-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.parallelogram-item.label.right","Right")}]},defaultValue:st.Left}).addRadio({category:e,path:"config.valign",name:(0,A.t)("canvas.parallelogram-item.name-vertical-align","Vertical align"),settings:{options:[{value:ct.Top,label:(0,A.t)("canvas.parallelogram-item.label.top","Top")},{value:ct.Middle,label:(0,A.t)("canvas.parallelogram-item.label.middle","Middle")},{value:ct.Bottom,label:(0,A.t)("canvas.parallelogram-item.label.bottom","Bottom")}]},defaultValue:ct.Middle}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.parallelogram-item.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.parallelogram-item.placeholder.auto","Auto")}})},customConnectionAnchors:[{x:-.6,y:1},{x:-.1,y:1},{x:.5,y:1},{x:1,y:1},{x:.925,y:.6},{x:.84,y:.2},{x:.76,y:-.2},{x:.675,y:-.6},{x:-.5,y:-1},{x:.1,y:-1},{x:.6,y:-1},{x:-1,y:-1},{x:-.925,y:-.6},{x:-.84,y:-.2},{x:-.76,y:.2},{x:-.675,y:.6}]},xh=(t,e)=>{const n=e?.valign===ct.Middle?"50%":e?.valign===ct.Top?"10%":"90%",r=e?.align===st.Center?"50%":e?.align===st.Left?"10%":"90%",i=`translate(${e?.align===st.Center?"-50%":e?.align===st.Left?"10%":"-90%"}, ${e?.valign===ct.Middle?"-50%":e?.valign===ct.Top?"10%":"-90%"})`;return{container:(0,Q.css)({height:"100%",width:"100%"}),text:(0,Q.css)({position:"absolute",top:n,left:r,transform:i,fontSize:`${e?.size}px`,color:e?.color}),elementBorder:(0,Q.css)({fill:"none",stroke:e?.borderColor??"none",strokeWidth:e?.borderWidth??0,strokeLinejoin:"round"})}};var yh=j(65240);class bh extends F.PureComponent{render(){const{data:e}=this.props,n=Ch(ot.$W.theme2,e);return(0,y.jsx)("div",{className:n.container,children:(0,y.jsx)("span",{className:n.span,children:e?.text})})}}const Ch=(0,yh.N)((t,e)=>({container:(0,Q.css)({position:"absolute",height:"100%",width:"100%",display:"table"}),span:(0,Q.css)({display:"table-cell",verticalAlign:e?.valign,textAlign:e?.align,fontSize:`${e?.size}px`,color:e?.color})})),Sh={id:"rectangle",name:"Rectangle",description:"Rectangle",display:bh,defaultSize:{width:240,height:160},getNewOptions:t=>({...t,config:{align:st.Center,valign:ct.Middle,color:{fixed:Er}},background:{color:{fixed:Zt}},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config,r={text:n?.text?t.getText(n.text).value():"",field:n?.text?.field,align:n?.align??st.Center,valign:n?.valign??ct.Middle,size:n?.size};return n?.color&&(r.color=t.getColor(n.color).value()),r},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.rectangle-item.category-rectangle","Rectangle")];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.rectangle-item.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.rectangle-item.name-text-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.rectangle-item.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.rectangle-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.rectangle-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.rectangle-item.label.right","Right")}]},defaultValue:st.Left}).addRadio({category:e,path:"config.valign",name:(0,A.t)("canvas.rectangle-item.name-vertical-align","Vertical align"),settings:{options:[{value:ct.Top,label:(0,A.t)("canvas.rectangle-item.label.top","Top")},{value:ct.Middle,label:(0,A.t)("canvas.rectangle-item.label.middle","Middle")},{value:ct.Bottom,label:(0,A.t)("canvas.rectangle-item.label.bottom","Bottom")}]},defaultValue:ct.Middle}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.rectangle-item.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.rectangle-item.placeholder.auto","Auto")}})}},Eh=t=>{const e=(0,Pt.of)(Yi(t));return(0,y.jsxs)("g",{className:e.outline,children:[(0,y.jsxs)("g",{className:e.server,children:[(0,y.jsx)("path",{d:"m2.6953 37.5v20.883c0 7.6725 15.592 13.922 34.805 13.922s34.805-6.2493 34.805-13.922v-20.883"}),(0,y.jsx)("path",{d:"m2.6953 16.617v20.883c0 7.7035 15.592 13.922 34.805 13.922s34.805-6.2184 34.805-13.922v-20.883"}),(0,y.jsx)("path",{d:"m37.5 30.539c19.212 0 34.805-6.2185 34.805-13.922 0-7.7034-15.592-13.922-34.805-13.922s-34.805 6.2184-34.805 13.922c0 7.7035 15.592 13.922 34.805 13.922z"})]}),(0,y.jsxs)("g",{className:e.circleBack,children:[(0,y.jsx)("path",{transform:"matrix(2.7868 0 0 2.7868 -132.86 -110.58)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(2.7868 0 0 2.7868 -122.04 -111.7)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(2.7868 0 0 2.7868 -111.21 -114.77)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})]}),(0,y.jsxs)("g",{className:e.circle,children:[(0,y.jsx)("path",{transform:"matrix(1.4922 0 0 1.4922 -52.337 -30.65)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(1.4922 0 0 1.4922 -41.518 -31.769)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(1.4922 0 0 1.4922 -30.688 -34.842)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})]})]})},wh=t=>{const e=(0,Pt.of)(Yi(t));return(0,y.jsx)("g",{children:(0,y.jsxs)("g",{className:e.outline,transform:"matrix(1.01 0 0 1.01 -.375 -.375)",children:[(0,y.jsxs)("g",{className:e.server,children:[(0,y.jsx)("path",{d:"m3.2812 55.659 9.125-52.377h50.188l9.125 52.377"}),(0,y.jsx)("path",{d:"m3.2812 56.328c0-2.5246 2.0379-4.5625 4.5625-4.5625h59.313c2.5245 0 4.5625 2.0379 4.5625 4.5625v10.828c0 2.5245-2.038 4.5625-4.5625 4.5625h-59.313c-2.5246 0-4.5625-2.038-4.5625-4.5625z"})]}),(0,y.jsx)("path",{d:"m12.406 61.742h30.69"}),(0,y.jsx)("path",{d:"m52.8 51.765v19.953"}),(0,y.jsx)("path",{className:e.circleBack,transform:"matrix(2.7592 0 0 2.7592 -109.42 -108.61)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{className:e.circle,transform:"matrix(1.4775 0 0 1.4775 -29.697 -29.479)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})]})})},Dh=t=>{const e=(0,Pt.of)(Yi(t));return(0,y.jsxs)("g",{className:e.outline,transform:"translate(.5 .49865)",children:[(0,y.jsxs)("g",{className:e.server,children:[(0,y.jsx)("path",{d:"m3.4834 21.768 8.0783-19.456h50.875l8.0784 19.456"}),(0,y.jsx)("path",{d:"m2.3125 24.852c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"}),(0,y.jsx)("path",{d:"m2.3125 42.031c0-2.5592 2.0658-4.6251 4.625-4.6251h60.125c2.5592 0 4.625 2.0659 4.625 4.6251v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"}),(0,y.jsx)("path",{d:"m2.3125 59.172c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"})]}),(0,y.jsx)("path",{d:"m11.562 28.797h31.111"}),(0,y.jsx)("path",{d:"m52.508 20.227v17.143"}),(0,y.jsx)("path",{d:"m11.562 63.117h31.111"}),(0,y.jsx)("path",{d:"m52.508 54.547v17.143"}),(0,y.jsx)("path",{d:"m11.562 45.977h31.111"}),(0,y.jsx)("path",{d:"m52.508 37.406v17.143"}),(0,y.jsxs)("g",{className:e.circleBack,children:[(0,y.jsx)("path",{transform:"matrix(2.7868 0 0 2.7868 -111.31 -143.2)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(2.7868 0 0 2.7868 -111.31 -126.14)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(2.7868 0 0 2.7868 -111.31 -108.86)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})]}),(0,y.jsxs)("g",{className:e.circle,children:[(0,y.jsx)("path",{transform:"matrix(1.4922 0 0 1.4922 -30.794 -63.277)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(1.4922 0 0 1.4922 -30.794 -46.209)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{transform:"matrix(1.4922 0 0 1.4922 -30.794 -28.93)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})]})]})},Mh=t=>{const e=(0,Pt.of)(Yi(t));return(0,y.jsxs)("g",{className:e.outline,children:[(0,y.jsxs)("g",{className:e.server,children:[(0,y.jsx)("path",{d:"m5.3125 9.6562c0-3.5621 2.8754-6.4375 6.4375-6.4375h51.5c3.5621 0 6.4375 2.8754 6.4375 6.4375v28.625c0 3.5621-2.8754 6.4375-6.4375 6.4375h-51.5c-3.5621 0-6.4375-2.8754-6.4375-6.4375z"}),(0,y.jsx)("path",{d:"m2.8125 59.859c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z"})]}),(0,y.jsx)("path",{d:"m37.5 46.719v2.875"}),(0,y.jsx)("path",{d:"m24.625 51.343h25.75"}),(0,y.jsx)("path",{d:"m12.062 63.804h31.111"}),(0,y.jsx)("path",{d:"m53.008 55.234v17.143"}),(0,y.jsx)("path",{className:e.circleBack,transform:"matrix(2.7868 0 0 2.7868 -110.81 -108.2)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"}),(0,y.jsx)("path",{className:e.circle,transform:"matrix(1.4922 0 0 1.4922 -30.294 -28.27)",d:"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z"})]})};var Th=(t=>(t.Single="Single",t.Stack="Stack",t.Database="Database",t.Terminal="Terminal",t))(Th||{});const El=ot.Ay.theme2.colors.text.primary,kh={id:"server",name:"Server",description:"Basic server with status",display:({data:t})=>t?(0,y.jsx)("svg",{viewBox:"0 0 75 75",children:t.type==="Single"?(0,y.jsx)(wh,{...t}):t.type==="Stack"?(0,y.jsx)(Dh,{...t}):t.type==="Database"?(0,y.jsx)(Eh,{...t}):t.type==="Terminal"?(0,y.jsx)(Mh,{...t}):null}):null,defaultSize:{width:100,height:100},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??100,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},config:{type:"Single"},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config;return{blinkRate:n?.blinkRate?t.getScalar(n.blinkRate).value():0,statusColor:n?.statusColor?t.getColor(n.statusColor).value():"transparent",bulbColor:n?.bulbColor?t.getColor(n.bulbColor).value():"green",type:n?.type??"Single"}},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.server-item.category-server","Server")];t.addSelect({category:e,path:"config.type",name:(0,A.t)("canvas.server-item.name-type","Type"),settings:{options:[{value:"Single",label:(0,A.t)("canvas.server-item.type-options.label-single","Single")},{value:"Stack",label:(0,A.t)("canvas.server-item.type-options.label-stack","Stack")},{value:"Database",label:(0,A.t)("canvas.server-item.type-options.label-database","Database")},{value:"Terminal",label:(0,A.t)("canvas.server-item.type-options.label-terminal","Terminal")}]},defaultValue:"Single"}).addCustomEditor({category:e,id:"statusColor",path:"config.statusColor",name:(0,A.t)("canvas.server-item.name-status-color","Status color"),editor:fe.N,settings:{},defaultValue:{fixed:"transparent"}}).addCustomEditor({category:e,id:"bulbColor",path:"config.bulbColor",name:(0,A.t)("canvas.server-item.name-bulb-color","Bulb color"),editor:fe.N,settings:{},defaultValue:{fixed:"green"}}).addCustomEditor({category:e,id:"blinkRate",path:"config.blinkRate",name:(0,A.t)("canvas.server-item.name-blink-rate","Blink rate [hz] (0 = off)"),editor:Dn.A,settings:{min:0,max:100}})}},Yi=t=>e=>({bulb:(0,Q.css)({"@keyframes blink":{"0%":{fillOpacity:0},"50%":{fillOpacity:1},"100%":{fillOpacity:0}}}),server:(0,Q.css)({fill:t?.statusColor??"transparent"}),circle:(0,Q.css)({[e.transitions.handleMotion("no-preference","reduce")]:{animation:`blink ${t?.blinkRate?1/t.blinkRate:0}s infinite step-end`},fill:t?.bulbColor,stroke:"none"}),circleBack:(0,Q.css)({fill:El,stroke:"none",opacity:1}),outline:(0,Q.css)({stroke:El,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"4px"})}),Ah=t=>{const{data:e,isSelected:n}=t,r=(0,Pt.of)(wl(e)),a=(0,wr.d2)().instanceState?.scene;return(0,Hi.A)(a?.editModeEnabled??(0,yl.of)(!1))&&n?(0,y.jsx)(Rh,{...t}):(0,y.jsx)("div",{className:r.container,children:(0,y.jsx)("span",{className:r.span,children:e?.text?e.text:(0,A.t)("canvas.text-display.double-click-to-set","Double click to set text")})})},Rh=t=>{let{data:e,config:n}=t;const r=(0,wr.d2)();let i;i=r.instanceState?.scene?.data.series;const a=(0,F.useRef)(n.text?.fixed??"");(0,F.useEffect)(()=>()=>{l(a.current)});const o=u=>{if(u.key==="Enter"){u.preventDefault();const d=r.instanceState?.scene;d&&d.editModeEnabled.next(!1)}},s=u=>{a.current=u.currentTarget.value},l=(0,F.useCallback)(u=>{let d;if(d=r.instanceState?.selected[0],d){const f=d.options;d.onChange({...f,config:{...f.config,text:{...d.options.config.text,fixed:u}}});const h=r.instanceState?.scene;h&&h.updateData(h.data)}},[r.instanceState?.scene,r.instanceState?.selected]),c=(0,Pt.of)(wl(e));return(0,y.jsx)("div",{className:c.inlineEditorContainer,children:i&&(0,y.jsx)(Ln.p,{defaultValue:n.text?.fixed??"",onKeyDown:o,onKeyUp:s,autoFocus:!0})})},wl=t=>e=>({container:(0,Q.css)({position:"absolute",height:"100%",width:"100%",display:"table"}),inlineEditorContainer:(0,Q.css)({height:"100%",width:"100%",display:"flex",alignItems:"center",padding:e.spacing(1)}),span:(0,Q.css)({display:"table-cell",verticalAlign:t?.valign,textAlign:t?.align,fontSize:`${t?.size}px`,color:t?.color})}),Oh={id:"text",name:"Text",description:"Display text",display:Ah,hasEditMode:!0,defaultSize:{width:100,height:50},getNewOptions:t=>({...t,config:{align:st.Center,valign:ct.Middle,color:{fixed:Uf},size:16},placement:{width:t?.placement?.width??100,height:t?.placement?.height??100,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config,r={text:n?.text?t.getText(n.text).value():"",field:n?.text?.field,align:n?.align??st.Center,valign:n?.valign??ct.Middle,size:n?.size};return n?.color&&(r.color=t.getColor(n.color).value()),r},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.text-item.category-text","Text")];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.text-item.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.text-item.name-text-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.text-item.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.text-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.text-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.text-item.label.right","Right")}]},defaultValue:st.Left}).addRadio({category:e,path:"config.valign",name:(0,A.t)("canvas.text-item.name-vertical-align","Vertical align"),settings:{options:[{value:ct.Top,label:(0,A.t)("canvas.text-item.label.top","Top")},{value:ct.Middle,label:(0,A.t)("canvas.text-item.label.middle","Middle")},{value:ct.Bottom,label:(0,A.t)("canvas.text-item.label.bottom","Bottom")}]},defaultValue:ct.Middle}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.text-item.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.text-item.placeholder.auto","Auto")}})}},Lh={id:"triangle",name:"Triangle",description:"Triangle",display:t=>{const{data:e}=t,n=_h(ot.$W.theme2,e),r=(0,Wi.A)();return(0,y.jsxs)("div",{className:n.container,children:[(0,y.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200",width:"100%",height:"100%",preserveAspectRatio:"none",children:[(0,y.jsxs)("defs",{children:[(0,y.jsx)("pattern",{id:`image-${r}`,patternUnits:"userSpaceOnUse",width:"200",height:"200",children:(0,y.jsx)("image",{xlinkHref:e?.backgroundImage,x:"-50",y:"-50",width:"300",height:"300"})}),(0,y.jsx)("clipPath",{id:`triangleClip-${r}`,children:(0,y.jsx)("polygon",{points:"100,0 200,200 0,200"})})]}),(0,y.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",clipPath:`url(#triangleClip-${r})`,style:{fill:"none"}}),(0,y.jsx)("polygon",{points:"100,0 200,200 0,200",style:{fill:e?.backgroundImage?`url(#image-${r})`:e?.backgroundColor}}),(0,y.jsx)("polygon",{points:"100,0 200,200 0,200",clipPath:`url(#triangleClip-${r})`,className:n.elementBorder})]}),(0,y.jsx)("span",{className:n.text,children:e?.text})]})},defaultSize:{width:160,height:138},getNewOptions:t=>({...t,background:{color:{fixed:Zt}},config:{align:st.Center,valign:ct.Middle,color:{fixed:Er}},placement:{width:t?.placement?.width??160,height:t?.placement?.height??138,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config,r={text:n?.text?t.getText(n.text).value():"",field:n?.text?.field,align:n?.align??st.Center,valign:n?.valign??ct.Middle,size:n?.size};n?.color&&(r.color=t.getColor(n.color).value());const{background:i,border:a}=e;return r.backgroundColor=i?.color?t.getColor(i.color).value():Zt,r.borderColor=a?.color?t.getColor(a.color).value():Zt,r.borderWidth=a?.width??0,r.backgroundImage=i?.image?t.getResource(i.image).value():void 0,r},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.triangle-item.category-triangle","Triangle")];t.addCustomEditor({category:e,id:"textSelector",path:"config.text",name:(0,A.t)("canvas.triangle-item.name-text","Text"),editor:fn.h}).addCustomEditor({category:e,id:"config.color",path:"config.color",name:(0,A.t)("canvas.triangle-item.name-text-color","Text color"),editor:fe.N,settings:{},defaultValue:{}}).addRadio({category:e,path:"config.align",name:(0,A.t)("canvas.triangle-item.name-align-text","Align text"),settings:{options:[{value:st.Left,label:(0,A.t)("canvas.triangle-item.label.left","Left")},{value:st.Center,label:(0,A.t)("canvas.triangle-item.label.center","Center")},{value:st.Right,label:(0,A.t)("canvas.triangle-item.label.right","Right")}]},defaultValue:st.Left}).addRadio({category:e,path:"config.valign",name:(0,A.t)("canvas.triangle-item.name-vertical-align","Vertical align"),settings:{options:[{value:ct.Top,label:(0,A.t)("canvas.triangle-item.label.top","Top")},{value:ct.Middle,label:(0,A.t)("canvas.triangle-item.label.middle","Middle")},{value:ct.Bottom,label:(0,A.t)("canvas.triangle-item.label.bottom","Bottom")}]},defaultValue:ct.Middle}).addNumberInput({category:e,path:"config.size",name:(0,A.t)("canvas.triangle-item.name-text-size","Text size"),settings:{placeholder:(0,A.t)("canvas.triangle-item.placeholder.auto","Auto")}})},customConnectionAnchors:[{x:-1,y:-1},{x:-.8,y:-.6},{x:-.6,y:-.2},{x:-.4,y:.2},{x:-.2,y:.6},{x:0,y:1},{x:.2,y:.6},{x:.4,y:.2},{x:.6,y:-.2},{x:.8,y:-.6},{x:1,y:-1},{x:.6,y:-1},{x:.2,y:-1},{x:-.2,y:-1},{x:-.6,y:-1}]},_h=(t,e)=>{const n=e?.valign===ct.Middle?"50%":e?.valign===ct.Top?"10%":"90%",r=e?.align===st.Center?"50%":e?.align===st.Left?"10%":"90%",i=`translate(${e?.align===st.Center?"-50%":e?.align===st.Left?"10%":"-90%"}, ${e?.valign===ct.Middle?"-50%":e?.valign===ct.Top?"10%":"-90%"})`;return{container:(0,Q.css)({height:"100%",width:"100%"}),text:(0,Q.css)({position:"absolute",top:n,left:r,transform:i,fontSize:`${e?.size}px`,color:e?.color}),elementBorder:(0,Q.css)({fill:"none",stroke:e?.borderColor??"none",strokeWidth:e?.borderWidth??0,strokeLinejoin:"round"})}},Ih={id:"windTurbine",name:"Wind Turbine",description:"Spinny spinny",display:({data:t})=>{const e=(0,Pt.of)(Ph),n=`spin ${t?.rpm?60/Math.abs(t.rpm):0}s linear infinite`;return(0,y.jsxs)("svg",{viewBox:"0 0 189.326 283.989",preserveAspectRatio:"xMidYMid meet",style:{fill:Zt},children:[(0,y.jsxs)("symbol",{id:"blade",children:[(0,y.jsx)("path",{fill:"#e6e6e6",id:"blade-front",d:"M14.6491879,1.85011601 C14.2684455,-0.0535962877 10.7150812,-0.815081206 9.06473318,3.37308585 L0.434338747,70.7658933 L8.93805104,91.9607889 L15.4106729,90.437819 L17.5684455,78.3807425 L14.5218097,1.97679814 L14.6491879,1.85011601 Z"}),(0,y.jsx)("path",{fill:"#d0d6d7",id:"blade-side",d:"M11.0951276,0.581206497 C10.3336427,0.961948956 9.57215777,1.85011601 8.93735499,3.24640371 L0.306960557,70.6392111 L8.81067285,91.8341067 L3.35359629,70.0044084 L11.0951276,0.581206497 Z"})]}),(0,y.jsxs)("g",{children:[(0,y.jsxs)("g",{id:"structure",transform:"translate(58.123, 82.664)",fillRule:"nonzero",children:[(0,y.jsx)("polygon",{id:"tower",fill:"#e6e6e6",points:"33.111,10.984 39.965,10.984 44.28,196.176 28.796,196.176"}),(0,y.jsx)("path",{id:"yaw",fill:"rgba(0,0,0,0.25)",d:"M40.3454756,23.2948956 L40.7262181,34.8445476 C38.8225058,35.0986079 35.7765661,35.0986079 32.349884,34.337123 L32.7306265,23.2955916 L40.3454756,23.2955916 L40.3454756,23.2948956 Z"}),(0,y.jsx)("path",{id:"base",fill:"#d0d6d7",transform:"translate(0 42)",d:"M26.3846868,150.591647 L46.5640371,150.591647 C48.8484919,150.591647 50.7522042,152.49536 50.7522042,154.779814 L50.7522042,158.967981 L22.0691415,158.967981 L22.0691415,154.779814 C22.0691415,152.49536 23.9728538,150.591647 26.2573086,150.591647 L26.3846868,150.591647 Z"}),(0,y.jsx)("circle",{id:"nacelle",fill:"#e6e6e6",cx:"36.54",cy:"12",r:"11.93"}),(0,y.jsx)("circle",{id:"gearbox",fill:"none",stroke:"#d0d6d7",strokeWidth:"2.75",cx:"36.538",cy:"11.999",r:"5.8"})]}),(0,y.jsxs)("g",{className:e.blade,style:{animation:n},children:[(0,y.jsx)("use",{id:"blade1",href:"#blade",x:"83.24",y:"0"}),(0,y.jsx)("use",{id:"blade2",href:"#blade",x:"83.24",y:"0",transform:"rotate(120 94.663 94.663)"}),(0,y.jsx)("use",{id:"blade3",href:"#blade",x:"83.24",y:"0",transform:"rotate(-120 94.663 94.663)"})]})]})]})},defaultSize:{width:100,height:155},getNewOptions:t=>({...t,background:{color:{fixed:"transparent"}},placement:{width:t?.placement?.width??100,height:t?.placement?.height??155,top:t?.placement?.top,left:t?.placement?.left,rotation:t?.placement?.rotation??0},links:t?.links??[]}),prepareData:(t,e)=>{const n=e.config;return{rpm:n?.rpm?t.getScalar(n.rpm).value():0}},registerOptionsUI:t=>{const e=[(0,A.t)("canvas.wind-turbine-item.category-wind-turbine","Wind Turbine")];t.addCustomEditor({category:e,id:"rpm",path:"config.rpm",name:(0,A.t)("canvas.wind-turbine-item.name-rpm","RPM"),editor:Dn.A})}},Ph=t=>({blade:(0,Q.css)({transformOrigin:"94.663px 94.663px",transform:"rotate(15deg)","@keyframes spin":{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}})}),ro={...ii.getNewOptions(),placement:{...ii.getNewOptions().placement,...ii.defaultSize},type:ii.id,name:"Element 1"},Ki=[ii,Oh,sh,Sh,hh,kh,Lh,Jf,mh],Dl=[qf,Ih,ah,eh,rh],ai=new Pe.O(()=>[...Ki,...Dl]);var Ce=j(79609),Ml=j(85891),io=j(95004),zh=j(60519),Nh=j(71599),Bh=j(81538),Dr=j(73163);let jh=0;const ao=new Set(["parallelogram","triangle","cloud","ellipse"]);class Xi{constructor(e,n,r){this.item=e,this.options=n,this.parent=r,this.UID=jh++,this.revId=0,this.sizeStyle={},this.dataStyle={},this.oneClickMode=Ce.yd.Off,this.showActionConfirmation=!1,this.showActionVarsModal=!1,this.actionVars={},this.setActionVars=o=>{this.actionVars=o,this.forceUpdate()},this.initElement=o=>{this.div=o,this.applyLayoutStylesToDiv()},this.applyDrag=o=>{const s=this.options.constraint?.horizontal===$.en.Center,l=this.options.constraint?.vertical===$.gR.Center;if((s||l)&&!((this.getScene()?.selecto?.getSelectedTargets().length??0)>1)){const f=this.div?.getBoundingClientRect()?.height??100,h=l?f/4:0;o.target.style.transform=`translate(${o.translate[0]}px, ${o.translate[1]-h}px)`;return}o.target.style.transform=o.transform},this.applyRotate=o=>{const s=o.delta,l=this.options.placement,u=(l.rotation??0)+s;l.rotation=u-Math.floor(u/360)*360,o.target.style.transform=o.transform},this.applyResize=o=>{const s=this.options.placement,l=o.target.style;let c=o.delta[0],u=o.delta[1],d=o.direction[0],f=o.direction[1];if(s.rotation){const v=(s.rotation??0)*Math.PI/180,p=d,g=f;d=Math.sign(p*Math.cos(v)-g*Math.sin(v)),f=Math.sign(p*Math.sin(v)+g*Math.cos(v))}d===1?(s.width=o.width,l.width=`${s.width}px`):d===-1&&(s.left-=c,s.width=o.width,ot.$W.featureToggles.canvasPanelPanZoom?l.transform=`translate(${s.left}px, ${s.top}px) rotate(${s.rotation??0}deg)`:l.left=`${s.left}px`,l.width=`${s.width}px`),f===-1?(s.top-=u,s.height=o.height,ot.$W.featureToggles.canvasPanelPanZoom?l.transform=`translate(${s.left}px, ${s.top}px) rotate(${s.rotation??0}deg)`:l.top=`${s.top}px`,l.height=`${s.height}px`):f===1&&(s.height=o.height,l.height=`${s.height}px`)},this.handleMouseEnter=(o,s)=>{const l=this.getScene();if(!l?.isEditingEnabled&&(!l?.tooltipPayload?.isOpen||l?.tooltipPayload?.element===this)?this.handleTooltip(o):s||l?.connections.handleMouseEnter(o),this.div!=null){if(this.oneClickMode===Ce.yd.Link){const u=this.getPrimaryDataLink();u&&(this.div.style.cursor="pointer",this.div.title=`Navigate to ${u.title===""?"data link":u.title}`)}else if(this.oneClickMode===Ce.yd.Action){const u=this.getPrimaryAction();u&&(this.div.style.cursor="pointer",this.div.title=u.title)}}},this.getPrimaryDataLink=()=>{if(this.getLinks)return this.getLinks({valueRowIndex:Mr(this.data.field,this.getScene())}).find(s=>s.oneClick===!0)},this.getPrimaryAction=()=>{const o=this.getScene(),s=o?.panel?.panelContext?.canExecuteActions;if(!(s?.()??!1))return;const c={valueRowIndex:Mr(this.data.field,o)},u={links:this.options.links??[],actions:this.options.actions??[]},d=o?.data?.series;if(d){const f=(0,Dr.Xx)(u.links,u.actions),h={__dataContext:{value:{data:d,field:f,frame:d[0],frameIndex:0}}};return(0,Dr.ko)(d[0],f,h,o?.panel.props.replaceVariables,u.actions,c).find(p=>p.oneClick===!0)}},this.handleTooltip=o=>{const s=this.getScene();if(!s||!s.tooltipCallback)return;const l=s.tooltipDisableForOneClick&&this.oneClickMode!==Ce.yd.Off;if(s.tooltipMode!==ft.$N.None&&!l){const u=this.div?.getBoundingClientRect();s.tooltipCallback({anchorPoint:{x:u?.right??o.pageX,y:u?.top??o.pageY},element:this,isOpen:!1})}},this.handleMouseLeave=o=>{const s=this.getScene();s?.tooltipCallback&&!s?.tooltipPayload?.isOpen&&s.tooltipCallback(void 0),this.oneClickMode!==Ce.yd.Off&&this.div&&(this.div.style.cursor="auto",this.div.title="")},this.onElementClick=o=>{if(this.oneClickMode===Ce.yd.Link){let s=this.getPrimaryDataLink();s&&window.open(s.href,s.target??"_self")}else if(this.oneClickMode===Ce.yd.Action){const s=this.getPrimaryAction();s?.variables&&s.variables.length>0?(this.showActionVarsModal=!0,this.forceUpdate()):(this.showActionConfirmation=!0,this.forceUpdate())}else this.handleTooltip(o),this.onTooltipCallback()},this.onElementKeyDown=o=>{o.key==="Enter"&&(o.currentTarget instanceof HTMLElement||o.currentTarget instanceof SVGElement)&&this.getScene()?.select({targets:[o.currentTarget]})},this.onTooltipCallback=()=>{const o=this.getScene();o?.tooltipCallback&&o.tooltipPayload?.anchorPoint&&o.tooltipCallback({anchorPoint:{x:o.tooltipPayload.anchorPoint.x,y:o.tooltipPayload.anchorPoint.y},element:this,isOpen:!0})},this.forceUpdate=()=>{const o=this.getScene();o?.actionConfirmationCallback&&o.actionConfirmationCallback()},this.renderActionsConfirmModal=o=>{if(o)return(0,y.jsx)(y.Fragment,{children:this.showActionConfirmation&&o&&(0,y.jsx)(Nh.u,{isOpen:!0,title:(0,A.t)("grafana-ui.action-editor.button.confirm-action","Confirm action"),body:o.confirmation(),confirmText:(0,A.t)("grafana-ui.action-editor.button.confirm","Confirm"),confirmButtonVariant:"primary",onConfirm:()=>{this.showActionConfirmation=!1,o.onClick(new MouseEvent("click"),null,this.actionVars),this.forceUpdate()},onDismiss:()=>{this.showActionConfirmation=!1,this.forceUpdate()}})})},this.renderVariablesInputModal=o=>{if(!o||!o.variables||o.variables.length===0)return;const s=()=>{this.showActionVarsModal=!1,this.showActionConfirmation=!0,this.forceUpdate()};return(0,y.jsx)(Bh.b,{action:o,variables:this.actionVars,setVariables:this.setActionVars,onDismiss:()=>{this.showActionVarsModal=!1,this.forceUpdate()},onShowConfirm:s})};const i=`Element ${Date.now()}`;n||(this.options={type:e.id,name:i}),n.constraint=n.constraint??{vertical:$.gR.Top,horizontal:$.en.Left},n.placement=n.placement??{width:100,height:100,top:0,left:0,rotation:0},n.background=n.background??{color:{fixed:"transparent"}},n.border=n.border??{color:{fixed:"dark-green"}};const a=this.getScene();if(!n.name){const o=a?.getNextElementName();n.name=o??i}a?.byName.set(n.name,this)}getScene(){let e=this.parent;for(;e;){if(e.isRoot())return e.scene;e=e.parent}}getName(){return this.options.name}applyLayoutStylesToDiv(e){if(ot.$W.featureToggles.canvasPanelPanZoom){this.applyLayoutStylesToDiv2(e);return}if(this.isRoot())return;const{constraint:n}=this.options,{vertical:r,horizontal:i}=n??{},a=this.options.placement??{},s={cursor:this.getScene()?.isEditingEnabled?"grab":"auto",pointerEvents:e?"none":"auto",position:"absolute",minWidth:"10px",minHeight:"10px",rotate:`${a.rotation??0}deg`},l=["0px","0px"];switch(r){case $.gR.Top:a.top=a.top??0,a.height=a.height??100,s.top=`${a.top}px`,s.height=`${a.height}px`,delete a.bottom;break;case $.gR.Bottom:a.bottom=a.bottom??0,a.height=a.height??100,s.bottom=`${a.bottom}px`,s.height=`${a.height}px`,delete a.top;break;case $.gR.TopBottom:a.top=a.top??0,a.bottom=a.bottom??0,s.top=`${a.top}px`,s.bottom=`${a.bottom}px`,delete a.height,s.height="";break;case $.gR.Center:a.top=a.top??0,a.height=a.height??100,l[1]="-50%",s.top=`calc(50% - ${a.top}px)`,s.height=`${a.height}px`,delete a.bottom;break;case $.gR.Scale:a.top=a.top??0,a.bottom=a.bottom??0,s.top=`${a.top}%`,s.bottom=`${a.bottom}%`,delete a.height,s.height="";break}switch(i){case $.en.Left:a.left=a.left??0,a.width=a.width??100,s.left=`${a.left}px`,s.width=`${a.width}px`,delete a.right;break;case $.en.Right:a.right=a.right??0,a.width=a.width??100,s.right=`${a.right}px`,s.width=`${a.width}px`,delete a.left;break;case $.en.LeftRight:a.left=a.left??0,a.right=a.right??0,s.left=`${a.left}px`,s.right=`${a.right}px`,delete a.width,s.width="";break;case $.en.Center:a.left=a.left??0,a.width=a.width??100,l[0]="-50%",s.left=`calc(50% - ${a.left}px)`,s.width=`${a.width}px`,delete a.right;break;case $.en.Scale:a.left=a.left??0,a.right=a.right??0,s.left=`${a.left}%`,s.right=`${a.right}%`,delete a.width,s.width="";break}if(s.transform=`translate(${l[0]}, ${l[1]})`,this.options.placement=a,this.sizeStyle=s,this.div){Zi(this.sizeStyle,this.div);const c=this.options.type;ao.has(c)?Il(this.dataStyle,this.div):Zi(this.dataStyle,this.div)}}applyLayoutStylesToDiv2(e){if(this.isRoot())return;const n=this.getScene(),{width:r,height:i}=n??{},{constraint:a}=this.options,{vertical:o,horizontal:s}=a??{},l=this.options.placement??{},u={cursor:n?.isEditingEnabled?"grab":"auto",pointerEvents:e?"none":"auto",position:"absolute",minWidth:"10px",minHeight:"10px"};let d="0px",f="0px";switch(o){case $.gR.Top:l.top=l.top??0,l.height=l.height??100,d=`${l.top??0}px`,u.height=`${l.height}px`,delete l.bottom;break;case $.gR.Bottom:l.bottom=l.bottom??0,l.height=l.height??100,d=`${i-(l.bottom??0)-(l.height??100)}px`,u.height=`${l.height}px`,delete l.top;break;case $.gR.TopBottom:l.top=l.top??0,l.bottom=l.bottom??0,d=`${l.top??0}px`,u.height=`${i-(l.top??0)-(l.bottom??0)}px`,delete l.height;break;case $.gR.Center:l.top=l.top??0,l.height=l.height??100,d=`${i/2-(l.top??0)-(l.height??0)/2}px`,u.height=`${l.height}px`,delete l.bottom;break;case $.gR.Scale:l.top=l.top??0,l.bottom=l.bottom??0,d=`${(l.top??0)*(i/100)}px`,u.height=`${i-(l.top??0)*(i/100)-(l.bottom??0)*(i/100)}px`,delete l.height;break}switch(s){case $.en.Left:l.left=l.left??0,l.width=l.width??100,f=`${l.left??0}px`,u.width=`${l.width}px`,delete l.right;break;case $.en.Right:l.right=l.right??0,l.width=l.width??100,f=`${r-(l.right??0)-(l.width??100)}px`,u.width=`${l.width}px`,delete l.left;break;case $.en.LeftRight:l.left=l.left??0,l.right=l.right??0,f=`${l.left??0}px`,u.width=`${r-(l.left??0)-(l.right??0)}px`,delete l.width;break;case $.en.Center:l.left=l.left??0,l.width=l.width??100,f=`${r/2-(l.left??0)-(l.width??0)/2}px`,u.width=`${l.width}px`,delete l.right;break;case $.en.Scale:l.left=l.left??0,l.right=l.right??0,f=`${(l.left??0)*(r/100)}px`,u.width=`${r-(l.left??0)*(r/100)-(l.right??0)*(r/100)}px`,delete l.width;break}if(this.options.placement=l,u.transform=`translate(${f}, ${d}) rotate(${l.rotation??0}deg)`,this.sizeStyle=u,this.div){Zi(this.sizeStyle,this.div);const h=this.options.type;ao.has(h)?Il(this.dataStyle,this.div):Zi(this.dataStyle,this.div)}}getTopLeftValues(e){const n=window.getComputedStyle(e),r=new DOMMatrix(n.transform||"");return{left:r.m41,top:r.m42,width:n.width?parseFloat(n.width):e.clientWidth,height:n.height?parseFloat(n.height):e.clientHeight}}setPlacementFromConstraint(e,n,r=1){if(ot.$W.featureToggles.canvasPanelPanZoom){this.setPlacementFromConstraint2(e,n,r);return}const{constraint:i}=this.options,{vertical:a,horizontal:o}=i??{};e||(e=this.div&&this.div.getBoundingClientRect());let s=0;n||(n=this.div&&this.div.parentElement?.getBoundingClientRect(),s=this.parent?.isRoot()?0:parseFloat(getComputedStyle(this.div?.parentElement).borderWidth));let l=0,c=0;if(this.options.placement?.rotation&&this.options.placement?.width&&this.options.placement?.height){const m=this.options.placement.rotation,x=Math.PI/180*m;let b=x;switch(!0){case(m>=0&&m<90):break;case(m>=90&&m<180):b=Math.PI-x;break;case(m>=180&&m<270):b=Math.PI+x;break;case m>=270:b=-x;break}const C=(E,S)=>E/2*Math.sin(b)+S/2*(Math.cos(b)-1);l=C(this.options.placement.width,this.options.placement.height),c=C(this.options.placement.height,this.options.placement.width)}const u=e&&n?Math.round(e.top-n.top-s+l)/r:0,d=e&&n?Math.round(n.bottom-s-e.bottom+l)/r:0,f=e&&n?Math.round(e.left-n.left-s+c)/r:0,h=e&&n?Math.round(n.right-s-e.right+c)/r:0,v={},p=(e?.width??100)/r,g=(e?.height??100)/r;switch(a){case $.gR.Top:v.top=u,v.height=g;break;case $.gR.Bottom:v.bottom=d,v.height=g;break;case $.gR.TopBottom:v.top=u,v.bottom=d;break;case $.gR.Center:const m=e?u+g/2:0,b=(n?n.height/2:0)-m;v.top=b,v.height=g;break;case $.gR.Scale:v.top=u/(n?.height??g)*100*r,v.bottom=d/(n?.height??g)*100*r;break}switch(o){case $.en.Left:v.left=f,v.width=p;break;case $.en.Right:v.right=h,v.width=p;break;case $.en.LeftRight:v.left=f,v.right=h;break;case $.en.Center:const m=e?f+p/2:0,b=(n?n.width/2:0)-m;v.left=b,v.width=p;break;case $.en.Scale:v.left=f/(n?.width??p)*100*r,v.right=h/(n?.width??p)*100*r;break}this.options.placement?.rotation&&(v.rotation=this.options.placement.rotation,v.width=this.options.placement.width,v.height=this.options.placement.height),this.options.placement=v,this.applyLayoutStylesToDiv(),this.revId++,this.getScene()?.save()}setPlacementFromConstraint2(e,n,r=1){const i=this.getScene(),{constraint:a}=this.options,{vertical:o,horizontal:s}=a??{},l=this.getTopLeftValues(this.div);e||(e=this.div&&this.div.getBoundingClientRect()),n||(n=this.div&&this.div.parentElement?.getBoundingClientRect());const c=Math.round(l.top),u=Math.round(i.height-l.top-l.height),d=Math.round(l.left),f=Math.round(i.width-l.left-l.width),h={},v=l.width,p=l.height;switch(h.top=c,h.left=d,o){case $.gR.Top:h.top=c,h.height=p;break;case $.gR.Bottom:h.bottom=u,h.height=p;break;case $.gR.TopBottom:h.top=c,h.bottom=u;break;case $.gR.Center:const g=e?c+p/2:0,x=i.height/2-g;h.top=x,h.height=p;break;case $.gR.Scale:h.top=c/(n?.height??p)*100*r,h.bottom=u/(n?.height??p)*100*r;break}switch(s){case $.en.Left:h.left=d,h.width=v;break;case $.en.Right:h.right=f,h.width=v;break;case $.en.LeftRight:h.left=d,h.right=f;break;case $.en.Center:const g=e?d+v/2:0,x=i.width/2-g;h.left=x,h.width=v;break;case $.en.Scale:h.left=d/(n?.width??v)*100*r,h.right=f/(n?.width??v)*100*r;break}this.options.placement?.rotation&&(h.rotation=this.options.placement.rotation,h.width=this.options.placement.width,h.height=this.options.placement.height),this.options.placement=h,this.applyLayoutStylesToDiv(),this.revId++,this.getScene()?.save()}updateData(e){this.item.prepareData&&(this.data=this.item.prepareData(e,this.options),this.revId++);const n=this.getScene(),r=n?.data?.series;if(this.options.links=this.options.links?.filter(s=>s!==null),this.options.links?.some(s=>s.oneClick===!0))this.oneClickMode=Ce.yd.Link;else if(this.options.actions?.filter(s=>s.type===Ml.X2.Fetch||(0,Dr.Bs)(s)).some(s=>s.oneClick)){const l=this.getScene()?.panel?.panelContext?.canExecuteActions,c=l?.()??!1;this.oneClickMode=c?Ce.yd.Action:Ce.yd.Off}else this.oneClickMode=Ce.yd.Off;if(r){const s={name:"Default field",type:io.PU.string,config:{links:this.options.links??[],actions:this.options.actions??[]},values:[]};this.getLinks=(0,zh._M)(r[0],s,{__dataContext:{value:{data:r,field:s,frame:r[0],frameIndex:0}}},n?.panel.props.replaceVariables)}const{background:i,border:a}=this.options,o={};if(i){if(i.color){const s=e.getColor(i.color);o.backgroundColor=s.value()}if(i.image){const s=e.getResource(i.image);if(s){const l=s.value();if(l)switch(o.backgroundImage=`url("${l}")`,i.size??$.xp.Contain){case $.xp.Contain:o.backgroundSize="contain",o.backgroundRepeat="no-repeat";break;case $.xp.Cover:o.backgroundSize="cover",o.backgroundRepeat="no-repeat";break;case $.xp.Original:o.backgroundRepeat="no-repeat";break;case $.xp.Tile:o.backgroundRepeat="repeat";break;case $.xp.Fill:o.backgroundSize="100% 100%";break}else o.backgroundImage=""}}}if(a&&a.color&&a.width!==void 0){const s=e.getColor(a.color);o.borderWidth=`${a.width}px`,o.borderStyle="solid",o.borderColor=s.value(),o.backgroundImage&&(o.backgroundOrigin="padding-box")}a&&a.radius!==void 0&&(o.borderRadius=`${a.radius}px`),this.dataStyle=o,this.applyLayoutStylesToDiv()}isRoot(){return!1}visit(e){e(this)}onChange(e){this.item.id!==e.type&&(this.item=ai.getIfExists(e.type)??me);const n=this.options.name,r=e.name;this.revId++,this.options={...e};let i=this.parent;for(;i;){if(i.isRoot()){i.scene.save();break}i.revId++,i=i.parent}const a=this.getScene();n!==r&&a&&(so(this,a.byName)&&Rl(this,a).forEach(o=>{o.info.targetName=r}),a.byName.delete(n),a.byName.set(r,this))}getSaveModel(){return{...this.options}}render(){const{item:e,div:n}=this,r=this.getScene(),i=n&&r&&r.selecto&&r.selecto.getSelectedTargets().includes(n);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{ref:this.initElement,onMouseEnter:a=>this.handleMouseEnter(a,i),onMouseLeave:r?.isEditingEnabled?void 0:this.handleMouseLeave,onClick:r?.isEditingEnabled?void 0:this.onElementClick,onKeyDown:r?.isEditingEnabled?void 0:this.onElementKeyDown,role:"button",tabIndex:0,style:{userSelect:"none"},children:(0,y.jsx)(e.display,{config:this.options.config,data:this.data,isSelected:i},`${this.UID}/${this.revId}`)},this.UID),this.showActionConfirmation&&this.renderActionsConfirmModal(this.getPrimaryAction()),this.showActionVarsModal&&this.renderVariablesInputModal(this.getPrimaryAction())]})}}function Tl(t,e){try{let n={targets:[]};if(e instanceof Be){const r=[];r.push(e?.div),n.targets=r,n.frame=e,t.select(n)}else t.currentLayer=e.parent,n.targets=[e?.div],t.select(n)}catch{yr.A.emit(En.r1.alertError,["Unable to select element, try selecting element in panel instead"])}}function Ui(t,e){return kl(t?[...Ki,...Dl]:[...Ki],e)}function kl(t,e){const n={options:[],current:[]},r=[];for(const i of t){const a={label:i.name,value:i.id,description:i.description};if(i.state===mr.pn.alpha){if(!ot.yn)continue;a.label=`${i.name} (Alpha)`,r.push(a)}else n.options.push(a);i.id===e&&n.current.push(a)}for(const i of r)n.options.push(i);return n}function oo(t,e,n){const r=ai.getIfExists(t.value)??me,i={...r.getNewOptions(),type:r.id,name:""};if(n&&(i.placement={...i.placement,top:n.y,left:n.x}),r.defaultSize&&(i.placement={...i.placement,...r.defaultSize}),e){const a=new Xi(r,i,e);a.updateData(e.scene.context),e.elements.push(a),e.scene.save(),e.reinitializeMoveable(),setTimeout(()=>Tl(e.scene,a))}}function Al(t){return t.options.connections&&t.options.connections.length>0}function so(t,e){return lo(e).some(r=>r.target===t)}function lo(t){const e=[];for(let n of t.values())n.options.connections&&n.options.connections.forEach((r,i)=>{(0,ne.isString)(r.color)&&(r.color={fixed:r.color}),(0,ne.isNumber)(r.size)&&(r.size={fixed:2,min:1,max:10});const a=r.targetName?t.get(r.targetName):n.parent;a&&e.push({index:i,source:n,target:a,info:r,vertices:r.vertices??void 0,sourceOriginal:r.sourceOriginal??void 0,targetOriginal:r.targetOriginal??void 0})});return e}function Rl(t,e){return e.connections.state.filter(n=>n.target===t)}function Vh(t,e){Rl(t,e).forEach(r=>{const a=(r.source.options.connections?.splice(0)??[]).filter(o=>o.targetName!==t.getName());r.source.onChange({...r.source.options,connections:a})}),e.connections.updateState()}const co=(t,e,n,r,i)=>{const a=t.left-e.left+t.width/2,o=t.top-e.top+t.height/2,s=(a+n.source.x*t.width/2)/i,l=(o-n.source.y*t.height/2)/i;let c,u;const d=r.div?.getBoundingClientRect();if(n.targetName&&d){const f=d.left-e.left+d.width/2,h=d.top-e.top+d.height/2;c=f+n.target.x*d.width/2,u=h-n.target.y*d.height/2}else{const f=e.width/2,h=e.height/2;c=f+n.target.x*e.width/2,u=h-n.target.y*e.height/2}return c/=i,u/=i,c-s===0&&(c+=1),u-l===0&&(u+=1),{x1:s,y1:l,x2:c,y2:u}},uo=(t,e,n)=>{const{x:r,y:i}=Ll(t.div,n.source.x,n.source.y);let a=0,o=0;const s=e.div;return n.targetName&&s?{x:a,y:o}=Ll(s,n.target.x,n.target.y):(a=n.target.x,o=n.target.y),{x1:r,y1:i,x2:a,y2:o}},fo=t=>{const e=window.getComputedStyle(t),n=e.transform;let r=0,i=0,a=0;if(n!=="none"){const l=new DOMMatrix(n);r=l.m41,i=l.m42,a=-Math.atan2(l.m21,l.m11)*(180/Math.PI)}const o=parseFloat(e.width),s=parseFloat(e.height);return{left:r,top:i,width:o,height:s,x:r,y:i,rotation:a}},Ol=(t,e,n)=>{const{left:r,top:i,width:a,height:o,rotation:s}=fo(t),l=r+a/2,c=i+o/2;let u=e-l,d=n-c;const f=s*(Math.PI/180),h=Math.cos(-f),v=Math.sin(-f),p=u*h-d*v,g=u*v+d*h,m=p/(a/2),x=-g/(o/2);return{x:m,y:x}},Ll=(t,e,n)=>{const{left:r,top:i,width:a,height:o,rotation:s}=fo(t),l=r+a/2,c=i+o/2,u=e*a/2,d=-(n*o)/2,f=s*(Math.PI/180),h=Math.cos(f),v=Math.sin(f),p=u*h-d*v,g=u*v+d*h,m=l+p,x=c+g;return{x:m,y:x}},In=(t,e,n,r)=>({x:(t+n)/2,y:(e+r)/2}),gy=(t,e,n,r,i,a,o,s)=>({x:i*o+t,y:a*s+e}),pe=(t,e,n,r)=>Math.atan2(r-e,n-t),Pn=(t,e,n,r)=>Math.sqrt((n-t)**2+(r-e)**2),Mr=(t,e)=>{if(t){const i=e.data?.series[0]?.fields.find(a=>a.name===t)?.values;return i?i.length-1:0}return 0},_l=(t,e,n,r)=>{const i=ot.$W.theme2.colors.text.primary,a=Mr(t.size?.field,e),o=t.color?e.context.getColor(t.color).value():i,s=t.size?e.context.getScale(t.size).get(a):n,l=t.radius?e.context.getScale(t.radius).get(a):0,c=t.direction?e.context.getDirection(t.direction).get(a):r,u=Fh(t.lineStyle?.style),d=t.lineStyle?.animate;return{strokeColor:o,strokeWidth:s,strokeRadius:l,arrowDirection:c,lineStyle:u,shouldAnimate:d}},Fh=t=>{switch(t){case je.Dashed:return Sn.Dashed;case je.Dotted:return Sn.Dotted;default:return Sn.Solid}},en=t=>ot.$W.featureToggles.canvasPanelPanZoom?t.viewportDiv?.getBoundingClientRect():t.div?.getBoundingClientRect();function Gh(t,e){const n=new Set,r=e.config??{};return t.forEach(i=>{i.fields.forEach(a=>{switch((0,xr.Ct)(a,i,t)){case e.background?.color?.field:case e.background?.image?.field:case e.border?.color?.field:case r.text?.field:case r.color?.field:case r.path?.field:case r.fill?.field:case r.blinkRate?.field:case r.statusColor?.field:case r.bulbColor?.field:case r.rpm?.field:n.add(a)}})}),[...n]}function Zi(t,e){Object.assign(e.style,t)}function Il(t,e){for(const n in t)e.style[n]=""}var Pl="rgb",zl="rgba",Nl="hsl",Bl="hsla",my=[Pl,zl,Nl,Bl],$h="function",xy="property",yy="array",Wh="object",Hh="string",Yh="number",oi="undefined",jl=typeof window!==oi,Un=typeof document!==oi&&document,Vl=null,by=function(t){if(!Un)return"";var e=(Un.body||Un.documentElement).style,n=Vl.length;if(typeof e[t]!==oi)return t;for(var r=0;r<n;++r){var i="-"+Vl[r]+"-"+t;if(typeof e[i]!==oi)return i}return""},Cy=null,Sy=null,Ey=null,wy=null,Kh=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],oe=1e-7,Dy=1/oe,Qi={cm:function(t){return t*96/2.54},mm:function(t){return t*96/254},in:function(t){return t*96},pt:function(t){return t*96/72},pc:function(t){return t*96/6},"%":function(t,e){return t*e/100},vw:function(t,e){return e===void 0&&(e=window.innerWidth),t/100*e},vh:function(t,e){return e===void 0&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return e===void 0&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return e===void 0&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Xh(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function qi(t,e,n,r){return(t*r+e*n)/(n+r)}function Ji(t){return typeof t===oi}function Te(t){return t&&typeof t===Wh}function qt(t){return Array.isArray(t)}function ye(t){return typeof t===Hh}function Tr(t){return typeof t===Yh}function ta(t){return typeof t===$h}function Uh(t,e){var n=t===""||t==" ",r=e===""||e==" ";return r&&n||t===e}function Fl(t,e,n,r,i){var a=ho(t,e,n);return a?n:Zh(t,e,n+1,r,i)}function ho(t,e,n){if(!t.ignore)return null;var r=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(r)}function Zh(t,e,n,r,i){for(var a=function(c){var u=e[c].trim();if(u===t.close&&!ho(t,e,c))return{value:c};var d=c,f=ze(i,function(h){var v=h.open;return v===u});if(f&&(d=Fl(f,e,c,r,i)),d===-1)return o=c,"break";c=d,o=c},o,s=n;s<r;++s){var l=a(s);if(s=o,typeof l=="object")return l.value;if(l==="break")break}return-1}function vo(t,e){var n=ye(e)?{separator:e}:e,r=n.separator,i=r===void 0?",":r,a=n.isSeparateFirst,o=n.isSeparateOnlyOpenClose,s=n.isSeparateOpenClose,l=s===void 0?o:s,c=n.openCloseCharacters,u=c===void 0?Kh:c,d=u.map(function(D){var M=D.open,w=D.close;return M===w?M:M+"|"+w}).join("|"),f="(\\s*"+i+"\\s*|"+d+"|\\s+)",h=new RegExp(f,"g"),v=t.split(h).filter(function(D){return D&&D!=="undefined"}),p=v.length,g=[],m=[];function x(){return m.length?(g.push(m.join("")),m=[],!0):!1}for(var b=function(D){var M=v[D].trim(),w=D,T=ze(u,function(R){var L=R.open;return L===M}),k=ze(u,function(R){var L=R.close;return L===M});if(T){if(w=Fl(T,v,D,p,u),w!==-1&&l)return x()&&a||(g.push(v.slice(D,w+1).join("")),D=w,a)?(C=D,"break"):(C=D,"continue")}else if(k&&!ho(k,v,D)){var O=Xh(u);return O.splice(u.indexOf(k),1),{value:vo(t,{separator:i,isSeparateFirst:a,isSeparateOnlyOpenClose:o,isSeparateOpenClose:l,openCloseCharacters:O})}}else if(Uh(M,i)&&!o)return x(),a?(C=D,"break"):(C=D,"continue");w===-1&&(w=p-1),m.push(v.slice(D,w+1).join("")),D=w,C=D},C,E=0;E<p;++E){var S=b(E);if(E=C,typeof S=="object")return S.value;if(S==="break")break}return m.length&&g.push(m.join("")),g}function zn(t){return vo(t,"")}function Nn(t){return vo(t,",")}function po(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function Zn(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],r=e[2],i=e[3];return{prefix:n,unit:i,value:parseFloat(r)}}function ea(t){return t.replace(/[\s-_]+([^\s-_])/g,function(e,n){return n.toUpperCase()})}function na(t,e){return e===void 0&&(e="-"),t.replace(/([a-z])([A-Z])/g,function(n,r,i){return""+r+e+i.toLowerCase()})}function My(t){return[].slice.call(t)}function si(){return Date.now?Date.now():new Date().getTime()}function Mn(t,e,n){n===void 0&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function Qh(t,e,n){n===void 0&&(n=-1);for(var r=t.length,i=r-1;i>=0;--i)if(e(t[i],i,t))return i;return n}function Ty(t,e,n){var r=Qh(t,e);return r>-1?t[r]:n}function ze(t,e,n){var r=Mn(t,e);return r>-1?t[r]:n}var Gl=function(){var t=si(),e=jl&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(n){var r=si(),i=setTimeout(function(){n(r-t)},1e3/60);return i}}(),qh=function(){var t=jl&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(e){clearTimeout(e)}}();function hn(t){return Object.keys(t)}function Jh(t){var e=hn(t);return e.map(function(n){return t[n]})}function ky(t){var e=hn(t);return e.map(function(n){return[n,t[n]]})}function Ay(t,e){e===void 0&&(e=[]),t.sort(function(n,r){var i=e.indexOf(n),a=e.indexOf(r);return a===-1&&i===-1?0:i===-1?1:a===-1?-1:i-a})}function It(t,e){var n=Zn(t),r=n.value,i=n.unit;if(Te(e)){var a=e[i];if(a){if(ta(a))return a(r);if(Qi[i])return Qi[i](r,a)}}else if(i==="%")return r*e/100;return Qi[i]?Qi[i](r):r}function nn(t,e,n){return Math.max(e,Math.min(t,n))}function $l(t,e,n,r){return r===void 0&&(r=t[0]/t[1]),[[Et(e[0],oe),Et(e[0]/r,oe)],[Et(e[1]*r,oe),Et(e[1],oe)]].filter(function(i){return i.every(function(a,o){var s=e[o],l=Et(s,oe);return n?a<=s||a<=l:a>=s||a>=l})})[0]||t}function go(t,e,n,r){if(!r)return t.map(function(h,v){return nn(h,e[v],n[v])});var i=t[0],a=t[1],o=r===!0?i/a:r,s=$l(t,e,!1,o),l=s[0],c=s[1],u=$l(t,n,!0,o),d=u[0],f=u[1];return i<l||a<c?(i=l,a=c):(i>d||a>f)&&(i=d,a=f),[i,a]}function tv(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return n}function mo(t){for(var e=t.length,n=0,r=e-1;r>=0;--r)n+=t[r];return e?n/e:0}function se(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function ev(t){return[0,1].map(function(e){return mo(t.map(function(n){return n[e]}))})}function Wl(t){var e=ev(t),n=se(e,t[0]),r=se(e,t[1]);return n<r&&r-n<Math.PI||n>r&&r-n<-Math.PI?1:-1}function vn(t,e){return Math.sqrt(Math.pow((e?e[0]:0)-t[0],2)+Math.pow((e?e[1]:0)-t[1],2))}function Et(t,e){if(!e)return t;var n=1/e;return Math.round(t/e)/n}function Hl(t,e){return t.forEach(function(n,r){t[r]=Et(t[r],e)}),t}function nv(t){for(var e=[],n=0;n<t;++n)e.push(n);return e}function Ry(t,e,n){var r=!1;return t.replace(e,function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return r?i[0]:(r=!0,ye(n)?n:n.apply(void 0,i))})}function Yl(t){return t.reduce(function(e,n){return e.concat(n)},[])}function rv(t){return t.reduce(function(e,n){return qt(n)?e.push.apply(e,rv(n)):e.push(n),e},[])}function Kl(t,e){t.indexOf(e)===-1&&t.push(e)}function iv(t){return t.replace("#","")}function Xl(t){var e=iv(t),n=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16),a=parseInt(e.substring(6,8),16)/255;return isNaN(a)&&(a=1),[n,r,i,a]}function av(t){var e=t.charAt(1),n=t.charAt(2),r=t.charAt(3),i=t.charAt(4),a=["#",e,e,n,n,r,r,i,i];return a.join("")}function ov(t){var e,n=t[0],r=t[1],i=t[2];n<0&&(n+=Math.floor((Math.abs(n)+360)/360)*360),n%=360;var a=(1-Math.abs(2*i-1))*r,o=a*(1-Math.abs(n/60%2-1)),s=i-a/2,l;return n<60?l=[a,o,0]:n<120?l=[o,a,0]:n<180?l=[0,a,o]:n<240?l=[0,o,a]:n<300?l=[o,0,a]:n<360?l=[a,0,o]:l=[0,0,0],[Math.round((l[0]+s)*255),Math.round((l[1]+s)*255),Math.round((l[2]+s)*255),(e=t[3])!==null&&e!==void 0?e:1]}function Oy(t){if(t.charAt(0)==="#")return t.length===4||t.length===5?Xl(av(t)):Xl(t);if(t.indexOf("(")!==-1){var e=po(t),n=e.prefix,r=e.value;if(!n||!r)return;var i=Nn(r),a=[0,0,0,1],o=i.length;switch(n){case Pl:case zl:for(var s=0;s<o;++s)a[s]=parseFloat(i[s]);return a;case Nl:case Bl:for(var s=0;s<o;++s)i[s].indexOf("%")!==-1?a[s]=parseFloat(i[s])/100:a[s]=parseFloat(i[s]);return ov(a)}}}function Ly(t,e){return Un?e?Un.querySelectorAll(t):Un.querySelector(t):e?[]:null}function ce(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function Tn(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function Ul(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}function _y(t,e){if(!t||!e||!e.length)return{};var n;if(t instanceof Element)n=t;else if(t.length)n=t[0];else return{};for(var r={},i=Ee(n).getComputedStyle(n),a=e.length,o=0;o<a;++o)r[e[o]]=i[e[o]];return r}function re(t,e,n,r){t.addEventListener(e,n,r)}function Jt(t,e,n,r){t.removeEventListener(e,n,r)}function Se(t){return t?.ownerDocument||Un}function xo(t){return Se(t).documentElement}function Bn(t){return Se(t).body}function Ee(t){var e;return((e=t?.ownerDocument)===null||e===void 0?void 0:e.defaultView)||window}function Zl(t){return t&&"postMessage"in t&&"blur"in t&&"self"in t}function pn(t){return Te(t)&&t.nodeName&&t.nodeType&&"ownerDocument"in t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yo=function(){return yo=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},yo.apply(this,arguments)};function sv(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}var lv=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(n,r){if(Te(n))for(var i in n)this.on(i,n[i]);else this._addEvent(n,r,{});return this},e.off=function(n,r){if(!n)this._events={};else if(Te(n))for(var i in n)this.off(i);else if(!r)this._events[n]=[];else{var a=this._events[n];if(a){var o=Mn(a,function(s){return s.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(n,r){var i=this;return r&&this._addEvent(n,r,{once:!0}),new Promise(function(a){i._addEvent(n,a,{once:!0})})},e.emit=function(n,r){var i=this;r===void 0&&(r={});var a=this._events[n];if(!n||!a)return!0;var o=!1;return r.eventType=n,r.stop=function(){o=!0},r.currentTarget=this,sv(a).forEach(function(s){s.listener(r),s.once&&i.off(n,s.listener)}),!o},e.trigger=function(n,r){return r===void 0&&(r={}),this.emit(n,r)},e._addEvent=function(n,r,i){var a=this._events;a[n]=a[n]||[];var o=a[n];o.push(yo({listener:r},i))},t}();const Qn=lv;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bo=function(t,e){return bo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},bo(t,e)};function cv(t,e){bo(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ue=function(){return ue=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ue.apply(this,arguments)};function uv(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.atan2(r,n);return i>=0?i:i+Math.PI*2}function Co(t){return uv([t[0].clientX,t[0].clientY],[t[1].clientX,t[1].clientY])/Math.PI*180}function dv(t){return t.touches&&t.touches.length>=2}function ra(t){return t?t.touches?hv(t.touches):[ql(t)]:[]}function fv(t){return t&&(t.type.indexOf("mouse")>-1||"button"in t)}function Ql(t,e,n){var r=n.length,i=li(t,r),a=i.clientX,o=i.clientY,s=i.originalClientX,l=i.originalClientY,c=li(e,r),u=c.clientX,d=c.clientY,f=li(n,r),h=f.clientX,v=f.clientY,p=a-u,g=o-d,m=a-h,x=o-v;return{clientX:s,clientY:l,deltaX:p,deltaY:g,distX:m,distY:x}}function So(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function hv(t){for(var e=Math.min(t.length,2),n=[],r=0;r<e;++r)n.push(ql(t[r]));return n}function ql(t){return{clientX:t.clientX,clientY:t.clientY}}function li(t,e){e===void 0&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},r=Math.min(t.length,e),i=0;i<r;++i){var a=t[i];n.originalClientX+="originalClientX"in a?a.originalClientX:a.clientX,n.originalClientY+="originalClientY"in a?a.originalClientY:a.clientY,n.clientX+=a.clientX,n.clientY+=a.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var Eo=function(){function t(e){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=e,this.prevClients=e,this.length=e.length}return t.prototype.getAngle=function(e){return e===void 0&&(e=this.prevClients),Co(e)},t.prototype.getRotation=function(e){return e===void 0&&(e=this.prevClients),Co(e)-Co(this.startClients)},t.prototype.getPosition=function(e,n){e===void 0&&(e=this.prevClients);var r=Ql(e||this.prevClients,this.prevClients,this.startClients),i=r.deltaX,a=r.deltaY;return this.movement+=Math.sqrt(i*i+a*a),this.prevClients=e,r},t.prototype.getPositions=function(e){e===void 0&&(e=this.prevClients);for(var n=this.prevClients,r=this.startClients,i=Math.min(this.length,n.length),a=[],o=0;o<i;++o)a[o]=Ql([e[o]],[n[o]],[r[o]]);return a},t.prototype.getMovement=function(e){var n=this.movement;if(!e)return n;var r=li(e,this.length),i=li(this.prevClients,this.length),a=r.clientX-i.clientX,o=r.clientY-i.clientY;return Math.sqrt(a*a+o*o)+n},t.prototype.getDistance=function(e){return e===void 0&&(e=this.prevClients),So(e)},t.prototype.getScale=function(e){return e===void 0&&(e=this.prevClients),So(e)/So(this.startClients)},t.prototype.move=function(e,n){this.startClients.forEach(function(r){r.clientX-=e,r.clientY-=n}),this.prevClients.forEach(function(r){r.clientX-=e,r.clientY-=n})},t}(),Jl=["textarea","input"],ia=function(t){cv(e,t);function e(n,r){r===void 0&&(r={});var i=t.call(this)||this;i.options={},i.flag=!1,i.pinchFlag=!1,i.data={},i.isDrag=!1,i.isPinch=!1,i.clientStores=[],i.targets=[],i.prevTime=0,i.doubleFlag=!1,i._useMouse=!1,i._useTouch=!1,i._useDrag=!1,i._dragFlag=!1,i._isTrusted=!1,i._isMouseEvent=!1,i._isSecondaryButton=!1,i._preventMouseEvent=!1,i._prevInputEvent=null,i._isDragAPI=!1,i._isIdle=!0,i._preventMouseEventId=0,i._window=window,i.onDragStart=function(f,h){if(h===void 0&&(h=!0),!(!i.flag&&f.cancelable===!1)){var v=f.type.indexOf("drag")>=-1;if(!(i.flag&&v)){i._isDragAPI=!0;var p=i.options,g=p.container,m=p.pinchOutside,x=p.preventWheelClick,b=p.preventRightClick,C=p.preventDefault,E=p.checkInput,S=p.dragFocusedInput,D=p.preventClickEventOnDragStart,M=p.preventClickEventOnDrag,w=p.preventClickEventByCondition,T=i._useTouch,k=!i.flag;if(i._isSecondaryButton=f.which===3||f.button===2,x&&(f.which===2||f.button===1)||b&&(f.which===3||f.button===2))return i.stop(),!1;if(k){var O=i._window.document.activeElement,R=f.target;if(R){var L=R.tagName.toLowerCase(),P=Jl.indexOf(L)>-1,z=R.isContentEditable;if(P||z){if(E||!S&&O===R)return!1;if(O&&(O===R||z&&O.isContentEditable&&O.contains(R)))if(S)R.blur();else return!1}else if((C||f.type==="touchstart")&&O){var V=O.tagName.toLowerCase();(O.isContentEditable||Jl.indexOf(V)>-1)&&O.blur()}(D||M||w)&&re(i._window,"click",i._onClick,!0)}i.clientStores=[new Eo(ra(f))],i._isIdle=!1,i.flag=!0,i.isDrag=!1,i._isTrusted=h,i._dragFlag=!0,i._prevInputEvent=f,i.data={},i.doubleFlag=si()-i.prevTime<200,i._isMouseEvent=fv(f),!i._isMouseEvent&&i._preventMouseEvent&&i._allowMouseEvent();var N=i._preventMouseEvent||i.emit("dragStart",ue(ue({data:i.data,datas:i.data,inputEvent:f,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,isTrusted:h,isDouble:i.doubleFlag},i.getCurrentStore().getPosition()),{preventDefault:function(){f.preventDefault()},preventDrag:function(){i._dragFlag=!1}}));N===!1&&i.stop(),i._isMouseEvent&&i.flag&&C&&f.preventDefault()}if(!i.flag)return!1;var G=0;if(k?(i._attchDragEvent(),T&&m&&(G=setTimeout(function(){re(g,"touchstart",i.onDragStart,{passive:!1})}))):T&&m&&Jt(g,"touchstart",i.onDragStart),i.flag&&dv(f)){if(clearTimeout(G),k&&f.touches.length!==f.changedTouches.length)return;i.pinchFlag||i.onPinchStart(f)}}}},i.onDrag=function(f,h){if(i.flag){var v=i.options.preventDefault;!i._isMouseEvent&&v&&f.preventDefault(),i._prevInputEvent=f;var p=ra(f),g=i.moveClients(p,f,!1);if(i._dragFlag){if(i.pinchFlag||g.deltaX||g.deltaY){var m=i._preventMouseEvent||i.emit("drag",ue(ue({},g),{isScroll:!!h,inputEvent:f}));if(m===!1){i.stop();return}}i.pinchFlag&&i.onPinch(f,p)}i.getCurrentStore().getPosition(p,!0)}},i.onDragEnd=function(f){if(i.flag){var h=i.options,v=h.pinchOutside,p=h.container,g=h.preventClickEventOnDrag,m=h.preventClickEventOnDragStart,x=h.preventClickEventByCondition,b=i.isDrag;(g||m||x)&&requestAnimationFrame(function(){i._allowClickEvent()}),!x&&!m&&g&&!b&&i._allowClickEvent(),i._useTouch&&v&&Jt(p,"touchstart",i.onDragStart),i.pinchFlag&&i.onPinchEnd(f);var C=f?.touches?ra(f):[],E=C.length;E===0||!i.options.keepDragging?i.flag=!1:i._addStore(new Eo(C));var S=i._getPosition(),D=si(),M=!b&&i.doubleFlag;i._prevInputEvent=null,i.prevTime=b||M?0:D,i.flag||(i._dettachDragEvent(),i._preventMouseEvent||i.emit("dragEnd",ue({data:i.data,datas:i.data,isDouble:M,isDrag:b,isClick:!b,isMouseEvent:i._isMouseEvent,isSecondaryButton:i._isSecondaryButton,inputEvent:f,isTrusted:i._isTrusted},S)),i.clientStores=[],i._isMouseEvent||(i._preventMouseEvent=!0,clearTimeout(i._preventMouseEventId),i._preventMouseEventId=setTimeout(function(){i._preventMouseEvent=!1},200)),i._isIdle=!0)}},i.onBlur=function(){i.onDragEnd()},i._allowClickEvent=function(){Jt(i._window,"click",i._onClick,!0)},i._onClick=function(f){i._allowClickEvent(),i._allowMouseEvent();var h=i.options.preventClickEventByCondition;h?.(f)||(f.stopPropagation(),f.preventDefault())},i._onContextMenu=function(f){var h=i.options;h.preventRightClick?i.onDragEnd(f):f.preventDefault()},i._passCallback=function(){};var a=[].concat(n),o=a[0];i._window=Zl(o)?o:Ee(o),i.options=ue({checkInput:!1,container:o&&!("document"in o)?Ee(o):o,preventRightClick:!0,preventWheelClick:!0,preventClickEventOnDragStart:!1,preventClickEventOnDrag:!1,preventClickEventByCondition:null,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},r);var s=i.options,l=s.container,c=s.events,u=s.checkWindowBlur;if(i._useDrag=c.indexOf("drag")>-1,i._useTouch=c.indexOf("touch")>-1,i._useMouse=c.indexOf("mouse")>-1,i.targets=a,i._useDrag&&a.forEach(function(f){re(f,"dragstart",i.onDragStart)}),i._useMouse&&(a.forEach(function(f){re(f,"mousedown",i.onDragStart),re(f,"mousemove",i._passCallback)}),re(l,"contextmenu",i._onContextMenu)),u&&re(Ee(),"blur",i.onBlur),i._useTouch){var d={passive:!1};a.forEach(function(f){re(f,"touchstart",i.onDragStart,d),re(f,"touchmove",i._passCallback,d)})}return i}return e.prototype.stop=function(){this.isDrag=!1,this.data={},this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1,this._isIdle=!0,this._allowClickEvent(),this._dettachDragEvent(),this._isDragAPI=!1},e.prototype.getMovement=function(n){return this.getCurrentStore().getMovement(n)+this.clientStores.slice(1).reduce(function(r,i){return r+i.movement},0)},e.prototype.isDragging=function(){return this.isDrag},e.prototype.isIdle=function(){return this._isIdle},e.prototype.isFlag=function(){return this.flag},e.prototype.isPinchFlag=function(){return this.pinchFlag},e.prototype.isDoubleFlag=function(){return this.doubleFlag},e.prototype.isPinching=function(){return this.isPinch},e.prototype.scrollBy=function(n,r,i,a){a===void 0&&(a=!0),this.flag&&(this.clientStores[0].move(n,r),a&&this.onDrag(i,!0))},e.prototype.move=function(n,r){var i=n[0],a=n[1],o=this.getCurrentStore(),s=o.prevClients;return this.moveClients(s.map(function(l){var c=l.clientX,u=l.clientY;return{clientX:c+i,clientY:u+a,originalClientX:c,originalClientY:u}}),r,!0)},e.prototype.triggerDragStart=function(n){this.onDragStart(n,!1)},e.prototype.setEventData=function(n){var r=this.data;for(var i in n)r[i]=n[i];return this},e.prototype.setEventDatas=function(n){return this.setEventData(n)},e.prototype.getCurrentEvent=function(n){return n===void 0&&(n=this._prevInputEvent),ue(ue({data:this.data,datas:this.data},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:n})},e.prototype.getEventData=function(){return this.data},e.prototype.getEventDatas=function(){return this.data},e.prototype.unset=function(){var n=this,r=this.targets,i=this.options.container;this.off(),Jt(this._window,"blur",this.onBlur),this._useDrag&&r.forEach(function(a){Jt(a,"dragstart",n.onDragStart)}),this._useMouse&&(r.forEach(function(a){Jt(a,"mousedown",n.onDragStart)}),Jt(i,"contextmenu",this._onContextMenu)),this._useTouch&&(r.forEach(function(a){Jt(a,"touchstart",n.onDragStart)}),Jt(i,"touchstart",this.onDragStart)),this._prevInputEvent=null,this._allowClickEvent(),this._dettachDragEvent()},e.prototype.onPinchStart=function(n){var r=this,i=this.options.pinchThreshold;if(!(this.isDrag&&this.getMovement()>i)){var a=new Eo(ra(n));this.pinchFlag=!0,this._addStore(a);var o=this.emit("pinchStart",ue(ue({data:this.data,datas:this.data,angle:a.getAngle(),touches:this.getCurrentStore().getPositions()},a.getPosition()),{inputEvent:n,isTrusted:this._isTrusted,preventDefault:function(){n.preventDefault()},preventDrag:function(){r._dragFlag=!1}}));o===!1&&(this.pinchFlag=!1)}},e.prototype.onPinch=function(n,r){if(!(!this.flag||!this.pinchFlag||r.length<2)){var i=this.getCurrentStore();this.isPinch=!0,this.emit("pinch",ue(ue({data:this.data,datas:this.data,movement:this.getMovement(r),angle:i.getAngle(r),rotation:i.getRotation(r),touches:i.getPositions(r),scale:i.getScale(r),distance:i.getDistance(r)},i.getPosition(r)),{inputEvent:n,isTrusted:this._isTrusted}))}},e.prototype.onPinchEnd=function(n){if(this.pinchFlag){var r=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var i=this.getCurrentStore();this.emit("pinchEnd",ue(ue({data:this.data,datas:this.data,isPinch:r,touches:i.getPositions()},i.getPosition()),{inputEvent:n}))}},e.prototype.getCurrentStore=function(){return this.clientStores[0]},e.prototype.moveClients=function(n,r,i){var a=this._getPosition(n,i),o=this.isDrag;(a.deltaX||a.deltaY)&&(this.isDrag=!0);var s=!1;return!o&&this.isDrag&&(s=!0),ue(ue({data:this.data,datas:this.data},a),{movement:this.getMovement(n),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,isSecondaryButton:this._isSecondaryButton,inputEvent:r,isTrusted:this._isTrusted,isFirstDrag:s})},e.prototype._addStore=function(n){this.clientStores.splice(0,0,n)},e.prototype._getPosition=function(n,r){var i=this.getCurrentStore(),a=i.getPosition(n,r),o=this.clientStores.slice(1).reduce(function(c,u){var d=u.getPosition();return c.distX+=d.distX,c.distY+=d.distY,c},a),s=o.distX,l=o.distY;return ue(ue({},a),{distX:s,distY:l})},e.prototype._attchDragEvent=function(){var n=this._window,r=this.options.container,i={passive:!1};this._isDragAPI&&(re(r,"dragover",this.onDrag,i),re(n,"dragend",this.onDragEnd)),this._useMouse&&(re(r,"mousemove",this.onDrag),re(n,"mouseup",this.onDragEnd)),this._useTouch&&(re(r,"touchmove",this.onDrag,i),re(n,"touchend",this.onDragEnd,i),re(n,"touchcancel",this.onDragEnd,i))},e.prototype._dettachDragEvent=function(){var n=this._window,r=this.options.container;this._isDragAPI&&(Jt(r,"dragover",this.onDrag),Jt(n,"dragend",this.onDragEnd)),this._useMouse&&(Jt(r,"mousemove",this.onDrag),Jt(n,"mouseup",this.onDragEnd)),this._useTouch&&(Jt(r,"touchstart",this.onDragStart),Jt(r,"touchmove",this.onDrag),Jt(n,"touchend",this.onDragEnd),Jt(n,"touchcancel",this.onDragEnd))},e.prototype._allowMouseEvent=function(){this._preventMouseEvent=!1,clearTimeout(this._preventMouseEventId)},e}(Qn);function vv(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.map(function(r){return r.split(" ").map(function(i){return i?""+t+i:""}).join(" ")}).join(" ")}function tc(t,e){return e.replace(/([^}{]*){/gm,function(n,r){return r.replace(/\.([^{,\s\d.]+)/g,"."+t+"$1")+"{"})}function kn(t,e){return function(n){n&&(t[e]=n)}}function ec(t,e,n){return function(r){r&&(t[e][n]=r)}}function aa(t,e){return function(n){var r=n.prototype;t.forEach(function(i){e(r,i)})}}function pv(t,e){return e===void 0&&(e={}),function(n,r){t.forEach(function(i){var a=e[i]||i;a in n||(n[a]=function(){for(var o,s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];var c=(o=this[r])[i].apply(o,s);return c===this[r]?this:c})})}}function gv(t){for(var e=5381,n=t.length;n;)e=e*33^t.charCodeAt(--n);return e>>>0}var mv=gv;function xv(t){return mv(t).toString(36)}function yv(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function bv(t,e,n){return n.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/mg,function(r,i){var a=i.trim();return(a?Nn(a):[""]).map(function(o){var s=o.trim();return s.indexOf("@")===0?s:s.indexOf(":global")>-1?s.replace(/\:global/g,""):s.indexOf(":host")>-1?"".concat(s.replace(/\:host/g,".".concat(t))):s?".".concat(t," ").concat(s):".".concat(t)}).join(", ")+" {"})}function Cv(t,e,n,r,i){var a=Se(r),o=a.createElement("style");return o.setAttribute("type","text/css"),o.setAttribute("data-styled-id",t),o.setAttribute("data-styled-count","1"),n.nonce&&o.setAttribute("nonce",n.nonce),o.innerHTML=bv(t,e,n),(i||a.head||a.body).appendChild(o),o}function Sv(t){var e="rCS"+xv(t);return{className:e,inject:function(n,r){r===void 0&&(r={});var i=yv(n),a=(i||n.ownerDocument||document).querySelector('style[data-styled-id="'.concat(e,'"]'));if(!a)a=Cv(e,t,r,n,i);else{var o=parseFloat(a.getAttribute("data-styled-count"))||0;a.setAttribute("data-styled-count","".concat(o+1))}return{destroy:function(){var s,l=parseFloat(a.getAttribute("data-styled-count"))||0;l<=1?(a.remove?a.remove():(s=a.parentNode)===null||s===void 0||s.removeChild(a),a=null):a.setAttribute("data-styled-count","".concat(l-1))}}}}}const wo=Sv;function Do(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return!0;return!1}function nc(t,e){for(var n=t.length,r=0;r<n;++r)if(e(t[r],r))return t[r];return null}function Ev(t){var e=t;if(typeof e>"u"){if(typeof navigator>"u"||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}function Mo(t,e){try{return new RegExp(t,"g").exec(e)}catch{return null}}function rc(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,e=t.brands||t.uaList;return!!(e&&e.length)}function wv(t,e){var n=Mo("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",e);return n?n[3]:""}function To(t){return t.replace(/_/g,".")}function ci(t,e){var n=null,r="-1";return Do(t,function(i){var a=Mo("("+i.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",e);return!a||i.brand?!1:(n=i,r=a[3]||"-1",i.versionAlias?r=i.versionAlias:i.versionTest&&(r=wv(i.versionTest.toLowerCase(),e)||r),r=To(r),!0)}),{preset:n,version:r}}function oa(t,e){var n={brand:"",version:"-1"};return Do(t,function(r){var i=ic(e,r);return i?(n.brand=r.id,n.version=r.versionAlias||i.version,n.version!=="-1"):!1}),n}function ic(t,e){return nc(t,function(n){var r=n.brand;return Mo(""+e.test,r.toLowerCase())})}var ac=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],oc=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],ko=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],sc=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],lc=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function cc(t){var e=navigator.userAgentData,n=(e.uaList||e.brands).slice(),r=e.mobile||!1,i=n[0],a={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!oa(sc,n).brand},o={name:"unknown",version:"-1",majorVersion:-1};a.webkit=!a.chromium&&Do(ko,function(f){return ic(n,f)});var s=oa(oc,n);if(a.chromium=!!s.brand,a.chromiumVersion=s.version,!a.chromium){var l=oa(ko,n);a.webkit=!!l.brand,a.webkitVersion=l.version}if(t){var c=t.platform.toLowerCase(),u=nc(lc,function(f){return new RegExp(""+f.test,"g").exec(c)});o.name=u?u.id:c,o.version=t.platformVersion}var d=oa(ac,n);return d.brand&&(a.name=d.brand,a.version=t?t.uaFullVersion:d.version),navigator.platform==="Linux armv8l"?o.name="android":a.webkit&&(o.name=r?"ios":"mac"),o.name==="ios"&&a.webview&&(a.version="-1"),o.version=To(o.version),a.version=To(a.version),o.majorVersion=parseInt(o.version,10),a.majorVersion=parseInt(a.version,10),{browser:a,os:o,isMobile:r,isHints:!0}}function Dv(t){var e=Ev(t),n=!!/mobi/g.exec(e),r={name:"unknown",version:"-1",majorVersion:-1,webview:!!ci(sc,e).preset,chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},i={name:"unknown",version:"-1",majorVersion:-1},a=ci(ac,e),o=a.preset,s=a.version,l=ci(lc,e),c=l.preset,u=l.version,d=ci(oc,e);if(r.chromium=!!d.preset,r.chromiumVersion=d.version,!r.chromium){var f=ci(ko,e);r.webkit=!!f.preset,r.webkitVersion=f.version}return c&&(i.name=c.id,i.version=u,i.majorVersion=parseInt(u,10)),o&&(r.name=o.id,r.version=s,r.webview&&i.name==="ios"&&r.name!=="safari"&&(r.webview=!1)),r.majorVersion=parseInt(r.version,10),{browser:r,os:i,isMobile:n,isHints:!1}}function Iy(t){return rc()?navigator.userAgentData.getHighEntropyValues(["architecture","model","platform","platformVersion","uaFullVersion"]).then(function(e){var n=cc(e);return t&&t(n),n}):(t&&t(Ao()),typeof Promise>"u"||!Promise?null:Promise.resolve(Ao()))}function Ao(t){return typeof t>"u"&&rc()?cc():Dv(t)}const uc=Ao;var Ro=function(t,e){return Ro=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ro(t,e)};function Oo(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ro(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var He=function(){return He=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},He.apply(this,arguments)};function Mv(t,e,n,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function dc(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}var Tv=uc(),kv=Tv.browser.name==="safari",qn="infinite-viewer-",fc="".concat(qn,"wrapper"),hc="".concat(qn,"scroll-area"),Av="".concat(qn,"scroll-bar"),vc="".concat(qn,"horizontal-scroll-bar"),pc="".concat(qn,"vertical-scroll-bar"),gc="".concat(qn,"scroll-thumb"),mc=wo(tc(qn,`
{
    position: relative;
    overscroll-behavior: none;
}
.wrapper {
    position: absolute;
    width: 100%;
    height: 100%;
    overflow: auto;
    scrollbar-width: none;
    top: 0;
    left: 0;
    will-change: scroll-position;
}
.restrict-wrapper {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
}
.wrapper::-webkit-scrollbar {
    display: none;
}
.scroll-area {
    position:absolute;
    top:0;
    left:0;
    transform-origin: 0 0;
}
.scroll-bar {
    position:absolute;
    width: 10px;
    height: 10px;
    box-sizing: border-box;
    right: 0;
    bottom: 0;
    overflow: hidden;
}
.horizontal-scroll-bar {
    width: calc(100% - 20px);
    right: 10px;
    height: 14px;
}
.vertical-scroll-bar {
    height: calc(100% - 20px);
    bottom: 10px;
    width: 14px;
}
.scroll-thumb {
    position:relative;
    opacity: 0.7;
    background: #333;
    border-radius: 3px;
    left: 0px;
    top: 0px;
    z-index: 10;
    width: 6px;
    height: 6px;
    transition: all ease 0.2s;
    opacity: 0;
}
.scroll-bar:hover .scroll-thumb {
    border-radius: 5px;
    opacity: 1;
}
.horizontal-scroll-bar .scroll-thumb {
    margin: 4px 0px;
    transition-property: opacity, margin, height, border-radius;
}
.vertical-scroll-bar .scroll-thumb {
    margin: 0px 4px;
    transition-property: opacity, margin, width, border-radius;
}
.horizontal-scroll-bar:hover .scroll-thumb {
    height: 10px;
    margin: 2px 0px;
}
.vertical-scroll-bar:hover .scroll-thumb {
    width: 10px;
    margin: 0px 2px;
}
`)),ke={margin:500,threshold:100,zoom:1,zoomX:1,zoomY:1,rangeX:[-1/0,1/0],rangeY:[-1/0,1/0],rangeOffsetX:[0,0],rangeOffsetY:[0,0],wrapperElement:null,scrollAreaElement:null,horizontalScrollElement:null,verticalScrollElement:null,usePinch:!1,useAutoZoom:!1,useMouseDrag:!1,pinchThreshold:30,cspNonce:"",maxPinchWheel:1/0,wheelScale:.01,displayHorizontalScroll:!0,displayVerticalScroll:!0,useTransform:!0,useWheelPinch:!0,zoomRange:[.001,1/0],wheelPinchKey:"ctrl",useWheelScroll:kv,zoomOffsetX:"50%",zoomOffsetY:"50%",translateZ:0,useGesture:!0,useResizeObserver:!1,pinchDirection:"all",preventWheelClick:!0,useBounceScrollBar:!1,useOverflowScroll:!1},xc=function(t){return 1-Math.pow(1-t,3)},yc={horizontal:{pos:"Left",coord:"X",size:"Width"},vertical:{pos:"Top",coord:"Y",size:"Height"}},Rv=mc.className,bc=["margin","threshold","zoomOffsetX","zoomOffsetY","zoom","zoomX","zoomY","rangeX","rangeY","rangeOffsetX","rangeOffsetY","usePinch","useMouseDrag","pinchThreshold","maxPinchWheel","wheelScale","displayVerticalScroll","displayHorizontalScroll","translateZ","useAutoZoom","wheelPinchKey","zoomRange","zoomRangeX","zoomRangeY","pinchDirection","useOverflowScroll"],Py=dc(dc([],bc,!0),["preventWheelClick","useWheelPinch","useWheelScroll","useGesture","cspNonce","wrapperElement","scrollAreaElement","verticalScrollElement","horizontalScrollElement","useResizeObserver","wheelContainer","useBounceScrollBar"],!1),zy=null,Ny=null,Ov=1e-6;function Lv(t){var e=t.deltaX,n=t.deltaY,r=t.datas,i=Date.now(),a=r.speed;if(!a){r.speed=[0,0],r.time=i;return}var o=i-r.time;r.speed=[a[0]/2+e/o,a[1]/2+n/o]}function Cc(t,e){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return Math.abs(n/e)}function _v(t,e){var n=Cc(t,e);return[-t[0]/2*n,-t[1]/2*n]}function gn(t){return Math.abs(t)}function Iv(t,e,n,r,i){var a=i||isFinite(n[0])?n[0]:Math.min(-1,Math.floor(t/e))*e-r,o=i||isFinite(n[1])?n[1]:Math.max(1,Math.ceil(t/e))*e+r;return[a,o]}function Sc(t,e){return t??e}function Ec(t,e,n){var r=n.duration,i=n.easing||function(l){return 1-Math.pow(1-l,3)},a=Date.now(),o=a,s=function(){var l=Date.now(),c=l-a;r<c&&(c=r);var u=i(c/r),d=i((o-a)/r);o=l,t(u-d),!(c>=r)&&e(s)};e(s)}var wc=function(t){Oo(e,t);function e(r,i,a){var o=t.call(this)||this;o.type=i,o.isAppend=!1,o.size=0,o.scrollSize=0,o.isHorizontal=!1,o._onDragStart=function(d){var f=o.isHorizontal,h=d.inputEvent.target,v=d.datas,p=o.thumbElement===h;p||setTimeout(function(){requestAnimationFrame(function(){var g=o.thumbElement.getBoundingClientRect(),m=g[f?"left":"top"],x=g[f?"width":"height"],b=m+x,C=d[f?"clientX":"clientY"];if(!(m<=C&&C<=b)){var E=o.size,S=E*E/o.scrollSize;o.scrollBy(m<C?S:-S)}})},100),v.isThumb=p,d.inputEvent.stopPropagation(),d.inputEvent.preventDefault()},o._onDrag=function(d){d.datas.isThumb&&o.scrollBy(o.isHorizontal?d.deltaX:d.deltaY)},o._onWheel=function(d){var f=o.isHorizontal?d.deltaX:d.deltaY;f&&d.preventDefault(),o.trigger("scroll",{delta:f})};var s=i==="horizontal",l=Se(r),c,u=a;return a?c=a.querySelector(".".concat(gc)):(u=l.createElement("div"),c=l.createElement("div"),u.insertBefore(c,null),o.isAppend=!0),Tn(u,s?vc:pc),Tn(u,Av),Tn(c,gc),o.thumbElement=c,o.barElement=u,o.isHorizontal=s,o.gesto=new ia(u,{container:Ee(l)}).on("dragStart",function(d){return o._onDragStart(d)}).on("drag",function(d){return o._onDrag(d)}),re(o.barElement,"wheel",o._onWheel,{passive:!1}),o}var n=e.prototype;return n.scrollBy=function(r,i){var a=r/this.size;this.trigger("scroll",{delta:i?r:this.scrollSize*a})},n.render=function(r,i,a,o){this.size=a,this.scrollSize=o;var s=r&&Et(o-a,.001)>0?1:0,l=this.isHorizontal?["X","width"]:["Y","height"],c=l[0],u=l[1],d=a/o*100,f=Math.max(0,i)/o*100;this.thumbElement.style.cssText+="".concat(u,": ").concat(d,"%;opacity: ").concat(s,";")+"transform: translate".concat(c,"(").concat(100/d*f,"%)")},n.destroy=function(){Jt(this.barElement,"wheel",this._onWheel),this.gesto.off(),this.off()},e}(Qn),Pv=function(t){Oo(e,t);function e(r,i,a){i===void 0&&(i={}),a===void 0&&(a={});var o=t.call(this)||this;return o._containerElement=r,o.offsetX=0,o.offsetY=0,o.containerWidth=0,o.containerHeight=0,o.viewportWidth=0,o.viewportHeight=0,o.viewportScrollWidth=0,o.viewportScrollHeight=0,o.scrollLeft=0,o.scrollTop=0,o._scrollTimer=0,o._zoomTimer=0,o._viewportElement=null,o._wheelContainerElement=null,o.dragFlag=!1,o.isLoop=!1,o._tempScale=[1,1],o._tempRect=null,o._tempRectTimer=null,o._onDestroys=[],o._asLeft=0,o._asTop=0,o.resize=function(){var s=o._containerElement,l=s.offsetWidth,c=s.offsetHeight,u=o._viewportElement,d=u.offsetWidth,f=u.offsetHeight,h=u.scrollWidth,v=u.scrollHeight;o.containerWidth=l,o.containerHeight=c,o.viewportWidth=d,o.viewportHeight=f,o.viewportScrollWidth=Math.max(d,h),o.viewportScrollHeight=Math.max(f,v),o.render(),o._scrollBy(0,0)},o._onScroll=function(){var s=o.wrapperElement,l=s.scrollLeft,c=s.scrollTop,u=o.zoom,d=u===void 0?ke.zoom:u,f=l-o.scrollLeft,h=c-o.scrollTop,v=o.getScrollLeft(),p=o.getScrollTop();o.isLoop&&(o.isLoop=!1),o.scrollLeft=l,o.scrollTop=c,o.scrollTo(v+f/d,p+h/d)},o.onWheel=function(s){var l=o.options,c=l.pinchDirection,u=l.maxPinchWheel||1/0,d=s["".concat(o.wheelPinchKey,"Key")]||s.ctrlKey;if(l.useWheelPinch&&d){var f=s.deltaY,h=f>=0?1:-1,v=Math.min(u,Math.abs(f));f=h*v;var p=-f,g=Math.max(1+p*(l.wheelScale||.01),Ov);clearTimeout(o._tempRectTimer),o._tempRectTimer=window.setTimeout(function(){o._tempRect=null},100),o._triggerPinch({distance:v,scale:g,rotation:0,zoom:o.zoom*g,zoomX:o.zoomX*(c==="vertical"?1:g),zoomY:o.zoomY*(c==="horizontal"?1:g),inputEvent:s,isWheel:!0,clientX:s.clientX,clientY:s.clientY,ratioX:0,ratioY:0})}else if(l.useWheelScroll){var m=s.deltaX,f=s.deltaY;s.shiftKey&&!m&&(m=f,f=0),o.scrollBy(m/o.zoomX,f/o.zoomY)}else return;s.preventDefault()},o.onGestureStart=function(s){o._tempScale=[o.zoomX,o.zoomY],o._setClientRect(),s.preventDefault()},o.onGestureChange=function(s){if(s.preventDefault(),o.gesto.isFlag()||!o._tempScale){o._tempScale=[1,1];return}var l=s.scale,c=o._tempScale[0],u=o._tempScale[1],d=o.options.pinchDirection;o._triggerPinch({distance:0,scale:l,rotation:s.rotation,inputEvent:s,isWheel:!0,zoom:(c+u)*l/2,zoomX:c*(d==="vertical"?1:l),zoomY:u*(d==="horizontal"?1:l),clientX:s.clientX,clientY:s.clientY,ratioX:0,ratioY:0})},o.onGestureEnd=function(){},pn(i)?(o._viewportElement=i,o.options=He(He({},ke),a)):(o._viewportElement=r.children[0],o.options=He(He({},ke),i)),o.init(),o}var n=e.prototype;return n.getContainer=function(){return this._containerElement},n.getWheelContainer=function(){return this._wheelContainerElement},n.getViewport=function(){return this._viewportElement},n.getWrapper=function(){return this.wrapperElement},n.geScrollArea=function(){return this.scrollAreaElement},n.destroy=function(){this.off(),this.gesto.unset(),this.verticalScrollbar.destroy(),this.horizontalScrollbar.destroy(),this.injectResult.destroy();var r=this._containerElement;this._onDestroys.forEach(function(i){i()}),Jt(this.wrapperElement,"scroll",this._onScroll),Jt(this._wheelContainerElement,"wheel",this.onWheel),Jt(r,"gesturestart",this.onGestureStart),Jt(r,"gesturechange",this.onGestureChange),Jt(r,"gesturesend",this.onGestureEnd),this.gesto=null,this.injectResult=null,this._containerElement=null,this._viewportElement=null,this.options=null},n.getScrollTop=function(r){r===void 0&&(r={});var i=!1,a=!1;Te(r)?(i=r.range,a=r.absolute):i=r;var o=this.zoomY,s=this.scrollTop/o+this.offsetY+(i?gn(this.getRangeY()[0]):0);return a?s*o:s},n.getScrollLeft=function(r){r===void 0&&(r={});var i=!1,a=!1;Te(r)?(i=r.range,a=r.absolute):i=r;var o=this.zoomX,s=this.scrollLeft/o+this.offsetX+(i?gn(this.getRangeX()[0]):0);return a?s*o:s},n.getScrollWidth=function(r){var i=this._getScrollRangeX(),a=this.zoomX,o=this.containerWidth/a+gn(i[0])+i[1];return r?o:o*a},n.getScrollHeight=function(r){var i=this._getScrollRangeY(),a=this.zoomY,o=this.containerHeight/a+gn(i[0])+i[1];return r?o:o*a},n.scrollCenter=function(r){r===void 0&&(r={}),this.resize();var i=this.zoomX,a=this.zoomY,o=-(this.containerWidth/i-this.viewportWidth)/2,s=-(this.containerHeight/a-this.viewportHeight)/2;return r.absolute&&(o*=i,s*=a),r.horizontal===!1&&(o=this.getScrollLeft()),r.vertical===!1&&(s=this.getScrollTop()),this.scrollTo(o,s,r)},n.setTo=function(r){var i=r.x,a=i===void 0?this.getScrollLeft():i,o=r.y,s=o===void 0?this.getScrollTop():o,l=r.zoom,c=l===void 0?[this.getZoomX(),this.getZoomY()]:l,u=r.duration,d=this,f=d.zoomX,h=d.zoomY,v=d.zoomRange,p=this,g=p.zoomOffsetX,m=g===void 0?ke.zoomOffsetX:g,x=p.zoomOffsetY,b=x===void 0?ke.zoomOffsetY:x;"zoomOffsetX"in r&&(m=r.zoomOffsetX),"zoomOffsetY"in r&&(b=r.zoomOffsetY);var C=qt(c)?c:[c,c],E=C[0],S=C[1],D=this.zoomRangeX||v,M=this.zoomRangeY||v,w=nn(E,D[0],D[1]),T=nn(S,M[0],M[1]),k=It("".concat(m),this.viewportWidth)*(1/f-1/w),O=It("".concat(b),this.viewportHeight)*(1/h-1/T);this.scrollTo(a-k,s-O,{duration:u}),this.setZoom(c,{zoomOffsetX:m,zoomOffsetY:b,duration:u,zoomBase:"fixed"})},n.setBy=function(r){var i=r.x,a=i===void 0?0:i,o=r.y,s=o===void 0?0:o,l=r.zoom,c=l===void 0?[0,0]:l,u=qt(c)?c:[c,c],d=u[0],f=u[1];this.setTo(He(He({},r),{x:this.getScrollLeft()+a,y:this.getScrollTop()+s,zoom:[this.zoomX+d,this.zoomY+f]}))},n.scrollBy=function(r,i,a){if(this._pauseScrollAnimation(),!a||!a.duration){var o=this.getScrollLeft(),s=this.getScrollTop();return a?.absolute&&(o*=this.zoomX,s*=this.zoomY),this._scrollTo(o+r,s+i,a)}else return this._startScrollAnimation([r,i],a),!0},n.scrollTo=function(r,i,a){if(this._pauseScrollAnimation(),!a||!a.duration)return this._scrollTo(r,i,a);var o=this.getScrollLeft(),s=this.getScrollTop();return a?.absolute&&(o*=this.zoomX,s*=this.zoomY),this.scrollBy(r-o,i-s,a)},n.zoomBy=function(r,i){this._pauseZoomAnimation();var a=qt(r)?r:[r,r],o=a[0],s=a[1];!i||!i.duration?this._setZoom([this.zoomX+o,this.zoomY+s],i):this._startZoomAnimation([o,s],i)},n.setZoom=function(r,i){if(this._pauseZoomAnimation(),!i||!i.duration)this._setZoom(r,i);else{var a=qt(r)?r:[r,r],o=a[0],s=a[1];this._startZoomAnimation([o-this.zoomX,s-this.zoomY],i)}},n.getViewportWidth=function(){return this.viewportWidth},n.getViewportHeight=function(){return this.viewportWidth},n.getViewportScrollWidth=function(){return this.viewportScrollWidth},n.getViewportScrollHeight=function(){return this.viewportScrollHeight},n.getContainerWidth=function(){return this.containerWidth},n.getContainerHeight=function(){return this.containerHeight},n.getZoom=function(){return(this.zoomX+this.zoomY)/2},n.getZoomX=function(){return this.zoomX},n.getZoomY=function(){return this.zoomY},n.getRangeX=function(r,i){return this._getRangeCoord("horizontal",r,i)},n.getRangeY=function(r,i){return this._getRangeCoord("vertical",r,i)},n.init=function(){var r=this,i,a=this._containerElement,o=this.options,s=Se(a),l=Ee(a),c=o.wrapperElement||a.querySelector(".".concat(fc)),u=o.scrollAreaElement||a.querySelector(".".concat(hc)),d=o.horizontalScrollElement||a.querySelector(".".concat(vc)),f=o.verticalScrollElement||a.querySelector(".".concat(pc));c||(c=s.createElement("div"),c.insertBefore(this._viewportElement,null),a.insertBefore(c,null)),this.wrapperElement=c,u||(u=s.createElement("div"),c.insertBefore(u,c.firstChild)),this.scrollAreaElement=u,Tn(a,Rv),Tn(c,fc),Tn(u,hc);var h=new wc(a,"horizontal",d),v=new wc(a,"vertical",f);this.horizontalScrollbar=h,this.verticalScrollbar=v,h.on("scroll",function(x){r.scrollBy(x.delta/r.zoomX,0)}),v.on("scroll",function(x){r.scrollBy(0,x.delta/r.zoomY)}),h.isAppend&&a.insertBefore(h.barElement,null),v.isAppend&&a.insertBefore(v.barElement,null),this.injectResult=mc.inject(a,{nonce:this.options.cspNonce});var p=o.wheelContainer,g=null;if(p&&(ye(p)?g=s.querySelector(p):pn(p)?g=p:("value"in p||"current"in p)&&(g=p.current||p.value)),g||(g=a),this._wheelContainerElement=g,this.gesto=new ia(a,{container:Ee(a),events:["touch","mouse"],preventWheelClick:(i=this.options.preventWheelClick)!==null&&i!==void 0?i:!0}).on("dragStart",function(x){var b=x.inputEvent,C=x.stop,E=x.datas;if(!r.useMouseDrag&&x.isMouseEvent){C();return}r._pauseScrollAnimation(),r.dragFlag=!1;var S=r.trigger("dragStart",x);if(S===!1){C();return}b.preventDefault(),E.startEvent=b}).on("drag",function(x){!r.options.usePinch||x.isPinch||r.useMouseDrag&&x.isMouseEvent?(r.trigger("drag",He(He({},x),{inputEvent:x.inputEvent})),Lv(x),r.scrollBy(-x.deltaX/r.zoomX,-x.deltaY/r.zoomY)):!r.dragFlag&&x.movement>o.pinchThreshold&&(r.dragFlag=!0,r.trigger("abortPinch",{inputEvent:x.datas.startEvent||x.inputEvent}))}).on("dragEnd",function(x){r.trigger("dragEnd",{isDrag:x.isDrag,isDouble:x.isDouble,inputEvent:x.inputEvent}),r._startScrollAnimationBySpeed(x.datas.speed)}).on("pinchStart",function(x){var b=x.inputEvent,C=x.datas,E=x.stop;b.preventDefault(),r._pauseScrollAnimation(),C.startZoom=[r.zoomX,r.zoomY];var S=r.trigger("pinchStart",{inputEvent:b});S===!1&&E(),r._setClientRect()}).on("pinch",function(x){var b=x.scale,C=r.options.pinchDirection;r._triggerPinch({rotation:x.rotation,distance:x.distance,scale:x.scale,inputEvent:x.inputEvent,isWheel:!1,zoom:x.datas.startZoom*b,zoomX:r.zoomX*(C==="vertical"?1:b),zoomY:r.zoomY*(C==="horizontal"?1:b),clientX:x.clientX,clientY:x.clientY,ratioX:0,ratioY:0})}).on("pinchEnd",function(){r._tempRect=null}),re(c,"scroll",this._onScroll),o.useResizeObserver){var m=new l.ResizeObserver(function(){r.resize()});m.observe(this._viewportElement),m.observe(this._containerElement),this._onDestroys.push(function(){m.disconnect()})}else re(l,"resize",this.resize),this._onDestroys.push(function(){Jt(l,"resize",r.resize)});(o.useWheelPinch||o.useWheelScroll)&&re(g,"wheel",this.onWheel,{passive:!1}),o.useGesture&&(re(a,"gesturestart",this.onGestureStart,{passive:!1}),re(a,"gesturechange",this.onGestureChange,{passive:!1})),this.resize()},n.render=function(){var r=this,i=r.offsetX,a=r.offsetY,o=r.zoomX,s=o===void 0?ke.zoomX:o,l=r.zoomY,c=l===void 0?ke.zoomY:l,u=r.translateZ,d=u===void 0?0:u,f=r.rangeX,h=r.rangeY,v=r.containerWidth,p=r.containerHeight,g=this.options.useTransform,m=g===void 0?ke.useTransform:g,x=-i*s,b=-a*c;this.scrollAreaElement.style.cssText="width:calc(100% + ".concat(this.getScrollAreaWidth(),"px);")+"height:calc(100% + ".concat(this.getScrollAreaHeight(),"px);");var C=this._viewportElement.style;m===!1?C.cssText+="position: relative; left: ".concat(x,"px; top: ").concat(b,"px; "):C.cssText+="transform-origin: 0 0;"+"transform:translate3d(".concat(x,"px, ").concat(b,"px, ").concat(d,"px) scale(").concat(s,", ").concat(c,");"),this.renderScroll()},n.renderScroll=function(){var r=this,i=r.zoomX,a=r.zoomY,o=r.containerWidth,s=r.containerHeight,l=this.horizontalScrollbar,c=this.verticalScrollbar;if(this.options.useBounceScrollBar){var u=this.getScrollLeft(!0)*i,d=this.getRangeX(!0),f=o+gn(d[0])+gn(d[1]),h=this.getScrollTop(!0)*a,v=this.getRangeY(!0),p=s+gn(v[0])+gn(v[1]);l.render(this.displayHorizontalScroll,u,o,f),c.render(this.displayVerticalScroll,h,s,p)}else{var g=this._getScrollRangeX(),m=this._getScrollRangeY(),u=this.getScrollLeft(),h=this.getScrollTop(),f=this.containerWidth+gn(g[0])+g[1],p=this.containerHeight+gn(m[0])+m[1];l.render(this.displayHorizontalScroll,u-g[0],o,f),c.render(this.displayVerticalScroll,h-m[0],s,p)}},n.move=function(r,i){var a=this.wrapperElement;a.scrollLeft=r,a.scrollTop=i},n.setDisplayVerticalScroll=function(r){this.options.displayVerticalScroll=r,this.renderScroll()},n.setDisplayHorizontalScroll=function(r){this.options.displayHorizontalScroll=r,this.renderScroll()},n._startZoomAnimation=function(r,i){var a=this;if(r){var o=i.duration,s=i.easing||xc;Ec(function(l){return a._setZoom([a.zoomX+r[0]*l,a.zoomY+r[1]*l],i)},function(l){a._zoomTimer=requestAnimationFrame(l)},{easing:s,duration:o})}},n._startScrollAnimation=function(r,i){var a=this;if(!(!r[0]&&!r[1])){var o=i.duration,s=i.easing||xc;Ec(function(l){return a._scrollBy(r[0]*l,r[1]*l,i)},function(l){a._scrollTimer=requestAnimationFrame(l)},{easing:s,duration:o})}},n._startScrollAnimationBySpeed=function(r){if(!(!r||!r[0]&&!r[1])){var i=-6e-4,a=Cc(r,i),o=_v(r,i);return this._startScrollAnimation(o,{duration:a})}},n._pauseScrollAnimation=function(){cancelAnimationFrame(this._scrollTimer),this._scrollTimer=0},n._pauseZoomAnimation=function(){cancelAnimationFrame(this._zoomTimer),this._zoomTimer=0},n.getScrollAreaWidth=function(){var r=this.getRangeX(!0),i=r[0],a=r[1];return i||a?this.margin*2:0},n.getScrollAreaHeight=function(){var r=this.getRangeY(!0),i=r[0],a=r[1];return i||a?this.margin*2:0},n._triggerPinch=function(r){var i=r.clientX,a=r.clientY,o=r.zoomX,s=r.zoomY;this.useAutoZoom&&this._zoomByClient([o,s],i,a),this._tempRect||this._setClientRect();var l=this.zoomRange,c=this.zoomRangeX||l,u=this.zoomRangeY||l,d=this._tempRect,f=d.left,h=d.top,v=d.width,p=d.height,g=(i-f)/v*100,m=(a-h)/p*100;this.trigger("pinch",He(He({},r),{zoom:nn((o+s)/2,l[0],l[1]),zoomX:nn(o,c[0],c[1]),zoomY:nn(s,u[0],u[1]),ratioX:g,ratioY:m}))},n._setClientRect=function(){var r=this.getContainer().getBoundingClientRect();this._tempRect={left:r.left,top:r.top,width:r.width,height:r.height}},n._zoomByClient=function(r,i,a){this._tempRect||this._setClientRect();var o=this._tempRect,s=o.left,l=o.top,c=o.width,u=o.height,d=this.options,f=d.zoomOffsetX,h=d.zoomOffsetY;d.zoomOffsetX="".concat((i-s)/c*100,"%"),d.zoomOffsetY="".concat((a-l)/u*100,"%"),this._setZoom(r,{zoomBase:"screen"}),d.zoomOffsetX=f,d.zoomOffsetY=h},n._setZoom=function(r,i){i===void 0&&(i={});var a=i.zoomBase,o=this,s=o.containerWidth,l=o.containerHeight,c=o.zoomX,u=o.zoomY,d=o.zoomRange,f=this,h=f.zoomOffsetX,v=h===void 0?ke.zoomOffsetX:h,p=f.zoomOffsetY,g=p===void 0?ke.zoomOffsetY:p;"zoomOffsetX"in i&&(v=i.zoomOffsetX),"zoomOffsetY"in i&&(g=i.zoomOffsetY);var m=this.getScrollLeft(),x=this.getScrollTop(),b=qt(r)?r:[r,r],C=b[0],E=b[1],S=this.zoomRangeX||d,D=this.zoomRangeY||d,M=nn(C,S[0],S[1]),w=nn(E,D[0],D[1]),T=this.options;T.zoomX=M,T.zoomY=w,T.zoom=(M+w)/2;var k=this.getScrollLeft(),O=this.getScrollTop(),R=0,L=0;a==="fixed"?(R=It("".concat(v),this.viewportWidth),L=It("".concat(g),this.viewportHeight)):a==="viewport"?(R=(-m+It("".concat(v),this.viewportWidth))*c,L=(-x+It("".concat(g),this.viewportHeight))*u):(R=It("".concat(v),s),L=It("".concat(g),l));var P=m+R/c,z=x+L/u,V=k+R/M,N=O+L/w;this._scrollBy(P-V,z-N,{zoom:!!(M-c||w-u)}),this.render()},n._scrollBy=function(r,i,a){var o=this.getScrollLeft(),s=this.getScrollTop();return a?.absolute&&(o*=this.zoomX,s*=this.zoomY),this._scrollTo(o+r,s+i,a)},n._scrollTo=function(r,i,a){var o=this,s=this,l=s.scrollLeft,c=s.scrollTop,u=a?.absolute;this._scrollToType("horizontal",r,u),this._scrollToType("vertical",i,u);var d=this.scrollLeft,f=this.scrollTop;this.render();var h=this.getScrollLeft(),v=this.getScrollTop();return this._emitScrollEvent(h,v,a?.zoom),Math.round(l)!==d||Math.round(c)!==f?(this.isLoop=!0,this.move(d,f),requestAnimationFrame(function(){if(o.isLoop){o.isLoop=!1;var p=o.wrapperElement,g=p.scrollLeft,m=p.scrollTop;o.scrollLeft=g,o.scrollTop=m,(d!==Math.round(g)||f!==Math.round(m))&&o._scrollTo(h,v)}}),!1):!0},n._scrollToType=function(r,i,a){var o=yc[r],s=this,l=s.margin,c=l===void 0?ke.margin:l,u=s.threshold,d=u===void 0?ke.threshold:u,f=this["scroll".concat(o.pos)],h=this["getRange".concat(o.coord)](!0,!0),v=h[0],p=h[1],g=Math.round(f),m=this["getScrollArea".concat(o.size)](),x=this["zoom".concat(o.coord)];a&&(i=i/x);var b=i*x;if(v===p)g=v,i=v/x;else if(b-d<=v){var C=Math.max(0,b-v);g=C,i=(v+C)/x}else if(b+d>=p){var E=Math.max(0,p-b);g=m-E,i=(p-E)/x}else g<d?g+=c:g>m-d&&(g-=c);g=Math.round(g),this["scroll".concat(o.pos)]=g,this["offset".concat(o.coord)]=i-g/x},n._getRangeCoord=function(r,i,a){var o=this,s=o.margin,l=s===void 0?ke.margin:s,c=o.threshold,u=yc[r],d=Sc(this["range".concat(u.coord)],ke["range".concat(u.coord)]),f=Sc(this["rangeOffset".concat(u.coord)],ke["rangeOffset".concat(u.coord)]),h=this["zoom".concat(u.coord)],v=Iv(this["getScroll".concat(u.pos)](),l,d,c,a);return i?[v[0]*h+f[0],this.options.useOverflowScroll?Math.max(this["viewport".concat(u.size)]*h-this["container".concat(u.size)],v[1]*h+f[1]):v[1]*h+f[1]]:[v[0]+f[0],v[1]+f[1]]},n._emitScrollEvent=function(r,i,a){var o=this._asLeft,s=this._asTop;!a&&o===r&&s===i||(this._asLeft=r,this._asTop=i,this.trigger("scroll",{scrollLeft:r,scrollTop:i,zoomX:this.zoomX,zoomY:this.zoomY}))},n._getScrollRangeX=function(){var r=this.getScrollLeft(),i=this.rangeX,a=i[0],o=i[1];this.useOverflowScroll&&isFinite(o)&&(o=Math.max(o,this.viewportWidth-this.containerWidth/this.zoomX));var s=Math.min(0,isFinite(a)?Math.min(a,r):r),l=Math.max(0,isFinite(o)?Math.max(o,r):r),c=this.viewportScrollWidth,u=Math.max(this.containerWidth/this.zoomX,c)-c,d=Math.min(0,u+s);return[d,l]},n._getScrollRangeY=function(){var r=this.getScrollTop(),i=this.rangeY,a=i[0],o=i[1];this.useOverflowScroll&&isFinite(o)&&(o=Math.max(o,this.viewportHeight-this.containerHeight/this.zoomY));var s=Math.min(0,isFinite(a)?Math.min(a,r):r),l=Math.max(0,isFinite(o)?Math.max(o,r):r),c=this.viewportScrollHeight,u=Math.max(this.containerHeight/this.zoomY,c)-c,d=Math.min(0,u+s);return[d,l]},e=Mv([aa(bc,function(r,i){var a={enumerable:!0,configurable:!0,get:function(){return this.options[i]}},o=ea("set ".concat(i));r[o]?a.set=function(s){this[o](s)}:a.set=function(s){this.options[i]=s},Object.defineProperty(r,i,a)})],e),e}(Qn),zv=function(t){Oo(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pv);const Nv=zv;var Bv=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(n){return this.values[this.keys.indexOf(n)]},e.set=function(n,r){var i=this.keys,a=this.values,o=i.indexOf(n),s=o===-1?i.length:o;i[s]=n,a[s]=r},t}(),jv=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(n){return this.object[n]},e.set=function(n,r){this.object[n]=r},t}(),Vv=typeof Map=="function",Fv=function(){function t(){}var e=t.prototype;return e.connect=function(n,r){this.prev=n,this.next=r,n&&(n.next=this),r&&(r.prev=this)},e.disconnect=function(){var n=this.prev,r=this.next;n&&(n.next=r),r&&(r.prev=n)},e.getIndex=function(){for(var n=this,r=-1;n;)n=n.prev,++r;return r},t}();function Gv(t,e){var n=[],r=[];return t.forEach(function(i){var a=i[0],o=i[1],s=new Fv;n[a]=s,r[o]=s}),n.forEach(function(i,a){i.connect(n[a-1])}),t.filter(function(i,a){return!e[a]}).map(function(i,a){var o=i[0],s=i[1];if(o===s)return[0,0];var l=n[o],c=r[s-1],u=l.getIndex();l.disconnect(),c?l.connect(c,c.next):l.connect(void 0,n[0]);var d=l.getIndex();return[u,d]})}var $v=function(){function t(n,r,i,a,o,s,l,c){this.prevList=n,this.list=r,this.added=i,this.removed=a,this.changed=o,this.maintained=s,this.changedBeforeAdded=l,this.fixed=c}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){var n=Gv(this.changedBeforeAdded,this.fixed),r=this.changed,i=[];this.cacheOrdered=n.filter(function(a,o){var s=a[0],l=a[1],c=r[o],u=c[0],d=c[1];if(s!==l)return i.push([u,d]),!0}),this.cachePureChanged=i},t}();function ui(t,e,n){var r=Vv?Map:n?jv:Bv,i=n||function(x){return x},a=[],o=[],s=[],l=t.map(i),c=e.map(i),u=new r,d=new r,f=[],h=[],v={},p=[],g=0,m=0;return l.forEach(function(x,b){u.set(x,b)}),c.forEach(function(x,b){d.set(x,b)}),l.forEach(function(x,b){var C=d.get(x);typeof C>"u"?(++m,o.push(b)):v[C]=m}),c.forEach(function(x,b){var C=u.get(x);typeof C>"u"?(a.push(b),++g):(s.push([C,b]),m=v[b]||0,f.push([C-m,b-g]),h.push(b===C),C!==b&&p.push([C,b]))}),o.reverse(),new $v(t,e,a,o,p,s,f,h)}var Wv=function(){function t(n,r){n===void 0&&(n=[]),this.findKeyCallback=r,this.list=[].slice.call(n)}var e=t.prototype;return e.update=function(n){var r=[].slice.call(n),i=ui(this.list,r,this.findKeyCallback);return this.list=r,i},t}();const Hv=Wv;var Lo=function(t,e){return Lo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Lo(t,e)};function di(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Lo(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ye=function(){return Ye=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ye.apply(this,arguments)};function Dc(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function _o(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function Mc(t){var e=0;return t.map(function(n){return n==null?"$compat".concat(++e):"".concat(n)})}function Tc(t){var e=[];return t.forEach(function(n){e=e.concat(qt(n)?Tc(n):n)}),e}function Io(t,e){if(!e)return t;for(var n in e)Ji(t[n])&&(t[n]=e[n]);return t}function sa(t,e){if(t===e)return!1;for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0;return!1}function kc(t){var e=t.className,n=Dc(t,["className"]);return e!=null&&(n.class=e),delete n.style,delete n.children,n}function Ac(t){var e={},n={};for(var r in t)r.indexOf("on")===0?n[r]=t[r]:e[r]=t[r];return[e,n]}function la(t){if(!t)return null;var e=t.b;return pn(e)?e:la(t.c)}function Rc(t){var e=t.parentNode;e&&e.removeChild(t)}function Oc(t){t.forEach(function(e){e()})}function Yv(){return this.constructor(this.props,this.context)}var Po=0,ca=function(){function t(n,r,i,a,o,s,l){l===void 0&&(l={}),this.t=n,this.d=r,this.k=i,this.i=a,this.c=o,this.ref=s,this.ps=l,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=t.prototype;return e.s=function(){return!0},e.u=function(n,r,i,a,o){var s=this,l=s.d,c=Jh(r).filter(function(v){return v.$_req}),u=Tc(c.map(function(v){return v.$_subs})),d=ze(u,function(v){return v.d===l});if(s.b&&!ye(i)&&!o&&!s.s(i.props,a)&&!d){var f=u.reduce(function(v,p){var g=p.d;return v[0]?v[0].d===g&&v.push(p):g>l&&v.push(p),v},[]);return f.forEach(function(v){hi(v,v._ps,[v.o],n,r,!0)}),!1}s.o=i,s.ss(a);var h=s.ps;return ye(i)||(s.ps=i.props,s.ref=i.ref),da(this),s.r(n,r,s.b?h:{},a),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var n=this,r=n.ref,i=n.fr;r&&r(i?i.current:n.b)},t}();function ua(){return Object.__CROACT_CURRENT_INSTNACE__}function Lc(){return Po}function Kv(t){Po=t}function da(t){return Object.__CROACT_CURRENT_INSTNACE__=t,Po=0,t}var zo=function(){function t(n,r){n===void 0&&(n={}),this.props=n,this.context=r,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=t.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(n,r){return this.props!==n||this.state!==r},e.setState=function(n,r,i){var a=this;a.$_timer||(a.$_state={}),clearTimeout(a.$_timer),a.$_timer=0,a.$_state=Ye(Ye({},a.$_state),n),i?a.$_setState(r,i):a.$_timer=window.setTimeout(function(){a.$_timer=0,a.$_setState(r,i)})},e.forceUpdate=function(n){this.setState({},n,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(n,r){},e.componentWillUnmount=function(){},e.$_setState=function(n,r){var i=[],a=this.$_p,o=hi(a.c,[a],[a.o],i,a._cs,Ye(Ye({},this.state),this.$_state),r);o&&(n&&i.push(n),Oc(i),da(null))},t}(),_c=function(t){di(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}var n=e.prototype;return n.shouldComponentUpdate=function(r,i){return sa(this.props,r)||sa(this.state,i)},e}(zo);function Ic(t){var e=function(n){e.current=n};return e.current=t,e}function Xv(t){return t._fr=!0,t}function Pc(t,e,n,r){var i,a;return!((i=t?.prototype)===null||i===void 0)&&i.render?a=new t(e,n):(a=new zo(e,n),a.constructor=t,t._fr?(r.fr=Ic(),a.render=function(){return this.constructor(this.props,r.fr)}):a.render=Yv),a.$_p=r,a}var Uv=function(t){di(e,t);function e(r,i,a,o,s,l,c){c===void 0&&(c={});var u=t.call(this,r,i,a,o,s,l,Io(c,r.defaultProps))||this;return u.typ="comp",u._usefs=[],u._uefs=[],u._defs=[],u}var n=e.prototype;return n.s=function(r,i){var a=this.b;return a.shouldComponentUpdate(Io(r,this.t.defaultProps),i||a.state)!==!1},n.r=function(r,i,a){var o,s,l=this,c=l.t;l.ps=Io(l.ps,l.t.defaultProps);var u=l.ps,d=!l.b,f=c.contextType,h=l.b,v=f?.get(l);l._cs=i,d?(h=Pc(c,u,v,l),l.b=h):(h.props=u,h.context=v);var p=h.state;l._usefs=[],l._uefs=[];var g=h.render();((s=(o=g?.props)===null||o===void 0?void 0:o.children)===null||s===void 0?void 0:s.length)===0&&(g.props.children=l.ps.children);var m=Ye(Ye({},i),h.$_cs);hi(l,l._ps,g?[g]:[],r,m),d?l._uefs.push(function(){f?.register(l),h.componentDidMount()}):l._uefs.push(function(){h.componentDidUpdate(a,p)}),r.push(function(){l._usefs.forEach(function(x){x()}),d?l.md():l.ud(),l._defs=l._uefs.map(function(x){return x()})})},n.ss=function(r){var i=this.b;!i||!r||(i.state=r)},n.un=function(){var r,i=this;i._ps.forEach(function(o){o.un()});var a=i.t;(r=a.contextType)===null||r===void 0||r.unregister(i),clearTimeout(i.b.$_timer),i._defs.forEach(function(o){o&&o()}),i.b.componentWillUnmount()},e}(ca);function Zv(t,e,n){var r=No(kc(t),kc(e)),i=r.added,a=r.removed,o=r.changed;for(var s in i)n.setAttribute(s,i[s]);for(var l in o)n.setAttribute(l,o[l][1]);for(var c in a)n.removeAttribute(c)}function Qv(t,e,n){var r=No(t,e),i=r.added,a=r.removed;for(var o in a)n.e(o,!0);for(var s in i)n.e(s)}function No(t,e){var n=hn(t),r=hn(e),i=ui(n,r,function(l){return l}),a={},o={},s={};return i.added.forEach(function(l){var c=r[l];a[c]=e[c]}),i.removed.forEach(function(l){var c=n[l];o[c]=t[c]}),i.maintained.forEach(function(l){var c=l[0],u=n[c],d=[t[u],e[u]];t[u]!==e[u]&&(s[u]=d)}),{added:a,removed:o,changed:s}}function qv(t,e,n){var r=n.style,i=No(t,e),a=i.added,o=i.removed,s=i.changed;for(var l in a){var c=na(l,"-");r.setProperty(c,a[l])}for(var l in s){var u=na(l,"-");r.setProperty(u,s[l][1])}for(var l in o){var d=na(l,"-");r.removeProperty(d)}}function Jv(t){return t.replace(/^on/g,"").toLowerCase()}var tp=function(t){di(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="elem",r._es={},r._svg=!1,r}var n=e.prototype;return n.e=function(r,i){var a=this,o=a._es,s=a.b,l=Jv(r);i?(Jt(s,l,o[r]),delete o[r]):(o[r]=function(c){var u,d;(d=(u=a.ps)[r])===null||d===void 0||d.call(u,c)},re(s,l,o[r]))},n.s=function(r){return sa(this.ps,r)},n.r=function(r,i,a){var o,s=this,l=!s.b,c=s.ps;if(l){var u=la(s.c),d=!1;s._svg||s.t==="svg"?d=!0:d=u&&u.ownerSVGElement,s._svg=d;var f=(o=s._hyd)===null||o===void 0?void 0:o.splice(0,1)[0],h=s.t;if(f)s._hyd=[].slice.call(f.children||[]);else{var v=Se(u);d?f=v.createElementNS("http://www.w3.org/2000/svg",h):f=v.createElement(h)}s.b=f}hi(s,s._ps,c.children,r,i);var p=s.b,g=Ac(a),m=g[0],x=g[1],b=Ac(c),C=b[0],E=b[1];return Zv(m,C,p),Qv(x,E,s),qv(a.style||{},c.style||{},p),r.push(function(){l?s.md():s.ud()}),!0},n.un=function(){var r=this,i=r._es,a=r.b;for(var o in i)Jt(a,o,i[o]);r._ps.forEach(function(s){s.un()}),r._es={},r._sel||Rc(a)},e}(ca);function fi(t){if(!t||pn(t))return t;var e=t.$_p._ps;return e.length?fi(e[0].b):null}function zc(t){if(t){if(t.b&&pn(t.b))return t;var e=t._ps;return e.length?zc(e[0]):null}}function Ke(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},a=i.key,o=i.ref,s=Dc(i,["key","ref"]);return{type:t,key:a,ref:o,props:Ye(Ye({},s),{children:Yl(n).filter(function(l){return l!=null&&l!==!1})})}}var Nc=function(t){di(e,t);function e(r,i){i===void 0&&(i=0);var a=t.call(this,"container",i,"container",0,null)||this;return a.typ="container",a.b=r,a}var n=e.prototype;return n.r=function(){return!0},n.un=function(){},e}(ca),ep=function(t){di(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.typ="text",r}var n=e.prototype;return n.r=function(r){var i,a=this,o=!a.b;if(o){var s=la(a.c),l=(i=a._hyd)===null||i===void 0?void 0:i.splice(0,1)[0];a.b=l||Se(s).createTextNode(a.t.replace("text_",""))}return r.push(function(){o?a.md():a.ud()}),!0},n.un=function(){Rc(this.b)},e}(ca);function np(t,e,n){var r=n.map(function(l){return ye(l)?null:l.key}),i=Mc(e.map(function(l){return l.k})),a=Mc(r),o=ui(i,a,function(l){return l});o.removed.forEach(function(l){e.splice(l,1)[0].un()}),o.ordered.forEach(function(l){var c=l[0],u=l[1],d=e.splice(c,1)[0];e.splice(u,0,d);var f=fi(d.b),h=fi(e[u+1]&&e[u+1].b);f&&f.parentNode.insertBefore(f,h)}),o.added.forEach(function(l){e.splice(l,0,Bc(n[l],r[l],l,t))});var s=o.maintained.filter(function(l){l[0];var c=l[1],u=n[c],d=e[c],f=ye(u)?"text_".concat(u):u.type;return f!==d.t?(d.un(),e.splice(c,1,Bc(u,r[c],c,t)),!0):(d.i=c,!1)});return _o(_o([],o.added,!0),s.map(function(l){l[0];var c=l[1];return c}),!0)}function rp(t,e){for(var n=t._ps,r=n.length,i=e.i+1;i<r;++i){var a=fi(n[i].b);if(a)return a}return null}function Bc(t,e,n,r){var i=r.d+1;if(ye(t)||Tr(t))return new ep("text_".concat(t),i,e,n,r,null,{});var a=t.type,o=typeof a=="string"?tp:Uv;return new o(a,i,e,n,r,t.ref,t.props)}function hi(t,e,n,r,i,a,o){var s=np(t,e,n),l=t._hyd,c=e.filter(function(d,f){return d._hyd=l,d.u(r,i,n[f],a,o)});t.typ==="container"&&t._sel&&e.forEach(function(d){var f=zc(d);f&&(f._sel=!0)}),t._hyd=null;var u=la(t);return u&&s.reverse().forEach(function(d){var f=e[d],h=fi(f.b);if(h&&u!==h&&!h.parentNode){var v=rp(t,f);u.insertBefore(h,v)}}),c.length>0}function jc(t,e,n,r){n===void 0&&(n=e.__CROACT__),r===void 0&&(r={});var i=!!n;n||(n=new Nc(e));var a=[];return hi(n,n._ps,t?[t]:[],a,r,void 0,void 0),Oc(a),da(null),i||(e.__CROACT__=n),n}function By(t,e,n){var r=e.__CROACT__;t&&!r&&(e.innerHTML=""),jc(t,e,r),n&&n()}function Vc(t,e,n){return!n&&t&&(n=new Nc(e.parentElement),n._hyd=[e],n._sel=!0),jc(t,e,n),n}var ip=0;function jy(t){var e="c".concat(++ip);function n(o){var s=this;if(!s.$_cs[e]){s.$_cs[e]=s;var l=[];s.shouldComponentUpdate=function(c){c.value!==s.props.value&&(s.$_req=!0)},s.render=function(){return s.props.children[0]},s.$_subs=l}return o.children[0]}function r(o,s){return o.children(s)}function i(o){return o._cs[e]}var a={$_id:e,$_dv:t,Consumer:r,Provider:n,get:function(o){var s,l;return(l=(s=i(o))===null||s===void 0?void 0:s.props.value)!==null&&l!==void 0?l:t},register:function(o){var s=i(o);s&&pushSet(s.$_subs,o)},unregister:function(o){var s=i(o);if(s){var l=s.$_subs,c=l.indexOf(o);c>-1&&l.splice(c,1)}}};return r.contextType=a,a}var ap=null;function Vy(t,e){return Ke(ap,{element:t,container:e})}function fa(t,e,n){if(t==null)return"";if(isString(t)||isNumber(t)||isFunction(t))return t;var r=t.type,i=t.props;if(isString(r)){var a={};getEntries(i).forEach(function(h){var v=h[0],p=h[1];if(v==="style")a[v]=getEntries(p).map(function(g){var m=g[0],x=g[1];return"".concat(decamelize(m),": ").concat(x,";")}).join("");else{if(v==="children")return;v.match(/^on[^a-z]/g)||(a[v]="".concat(p))}});var o=i.children.map(function(h){return fa(h,e)}).join("");if(n)return{tagName:r,props:a,children:o};var s=_o([r],getEntries(a).map(function(h){var v=h[0],p=h[1];return"".concat(v,'="').concat(p.replace(/"/g,'\\"'),'"')}),!0);return"<".concat(s.join(" "),">").concat(o,"</").concat(r,">")}else if(isFunction(r)){var l=r.contextType,c={b:null,_hs:[],_usefs:[],_uefs:[],_defs:[],_cs:e};da(c);var u=l?.get(c),d=Pc(r,i,u,{}),f=Ye(Ye({},e),d.$_cs);return c.b=d,fa(d.render(),f,n)}return""}function Fy(t){return fa(t,{})}function Gy(t){return fa(t,{},!0)}function Bo(t){var e=ua(),n=e._hs||(e._hs=[]),r=Lc(),i=n[r];if(Kv(r+1),i){if(!sa(i.deps,t.deps))return i.updated=!1,i;n[r]=t}else n.push(t);return t.value=t.func(),t.updated=!0,t}function op(t,e){var n=Bo({func:t,deps:e});return n.value}function sp(t){return op(function(){return Ic(t)},[])}function $y(t){var e=ua(),n=t.$_id,r=e._cs,i;return n in r?(i=r[n],i.props.value):t.$_dv,jo(function(){return t.register(e),function(){t.unregister(e)}},[]),t.get(e)}function Wy(t){var e=ua(),n=Lc(),r=e.b;return Bo({func:function(){r.state[n]=isFunction(t)?t():t},deps:[]}),[r.state[n],function(i){var a;return r.setState((a={},a[n]=i,a))}]}function jo(t,e,n){var r=ua(),i=Bo({func:function(){return t},deps:e}),a=n?r._usefs:r._uefs;i.updated?a.push(function(){return i.effect&&i.effect(),i.effect=t(),i.effect}):a.push(function(){return i.effect})}function lp(t,e,n){jo(function(){t?.(e())},n,!0)}var Hy="simple-1.0.0";function cp(t,e,n,r,i,a){for(var o=0;o<i;++o){var s=n+o*i,l=r+o*i;t[s]+=t[l]*a,e[s]+=e[l]*a}}function up(t,e,n,r,i){for(var a=0;a<i;++a){var o=n+a*i,s=r+a*i,l=t[o],c=e[o];t[o]=t[s],t[s]=l,e[o]=e[s],e[s]=c}}function dp(t,e,n,r,i){for(var a=0;a<r;++a){var o=n+a*r;t[o]/=i,e[o]/=i}}function Fc(t,e,n){n===void 0&&(n=Math.sqrt(t.length));for(var r=t.slice(),i=0;i<n;++i)r[i*n+e-1]=0,r[(e-1)*n+i]=0;return r[(e-1)*(n+1)]=1,r}function rn(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=t.slice(),r=ee(e),i=0;i<e;++i){var a=e*i+i;if(!Et(n[a],oe)){for(var o=i+1;o<e;++o)if(n[e*i+o]){up(n,r,i,o,e);break}}if(!Et(n[a],oe))return[];dp(n,r,i,e,n[a]);for(var o=0;o<e;++o){var s=o,l=o+i*e,c=n[l];!Et(c,oe)||i===o||cp(n,r,s,i,e,-c)}}return r}function fp(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=0;r<e;++r)for(var i=0;i<e;++i)n[i*e+r]=t[e*r+i];return n}function Gc(t,e){e===void 0&&(e=Math.sqrt(t.length));for(var n=[],r=t[e*e-1],i=0;i<e-1;++i)n[i]=t[e*(e-1)+i]/r;return n[e-1]=0,n}function hp(t,e){for(var n=ee(e),r=0;r<e-1;++r)n[e*(e-1)+r]=t[r]||0;return n}function Jn(t,e){for(var n=t.slice(),r=t.length;r<e-1;++r)n[r]=0;return n[e-1]=1,n}function an(t,e,n){if(e===void 0&&(e=Math.sqrt(t.length)),e===n)return t;for(var r=ee(n),i=Math.min(e,n),a=0;a<i-1;++a){for(var o=0;o<i-1;++o)r[a*n+o]=t[a*e+o];r[(a+1)*n-1]=t[(a+1)*e-1],r[(n-1)*n+a]=t[(e-1)*e+a]}return r[n*n-1]=t[e*e-1],r}function ha(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=ee(t);return e.forEach(function(i){r=Qt(r,i,t)}),r}function Qt(t,e,n){n===void 0&&(n=Math.sqrt(t.length));var r=[],i=t.length/n,a=e.length/i;if(i){if(!a)return t}else return e;for(var o=0;o<n;++o)for(var s=0;s<a;++s){r[s*n+o]=0;for(var l=0;l<i;++l)r[s*n+o]+=t[l*n+o]*e[s*i+l]}return r}function Ft(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]+e[i];return r}function pt(t,e){for(var n=Math.min(t.length,e.length),r=t.slice(),i=0;i<n;++i)r[i]=r[i]-e[i];return r}function vp(t,e){return e===void 0&&(e=t.length===6),e?[t[0],t[1],0,t[2],t[3],0,t[4],t[5],1]:t}function $c(t,e){return e===void 0&&(e=t.length===9),e?[t[0],t[1],t[3],t[4],t[6],t[7]]:t}function we(t,e,n){n===void 0&&(n=e.length);var r=Qt(t,e,n),i=r[n-1];return r.map(function(a){return a/i})}function pp(t,e){return Qt(t,[1,0,0,0,0,Math.cos(e),Math.sin(e),0,0,-Math.sin(e),Math.cos(e),0,0,0,0,1],4)}function gp(t,e){return Qt(t,[Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1],4)}function mp(t,e){return Qt(t,pi(e,4))}function va(t,e){var n=e[0],r=n===void 0?1:n,i=e[1],a=i===void 0?1:i,o=e[2],s=o===void 0?1:o;return Qt(t,[r,0,0,0,0,a,0,0,0,0,s,0,0,0,0,1],4)}function vi(t,e){return we(pi(e,3),Jn(t,3))}function Vo(t,e){var n=e[0],r=n===void 0?0:n,i=e[1],a=i===void 0?0:i,o=e[2],s=o===void 0?0:o;return Qt(t,[1,0,0,0,0,1,0,0,0,0,1,0,r,a,s,1],4)}function Fo(t,e){return Qt(t,e,4)}function pi(t,e){var n=Math.cos(t),r=Math.sin(t),i=ee(e);return i[0]=n,i[1]=r,i[e]=-r,i[e+1]=n,i}function ee(t){for(var e=t*t,n=[],r=0;r<e;++r)n[r]=r%(t+1)?0:1;return n}function Go(t,e){for(var n=ee(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[(e+1)*i]=t[i];return n}function tr(t,e){for(var n=ee(e),r=Math.min(t.length,e-1),i=0;i<r;++i)n[e*(e-1)+i]=t[i];return n}function $o(t,e,n,r,i,a,o,s){var l=t[0],c=t[1],u=e[0],d=e[1],f=n[0],h=n[1],v=r[0],p=r[1],g=i[0],m=i[1],x=a[0],b=a[1],C=o[0],E=o[1],S=s[0],D=s[1],M=[l,0,u,0,f,0,v,0,c,0,d,0,h,0,p,0,1,0,1,0,1,0,1,0,0,l,0,u,0,f,0,v,0,c,0,d,0,h,0,p,0,1,0,1,0,1,0,1,-g*l,-m*l,-x*u,-b*u,-C*f,-E*f,-S*v,-D*v,-g*c,-m*c,-x*d,-b*d,-C*h,-E*h,-S*p,-D*p],w=rn(M,8);if(!w.length)return[];var T=Qt(w,[g,m,x,b,C,E,S,D],8);return T[8]=1,an(fp(T),3,4)}function Yy(t){return[0,1].map(function(e){return average(t.map(function(n){return n[e]}))})}var gi=function(){return gi=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},gi.apply(this,arguments)};function Wo(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function er(t,e){return e===void 0&&(e=0),kr(Ar(t,e))}function Ky(t){return er(getComputedStyle(t).transform)}function pa(t,e){var n=we(t,[e[0],e[1]||0,e[2]||0,1],4),r=n[3]||1;return[n[0]/r,n[1]/r,n[2]/r]}function xp(t,e){e===void 0&&(e=document.body);for(var n=t,r=Wo();n;){var i=getComputedStyle(n).transform;if(r=Fo(er(i),r),n===e)break;n=n.parentElement}return r=rn(r,4),r[12]=0,r[13]=0,r[14]=0,r}function kr(t){var e=Wo();return t.forEach(function(n){var r=n.matrixFunction,i=n.functionValue;r&&(e=r(e,i))}),e}function Ar(t,e){e===void 0&&(e=0);var n=qt(t)?t:zn(t);return n.map(function(r){var i=po(r),a=i.prefix,o=i.value,s=null,l=a,c="";if(a==="translate"||a==="translateX"||a==="translate3d"){var u=Te(e)?gi(gi({},e),{"o%":e["%"]}):{"%":e,"o%":e},d=Nn(o).map(function(R,L){return L===0&&"x%"in u?u["%"]=e["x%"]:L===1&&"y%"in u?u["%"]=e["y%"]:u["%"]=e["o%"],It(R,u)}),f=d[0],h=d[1],v=h===void 0?0:h,p=d[2],g=p===void 0?0:p;s=Vo,c=[f,v,g]}else if(a==="translateY"){var m=Te(e)?gi({"%":e["y%"]},e):{"%":e},v=It(o,m);s=Vo,c=[0,v,0]}else if(a==="translateZ"){var g=parseFloat(o);s=Vo,c=[0,0,g]}else if(a==="scale"||a==="scale3d"){var x=Nn(o).map(function(R){return parseFloat(R)}),b=x[0],C=x[1],E=C===void 0?b:C,S=x[2],D=S===void 0?1:S;s=va,c=[b,E,D]}else if(a==="scaleX"){var b=parseFloat(o);s=va,c=[b,1,1]}else if(a==="scaleY"){var E=parseFloat(o);s=va,c=[1,E,1]}else if(a==="scaleZ"){var D=parseFloat(o);s=va,c=[1,1,D]}else if(a==="rotate"||a==="rotateZ"||a==="rotateX"||a==="rotateY"){var M=Zn(o),w=M.unit,T=M.value,k=w==="rad"?T:T*Math.PI/180;a==="rotate"||a==="rotateZ"?(l="rotateZ",s=mp):a==="rotateX"?s=pp:a==="rotateY"&&(s=gp),c=k}else if(a==="matrix3d")s=Fo,c=Nn(o).map(function(R){return parseFloat(R)});else if(a==="matrix"){var O=Nn(o).map(function(R){return parseFloat(R)});s=Fo,c=[O[0],O[1],0,0,O[2],O[3],0,0,0,0,1,0,O[4],O[5],0,1]}else l="";return{name:a,functionName:l,value:o,matrixFunction:s,functionValue:c}})}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Ho=function(t,e){return Ho=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Ho(t,e)};function yp(t,e){Ho(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Wc=typeof Map=="function"?void 0:function(){var t=0;return function(e){return e.__DIFF_KEY__||(e.__DIFF_KEY__=++t)}}(),bp=function(t){yp(e,t);function e(n){return n===void 0&&(n=[]),t.call(this,n,Wc)||this}return e}(Hv);function Rr(t,e){return ui(t,e,Wc)}const Hc=bp;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Yo=function(t,e){return Yo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Yo(t,e)};function Cp(t,e){Yo(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Or=function(){return Or=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Or.apply(this,arguments)};function Sp(t){var e=t.container;return e===document.body?[e.scrollLeft||document.documentElement.scrollLeft,e.scrollTop||document.documentElement.scrollTop]:[e.scrollLeft,e.scrollTop]}function Yc(t,e){return t.addEventListener("scroll",e),function(){t.removeEventListener("scroll",e)}}function ga(t){if(t){if(ye(t))return document.querySelector(t)}else return null;if(ta(t))return t();if(t instanceof Element)return t;if("current"in t)return t.current;if("value"in t)return t.value}var Ep=function(t){Cp(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r._startRect=null,r._startPos=[],r._prevTime=0,r._timer=0,r._prevScrollPos=[0,0],r._isWait=!1,r._flag=!1,r._currentOptions=null,r._lock=!1,r._unregister=null,r._onScroll=function(){var i=r._currentOptions;r._lock||!i||r.emit("scrollDrag",{next:function(a){r.checkScroll({container:i.container,inputEvent:a})}})},r}var n=e.prototype;return n.dragStart=function(r,i){var a=ga(i.container);if(!a){this._flag=!1;return}var o=0,s=0,l=0,c=0;if(a===document.body)l=window.innerWidth,c=window.innerHeight;else{var u=a.getBoundingClientRect();o=u.top,s=u.left,l=u.width,c=u.height}this._flag=!0,this._startPos=[r.clientX,r.clientY],this._startRect={top:o,left:s,width:l,height:c},this._prevScrollPos=this._getScrollPosition([0,0],i),this._currentOptions=i,this._registerScrollEvent(i)},n.drag=function(r,i){if(clearTimeout(this._timer),!!this._flag){var a=r.clientX,o=r.clientY,s=i.threshold,l=s===void 0?0:s,c=this,u=c._startRect,d=c._startPos;this._currentOptions=i;var f=[0,0];return u.top>o-l?(d[1]>u.top||o<d[1])&&(f[1]=-1):u.top+u.height<o+l&&(d[1]<u.top+u.height||o>d[1])&&(f[1]=1),u.left>a-l?(d[0]>u.left||a<d[0])&&(f[0]=-1):u.left+u.width<a+l&&(d[0]<u.left+u.width||a>d[0])&&(f[0]=1),!f[0]&&!f[1]?!1:this._continueDrag(Or(Or({},i),{direction:f,inputEvent:r,isDrag:!0}))}},n.checkScroll=function(r){var i=this;if(this._isWait)return!1;var a=r.prevScrollPos,o=a===void 0?this._prevScrollPos:a,s=r.direction,l=r.throttleTime,c=l===void 0?0:l,u=r.inputEvent,d=r.isDrag,f=this._getScrollPosition(s||[0,0],r),h=f[0]-o[0],v=f[1]-o[1],p=s||[h?Math.abs(h)/h:0,v?Math.abs(v)/v:0];return this._prevScrollPos=f,this._lock=!1,!h&&!v?!1:(this.emit("move",{offsetX:p[0]?h:0,offsetY:p[1]?v:0,inputEvent:u}),c&&d&&(clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},c)),!0)},n.dragEnd=function(){this._flag=!1,this._lock=!1,clearTimeout(this._timer),this._unregisterScrollEvent()},n._getScrollPosition=function(r,i){var a=i.container,o=i.getScrollPosition,s=o===void 0?Sp:o;return s({container:ga(a),direction:r})},n._continueDrag=function(r){var i=this,a,o=r.container,s=r.direction,l=r.throttleTime,c=r.useScroll,u=r.isDrag,d=r.inputEvent;if(!(!this._flag||u&&this._isWait)){var f=si(),h=Math.max(l+this._prevTime-f,0);if(h>0)return clearTimeout(this._timer),this._timer=window.setTimeout(function(){i._continueDrag(r)},h),!1;this._prevTime=f;var v=this._getScrollPosition(s,r);this._prevScrollPos=v,u&&(this._isWait=!0),c||(this._lock=!0);var p={container:ga(o),direction:s,inputEvent:d};return(a=r.requestScroll)===null||a===void 0||a.call(r,p),this.emit("scroll",p),this._isWait=!1,c||this.checkScroll(Or(Or({},r),{prevScrollPos:v,direction:s,inputEvent:d}))}},n._registerScrollEvent=function(r){this._unregisterScrollEvent();var i=r.checkScrollEvent;if(i){var a=i===!0?Yc:i,o=ga(r.container);i===!0&&(o===document.body||o===document.documentElement)?this._unregister=Yc(window,this._onScroll):this._unregister=a(o,this._onScroll)}},n._unregisterScrollEvent=function(){var r;(r=this._unregister)===null||r===void 0||r.call(this),this._unregister=null},e}(Qn);const Kc=Ep;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function nr(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function Ae(t){return Et(t,oe)}function wp(t,e){return t.every(function(n,r){return Ae(n-e[r])===0})}function Dp(t,e){return!Ae(t[0]-e[0])&&!Ae(t[1]-e[1])}function Mp(t){return t.reduce(function(e,n){return e.push.apply(e,n),e},[])}function mi(t){return t.length<3?0:Math.abs(tv(t.map(function(e,n){var r=t[n+1]||t[0];return e[0]*r[1]-r[0]*e[1]})))/2}function Ko(t,e){var n=e.width,r=e.height,i=e.left,a=e.top,o=rr(t),s=o.minX,l=o.minY,c=o.maxX,u=o.maxY,d=n/(c-s),f=r/(u-l);return t.map(function(h){return[i+(h[0]-s)*d,a+(h[1]-l)*f]})}function rr(t){var e=t.map(function(r){return r[0]}),n=t.map(function(r){return r[1]});return{minX:Math.min.apply(Math,e),minY:Math.min.apply(Math,n),maxX:Math.max.apply(Math,e),maxY:Math.max.apply(Math,n)}}function ma(t,e,n){var r=t[0],i=t[1],a=rr(e),o=a.minX,s=a.maxX,l=[[o,i],[s,i]],c=ir(l[0],l[1]),u=Uo(e),d=[];if(u.forEach(function(v){var p=ir(v[0],v[1]),g=v[0];if(wp(c,p))d.push({pos:t,line:v,type:"line"});else{var m=Xo(xa(c,p),[l,v]);m.forEach(function(x){v.some(function(b){return Dp(b,x)})?d.push({pos:x,line:v,type:"point"}):Ae(g[1]-i)!==0&&d.push({pos:x,line:v,type:"intersection"})})}}),!n&&ze(d,function(v){return v[0]===r}))return!0;var f=0,h={};return d.forEach(function(v){var p=v.pos,g=v.type,m=v.line;if(!(p[0]>r))if(g==="intersection")++f;else{if(g==="line")return;if(g==="point"){var x=ze(m,function(E){return E[1]!==i}),b=h[p[0]],C=x[1]>i?1:-1;b?b!==C&&++f:h[p[0]]=C}}}),f%2===1}function Tp(t,e){var n=t[0],r=t[1],i=t[2];return(n*e[0]+r*e[1]+i)/(n*n+r*r)}function ir(t,e){var n=t[0],r=t[1],i=e[0],a=e[1],o=i-n,s=a-r;Math.abs(o)<oe&&(o=0),Math.abs(s)<oe&&(s=0);var l=0,c=0,u=0;return o?s?(l=-s/o,c=1,u=-l*n-r):(c=1,u=-r):s&&(l=-1,u=n),[l,c,u]}function xa(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],s=e[2],l=n===0&&a===0,c=r===0&&o===0,u=[];if(l&&c)return[];if(l){var d=-i/r,f=-s/o;return d!==f?[]:[[-1/0,d],[1/0,d]]}else if(c){var h=-i/n,v=-s/a;return h!==v?[]:[[h,-1/0],[h,1/0]]}else if(n===0){var p=-i/r,g=-(o*p+s)/a;u=[[g,p]]}else if(a===0){var p=-s/o,g=-(r*p+i)/n;u=[[g,p]]}else if(r===0){var g=-i/n,p=-(a*g+s)/o;u=[[g,p]]}else if(o===0){var g=-s/a,p=-(n*g+i)/r;u=[[g,p]]}else{var g=(r*s-o*i)/(o*n-r*a),p=-(n*g+i)/r;u=[[g,p]]}return u.map(function(m){return[m[0],m[1]]})}function Xy(t,e,n){var r=xa(ir(t[0],t[1]),ir(e[0],e[1]));return n?Xo(r,[t,e]):r}function kp(t,e){var n=ir(e[0],e[1]);return Ae(Tp(n,t))===0}function Xo(t,e){var n=e.map(function(d){return[0,1].map(function(f){return[Math.min(d[0][f],d[1][f]),Math.max(d[0][f],d[1][f])]})}),r=[];if(t.length===2){var i=t[0],a=i[0],o=i[1];if(Ae(a-t[1][0])){if(!Ae(o-t[1][1])){var c=Math.max.apply(Math,n.map(function(d){return d[0][0]})),u=Math.min.apply(Math,n.map(function(d){return d[0][1]}));if(Ae(c-u)>0)return[];r=[[c,o],[u,o]]}}else{var s=Math.max.apply(Math,n.map(function(d){return d[1][0]})),l=Math.min.apply(Math,n.map(function(d){return d[1][1]}));if(Ae(s-l)>0)return[];r=[[a,s],[a,l]]}}return r.length||(r=t.filter(function(d){var f=d[0],h=d[1];return n.every(function(v){return 0<=Ae(f-v[0][0])&&0<=Ae(v[0][1]-f)&&0<=Ae(h-v[1][0])&&0<=Ae(v[1][1]-h)})})),r.map(function(d){return[Ae(d[0]),Ae(d[1])]})}function Uo(t){return nr(t.slice(1),[t[0]]).map(function(e,n){return[t[n],e]})}function Zo(t,e){var n=t.slice(),r=e.slice();Wl(n)===-1&&n.reverse(),Wl(r)===-1&&r.reverse();var i=Uo(n),a=Uo(r),o=i.map(function(u){return ir(u[0],u[1])}),s=a.map(function(u){return ir(u[0],u[1])}),l=[];o.forEach(function(u,d){var f=i[d],h=[];s.forEach(function(v,p){var g=xa(u,v),m=Xo(g,[f,a[p]]);h.push.apply(h,m.map(function(x){return{index1:d,index2:p,pos:x,type:"intersection"}}))}),h.sort(function(v,p){return vn(f[0],v.pos)-vn(f[0],p.pos)}),l.push.apply(l,h),ma(f[1],r)&&l.push({index1:d,index2:-1,pos:f[1],type:"inside"})}),a.forEach(function(u,d){if(ma(u[1],n)){var f=!1,h=Mn(l,function(v){var p=v.index2;return p===d?(f=!0,!1):!!f});h===-1&&(f=!1,h=Mn(l,function(v){var p=v.index1,g=v.index2;return p===-1&&g+1===d?(f=!0,!1):!!f})),h===-1?l.push({index1:-1,index2:d,pos:u[1],type:"inside"}):l.splice(h,0,{index1:-1,index2:d,pos:u[1],type:"inside"})}});var c={};return l.filter(function(u){var d=u.pos,f=d[0]+"x"+d[1];return c[f]?!1:(c[f]=!0,!0)})}function Qo(t,e){var n=Zo(t,e);return n.map(function(r){var i=r.pos;return i})}function Ap(t){var e=t[0],n=e.index1,r=e.index2,i=t[1],a=i.index1,o=i.index2;return n!==-1&&(n===a||n+1===a)||r!==-1&&(r===o||r+1===o)}function Rp(t,e){var n=Zo(t,e),r=[],i;return Zo(t,e).forEach(function(a,o,s){o===0||!Ap([s[o-1],a])?(i=[a],r.push(i)):i.push(a)}),r.map(function(a){return a.map(function(o){var s=o.pos;return s})})}function ya(t,e,n,r){n===void 0&&(n=0),r===void 0&&(r=[]);for(var i=r.length===0,a=t.length,o=t[n]?n:0,s=nr(t.slice(o),t.slice(0,o)),l=function(d){var f=s[d];if(find(e,function(m){return m[0]===f[0]&&m[1]===f[1]}))return"continue";if(r.some(function(m){return find(m,function(x){return x[0]===f[0]&&x[1]===f[1]})}))return i?"continue":"break";var h=void 0;i?(h=[],r.push(h)):h=r[r.length-1],h.push(f);var v=[f,t[n+1]||t[0]],p=e.filter(function(m){return kp(m,v)}).sort(function(m,x){return getDist(f,m)-getDist(f,x)})[0];if(p){var g=e.indexOf(p);if(ya(e,t,g,r),!i)return"break"}else return ya(s,e,d+1,r),"break"},c=0;c<a;++c){var u=l(c);if(u==="break")break}return r}function Uy(t,e){return ya(t,nr(e).reverse())}function Zy(t,e){if(!e.length)return[nr(t)];var n=Rp(t,e),r=[t];return n.forEach(function(i){var a=nr(i).reverse();r=Mp(r.map(function(o){var s=ya(o,a),l=s[0];if(s.length===1&&a.every(function(f){return l.indexOf(f)===-1})){var c=l[l.length-1],u=nr(a).sort(function(f,h){return getDist(c,f)-getDist(c,h)})[0],d=a.indexOf(u);l.push.apply(l,nr(a.slice(d),a.slice(0,d),[a[d],c]))}return s}))}),r}function Op(t,e){var n=Qo(t,e);return mi(n)}var qo=function(t,e){return qo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},qo(t,e)};function Lp(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");qo(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Jo=function(){return Jo=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Jo.apply(this,arguments)};function _p(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}var Ip=null;function Qy(t,e){var n=cssStyled(e);return function(r){Lp(i,r);function i(){var a=r!==null&&r.apply(this,arguments)||this;return a.injector=n,a.tag=t,a}return i}(Ip)}function Xc(t,e){var n=wo(e),r=n.className;return Xv(function(i,a){var o=i.className,s=o===void 0?"":o,l=i.cspNonce,c=_p(i,["className","cspNonce"]),u=sp();return lp(a,function(){return u.current},[]),jo(function(){var d=n.inject(u.current,{nonce:i.cspNonce});return function(){d.destroy()}},[]),Ke(t,Jo({ref:u,"data-styled-id":r,className:"".concat(s," ").concat(r)},c))})}const qy=null;var ts=function(t,e){return ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},ts(t,e)};function Lr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ts(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var _=function(){return _=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_.apply(this,arguments)};function Pp(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function zp(t,e,n,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function Np(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function J(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function xi(t,e){return _({events:[],props:[],name:t},e)}var Bp=["n","w","s","e"],es=["n","w","s","e","nw","ne","sw","se"];function jp(t,e){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(e,'deg);transform-origin: 16px 16px"></path></svg>')}function Vp(t){var e=jp(1,t),n=Math.round(t/45)*45%180,r="ns-resize";return n===135?r="nwse-resize":n===45?r="nesw-resize":n===90&&(r="ew-resize"),"cursor:".concat(r,";cursor: url('").concat(e,"') 16 16, ").concat(r,";")}var _r=uc(),Uc=_r.browser.webkit,Zc=Uc&&function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,e=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return e?parseFloat(e[1])<605:!1}(),Qc=_r.browser.name,qc=parseInt(_r.browser.version,10),Fp=Qc==="chrome",Gp=_r.browser.chromium,$p=parseInt(_r.browser.chromiumVersion,10)||0,Wp=Fp&&qc>=109||Gp&&$p>=109,Hp=Qc==="firefox",Yp=parseInt(_r.browser.webkitVersion,10)>=612||qc>=15,ns="moveable-",Kp=es.map(function(t){var e="",n="",r="center",i="center",a="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(e="top: ".concat(a,";"),i="bottom"),t.indexOf("s")>-1&&(e="top: 0px;",i="top"),t.indexOf("w")>-1&&(n="left: ".concat(a,";"),r="right"),t.indexOf("e")>-1&&(n="left: 0px;",r="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(n).concat(e,`
        transform-origin: `).concat(r," ").concat(i,`;
    }`)}).join(`
`),Xp=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(Kp,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(Vp(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(Zc?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),Up=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],rs=1e-4,Re=1e-7,ba=1e-9,is=Math.pow(10,10),Jc=-is,Zp={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},as={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},tu={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},eu=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function yi(t,e,n,r,i,a){var o,s;a===void 0&&(a="draggable");var l=(s=(o=e.gestos[a])===null||o===void 0?void 0:o.move(n,t.inputEvent))!==null&&s!==void 0?s:{},c=l.originalDatas||l.datas,u=c[a]||(c[a]={});return _(_({},i?sd(e,l):l),{isPinch:!!r,parentEvent:!0,datas:u,originalDatas:t.originalDatas})}var Ir=function(){function t(e){var n;e===void 0&&(e="draggable"),this.ableName=e,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(n={},n[e]={},n)}return t.prototype.dragStart=function(e,n){this.isDrag=!1,this.isFlag=!1;var r=n.originalDatas;return this.datas=r,r[this.ableName]||(r[this.ableName]={}),_(_({},this.move(e,n.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(e,n){return this.move([e[0]-this.prevX,e[1]-this.prevY],n)},t.prototype.move=function(e,n){var r,i,a=!1;if(!this.isFlag)this.prevX=e[0],this.prevY=e[1],this.startX=e[0],this.startY=e[1],r=e[0],i=e[1],this.isFlag=!0;else{var o=this.isDrag;r=this.prevX+e[0],i=this.prevY+e[1],(e[0]||e[1])&&(this.isDrag=!0),!o&&this.isDrag&&(a=!0)}return this.prevX=r,this.prevY=i,{type:"drag",clientX:r,clientY:i,inputEvent:n,isFirstDrag:a,isDrag:this.isDrag,distX:r-this.startX,distY:i-this.startY,deltaX:e[0],deltaY:e[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function Pr(t,e,n,r){var i=t.length===16,a=i?4:3,o=lr(t,n,r,a),s=I(o,4),l=I(s[0],2),c=l[0],u=l[1],d=I(s[1],2),f=d[0],h=d[1],v=I(s[2],2),p=v[0],g=v[1],m=I(s[3],2),x=m[0],b=m[1],C=I(ae(t,e,a),2),E=C[0],S=C[1],D=Math.min(c,f,p,x),M=Math.min(u,h,g,b),w=Math.max(c,f,p,x),T=Math.max(u,h,g,b);c=c-D||0,f=f-D||0,p=p-D||0,x=x-D||0,u=u-M||0,h=h-M||0,g=g-M||0,b=b-M||0,E=E-D||0,S=S-M||0;var k=t[0],O=t[a+1],R=_e(k*O);return{left:D,top:M,right:w,bottom:T,origin:[E,S],pos1:[c,u],pos2:[f,h],pos3:[p,g],pos4:[x,b],direction:R}}function nu(t,e){var n=e.clientX,r=e.clientY,i=e.datas,a=t.state,o=a.moveableClientRect,s=a.rootMatrix,l=a.is3d,c=a.pos1,u=o.left,d=o.top,f=l?4:3,h=I(pt($r(s,[n-u,r-d],f),c),2),v=h[0],p=h[1],g=I(mn({datas:i,distX:v,distY:p}),2),m=g[0],x=g[1];return[m,x]}function ar(t,e){var n=e.datas,r=t.state,i=r.allMatrix,a=r.beforeMatrix,o=r.is3d,s=r.left,l=r.top,c=r.origin,u=r.offsetMatrix,d=r.targetMatrix,f=r.transformOrigin,h=o?4:3;n.is3d=o,n.matrix=i,n.targetMatrix=d,n.beforeMatrix=a,n.offsetMatrix=u,n.transformOrigin=f,n.inverseMatrix=rn(i,h),n.inverseBeforeMatrix=rn(a,h),n.absoluteOrigin=Jn(Ft([s,l],c),h),n.startDragBeforeDist=we(n.inverseBeforeMatrix,n.absoluteOrigin,h),n.startDragDist=we(n.inverseMatrix,n.absoluteOrigin,h)}function Qp(t){return Pr(t.datas.beforeTransform,[50,50],100,100).direction}function Ca(t,e,n){var r=e.datas,i=e.originalDatas.beforeRenderable,a=r.transformIndex,o=i.nextTransforms,s=o.length,l=i.nextTransformAppendedIndexes,c=-1;a===-1?(n==="translate"?c=0:n==="rotate"&&(c=Mn(o,function(h){return h.match(/scale\(/g)})),c===-1&&(c=o.length),r.transformIndex=c):ze(l,function(h){return h.index===a&&h.functionName===n})?c=a:c=a+l.filter(function(h){return h.index<a}).length;var u=S0(o,t.state,c),d=u.targetFunction,f=n==="rotate"?"rotateZ":n;r.beforeFunctionTexts=u.beforeFunctionTexts,r.afterFunctionTexts=u.afterFunctionTexts,r.beforeTransform=u.beforeFunctionMatrix,r.beforeTransform2=u.beforeFunctionMatrix2,r.targetTansform=u.targetFunctionMatrix,r.afterTransform=u.afterFunctionMatrix,r.afterTransform2=u.afterFunctionMatrix2,r.targetAllTransform=u.allFunctionMatrix,d.functionName===f?(r.afterFunctionTexts.splice(0,1),r.isAppendTransform=!1):s>c&&(r.isAppendTransform=!0,i.nextTransformAppendedIndexes=J(J([],I(l),!1),[{functionName:n,index:c,isAppend:!0}],!1))}function Sa(t,e,n){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?n:e," ").concat(t.afterFunctionTexts.join(" "))}function qp(t){var e=t.datas,n=t.distX,r=t.distY,i=I(iu({datas:e,distX:n,distY:r}),2),a=i[0],o=i[1],s=ru(e,hp([a,o],4));return we(s,Jn([0,0,0],4),4)}function ru(t,e,n){var r=t.beforeTransform,i=t.afterTransform,a=t.beforeTransform2,o=t.afterTransform2,s=t.targetAllTransform,l=n?Qt(s,e,4):Qt(e,s,4),c=Qt(rn(n?a:r,4),l,4),u=Qt(c,rn(n?o:i,4),4);return u}function iu(t){var e=t.datas,n=t.distX,r=t.distY,i=e.inverseBeforeMatrix,a=e.is3d,o=e.startDragBeforeDist,s=e.absoluteOrigin,l=a?4:3;return pt(we(i,Ft(s,[n,r]),l),o)}function mn(t,e){var n=t.datas,r=t.distX,i=t.distY,a=n.inverseBeforeMatrix,o=n.inverseMatrix,s=n.is3d,l=n.startDragBeforeDist,c=n.startDragDist,u=n.absoluteOrigin,d=s?4:3;return pt(we(e?a:o,Ft(u,[r,i]),d),e?l:c)}function Jp(t,e){var n=t.datas,r=t.distX,i=t.distY,a=n.beforeMatrix,o=n.matrix,s=n.is3d,l=n.startDragBeforeDist,c=n.startDragDist,u=n.absoluteOrigin,d=s?4:3;return pt(we(e?a:o,Ft(e?l:c,[r,i]),d),u)}function tg(t,e,n,r,i,a){return r===void 0&&(r=e),i===void 0&&(i=n),a===void 0&&(a=[0,0]),t?t.map(function(o,s){var l=Zn(o),c=l.value,u=l.unit,d=s?i:r,f=s?n:e;if(o==="%"||isNaN(c)){var h=d?a[s]/d:0;return f*h}else if(u!=="%")return c;return f*c/100}):a}function au(t){var e=[];return t[1]>=0&&(t[0]>=0&&e.push(3),t[0]<=0&&e.push(2)),t[1]<=0&&(t[0]>=0&&e.push(1),t[0]<=0&&e.push(0)),e}function eg(t,e){return au(e).map(function(n){return t[n]})}function os(t,e){var n=(e+1)/2;return[qi(t[0][0],t[1][0],n,1-n),qi(t[0][1],t[1][1],n,1-n)]}function he(t,e){var n=os([t[0],t[1]],e[0]),r=os([t[2],t[3]],e[0]);return os([n,r],e[1])}function ng(t,e,n,r,i,a){var o=lr(e,n,r,i),s=he(o,a),l=t[0]-s[0],c=t[1]-s[1];return[l,c]}function bi(t,e,n,r){return Qt(t,wi(e,r,n),r)}function rg(t,e,n,r){var i=t.transformOrigin,a=t.offsetMatrix,o=t.is3d,s=o?4:3,l;if(ye(n)){var c=e.beforeTransform,u=e.afterTransform;r?l=an(er(n),4,s):l=an(Qt(Qt(c,er([n]),4),u,4),4,s)}else l=n;return bi(a,l,i,s)}function ig(t,e){var n=t.transformOrigin,r=t.offsetMatrix,i=t.is3d,a=t.targetMatrix,o=t.targetAllTransform,s=i?4:3;return bi(r,Qt(o||a,Go(e,s),s),n,s)}function Ea(t,e){var n=zr(e);return{setTransform:function(r,i){i===void 0&&(i=-1),n.startTransforms=qt(r)?r:zn(r),ss(t,e,i)},setTransformIndex:function(r){ss(t,e,r)}}}function wa(t,e,n){var r=zr(e),i=r.startTransforms;ss(t,e,Mn(i,function(a){return a.indexOf("".concat(n,"("))===0}))}function ss(t,e,n){var r=zr(e),i=e.datas;if(i.transformIndex=n,n!==-1){var a=r.startTransforms[n];if(a){var o=t.state,s=Ar([a],{"x%":function(l){return l/100*o.offsetWidth},"y%":function(l){return l/100*o.offsetHeight}});i.startValue=s[0].functionValue}}}function ls(t,e){var n=zr(t);n.nextTransforms=zn(e)}function zr(t){return t.originalDatas.beforeRenderable}function Da(t){var e=t.originalDatas.beforeRenderable;return e.nextTransforms}function Ma(t){return(Da(t)||[]).join(" ")}function Ta(t){return zr(t).nextStyle}function ou(t,e,n,r,i){ls(i,e);var a=Oe.drag(t,yi(i,t.state,n,r,!1)),o=a?a.transform:e;return _(_({transform:e,drag:a},Le({transform:o},i)),{afterTransform:o})}function cs(t,e,n,r,i,a){var o=rg(t.state,i,e,a),s=sg(t,n,r,o);return s}function su(t,e,n,r,i,a,o){var s=cs(t,e,n,i,a,o),l=t.state,c=l.left,u=l.top,d=t.props.groupable,f=d?c:0,h=d?u:0,v=pt(r,s);return pt(v,[f,h])}function ag(t,e,n,r,i,a,o){var s=su(t,e,n,r,i,a,o);return s}function og(t,e,n){return[e?-1+t[0]/(e/2):0,n?-1+t[1]/(n/2):0]}function sg(t,e,n,r){r===void 0&&(r=t.state.allMatrix);var i=t.state,a=i.width,o=i.height,s=i.is3d,l=s?4:3,c=[a/2*(1+e[0])+n[0],o/2*(1+e[1])+n[1]];return ae(r,c,l)}function lg(t,e,n){var r=n.fixedDirection,i=n.fixedPosition,a=n.fixedOffset;return su(t,"rotate(".concat(e,"deg)"),r,i,a,n)}function cg(t,e,n,r,i,a){var o=t.props.groupable,s=t.state,l=s.transformOrigin,c=s.offsetMatrix,u=s.is3d,d=s.width,f=s.height,h=s.left,v=s.top,p=a.fixedDirection,g=a.nextTargetMatrix||s.targetMatrix,m=u?4:3,x=tg(i,e,n,d,f,l),b=o?h:0,C=o?v:0,E=bi(c,g,x,m),S=ng(r,E,e,n,m,p);return pt(S,[b,C])}function ug(t,e){return he(Ze(t.state),e)}function dg(t,e){var n=t.targetGesto,r=t.controlGesto,i;return n?.isFlag()&&(i=n.getEventData()[e]),!i&&r?.isFlag()&&(i=r.getEventData()[e]),i||{}}function fg(t){if(t&&t.getRootNode){var e=t.getRootNode();if(e.nodeType===11)return e}}function hg(t){var e=t("scale"),n=t("rotate"),r=t("translate"),i=[];return r&&r!=="0px"&&r!=="none"&&i.push("translate(".concat(r.split(/\s+/).join(","),")")),n&&n!=="1"&&n!=="none"&&i.push("rotate(".concat(n,")")),e&&e!=="1"&&e!=="none"&&i.push("scale(".concat(e.split(/\s+/).join(","),")")),i}function lu(t,e,n){for(var r=t,i=[],a=xo(t)||Bn(t),o=!n&&t===e||t===a,s=o,l=!1,c=3,u,d,f,h=!1,v=Di(e,e,!0).offsetParent,p=1;r&&!s;){s=o;var g=Ne(r),m=g("position"),x=Xu(r),b=m==="fixed",C=hg(g),E=vp(u0(x)),S=void 0,D=!1,M=!1,w=0,T=0,k=0,O=0,R={hasTransform:!1,fixedContainer:null};b&&(h=!0,R=p0(r),v=R.fixedContainer);var L=E.length;!l&&(L===16||C.length)&&(l=!0,c=4,Ms(i),f&&(f=an(f,3,4))),l&&L===9&&(E=an(E,3,4));var P=v0(r,t),z=P.tagName,V=P.hasOffset,N=P.isSVG,G=P.origin,W=P.targetOrigin,B=P.offset,q=I(B,2),Z=q[0],K=q[1];z==="svg"&&!r.ownerSVGElement&&f&&(i.push({type:"target",target:r,matrix:g0(r,c)}),i.push({type:"offset",target:r,matrix:ee(c)}));var X=parseFloat(g("zoom"))||1;if(b)S=R.fixedContainer,D=!0;else{var H=Di(r,e,!1,!0,g),et=H.offsetZoom;if(S=H.offsetParent,D=H.isEnd,M=H.isStatic,p*=et,(H.isCustomElement||et!==1)&&M)Z-=S.offsetLeft,K-=S.offsetTop;else if(Hp||Wp){var rt=H.parentSlotElement;if(rt){for(var mt=S,vt=0,U=0;mt&&fg(mt);)vt+=mt.offsetLeft,U+=mt.offsetTop,mt=mt.offsetParent;Z-=vt,K-=U}}}if(Uc&&!Yp&&V&&!N&&M&&(m==="relative"||m==="static")&&(Z-=S.offsetLeft,K-=S.offsetTop,o=o||D),b)V&&R.hasTransform&&(k=S.clientLeft,O=S.clientTop);else if(V&&v!==S&&(w=S.clientLeft,T=S.clientTop),V&&S===a){var nt=Uu(r,!1);Z+=nt[0],K+=nt[1]}if(i.push({type:"target",target:r,matrix:wi(E,c,G)}),C.length&&(i.push({type:"offset",target:r,matrix:ee(c)}),i.push({type:"target",target:r,matrix:wi(er(C),c,G)})),V){var Rt=r===t,ut=Rt?0:r.scrollLeft,dt=Rt?0:r.scrollTop;i.push({type:"offset",target:r,matrix:tr([Z-ut+w-k,K-dt+T-O],c)})}else i.push({type:"offset",target:r,origin:G});if(X!==1&&i.push({type:"zoom",target:r,matrix:wi(Go([X,X],c),c,[0,0])}),f||(f=E),u||(u=G),d||(d=W),s||b)break;r=S,o=D,(!n||r===a)&&(s=o)}return f||(f=ee(c)),u||(u=[0,0]),d||(d=[0,0]),{zoom:p,offsetContainer:v,matrixes:i,targetMatrix:f,transformOrigin:u,targetOrigin:d,is3d:l,hasFixed:h}}var or=null,sr=null,Nr=null;function Br(t){t?(window.Map&&(or=new Map,sr=new Map),Nr=[]):(or=null,Nr=null,sr=null)}function vg(t){var e=sr?.get(t);if(e)return e;var n=Ti(t,!0);return sr&&sr.set(t,n),n}function pg(t,e){if(Nr){var n=ze(Nr,function(i){return i[0][0]==t&&i[0][1]==e});if(n)return n[1]}var r=lu(t,e,!0);return Nr&&Nr.push([[t,e],r]),r}function Ne(t){var e=or?.get(t);if(!e){var n=Ee(t).getComputedStyle(t);if(!or)return function(a){return n[a]};e={style:n,cached:{}},or.set(t,e)}var r=e.cached,i=e.style;return function(a){return a in r||(r[a]=i[a]),r[a]}}function on(t,e,n){var r=n.originalDatas;r.groupable=r.groupable||{};var i=r.groupable;i.childDatas=i.childDatas||[];var a=i.childDatas;return t.moveables.map(function(o,s){return a[s]=a[s]||{},a[s][e]=a[s][e]||{},_(_({},n),{isRequestChild:!0,datas:a[s][e],originalDatas:a[s]})})}function us(t,e,n,r,i,a,o){var s=!!n.match(/Start$/g),l=!!n.match(/End$/g),c=i.isPinch,u=i.datas,d=on(t,e.name,i),f=t.moveables,h=[],v=d.map(function(p,g){var m=f[g],x=m.state,b=x.gestos,C=p;if(s)C=new Ir(o).dragStart(r,p),h.push(C);else{if(b[o]||(b[o]=u.childGestos[g]),!b[o])return;C=yi(p,x,r,c,a,o),h.push(C)}var E=e[n](m,_(_({},C),{parentFlag:!0}));return l&&(b[o]=null),E});return s&&(u.childGestos=f.map(function(p){return p.state.gestos[o]})),{eventParams:v,childEvents:h}}function An(t,e,n,r,i,a){i===void 0&&(i=function(u,d){return d});var o=!!n.match(/End$/g),s=on(t,e.name,r),l=t.moveables,c=s.map(function(u,d){var f=l[d],h=u;h=i(f,u);var v=e[n](f,_(_({},h),{parentFlag:!0}));return v&&a&&a(f,u,v,d),o&&(f.state.gestos={}),v});return c}function ka(t,e,n,r){var i=n.fixedDirection,a=n.fixedPosition,o=r.datas.startPositions||Ze(e.state),s=he(o,i),l=I(we(pi(-t.rotation/180*Math.PI,3),[s[0]-a[0],s[1]-a[1],1],3),2),c=l[0],u=l[1];return r.datas.originalX=c,r.datas.originalY=u,r}function cu(t,e,n,r){var i=t.getState(),a=i.renderPoses,o=i.rotation,s=i.direction,l=cr(t.props,e).zoom,c=Ei(o/Math.PI*180),u={},d=t.renderState;d.renderDirectionMap||(d.renderDirectionMap={});var f=d.renderDirectionMap;n.forEach(function(v){var p=v.dir;u[p]=!0});var h=_e(s);return n.map(function(v){var p=v.data,g=v.classNames,m=v.dir,x=as[m];if(!x||!u[m])return null;f[m]=!0;var b=(Et(c,15)+h*tu[m]+720)%180,C={};return hn(p).forEach(function(E){C["data-".concat(E)]=p[E]}),r.createElement("div",_({className:ht.apply(void 0,J(["control","direction",m,e],I(g),!1)),"data-rotation":b,"data-direction":m},C,{key:"direction-".concat(m),style:Ba.apply(void 0,J([o,l],I(x.map(function(E){return a[E]})),!1))}))})}function uu(t,e,n,r){var i=cr(t.props,n),a=i.renderDirections,o=a===void 0?e:a,s=i.displayAroundControls;if(!o)return[];var l=o===!0?es:o;return J(J([],I(s?vu(t,r,n,l):[]),!1),I(cu(t,n,l.map(function(c){return{data:{},classNames:[],dir:c}}),r)),!1)}function Ci(t,e,n,r,i,a){for(var o=[],s=6;s<arguments.length;s++)o[s-6]=arguments[s];var l=se(n,r),c=e?Et(l/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(a),className:ht.apply(void 0,J(["line","direction",e?"edge":"",e],I(o),!1)),"data-rotation":c,"data-line-key":a,"data-direction":e,style:Mi(n,r,i,l)})}function du(t,e,n,r,i){var a=n===!0?Bp:n;return a.map(function(o,s){var l=I(as[o],2),c=l[0],u=l[1];if(u!=null)return Ci(t,o,r[c],r[u],i,"".concat(e,"Edge").concat(s),e)}).filter(Boolean)}function fu(t){return function(e,n){var r=cr(e.props,t).edge;return r&&(r===!0||r.length)?J(J([],I(du(n,t,r,e.getState().renderPoses,e.props.zoom)),!1),I(gg(e,t,n)),!1):hu(e,t,n)}}function hu(t,e,n){return uu(t,es,e,n)}function gg(t,e,n){return uu(t,["nw","ne","sw","se"],e,n)}function vu(t,e,n,r){var i=t.renderState;i.renderDirectionMap||(i.renderDirectionMap={});var a=t.getState(),o=a.renderPoses,s=a.rotation,l=a.direction,c=i.renderDirectionMap,u=t.props.zoom,d=_e(l),f=s/Math.PI*180;return(r||hn(c)).map(function(h){var v=as[h];if(!v)return null;var p=(Et(f,15)+d*tu[h]+720)%180,g=["around-control"];return n&&g.push("direction",n),e.createElement("div",{className:ht.apply(void 0,J([],I(g),!1)),"data-rotation":p,"data-direction":h,key:"direction-around-".concat(h),style:Ba.apply(void 0,J([s,u],I(v.map(function(m){return o[m]})),!1))})})}function ds(t,e,n){var r=t||{},i=r.position,a=i===void 0?"client":i,o=r.left,s=o===void 0?-1/0:o,l=r.top,c=l===void 0?-1/0:l,u=r.right,d=u===void 0?1/0:u,f=r.bottom,h=f===void 0?1/0:f,v={position:a,left:s,top:c,right:d,bottom:h};return{vertical:pu(v,e,!0),horizontal:pu(v,n,!1)}}function Aa(t,e){var n=t.state,r=n.containerClientRect,i=r.clientHeight,a=r.clientWidth,o=r.clientLeft,s=r.clientTop,l=n.snapOffset,c=l.left,u=l.top,d=l.right,f=l.bottom,h=e||t.props.bounds||{},v=h.position||"client",p=v==="css",g=h.left,m=g===void 0?-1/0:g,x=h.top,b=x===void 0?-1/0:x,C=h.right,E=C===void 0?p?-1/0:1/0:C,S=h.bottom,D=S===void 0?p?-1/0:1/0:S;return p&&(E=a+d-c-E,D=i+f-u-D),{left:m+c-o,right:E+c-o,top:b+u-s,bottom:D+u-s}}function mg(t,e,n){var r=Aa(t),i=r.left,a=r.top,o=r.right,s=r.bottom,l=I(n,2),c=l[0],u=l[1],d=I(pt(n,e),2),f=d[0],h=d[1];Y(f)<Re&&(f=0),Y(h)<Re&&(h=0);var v=h>0,p=f>0,g={isBound:!1,offset:0,pos:0},m={isBound:!1,offset:0,pos:0};if(f===0&&h===0)return{vertical:g,horizontal:m};if(f===0)v?s<u&&(m.pos=s,m.offset=u-s):a>u&&(m.pos=a,m.offset=u-a);else if(h===0)p?o<c&&(g.pos=o,g.offset=c-o):i>c&&(g.pos=i,g.offset=c-i);else{var x=h/f,b=n[1]-x*c,C=0,E=0,S=!1;p&&o<=c?(C=x*o+b,E=o,S=!0):!p&&c<=i&&(C=x*i+b,E=i,S=!0),S&&(C<a||C>s)&&(S=!1),S||(v&&s<=u?(C=s,E=(C-b)/x,S=!0):!v&&u<=a&&(C=a,E=(C-b)/x,S=!0)),S&&(g.isBound=!0,g.pos=E,g.offset=c-E,m.isBound=!0,m.pos=C,m.offset=u-C)}return{vertical:g,horizontal:m}}function pu(t,e,n){var r=t[n?"left":"top"],i=t[n?"right":"bottom"],a=Math.min.apply(Math,J([],I(e),!1)),o=Math.max.apply(Math,J([],I(e),!1)),s=[];return r+1>a&&s.push({direction:"start",isBound:!0,offset:a-r,pos:r}),i-1<o&&s.push({direction:"end",isBound:!0,offset:o-i,pos:i}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort(function(l,c){return Y(c.offset)-Y(l.offset)})}function gu(t,e,n){var r=n?t.map(function(i){return vi(i,n)}):t;return r.some(function(i){return i[0]<e.left&&Y(i[0]-e.left)>.1||i[0]>e.right&&Y(i[0]-e.right)>.1||i[1]<e.top&&Y(i[1]-e.top)>.1||i[1]>e.bottom&&Y(i[1]-e.bottom)>.1})}function xg(t,e,n){var r=Ue(t),i=Math.sqrt(r*r-e*e)||0;return[i,-i].sort(function(a,o){return Y(a-t[n?0:1])-Y(o-t[n?0:1])}).map(function(a){return se([0,0],n?[a,e]:[e,a])})}function yg(t,e,n,r,i){if(!t.props.bounds)return[];var a=i*Math.PI/180,o=Aa(t),s=o.left,l=o.top,c=o.right,u=o.bottom,d=s-r[0],f=c-r[0],h=l-r[1],v=u-r[1],p={left:d,top:h,right:f,bottom:v};if(!gu(n,p,0))return[];var g=[];return[[d,0],[f,0],[h,1],[v,1]].forEach(function(m){var x=I(m,2),b=x[0],C=x[1];n.forEach(function(E){var S=se([0,0],E);g.push.apply(g,J([],I(xg(E,b,C).map(function(D){return a+D-S}).filter(function(D){return!gu(e,p,D)}).map(function(D){return Et(D*180/Math.PI,Re)})),!1))})}),g}var bg=["left","right","center"],Cg=["top","bottom","middle"],mu={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},jn={start:"left",end:"right",center:"center"},Vn={start:"top",end:"bottom",center:"middle"};function jr(){return{left:!1,top:!1,right:!1,bottom:!1}}function Vr(t,e){var n=t.props,r=n.snappable,i=n.bounds,a=n.innerBounds,o=n.verticalGuidelines,s=n.horizontalGuidelines,l=n.snapGridWidth,c=n.snapGridHeight,u=t.state,d=u.guidelines,f=u.enableSnap;return!r||!f||e&&r!==!0&&r.indexOf(e)<0?!1:!!(l||c||i||a||d&&d.length||o&&o.length||s&&s.length)}function fs(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function Sg(t,e){var n=fs(t),r={};for(var i in n)i in e&&n[i]&&(r[i]=e[i]);return r}function hs(t,e){var n=Sg(t,e),r=Cg.filter(function(a){return a in n}),i=bg.filter(function(a){return a in n});return{horizontalNames:r,verticalNames:i,horizontal:r.map(function(a){return n[a]}),vertical:i.map(function(a){return n[a]})}}function Eg(t,e,n){var r=ae(t,[e.clientLeft,e.clientTop],n);return[e.left+r[0],e.top+r[1]]}function wg(t){var e=I(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];Math.abs(i)<oe&&(i=0),Math.abs(a)<oe&&(a=0);var o=0,s=0,l=0;return i?a?(o=-a/i,s=1,l=o*n[0]-n[1]):(s=1,l=-n[1]):(o=-1,l=n[0]),[o,s,l].map(function(c){return Et(c,oe)})}var xu="snapRotationThreshold",yu="snapRotationDegrees",bu="snapHorizontalThreshold",Cu="snapVerticalThreshold";function Ra(t,e,n,r,i,a,o){var s;r===void 0&&(r=[]),i===void 0&&(i=[]);var l=t.props,c=((s=t.state.snapThresholdInfo)===null||s===void 0?void 0:s.multiples)||[1,1],u=id(o,l[bu],5),d=id(a,l[Cu],5);return Su(t.state.guidelines,e,n,r,i,u,d,c)}function Su(t,e,n,r,i,a,o,s){return{vertical:wu(t,"vertical",e,o*s[0],r),horizontal:wu(t,"horizontal",n,a*s[1],i)}}function Dg(t,e,n){var r=I(n,2),i=r[0],a=r[1],o=I(e,2),s=o[0],l=o[1],c=I(pt(n,e),2),u=c[0],d=c[1],f=d>0,h=u>0;u=Ga(u),d=Ga(d);var v={isSnap:!1,offset:0,pos:0},p={isSnap:!1,offset:0,pos:0};if(u===0&&d===0)return{vertical:v,horizontal:p};var g=Ra(t,u?[i]:[],d?[a]:[],[],[],void 0,void 0),m=g.vertical,x=g.horizontal;m.posInfos.filter(function(z){var V=z.pos;return h?V>=s:V<=s}),x.posInfos.filter(function(z){var V=z.pos;return f?V>=l:V<=l}),m.isSnap=m.posInfos.length>0,x.isSnap=x.posInfos.length>0;var b=vs(m),C=b.isSnap,E=b.guideline,S=vs(x),D=S.isSnap,M=S.guideline,w=D?M.pos[1]:0,T=C?E.pos[0]:0;if(u===0)D&&(p.isSnap=!0,p.pos=M.pos[1],p.offset=a-p.pos);else if(d===0)C&&(v.isSnap=!0,v.pos=T,v.offset=i-T);else{var k=d/u,O=n[1]-k*i,R=0,L=0,P=!1;C?(L=T,R=k*L+O,P=!0):D&&(R=w,L=(R-O)/k,P=!0),P&&(v.isSnap=!0,v.pos=L,v.offset=i-L,p.isSnap=!0,p.pos=R,p.offset=a-R)}return{vertical:v,horizontal:p}}function Fn(t){var e="";return t===-1||t==="top"||t==="left"?e="start":t===0||t==="center"||t==="middle"?e="center":(t===1||t==="right"||t==="bottom")&&(e="end"),e}function Eu(t,e,n,r){var i=hs(t.props.snapDirections,e),a=Ra(t,i.vertical,i.horizontal,i.verticalNames.map(function(l){return Fn(l)}),i.horizontalNames.map(function(l){return Fn(l)}),n,r),o=Fn(i.horizontalNames[a.horizontal.index]),s=Fn(i.verticalNames[a.vertical.index]);return{vertical:_(_({},a.vertical),{direction:s}),horizontal:_(_({},a.horizontal),{direction:o})}}function vs(t){var e=t.isSnap;if(!e)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var n=t.posInfos[0],r=n.guidelineInfos[0],i=r.offset,a=r.dist,o=r.guideline;return{isSnap:e,offset:i,dist:a,pos:n.pos,guideline:o}}function wu(t,e,n,r,i){var a,o;if(i===void 0&&(i=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var s=e==="vertical",l=s?0:1,c=n.map(function(d,f){var h=i[f]||"",v=t.map(function(p){var g=p.pos,m=d-g[l];return{offset:m,dist:Y(m),guideline:p,direction:h}}).filter(function(p){var g=p.guideline,m=p.dist,x=g.type;return!(x!==e||m>r)}).sort(function(p,g){return p.dist-g.dist});return{pos:d,index:f,guidelineInfos:v,direction:h}}).filter(function(d){return d.guidelineInfos.length>0}).sort(function(d,f){return d.guidelineInfos[0].dist-f.guidelineInfos[0].dist}),u=c.length>0;return{isSnap:u,index:u?c[0].index:-1,direction:(o=(a=c[0])===null||a===void 0?void 0:a.direction)!==null&&o!==void 0?o:"",posInfos:c}}function Mg(t,e,n,r,i){var a=[];n[0]&&n[1]?a=[n,[-n[0],n[1]],[n[0],-n[1]]]:!n[0]&&!n[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(f,h,v){var p=v[h+1]||v[0];a.push(f),a.push([(f[0]+p[0])/2,(f[1]+p[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],n):(a.push.apply(a,J([],I(eg([[-1,-1],[1,-1],[-1,-1],[1,1]],n)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var o=a.map(function(f){return he(e,f)}),s=o.map(function(f){return f[0]}),l=o.map(function(f){return f[1]}),c=Ra(t,s,l,a.map(function(f){return Fn(f[0])}),a.map(function(f){return Fn(f[1])}),r,i),u=Fn(a.map(function(f){return f[0]})[c.vertical.index]),d=Fn(a.map(function(f){return f[1]})[c.horizontal.index]);return{vertical:_(_({},c.vertical),{direction:u}),horizontal:_(_({},c.horizontal),{direction:d})}}function Du(t,e){var n=Y(t.offset),r=Y(e.offset);return t.isBound&&e.isBound?r-n:t.isBound?-1:e.isBound?1:t.isSnap&&e.isSnap?r-n:t.isSnap?-1:e.isSnap||n<Re?1:r<Re?-1:n-r}function Oa(t,e){return t.slice().sort(function(n,r){var i=n.sign[e],a=r.sign[e],o=n.offset[e],s=r.offset[e];if(i){if(!a)return-1}else return 1;return Du({isBound:n.isBound,isSnap:n.isSnap,offset:o},{isBound:r.isBound,isSnap:r.isSnap,offset:s})})[0]}function Tg(t,e,n){var r=[];if(n)Y(e[0])!==1||Y(e[1])!==1?r.push([e,[-1,-1]],[e,[-1,1]],[e,[1,-1]],[e,[1,1]]):r.push([e,[t[0],-t[1]]],[e,[-t[0],t[1]]]),r.push([e,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var i=t[0]?t:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(s){var l=[o*i[0],s*i[1]];e[0]===l[0]&&e[1]===l[1]||r.push([e,l])})})}else if(t[0]){var a=Y(e[0])===1?[1]:[1,-1];a.forEach(function(o){r.push([[e[0],-1],[o*t[0],-1]],[[e[0],0],[o*t[0],0]],[[e[0],1],[o*t[0],1]])})}else if(t[1]){var a=Y(e[1])===1?[1]:[1,-1];a.forEach(function(s){r.push([[-1,e[1]],[-1,s*t[1]]],[[0,e[1]],[0,s*t[1]]],[[1,e[1]],[1,s*t[1]]])})}return r}function Mu(t,e){var n=mo([e[0][0],e[1][0]]),r=mo([e[0][1],e[1][1]]);return{vertical:n<=t[0],horizontal:r<=t[1]}}function ps(t,e){var n=I(e,2),r=n[0],i=n[1],a=i[0]-r[0],o=i[1]-r[1];Y(a)<Re&&(a=0),Y(o)<Re&&(o=0);var s,l;if(!a)s=r[0],l=t[0];else if(!o)s=r[1],l=t[1];else{var c=o/a;s=c*(t[0]-r[0])+r[1],l=t[1]}return s-l}function Tu(t,e,n,r){return r===void 0&&(r=Re),t.every(function(i){var a=ps(i,e),o=a<=0;return o===n||Y(a)<=r})}function ku(t,e,n,r,i){return i===void 0&&(i=0),r&&e-i<=t||!r&&t<=n+i?{isBound:!0,offset:r?e-t:n-t}:{isBound:!1,offset:0}}function kg(t,e){var n=e.line,r=e.centerSign,i=e.verticalSign,a=e.horizontalSign,o=e.lineConstants,s=t.props.innerBounds;if(!s)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=s.left,c=s.top,u=s.width,d=s.height,f=[[l,c],[l,c+d]],h=[[l,c],[l+u,c]],v=[[l+u,c],[l+u,c+d]],p=[[l,c+d],[l+u,c+d]];if(Tu([[l,c],[l+u,c],[l,c+d],[l+u,c+d]],n,r))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Gn(n,o,h,i),m=Gn(n,o,p,i),x=Gn(n,o,f,a),b=Gn(n,o,v,a),C=g.isBound&&m.isBound,E=g.isBound||m.isBound,S=x.isBound&&b.isBound,D=x.isBound||b.isBound,M=Gr(g.offset,m.offset),w=Gr(x.offset,b.offset),T=[0,0],k=!1,O=!1;return Y(w)<Y(M)?(T=[M,0],k=E,O=C):(T=[0,w],k=D,O=S),{isAllBound:O,isVerticalBound:E,isHorizontalBound:D,isBound:k,offset:T}}function Gn(t,e,n,r,i,a){var o=I(e,2),s=o[0],l=o[1],c=t[0],u=n[0],d=n[1],f=Ga(d[1]-u[1]),h=Ga(d[0]-u[0]),v=l,p=s,g=-s/l;if(h){if(!f){if(a&&!v)return{isBound:!1,offset:0};if(p){var C=(u[1]-c[1])/g+c[0];return ku(C,u[0],d[0],r,i)}else{var x=u[1]-c[1],b=Y(x)<=(i||0);return{isBound:b,offset:b?x:0}}}}else{if(a&&!p)return{isBound:!1,offset:0};if(v){var m=g*(u[0]-c[0])+c[1];return ku(m,u[1],d[1],r,i)}else{var x=u[0]-c[0],b=Y(x)<=(i||0);return{isBound:b,offset:b?x:0}}}return{isBound:!1,offset:0}}function Au(t,e,n){return e.map(function(r){var i=kg(t,r),a=i.isBound,o=i.offset,s=i.isVerticalBound,l=i.isHorizontalBound,c=r.multiple,u=mn({datas:n,distX:o[0],distY:o[1]}).map(function(d,f){return d*(c[f]?2/c[f]:0)});return{sign:c,isBound:a,isVerticalBound:s,isHorizontalBound:l,isSnap:!1,offset:u}})}function Ag(t,e,n){var r,i=gs(t,e,[0,0],!1).map(function(f){return _(_({},f),{multiple:f.multiple.map(function(h){return Y(h)*2})})}),a=Au(t,i,n),o=Oa(a,0),s=Oa(a,1),l=0,c=0,u=o.isVerticalBound||s.isVerticalBound,d=o.isHorizontalBound||s.isHorizontalBound;return(u||d)&&(r=I(Jp({datas:n,distX:-o.offset[0],distY:-s.offset[1]}),2),l=r[0],c=r[1]),{vertical:{isBound:u,offset:l},horizontal:{isBound:d,offset:c}}}function Rg(t,e){var n=[],r=t[0],i=t[1];return r&&i?n.push([[0,i*2],t,[-r,i]],[[r*2,0],t,[r,-i]]):r?(n.push([[r*2,0],[r,1],[r,-1]]),e&&n.push([[0,-1],[r,-1],[-r,-1]],[[0,1],[r,1],[-r,1]])):i?(n.push([[0,i*2],[1,i],[-1,i]]),e&&n.push([[-1,0],[-1,i],[-1,-i]],[[1,0],[1,i],[1,-i]])):n.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),n}function gs(t,e,n,r){var i=t.state,a=i.allMatrix,o=i.is3d,s=lr(a,100,100,o?4:3),l=he(s,[0,0]);return Rg(n,r).map(function(c){var u=I(c,3),d=u[0],f=u[1],h=u[2],v=[he(s,f),he(s,h)],p=wg(v),g=Mu(l,v),m=g.vertical,x=g.horizontal,b=ps(l,v)<=0;return{multiple:d,centerSign:b,verticalSign:m,horizontalSign:x,lineConstants:p,line:[he(e,f),he(e,h)]}})}function Ru(t,e,n,r){var i=r?t.map(function(a){return vi(a,r)}):t;return[[i[0],i[1]],[i[1],i[3]],[i[3],i[2]],[i[2],i[0]]].some(function(a){var o=ps(n,a)<=0;return!Tu(e,a,o)})}function Og(t){var e=I(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return Y(n[0]);if(!a)return Y(n[1]);var o=a/i;return Y((-o*n[0]+n[1])/Math.sqrt(Math.pow(o,2)+1))}function Lg(t){var e=I(t,2),n=e[0],r=e[1],i=r[0]-n[0],a=r[1]-n[1];if(!i)return[n[0],0];if(!a)return[0,n[1]];var o=a/i,s=-o*n[0]+n[1];return[-s/(o+1/o),s/(o*o+1)]}function _g(t,e,n,r,i){var a=t.props.innerBounds,o=i*Math.PI/180;if(!a)return[];var s=a.left,l=a.top,c=a.width,u=a.height,d=s-r[0],f=s+c-r[0],h=l-r[1],v=l+u-r[1],p=[[d,h],[f,h],[d,v],[f,v]],g=he(n,[0,0]);if(!Ru(n,p,g,0))return[];var m=[],x=p.map(function(b){return[Ue(b),se([0,0],b)]});return[[n[0],n[1]],[n[1],n[3]],[n[3],n[2]],[n[2],n[0]]].forEach(function(b){var C=se([0,0],Lg(b)),E=Og(b);m.push.apply(m,J([],I(x.filter(function(S){var D=I(S,1),M=D[0];return M&&E<=M}).map(function(S){var D=I(S,2),M=D[0],w=D[1],T=Math.acos(M?E/M:0),k=w+T,O=w-T;return[o+k-C,o+O-C]}).reduce(function(S,D){return S.push.apply(S,J([],I(D),!1)),S},[]).filter(function(S){return!Ru(e,p,g,S)}).map(function(S){return Et(S*180/Math.PI,Re)})),!1))}),m}function Ig(t){var e=t.props.innerBounds,n=jr();if(!e)return{boundMap:n,vertical:[],horizontal:[]};var r=t.getRect(),i=r.pos1,a=r.pos2,o=r.pos3,s=r.pos4,l=[i,a,o,s],c=he(l,[0,0]),u=e.left,d=e.top,f=e.width,h=e.height,v=[[u,d],[u,d+h]],p=[[u,d],[u+f,d]],g=[[u+f,d],[u+f,d+h]],m=[[u,d+h],[u+f,d+h]],x=gs(t,l,[0,0],!1),b=[],C=[];return x.forEach(function(E){var S=E.line,D=E.lineConstants,M=Mu(c,S),w=M.horizontal,T=M.vertical,k=Gn(S,D,p,T,1,!0),O=Gn(S,D,m,T,1,!0),R=Gn(S,D,v,w,1,!0),L=Gn(S,D,g,w,1,!0);k.isBound&&!n.top&&(b.push(d),n.top=!0),O.isBound&&!n.bottom&&(b.push(d+h),n.bottom=!0),R.isBound&&!n.left&&(C.push(u),n.left=!0),L.isBound&&!n.right&&(C.push(u+f),n.right=!0)}),{boundMap:n,horizontal:b,vertical:C}}function Pg(t,e,n,r){var i=e[0]-t[0],a=e[1]-t[1];if(Y(i)<oe&&(i=0),Y(a)<oe&&(a=0),!i)return r?[0,0]:[0,n];if(!a)return r?[n,0]:[0,0];var o=a/i,s=t[1]-o*t[0];if(r){var l=o*(e[0]+n)+s;return[n,l-e[1]]}else{var c=(e[1]+n-s)/o;return[c-e[0],n]}}function ms(t,e,n,r,i){var a=Pg(t,e,n,r);if(!a)return{isOutside:!1,offset:[0,0]};var o=vn(t,e),s=vn(a,t),l=vn(a,e),c=s>o||l>o,u=I(mn({datas:i,distX:a[0],distY:a[1]}),2),d=u[0],f=u[1];return{offset:[d,f],isOutside:c}}function La(t,e){return t.isBound?t.offset:e.isSnap?vs(e).offset:0}function zg(t,e,n,r,i){var a=I(e,2),o=a[0],s=a[1],l=I(n,2),c=l[0],u=l[1],d=I(r,2),f=d[0],h=d[1],v=I(i,2),p=v[0],g=v[1],m=-p,x=-g;if(t&&o&&s){m=0,x=0;var b=[];if(c&&u?b.push([0,g],[p,0]):c?b.push([p,0]):u?b.push([0,g]):f&&h?b.push([0,g],[p,0]):f?b.push([p,0]):h&&b.push([0,g]),b.length){b.sort(function(D,M){return Ue(pt([o,s],D))-Ue(pt([o,s],M))});var C=b[0];if(C[0]&&Y(o)>oe)m=-C[0],x=s*Y(o+m)/Y(o)-s;else if(C[1]&&Y(s)>oe){var E=s;x=-C[1],m=o*Y(s+x)/Y(E)-o}if(t&&u&&c)if(Y(m)>oe&&Y(m)<Y(p)){var S=Y(p)/Y(m);m*=S,x*=S}else if(Y(x)>oe&&Y(x)<Y(g)){var S=Y(g)/Y(x);m*=S,x*=S}else m=Gr(-p,m),x=Gr(-g,x)}}else m=o||c?-p:0,x=s||u?-g:0;return[m,x]}function Ng(t,e,n,r,i,a){if(!Vr(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=As(a.absolutePoses,[e,n]),s=Xe(o),l=s.left,c=s.right,u=s.top,d=s.bottom,f={horizontal:o.map(function(L){return L[1]}),vertical:o.map(function(L){return L[0]})},h=fs(t.props.snapDirections),v=hs(h,{left:l,right:c,top:u,bottom:d,center:(l+c)/2,middle:(u+d)/2}),p=_a(t,i,v,f),g=p.vertical,m=p.horizontal,x=Ag(t,o,a),b=x.vertical,C=x.horizontal,E=g.isSnap,S=m.isSnap,D=g.isBound||b.isBound,M=m.isBound||C.isBound,w=Gr(g.offset,b.offset),T=Gr(m.offset,C.offset),k=I(zg(r,[e,n],[D,M],[E,S],[w,T]),2),O=k[0],R=k[1];return[{isBound:D,isSnap:E,offset:O},{isBound:M,isSnap:S,offset:R}]}function _a(t,e,n,r){r===void 0&&(r=n);var i=ds(Aa(t),r.vertical,r.horizontal),a=i.horizontal,o=i.vertical,s=e?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Ra(t,n.vertical,n.horizontal,void 0,void 0,void 0,void 0),l=s.horizontal,c=s.vertical,u=La(a[0],l),d=La(o[0],c),f=Y(u),h=Y(d);return{horizontal:{isBound:a[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:u,dist:f,bounds:a,snap:l},vertical:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:d,dist:h,bounds:o,snap:c}}}function Ou(t,e,n,r,i,a,o){o===void 0&&(o=[1,1]);var s=ds(e,n,r),l=s.horizontal,c=s.vertical,u=Su(t,n,r,[],[],i,a,o),d=u.horizontal,f=u.vertical,h=La(l[0],d),v=La(c[0],f),p=Y(h),g=Y(v);return{horizontal:{isBound:l[0].isBound,isSnap:d.isSnap,snapIndex:d.index,offset:h,dist:p,bounds:l,snap:d},vertical:{isBound:c[0].isBound,isSnap:f.isSnap,snapIndex:f.index,offset:v,dist:g,bounds:c,snap:f}}}function Bg(t,e,n,r){var i=se(t,e)/Math.PI*180,a=n.vertical,o=a.isBound,s=a.isSnap,l=a.dist,c=n.horizontal,u=c.isBound,d=c.isSnap,f=c.dist,h=i%180,v=h<3||h>177,p=h>87&&h<93;return f<l&&(o||s&&!p&&(!r||!v))?"vertical":u||d&&!v&&(!r||!p)?"horizontal":""}function jg(t,e,n,r,i,a){return n.map(function(o){var s=I(o,2),l=s[0],c=s[1],u=he(e,l),d=he(e,c),f=r?Vg(t,u,d,i):_a(t,i,{vertical:[d[0]],horizontal:[d[1]]}),h=f.horizontal,v=h.offset,p=h.isBound,g=h.isSnap,m=f.vertical,x=m.offset,b=m.isBound,C=m.isSnap,E=pt(c,l);if(!x&&!v)return{isBound:b||p,isSnap:C||g,sign:E,offset:[0,0]};var S=Bg(u,d,f,r);if(!S)return{sign:E,isBound:!1,isSnap:!1,offset:[0,0]};var D=S==="vertical",M=[0,0];return!r&&Y(c[0])===1&&Y(c[1])===1&&l[0]!==c[0]&&l[1]!==c[1]?M=mn({datas:a,distX:-x,distY:-v}):M=ms(u,d,-(D?x:v),D,a).offset,M=M.map(function(w,T){return w*(E[T]?2/E[T]:0)}),{sign:E,isBound:D?b:p,isSnap:D?C:g,offset:M}})}function Lu(t,e){return t.isBound?t.offset:e.isSnap?e.offset:0}function Vg(t,e,n,r){var i=mg(t,e,n),a=i.horizontal,o=i.vertical,s=r?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:Dg(t,e,n),l=s.horizontal,c=s.vertical,u=Lu(a,l),d=Lu(o,c),f=Y(u),h=Y(d);return{horizontal:{isBound:a.isBound,isSnap:l.isSnap,offset:u,dist:f},vertical:{isBound:o.isBound,isSnap:c.isSnap,offset:d,dist:h}}}function Fg(t,e,n,r,i){var a=[-n[0],-n[1]],o=t.state,s=o.width,l=o.height,c=t.props.bounds,u=1/0,d=1/0;if(c){var f=[[n[0],-n[1]],[-n[0],n[1]]],h=c.left,v=h===void 0?-1/0:h,p=c.top,g=p===void 0?-1/0:p,m=c.right,x=m===void 0?1/0:m,b=c.bottom,C=b===void 0?1/0:b;f.forEach(function(E){var S=E[0]!==a[0],D=E[1]!==a[1],M=he(e,E),w=se(r,M)*360/Math.PI;if(D){var T=M.slice();(Y(w-360)<2||Y(w-180)<2)&&(T[1]=r[1]);var k=ms(r,T,(r[1]<M[1]?C:g)-M[1],!1,i),O=I(k.offset,2),R=O[1],L=k.isOutside;isNaN(R)||(d=l+(L?1:-1)*Y(R))}if(S){var T=M.slice();(Y(w-90)<2||Y(w-270)<2)&&(T[0]=r[0]);var P=ms(r,T,(r[0]<M[0]?x:v)-M[0],!0,i),z=I(P.offset,1),V=z[0],N=P.isOutside;isNaN(V)||(u=s+(N?1:-1)*Y(V))}})}return{maxWidth:u,maxHeight:d}}var Oe={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,e){var n=t.props,r=n.hideThrottleDragRotateLine,i=n.throttleDragRotate,a=n.zoom,o=t.getState(),s=o.dragInfo,l=o.beforeOrigin;if(r||!i||!s)return[];var c=s.dist;if(!c[0]&&!c[1])return[];var u=Ue(c),d=se(c,[0,0]);return[e.createElement("div",{className:ht("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) rotate(").concat(d,"rad) scaleY(").concat(a,")")}})]},dragStart:function(t,e){var n=e.datas,r=e.parentEvent,i=e.parentGesto,a=t.state,o=a.gestos,s=a.style;if(o.draggable)return!1;o.draggable=i||t.targetGesto,n.datas={},n.left=parseFloat(s.left||"")||0,n.top=parseFloat(s.top||"")||0,n.bottom=parseFloat(s.bottom||"")||0,n.right=parseFloat(s.right||"")||0,n.startValue=[0,0],ar(t,e),wa(t,e,"translate"),o0(t,n),n.prevDist=[0,0],n.prevBeforeDist=[0,0],n.isDrag=!1,n.deltaOffset=[0,0];var l=At(t,e,_({set:function(u){n.startValue=u}},Ea(t,e))),c=r||it(t,"onDragStart",l);return c!==!1?(n.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.draggable=null,n.isPinch=!1),n.isDrag?l:!1},drag:function(t,e){if(e){Ca(t,e,"translate");var n=e.datas,r=e.parentEvent,i=e.parentFlag,a=e.isPinch,o=e.deltaOffset,s=e.useSnap,l=e.isRequest,c=e.isGroup,u=e.parentThrottleDrag,d=e.distX,f=e.distY,h=n.isDrag,v=n.prevDist,p=n.prevBeforeDist,g=n.startValue;if(h){o&&(d+=o[0],f+=o[1]);var m=t.props,x=m.parentMoveable,b=c?0:m.throttleDrag||u||0,C=r?0:m.throttleDragRotate||0,E=0,S=!1,D=!1,M=!1,w=!1;if(!r&&C>0&&(d||f)){var T=m.startDragRotate||0,k=Et(T+se([0,0],[d,f])*180/Math.PI,C)-T,O=f*Math.abs(Math.cos((k-90)/180*Math.PI)),R=d*Math.abs(Math.cos(k/180*Math.PI)),L=Ue([R,O]);E=k*Math.PI/180,d=L*Math.cos(E),f=L*Math.sin(E)}if(!a&&!r&&!i){var P=I(Ng(t,d,f,C,!s&&l||o,n),2),z=P[0],V=P[1];S=z.isSnap,D=z.isBound,M=V.isSnap,w=V.isBound;var N=z.offset,G=V.offset;d+=N,f+=G}var W=Ft(iu({datas:n,distX:d,distY:f}),g),B=Ft(qp({datas:n,distX:d,distY:f}),g);Hl(B,Re),Hl(W,Re),C||(!S&&!D&&(B[0]=Et(B[0],b),W[0]=Et(W[0],b)),!M&&!w&&(B[1]=Et(B[1],b),W[1]=Et(W[1],b)));var q=pt(W,g),Z=pt(B,g),K=pt(Z,v),X=pt(q,p);n.prevDist=Z,n.prevBeforeDist=q,n.passDelta=K,n.passDist=Z;var H=n.left+q[0],et=n.top+q[1],rt=n.right-q[0],mt=n.bottom-q[1],vt=Sa(n,"translate(".concat(B[0],"px, ").concat(B[1],"px)"),"translate(".concat(Z[0],"px, ").concat(Z[1],"px)"));if(ls(e,vt),t.state.dragInfo.dist=r?[0,0]:Z,!(!r&&!x&&K.every(function(dt){return!dt})&&X.some(function(dt){return!dt}))){var U=t.state,nt=U.width,Rt=U.height,ut=At(t,e,_({transform:vt,dist:Z,delta:K,translate:B,beforeDist:q,beforeDelta:X,beforeTranslate:W,left:H,top:et,right:rt,bottom:mt,width:nt,height:Rt,isPinch:a},Le({transform:vt},e)));return!r&&it(t,"onDrag",ut),ut}}}},dragAfter:function(t,e){var n=e.datas,r=n.deltaOffset;return r[0]||r[1]?(n.deltaOffset=[0,0],this.drag(t,_(_({},e),{deltaOffset:r}))):!1},dragEnd:function(t,e){var n=e.parentEvent,r=e.datas;if(t.state.dragInfo=null,!!r.isDrag){r.isDrag=!1;var i=$e(t,e,{});return!n&&it(t,"onDragEnd",i),i}},dragGroupStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,s=this.dragStart(t,e);if(!s)return!1;var l=us(t,this,"dragStart",[a||0,o||0],e,!1,"draggable"),c=l.childEvents,u=l.eventParams,d=_(_({},s),{targets:t.props.targets,events:u}),f=it(t,"onDragGroupStart",d);i.isDrag=f!==!1;var h=(r=(n=c[0])===null||n===void 0?void 0:n.datas.startValue)!==null&&r!==void 0?r:[0,0];return i.throttleOffset=[h[0]%1,h[1]%1],i.isDrag?s:!1},dragGroup:function(t,e){var n=e.datas;if(n.isDrag){var r=this.drag(t,_(_({},e),{parentThrottleDrag:t.props.throttleDrag})),i=e.datas.passDelta,a=us(t,this,"drag",i,e,!1,"draggable").eventParams;if(r){var o=_({targets:t.props.targets,events:a},r);return it(t,"onDragGroup",o),o}}},dragGroupEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isDrag){this.dragEnd(t,e);var i=us(t,this,"dragEnd",[0,0],e,!1,"draggable").eventParams;return it(t,"onDragGroupEnd",$e(t,e,{targets:t.props.targets,events:i})),n}},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=!1;return{isControl:!1,requestStart:function(o){return a=o.useSnap,{datas:e,useSnap:a}},request:function(o){return"x"in o?r=o.x-n.left:"deltaX"in o&&(r+=o.deltaX),"y"in o?i=o.y-n.top:"deltaY"in o&&(i+=o.deltaY),{datas:e,distX:r,distY:i,useSnap:a}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function _u(t,e){var n=he(t,e),r=[0,0];return{fixedPosition:n,fixedDirection:e,fixedOffset:r}}function Gg(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,s=[i/2*(1+e[0]),a/2*(1+e[1])],l=ae(n,s,o),c=[0,0];return{fixedPosition:l,fixedDirection:e,fixedOffset:c}}function Iu(t,e){var n=t.allMatrix,r=t.is3d,i=t.width,a=t.height,o=r?4:3,s=og(e,i,a),l=ae(n,e,o),c=[i?0:e[0],a?0:e[1]];return{fixedPosition:l,fixedDirection:s,fixedOffset:c}}var Pu=Is("resizable"),xs={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:fu("resizable"),dragControlCondition:Pu,viewClassName:_s("resizable"),dragControlStart:function(t,e){var n,r=e.inputEvent,i=e.isPinch,a=e.isGroup,o=e.parentDirection,s=e.parentGesto,l=e.datas,c=e.parentFixedDirection,u=e.parentEvent,d=ed(o,i,r,l),f=t.state,h=f.target,v=f.width,p=f.height,g=f.gestos;if(!d||!h||g.resizable)return!1;g.resizable=s||t.controlGesto,!i&&ar(t,e),l.datas={},l.direction=d,l.startOffsetWidth=v,l.startOffsetHeight=p,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=f.inlineCSSWidth||f.cssWidth,l.startHeight=f.inlineCSSHeight||f.cssHeight,l.maxSize=[1/0,1/0],a||(l.minSize=[f.minOffsetWidth,f.minOffsetHeight],l.maxSize=[f.maxOffsetWidth,f.maxOffsetHeight]);var m=t.props.transformOrigin||"% %";l.transformOrigin=m&&ye(m)?m.split(" "):m,l.startOffsetMatrix=f.offsetMatrix,l.startTransformOrigin=f.transformOrigin,l.isWidth=(n=e?.parentIsWidth)!==null&&n!==void 0?n:!d[0]&&!d[1]||d[0]||!d[1];function x(w){l.ratio=w&&isFinite(w)?w:0}l.startPositions=Ze(t.state);function b(w){var T=_u(l.startPositions,w);l.fixedDirection=T.fixedDirection,l.fixedPosition=T.fixedPosition,l.fixedOffset=T.fixedOffset}function C(w){var T=Iu(t.state,w);l.fixedDirection=T.fixedDirection,l.fixedPosition=T.fixedPosition,l.fixedOffset=T.fixedOffset}function E(w){l.minSize=[It("".concat(w[0]),0)||0,It("".concat(w[1]),0)||0]}function S(w){var T=[w[0]||1/0,w[1]||1/0];(!Tr(T[0])||isFinite(T[0]))&&(T[0]=It("".concat(T[0]),0)||1/0),(!Tr(T[1])||isFinite(T[1]))&&(T[1]=It("".concat(T[1]),0)||1/0),l.maxSize=T}x(v/p),b(c||[-d[0],-d[1]]),l.setFixedDirection=b,l.setFixedPosition=C,l.setMin=E,l.setMax=S;var D=At(t,e,{direction:d,startRatio:l.ratio,set:function(w){var T=I(w,2),k=T[0],O=T[1];l.startWidth=k,l.startHeight=O},setMin:E,setMax:S,setRatio:x,setFixedDirection:b,setFixedPosition:C,setOrigin:function(w){l.transformOrigin=w},dragStart:Oe.dragStart(t,new Ir().dragStart([0,0],e))}),M=u||it(t,"onResizeStart",D);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,M!==!1&&(l.isResize=!0,t.state.snapRenderInfo={request:e.isRequest,direction:d}),l.isResize?D:!1},dragControl:function(t,e){var n,r=e.datas,i=e.parentFlag,a=e.isPinch,o=e.parentKeepRatio,s=e.dragClient,l=e.parentDist,c=e.useSnap,u=e.isRequest,d=e.isGroup,f=e.parentEvent,h=e.resolveMatrix,v=r.isResize,p=r.transformOrigin,g=r.startWidth,m=r.startHeight,x=r.prevWidth,b=r.prevHeight,C=r.minSize,E=r.maxSize,S=r.ratio,D=r.startOffsetWidth,M=r.startOffsetHeight,w=r.isWidth;if(!v)return;if(h){var T=t.state.is3d,k=r.startOffsetMatrix,O=r.startTransformOrigin,R=T?4:3,L=er(Da(e)),P=Math.sqrt(L.length);R!==P&&(L=an(L,P,R));var z=bi(k,L,O,R),V=lr(z,D,M,R);r.startPositions=V,r.nextTargetMatrix=L,r.nextAllMatrix=z}var N=cr(t.props,"resizable"),G=N.resizeFormat,W=N.throttleResize,B=W===void 0?i?0:1:W,q=N.parentMoveable,Z=N.keepRatioFinally,K=r.direction,X=K,H=0,et=0;!K[0]&&!K[1]&&(X=[1,1]);var rt=S&&(o??N.keepRatio)||!1;function mt(){var St=r.fixedDirection,gt=ud(X,rt,r,e);H=gt.distWidth,et=gt.distHeight;var kt=X[0]-St[0]||rt?Math.max(D+H,Re):D,Lt=X[1]-St[1]||rt?Math.max(M+et,Re):M;return rt&&D&&M&&(w?Lt=kt/S:kt=Lt*S),[kt,Lt]}var vt=I(mt(),2),U=vt[0],nt=vt[1];f||(r.setFixedDirection(r.fixedDirection),it(t,"onBeforeResize",At(t,e,{startFixedDirection:r.startFixedDirection,startFixedPosition:r.startFixedPosition,setFixedDirection:function(St){var gt;return r.setFixedDirection(St),gt=I(mt(),2),U=gt[0],nt=gt[1],[U,nt]},setFixedPosition:function(St){var gt;return r.setFixedPosition(St),gt=I(mt(),2),U=gt[0],nt=gt[1],[U,nt]},boundingWidth:U,boundingHeight:nt,setSize:function(St){var gt;gt=I(St,2),U=gt[0],nt=gt[1]}},!0)));var Rt=s;s||(!i&&a?Rt=ug(t,[0,0]):Rt=r.fixedPosition);var ut=[0,0];a||(ut=i0(t,U,nt,K,Rt,!c&&u,r)),l&&(!l[0]&&(ut[0]=0),!l[1]&&(ut[1]=0));function dt(){var St;G&&(St=I(G([U,nt]),2),U=St[0],nt=St[1]),U=Et(U,B),nt=Et(nt,B)}if(rt){X[0]&&X[1]&&ut[0]&&ut[1]&&(Y(ut[0])>Y(ut[1])?ut[1]=0:ut[0]=0);var yt=!ut[0]&&!ut[1];yt&&dt(),X[0]&&!X[1]||ut[0]&&!ut[1]||yt&&w?(U+=ut[0],nt=U/S):(!X[0]&&X[1]||!ut[0]&&ut[1]||yt&&!w)&&(nt+=ut[1],U=nt*S)}else U+=ut[0],nt+=ut[1],U=Math.max(0,U),nt=Math.max(0,nt);n=I(go([U,nt],C,E,rt?S:!1),2),U=n[0],nt=n[1],dt(),rt&&(d||Z)&&(w?nt=U/S:U=nt*S),H=U-D,et=nt-M;var Ot=[H-x,et-b];r.prevWidth=H,r.prevHeight=et;var Tt=cg(t,U,nt,Rt,p,r);if(!(!q&&Ot.every(function(St){return!St})&&Tt.every(function(St){return!St}))){var xt=Oe.drag(t,yi(e,t.state,Tt,!!a,!1,"draggable")),Ct=xt.transform,Ht=g+H,Nt=m+et,lt=At(t,e,_({width:Ht,height:Nt,offsetWidth:Math.round(U),offsetHeight:Math.round(nt),startRatio:S,boundingWidth:U,boundingHeight:nt,direction:K,dist:[H,et],delta:Ot,isPinch:!!a,drag:xt},rd({style:{width:"".concat(Ht,"px"),height:"".concat(Nt,"px")},transform:Ct},xt,e)));return!f&&it(t,"onResize",lt),lt}},dragControlAfter:function(t,e){var n=e.datas,r=n.isResize,i=n.startOffsetWidth,a=n.startOffsetHeight,o=n.prevWidth,s=n.prevHeight;if(!(!r||t.props.checkResizableError===!1)){var l=t.state,c=l.width,u=l.height,d=c-(i+o),f=u-(a+s),h=Y(d)>3,v=Y(f)>3;if(h&&(n.startWidth+=d,n.startOffsetWidth+=d,n.prevWidth+=d),v&&(n.startHeight+=f,n.startOffsetHeight+=f,n.prevHeight+=f),h||v)return this.dragControl(t,e)}},dragControlEnd:function(t,e){var n=e.datas,r=e.parentEvent;if(n.isResize){n.isResize=!1;var i=$e(t,e,{});return!r&&it(t,"onResizeEnd",i),i}},dragGroupControlCondition:Pu,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,_(_({},e),{isGroup:!0}));if(!r)return!1;var i=on(t,"resizable",e),a=n.startOffsetWidth,o=n.startOffsetHeight;function s(){var h=n.minSize;i.forEach(function(v){var p=v.datas,g=p.minSize,m=p.startOffsetWidth,x=p.startOffsetHeight,b=a*(m?g[0]/m:0),C=o*(x?g[1]/x:0);h[0]=Math.max(h[0],b),h[1]=Math.max(h[1],C)})}function l(){var h=n.maxSize;i.forEach(function(v){var p=v.datas,g=p.maxSize,m=p.startOffsetWidth,x=p.startOffsetHeight,b=a*(m?g[0]/m:0),C=o*(x?g[1]/x:0);h[0]=Math.min(h[0],b),h[1]=Math.min(h[1],C)})}var c=An(t,this,"dragControlStart",e,function(h,v){return ka(t,h,n,v)});s(),l();var u=function(h){r.setFixedDirection(h),c.forEach(function(v,p){v.setFixedDirection(h),ka(t,v.moveable,n,i[p])})};n.setFixedDirection=u;var d=_(_({},r),{targets:t.props.targets,events:c.map(function(h){return _(_({},h),{setMin:function(v){h.setMin(v),s()},setMax:function(v){h.setMax(v),l()}})}),setFixedDirection:u,setMin:function(h){r.setMin(h),s()},setMax:function(h){r.setMax(h),l()}}),f=it(t,"onResizeGroupStart",d);return n.isResize=f!==!1,n.isResize?r:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isResize){var r=cr(t.props,"resizable");Va(t,"onBeforeResize",function(h){it(t,"onBeforeResizeGroup",At(t,e,_(_({},h),{targets:r.targets}),!0))});var i=this.dragControl(t,_(_({},e),{isGroup:!0}));if(i){var a=i.boundingWidth,o=i.boundingHeight,s=i.dist,l=r.keepRatio,c=[a/(a-s[0]),o/(o-s[1])],u=n.fixedPosition,d=An(t,this,"dragControl",e,function(h,v){var p=I(we(pi(t.rotation/180*Math.PI,3),[v.datas.originalX*c[0],v.datas.originalY*c[1],1],3),2),g=p[0],m=p[1];return _(_({},v),{parentDist:null,parentScale:c,dragClient:Ft(u,[g,m]),parentKeepRatio:l})}),f=_({targets:r.targets,events:d},i);return it(t,"onResizeGroup",f),f}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isResize){this.dragControlEnd(t,e);var i=An(t,this,"dragControlEnd",e),a=$e(t,e,{targets:t.props.targets,events:i});return it(t,"onResizeGroupEnd",a),n}},request:function(t){var e={},n=0,r=0,i=!1,a=t.getRect();return{isControl:!0,requestStart:function(o){var s;return i=o.useSnap,{datas:e,parentDirection:o.direction||[1,1],parentIsWidth:(s=o?.horizontal)!==null&&s!==void 0?s:!0,useSnap:i}},request:function(o){return"offsetWidth"in o?n=o.offsetWidth-a.offsetWidth:"deltaWidth"in o&&(n+=o.deltaWidth),"offsetHeight"in o?r=o.offsetHeight-a.offsetHeight:"deltaHeight"in o&&(r+=o.deltaHeight),{datas:e,parentDist:[n,r],parentKeepRatio:o.keepRatio,useSnap:i}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.resizable=null}};function ys(t,e,n,r,i){var a=t.props.groupable,o=t.state,s=o.is3d?4:3,l=e.origin,c=ae(t.state.rootMatrix,pt([l[0],l[1]],a?[0,0]:[o.left,o.top]),s),u=Ft([i.left,i.top],c);e.startAbsoluteOrigin=u,e.prevDeg=se(u,[n,r])/Math.PI*180,e.defaultDeg=e.prevDeg,e.prevSnapDeg=0,e.loop=0,e.startDist=vn(u,[n,r])}function Ia(t,e,n){var r=n.defaultDeg,i=n.prevDeg,a=i%360,o=Math.floor(i/360);a<0&&(a+=360),a>t&&a>270&&t<90?++o:a<t&&a<90&&t>270&&--o;var s=e*(o*360+t-r);return n.prevDeg=r+s,s}function bs(t,e,n,r){return Ia(se(r.startAbsoluteOrigin,[t,e])/Math.PI*180,n,r)}function Cs(t,e,n,r,i,a){var o=t.props.throttleRotate,s=o===void 0?0:o,l=n.prevSnapDeg,c=0,u=!1;if(a){var d=r0(t,e,r,i+r);u=d.isSnap,c=i+d.dist}u||(c=Et(i+r,s));var f=c-i;return n.prevSnapDeg=f,[f-l,f,c]}function zu(t,e,n){var r=I(e,4),i=r[0],a=r[1],o=r[2],s=r[3];if(t==="none")return[];if(qt(t))return t.map(function(g){return zu(g,[i,a,o,s],n)[0]});var l=I((t||"top").split("-"),2),c=l[0],u=l[1],d=[i,a];c==="left"?d=[o,i]:c==="right"?d=[a,s]:c==="bottom"&&(d=[s,o]);var f=[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2],h=Ju(d,n);if(u){var v=u==="top"||u==="left",p=c==="bottom"||c==="left";f=d[v&&!p||!v&&p?0:1]}return[[f,h]]}function Ss(t,e){if(e.isRequest)return e.requestAble==="rotatable";var n=e.inputEvent.target;if(ce(n,ht("rotation-control"))||t.props.rotateAroundControls&&ce(n,ht("around-control"))||ce(n,ht("control"))&&ce(n,ht("rotatable")))return!0;var r=t.props.rotationTarget;return r?Ps(r,!0).some(function(i){return i?n===i||n.contains(i):!1}):!1}var $g=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,Wg={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[$g],viewClassName:function(t){return t.isDragging("rotatable")?ht("view-rotation-dragging"):""},render:function(t,e){var n=cr(t.props,"rotatable"),r=n.rotatable,i=n.rotationPosition,a=n.zoom,o=n.renderDirections,s=n.rotateAroundControls,l=n.resolveAblesWithRotatable,c=t.getState(),u=c.renderPoses,d=c.direction;if(!r)return null;var f=zu(i,u,d),h=[];if(f.forEach(function(m,x){var b=I(m,2),C=b[0],E=b[1];h.push(e.createElement("div",{key:"rotation".concat(x),className:ht("rotation"),style:{transform:"translate(-50%) translate(".concat(C[0],"px, ").concat(C[1],"px) rotate(").concat(E,"rad)")}},e.createElement("div",{className:ht("line rotation-line"),style:{transform:"scaleX(".concat(a,")")}}),e.createElement("div",{className:ht("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(a,")")}})))}),o){var v=hn(l||{}),p={};v.forEach(function(m){l[m].forEach(function(x){p[x]=m})});var g=[];qt(o)&&(g=o.map(function(m){var x=p[m];return{data:x?{resolve:x}:{},classNames:x?["move"]:[],dir:m}})),h.push.apply(h,J([],I(cu(t,"rotatable",g,e)),!1))}return s&&h.push.apply(h,J([],I(vu(t,e)),!1)),h},dragControlCondition:Ss,dragControlStart:function(t,e){var n,r,i=e.datas,a=e.clientX,o=e.clientY,s=e.parentRotate,l=e.parentFlag,c=e.isPinch,u=e.isRequest,d=t.state,f=d.target,h=d.left,v=d.top,p=d.direction,g=d.beforeDirection,m=d.targetTransform,x=d.moveableClientRect,b=d.offsetMatrix,C=d.targetMatrix,E=d.allMatrix,S=d.width,D=d.height;if(!u&&!f)return!1;var M=t.getRect();i.rect=M,i.transform=m,i.left=h,i.top=v;var w=function(X){var H=Iu(t.state,X);i.fixedDirection=H.fixedDirection,i.fixedOffset=H.fixedOffset,i.fixedPosition=H.fixedPosition,B&&B.setFixedPosition(X)},T=function(X){var H=Gg(t.state,X);i.fixedDirection=H.fixedDirection,i.fixedOffset=H.fixedOffset,i.fixedPosition=H.fixedPosition,B&&B.setFixedDirection(X)},k=a,O=o;if(u||c||l){var R=s||0;i.beforeInfo={origin:M.beforeOrigin,prevDeg:R,defaultDeg:R,prevSnapDeg:0,startDist:0},i.afterInfo=_(_({},i.beforeInfo),{origin:M.origin}),i.absoluteInfo=_(_({},i.beforeInfo),{origin:M.origin,startValue:R})}else{var L=(r=e.inputEvent)===null||r===void 0?void 0:r.target;if(L){var P=L.getAttribute("data-direction")||"",z=Zp[P];if(z){i.isControl=!0,i.isAroundControl=ce(L,ht("around-control")),i.controlDirection=z;var V=L.getAttribute("data-resolve");V&&(i.resolveAble=V);var N=y0(d.rootMatrix,d.renderPoses,x);n=I(he(N,z),2),k=n[0],O=n[1]}}i.beforeInfo={origin:M.beforeOrigin},i.afterInfo={origin:M.origin},i.absoluteInfo={origin:M.origin,startValue:M.rotation};var G=w;w=function(X){var H=d.is3d?4:3,et=I(Ft(Gc(C,H),X),2),rt=et[0],mt=et[1],vt=we(b,Jn([rt,mt],H)),U=we(E,Jn([X[0],X[1]],H));G(X);var nt=d.posDelta;i.beforeInfo.origin=pt(vt,nt),i.afterInfo.origin=pt(U,nt),i.absoluteInfo.origin=pt(U,nt),ys(t,i.beforeInfo,k,O,x),ys(t,i.afterInfo,k,O,x),ys(t,i.absoluteInfo,k,O,x)},T=function(X){var H=he([[0,0],[S,0],[0,D],[S,D]],X);w(H)}}i.startClientX=k,i.startClientY=O,i.direction=p,i.beforeDirection=g,i.startValue=0,i.datas={},wa(t,e,"rotate");var W=!1,B=!1;if(i.isControl&&i.resolveAble){var q=i.resolveAble;q==="resizable"&&(B=xs.dragControlStart(t,_(_({},new Ir("resizable").dragStart([0,0],e)),{parentPosition:i.controlPosition,parentFixedPosition:i.fixedPosition})))}B||(W=Oe.dragStart(t,new Ir().dragStart([0,0],e))),w(b0(t));var Z=At(t,e,_(_({set:function(X){i.startValue=X*Math.PI/180},setFixedDirection:T,setFixedPosition:w},Ea(t,e)),{dragStart:W,resizeStart:B})),K=it(t,"onRotateStart",Z);return i.isRotate=K!==!1,d.snapRenderInfo={request:e.isRequest},i.isRotate?Z:!1},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.clientDistX,s=e.clientDistY,l=e.parentRotate,c=e.parentFlag,u=e.isPinch,d=e.groupDelta,f=e.resolveMatrix,h=a.beforeDirection,v=a.beforeInfo,p=a.afterInfo,g=a.absoluteInfo,m=a.isRotate,x=a.startValue,b=a.rect,C=a.startClientX,E=a.startClientY;if(m){Ca(t,e,"rotate");var S=Qp(e),D=h*S,M=t.props.parentMoveable,w=0,T,k,O=0,R,L,P=0,z,V,N=180/Math.PI*x,G=g.startValue,W=!1,B=C+o,q=E+s;if(!c&&"parentDist"in e){var Z=e.parentDist;T=Z,R=Z,z=Z}else u||c?(T=Ia(l,h,v),R=Ia(l,D,p),z=Ia(l,D,g)):(T=bs(B,q,h,v),R=bs(B,q,D,p),z=bs(B,q,D,g),W=!0);if(k=N+T,L=N+R,V=G+z,it(t,"onBeforeRotate",At(t,e,{beforeRotation:k,rotation:L,absoluteRotation:V,setRotation:function(Rt){R=Rt-N,T=R,z=R}},!0)),n=I(Cs(t,b,v,T,N,W),3),w=n[0],T=n[1],k=n[2],r=I(Cs(t,b,p,R,N,W),3),O=r[0],R=r[1],L=r[2],i=I(Cs(t,b,g,z,G,W),3),P=i[0],z=i[1],V=i[2],!(!P&&!O&&!w&&!M&&!f)){var K=Sa(a,"rotate(".concat(L,"deg)"),"rotate(".concat(R,"deg)"));f&&(a.fixedPosition=cs(t,a.targetAllTransform,a.fixedDirection,a.fixedOffset,a));var X=lg(t,R,a),H=pt(Ft(d||[0,0],X),a.prevInverseDist||[0,0]);a.prevInverseDist=X,a.requestValue=null;var et=ou(t,K,H,u,e),rt=et,mt=vn([B,q],g.startAbsoluteOrigin)-g.startDist,vt=void 0;if(a.resolveAble==="resizable"){var U=xs.dragControl(t,_(_({},yi(e,t.state,[e.deltaX,e.deltaY],!!u,!1,"resizable")),{resolveMatrix:!0,parentDistance:mt}));U&&(vt=U,rt=rd(rt,U,e))}var nt=At(t,e,_(_({delta:O,dist:R,rotate:L,rotation:L,beforeDist:T,beforeDelta:w,beforeRotate:k,beforeRotation:k,absoluteDist:z,absoluteDelta:P,absoluteRotate:V,absoluteRotation:V,isPinch:!!u,resize:vt},et),rt));return it(t,"onRotate",nt),nt}}},dragControlEnd:function(t,e){var n=e.datas;if(n.isRotate){n.isRotate=!1;var r=$e(t,e,{});return it(t,"onRotateEnd",r),r}},dragGroupControlCondition:Ss,dragGroupControlStart:function(t,e){var n=e.datas,r=t.state,i=r.left,a=r.top,o=r.beforeOrigin,s=this.dragControlStart(t,e);if(!s)return!1;s.set(n.beforeDirection*t.rotation);var l=An(t,this,"dragControlStart",e,function(d,f){var h=d.state,v=h.left,p=h.top,g=h.beforeOrigin,m=Ft(pt([v,p],[i,a]),pt(g,o));return f.datas.startGroupClient=m,f.datas.groupClient=m,_(_({},f),{parentRotate:0})}),c=_(_({},s),{targets:t.props.targets,events:l}),u=it(t,"onRotateGroupStart",c);return n.isRotate=u!==!1,n.isRotate?s:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isRotate){Va(t,"onBeforeRotate",function(c){it(t,"onBeforeRotateGroup",At(t,e,_(_({},c),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=n.beforeDirection,a=r.beforeDist,o=a/180*Math.PI,s=An(t,this,"dragControl",e,function(c,u){var d=u.datas.startGroupClient,f=I(u.datas.groupClient,2),h=f[0],v=f[1],p=I(vi(d,o*i),2),g=p[0],m=p[1],x=[g-h,m-v];return u.datas.groupClient=[g,m],_(_({},u),{parentRotate:a,groupDelta:x})});t.rotation=i*r.beforeRotation;var l=_({targets:t.props.targets,events:s,set:function(c){t.rotation=c},setGroupRotation:function(c){t.rotation=c}},r);return it(t,"onRotateGroup",l),l}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isRotate){this.dragControlEnd(t,e);var i=An(t,this,"dragControlEnd",e),a=$e(t,e,{targets:t.props.targets,events:i});return it(t,"onRotateGroupEnd",a),n}},request:function(t){var e={},n=0,r=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:e}},request:function(i){return"deltaRotate"in i?n+=i.deltaRotate:"rotate"in i&&(n=i.rotate-r),{datas:e,parentDist:n}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function Hg(t,e){var n,r=t.direction,i=t.classNames,a=t.size,o=t.pos,s=t.zoom,l=t.key,c=r==="horizontal",u=c?"Y":"X";return e.createElement("div",{key:l,className:i.join(" "),style:(n={},n[c?"width":"height"]="".concat(a),n.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(u,"(-50%) scale").concat(u,"(").concat(s,")"),n)})}function Es(t,e){return Hg(_(_({},t),{classNames:J([ht("line","guideline",t.direction)],I(t.classNames),!1).filter(function(n){return n}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(n){return"".concat(Et(n,.1),"px")})}),e)}function Nu(t,e,n,r,i,a,o,s){var l=t.props.zoom;return n.map(function(c,u){var d=c.type,f=c.pos,h=[0,0];return h[o]=r,h[o?0:1]=-i+f,Es({key:"".concat(e,"TargetGuideline").concat(u),classNames:[ht("target","bold",d)],posValue:h,sizeValue:a,zoom:l,direction:e},s)})}function Bu(t,e,n,r,i,a){var o=t.props,s=o.zoom,l=o.isDisplayInnerSnapDigit,c=e==="horizontal"?jn:Vn,u=i[c.start],d=i[c.end];return n.filter(function(f){var h=f.hide,v=f.elementRect;if(h)return!1;if(l&&v){var p=v.rect;if(p[c.start]<=u&&d<=p[c.end])return!1}return!0}).map(function(f,h){var v=f.pos,p=f.size,g=f.element,m=f.className,x=[-r[0]+v[0],-r[1]+v[1]];return Es({key:"".concat(e,"-default-guideline-").concat(h),classNames:g?[ht("bold"),m]:[ht("normal"),m],direction:e,posValue:x,sizeValue:p,zoom:s},a)})}function Si(t,e,n,r,i,a,o,s){var l,c=t.props,u=c.snapDigit,d=u===void 0?0:u,f=c.isDisplaySnapDigit,h=f===void 0?!0:f,v=c.snapDistFormat,p=v===void 0?function(E,S){return E}:v,g=c.zoom,m=e==="horizontal"?"X":"Y",x=e==="vertical"?"height":"width",b=Math.abs(i),C=h?parseFloat(b.toFixed(d)):0;return s.createElement("div",{key:"".concat(e,"-").concat(n,"-guideline-").concat(r),className:ht("guideline-group",e),style:(l={left:"".concat(a[0],"px"),top:"".concat(a[1],"px")},l[x]="".concat(b,"px"),l)},Es({direction:e,classNames:[ht(n),o],size:"100%",posValue:[0,0],sizeValue:b,zoom:g},s),s.createElement("div",{className:ht("size-value","gap"),style:{transform:"translate".concat(m,"(-50%) scale(").concat(g,")")}},C>0?p(C,e):""))}function Yg(t,e,n,r){var i=t==="vertical"?0:1,a=t==="vertical"?1:0,o=i?jn:Vn,s=n[o.start],l=n[o.end];return ad(e,function(c){return c.pos[i]}).map(function(c){var u=[],d=[],f=[];return c.forEach(function(h){var v,p,g=h.element,m=h.elementRect.rect;if(m[o.end]<s)u.push(h);else if(l<m[o.start])d.push(h);else if(m[o.start]<=s&&l<=m[o.end]&&r){var x=h.pos,b={element:g,rect:_(_({},m),(v={},v[o.end]=m[o.start],v))},C={element:g,rect:_(_({},m),(p={},p[o.start]=m[o.end],p))},E=[0,0],S=[0,0];E[i]=x[i],E[a]=x[a],S[i]=x[i],S[a]=x[a]+h.size,u.push({type:t,pos:E,size:0,elementRect:b,direction:"",elementDirection:"end"}),d.push({type:t,pos:S,size:0,elementRect:C,direction:"",elementDirection:"start"})}}),u.sort(function(h,v){return v.pos[a]-h.pos[a]}),d.sort(function(h,v){return h.pos[a]-v.pos[a]}),{total:c,start:u,end:d,inner:f}})}function Kg(t,e,n,r,i){var a=t.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(s){var l=e.filter(function(g){return g.type===s}),c=s==="vertical"?1:0,u=c?0:1,d=Yg(s,l,r,a),f=c?Vn:jn,h=c?jn:Vn,v=r[f.start],p=r[f.end];d.forEach(function(g){var m=g.total,x=g.start,b=g.end,C=g.inner,E=n[u]+m[0].pos[u]-r[h.start],S=r;x.forEach(function(D){var M=D.elementRect.rect,w=S[f.start]-M[f.end];if(w>0){var T=[0,0];T[c]=n[c]+S[f.start]-v-w,T[u]=E,o.push(Si(t,s,"dashed",o.length,w,T,D.className,i))}S=M}),S=r,b.forEach(function(D){var M=D.elementRect.rect,w=M[f.start]-S[f.end];if(w>0){var T=[0,0];T[c]=n[c]+S[f.end]-v,T[u]=E,o.push(Si(t,s,"dashed",o.length,w,T,D.className,i))}S=M}),C.forEach(function(D){var M=D.elementRect.rect,w=v-M[f.start],T=M[f.end]-p,k=[0,0],O=[0,0];k[c]=n[c]-w,k[u]=E,O[c]=n[c]+p-v,O[u]=E,o.push(Si(t,s,"dashed",o.length,w,k,D.className,i)),o.push(Si(t,s,"dashed",o.length,T,O,D.className,i))})})}),o}function Xg(t,e,n,r,i){var a=[];return["horizontal","vertical"].forEach(function(o){var s=e.filter(function(g){return g.type===o}).slice(0,1),l=o==="vertical"?0:1,c=l?0:1,u=l?Vn:jn,d=l?jn:Vn,f=r[u.start],h=r[u.end],v=r[d.start],p=r[d.end];s.forEach(function(g){var m=g.gap,x=g.gapRects,b=Math.max.apply(Math,J([v],I(x.map(function(S){var D=S.rect;return D[d.start]})),!1)),C=Math.min.apply(Math,J([p],I(x.map(function(S){var D=S.rect;return D[d.end]})),!1)),E=(b+C)/2;b===C||E===(v+p)/2||x.forEach(function(S){var D=S.rect,M=S.className,w=[n[0],n[1]];if(D[u.end]<f)w[l]+=D[u.end]-f;else if(h<D[u.start])w[l]+=D[u.start]-f-m;else return;w[c]+=E-v,a.push(Si(t,l?"vertical":"horizontal","gap",a.length,m,w,M,i))})})}),a}function ws(t){var e,n,r=t.state,i=r.containerClientRect,a=r.hasFixed,o=i.overflow,s=i.scrollHeight,l=i.scrollWidth,c=i.clientHeight,u=i.clientWidth,d=i.clientLeft,f=i.clientTop,h=t.props,v=h.snapGap,p=v===void 0?!0:v,g=h.verticalGuidelines,m=h.horizontalGuidelines,x=h.snapThreshold,b=x===void 0?5:x,C=h.maxSnapElementGuidelineDistance,E=C===void 0?1/0:C,S=h.isDisplayGridGuidelines,D=Xe(Ze(t.state)),M=D.top,w=D.left,T=D.bottom,k=D.right,O={top:M,left:w,bottom:T,right:k,center:(w+k)/2,middle:(M+T)/2},R=qg(t),L=J([],I(R),!1),P=((n=(e=r.snapThresholdInfo)===null||e===void 0?void 0:e.multiples)!==null&&n!==void 0?n:[1,1]).map(function(G){return G*b});p&&L.push.apply(L,J([],I(Ug(t,O,P)),!1));var z=_({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(L.push.apply(L,J([],I(Qg(t,o?l:u,o?s:c,d,f,z,S)),!1)),a){var V=i.left,N=i.top;z.left+=V,z.top+=N,z.right+=V,z.bottom+=N}return L.push.apply(L,J([],I(Fu(m||!1,g||!1,o?l:u,o?s:c,d,f,z)),!1)),L=L.filter(function(G){var W=G.element,B=G.elementRect,q=G.type;if(!W||!B)return!0;var Z=B.rect;return ju(O,Z,q,E)}),L}function Ug(t,e,n){var r=t.props,i=r.maxSnapElementGuidelineDistance,a=i===void 0?1/0:i,o=r.maxSnapElementGapDistance,s=o===void 0?1/0:o,l=t.state.elementRects,c=[];return[["vertical",jn,Vn],["horizontal",Vn,jn]].forEach(function(u){var d=I(u,3),f=d[0],h=d[1],v=d[2],p=e[h.start],g=e[h.end],m=e[h.center],x=e[v.start],b=e[v.end],C={left:n[0],top:n[1]};function E(M){var w=M.rect,T=C[h.start];return w[h.end]<p+T?p-w[h.end]:g-T<w[h.start]?w[h.start]-g:-1}var S=l.filter(function(M){var w=M.rect;return w[v.start]>b||w[v.end]<x?!1:E(M)>0}).sort(function(M,w){return E(M)-E(w)}),D=[];S.forEach(function(M){S.forEach(function(w){if(M!==w){var T=M.rect,k=w.rect,O=T[v.start],R=T[v.end],L=k[v.start],P=k[v.end];O>P||L>R||D.push([M,w])}})}),D.forEach(function(M){var w=I(M,2),T=w[0],k=w[1],O=T.rect,R=k.rect,L=O[h.start],P=O[h.end],z=R[h.start],V=R[h.end],N=C[h.start],G=0,W=0,B=!1,q=!1,Z=!1;if(P<=p&&g<=z){if(q=!0,G=(z-P-(g-p))/2,W=P+G+(g-p)/2,Y(W-m)>N)return}else if(P<z&&V<p+N){if(B=!0,G=z-P,W=V+G,Y(W-p)>N)return}else if(P<z&&g-N<L){if(Z=!0,G=z-P,W=L-G,Y(W-g)>N)return}else return;G&&ju(e,R,f,a)&&(G>s||c.push({type:f,pos:f==="vertical"?[W,0]:[0,W],element:k.element,size:0,className:k.className,isStart:B,isCenter:q,isEnd:Z,gap:G,hide:!0,gapRects:[T,k],direction:"",elementDirection:""}))})}),c}function Zg(t,e,n,r){var i,a,o=t.props,s=t.state,l=o.snapGridAll,c=o.snapGridWidth,u=c===void 0?0:c,d=o.snapGridHeight,f=d===void 0?0:d,h=s.snapRenderInfo,v=h&&(((i=h.direction)===null||i===void 0?void 0:i[0])||((a=h.direction)===null||a===void 0?void 0:a[1])),p=t.moveables;if(l&&p&&v&&(u||f)){if(s.snapThresholdInfo)return;s.snapThresholdInfo={multiples:[1,1],offset:[0,0]};var g=t.getRect(),m=g.children,x=h.direction;if(m){var b=x.map(function(E,S){var D=S===0?{snapSize:u,posName:"left",sizeName:"width",clientOffset:r.left-e}:{snapSize:f,posName:"top",sizeName:"height",clientOffset:r.top-n},M=D.snapSize,w=D.posName,T=D.sizeName,k=D.clientOffset;if(!M)return{dir:E,multiple:1,snapSize:M,snapOffset:0};var O=g[T],R=g[w],L=Yl(m.map(function(B){return[B[w]-R,B[T],O-B[T]-B[w]+R]})).filter(function(B){return B}).sort(function(B,q){return B-q}),P=L[0],z=L.map(function(B){return Et(B/P,.1)*M}),V=1,N=Et(O/P,.1);for(V=1;V<=10&&!z.every(function(B){return B*V%1===0});++V);var G=(-E+1)/2,W=qi(R-k,R-k+O,G,1-G);return{multiple:N*V,dir:E,snapSize:M,snapOffset:Math.round(W/M)}}),C=b.map(function(E){return E.multiple||1});s.snapThresholdInfo.multiples=C,s.snapThresholdInfo.offset=b.map(function(E){return E.snapOffset}),b.forEach(function(E,S){E.snapSize})}}else s.snapThresholdInfo=null}function Qg(t,e,n,r,i,a,o){r===void 0&&(r=0),i===void 0&&(i=0);var s=t.props,l=t.state,c=s.snapGridWidth,u=c===void 0?0:c,d=s.snapGridHeight,f=d===void 0?0:d,h=[],v=a.left,p=a.top,g=[0,0];Zg(t,r,i,a);var m=l.snapThresholdInfo,x=u,b=f;if(m&&(u*=m.multiples[0]||1,f*=m.multiples[1]||1,g=m.offset),f){for(var C=function(S){h.push({type:"horizontal",pos:[v,Et(g[1]*b+S-i+p,.1)],className:ht("grid-guideline"),size:e,hide:!o,direction:"",grid:!0})},E=0;E<=n*2;E+=f)C(E);for(var E=-f;E>=-n;E-=f)C(E)}if(u){for(var C=function(D){h.push({type:"vertical",pos:[Et(g[0]*x+D-r+v,.1),p],className:ht("grid-guideline"),size:n,hide:!o,direction:"",grid:!0})},E=0;E<=e*2;E+=u)C(E);for(var E=-u;E>=-e;E-=u)C(E)}return h}function ju(t,e,n,r){return n==="horizontal"?Y(t.right-e.left)<=r||Y(t.left-e.right)<=r||t.left<=e.right&&e.left<=t.right:n==="vertical"?Y(t.bottom-e.top)<=r||Y(t.top-e.bottom)<=r||t.top<=e.bottom&&e.top<=t.bottom:!0}function qg(t){var e=t.state,n=t.props.elementGuidelines,r=n===void 0?[]:n;if(!r.length)return e.elementRects=[],[];var i=(e.elementRects||[]).filter(function(f){return!f.refresh}),a=r.map(function(f){return Te(f)&&"element"in f?_(_({},f),{element:xn(f.element,!0)}):{element:xn(f,!0)}}).filter(function(f){return f.element}),o=Rr(i.map(function(f){return f.element}),a.map(function(f){return f.element})),s=o.maintained,l=o.added,c=[];s.forEach(function(f){var h=I(f,2),v=h[0],p=h[1];c[p]=i[v]}),Jg(t,l.map(function(f){return a[f]})).map(function(f,h){c[l[h]]=f}),e.elementRects=c;var u=fs(t.props.elementSnapDirections),d=[];return c.forEach(function(f){var h=f.element,v=f.top,p=v===void 0?u.top:v,g=f.left,m=g===void 0?u.left:g,x=f.right,b=x===void 0?u.right:x,C=f.bottom,E=C===void 0?u.bottom:C,S=f.center,D=S===void 0?u.center:S,M=f.middle,w=M===void 0?u.middle:M,T=f.className,k=f.rect,O=hs({top:p,right:b,left:m,bottom:E,center:D,middle:w},k),R=O.horizontal,L=O.vertical,P=O.horizontalNames,z=O.verticalNames,V=k.top,N=k.left,G=k.right-N,W=k.bottom-V,B=[G,W];L.forEach(function(q,Z){d.push({type:"vertical",element:h,pos:[Et(q,.1),V],size:W,sizes:B,className:T,elementRect:f,elementDirection:mu[z[Z]]||z[Z],direction:""})}),R.forEach(function(q,Z){d.push({type:"horizontal",element:h,pos:[N,Et(q,.1)],size:G,sizes:B,className:T,elementRect:f,elementDirection:mu[P[Z]]||P[Z],direction:""})})}),d}function Vu(t,e){return t?t.map(function(n){var r=Te(n)?n:{pos:n},i=r.pos;return Tr(i)?r:_(_({},r),{pos:It(i,e)})}):[]}function Fu(t,e,n,r,i,a,o){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var s=[],l=o.left,c=o.top,u=o.bottom,d=o.right,f=n+d-l,h=r+u-c;return Vu(t,h).forEach(function(v){s.push({type:"horizontal",pos:[l,Et(v.pos-a+c,.1)],size:f,className:v.className,direction:""})}),Vu(e,f).forEach(function(v){s.push({type:"vertical",pos:[Et(v.pos-i+l,.1),c],size:h,className:v.className,direction:""})}),s}function Jg(t,e){if(!e.length)return[];var n=t.props.groupable,r=t.state,i=r.containerClientRect,a=r.rootMatrix,o=r.is3d,s=r.offsetDelta,l=o?4:3,c=I(Eg(a,i,l),2),u=c[0],d=c[1],f=n?0:s[0],h=n?0:s[1];return e.map(function(v){var p=v.element.getBoundingClientRect(),g=p.left-u-f,m=p.top-d-h,x=m+p.height,b=g+p.width,C=I($r(a,[g,m],l),2),E=C[0],S=C[1],D=I($r(a,[b,x],l),2),M=D[0],w=D[1];return _(_({},v),{rect:{left:E,right:M,top:S,bottom:w,center:(E+M)/2,middle:(S+w)/2}})})}function Pa(t){var e=t.state,n=e.container,r=t.props.snapContainer||n;if(e.snapContainer===r&&e.guidelines&&e.guidelines.length)return!1;var i=e.containerClientRect,a={left:0,top:0,bottom:0,right:0};if(n!==r){var o=xn(r,!0);if(o){var s=Ti(o),l=ld(e,[s.left-i.left,s.top-i.top]),c=ld(e,[s.right-i.right,s.bottom-i.bottom]);a.left=Et(l[0],1e-5),a.top=Et(l[1],1e-5),a.right=Et(c[0],1e-5),a.bottom=Et(c[1],1e-5)}}return e.snapContainer=r,e.snapOffset=a,e.guidelines=ws(t),e.enableSnap=!0,!0}function Gu(t,e,n,r,i,a){var o=lr(t,e,n,a?4:3),s=he(o,r);return As(o,pt(i,s))}function $u(t){return t?t/Y(t):0}function t0(t,e,n,r,i,a){var o=a.fixedDirection,s=Tg(n,o,r),l=gs(t,e,n,r),c=J(J([],I(jg(t,e,s,r,i,a)),!1),I(Au(t,l,a)),!1),u=Oa(c,0),d=Oa(c,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:d.isBound,offset:d.offset[1]}}}function e0(t,e,n,r,i,a,o,s,l){var c=he(e,o),u=_a(t,s,{vertical:[c[0]],horizontal:[c[1]]}),d=u.horizontal.offset,f=u.vertical.offset;if(Et(f,rs)||Et(d,rs)){var h=I(mn({datas:l,distX:-f,distY:-d}),2),v=h[0],p=h[1],g=Math.min(i||1/0,n+o[0]*v),m=Math.min(a||1/0,r+o[1]*p);return[g-n,m-r]}return[0,0]}function Wu(t,e,n,r,i,a,o,s){for(var l=Ze(t.state),c=t.props.keepRatio,u=0,d=0,f=0;f<2;++f){var h=e(u,d),v=t0(t,h,i,c,o,s),p=v.width,g=v.height,m=p.isBound,x=g.isBound,b=p.offset,C=g.offset;if(f===1&&(m||(b=0),x||(C=0)),f===0&&o&&!m&&!x)return[0,0];if(c){var E=Y(b)*(n?1/n:1),S=Y(C)*(r?1/r:1),D=m&&x?E<S:x||!m&&E<S;D?b=n*C/r:C=r*b/n}u+=b,d+=C}if(!c&&i[0]&&i[1]){var M=Fg(t,l,i,a,s),w=M.maxWidth,T=M.maxHeight,k=I(e0(t,e(u,d).map(function(L){return L.map(function(P){return Et(P,rs)})}),n+u,r+d,w,T,i,o,s),2),b=k[0],C=k[1];u+=b,d+=C}return[u,d]}function Ei(t){return t<0&&(t=t%360+360),t%=360,t}function n0(t,e){e=Ei(e);var n=Math.floor(t/360),r=n*360+360-e,i=n*360+e;return Y(t-r)<Y(t-i)?r:i}function Ds(t,e){t=Ei(t),e=Ei(e);var n=Ei(t-e);return Math.min(n,360-n)}function r0(t,e,n,r){var i,a=t.props,o=(i=a[xu])!==null&&i!==void 0?i:5,s=a[yu];if(Vr(t,"rotatable")){var l=e.pos1,c=e.pos2,u=e.pos3,d=e.pos4,f=e.origin,h=n*Math.PI/180,v=[l,c,u,d].map(function(C){return pt(C,f)}),p=v.map(function(C){return vi(C,h)}),g=J(J([],I(yg(t,v,p,f,n)),!1),I(_g(t,v,p,f,n)),!1);g.sort(function(C,E){return Y(C-n)-Y(E-n)});var m=g.length>0;if(m)return{isSnap:m,dist:m?g[0]:n}}if(s?.length&&o){var x=s.slice().sort(function(C,E){return Ds(C,r)-Ds(E,r)}),b=x[0];if(Ds(b,r)<=o)return{isSnap:!0,dist:n+n0(r,b)-r}}return{isSnap:!1,dist:n}}function i0(t,e,n,r,i,a,o){if(!Vr(t,"resizable"))return[0,0];var s=o.fixedDirection,l=o.nextAllMatrix,c=t.state,u=c.allMatrix,d=c.is3d;return Wu(t,function(f,h){return Gu(l||u,e+f,n+h,s,i,d)},e,n,r,i,a,o)}function a0(t,e,n,r,i){if(!Vr(t,"scalable"))return[0,0];var a=i.startOffsetWidth,o=i.startOffsetHeight,s=i.fixedPosition,l=i.fixedDirection,c=i.is3d,u=Wu(t,function(d,f){return Gu(ig(i,Ft(e,[d/a,f/o])),a,o,l,s,c)},a,o,n,s,r,i);return[u[0]/a,u[1]/o]}function o0(t,e){e.absolutePoses=Ze(t.state)}function Hu(t){var e=[];return t.forEach(function(n){n.guidelineInfos.forEach(function(r){var i=r.guideline;ze(e,function(a){return a.guideline===i})||(i.direction="",e.push({guideline:i,posInfo:n}))})}),e.map(function(n){var r=n.guideline,i=n.posInfo;return _(_({},r),{direction:i.direction})})}function Yu(t,e,n,r,i,a){var o=ds(Aa(t,a),e,n),s=o.vertical,l=o.horizontal,c=jr();s.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.left=!0),v.direction==="end"&&(c.right=!0),r.push({type:"bounds",pos:v.pos}))}),l.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.top=!0),v.direction==="end"&&(c.bottom=!0),i.push({type:"bounds",pos:v.pos}))});var u=Ig(t),d=u.boundMap,f=u.vertical,h=u.horizontal;return f.forEach(function(v){Mn(r,function(p){var g=p.type,m=p.pos;return g==="bounds"&&m===v})>=0||r.push({type:"bounds",pos:v})}),h.forEach(function(v){Mn(i,function(p){var g=p.type,m=p.pos;return g==="bounds"&&m===v})>=0||i.push({type:"bounds",pos:v})}),{boundMap:c,innerBoundMap:d}}var s0=Is("",["resizable","scalable"]),l0={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold","snapGridAll",xu,yu,bu,Cu,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,e){var n=t.state,r=n.top,i=n.left,a=n.pos1,o=n.pos2,s=n.pos3,l=n.pos4,c=n.snapRenderInfo,u=t.props.snapRenderThreshold,d=u===void 0?1:u;if(!c||!c.render||!Vr(t,""))return Wr(t,"boundMap",jr(),function(K){return JSON.stringify(K)}),Wr(t,"innerBoundMap",jr(),function(K){return JSON.stringify(K)}),[];n.guidelines=ws(t);var f=Math.min(a[0],o[0],s[0],l[0]),h=Math.min(a[1],o[1],s[1],l[1]),v=c.externalPoses||[],p=Ze(t.state),g=[],m=[],x=[],b=[],C=[],E=Xe(p),S=E.width,D=E.height,M=E.top,w=E.left,T=E.bottom,k=E.right,O={left:w,right:k,top:M,bottom:T,center:(w+k)/2,middle:(M+T)/2},R=v.length>0,L=R?Xe(v):{};if(!c.request){if(c.direction&&C.push(Mg(t,p,c.direction,d,d)),c.snap){var P=Xe(p);c.center&&(P.middle=(P.top+P.bottom)/2,P.center=(P.left+P.right)/2),C.push(Eu(t,P,d,d))}R&&(c.center&&(L.middle=(L.top+L.bottom)/2,L.center=(L.left+L.right)/2),C.push(Eu(t,L,d,d))),C.forEach(function(K){var X=K.vertical.posInfos,H=K.horizontal.posInfos;g.push.apply(g,J([],I(X.filter(function(et){var rt=et.guidelineInfos;return rt.some(function(mt){var vt=mt.guideline;return!vt.hide})}).map(function(et){return{type:"snap",pos:et.pos}})),!1)),m.push.apply(m,J([],I(H.filter(function(et){var rt=et.guidelineInfos;return rt.some(function(mt){var vt=mt.guideline;return!vt.hide})}).map(function(et){return{type:"snap",pos:et.pos}})),!1)),x.push.apply(x,J([],I(Hu(X)),!1)),b.push.apply(b,J([],I(Hu(H)),!1))})}var z=Yu(t,[w,k],[M,T],g,m),V=z.boundMap,N=z.innerBoundMap;R&&Yu(t,[L.left,L.right],[L.top,L.bottom],g,m,c.externalBounds);var G=J(J([],I(x),!1),I(b),!1),W=G.filter(function(K){return K.element&&!K.gapRects}),B=G.filter(function(K){return K.gapRects}).sort(function(K,X){return K.gap-X.gap});it(t,"onSnap",{guidelines:G.filter(function(K){var X=K.element;return!X}),elements:W,gaps:B},!0);var q=Wr(t,"boundMap",V,function(K){return JSON.stringify(K)},jr()),Z=Wr(t,"innerBoundMap",N,function(K){return JSON.stringify(K)},jr());return(V===q||N===Z)&&it(t,"onBound",{bounds:V,innerBounds:N},!0),J(J(J(J(J(J([],I(Kg(t,W,[f,h],O,e)),!1),I(Xg(t,B,[f,h],O,e)),!1),I(Bu(t,"horizontal",b,[i,r],O,e)),!1),I(Bu(t,"vertical",x,[i,r],O,e)),!1),I(Nu(t,"horizontal",m,f,r,S,0,e)),!1),I(Nu(t,"vertical",g,h,i,D,1,e)),!1)},dragStart:function(t,e){t.state.snapRenderInfo={request:e.isRequest,snap:!0,center:!0},Pa(t)},drag:function(t){var e=t.state;Pa(t)||(e.guidelines=ws(t)),e.snapRenderInfo&&(e.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,e){if(s0(t,e)||Ss(t,e))return!0;if(!e.isRequest&&e.inputEvent)return ce(e.inputEvent.target,ht("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,Pa(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,e){this.dragStart(t,e)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Pa(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var e=t.state;e.enableSnap=!1,e.guidelines=[],e.snapRenderInfo=null,e.elementRects=[]}};function c0(t,e){return[t[0]*e[0],t[1]*e[1]]}function ht(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return vv.apply(void 0,J([ns],I(t),!1))}function Ku(t){t()}function u0(t){return!t||t==="none"?[1,0,0,1,0,0]:Te(t)?t:er(t)}function wi(t,e,n){return ha(e,tr(n,e),t,tr(n.map(function(r){return-r}),e))}function d0(t,e,n){if(e==="%"){var r=Ts(t.ownerSVGElement);return r[n?"width":"height"]/100}return 1}function f0(t){var e=h0(Os(t,":before"));return e.map(function(n,r){var i=Zn(n),a=i.value,o=i.unit;return a*d0(t,o,r===0)})}function za(t){return t?t.split(" "):["0","0"]}function h0(t){return za(t.transformOrigin)}function Xu(t){var e=Ne(t),n=e("transform");if(n&&n!=="none")return n;if("transform"in t){var r=t.transform,i=r.baseVal;if(!i)return"";var a=i.length;if(!a)return"";for(var o=[],s=function(c){var u=i[c].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(d){return u[d]}).join(", "),")"))},l=0;l<a;++l)s(l);return o.join(" ")}return""}function Di(t,e,n,r,i){var a,o,s=xo(t)||Bn(t),l=!1,c,u;if(!t||n)c=t;else{var d=(a=t?.assignedSlot)===null||a===void 0?void 0:a.parentElement,f=t.parentElement;d?(l=!0,u=f,c=d):c=f}for(var h=!1,v=t===e||c===e,p="relative",g=1,m=parseFloat(i?.("zoom"))||1,x=i?.("position");c&&c!==s;){e===c&&(v=!0);var b=Ne(c),C=c.tagName.toLowerCase(),E=Xu(c),S=b("willChange"),D=parseFloat(b("zoom"))||1;if(p=b("position"),r&&D!==1){g=D;break}if(!n&&r&&m!==1&&x&&x!=="absolute"||C==="svg"||C==="foreignobject"||p!=="static"||E&&E!=="none"||S==="transform")break;var M=(o=t?.assignedSlot)===null||o===void 0?void 0:o.parentNode,w=c.parentNode;M&&(l=!0,u=w);var T=w;if(T&&T.nodeType===11){c=T.host,h=!0,p=Ne(c)("position");break}c=T,p="relative"}return{offsetZoom:g,hasSlot:l,parentSlotElement:u,isCustomElement:h,isStatic:p==="static",isEnd:v||!c||c===s,offsetParent:c||s}}function v0(t,e){var n,r=t.tagName.toLowerCase(),i=t.offsetLeft,a=t.offsetTop,o=Ne(t),s=Ji(i),l=!s,c,u;return!l&&(r!=="svg"||t.ownerSVGElement)?(c=Zc?f0(t):za(o("transformOrigin")).map(function(d){return parseFloat(d)}),u=c.slice(),l=!0,r==="svg"?(i=0,a=0):(n=I(m0(t,c,t===e&&e.tagName.toLowerCase()==="g"),4),i=n[0],a=n[1],c[0]=n[2],c[1]=n[3])):(c=za(o("transformOrigin")).map(function(d){return parseFloat(d)}),u=c.slice()),{tagName:r,isSVG:s,hasOffset:l,offset:[i||0,a||0],origin:c,targetOrigin:u}}function Uu(t,e){var n=Ne(t),r=Ne(Bn(t)),i=r("position");if(!e&&(!i||i==="static"))return[0,0];var a=parseInt(r("marginLeft"),10),o=parseInt(r("marginTop"),10);return n("position")==="absolute"&&((n("top")!=="auto"||n("bottom")!=="auto")&&(o=0),(n("left")!=="auto"||n("right")!=="auto")&&(a=0)),[a,o]}function Ms(t){t.forEach(function(e){var n=e.matrix;n&&(e.matrix=an(n,3,4))})}function p0(t){for(var e=t.parentElement,n=!1,r=Bn(t);e;){var i=Os(e).transform;if(i&&i!=="none"){n=!0;break}if(e===r)break;e=e.parentElement}return{fixedContainer:e||r,hasTransform:n}}function Na(t,e){return e===void 0&&(e=t.length>9),"".concat(e?"matrix3d":"matrix","(").concat($c(t,!e).join(","),")")}function Ts(t){var e=t.clientWidth,n=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:e,clientHeight:n};var r=t.viewBox,i=r&&r.baseVal||{x:0,y:0,width:0,height:0};return{x:i.x,y:i.y,width:i.width||e,height:i.height||n,clientWidth:e,clientHeight:n}}function g0(t,e){var n,r=Ts(t),i=r.width,a=r.height,o=r.clientWidth,s=r.clientHeight,l=o/i,c=s/a,u=t.preserveAspectRatio.baseVal,d=u.align,f=u.meetOrSlice,h=[0,0],v=[l,c],p=[0,0];if(d!==1){var g=(d-2)%3,m=Math.floor((d-2)/3);h[0]=i*g/2,h[1]=a*m/2;var x=f===2?Math.max(c,l):Math.min(l,c);v[0]=x,v[1]=x,p[0]=(o-i)/2*g,p[1]=(s-a)/2*m}var b=Go(v,e);return n=I(p,2),b[e*(e-1)]=n[0],b[e*(e-1)+1]=n[1],wi(b,e,h)}function m0(t,e,n){var r=t.tagName.toLowerCase();if(!t.getBBox||!n&&r==="g")return[0,0,0,0];var i=Ne(t),a=i("transform-box")==="fill-box",o=t.getBBox(),s=Ts(t.ownerSVGElement),l=o.x,c=o.y;r==="foreignobject"&&!l&&!c&&(l=parseFloat(t.getAttribute("x"))||0,c=parseFloat(t.getAttribute("y"))||0);var u=l-s.x,d=c-s.y,f=a?e[0]:e[0]-u,h=a?e[1]:e[1]-d;return[u,d,f,h]}function ae(t,e,n){return we(t,Jn(e,n),n)}function lr(t,e,n,r){return[[0,0],[e,0],[0,n],[e,n]].map(function(i){return ae(t,i,r)})}function Xe(t){var e=t.map(function(c){return c[0]}),n=t.map(function(c){return c[1]}),r=Math.min.apply(Math,J([],I(e),!1)),i=Math.min.apply(Math,J([],I(n),!1)),a=Math.max.apply(Math,J([],I(e),!1)),o=Math.max.apply(Math,J([],I(n),!1)),s=a-r,l=o-i;return{left:r,top:i,right:a,bottom:o,width:s,height:l}}function Zu(t,e,n,r){var i=lr(t,e,n,r);return Xe(i)}function x0(t,e,n,r,i){var a,o=t.target,s=t.origin,l=e.matrix,c=qu(o),u=c.offsetWidth,d=c.offsetHeight,f=n.getBoundingClientRect(),h=[0,0];n===Bn(n)&&(h=Uu(o,!0));for(var v=o.getBoundingClientRect(),p=v.left-f.left+n.scrollLeft-(n.clientLeft||0)+h[0],g=v.top-f.top+n.scrollTop-(n.clientTop||0)+h[1],m=v.width,x=v.height,b=ha(r,i,l),C=Zu(b,u,d,r),E=C.left,S=C.top,D=C.width,M=C.height,w=ae(b,s,r),T=pt(w,[E,S]),k=[p+T[0]*m/D,g+T[1]*x/M],O=[0,0],R=0;++R<10;){var L=rn(i,r);a=I(pt(ae(L,k,r),ae(L,w,r)),2),O[0]=a[0],O[1]=a[1];var P=ha(r,i,tr(O,r),l),z=Zu(P,u,d,r),V=z.left,N=z.top,G=V-p,W=N-g;if(Y(G)<2&&Y(W)<2)break;k[0]-=G,k[1]-=W}return O.map(function(B){return Math.round(B)})}function y0(t,e,n){var r=t.length===16,i=r?4:3,a=e.map(function(l){return ae(t,l,i)}),o=n.left,s=n.top;return a.map(function(l){return[l[0]+o,l[1]+s]})}function Ue(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Qu(t,e){return Ue([e[0]-t[0],e[1]-t[1]])}function Mi(t,e,n,r){n===void 0&&(n=1),r===void 0&&(r=se(t,e));var i=Qu(t,e);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(r,"rad) scaleY(").concat(n,")"),width:"".concat(i,"px")}}function Ba(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.length,a=n.reduce(function(s,l){return s+l[0]},0)/i,o=n.reduce(function(s,l){return s+l[1]},0)/i;return{transform:"translateZ(0px) translate(".concat(a,"px, ").concat(o,"px) rotate(").concat(t,"rad) scale(").concat(e,")")}}function cr(t,e){var n=t[e];return Te(n)?_(_({},t),n):t}function qu(t){var e=t&&!Ji(t.offsetWidth),n=0,r=0,i=0,a=0,o=0,s=0,l=0,c=0,u=0,d=0,f=0,h=0,v=1/0,p=1/0,g=1/0,m=1/0,x=0,b=0,C=!1;if(t)if(!e&&t.ownerSVGElement){var E=t.getBBox();C=!0,n=E.width,r=E.height,o=n,s=r,l=n,c=r,i=n,a=r}else{var S=Ne(t),D=t.style,M=S("boxSizing")==="border-box",w=parseFloat(S("borderLeftWidth"))||0,T=parseFloat(S("borderRightWidth"))||0,k=parseFloat(S("borderTopWidth"))||0,O=parseFloat(S("borderBottomWidth"))||0,R=parseFloat(S("paddingLeft"))||0,L=parseFloat(S("paddingRight"))||0,P=parseFloat(S("paddingTop"))||0,z=parseFloat(S("paddingBottom"))||0,V=R+L,N=P+z,G=w+T,W=k+O,B=V+G,q=N+W,Z=S("position"),K=0,X=0;if("clientLeft"in t){var H=null;if(Z==="absolute"){var et=Di(t,Bn(t));H=et.offsetParent}else H=t.parentElement;if(H){var rt=Ne(H);K=parseFloat(rt("width")),X=parseFloat(rt("height"))}}u=Math.max(V,It(S("minWidth"),K)||0),d=Math.max(N,It(S("minHeight"),X)||0),v=It(S("maxWidth"),K),p=It(S("maxHeight"),X),isNaN(v)&&(v=1/0),isNaN(p)&&(p=1/0),x=It(D.width,0)||0,b=It(D.height,0)||0,o=parseFloat(S("width"))||0,s=parseFloat(S("height"))||0,l=Y(o-x)<1?nn(u,x||o,v):o,c=Y(s-b)<1?nn(d,b||s,p):s,n=l,r=c,i=l,a=c,M?(g=v,m=p,f=u,h=d,l=n-B,c=r-q):(g=v+B,m=p+q,f=u+B,h=d+q,n=l+B,r=c+q),i=l+V,a=c+N}return{svg:C,offsetWidth:n,offsetHeight:r,clientWidth:i,clientHeight:a,contentWidth:l,contentHeight:c,inlineCSSWidth:x,inlineCSSHeight:b,cssWidth:o,cssHeight:s,minWidth:u,minHeight:d,maxWidth:v,maxHeight:p,minOffsetWidth:f,minOffsetHeight:h,maxOffsetWidth:g,maxOffsetHeight:m}}function Ju(t,e){return se(e>0?t[0]:t[1],e>0?t[1]:t[0])}function ja(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function td(t,e){var n=t===Bn(t)||t===xo(t),r={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return n&&(r.clientHeight=Math.max(e.height,r.clientHeight),r.scrollHeight=Math.max(e.height,r.scrollHeight)),r.overflow=Ne(t)("overflow")!=="visible",_(_({},e),r)}function ks(t,e,n,r){var i=t.left,a=t.right,o=t.top,s=t.bottom,l=e.top,c=e.left,u={left:c+i,top:l+o,right:c+a,bottom:l+s,width:a-i,height:s-o};return n&&r?td(n,u):u}function Ti(t,e){var n=0,r=0,i=0,a=0;if(t){var o=t.getBoundingClientRect();n=o.left,r=o.top,i=o.width,a=o.height}var s={left:n,top:r,width:i,height:a,right:n+i,bottom:r+a};return t&&e?td(t,s):s}function b0(t){var e=t.props,n=e.groupable,r=e.svgOrigin,i=t.getState(),a=i.offsetWidth,o=i.offsetHeight,s=i.svg,l=i.transformOrigin;return!n&&s&&r?Ns(r,a,o):l}function ed(t,e,n,r){var i;if(t)i=t;else if(e)i=[0,0];else{var a=n.target;i=nd(a,r)}return i}function nd(t,e){if(t){var n=t.getAttribute("data-rotation")||"",r=t.getAttribute("data-direction");if(e.deg=n,!!r){var i=[0,0];return r.indexOf("w")>-1&&(i[0]=-1),r.indexOf("e")>-1&&(i[0]=1),r.indexOf("n")>-1&&(i[1]=-1),r.indexOf("s")>-1&&(i[1]=1),i}}}function As(t,e){return[Ft(e,t[0]),Ft(e,t[1]),Ft(e,t[2]),Ft(e,t[3])]}function Ze(t){var e=t.left,n=t.top,r=t.pos1,i=t.pos2,a=t.pos3,o=t.pos4;return As([r,i,a,o],[e,n])}function Rs(t,e){t[e?"controlAbles":"targetAbles"].forEach(function(n){n.unset&&n.unset(t)})}function Fr(t,e){var n=e?"controlGesto":"targetGesto",r=t[n];r?.isIdle()===!1&&Rs(t,e),r?.unset(),t[n]=null}function Le(t,e){if(e){var n=zr(e);n.nextStyle=_(_({},n.nextStyle),t)}return{style:t,cssText:hn(t).map(function(r){return"".concat(na(r,"-"),": ").concat(t[r],";")}).join("")}}function rd(t,e,n){var r=e.afterTransform||e.transform;return _(_({},Le(_(_(_({},t.style),e.style),{transform:r}),n)),{afterTransform:r,transform:t.transform})}function At(t,e,n,r){var i=e.datas;i.datas||(i.datas={});var a=_(_({},n),{target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,moveable:t,datas:i.datas,isRequest:e.isRequest,isRequestChild:e.isRequestChild,isFirstDrag:!!e.isFirstDrag,isTrusted:e.isTrusted!==!1,stopAble:function(){i.isEventStart=!1},stopDrag:function(){var o;(o=e.stop)===null||o===void 0||o.call(e)}});return i.isStartEvent?r||(i.lastEvent=a):i.isStartEvent=!0,a}function $e(t,e,n){var r=e.datas,i="isDrag"in n?n.isDrag:e.isDrag;return r.datas||(r.datas={}),_(_({isDrag:i},n),{moveable:t,target:t.state.target,clientX:e.clientX,clientY:e.clientY,inputEvent:e.inputEvent,currentTarget:t,lastEvent:r.lastEvent,isDouble:e.isDouble,datas:r.datas,isFirstDrag:!!e.isFirstDrag})}function Va(t,e,n){t._emitter.on(e,n)}function it(t,e,n,r,i){return t.triggerEvent(e,n,r,i)}function Os(t,e){return Ee(t).getComputedStyle(t,e)}function Fa(t,e,n){var r={},i={};return t.filter(function(a){var o=a.name;if(r[o]||!e.some(function(s){return a[s]}))return!1;if(!n&&a.ableGroup){if(i[a.ableGroup])return!1;i[a.ableGroup]=!0}return r[o]=!0,!0})}function Ls(t,e){return t===e||t==null&&e==null}function id(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.length-1,r=0;r<n;++r){var i=t[r];if(!Ji(i))return i}return t[n]}function ad(t,e){var n=[],r=[];return t.forEach(function(i,a){var o=e(i,a,t),s=r.indexOf(o),l=n[s]||[];s===-1&&(r.push(o),n.push(l)),l.push(i)}),n}function C0(t,e){var n=[],r={};return t.forEach(function(i,a){var o=e(i,a,t),s=r[o];s||(s=[],r[o]=s,n.push(s)),s.push(i)}),n}function od(t){return t.reduce(function(e,n){return e.concat(n)},[])}function Gr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.sort(function(n,r){return Y(r)-Y(n)}),t[0]}function $r(t,e,n){return we(rn(t,n),Jn(e,n),n)}function sd(t,e){var n,r=t.is3d,i=t.rootMatrix,a=r?4:3;return n=I($r(i,[e.distX,e.distY],a),2),e.distX=n[0],e.distY=n[1],e}function Qe(t,e,n,r){if(!n[0]&&!n[1])return e;var i=ae(t,[$u(n[0]||1),0],r),a=ae(t,[0,$u(n[1]||1)],r),o=ae(t,[n[0]/Ue(i),n[1]/Ue(a)],r);return Ft(e,o)}function sn(t,e,n){return n?"".concat(t/e*100,"%"):"".concat(t,"px")}function Ga(t){return Y(t)<=Re?0:t}function _s(t){return function(e){if(!e.isDragging(t))return"";var n=dg(e,t),r=n.deg;return r?ht("view-control-rotation".concat(r)):""}}function Is(t,e){return e===void 0&&(e=[t]),function(n,r){if(r.isRequest)return e.some(function(a){return r.requestAble===a})?r.parentDirection:!1;var i=r.inputEvent.target;return ce(i,ht("direction"))&&(!t||ce(i,ht(t)))}}function S0(t,e,n){var r,i=Ar(t,{"x%":function(E){return E/100*e.offsetWidth},"y%":function(E){return E/100*e.offsetHeight}}),a=t.slice(0,n<0?void 0:n),o=t.slice(0,n<0?void 0:n+1),s=t[n]||"",l=n<0?[]:t.slice(n),c=n<0?[]:t.slice(n+1),u=i.slice(0,n<0?void 0:n),d=i.slice(0,n<0?void 0:n+1),f=(r=i[n])!==null&&r!==void 0?r:Ar([""])[0],h=n<0?[]:i.slice(n),v=n<0?[]:i.slice(n+1),p=f?[f]:[],g=kr(u),m=kr(d),x=kr(h),b=kr(v),C=Qt(g,x,4);return{transforms:t,beforeFunctionMatrix:g,beforeFunctionMatrix2:m,targetFunctionMatrix:kr(p),afterFunctionMatrix:x,afterFunctionMatrix2:b,allFunctionMatrix:C,beforeFunctions:u,beforeFunctions2:d,targetFunction:p[0],afterFunctions:h,afterFunctions2:v,beforeFunctionTexts:a,beforeFunctionTexts2:o,targetFunctionText:s,afterFunctionTexts:l,afterFunctionTexts2:c}}function E0(t){return!t||!Te(t)||pn(t)?!1:qt(t)||"length"in t}function xn(t,e){return t?pn(t)?t:ye(t)?e?document.querySelector(t):t:ta(t)?t():Zl(t)?t:"current"in t?t.current:t:null}function Ps(t,e){if(!t)return[];var n=E0(t)?[].slice.call(t):[t];return n.reduce(function(r,i){return ye(i)&&e?J(J([],I(r),!1),I([].slice.call(document.querySelectorAll(i))),!1):(qt(i)?r.push(Ps(i,e)):r.push(xn(i,e)),r)},[])}function w0(t,e,n){var r=se(t,e)/Math.PI*180;return r=n>=0?r:180-r,r=r>=0?r:360+r,r}function ld(t,e){var n=t.rootMatrix,r=t.is3d,i=r?4:3,a=rn(n,i);return r||(a=an(a,3,4)),a[12]=0,a[13]=0,a[14]=0,pa(a,e)}function cd(t,e,n,r,i){var a=I(t,2),o=a[0],s=a[1],l=0,c=0;if(i&&o&&s){var u=se([0,0],e),d=se([0,0],r),f=Ue(e),h=Math.cos(u-d)*f;if(!r[0])c=h,l=c*n;else if(!r[1])l=h,c=l/n;else{var v=r[0]*o,p=r[1]*s,g=Math.atan2(v+e[0],p+e[1]),m=Math.atan2(v,p);g<0&&(g+=Math.PI*2),m<0&&(m+=Math.PI*2);var x=0;Y(g-m)<Math.PI/2||Y(g-m)>Math.PI/2*3||(m+=Math.PI),x=g-m,x>Math.PI*2?x-=Math.PI*2:x>Math.PI?x=2*Math.PI-x:x<-Math.PI&&(x=-2*Math.PI-x);var b=Ue([v+e[0],p+e[1]])*Math.cos(x);l=b*Math.sin(m)-v,c=b*Math.cos(m)-p,r[0]<0&&(l*=-1),r[1]<0&&(c*=-1)}}else l=r[0]*e[0],c=r[1]*e[1];return[l,c]}function ud(t,e,n,r){var i,a=n.ratio,o=n.startOffsetWidth,s=n.startOffsetHeight,l=0,c=0,u=r.distX,d=r.distY,f=r.pinchScale,h=r.parentDistance,v=r.parentDist,p=r.parentScale,g=n.fixedDirection,m=[0,1].map(function(D){return Y(t[D]-g[D])}),x=[0,1].map(function(D){var M=m[D];return M!==0&&(M=2/M),M});if(v)l=v[0],c=v[1],e&&(l?c||(c=l/a):l=c*a);else if(Tr(f))l=(f-1)*o,c=(f-1)*s;else if(p)l=(p[0]-1)*o,c=(p[1]-1)*s;else if(h){var b=o*m[0],C=s*m[1],E=Ue([b,C]);l=h/E*b*x[0],c=h/E*C*x[1]}else{var S=mn({datas:n,distX:u,distY:d});S=x.map(function(D,M){return S[M]*D}),i=I(cd([o,s],S,a,t,e),2),l=i[0],c=i[1]}return{distWidth:l,distHeight:c}}function zs(t,e){if(e){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var n=I(t.split(" "),2),r=n[0],i=n[1],a=zs(r||""),o=zs(i||""),s=_(_({},a),o),l={x:"50%",y:"50%"};return s.x&&(l.x=s.x),s.y&&(l.y=s.y),s.value&&(s.x&&!s.y&&(l.y=s.value),!s.x&&s.y&&(l.x=s.value)),l}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function Ns(t,e,n){var r=zs(t,!0),i=r.x,a=r.y;return[It(i,e)||0,It(a,n)||0]}function D0(t,e,n){var r=t.map(function(a){return pt(a,e)}),i=r.map(function(a){return vi(a,n)});return{prev:r,next:i,result:i.map(function(a){return Ft(a,e)})}}function dd(t,e){return t.length===e.length&&t.every(function(n,r){var i=e[r],a=qt(n),o=qt(i);return a&&o?dd(n,i):!a&&!o?n===i:!1})}function Wr(t,e,n,r,i){var a=t._store,o=a[e];if(!(e in a))if(i!=null)a[e]=i,o=i;else return a[e]=n,n;return o===n||r(o)===r(n)?o:(a[e]=n,n)}function _e(t){return t>=0?1:-1}function Y(t){return Math.abs(t)}function Bs(t,e){return nv(t).map(function(n){return e(n)})}function fd(t){return Tr(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var M0=xi("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,e){var n=e.datas,r=e.targets,i=e.angle,a=e.originalDatas,o=t.props,s=o.pinchable,l=o.ables;if(!s)return!1;var c="onPinch".concat(r?"Group":"","Start"),u="drag".concat(r?"Group":"","ControlStart"),d=(s===!0?t.controlAbles:l.filter(function(p){return s.indexOf(p.name)>-1})).filter(function(p){return p.canPinch&&p[u]}),f=At(t,e,{});r&&(f.targets=r);var h=it(t,c,f);n.isPinch=h!==!1,n.ables=d;var v=n.isPinch;return v?(d.forEach(function(p){if(a[p.name]=a[p.name]||{},!!p[u]){var g=_(_({},e),{datas:a[p.name],parentRotate:i,isPinch:!0});p[u](t,g)}}),t.state.snapRenderInfo={request:e.isRequest,direction:[0,0]},v):!1},pinch:function(t,e){var n=e.datas,r=e.scale,i=e.distance,a=e.originalDatas,o=e.inputEvent,s=e.targets,l=e.angle;if(n.isPinch){var c=i*(1-1/r),u=At(t,e,{});s&&(u.targets=s);var d="onPinch".concat(s?"Group":"");it(t,d,u);var f=n.ables,h="drag".concat(s?"Group":"","Control");return f.forEach(function(v){v[h]&&v[h](t,_(_({},e),{datas:a[v.name],inputEvent:o,resolveMatrix:!0,pinchScale:r,parentDistance:c,parentRotate:l,isPinch:!0}))}),u}},pinchEnd:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.targets,o=e.originalDatas;if(n.isPinch){var s="onPinch".concat(a?"Group":"","End"),l=$e(t,e,{isDrag:r});a&&(l.targets=a),it(t,s,l);var c=n.ables,u="drag".concat(a?"Group":"","ControlEnd");return c.forEach(function(d){d[u]&&d[u](t,_(_({},e),{isDrag:r,datas:o[d.name],inputEvent:i,isPinch:!0}))}),r}},pinchGroupStart:function(t,e){return this.pinchStart(t,_(_({},e),{targets:t.props.targets}))},pinchGroup:function(t,e){return this.pinch(t,_(_({},e),{targets:t.props.targets}))},pinchGroupEnd:function(t,e){return this.pinchEnd(t,_(_({},e),{targets:t.props.targets}))}}),hd=Is("scalable"),T0={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:fu("scalable"),dragControlCondition:hd,viewClassName:_s("scalable"),dragControlStart:function(t,e){var n=e.datas,r=e.isPinch,i=e.inputEvent,a=e.parentDirection,o=ed(a,r,i,n),s=t.state,l=s.width,c=s.height,u=s.targetTransform,d=s.target,f=s.pos1,h=s.pos2,v=s.pos4;if(!o||!d)return!1;r||ar(t,e),n.datas={},n.transform=u,n.prevDist=[1,1],n.direction=o,n.startOffsetWidth=l,n.startOffsetHeight=c,n.startValue=[1,1];var p=!o[0]&&!o[1]||o[0]||!o[1];wa(t,e,"scale"),n.isWidth=p;function g(S){n.ratio=S&&isFinite(S)?S:0}n.startPositions=Ze(t.state);function m(S){var D=_u(n.startPositions,S);n.fixedDirection=D.fixedDirection,n.fixedPosition=D.fixedPosition,n.fixedOffset=D.fixedOffset}n.setFixedDirection=m,g(vn(f,h)/vn(h,v)),m([-o[0],-o[1]]);var x=function(S){n.minScaleSize=S},b=function(S){n.maxScaleSize=S};x([-1/0,-1/0]),b([1/0,1/0]);var C=At(t,e,_(_({direction:o,set:function(S){n.startValue=S},setRatio:g,setFixedDirection:m,setMinScaleSize:x,setMaxScaleSize:b},Ea(t,e)),{dragStart:Oe.dragStart(t,new Ir().dragStart([0,0],e))})),E=it(t,"onScaleStart",C);return n.startFixedDirection=n.fixedDirection,E!==!1&&(n.isScale=!0,t.state.snapRenderInfo={request:e.isRequest,direction:o}),n.isScale?C:!1},dragControl:function(t,e){Ca(t,e,"scale");var n=e.datas,r=e.parentKeepRatio,i=e.parentFlag,a=e.isPinch,o=e.dragClient,s=e.isRequest,l=e.useSnap,c=e.resolveMatrix,u=n.prevDist,d=n.direction,f=n.startOffsetWidth,h=n.startOffsetHeight,v=n.isScale,p=n.startValue,g=n.isWidth,m=n.ratio;if(!v)return!1;var x=t.props,b=x.throttleScale,C=x.parentMoveable,E=d;!d[0]&&!d[1]&&(E=[1,1]);var S=m&&(r??x.keepRatio)||!1,D=t.state,M=[p[0],p[1]];function w(){var U=ud(E,S,n,e),nt=U.distWidth,Rt=U.distHeight,ut=f?(f+nt)/f:1,dt=h?(h+Rt)/h:1;p[0]||(M[0]=nt/f),p[1]||(M[1]=Rt/h);var yt=(E[0]||S?ut:1)*M[0],Ot=(E[1]||S?dt:1)*M[1];return yt===0&&(yt=_e(u[0])*ba),Ot===0&&(Ot=_e(u[1])*ba),[yt,Ot]}var T=w();if(!a&&t.props.groupable){var k=D.snapRenderInfo||{},O=k.direction;qt(O)&&(O[0]||O[1])&&(D.snapRenderInfo={direction:d,request:e.isRequest})}it(t,"onBeforeScale",At(t,e,{scale:T,setFixedDirection:function(U){return n.setFixedDirection(U),T=w(),T},startFixedDirection:n.startFixedDirection,setScale:function(U){T=U}},!0));var R=[T[0]/M[0],T[1]/M[1]],L=o,P=[0,0],z=_e(R[0]*R[1]),V=!o&&!i&&a;if(V||c?L=cs(t,n.targetAllTransform,[0,0],[0,0],n):o||(L=n.fixedPosition),a||(P=a0(t,R,d,!l&&s,n)),S){E[0]&&E[1]&&P[0]&&P[1]&&(Math.abs(P[0]*f)>Math.abs(P[1]*h)?P[1]=0:P[0]=0);var N=!P[0]&&!P[1];if(N&&(g?R[0]=Et(R[0]*M[0],b)/M[0]:R[1]=Et(R[1]*M[1],b)/M[1]),E[0]&&!E[1]||P[0]&&!P[1]||N&&g){R[0]+=P[0];var G=f*R[0]*M[0]/m;R[1]=_e(z*R[0])*Y(G/h/M[1])}else if(!E[0]&&E[1]||!P[0]&&P[1]||N&&!g){R[1]+=P[1];var W=h*R[1]*M[1]*m;R[0]=_e(z*R[1])*Y(W/f/M[0])}}else R[0]+=P[0],R[1]+=P[1],P[0]||(R[0]=Et(R[0]*M[0],b)/M[0]),P[1]||(R[1]=Et(R[1]*M[1],b)/M[1]);R[0]===0&&(R[0]=_e(u[0])*ba),R[1]===0&&(R[1]=_e(u[1])*ba),T=c0(R,[M[0],M[1]]);var B=[f,h],q=[f*T[0],h*T[1]];q=go(q,n.minScaleSize,n.maxScaleSize,S?m:!1),T=Bs(2,function(U){return B[U]?q[U]/B[U]:q[U]}),R=Bs(2,function(U){return T[U]/M[U]});var Z=Bs(2,function(U){return u[U]?R[U]/u[U]:R[U]}),K="scale(".concat(R.join(", "),")"),X="scale(".concat(T.join(", "),")"),H=Sa(n,X,K),et=!p[0]||!p[1],rt=ag(t,et?X:K,n.fixedDirection,L,n.fixedOffset,n,et),mt=V?rt:pt(rt,n.prevInverseDist||[0,0]);if(n.prevDist=R,n.prevInverseDist=rt,T[0]===u[0]&&T[1]===u[1]&&mt.every(function(U){return!U})&&!C&&!V)return!1;var vt=At(t,e,_({offsetWidth:f,offsetHeight:h,direction:d,scale:T,dist:R,delta:Z,isPinch:!!a},ou(t,H,mt,a,e)));return it(t,"onScale",vt),vt},dragControlEnd:function(t,e){var n=e.datas;if(!n.isScale)return!1;n.isScale=!1;var r=$e(t,e,{});return it(t,"onScaleEnd",r),r},dragGroupControlCondition:hd,dragGroupControlStart:function(t,e){var n=e.datas,r=this.dragControlStart(t,e);if(!r)return!1;var i=on(t,"resizable",e);n.moveableScale=t.scale;var a=An(t,this,"dragControlStart",e,function(c,u){return ka(t,c,n,u)}),o=function(c){r.setFixedDirection(c),a.forEach(function(u,d){u.setFixedDirection(c),ka(t,u.moveable,n,i[d])})};n.setFixedDirection=o;var s=_(_({},r),{targets:t.props.targets,events:a,setFixedDirection:o}),l=it(t,"onScaleGroupStart",s);return n.isScale=l!==!1,n.isScale?s:!1},dragGroupControl:function(t,e){var n=e.datas;if(n.isScale){Va(t,"onBeforeScale",function(u){it(t,"onBeforeScaleGroup",At(t,e,_(_({},u),{targets:t.props.targets}),!0))});var r=this.dragControl(t,e);if(r){var i=r.dist,a=n.moveableScale;t.scale=[i[0]*a[0],i[1]*a[1]];var o=t.props.keepRatio,s=n.fixedPosition,l=An(t,this,"dragControl",e,function(u,d){var f=I(we(pi(t.rotation/180*Math.PI,3),[d.datas.originalX*i[0],d.datas.originalY*i[1],1],3),2),h=f[0],v=f[1];return _(_({},d),{parentDist:null,parentScale:i,parentKeepRatio:o,dragClient:Ft(s,[h,v])})}),c=_({targets:t.props.targets,events:l},r);return it(t,"onScaleGroup",c),c}}},dragGroupControlEnd:function(t,e){var n=e.isDrag,r=e.datas;if(r.isScale){this.dragControlEnd(t,e);var i=An(t,this,"dragControlEnd",e),a=$e(t,e,{targets:t.props.targets,events:i});return it(t,"onScaleGroupEnd",a),n}},request:function(){var t={},e=0,n=0,r=!1;return{isControl:!0,requestStart:function(i){return r=i.useSnap,{datas:t,parentDirection:i.direction||[1,1],useSnap:r}},request:function(i){return e+=i.deltaWidth,n+=i.deltaHeight,{datas:t,parentDist:[e,n],parentKeepRatio:i.keepRatio,useSnap:r}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:r}}}}};function $n(t,e){return t.map(function(n,r){return qi(n,e[r],1,2)})}function vd(t,e,n){var r=se(t,e),i=se(t,n),a=i-r;return a>=0?a:a+2*Math.PI}function k0(t,e){var n=vd(t[0],t[1],t[2]),r=vd(e[0],e[1],e[2]),i=Math.PI;return!(n>=i&&r<=i||n<=i&&r>=i)}var A0={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:_s("warpable"),render:function(t,e){var n=t.props,r=n.resizable,i=n.scalable,a=n.warpable,o=n.zoom;if(r||i||!a)return[];var s=t.state,l=s.pos1,c=s.pos2,u=s.pos3,d=s.pos4,f=$n(l,c),h=$n(c,l),v=$n(l,u),p=$n(u,l),g=$n(u,d),m=$n(d,u),x=$n(c,d),b=$n(d,c);return J([e.createElement("div",{className:ht("line"),key:"middeLine1",style:Mi(f,g,o)}),e.createElement("div",{className:ht("line"),key:"middeLine2",style:Mi(h,m,o)}),e.createElement("div",{className:ht("line"),key:"middeLine3",style:Mi(v,x,o)}),e.createElement("div",{className:ht("line"),key:"middeLine4",style:Mi(p,b,o)})],I(hu(t,"warpable",e)),!1)},dragControlCondition:function(t,e){if(e.isRequest)return!1;var n=e.inputEvent.target;return ce(n,ht("direction"))&&ce(n,ht("warpable"))},dragControlStart:function(t,e){var n=e.datas,r=e.inputEvent,i=t.props.target,a=r.target,o=nd(a,n);if(!o||!i)return!1;var s=t.state,l=s.transformOrigin,c=s.is3d,u=s.targetTransform,d=s.targetMatrix,f=s.width,h=s.height,v=s.left,p=s.top;n.datas={},n.targetTransform=u,n.warpTargetMatrix=c?d:an(d,3,4),n.targetInverseMatrix=Fc(rn(n.warpTargetMatrix,4),3,4),n.direction=o,n.left=v,n.top=p,n.poses=[[0,0],[f,0],[0,h],[f,h]].map(function(x){return pt(x,l)}),n.nextPoses=n.poses.map(function(x){var b=I(x,2),C=b[0],E=b[1];return we(n.warpTargetMatrix,[C,E,0,1],4)}),n.startValue=ee(4),n.prevMatrix=ee(4),n.absolutePoses=Ze(s),n.posIndexes=au(o),ar(t,e),wa(t,e,"matrix3d"),s.snapRenderInfo={request:e.isRequest,direction:o};var g=At(t,e,_({set:function(x){n.startValue=x}},Ea(t,e))),m=it(t,"onWarpStart",g);return m!==!1&&(n.isWarp=!0),n.isWarp},dragControl:function(t,e){var n=e.datas,r=e.isRequest,i=e.distX,a=e.distY,o=n.targetInverseMatrix,s=n.prevMatrix,l=n.isWarp,c=n.startValue,u=n.poses,d=n.posIndexes,f=n.absolutePoses;if(!l)return!1;if(Ca(t,e,"matrix3d"),Vr(t,"warpable")){var h=d.map(function(w){return f[w]});h.length>1&&h.push([(h[0][0]+h[1][0])/2,(h[0][1]+h[1][1])/2]);var v=_a(t,r,{horizontal:h.map(function(w){return w[1]+a}),vertical:h.map(function(w){return w[0]+i})}),p=v.horizontal,g=v.vertical;a-=p.offset,i-=g.offset}var m=mn({datas:n,distX:i,distY:a},!0),x=n.nextPoses.slice();if(d.forEach(function(w){x[w]=Ft(x[w],m)}),!Up.every(function(w){return k0(w.map(function(T){return u[T]}),w.map(function(T){return x[T]}))}))return!1;var b=$o(u[0],u[2],u[1],u[3],x[0],x[2],x[1],x[3]);if(!b.length)return!1;var C=Qt(o,b,4),E=ru(n,C,!0),S=Qt(rn(s,4),E,4);n.prevMatrix=E;var D=Qt(c,E,4),M=Sa(n,"matrix3d(".concat(D.join(", "),")"),"matrix3d(".concat(E.join(", "),")"));return ls(e,M),it(t,"onWarp",At(t,e,_({delta:S,matrix:D,dist:E,multiply:Qt,transform:M},Le({transform:M},e)))),!0},dragControlEnd:function(t,e){var n=e.datas,r=e.isDrag;return n.isWarp?(n.isWarp=!1,it(t,"onWarpEnd",$e(t,e,{})),r):!1}},R0=ht("area-pieces"),$a=ht("area-piece"),pd=ht("avoid"),O0=ht("view-dragging");function js(t){var e=t.areaElement;if(e){var n=t.state,r=n.width,i=n.height;Ul(e,pd),e.style.cssText+="left: 0px; top: 0px; width: ".concat(r,"px; height: ").concat(i,"px")}}function gd(t){return t.createElement("div",{key:"area_pieces",className:R0},t.createElement("div",{className:$a}),t.createElement("div",{className:$a}),t.createElement("div",{className:$a}),t.createElement("div",{className:$a}))}var md={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,e){var n=t.props,r=n.target,i=n.dragArea,a=n.groupable,o=n.passDragArea,s=t.getState(),l=s.width,c=s.height,u=s.renderPoses,d=o?ht("area","pass"):ht("area");if(a)return[e.createElement("div",{key:"area",ref:kn(t,"areaElement"),className:d}),gd(e)];if(!r||!i)return[];var f=$o([0,0],[l,0],[0,c],[l,c],u[0],u[1],u[2],u[3]),h=f.length?Na(f,!0):"none";return[e.createElement("div",{key:"area",ref:kn(t,"areaElement"),className:d,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(c,"px"),transformOrigin:"0 0",transform:h}}),gd(e)]},dragStart:function(t,e){var n=e.datas,r=e.clientX,i=e.clientY,a=e.inputEvent;if(!a)return!1;n.isDragArea=!1;var o=t.areaElement,s=t.state,l=s.moveableClientRect,c=s.renderPoses,u=s.rootMatrix,d=s.is3d,f=l.left,h=l.top,v=Xe(c),p=v.left,g=v.top,m=v.width,x=v.height,b=d?4:3,C=I($r(u,[r-f,i-h],b),2),E=C[0],S=C[1];E-=p,S-=g;var D=[{left:p,top:g,width:m,height:S-10},{left:p,top:g,width:E-10,height:x},{left:p,top:g+S+10,width:m,height:x-S-10},{left:p+E+10,top:g,width:m-E-10,height:x}],M=[].slice.call(o.nextElementSibling.children);D.forEach(function(w,T){M[T].style.cssText="left: ".concat(w.left,"px;top: ").concat(w.top,"px; width: ").concat(w.width,"px; height: ").concat(w.height,"px;")}),Tn(o,pd),s.disableNativeEvent=!0},drag:function(t,e){var n=e.datas,r=e.inputEvent;if(this.enableNativeEvent(t),!r)return!1;n.isDragArea||(n.isDragArea=!0,js(t))},dragEnd:function(t,e){this.enableNativeEvent(t);var n=e.inputEvent,r=e.datas;if(!n)return!1;r.isDragArea||js(t)},dragGroupStart:function(t,e){return this.dragStart(t,e)},dragGroup:function(t,e){return this.drag(t,e)},dragGroupEnd:function(t,e){return this.dragEnd(t,e)},unset:function(t){js(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var e=t.state;e.disableNativeEvent&&Gl(function(){e.disableNativeEvent=!1})}},L0=xi("origin",{props:["origin","svgOrigin"],render:function(t,e){var n=t.props,r=n.zoom,i=n.svgOrigin,a=n.groupable,o=t.getState(),s=o.beforeOrigin,l=o.rotation,c=o.svg,u=o.allMatrix,d=o.is3d,f=o.left,h=o.top,v=o.offsetWidth,p=o.offsetHeight,g;if(!a&&c&&i){var m=I(Ns(i,v,p),2),x=m[0],b=m[1],C=d?4:3,E=ae(u,[x,b],C);g=Ba(l,r,pt(E,[f,h]))}else g=Ba(l,r,s);return[e.createElement("div",{className:ht("control","origin"),style:g,key:"beforeOrigin"})]}});function _0(t){var e=t.scrollContainer;return[e.scrollLeft,e.scrollTop]}var I0={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,e){var n=t.props,r=n.scrollContainer,i=r===void 0?t.getContainer():r,a=n.scrollOptions,o=new Kc,s=xn(i,!0);e.datas.dragScroll=o,t.state.dragScroll=o;var l=e.isControl?"controlGesto":"targetGesto",c=e.targets;o.on("scroll",function(u){var d=u.container,f=u.direction,h=At(t,e,{scrollContainer:d,direction:f}),v=c?"onScrollGroup":"onScroll";c&&(h.targets=c),it(t,v,h)}).on("move",function(u){var d=u.offsetX,f=u.offsetY,h=u.inputEvent;t[l].scrollBy(d,f,h.inputEvent,!1)}).on("scrollDrag",function(u){var d=u.next;d(t[l].getCurrentEvent())}),o.dragStart(e,_({container:s},a))},checkScroll:function(t,e){var n=e.datas.dragScroll;if(n){var r=t.props,i=r.scrollContainer,a=i===void 0?t.getContainer():i,o=r.scrollThreshold,s=o===void 0?0:o,l=r.scrollThrottleTime,c=l===void 0?0:l,u=r.getScrollPosition,d=u===void 0?_0:u,f=r.scrollOptions;return n.drag(e,_({container:a,threshold:s,throttleTime:c,getScrollPosition:function(h){return d({scrollContainer:h.container,direction:h.direction})}},f)),!0}},drag:function(t,e){return this.checkScroll(t,e)},dragEnd:function(t,e){e.datas.dragScroll.dragEnd(),e.datas.dragScroll=null},dragControlStart:function(t,e){return this.dragStart(t,_(_({},e),{isControl:!0}))},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupStart:function(t,e){return this.dragStart(t,_(_({},e),{targets:t.props.targets}))},dragGroup:function(t,e){return this.drag(t,_(_({},e),{targets:t.props.targets}))},dragGroupEnd:function(t,e){return this.dragEnd(t,_(_({},e),{targets:t.props.targets}))},dragGroupControlStart:function(t,e){return this.dragStart(t,_(_({},e),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,e){return this.drag(t,_(_({},e),{targets:t.props.targets}))},dragGroupControEnd:function(t,e){return this.dragEnd(t,_(_({},e),{targets:t.props.targets}))},unset:function(t){var e,n=t.state;(e=n.dragScroll)===null||e===void 0||e.dragEnd(),n.dragScroll=null}},xd={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","preventRightClick","preventWheelClick","requestStyles"],events:["changeTargets"]},P0=xi("padding",{props:["padding"],render:function(t,e){var n=t.props;if(n.dragArea)return[];var r=fd(n.padding||{}),i=r.left,a=r.top,o=r.right,s=r.bottom,l=t.getState(),c=l.renderPoses,u=l.pos1,d=l.pos2,f=l.pos3,h=l.pos4,v=[u,d,f,h],p=[];return i>0&&p.push([0,2]),a>0&&p.push([0,1]),o>0&&p.push([1,3]),s>0&&p.push([2,3]),p.map(function(g,m){var x=I(g,2),b=x[0],C=x[1],E=v[b],S=v[C],D=c[b],M=c[C],w=$o([0,0],[100,0],[0,100],[100,100],E,S,D,M);if(w.length)return e.createElement("div",{key:"padding".concat(m),className:ht("padding"),style:{transform:Na(w,!0)}})})}}),yd=["nw","ne","se","sw"];function Wa(t,e){var n=t[0]+t[1],r=n>e?e/n:1;return t[0]*=r,t[1]=e-t[1]*r,t}var z0=[1,2,5,6],N0=[0,3,4,7],ur=[1,-1,-1,1],dr=[1,1,-1,-1];function Vs(t,e,n,r,i,a,o,s){i===void 0&&(i=0),a===void 0&&(a=0),o===void 0&&(o=n),s===void 0&&(s=r);var l=[],c=!1,u=t.filter(function(f){return!f.virtual}),d=u.map(function(f){var h=f.horizontal,v=f.vertical,p=f.pos;if(v&&!c&&(c=!0,l.push("/")),c){var g=Math.max(0,v===1?p[1]-a:s-p[1]);return l.push(sn(g,r,e)),g}else{var g=Math.max(0,h===1?p[0]-i:o-p[0]);return l.push(sn(g,n,e)),g}});return{radiusPoses:u,styles:l,raws:d}}function bd(t){for(var e=[0,0],n=[0,0],r=t.length,i=0;i<r;++i){var a=t[i];a.sub&&(a.horizontal&&(e[1]===0&&(e[0]=i),e[1]=i-e[0]+1,n[0]=i+1),a.vertical&&(n[1]===0&&(n[0]=i),n[1]=i-n[0]+1))}return{horizontalRange:e,verticalRange:n}}function Cd(t,e,n,r,i,a,o){var s,l,c,u;a===void 0&&(a=[0,0]),o===void 0&&(o=!1);var d=t.indexOf("/"),f=(d>-1?t.slice(0,d):t).length,h=t.slice(0,f),v=t.slice(f+1),p=h.length,g=v.length,m=g>0,x=I(h,4),b=x[0],C=b===void 0?"0px":b,E=x[1],S=E===void 0?C:E,D=x[2],M=D===void 0?C:D,w=x[3],T=w===void 0?S:w,k=I(v,4),O=k[0],R=O===void 0?C:O,L=k[1],P=L===void 0?m?R:S:L,z=k[2],V=z===void 0?m?R:M:z,N=k[3],G=N===void 0?m?P:T:N,W=[C,S,M,T].map(function(H){return It(H,e)}),B=[R,P,V,G].map(function(H){return It(H,n)}),q=W.slice(),Z=B.slice();s=I(Wa([q[0],q[1]],e),2),q[0]=s[0],q[1]=s[1],l=I(Wa([q[3],q[2]],e),2),q[3]=l[0],q[2]=l[1],c=I(Wa([Z[0],Z[3]],n),2),Z[0]=c[0],Z[3]=c[1],u=I(Wa([Z[1],Z[2]],n),2),Z[1]=u[0],Z[2]=u[1];var K=o?q:q.slice(0,Math.max(a[0],p)),X=o?Z:Z.slice(0,Math.max(a[1],g));return J(J([],I(K.map(function(H,et){var rt=yd[et];return{virtual:et>=p,horizontal:ur[et],vertical:0,pos:[r+H,i+(dr[et]===-1?n:0)],sub:!0,raw:W[et],direction:rt}})),!1),I(X.map(function(H,et){var rt=yd[et];return{virtual:et>=g,horizontal:0,vertical:dr[et],pos:[r+(ur[et]===-1?e:0),i+H],sub:!0,raw:B[et],direction:rt}})),!1)}function B0(t,e,n,r,i){i===void 0&&(i=e.length);var a=bd(t.slice(r)),o=a.horizontalRange,s=a.verticalRange,l=n-r,c=0;if(l===0)c=i;else if(l>0&&l<o[1])c=o[1]-l;else if(l>=s[0])c=s[0]+s[1]-l;else return;t.splice(n,c),e.splice(n,c)}function j0(t,e,n,r,i,a,o,s,l,c,u){c===void 0&&(c=0),u===void 0&&(u=0);var d=bd(t.slice(n)),f=d.horizontalRange,h=d.verticalRange;if(r>-1)for(var v=ur[r]===1?a-c:s-a,p=f[1];p<=r;++p){var g=dr[p]===1?u:l,m=0;if(r===p?m=a:p===0?m=c+v:ur[p]===-1&&(m=s-(e[n][0]-c)),t.splice(n+p,0,{horizontal:ur[p],vertical:0,pos:[m,g]}),e.splice(n+p,0,[m,g]),p===0)break}else if(i>-1){var x=dr[i]===1?o-u:l-o;if(f[1]===0&&h[1]===0){var b=[c+x,u];t.push({horizontal:ur[0],vertical:0,pos:b}),e.push(b)}for(var C=h[0],p=h[1];p<=i;++p){var m=ur[p]===1?c:s,g=0;if(i===p?g=o:p===0?g=u+x:dr[p]===1?g=e[n+C][1]:dr[p]===-1&&(g=l-(e[n+C][1]-u)),t.push({horizontal:0,vertical:dr[p],pos:[m,g]}),e.push([m,g]),p===0)break}}}function V0(t,e){e===void 0&&(e=t.map(function(i){return i.raw}));var n=t.map(function(i,a){return i.horizontal?e[a]:null}).filter(function(i){return i!=null}),r=t.map(function(i,a){return i.vertical?e[a]:null}).filter(function(i){return i!=null});return{horizontals:n,verticals:r}}var F0=[[0,-1,"n"],[1,0,"e"]],G0=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function Fs(t,e,n){var r=t.props.clipRelative,i=t.state,a=i.width,o=i.height,s=e,l=s.type,c=s.poses,u=l==="rect",d=l==="circle";if(l==="polygon")return n.map(function(S){return"".concat(sn(S[0],a,r)," ").concat(sn(S[1],o,r))});if(u||l==="inset"){var f=n[1][1],h=n[3][0],v=n[7][0],p=n[5][1];if(u)return[f,h,p,v].map(function(S){return"".concat(S,"px")});var g=[f,a-h,o-p,v].map(function(S,D){return sn(S,D%2?a:o,r)});if(n.length>8){var m=I(pt(n[4],n[0]),2),x=m[0],b=m[1];g.push.apply(g,J(["round"],I(Vs(c.slice(8).map(function(S,D){return _(_({},S),{pos:n[D]})}),r,x,b,v,f,h,p).styles),!1))}return g}else if(d||l==="ellipse"){var C=n[0],E=sn(Y(n[1][1]-C[1]),d?Math.sqrt((a*a+o*o)/2):o,r),g=d?[E]:[sn(Y(n[2][0]-C[0]),a,r),E];return g.push("at",sn(C[0],a,r),sn(C[1],o,r)),g}}function Ha(t,e,n,r){var i=[r,(r+e)/2,e],a=[t,(t+n)/2,n];return G0.map(function(o){var s=I(o,3),l=s[0],c=s[1],u=s[2],d=i[l+1],f=a[c+1];return{vertical:Y(c),horizontal:Y(l),direction:u,pos:[d,f]}})}function Sd(t){var e=[1/0,-1/0],n=[1/0,-1/0];return t.forEach(function(r){var i=r.pos;e[0]=Math.min(e[0],i[0]),e[1]=Math.max(e[1],i[0]),n[0]=Math.min(n[0],i[1]),n[1]=Math.max(n[1],i[1])}),[Y(e[1]-e[0]),Y(n[1]-n[0])]}function Ed(t,e,n,r,i){var a,o,s,l,c,u,d,f,h;if(t){var v=i;if(!v){var p=Ne(t),g=p("clipPath");v=g!=="none"?g:p("clip")}if(!((!v||v==="none"||v==="auto")&&(v=r,!v))){var m=po(v),x=m.prefix,b=x===void 0?v:x,C=m.value,E=C===void 0?"":C,S=b==="circle",D=" ";if(b==="polygon"){var M=Nn(E||"0% 0%, 100% 0%, 100% 100%, 0% 100%");D=",";var w=M.map(function(Ht){var Nt=I(Ht.split(" "),2),lt=Nt[0],St=Nt[1];return{vertical:1,horizontal:1,pos:[It(lt,e),It(St,n)]}}),T=rr(w.map(function(Ht){return Ht.pos}));return{type:b,clipText:v,poses:w,splitter:D,left:T.minX,right:T.maxX,top:T.minY,bottom:T.maxY}}else if(S||b==="ellipse"){var k="",O="",R=0,L=0,M=zn(E);if(S){var P="";a=I(M,4),o=a[0],P=o===void 0?"50%":o,s=a[2],k=s===void 0?"50%":s,l=a[3],O=l===void 0?"50%":l,R=It(P,Math.sqrt((e*e+n*n)/2)),L=R}else{var z="",V="";c=I(M,5),u=c[0],z=u===void 0?"50%":u,d=c[1],V=d===void 0?"50%":d,f=c[3],k=f===void 0?"50%":f,h=c[4],O=h===void 0?"50%":h,R=It(z,e),L=It(V,n)}var N=[It(k,e),It(O,n)],w=J([{vertical:1,horizontal:1,pos:N,direction:"nesw"}],I(F0.slice(0,S?1:2).map(function(lt){return{vertical:Y(lt[1]),horizontal:lt[0],direction:lt[2],sub:!0,pos:[N[0]+lt[0]*R,N[1]+lt[1]*L]}})),!1);return{type:b,clipText:v,radiusX:R,radiusY:L,left:N[0]-R,top:N[1]-L,right:N[0]+R,bottom:N[1]+L,poses:w,splitter:D}}else if(b==="inset"){var M=zn(E||"0 0 0 0"),G=M.indexOf("round"),W=(G>-1?M.slice(0,G):M).length,B=M.slice(W+1),q=I(M.slice(0,W),4),Z=q[0],K=q[1],X=K===void 0?Z:K,H=q[2],et=H===void 0?Z:H,rt=q[3],mt=rt===void 0?X:rt,vt=I([Z,et].map(function(lt){return It(lt,n)}),2),U=vt[0],nt=vt[1],Rt=I([mt,X].map(function(lt){return It(lt,e)}),2),ut=Rt[0],dt=Rt[1],yt=e-dt,Ot=n-nt,Tt=Cd(B,yt-ut,Ot-U,ut,U),w=J(J([],I(Ha(U,yt,Ot,ut)),!1),I(Tt),!1);return{type:"inset",clipText:v,poses:w,top:U,left:ut,right:yt,bottom:Ot,radius:B,splitter:D}}else if(b==="rect"){var M=Nn(E||"0px, ".concat(e,"px, ").concat(n,"px, 0px"));D=",";var xt=I(M.map(function(kt){var Lt=Zn(kt).value;return Lt}),4),Ct=xt[0],dt=xt[1],nt=xt[2],ut=xt[3],w=Ha(Ct,dt,nt,ut);return{type:"rect",clipText:v,poses:w,top:Ct,right:dt,bottom:nt,left:ut,values:M,splitter:D}}}}}function $0(t,e,n,r,i){var a=t[e],o=a.direction,s=a.sub,l=t.map(function(){return[0,0]}),c=o?o.split(""):[];if(r&&e<8){var u=c.filter(function(R){return R==="w"||R==="e"}),d=c.filter(function(R){return R==="n"||R==="s"}),f=u[0],h=d[0];l[e]=n;var v=I(Sd(t),2),p=v[0],g=v[1],m=p&&g?p/g:0;if(m&&i){var x=(e+4)%8,b=t[x].pos,C=[0,0];o.indexOf("w")>-1?C[0]=-1:o.indexOf("e")>-1&&(C[0]=1),o.indexOf("n")>-1?C[1]=-1:o.indexOf("s")>-1&&(C[1]=1);var E=cd([p,g],n,m,C,!0),S=p+E[0],D=g+E[1],M=b[1],w=b[1],T=b[0],k=b[0];C[0]===-1?T=k-S:C[0]===1?k=T+S:(T=T-S/2,k=k+S/2),C[1]===-1?M=w-D:(C[1]===1||(M=w-D/2),w=M+D);var O=Ha(M,k,w,T);t.forEach(function(R,L){l[L][0]=O[L].pos[0]-R.pos[0],l[L][1]=O[L].pos[1]-R.pos[1]})}else t.forEach(function(R,L){var P=R.direction;P&&(P.indexOf(f)>-1&&(l[L][0]=n[0]),P.indexOf(h)>-1&&(l[L][1]=n[1]))}),f&&(l[1][0]=n[0]/2,l[5][0]=n[0]/2),h&&(l[3][1]=n[1]/2,l[7][1]=n[1]/2)}else o&&!s?c.forEach(function(R){var L=R==="n"||R==="s";t.forEach(function(P,z){var V=P.direction,N=P.horizontal,G=P.vertical;!V||V.indexOf(R)===-1||(l[z]=[L||!N?0:n[0],!L||!G?0:n[1]])})}):l[e]=n;return l}function W0(t,e){var n=I(nu(t,e),2),r=n[0],i=n[1],a=e.datas,o=a.clipPath,s=a.clipIndex,l=o,c=l.type,u=l.poses,d=l.splitter,f=u.map(function(x){return x.pos});if(c==="polygon")f.splice(s,0,[r,i]);else if(c==="inset"){var h=z0.indexOf(s),v=N0.indexOf(s),p=u.length;if(j0(u,f,8,h,v,r,i,f[4][0],f[4][1],f[0][0],f[0][1]),p===u.length)return}else return;var g=Fs(t,o,f),m="".concat(c,"(").concat(g.join(d),")");it(t,"onClip",At(t,e,_({clipEventType:"added",clipType:c,poses:f,clipStyles:g,clipStyle:m,distX:0,distY:0},Le({clipPath:m},e))))}function H0(t,e){var n=e.datas,r=n.clipPath,i=n.clipIndex,a=r,o=a.type,s=a.poses,l=a.splitter,c=s.map(function(h){return h.pos}),u=c.length;if(o==="polygon")s.splice(i,1),c.splice(i,1);else if(o==="inset"){if(i<8||(B0(s,c,i,8,u),u===s.length))return}else return;var d=Fs(t,r,c),f="".concat(o,"(").concat(d.join(l),")");it(t,"onClip",At(t,e,_({clipEventType:"removed",clipType:o,poses:c,clipStyles:d,clipStyle:f,distX:0,distY:0},Le({clipPath:f},e))))}var Y0={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,e){var n=t.props,r=n.customClipPath,i=n.defaultClipPath,a=n.clipArea,o=n.zoom,s=n.groupable,l=t.getState(),c=l.target,u=l.width,d=l.height,f=l.allMatrix,h=l.is3d,v=l.left,p=l.top,g=l.pos1,m=l.pos2,x=l.pos3,b=l.pos4,C=l.clipPathState,E=l.snapBoundInfos,S=l.rotation;if(!c||s)return[];var D=Ed(c,u,d,i||"inset",C||r);if(!D)return[];var M=h?4:3,w=D.type,T=D.poses,k=T.map(function(dt){var yt=ae(f,dt.pos,M);return[yt[0]-v,yt[1]-p]}),O=[],R=[],L=w==="rect",P=w==="inset",z=w==="polygon";if(L||P||z){var V=P?k.slice(0,8):k;R=V.map(function(dt,yt){var Ot=yt===0?V[V.length-1]:V[yt-1],Tt=se(Ot,dt),xt=Qu(Ot,dt);return e.createElement("div",{key:"clipLine".concat(yt),className:ht("line","clip-line","snap-control"),"data-clip-index":yt,style:{width:"".concat(xt,"px"),transform:"translate(".concat(Ot[0],"px, ").concat(Ot[1],"px) rotate(").concat(Tt,"rad) scaleY(").concat(o,")")}})})}if(O=k.map(function(dt,yt){return e.createElement("div",{key:"clipControl".concat(yt),className:ht("control","clip-control","snap-control"),"data-clip-index":yt,style:{transform:"translate(".concat(dt[0],"px, ").concat(dt[1],"px) rotate(").concat(S,"rad) scale(").concat(o,")")}})}),P&&O.push.apply(O,J([],I(k.slice(8).map(function(dt,yt){return e.createElement("div",{key:"clipRadiusControl".concat(yt),className:ht("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+yt,style:{transform:"translate(".concat(dt[0],"px, ").concat(dt[1],"px) rotate(").concat(S,"rad) scale(").concat(o,")")}})})),!1)),w==="circle"||w==="ellipse"){var N=D.left,G=D.top,W=D.radiusX,B=D.radiusY,q=I(pt(ae(f,[N,G],M),ae(f,[0,0],M)),2),Z=q[0],K=q[1],X="none";if(!a){for(var H=Math.max(10,W/5,B/5),et=[],rt=0;rt<=H;++rt){var mt=Math.PI*2/H*rt;et.push([W+(W-o)*Math.cos(mt),B+(B-o)*Math.sin(mt)])}et.push([W,-2]),et.push([-2,-2]),et.push([-2,B*2+2]),et.push([W*2+2,B*2+2]),et.push([W*2+2,-2]),et.push([W,-2]),X="polygon(".concat(et.map(function(dt){return"".concat(dt[0],"px ").concat(dt[1],"px")}).join(", "),")")}O.push(e.createElement("div",{key:"clipEllipse",className:ht("clip-ellipse","snap-control"),style:{width:"".concat(W*2,"px"),height:"".concat(B*2,"px"),clipPath:X,transform:"translate(".concat(-v+Z,"px, ").concat(-p+K,"px) ").concat(Na(f))}}))}if(a){var vt=Xe(J([g,m,x,b],I(k),!1)),U=vt.width,nt=vt.height,Rt=vt.left,ut=vt.top;if(z||L||P){var et=P?k.slice(0,8):k;O.push(e.createElement("div",{key:"clipArea",className:ht("clip-area","snap-control"),style:{width:"".concat(U,"px"),height:"".concat(nt,"px"),transform:"translate(".concat(Rt,"px, ").concat(ut,"px)"),clipPath:"polygon(".concat(et.map(function(yt){return"".concat(yt[0]-Rt,"px ").concat(yt[1]-ut,"px")}).join(", "),")")}}))}}return E&&["vertical","horizontal"].forEach(function(dt){var yt=E[dt],Ot=dt==="horizontal";yt.isSnap&&R.push.apply(R,J([],I(yt.snap.posInfos.map(function(Tt,xt){var Ct=Tt.pos,Ht=pt(ae(f,Ot?[0,Ct]:[Ct,0],M),[v,p]),Nt=pt(ae(f,Ot?[u,Ct]:[Ct,d],M),[v,p]);return Ci(e,"",Ht,Nt,o,"clip".concat(dt,"snap").concat(xt),"guideline")})),!1)),yt.isBound&&R.push.apply(R,J([],I(yt.bounds.map(function(Tt,xt){var Ct=Tt.pos,Ht=pt(ae(f,Ot?[0,Ct]:[Ct,0],M),[v,p]),Nt=pt(ae(f,Ot?[u,Ct]:[Ct,d],M),[v,p]);return Ci(e,"",Ht,Nt,o,"clip".concat(dt,"bounds").concat(xt),"guideline","bounds","bold")})),!1))}),J(J([],I(O),!1),I(R),!1)},dragControlCondition:function(t,e){return e.inputEvent&&(e.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,e){var n=t.props,r=n.dragWithClip,i=r===void 0?!0:r;return i?!1:this.dragControlStart(t,e)},drag:function(t,e){return this.dragControl(t,_(_({},e),{isDragTarget:!0}))},dragEnd:function(t,e){return this.dragControlEnd(t,e)},dragControlStart:function(t,e){var n=t.state,r=t.props,i=r.defaultClipPath,a=r.customClipPath,o=n.target,s=n.width,l=n.height,c=e.inputEvent?e.inputEvent.target:null,u=c&&c.getAttribute("class")||"",d=e.datas,f=Ed(o,s,l,i||"inset",a);if(!f)return!1;var h=f.clipText,v=f.type,p=f.poses,g=it(t,"onClipStart",At(t,e,{clipType:v,clipStyle:h,poses:p.map(function(m){return m.pos})}));return g===!1?(d.isClipStart=!1,!1):(d.isControl=u&&u.indexOf("clip-control")>-1,d.isLine=u.indexOf("clip-line")>-1,d.isArea=u.indexOf("clip-area")>-1||u.indexOf("clip-ellipse")>-1,d.clipIndex=c?parseInt(c.getAttribute("data-clip-index"),10):-1,d.clipPath=f,d.isClipStart=!0,n.clipPathState=h,ar(t,e),!0)},dragControl:function(t,e){var n,r,i,a=e.datas,o=e.originalDatas,s=e.isDragTarget;if(!a.isClipStart)return!1;var l=a,c=l.isControl,u=l.isLine,d=l.isArea,f=l.clipIndex,h=l.clipPath;if(!h)return!1;var v=cr(t.props,"clippable"),p=v.keepRatio,g=0,m=0,x=o.draggable,b=mn(e);s&&x?(n=I(x.prevBeforeDist,2),g=n[0],m=n[1]):(r=I(b,2),g=r[0],m=r[1]);var C=[g,m],E=t.state,S=E.width,D=E.height,M=!d&&!c&&!u,w=h.type,T=h.poses,k=h.splitter,O=T.map(function(Dt){return Dt.pos});M&&(g=-g,m=-m);var R=!c||T[f].direction==="nesw",L=w==="inset"||w==="rect",P=T.map(function(){return[0,0]});if(c&&!R){var z=T[f],V=z.horizontal,N=z.vertical,G=[g*Y(V),m*Y(N)];P=$0(T,f,G,L,p)}else R&&(P=O.map(function(){return[g,m]}));var W=O.map(function(Dt,Gt){return Ft(Dt,P[Gt])}),B=J([],I(W),!1);E.snapBoundInfos=null;var q=h.type==="circle",Z=h.type==="ellipse";if(q||Z){var K=Xe(W),X=Y(K.bottom-K.top),H=Y(Z?K.right-K.left:X),et=W[0][1]+X,rt=W[0][0]-H,mt=W[0][0]+H;q&&(B.push([mt,K.bottom]),P.push([1,0])),B.push([K.left,et]),P.push([0,1]),B.push([rt,K.bottom]),P.push([1,0])}var vt=Fu((v.clipHorizontalGuidelines||[]).map(function(Dt){return It("".concat(Dt),D)}),(v.clipVerticalGuidelines||[]).map(function(Dt){return It("".concat(Dt),S)}),S,D),U=[],nt=[];if(q||Z)U=[B[4][0],B[2][0]],nt=[B[1][1],B[3][1]];else if(L){var Rt=[B[0],B[2],B[4],B[6]],ut=[P[0],P[2],P[4],P[6]];U=Rt.filter(function(Dt,Gt){return ut[Gt][0]}).map(function(Dt){return Dt[0]}),nt=Rt.filter(function(Dt,Gt){return ut[Gt][1]}).map(function(Dt){return Dt[1]})}else U=B.filter(function(Dt,Gt){return P[Gt][0]}).map(function(Dt){return Dt[0]}),nt=B.filter(function(Dt,Gt){return P[Gt][1]}).map(function(Dt){return Dt[1]});var dt=[0,0],yt=Ou(vt,v.clipTargetBounds&&{left:0,top:0,right:S,bottom:D},U,nt,5,5),Ot=yt.horizontal,Tt=yt.vertical,xt=Ot.offset,Ct=Tt.offset;if(Ot.isBound&&(dt[1]+=xt),Tt.isBound&&(dt[0]+=Ct),(Z||q)&&P[0][0]===0&&P[0][1]===0){var K=Xe(W),Ht=K.bottom-K.top,Nt=Z?K.right-K.left:Ht,lt=Tt.isBound?Y(Ct):Tt.snapIndex===0?-Ct:Ct,St=Ot.isBound?Y(xt):Ot.snapIndex===0?-xt:xt;Nt-=lt,Ht-=St,q&&(Ht=Du(Tt,Ot)>0?Ht:Nt,Nt=Ht);var gt=B[0];B[1][1]=gt[1]-Ht,B[2][0]=gt[0]+Nt,B[3][1]=gt[1]+Ht,B[4][0]=gt[0]-Nt}else if(L&&p&&c){var kt=I(Sd(T),2),Lt=kt[0],wt=kt[1],Bt=Lt&&wt?Lt/wt:0,Xt=T[f],bt=Xt.direction||"",tt=B[1][1],et=B[5][1],rt=B[7][0],mt=B[3][0];Y(xt)<=Y(Ct)?xt=_e(xt)*Y(Ct)/Bt:Ct=_e(Ct)*Y(xt)*Bt,bt.indexOf("w")>-1?rt-=Ct:bt.indexOf("e")>-1?mt-=Ct:(rt+=Ct/2,mt-=Ct/2),bt.indexOf("n")>-1?tt-=xt:bt.indexOf("s")>-1?et-=xt:(tt+=xt/2,et-=xt/2);var Wt=Ha(tt,mt,et,rt);B.forEach(function(Cn,qr){var Jr;Jr=I(Wt[qr].pos,2),Cn[0]=Jr[0],Cn[1]=Jr[1]})}else B.forEach(function(Dt,Gt){var Ie=P[Gt];Ie[0]&&(Dt[0]-=Ct),Ie[1]&&(Dt[1]-=xt)});var Mt=Fs(t,h,W),jt="".concat(w,"(").concat(Mt.join(k),")");if(E.clipPathState=jt,q||Z)U=[B[4][0],B[2][0]],nt=[B[1][1],B[3][1]];else if(L){var Rt=[B[0],B[2],B[4],B[6]];U=Rt.map(function(Gt){return Gt[0]}),nt=Rt.map(function(Gt){return Gt[1]})}else U=B.map(function(Dt){return Dt[0]}),nt=B.map(function(Dt){return Dt[1]});if(E.snapBoundInfos=Ou(vt,v.clipTargetBounds&&{left:0,top:0,right:S,bottom:D},U,nt,1,1),x){var Yt=E.is3d,te=E.allMatrix,ie=Yt?4:3,Ut=dt;s&&(Ut=[C[0]+dt[0]-b[0],C[1]+dt[1]-b[1]]),x.deltaOffset=Qt(te,[Ut[0],Ut[1],0,0],ie)}return it(t,"onClip",At(t,e,_({clipEventType:"changed",clipType:w,poses:W,clipStyle:jt,clipStyles:Mt,distX:g,distY:m},Le((i={},i[w==="rect"?"clip":"clipPath"]=jt,i),e)))),!0},dragControlEnd:function(t,e){this.unset(t);var n=e.isDrag,r=e.datas,i=e.isDouble,a=r.isLine,o=r.isClipStart,s=r.isControl;return o?(it(t,"onClipEnd",$e(t,e,{})),i&&(s?H0(t,e):a&&W0(t,e)),i||n):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},K0={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,e){return e.isRequest?e.requestAble==="originDraggable":ce(e.inputEvent.target,ht("origin"))},dragControlStart:function(t,e){var n=e.datas;ar(t,e);var r=At(t,e,{dragStart:Oe.dragStart(t,new Ir().dragStart([0,0],e))}),i=it(t,"onDragOriginStart",r);return n.startOrigin=t.state.transformOrigin,n.startTargetOrigin=t.state.targetOrigin,n.prevOrigin=[0,0],n.isDragOrigin=!0,i===!1?(n.isDragOrigin=!1,!1):r},dragControl:function(t,e){var n=e.datas,r=e.isPinch,i=e.isRequest;if(!n.isDragOrigin)return!1;var a=I(mn(e),2),o=a[0],s=a[1],l=t.state,c=l.width,u=l.height,d=l.offsetMatrix,f=l.targetMatrix,h=l.is3d,v=t.props.originRelative,p=v===void 0?!0:v,g=h?4:3,m=[o,s];if(i){var x=e.distOrigin;(x[0]||x[1])&&(m=x)}var b=Ft(n.startOrigin,m),C=Ft(n.startTargetOrigin,m),E=pt(m,n.prevOrigin),S=bi(d,f,b,g),D=t.getRect(),M=Xe(lr(S,c,u,g)),w=[D.left-M.left,D.top-M.top];n.prevOrigin=m;var T=[sn(C[0],c,p),sn(C[1],u,p)].join(" "),k=Oe.drag(t,yi(e,t.state,w,!!r,!1)),O=At(t,e,_(_({width:c,height:u,origin:b,dist:m,delta:E,transformOrigin:T,drag:k},Le({transformOrigin:T,transform:k.transform},e)),{afterTransform:k.transform}));return it(t,"onDragOrigin",O),O},dragControlEnd:function(t,e){var n=e.datas;return n.isDragOrigin?(it(t,"onDragOriginEnd",$e(t,e,{})),!0):!1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);return!!n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);return n?(t.transformOrigin=n.transformOrigin,!0):!1},request:function(t){var e={},n=t.getRect(),r=0,i=0,a=n.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:e}},request:function(s){return"deltaOrigin"in s?(o[0]+=s.deltaOrigin[0],o[1]+=s.deltaOrigin[1]):"origin"in s?(o[0]=s.origin[0]-a[0],o[1]=s.origin[1]-a[1]):("x"in s?r=s.x-n.left:"deltaX"in s&&(r+=s.deltaX),"y"in s?i=s.y-n.top:"deltaY"in s&&(i+=s.deltaY)),{datas:e,distX:r,distY:i,distOrigin:o}},requestEnd:function(){return{datas:e,isDrag:!0}}}}};function X0(t,e,n,r){var i=t.filter(function(l){var c=l.virtual,u=l.horizontal;return u&&!c}).length,a=t.filter(function(l){var c=l.virtual,u=l.vertical;return u&&!c}).length,o=-1;if(e===0&&(i===0?o=0:i===1&&(o=1)),e===2&&(i<=2?o=2:i<=3&&(o=3)),e===3&&(a===0?o=4:a<4&&(o=7)),e===1&&(a<=1?o=5:a<=2&&(o=6)),!(o===-1||!t[o].virtual)){var s=t[o];U0(t,o),o<4?s.pos[0]=n:s.pos[1]=r}}function U0(t,e){e<4?t.slice(0,e+1).forEach(function(n){n.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,e+1).forEach(function(n){n.virtual=!1}))}function Z0(t,e){e<4?t.slice(e,4).forEach(function(n){n.virtual=!0}):t.slice(e).forEach(function(n){n.virtual=!0})}function wd(t,e,n,r,i){r===void 0&&(r=[0,0]);var a=[];return!t||t==="0px"?a=[]:a=zn(t),Cd(a,e,n,0,0,r,i)}function Dd(t,e,n,r,i){var a=t.state,o=a.width,s=a.height,l=Vs(i,t.props.roundRelative,o,s),c=l.raws,u=l.styles,d=l.radiusPoses,f=V0(d,c),h=f.horizontals,v=f.verticals,p=u.join(" ");a.borderRadiusState=p;var g=At(t,e,_({horizontals:h,verticals:v,borderRadius:p,width:o,height:s,delta:r,dist:n},Le({borderRadius:p},e)));return it(t,"onRound",g),g}function Md(t){var e,n,r=t.getState().style,i=r.borderRadius||"";if(!i&&t.props.groupable){var a=t.moveables[0],o=t.getTargets()[0];o&&(a?.props.target===o?(i=(n=(e=t.moveables[0])===null||e===void 0?void 0:e.state.style.borderRadius)!==null&&n!==void 0?n:"",r.borderRadius=i):(i=Os(o).borderRadius,r.borderRadius=i))}return i}var Q0={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var e=t.props.roundClickable;return e===!0||e==="line"?ht("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,e){var n=t.getState(),r=n.target,i=n.width,a=n.height,o=n.allMatrix,s=n.is3d,l=n.left,c=n.top,u=n.borderRadiusState,d=t.props,f=d.minRoundControls,h=f===void 0?[0,0]:f,v=d.maxRoundControls,p=v===void 0?[4,4]:v,g=d.zoom,m=d.roundPadding,x=m===void 0?0:m,b=d.isDisplayShadowRoundControls,C=d.groupable;if(!r)return null;var E=u||Md(t),S=s?4:3,D=wd(E,i,a,h,!0);if(!D)return null;var M=0,w=0,T=C?[0,0]:[l,c];return D.map(function(k,O){var R=k.horizontal,L=k.vertical,P=k.direction||"",z=J([],I(k.pos),!1);w+=Math.abs(R),M+=Math.abs(L),R&&P.indexOf("n")>-1&&(z[1]-=x),L&&P.indexOf("w")>-1&&(z[0]-=x),R&&P.indexOf("s")>-1&&(z[1]+=x),L&&P.indexOf("e")>-1&&(z[0]+=x);var V=pt(ae(o,z,S),T),N=b&&b!=="horizontal",G=k.vertical?M<=p[1]&&(N||!k.virtual):w<=p[0]&&(b||!k.virtual);return e.createElement("div",{key:"borderRadiusControl".concat(O),className:ht("control","border-radius",k.vertical?"vertical":"",k.virtual?"virtual":""),"data-radius-index":O,style:{display:G?"block":"none",transform:"translate(".concat(V[0],"px, ").concat(V[1],"px) scale(").concat(g,")")}})})},dragControlCondition:function(t,e){if(!e.inputEvent||e.isRequest)return!1;var n=e.inputEvent.target.getAttribute("class")||"";return n.indexOf("border-radius")>-1||n.indexOf("moveable-line")>-1&&n.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,e){return this.dragControlCondition(t,e)},dragControlStart:function(t,e){var n=e.inputEvent,r=e.datas,i=n.target,a=i.getAttribute("class")||"",o=a.indexOf("border-radius")>-1,s=a.indexOf("moveable-line")>-1&&a.indexOf("moveable-direction")>-1,l=o?parseInt(i.getAttribute("data-radius-index"),10):-1,c=-1;if(s){var u=i.getAttribute("data-line-key")||"";u&&(c=parseInt(u.replace(/render-line-/g,""),10),isNaN(c)&&(c=-1))}if(!o&&!s)return!1;var d=At(t,e,{}),f=it(t,"onRoundStart",d);if(f===!1)return!1;r.lineIndex=c,r.controlIndex=l,r.isControl=o,r.isLine=s,ar(t,e);var h=t.props,v=h.roundRelative,p=h.minRoundControls,g=p===void 0?[0,0]:p,m=t.state,x=m.width,b=m.height;r.isRound=!0,r.prevDist=[0,0];var C=Md(t),E=wd(C||"",x,b,g,!0)||[];return r.controlPoses=E,m.borderRadiusState=Vs(E,v,x,b).styles.join(" "),d},dragControl:function(t,e){var n=e.datas,r=n.controlPoses;if(!n.isRound||!n.isControl||!r.length)return!1;var i=n.controlIndex,a=I(mn(e),2),o=a[0],s=a[1],l=[o,s],c=pt(l,n.prevDist),u=t.props.maxRoundControls,d=u===void 0?[4,4]:u,f=t.state,h=f.width,v=f.height,p=r[i],g=p.vertical,m=p.horizontal,x=r.map(function(C){var E=C.horizontal,S=C.vertical,D=[E*m*l[0],S*g*l[1]];if(E){if(d[0]===1)return D;if(d[0]<4&&E!==m)return D}else{if(d[1]===0)return D[1]=S*m*l[0]/h*v,D;if(g){if(d[1]===1)return D;if(d[1]<4&&S!==g)return D}}return[0,0]});x[i]=l;var b=r.map(function(C,E){return _(_({},C),{pos:Ft(C.pos,x[E])})});return i<4?b.slice(0,i+1).forEach(function(C){C.virtual=!1}):b.slice(4,i+1).forEach(function(C){C.virtual=!1}),n.prevDist=[o,s],Dd(t,e,l,c,b)},dragControlEnd:function(t,e){var n=t.state;n.borderRadiusState="";var r=e.datas,i=e.isDouble;if(!r.isRound)return!1;var a=r.isControl,o=r.controlIndex,s=r.isLine,l=r.lineIndex,c=r.controlPoses,u=c.filter(function(m){var x=m.virtual;return x}).length,d=t.props.roundClickable,f=d===void 0?!0:d;if(i&&f){if(a&&(f===!0||f==="control"))Z0(c,o);else if(s&&(f===!0||f==="line")){var h=I(nu(t,e),2),v=h[0],p=h[1];X0(c,l,v,p)}u!==c.filter(function(m){var x=m.virtual;return x}).length&&Dd(t,e,[0,0],[0,0],c)}var g=$e(t,e,{});return it(t,"onRoundEnd",g),n.borderRadiusState="",g},dragGroupControlStart:function(t,e){var n=this.dragControlStart(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=on(t,"roundable",e),o=_({targets:t.props.targets,events:a.map(function(s,l){return _(_({},s),{target:i[l],moveable:r[l],currentTarget:r[l]})})},n);return it(t,"onRoundGroupStart",o),n},dragGroupControl:function(t,e){var n=this.dragControl(t,e);if(!n)return!1;var r=t.moveables,i=t.props.targets,a=on(t,"roundable",e),o=_({targets:t.props.targets,events:a.map(function(s,l){return _(_(_({},s),{target:i[l],moveable:r[l],currentTarget:r[l]}),Le({borderRadius:n.borderRadius},s))})},n);return it(t,"onRoundGroup",o),o},dragGroupControlEnd:function(t,e){var n=t.moveables,r=t.props.targets,i=on(t,"roundable",e);Va(t,"onRound",function(s){var l=_({targets:t.props.targets,events:i.map(function(c,u){return _(_(_({},c),{target:r[u],moveable:n[u],currentTarget:n[u]}),Le({borderRadius:s.borderRadius},c))})},s);it(t,"onRoundGroup",l)});var a=this.dragControlEnd(t,e);if(!a)return!1;var o=_({targets:t.props.targets,events:i.map(function(s,l){var c;return _(_({},s),{target:r[l],moveable:n[l],currentTarget:n[l],lastEvent:(c=s.datas)===null||c===void 0?void 0:c.lastEvent})})},a);return it(t,"onRoundGroupEnd",o),o},unset:function(t){t.state.borderRadiusState=""}};function q0(t,e){var n=e?4:3,r=ee(n),i="matrix".concat(e?"3d":"","(").concat(r.join(","),")");return t===i||t==="matrix(1,0,0,1,0,0)"}var Td={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,e){var n=t.state,r=n.is3d,i=n.targetMatrix,a=n.inlineTransform,o=r?"matrix3d(".concat(i.join(","),")"):"matrix(".concat($c(i,!0),")"),s=!a||a==="none"?o:a;e.datas.startTransforms=q0(s,r)?[]:zn(s)},resetStyle:function(t){var e=t.datas;e.nextStyle={},e.nextTransforms=t.datas.startTransforms,e.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,e){return At(t,e,{setTransform:function(n){e.datas.startTransforms=qt(n)?n:zn(n)},isPinch:!!e.isPinch})},fillDragParams:function(t,e){return At(t,e,{isPinch:!!e.isPinch})},dragStart:function(t,e){this.setTransform(t,e),this.resetStyle(e),it(t,"onBeforeRenderStart",this.fillDragStartParams(t,e))},drag:function(t,e){e.datas.startTransforms||this.setTransform(t,e),this.resetStyle(e),it(t,"onBeforeRender",At(t,e,{isPinch:!!e.isPinch}))},dragEnd:function(t,e){e.datas.startTransforms||(this.setTransform(t,e),this.resetStyle(e)),it(t,"onBeforeRenderEnd",At(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag}))},dragGroupStart:function(t,e){var n=this;this.dragStart(t,e);var r=on(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,s){var l=i[s];return n.setTransform(l,o),n.resetStyle(o),n.fillDragStartParams(l,o)});it(t,"onBeforeRenderGroupStart",At(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,setTransform:function(){},events:a}))},dragGroup:function(t,e){var n=this;this.drag(t,e);var r=on(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,s){var l=i[s];return n.resetStyle(o),n.fillDragParams(l,o)});it(t,"onBeforeRenderGroup",At(t,e,{isPinch:!!e.isPinch,targets:t.props.targets,events:a}))},dragGroupEnd:function(t,e){this.dragEnd(t,e),it(t,"onBeforeRenderGroupEnd",At(t,e,{isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets}))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)}},kd={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,e){it(t,"onRenderStart",At(t,e,{isPinch:!!e.isPinch}))},drag:function(t,e){it(t,"onRender",this.fillDragParams(t,e))},dragAfter:function(t,e){return this.drag(t,e)},dragEnd:function(t,e){it(t,"onRenderEnd",this.fillDragEndParams(t,e))},dragGroupStart:function(t,e){it(t,"onRenderGroupStart",At(t,e,{isPinch:!!e.isPinch,targets:t.props.targets}))},dragGroup:function(t,e){var n=this,r=on(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,s){var l=i[s];return n.fillDragParams(l,o)});it(t,"onRenderGroup",At(t,e,_(_({isPinch:!!e.isPinch,targets:t.props.targets,transform:Ma(e),transformObject:{}},Le(Ta(e))),{events:a})))},dragGroupEnd:function(t,e){var n=this,r=on(t,"beforeRenderable",e),i=t.moveables,a=r.map(function(o,s){var l=i[s];return n.fillDragEndParams(l,o)});it(t,"onRenderGroupEnd",At(t,e,_({isPinch:!!e.isPinch,isDrag:e.isDrag,targets:t.props.targets,events:a,transformObject:{},transform:Ma(e)},Le(Ta(e)))))},dragControlStart:function(t,e){return this.dragStart(t,e)},dragControl:function(t,e){return this.drag(t,e)},dragControlAfter:function(t,e){return this.dragAfter(t,e)},dragControlEnd:function(t,e){return this.dragEnd(t,e)},dragGroupControlStart:function(t,e){return this.dragGroupStart(t,e)},dragGroupControl:function(t,e){return this.dragGroup(t,e)},dragGroupControlEnd:function(t,e){return this.dragGroupEnd(t,e)},fillDragParams:function(t,e){var n={};return Ar(Da(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),At(t,e,_({isPinch:!!e.isPinch,transformObject:n,transform:Ma(e)},Le(Ta(e))))},fillDragEndParams:function(t,e){var n={};return Ar(Da(e)||[]).forEach(function(r){n[r.name]=r.functionValue}),At(t,e,_({isPinch:!!e.isPinch,isDrag:e.isDrag,transformObject:n,transform:Ma(e)},Le(Ta(e))))}};function ki(t,e,n,r,i,a,o){a.clientDistX=a.distX,a.clientDistY=a.distY;var s=i==="Start",l=i==="End",c=i==="After",u=t.state.target,d=a.isRequest,f=r.indexOf("Control")>-1;if(!u||s&&f&&!d&&t.areaElement===a.inputEvent.target)return!1;var h=J([],I(e),!1);if(d){var v=a.requestAble;h.some(function(O){return O.name===v})||h.push.apply(h,J([],I(t.props.ables.filter(function(O){return O.name===v})),!1))}if(!h.length||h.every(function(O){return O.dragRelation}))return!1;var p=a.inputEvent,g;l&&p&&(g=document.elementFromPoint(a.clientX,a.clientY)||p.target);var m=!1,x=function(){var O;m=!0,(O=a.stop)===null||O===void 0||O.call(a)},b=s&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());b&&t.updateRect(i,!0,!1);var C=a.datas,E=f?"controlGesto":"targetGesto",S=t[E],D=function(O,R,L){if(!(R in O)||S!==t[E])return!1;var P=O.name,z=C[P]||(C[P]={});if(s&&(z.isEventStart=!L||!O[L]||O[L](t,a)),!z.isEventStart)return!1;var V=O[R](t,_(_({},a),{stop:x,datas:z,originalDatas:C,inputTarget:g}));return t._emitter.off(),s&&V===!1&&(z.isEventStart=!1),V};b&&h.forEach(function(O){O.unset&&O.unset(t)}),D(Td,"drag".concat(r).concat(i));var M=0,w=0;n.forEach(function(O){if(m)return!1;var R="".concat(O).concat(r).concat(i),L="".concat(O).concat(r,"Condition");i===""&&!d&&sd(t.state,a);var P=h.filter(function(N){return N[R]});P=P.filter(function(N,G){return N.name&&P.indexOf(N)===G});var z=P.filter(function(N){return D(N,R,L)}),V=z.length;m&&++M,V&&++w,!m&&s&&P.length&&!V&&(M+=P.filter(function(N){var G=N.name,W=C[G];return W.isEventStart?N.dragRelation!=="strong":!1}).length?1:0)}),(!c||w)&&D(kd,"drag".concat(r).concat(i));var T=S!==t[E]||M===n.length;if((l||m||T)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(O){O.state.gestos={}}),h.forEach(function(O){O.unset&&O.unset(t)})),s&&!T&&!d&&w&&t.props.preventDefault&&a?.preventDefault(),t.isUnmounted||T)return!1;if(!s&&w&&!o||l){var k=t.props.flushSync||Ku;k(function(){t.updateRect(l?i:"",!0,!1),t.forceUpdate()})}return!s&&!l&&!c&&w&&!o&&ki(t,e,n,r,i+"After",a),!0}function Gs(t,e){return function(n,r){var i;r===void 0&&(r=n.inputEvent.target);var a=r,o=t.areaElement,s=t._dragTarget;return!s||!e&&(!((i=t.controlGesto)===null||i===void 0)&&i.isFlag())?!1:a===s||s.contains(a)||a===o||!t.isMoveableElement(a)&&!t.controlBox.contains(a)||ce(a,"moveable-area")||ce(a,"moveable-padding")||ce(a,"moveable-edgeDraggable")}}function Ad(t,e,n){var r=t.controlBox,i=[],a=t.props,o=a.dragArea,s=t.state.target,l=a.dragTarget;i.push(r),(!o||l)&&i.push(e),!o&&l&&s&&e!==s&&a.dragTargetSelf&&i.push(s);var c=Gs(t);return Od(t,i,"targetAbles",n,{dragStart:c,pinchStart:c})}function Rd(t,e){var n=t.controlBox,r=[];r.push(n);var i=Gs(t,!0),a=function(o,s){if(s===void 0&&(s=o.inputEvent.target),s===n)return!0;var l=i(o,s);return!l};return Od(t,r,"controlAbles",e,{dragStart:a,pinchStart:a})}function Od(t,e,n,r,i){i===void 0&&(i={});var a=n==="targetAbles",o=t.props,s=o.pinchOutside,l=o.pinchThreshold,c=o.preventClickEventOnDrag,u=o.preventClickDefault,d=o.checkInput,f=o.dragFocusedInput,h=o.preventDefault,v=h===void 0?!0:h,p=o.preventRightClick,g=p===void 0?!0:p,m=o.preventWheelClick,x=m===void 0?!0:m,b=o.dragContainer,C=xn(b,!0),E={preventDefault:v,preventRightClick:g,preventWheelClick:x,container:C||Ee(t.getControlBoxElement()),pinchThreshold:l,pinchOutside:s,preventClickEventOnDrag:a?c:!1,preventClickEventOnDragStart:a?u:!1,preventClickEventByCondition:a?null:function(M){return t.controlBox.contains(M.target)},checkInput:a?d:!1,dragFocusedInput:f},S=new ia(e,E),D=r==="Control";return["drag","pinch"].forEach(function(M){["Start","","End"].forEach(function(w){S.on("".concat(M).concat(w),function(T){var k,O=T.eventType,R=M==="drag"&&T.isPinch;if(i[O]&&!i[O](T)){T.stop();return}if(!R){var L=M==="drag"?[M]:["drag",M],P=J([],I(t[n]),!1),z=ki(t,P,L,r,w,T);z?(t.props.stopPropagation||w==="Start"&&D)&&((k=T?.inputEvent)===null||k===void 0||k.stopPropagation()):T.stop()}})})}),S}var J0=function(){function t(e,n,r){var i=this;this.target=e,this.moveable=n,this.eventName=r,this.ables=[],this._onEvent=function(a){var o=i.eventName,s=i.moveable;s.state.disableNativeEvent||i.ables.forEach(function(l){l[o](s,{inputEvent:a})})},e.addEventListener(r.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(e){this.ables=e},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t}();function tm(t,e,n,r){var i;n===void 0&&(n=e);var a=lu(t,e),o=a.matrixes,s=a.is3d,l=a.targetMatrix,c=a.transformOrigin,u=a.targetOrigin,d=a.offsetContainer,f=a.hasFixed,h=a.zoom,v=pg(d,n),p=v.matrixes,g=v.is3d,m=v.offsetContainer,x=v.zoom,b=r||g||s,C=b?4:3,E=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,S=l,D=ee(C),M=ee(C),w=ee(C),T=ee(C),k=o.length,O=p.map(function(G){return _(_({},G),{matrix:G.matrix?J([],I(G.matrix),!1):void 0})}).reverse();o.reverse(),!s&&b&&(S=an(S,3,4),Ms(o)),!g&&b&&Ms(O),O.forEach(function(G){M=Qt(M,G.matrix,C)});var R=n||Bn(t),L=((i=O[0])===null||i===void 0?void 0:i.target)||Di(R,R,!0).offsetParent,P=O.slice(1).reduce(function(G,W){return Qt(G,W.matrix,C)},ee(C));o.forEach(function(G,W){if(k-2===W&&(w=D.slice()),k-1===W&&(T=D.slice()),!G.matrix){var B=o[W+1],q=x0(G,B,L,C,Qt(P,D,C));G.matrix=tr(q,C)}D=Qt(D,G.matrix,C)});var z=!E&&s;S||(S=ee(z?4:3));var V=Na(E&&S.length===16?an(S,4,3):S,z),N=M;return M=Fc(M,C,C),{hasZoom:h!==1||x!==1,hasFixed:f,matrixes:o,rootMatrix:M,originalRootMatrix:N,beforeMatrix:w,offsetMatrix:T,allMatrix:D,targetMatrix:S,targetTransform:V,inlineTransform:t.style.transform,transformOrigin:c,targetOrigin:u,is3d:b,offsetContainer:d,offsetRootContainer:m}}function Ld(t,e,n,r){n===void 0&&(n=e);var i=0,a=0,o=0,s={},l=qu(t);if(t&&(i=l.offsetWidth,a=l.offsetHeight),t){var c=tm(t,e,n,r),u=Pr(c.allMatrix,c.transformOrigin,i,a);s=_(_({},c),u);var d=Pr(c.allMatrix,[50,50],100,100);o=Ju([d.pos1,d.pos2],d.direction)}var f=r?4:3;return _(_(_({hasZoom:!1,width:i,height:a,rotation:o},l),{originalRootMatrix:ee(f),rootMatrix:ee(f),beforeMatrix:ee(f),offsetMatrix:ee(f),allMatrix:ee(f),targetMatrix:ee(f),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!r,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),s)}function Jy(t,e,n){return n===void 0&&(n=e),Ld(t,e,n,!0)}function $s(t,e,n,r,i,a){a===void 0&&(a=[]);var o=1,s=[0,0],l=ja(),c=ja(),u=ja(),d=ja(),f=[0,0],h={},v=Ld(e,n,i,!0);if(e){var p=Ne(e);a.forEach(function(O){h[O]=p(O)});var g=v.is3d?4:3,m=Pr(v.offsetMatrix,Ft(v.transformOrigin,Gc(v.targetMatrix,g)),v.width,v.height);o=m.direction,s=Ft(m.origin,[m.left-v.left,m.top-v.top]),d=Ti(v.offsetRootContainer);var x=Di(r,r,!0).offsetParent||v.offsetRootContainer;if(v.hasZoom){var b=Pr(Qt(v.originalRootMatrix,v.allMatrix),v.transformOrigin,v.width,v.height),C=Pr(v.originalRootMatrix,za(Ne(x)("transformOrigin")).map(function(O){return parseFloat(O)}),x.offsetWidth,x.offsetHeight);if(l=ks(b,d),u=ks(C,d,x,!0),t){var E=b.left,S=b.top;c=ks({left:E,top:S,bottom:S,right:S},d)}}else{l=Ti(e),u=vg(x),t&&(c=Ti(t));var D=u.left,M=u.top,w=u.clientLeft,T=u.clientTop,k=[l.left-D,l.top-M];f=pt($r(v.rootMatrix,k,4),[w+v.left,T+v.top])}}return _({targetClientRect:l,containerClientRect:u,moveableClientRect:c,rootContainerClientRect:d,beforeDirection:o,beforeOrigin:s,originalBeforeOrigin:s,target:e,style:h,offsetDelta:f},v)}function _d(t){var e=t.pos1,n=t.pos2,r=t.pos3,i=t.pos4;if(!e||!n||!r||!i)return null;var a=rr([e,n,r,i]),o=[a.minX,a.minY],s=pt(t.origin,o);return e=pt(e,o),n=pt(n,o),r=pt(r,o),i=pt(i,o),_(_({},t),{left:t.left,top:t.top,posDelta:o,pos1:e,pos2:n,pos3:r,pos4:i,origin:s,beforeOrigin:s,isPersisted:!0})}var Hr=function(t){Lr(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.state=_({container:null,gestos:{},renderLines:[[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]],[[0,0],[0,0]]],renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},$s(null)),n.renderState={},n.enabledAbles=[],n.targetAbles=[],n.controlAbles=[],n.rotation=0,n.scale=[1,1],n.isMoveableMounted=!1,n.isUnmounted=!1,n.events={mouseEnter:null,mouseLeave:null},n._emitter=new Qn,n._prevOriginalDragTarget=null,n._originalDragTarget=null,n._prevDragTarget=null,n._dragTarget=null,n._prevPropTarget=null,n._propTarget=null,n._prevDragArea=!1,n._isPropTargetChanged=!1,n._hasFirstTarget=!1,n._reiszeObserver=null,n._observerId=0,n._mutationObserver=null,n._rootContainer=null,n._viewContainer=null,n._viewClassNames=[],n._store={},n.checkUpdateRect=function(){if(!n.isDragging()){var r=n.props.parentMoveable;if(r){r.checkUpdateRect();return}qh(n._observerId),n._observerId=Gl(function(){n.isDragging()||n.updateRect()})}},n._onPreventClick=function(r){r.stopPropagation(),r.preventDefault()},n}return e.prototype.render=function(){var n=this.props,r=this.getState(),i=n.parentPosition,a=n.className,o=n.target,s=n.zoom,l=n.cspNonce,c=n.translateZ,u=n.cssStyled,d=n.groupable,f=n.linePadding,h=n.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var v=I(i||[0,0],2),p=v[0],g=v[1],m=r.left,x=r.top,b=r.target,C=r.direction,E=r.hasFixed,S=r.offsetDelta,D=n.targets,M=this.isDragging(),w={};this.getEnabledAbles().forEach(function(P){w["data-able-".concat(P.name.toLowerCase())]=!0});var T=this._getAbleClassName(),k=D&&D.length&&(b||d)||o||!this._hasFirstTarget&&this.state.isPersisted,O=this.controlBox||this.props.firstRenderState||this.props.persistData,R=[m-p,x-g];!d&&n.useAccuratePosition&&(R[0]+=S[0],R[1]+=S[1]);var L={position:E?"fixed":"absolute",display:k?"block":"none",visibility:O?"visible":"hidden",transform:"translate3d(".concat(R[0],"px, ").concat(R[1],"px, ").concat(c,")"),"--zoom":s,"--zoompx":"".concat(s,"px")};return f&&(L["--moveable-line-padding"]=f),h&&(L["--moveable-control-padding"]=h),Ke(u,_({cspNonce:l,ref:kn(this,"controlBox"),className:"".concat(ht("control-box",C===-1?"reverse":"",M?"dragging":"")," ").concat(T," ").concat(a)},w,{onClick:this._onPreventClick,style:L}),this.renderAbles(),this._renderLines())},e.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var n=this.props,r=n.parentMoveable,i=n.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!i&&!r&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},e.prototype.componentDidUpdate=function(n){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(n)},e.prototype.componentWillUnmount=function(){var n,r;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(n=this._reiszeObserver)===null||n===void 0||n.disconnect(),(r=this._mutationObserver)===null||r===void 0||r.disconnect();var i=this._viewContainer;i&&this._changeAbleViewClassNames([]),Fr(this,!1),Fr(this,!0);var a=this.events;for(var o in a){var s=a[o];s&&s.destroy()}},e.prototype.getTargets=function(){var n=this.props.target;return n?[n]:[]},e.prototype.getAble=function(n){var r=this.props.ables||[];return ze(r,function(i){return i.name===n})},e.prototype.getContainer=function(){var n=this.props,r=n.parentMoveable,i=n.wrapperMoveable,a=n.container;return a||i&&i.getContainer()||r&&r.getContainer()||this.controlBox.parentElement},e.prototype.getControlBoxElement=function(){return this.controlBox},e.prototype.getDragElement=function(){return this._dragTarget},e.prototype.isMoveableElement=function(n){var r;return n&&(((r=n.getAttribute)===null||r===void 0?void 0:r.call(n,"class"))||"").indexOf(ns)>-1},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=this.targetGesto,a=this.controlGesto;return i&&Gs(this)({inputEvent:n},r)?i.isFlag()||i.triggerDragStart(n):a&&this.isMoveableElement(r)&&(a.isFlag()||a.triggerDragStart(n)),this},e.prototype.hitTest=function(n){var r=this.state,i=r.target,a=r.pos1,o=r.pos2,s=r.pos3,l=r.pos4,c=r.targetClientRect;if(!i)return 0;var u;if(pn(n)){var d=n.getBoundingClientRect();u={left:d.left,top:d.top,width:d.width,height:d.height}}else u=_({width:0,height:0},n);var f=u.left,h=u.top,v=u.width,p=u.height,g=Ko([a,o,l,s],c),m=Op(g,[[f,h],[f+v,h],[f+v,h+p],[f,h+p]]),x=mi(g);return!m||!x?0:Math.min(100,m/x*100)},e.prototype.isInside=function(n,r){var i=this.state,a=i.target,o=i.pos1,s=i.pos2,l=i.pos3,c=i.pos4,u=i.targetClientRect;return a?ma([n,r],Ko([o,s,c,l],u)):!1},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0);var a=this.props,o=!a.parentPosition&&!a.wrapperMoveable;o&&Br(!0);var s=a.parentMoveable,l=this.state,c=l.target||a.target,u=this.getContainer(),d=s?s._rootContainer:this._rootContainer,f=$s(this.controlBox,c,u,u,d||u,this._getRequestStyles());if(!c&&this._hasFirstTarget&&a.persistData){var h=_d(a.persistData);for(var v in h)f[v]=h[v]}o&&Br(),this.updateState(f,s?!1:i)},e.prototype.isDragging=function(n){var r,i,a=this.targetGesto,o=this.controlGesto;if(a?.isFlag()){if(!n)return!0;var s=a.getEventData();return!!(!((r=s[n])===null||r===void 0)&&r.isEventStart)}if(o?.isFlag()){if(!n)return!0;var s=o.getEventData();return!!(!((i=s[n])===null||i===void 0)&&i.isEventStart)}return!1},e.prototype.updateTarget=function(n){this.updateRect(n,!0)},e.prototype.getRect=function(){var n=this.state,r=Ze(this.state),i=I(r,4),a=i[0],o=i[1],s=i[2],l=i[3],c=Xe(r),u=n.width,d=n.height,f=c.width,h=c.height,v=c.left,p=c.top,g=[n.left,n.top],m=Ft(g,n.origin),x=Ft(g,n.beforeOrigin),b=n.transformOrigin;return{width:f,height:h,left:v,top:p,pos1:a,pos2:o,pos3:s,pos4:l,offsetWidth:u,offsetHeight:d,beforeOrigin:x,origin:m,transformOrigin:b,rotation:this.getRotation()}},e.prototype.getManager=function(){return this},e.prototype.stopDrag=function(n){if(!n||n==="target"){var r=this.targetGesto;r?.isIdle()===!1&&Rs(this,!1),r?.stop()}if(!n||n==="control"){var r=this.controlGesto;r?.isIdle()===!1&&Rs(this,!0),r?.stop()}},e.prototype.getRotation=function(){var n=this.state,r=n.pos1,i=n.pos2,a=n.direction;return w0(r,i,a)},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this,o=a.props,s=o.parentMoveable||o.wrapperMoveable||a,l=s.props.ables,c=o.groupable,u=ze(l,function(m){return m.name===n});if(this.isDragging()||!u||!u.request)return{request:function(){return this},requestEnd:function(){return this}};var d=u.request(a),f=i||r.isInstant,h=d.isControl?"controlAbles":"targetAbles",v="".concat(c?"Group":"").concat(d.isControl?"Control":""),p=J([],I(s[h]),!1),g={request:function(m){return ki(a,p,["drag"],v,"",_(_({},d.request(m)),{requestAble:n,isRequest:!0}),f),g},requestEnd:function(){return ki(a,p,["drag"],v,"End",_(_({},d.requestEnd()),{requestAble:n,isRequest:!0}),f),g}};return ki(a,p,["drag"],v,"Start",_(_({},d.requestStart(r)),{requestAble:n,isRequest:!0}),f),f?g.request(r).requestEnd():g},e.prototype.getMoveables=function(){return[this]},e.prototype.destroy=function(){this.componentWillUnmount()},e.prototype.updateRenderPoses=function(){var n=this.getState(),r=this.props,i=r.padding,a=n.originalBeforeOrigin,o=n.transformOrigin,s=n.allMatrix,l=n.is3d,c=n.pos1,u=n.pos2,d=n.pos3,f=n.pos4,h=n.left,v=n.top,p=n.isPersisted,g=r.zoom||1;if(!i&&g<=1){n.renderPoses=[c,u,d,f],n.renderLines=[[c,u],[u,f],[f,d],[d,c]];return}var m=fd(i||{}),x=m.left,b=m.top,C=m.bottom,E=m.right,S=l?4:3,D=[];p?D=o:this.controlBox&&r.groupable?D=a:D=Ft(a,[h,v]);var M=ha(S,tr(D.map(function(L){return-L}),S),s,tr(o,S)),w=Qe(M,c,[-x,-b],S),T=Qe(M,u,[E,-b],S),k=Qe(M,d,[-x,C],S),O=Qe(M,f,[E,C],S);if(n.renderPoses=[w,T,k,O],n.renderLines=[[w,T],[T,O],[O,k],[k,w]],g){var R=g/2;n.renderLines=[[Qe(M,c,[-x-R,-b],S),Qe(M,u,[E+R,-b],S)],[Qe(M,u,[E,-b-R],S),Qe(M,f,[E,C+R],S)],[Qe(M,f,[E+R,C],S),Qe(M,d,[-x-R,C],S)],[Qe(M,d,[-x,C+R],S),Qe(M,c,[-x,-b-R],S)]]}},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var n=this.props,r=n.target,i=n.container,a=n.parentMoveable,o=this.state,s=o.target,l=o.container;if(!(!s&&!r)){this.updateAbles();var c=!Ls(s,r),u=c||!Ls(l,i);if(u){var d=i||this.controlBox;d&&this.unsetAbles(),this.updateState({target:r,container:i}),!a&&d&&this.updateRect("End",!1,!1),this._isPropTargetChanged=c}}},e.prototype.waitToChangeTarget=function(){return new Promise(function(){})},e.prototype.triggerEvent=function(n,r){var i=this.props;if(this._emitter.trigger(n,r),i.parentMoveable&&r.isRequest&&!r.isRequestChild)return i.parentMoveable.triggerEvent(n,r,!0);var a=i[n];return a&&a(r)},e.prototype.useCSS=function(n,r){var i=this.props.customStyledMap,a=n+r;return i[a]||(i[a]=Xc(n,r)),i[a]},e.prototype.getState=function(){var n,r=this.props;(r.target||!((n=r.targets)===null||n===void 0)&&n.length)&&(this._hasFirstTarget=!0);var i=this.controlBox,a=r.persistData,o=r.firstRenderState;if(o&&!i)return o;if(!this._hasFirstTarget&&a){var s=_d(a);if(s)return this.updateState(s,!1),this.state}return this.state.isPersisted=!1,this.state},e.prototype.updateSelectors=function(){},e.prototype.unsetAbles=function(){var n=this;this.targetAbles.forEach(function(r){r.unset&&r.unset(n)})},e.prototype.updateAbles=function(n,r){n===void 0&&(n=this.props.ables),r===void 0&&(r="");var i=this.props,a=i.triggerAblesSimultaneously,o=this.getEnabledAbles(n),s="drag".concat(r,"Start"),l="pinch".concat(r,"Start"),c="drag".concat(r,"ControlStart"),u=Fa(o,[s,l],a),d=Fa(o,[c],a);this.enabledAbles=o,this.targetAbles=u,this.controlAbles=d},e.prototype.updateState=function(n,r){if(r){if(this.isUnmounted)return;this.setState(n)}else{var i=this.state;for(var a in n)i[a]=n[a]}},e.prototype.getEnabledAbles=function(n){n===void 0&&(n=this.props.ables);var r=this.props;return n.filter(function(i){return i&&(i.always&&r[i.name]!==!1||r[i.name])})},e.prototype.renderAbles=function(){var n=this,r=this.props,i=r.triggerAblesSimultaneously,a={createElement:Ke};return this.renderState={},C0(od(Fa(this.getEnabledAbles(),["render"],i).map(function(o){var s=o.render;return s(n,a)||[]})).filter(function(o){return o}),function(o){var s=o.key;return s}).map(function(o){return o[0]})},e.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},e.prototype._getRequestStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,s=(o=(a=i.requestStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return J(J([],I(r),!1),I(s),!1)},J([],I(this.props.requestStyles||[]),!1));return n},e.prototype._updateObserver=function(n){this._updateResizeObserver(n),this._updateMutationObserver(n)},e.prototype._updateEvents=function(){var n=this.targetAbles.length,r=this.controlAbles.length,i=this._dragTarget,a=!n&&this.targetGesto||this._isTargetChanged(!0);a&&(Fr(this,!1),this.updateState({gestos:{}})),r||Fr(this,!0),i&&n&&!this.targetGesto&&(this.targetGesto=Ad(this,i,"")),!this.controlGesto&&r&&(this.controlGesto=Rd(this,"Control"))},e.prototype._updateTargets=function(){var n=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=n.dragArea,this._propTarget=n.target,this._originalDragTarget=n.dragTarget||n.target,this._dragTarget=xn(this._originalDragTarget,!0)},e.prototype._renderLines=function(){var n=this.props,r=n,i=r.zoom,a=r.hideDefaultLines,o=r.hideChildMoveableDefaultLines,s=r.parentMoveable;if(a||s&&o)return[];var l=this.getState(),c={createElement:Ke};return l.renderLines.map(function(u,d){return Ci(c,"",u[0],u[1],i,"render-line-".concat(d))})},e.prototype._isTargetChanged=function(n){var r=this.props,i=r.dragTarget||r.target,a=this._prevOriginalDragTarget,o=this._prevDragArea,s=r.dragArea,l=!s&&a!==i,c=(n||s)&&o!==s;return l||c||this._prevPropTarget!=this._propTarget},e.prototype._updateNativeEvents=function(){var n=this,r=this.props,i=r.dragArea?this.areaElement:this.state.target,a=this.events,o=hn(a);if(this._isTargetChanged())for(var s in a){var l=a[s];l&&l.destroy(),a[s]=null}if(i){var c=this.enabledAbles;o.forEach(function(u){var d=Fa(c,[u]),f=d.length>0,h=a[u];if(!f){h&&(h.destroy(),a[u]=null);return}h||(h=new J0(i,n,u),a[u]=h),h.setAbles(d)})}},e.prototype._checkUpdateRootContainer=function(){var n=this.props.rootContainer;!this._rootContainer&&n&&(this._rootContainer=xn(n,!0))},e.prototype._checkUpdateViewContainer=function(){var n=this.props.viewContainer;!this._viewContainer&&n&&(this._viewContainer=xn(n,!0));var r=this._viewContainer;r&&this._changeAbleViewClassNames(J(J([],I(this._getAbleViewClassNames()),!1),[this.isDragging()?O0:""],!1))},e.prototype._changeAbleViewClassNames=function(n){var r=this._viewContainer,i=ad(n.filter(Boolean),function(c){return c}).map(function(c){var u=I(c,1),d=u[0];return d}),a=this._viewClassNames,o=ui(a,i),s=o.removed,l=o.added;s.forEach(function(c){Ul(r,a[c])}),l.forEach(function(c){Tn(r,i[c])}),this._viewClassNames=i},e.prototype._getAbleViewClassNames=function(){var n=this;return(this.getEnabledAbles().map(function(r){var i;return((i=r.viewClassName)===null||i===void 0?void 0:i.call(r,n))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},e.prototype._getAbleClassName=function(n){var r=this;n===void 0&&(n="");var i=this.getEnabledAbles(),a=this.targetGesto,o=this.controlGesto,s=a?.isFlag()?a.getEventData():{},l=o?.isFlag()?o.getEventData():{};return i.map(function(c){var u,d,f,h=c.name,v=((u=c.className)===null||u===void 0?void 0:u.call(c,r))||"";return(!((d=s[h])===null||d===void 0)&&d.isEventStart||!((f=l[h])===null||f===void 0)&&f.isEventStart)&&(v+=" ".concat(ht("".concat(h).concat(n,"-dragging")))),v.trim()}).filter(Boolean).join(" ")},e.prototype._updateResizeObserver=function(n){var r,i=this.props,a=i.target,o=Ee(this.getControlBoxElement());if(!o.ResizeObserver||!a||!i.useResizeObserver){(r=this._reiszeObserver)===null||r===void 0||r.disconnect();return}if(!(n.target===a&&this._reiszeObserver)){var s=new o.ResizeObserver(this.checkUpdateRect);s.observe(a,{box:"border-box"}),this._reiszeObserver=s}},e.prototype._updateMutationObserver=function(n){var r=this,i,a=this.props,o=a.target,s=Ee(this.getControlBoxElement());if(!s.MutationObserver||!o||!a.useMutationObserver){(i=this._mutationObserver)===null||i===void 0||i.disconnect();return}if(!(n.target===o&&this._mutationObserver)){var l=new s.MutationObserver(function(c){var u,d;try{for(var f=Np(c),h=f.next();!h.done;h=f.next()){var v=h.value;v.type==="attributes"&&v.attributeName==="style"&&r.checkUpdateRect()}}catch(p){u={error:p}}finally{try{h&&!h.done&&(d=f.return)&&d.call(f)}finally{if(u)throw u.error}}});l.observe(o,{attributes:!0}),this._mutationObserver=l}},e.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,preventRightClick:!0,preventWheelClick:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Ku,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},e}(_c),Ws={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,e){var n,r=t.props,i=r.targets||[],a=t.getState(),o=a.left,s=a.top,l=a.isPersisted,c=r.zoom||1,u=t.renderGroupRects,d=((n=r.persistData)===null||n===void 0?void 0:n.children)||[];l?i=d.map(function(){return null}):d=[];var f=Wr(t,"parentPosition",[o,s],function(v){return v.join(",")}),h=Wr(t,"requestStyles",t.getRequestChildStyles(),function(v){return v.join(",")});return t.moveables=t.moveables.slice(0,i.length),J(J([],I(i.map(function(v,p){return e.createElement(Hr,{key:"moveable"+p,ref:ec(t,"moveables",p),target:v,origin:!1,requestStyles:h,cssStyled:r.cssStyled,customStyledMap:r.customStyledMap,useResizeObserver:r.useResizeObserver,useMutationObserver:r.useMutationObserver,hideChildMoveableDefaultLines:r.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[o,s],persistData:d[p],zoom:c})})),!1),I(od(u.map(function(v,p){var g=v.pos1,m=v.pos2,x=v.pos3,b=v.pos4,C=[g,m,x,b];return[[0,1],[1,3],[3,2],[2,0]].map(function(E,S){var D=I(E,2),M=D[0],w=D[1];return Ci(e,"",pt(C[M],f),pt(C[w],f),c,"group-rect-".concat(p,"-").concat(S))})}))),!1)}},em=xi("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,e){e.datas.inputTarget=e.inputEvent&&e.inputEvent.target},dragEnd:function(t,e){var n=t.props.target,r=e.inputEvent,i=e.inputTarget,a=t.isMoveableElement(i),o=!a&&t.controlBox.contains(i);if(!(!r||!i||e.isDrag||t.isMoveableElement(i)||o)){var s=n.contains(i);it(t,"onClick",At(t,e,{isDouble:e.isDouble,inputTarget:i,isTarget:n===i,moveableTarget:t.props.target,containsTarget:s}))}},dragGroupEnd:function(t,e){var n=e.inputEvent,r=e.inputTarget;if(!(!n||!r||e.isDrag||t.isMoveableElement(r)||e.datas.inputTarget===r)){var i=t.props.targets,a=i.indexOf(r),o=a>-1,s=!1;a===-1&&(a=Mn(i,function(l){return l.contains(r)}),s=a>-1),it(t,"onClickGroup",At(t,e,{isDouble:e.isDouble,targets:i,inputTarget:r,targetIndex:a,isTarget:o,containsTarget:s,moveableTarget:i[a]}))}},dragControlEnd:function(t,e){this.dragEnd(t,e)},dragGroupControlEnd:function(t,e){this.dragEnd(t,e)}});function Yr(t){var e=t.originalDatas.draggable;return e||(t.originalDatas.draggable={},e=t.originalDatas.draggable),_(_({},t),{datas:e})}var nm=xi("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,e){var n=t.props,r=n.edgeDraggable;return r?du(e,"edgeDraggable",r,t.getState().renderPoses,n.zoom):[]},dragCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&ce(i,ht("direction"))&&ce(i,ht("edge"))&&ce(i,ht("edgeDraggable"))},dragStart:function(t,e){return Oe.dragStart(t,Yr(e))},drag:function(t,e){return Oe.drag(t,Yr(e))},dragEnd:function(t,e){return Oe.dragEnd(t,Yr(e))},dragGroupCondition:function(t,e){var n,r=t.props,i=(n=e.inputEvent)===null||n===void 0?void 0:n.target;return!r.edgeDraggable||!i?!1:!r.draggable&&ce(i,ht("direction"))&&ce(i,ht("line"))},dragGroupStart:function(t,e){return Oe.dragGroupStart(t,Yr(e))},dragGroup:function(t,e){return Oe.dragGroup(t,Yr(e))},dragGroupEnd:function(t,e){return Oe.dragGroupEnd(t,Yr(e))},unset:function(t){return Oe.unset(t)}}),Id={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},Hs=[Td,xd,l0,M0,Oe,nm,xs,T0,A0,Wg,I0,P0,L0,K0,Y0,Q0,Ws,Id,em,md,kd],rm=Hs.reduce(function(t,e){return(e.events||[]).forEach(function(n){Kl(t,n)}),t},[]),im=Hs.reduce(function(t,e){return(e.props||[]).forEach(function(n){Kl(t,n)}),t},[]);function Pd(t,e){var n=I(t,3),r=n[0],i=n[1],a=n[2];return(r*e[0]+i*e[1]+a)/Math.sqrt(r*r+i*i)}function Ya(t,e){var n=I(t,2),r=n[0],i=n[1];return-r*e[0]-i*e[1]}function zd(t,e){return Math.max.apply(Math,J([],I(t.map(function(n){var r=I(n,4),i=r[0],a=r[1],o=r[2],s=r[3];return Math.max(i[e],a[e],o[e],s[e])})),!1))}function Nd(t,e){return Math.min.apply(Math,J([],I(t.map(function(n){var r=I(n,4),i=r[0],a=r[1],o=r[2],s=r[3];return Math.min(i[e],a[e],o[e],s[e])})),!1))}function am(t,e){var n,r,i,a=[0,0],o=[0,0],s=[0,0],l=[0,0],c=0,u=0;if(!t.length)return{pos1:a,pos2:o,pos3:s,pos4:l,minX:0,minY:0,maxX:0,maxY:0,width:c,height:u,rotation:e};var d=Et(e,Re);if(d%90){var f=d/180*Math.PI,h=Math.tan(f),v=-1/h,p=[is,Jc],g=[[0,0],[0,0]],m=[is,Jc],x=[[0,0],[0,0]];t.forEach(function(Z){Z.forEach(function(K){var X=Pd([-h,1,0],K),H=Pd([-v,1,0],K);p[0]>X&&(g[0]=K,p[0]=X),p[1]<X&&(g[1]=K,p[1]=X),m[0]>H&&(x[0]=K,m[0]=H),m[1]<H&&(x[1]=K,m[1]=H)})});var b=I(g,2),C=b[0],E=b[1],S=I(x,2),D=S[0],M=S[1],w=[-h,1,Ya([-h,1],C)],T=[-h,1,Ya([-h,1],E)],k=[-v,1,Ya([-v,1],D)],O=[-v,1,Ya([-v,1],M)];n=I([[w,k],[w,O],[T,k],[T,O]].map(function(Z){var K=I(Z,2),X=K[0],H=K[1];return xa(X,H)[0]}),4),a=n[0],o=n[1],s=n[2],l=n[3],c=m[1]-m[0],u=p[1]-p[0]}else{var R=Nd(t,0),L=Nd(t,1),P=zd(t,0),z=zd(t,1);if(a=[R,L],o=[P,L],s=[R,z],l=[P,z],c=P-R,u=z-L,d%180){var V=[s,a,l,o];r=I(V,4),a=r[0],o=r[1],s=r[2],l=r[3],c=z-L,u=P-R}}if(d%360>180){var V=[l,s,o,a];i=I(V,4),a=i[0],o=i[1],s=i[2],l=i[3]}var N=rr([a,o,s,l]),G=N.minX,W=N.minY,B=N.maxX,q=N.maxY;return{pos1:a,pos2:o,pos3:s,pos4:l,width:c,height:u,minX:G,minY:W,maxX:B,maxY:q,rotation:e}}function Bd(t,e){var n=e.map(function(r){if(qt(r)){var i=Bd(t,r),a=i.length;return a>1?i:a===1?i[0]:null}else{var o=ze(t,function(s){var l=s.manager;return l.props.target===r});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return n.length===1&&qt(n[0])?n[0]:n}var om=function(t){Lr(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.differ=new Hc,n.moveables=[],n.transformOrigin="50% 50%",n.renderGroupRects=[],n._targetGroups=[],n._hasFirstTargets=!1,n}return e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},e.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){var a;i===void 0&&(i=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Br(!0),this.moveables.forEach(function(rt){rt.updateRect(n,!1,!1)});var s=this.props,l=this.moveables,c=o.target||s.target,u=l.map(function(rt){return{finded:!1,manager:rt}}),d=this.props.targetGroups||[],f=Bd(u,d),h=s.useDefaultGroupRotate;f.push.apply(f,J([],I(u.filter(function(rt){var mt=rt.finded;return!mt}).map(function(rt){var mt=rt.manager;return mt})),!1));var v=[],p=!r||n!==""&&s.updateGroup,g=s.defaultGroupRotate||0;if(!this._hasFirstTargets){var m=(a=s.persistData)===null||a===void 0?void 0:a.rotation;m!=null&&(g=m)}function x(rt,mt,vt){var U=rt.map(function(Tt){if(qt(Tt)){var xt=x(Tt,mt),Ct=[xt.pos1,xt.pos2,xt.pos3,xt.pos4];return v.push(xt),{poses:Ct,rotation:xt.rotation}}else return{poses:Ze(Tt.state),rotation:Tt.getRotation()}}),nt=U.map(function(Tt){var xt=Tt.rotation;return xt}),Rt=0,ut=nt[0],dt=nt.every(function(Tt){return Math.abs(ut-Tt)<.1});p?Rt=!h&&dt?ut:g:Rt=!h&&!vt&&dt?ut:mt;var yt=U.map(function(Tt){var xt=Tt.poses;return xt}),Ot=am(yt,Rt);return Ot}var b=x(f,this.rotation,!0);p&&(this.rotation=b.rotation,this.transformOrigin=s.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=d,this.renderGroupRects=v;var C=this.transformOrigin,E=this.rotation,S=this.scale,D=b.width,M=b.height,w=b.minX,T=b.minY,k=D0([[0,0],[D,0],[0,M],[D,M]],Ns(C,D,M),this.rotation/180*Math.PI),O=rr(k.result),R=O.minX,L=O.minY,P=" rotate(".concat(E,"deg)")+" scale(".concat(_e(S[0]),", ").concat(_e(S[1]),")"),z="translate(".concat(-R,"px, ").concat(-L,"px)").concat(P);this.controlBox.style.transform="translate3d(".concat(w,"px, ").concat(T,"px, ").concat(this.props.translateZ||0,")"),c.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(C,";")+"width:".concat(D,"px;height:").concat(M,"px;")+"transform: ".concat(z),o.width=D,o.height=M;var V=this.getContainer(),N=$s(this.controlBox,c,this.controlBox,this.getContainer(),this._rootContainer||V,[]),G=[N.left,N.top],W=I(Ze(N),4),B=W[0],q=W[1],Z=W[2],K=W[3],X=rr([B,q,Z,K]),H=[X.minX,X.minY],et=_e(S[0]*S[1]);N.pos1=pt(B,H),N.pos2=pt(q,H),N.pos3=pt(Z,H),N.pos4=pt(K,H),N.left=w-N.left+H[0],N.top=T-N.top+H[1],N.origin=pt(Ft(G,N.origin),H),N.beforeOrigin=pt(Ft(G,N.beforeOrigin),H),N.originalBeforeOrigin=Ft(G,N.originalBeforeOrigin),N.transformOrigin=pt(Ft(G,N.transformOrigin),H),c.style.transform="translate(".concat(-R-H[0],"px, ").concat(-L-H[1],"px)")+P,Br(),this.updateState(_(_({},N),{posDelta:H,direction:et,beforeDirection:et}),i)},e.prototype.getRect=function(){return _(_({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.triggerEvent=function(n,r,i){if(i||n.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,n,r);this._emitter.trigger(n,r)},e.prototype.getRequestChildStyles=function(){var n=this.getEnabledAbles().reduce(function(r,i){var a,o,s=(o=(a=i.requestChildStyle)===null||a===void 0?void 0:a.call(i))!==null&&o!==void 0?o:[];return J(J([],I(r),!1),I(s),!1)},[]);return n},e.prototype.getMoveables=function(){return J([],I(this.moveables),!1)},e.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,J(J([],I(this.props.ables),!1),[Ws],!1),"Group")},e.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=xn(this._originalDragTarget,!0)},e.prototype._updateEvents=function(){var n=this.state,r=this.props,i=this._prevDragTarget,a=r.dragTarget||this.areaElement,o=r.targets,s=this.differ.update(o),l=s.added,c=s.changed,u=s.removed,d=l.length||u.length;(d||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Fr(this,!1),Fr(this,!0),this.updateState({gestos:{}})),i!==a&&(n.target=null),n.target||(n.target=this.areaElement,this.controlBox.style.display="block"),n.target&&(this.targetGesto||(this.targetGesto=Ad(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=Rd(this,"GroupControl")));var f=!Ls(n.container,r.container);f&&(n.container=r.container),(f||d||this.transformOrigin!==(r.defaultGroupOrigin||"50% 50%")||c.length||o.length&&!dd(this._targetGroups,r.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!d},e.prototype._updateObserver=function(){},e.defaultProps=_(_({},Hr.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),e}(Hr),sm=function(t){Lr(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.moveables=[],n}return e.prototype.render=function(){var n=this,r,i=this.props,a=i.cspNonce,o=i.cssStyled,s=i.persistData,l=i.targets||[],c=l.length,u=this.isUnmounted||!c,d=(r=s?.children)!==null&&r!==void 0?r:[];return u&&!c&&d.length?l=d.map(function(){return null}):u||(d=[]),Ke(o,{cspNonce:a,ref:kn(this,"controlBox"),className:ht("control-box")},l.map(function(f,h){var v,p,g=(p=(v=i.individualGroupableProps)===null||v===void 0?void 0:v.call(i,f,h))!==null&&p!==void 0?p:{};return Ke(Hr,_({key:"moveable"+h,ref:ec(n,"moveables",h)},i,g,{target:f,wrapperMoveable:n,isWrapperMounted:n.isMoveableMounted,persistData:d[h]}))}))},e.prototype.componentDidMount=function(){},e.prototype.componentDidUpdate=function(){},e.prototype.getTargets=function(){return this.props.targets},e.prototype.updateRect=function(n,r,i){i===void 0&&(i=!0),Br(!0),this.moveables.forEach(function(a){a.updateRect(n,r,i)}),Br()},e.prototype.getRect=function(){return _(_({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(n){return n.getRect()})})},e.prototype.request=function(n,r,i){r===void 0&&(r={});var a=this.moveables.map(function(l){return l.request(n,_(_({},r),{isInstant:!1}),!1)}),o=i||r.isInstant,s={request:function(l){return a.forEach(function(c){return c.request(l)}),this},requestEnd:function(){return a.forEach(function(l){return l.requestEnd()}),this}};return o?s.request(r).requestEnd():s},e.prototype.dragStart=function(n,r){r===void 0&&(r=n.target);var i=r,a=ze(this.moveables,function(o){var s=o.getTargets()[0],l=o.getControlBoxElement(),c=o.getDragElement();return!s||!c?!1:c===i||c.contains(i)||c!==s&&s===i||s.contains(i)||l===i||l.contains(i)});return a&&a.dragStart(n,r),this},e.prototype.hitTest=function(){return 0},e.prototype.isInside=function(){return!1},e.prototype.isDragging=function(){return!1},e.prototype.getDragElement=function(){return null},e.prototype.getMoveables=function(){return J([],I(this.moveables),!1)},e.prototype.updateRenderPoses=function(){},e.prototype.checkUpdate=function(){},e.prototype.triggerEvent=function(){},e.prototype.updateAbles=function(){},e.prototype._updateEvents=function(){},e.prototype._updateObserver=function(){},e}(Hr);function jd(t,e){var n=[];return t.forEach(function(r){if(r){if(ye(r)){e[r]&&n.push.apply(n,J([],I(e[r]),!1));return}qt(r)?n.push.apply(n,J([],I(jd(r,e)),!1)):n.push(r)}}),n}function Vd(t,e){var n=[];return t.forEach(function(r){if(r){if(ye(r)){e[r]&&n.push.apply(n,J([],I(e[r]),!1));return}qt(r)?n.push(Vd(r,e)):n.push(r)}}),n}function Fd(t,e){return t.length!==e.length||t.some(function(n,r){var i=e[r];return!n&&!i?!1:n!=i?qt(n)&&qt(i)?Fd(n,i):!0:!1})}var Gd=function(t){Lr(e,t);function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.refTargets=[],n.selectorMap={},n._differ=new Hc,n._elementTargets=[],n._tmpRefTargets=[],n._tmpSelectorMap={},n._onChangeTargets=null,n}return e.makeStyled=function(){var n={},r=this.getTotalAbles();r.forEach(function(a){var o=a.css;o&&o.forEach(function(s){n[s]=!0})});var i=hn(n).join(`
`);this.defaultStyled=Xc("div",tc(ns,Xp+i))},e.getTotalAbles=function(){return J([xd,Ws,Id,md],I(this.defaultAbles),!1)},e.prototype.render=function(){var n,r=this.constructor;r.defaultStyled||r.makeStyled();var i=this.props,a=i.ables,o=i.props,s=Pp(i,["ables","props"]),l=I(this._updateRefs(!0),2),c=l[0],u=l[1],d=jd(c,u),f=d.length>1,h=r.getTotalAbles(),v=J(J([],I(h),!1),I(a||[]),!1),p=_(_(_({},s),o||{}),{ables:v,cssStyled:r.defaultStyled,customStyledMap:r.customStyledMap});this._elementTargets=d;var g=null,m=this.moveable,x=s.persistData;if(x?.children&&(f=!0),s.individualGroupable)return Ke(sm,_({key:"individual-group",ref:kn(this,"moveable")},p,{target:null,targets:d}));if(f){var b=Vd(c,u);if(m&&!m.props.groupable&&!m.props.individualGroupable){var C=m.props.target;C&&d.indexOf(C)>-1&&(g=_({},m.state))}return Ke(om,_({key:"group",ref:kn(this,"moveable")},p,(n=s.groupableProps)!==null&&n!==void 0?n:{},{target:null,targets:d,targetGroups:b,firstRenderState:g}))}else{var E=d[0];if(m&&(m.props.groupable||m.props.individualGroupable)){var S=m.moveables||[],D=ze(S,function(M){return M.props.target===E});D&&(g=_({},D.state))}return Ke(Hr,_({key:"single",ref:kn(this,"moveable")},p,{target:E,firstRenderState:g}))}},e.prototype.componentDidMount=function(){this._checkChangeTargets()},e.prototype.componentDidUpdate=function(){this._checkChangeTargets()},e.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},e.prototype.getTargets=function(){var n,r;return(r=(n=this.moveable)===null||n===void 0?void 0:n.getTargets())!==null&&r!==void 0?r:[]},e.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs(),this.forceUpdate()},e.prototype.waitToChangeTarget=function(){var n=this,r;return this._onChangeTargets=function(){n._onChangeTargets=null,r()},new Promise(function(i){r=i})},e.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},e.prototype.getManager=function(){return this.moveable},e.prototype.getMoveables=function(){return this.moveable.getMoveables()},e.prototype.getDragElement=function(){return this.moveable.getDragElement()},e.prototype._updateRefs=function(n){var r=this.refTargets,i=Ps(this.props.target||this.props.targets),a=typeof document<"u",o=Fd(r,i),s=this.selectorMap,l={};return this.refTargets.forEach(function c(u){if(ye(u)){var d=s[u];d?l[u]=s[u]:a&&(o=!0,l[u]=[].slice.call(document.querySelectorAll(u)))}else qt(u)&&u.forEach(c)}),this._tmpRefTargets=i,this._tmpSelectorMap=l,[i,l,!n&&o]},e.prototype._checkChangeTargets=function(){var n,r,i;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var a=this._differ.update(this._elementTargets),o=a.added,s=a.removed,l=o.length||s.length;l&&((r=(n=this.props).onChangeTargets)===null||r===void 0||r.call(n,{moveable:this.moveable,targets:this._elementTargets}),(i=this._onChangeTargets)===null||i===void 0||i.call(this));var c=I(this._updateRefs(),3),u=c[0],d=c[1],f=c[2];this.refTargets=u,this.selectorMap=d,f&&this.forceUpdate()},e.defaultAbles=[],e.customStyledMap={},e.defaultStyled=null,zp([pv(eu)],e.prototype,"moveable",void 0),e}(_c),lm=function(t){Lr(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.defaultAbles=Hs,e}(Gd);function tb(t){var e;return e=function(n){Lr(r,n);function r(){return n!==null&&n.apply(this,arguments)||this}return r}(Gd),e.defaultAbles=t,e}var Ys=function(t,e){return Ys=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ys(t,e)};function Ks(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ys(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Ai=function(){return Ai=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ai.apply(this,arguments)};function cm(t,e,n,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}var um=function(t){Ks(e,t);function e(r){var i=t.call(this,r)||this;return i.state={},i.state=i.props,i}var n=e.prototype;return n.render=function(){return Ke(lm,Ai({ref:kn(this,"moveable")},this.state))},e}(zo),dm=im,fm=eu,hm=rm,vm=function(t){Ks(e,t);function e(r,i){i===void 0&&(i={});var a=t.call(this)||this;a.containerProvider=null,a.selfElement=null,a._warp=!1;var o=Ai({},i),s={};hm.forEach(function(u){s[ea("on ".concat(u))]=function(d){return a.trigger(u,d)}});var l;i.warpSelf?(delete i.warpSelf,a._warp=!0,l=r):(l=Se(r).createElement("div"),r.appendChild(l)),a.containerProvider=Vc(Ke(um,Ai({ref:kn(a,"innerMoveable")},o,s)),l),a.selfElement=l;var c=o.target;return qt(c)&&c.length>1&&a.updateRect(),a}var n=e.prototype;return n.setState=function(r,i){this.innerMoveable.setState(r,i)},n.forceUpdate=function(r){this.innerMoveable.forceUpdate(r)},n.dragStart=function(r,i){i===void 0&&(i=r.target);var a=this.innerMoveable;a.$_timer&&this.forceUpdate(),this.getMoveable().dragStart(r,i)},n.destroy=function(){var r,i=this.selfElement;Vc(null,i,this.containerProvider),this._warp||(r=i?.parentElement)===null||r===void 0||r.removeChild(i),this.containerProvider=null,this.off(),this.selfElement=null,this.innerMoveable=null},n.getMoveable=function(){return this.innerMoveable.moveable},e=cm([aa(fm,function(r,i){r[i]||(r[i]=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var s=this.getMoveable();if(!(!s||!s[i]))return s[i].apply(s,a)})}),aa(dm,function(r,i){Object.defineProperty(r,i,{get:function(){return this.getMoveable().props[i]},set:function(a){var o;this.setState((o={},o[i]=a,o))},enumerable:!0,configurable:!0})})],e),e}(Qn),pm=function(t){Ks(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(vm);function eb(t,e,n){return getElementInfo$1(t,e,n)}function nb(t,e){return makeAble$1(t,e)}var Xs=function(t,e){return Xs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Xs(t,e)};function gm(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Xs(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var mm="object",xm="string";function $d(t){return t&&typeof t===mm}function Wd(t){return Array.isArray(t)}function Hd(t){return typeof t===xm}function ym(t,e,n){n===void 0&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function Us(t,e,n,r){t.addEventListener(e,n,r)}function Zs(t,e,n,r){t.removeEventListener(e,n,r)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Qs=function(){return Qs=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Qs.apply(this,arguments)};function bm(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}var Cm=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(n,r){if($d(n))for(var i in n)this.on(i,n[i]);else this._addEvent(n,r,{});return this},e.off=function(n,r){if(!n)this._events={};else if($d(n))for(var i in n)this.off(i);else if(!r)this._events[n]=[];else{var a=this._events[n];if(a){var o=ym(a,function(s){return s.listener===r});o>-1&&a.splice(o,1)}}return this},e.once=function(n,r){var i=this;return r&&this._addEvent(n,r,{once:!0}),new Promise(function(a){i._addEvent(n,a,{once:!0})})},e.emit=function(n,r){var i=this;r===void 0&&(r={});var a=this._events[n];if(!n||!a)return!0;var o=!1;return r.eventType=n,r.stop=function(){o=!0},r.currentTarget=this,bm(a).forEach(function(s){s.listener(r),s.once&&i.off(n,s.listener)}),!o},e.trigger=function(n,r){return r===void 0&&(r={}),this.emit(n,r)},e._addEvent=function(n,r,i){var a=this._events;a[n]=a[n]||[];var o=a[n];o.push(Qs({listener:r},i))},t}();function Sm(t,e){return e={exports:{}},t(e,e.exports),e.exports}var Ri=Sm(function(t,e){function n(l){if(l&&typeof l=="object"){var c=l.which||l.keyCode||l.charCode;c&&(l=c)}if(typeof l=="number")return o[l];var u=String(l),d=r[u.toLowerCase()];if(d)return d;var d=i[u.toLowerCase()];if(d)return d;if(u.length===1)return u.charCodeAt(0)}n.isEventKey=function(c,u){if(c&&typeof c=="object"){var d=c.which||c.keyCode||c.charCode;if(d==null)return!1;if(typeof u=="string"){var f=r[u.toLowerCase()];if(f)return f===d;var f=i[u.toLowerCase()];if(f)return f===d}else if(typeof u=="number")return u===d;return!1}},e=t.exports=n;var r=e.code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=e.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(a=97;a<123;a++)r[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)r[a-48]=a;for(a=1;a<13;a++)r["f"+a]=a+111;for(a=0;a<10;a++)r["numpad "+a]=a+96;var o=e.names=e.title={};for(a in r)o[r[a]]=a;for(var s in i)r[s]=i[s]}),rb=Ri.code,ib=Ri.codes,ab=Ri.aliases,Em=Ri.names,ob=Ri.title,Yd={"+":"plus","left command":"meta","right command":"meta"},Kd={shift:1,ctrl:2,alt:3,meta:4};function Xd(t,e){var n=(Em[t]||e||"").toLowerCase();for(var r in Yd)n=n.replace(r,Yd[r]);return n.replace(/\s/g,"")}function Ud(t,e){e===void 0&&(e=Xd(t.keyCode,t.key));var n=wm(t);return n.indexOf(e)===-1&&n.push(e),n.filter(Boolean)}function wm(t){var e=[t.shiftKey&&"shift",t.ctrlKey&&"ctrl",t.altKey&&"alt",t.metaKey&&"meta"];return e.filter(Boolean)}function Zd(t){var e=t.slice();return e.sort(function(n,r){var i=Kd[n]||5,a=Kd[r]||5;return i-a}),e}var Qd,Dm=function(t){gm(e,t);function e(r){r===void 0&&(r=window);var i=t.call(this)||this;return i.container=r,i.ctrlKey=!1,i.altKey=!1,i.shiftKey=!1,i.metaKey=!1,i.clear=function(){return i.ctrlKey=!1,i.altKey=!1,i.shiftKey=!1,i.metaKey=!1,i},i.keydownEvent=function(a){i.triggerEvent("keydown",a)},i.keyupEvent=function(a){i.triggerEvent("keyup",a)},i.blur=function(){i.clear(),i.trigger("blur")},Us(r,"blur",i.blur),Us(r,"keydown",i.keydownEvent),Us(r,"keyup",i.keyupEvent),i}var n=e.prototype;return Object.defineProperty(e,"global",{get:function(){return Qd||(Qd=new e)},enumerable:!1,configurable:!0}),e.setGlobal=function(){return this.global},n.destroy=function(){var r=this.container;this.clear(),this.off(),Zs(r,"blur",this.blur),Zs(r,"keydown",this.keydownEvent),Zs(r,"keyup",this.keyupEvent)},n.keydown=function(r,i){return this.addEvent("keydown",r,i)},n.offKeydown=function(r,i){return this.removeEvent("keydown",r,i)},n.offKeyup=function(r,i){return this.removeEvent("keyup",r,i)},n.keyup=function(r,i){return this.addEvent("keyup",r,i)},n.addEvent=function(r,i,a){return Wd(i)?this.on(r+"."+Zd(i).join("."),a):Hd(i)?this.on(r+"."+i,a):this.on(r,i),this},n.removeEvent=function(r,i,a){return Wd(i)?this.off(r+"."+Zd(i).join("."),a):Hd(i)?this.off(r+"."+i,a):this.off(r,i),this},n.triggerEvent=function(r,i){this.ctrlKey=i.ctrlKey,this.shiftKey=i.shiftKey,this.altKey=i.altKey,this.metaKey=i.metaKey;var a=Xd(i.keyCode,i.key),o=a==="ctrl"||a==="shift"||a==="meta"||a==="alt",s={key:a,isToggle:o,inputEvent:i,keyCode:i.keyCode,ctrlKey:i.ctrlKey,altKey:i.altKey,shiftKey:i.shiftKey,metaKey:i.metaKey};this.trigger(r,s),this.trigger(r+"."+a,s);var l=Ud(i,a);l.length>1&&this.trigger(r+"."+l.join("."),s)},e}(Cm);const Mm=Dm;var qs=function(t,e){return qs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},qs(t,e)};function qd(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");qs(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var de=function(){return de=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},de.apply(this,arguments)};function Tm(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function km(t,e,n,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a}function Oi(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return t.concat(a||Array.prototype.slice.call(e))}function Am(t){if("touches"in t){var e=t.touches[0]||t.changedTouches[0];return{clientX:e.clientX,clientY:e.clientY}}else return{clientX:t.clientX,clientY:t.clientY}}function Rm(t){if(typeof Map>"u")return t.filter(function(n,r){return t.indexOf(n)===r});var e=new Map;return t.filter(function(n){return e.has(n)?!1:(e.set(n,!0),!0)})}function Om(t,e,n){var r=Se(t);return r.elementFromPoint&&r.elementFromPoint(e,n)||null}function Jd(t,e,n){var r=t.tag,i=t.children,a=t.attributes,o=t.className,s=t.style,l=e||Se(n).createElement(r);for(var c in a)l.setAttribute(c,a[c]);var u=l.children;if(i.forEach(function(f,h){Jd(f,u[h],l)}),o&&o.split(/\s+/g).forEach(function(f){f&&!ce(l,f)&&Tn(l,f)}),s){var d=l.style;for(var c in s)d[c]=s[c]}return!e&&n&&n.appendChild(l),l}function Lm(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e||{},a=i.className,o=a===void 0?"":a,s=i.style,l=s===void 0?{}:s,c=Tm(i,["className","style"]);return{tag:t,className:o,style:l,attributes:c,children:n}}function Js(t,e,n){t!==e&&n(t,e)}function tf(t,e,n){var r;n===void 0&&(n=t.data.boundArea);var i=t.distX,a=i===void 0?0:i,o=t.distY,s=o===void 0?0:o,l=t.data,c=l.startX,u=l.startY;if(e>0){var d=Math.sqrt((a*a+s*s)/(1+e*e)),f=e*d;a=(a>=0?1:-1)*f,s=(s>=0?1:-1)*d}var h=Math.abs(a),v=Math.abs(s),p=a<0?c-n.left:n.right-c,g=s<0?u-n.top:n.bottom-u;r=go([h,v],[0,0],[p,g],!!e),h=r[0],v=r[1],a=(a>=0?1:-1)*h,s=(s>=0?1:-1)*v;var m=Math.min(0,a),x=Math.min(0,s),b=c+m,C=u+x;return{left:b,top:C,right:b+h,bottom:C+v,width:h,height:v}}function Ka(t){var e=t.getBoundingClientRect(),n=e.left,r=e.top,i=e.width,a=e.height;return{pos1:[n,r],pos2:[n+i,r],pos3:[n,r+a],pos4:[n+i,r+a]}}function ef(t,e,n){var r=Rr(t,e),i=r.list,a=r.prevList,o=r.added,s=r.removed,l=r.maintained;return Oi(Oi(Oi([],o.map(function(c){return i[c]}),!0),s.map(function(c){return a[c]}),!0),n?l.map(function(c){var u=c[1];return i[u]}):[],!0)}function nf(t){for(var e=0,n=t.length,r=1;r<n;++r)e=Math.max(vn(t[r],t[r-1]),e);return e}var rf=wo(`
:host {
    position: fixed;
    display: none;
    border: 1px solid #4af;
    background: rgba(68, 170, 255, 0.5);
    pointer-events: none;
    will-change: transform;
    z-index: 100;
}
`),af="selecto-selection ".concat(rf.className),of=["className","boundContainer","selectableTargets","selectByClick","selectFromInside","continueSelect","continueSelectWithoutDeselect","toggleContinueSelect","toggleContinueSelectWithoutDeselect","keyContainer","hitRate","scrollOptions","checkInput","preventDefault","ratio","getElementRect","preventDragFromInside","rootContainer","dragCondition","clickBySelectEnd","checkOverflow","innerScrollOptions"],sb=Oi(["dragContainer","cspNonce","preventClickEventOnDrag","preventClickEventOnDragStart","preventRightClick"],of,!0),lb={className:String,boundContainer:null,portalContainer:null,container:null,dragContainer:null,selectableTargets:Array,selectByClick:Boolean,selectFromInside:Boolean,continueSelect:Boolean,toggleContinueSelect:Array,toggleContinueSelectWithoutDeselect:Array,keyContainer:null,hitRate:Number,scrollOptions:Object,checkInput:Boolean,preventDefault:Boolean,cspNonce:String,ratio:Number,getElementRect:Function,preventDragFromInside:Boolean,rootContainer:Object,dragCondition:Function,clickBySelectEnd:Boolean,continueSelectWithoutDeselect:Boolean,preventClickEventOnDragStart:Boolean,preventClickEventOnDrag:Boolean,checkOverflow:Boolean,innerScrollOptions:Object},cb=null,ub=null,_m=function(t){qd(e,t);function e(r){r===void 0&&(r={});var i=t.call(this)||this;i.selectedTargets=[],i.dragScroll=new Kc,i._onDragStart=function(s,l){var c=s.data,u=s.clientX,d=s.clientY,f=s.inputEvent,h=i.options,v=h.selectFromInside,p=h.selectByClick,g=h.rootContainer,m=h.boundContainer,x=h.preventDragFromInside,b=x===void 0?!0:x,C=h.clickBySelectEnd,E=h.dragCondition;if(E&&!E(s)){s.stop();return}c.data={};var S=Ee(i.container);c.innerWidth=S.innerWidth,c.innerHeight=S.innerHeight,i.findSelectableTargets(c),c.startSelectedTargets=i.selectedTargets,c.scaleMatrix=Wo(),c.containerX=0,c.containerY=0;var D=i.container,M={left:-1/0,top:-1/0,right:1/0,bottom:1/0};if(g){var w=i.container.getBoundingClientRect();c.containerX=w.left,c.containerY=w.top,c.scaleMatrix=xp(i.container,g)}if(m){var T=Te(m)&&"element"in m?de({left:!0,top:!0,bottom:!0,right:!0},m):{element:m,left:!0,top:!0,bottom:!0,right:!0},k=T.element,O=void 0;if(k){ye(k)?O=Se(D).querySelector(k):k===!0?O=i.container:O=k;var R=O.getBoundingClientRect();T.left&&(M.left=R.left),T.top&&(M.top=R.top),T.right&&(M.right=R.right),T.bottom&&(M.bottom=R.bottom)}}c.boundArea=M;var L={left:u,top:d,right:u,bottom:d,width:0,height:0},P=[],z=p&&!C,V=!1;if(!v||z){var N=i._findElement(l||f.target,c.selectableTargets);V=!!N,z&&(P=N?[N]:[])}var G=!v&&V;if(G&&!p)return s.stop(),!1;var W=f.type,B=W==="mousedown"||W==="touchstart",q=!s.isClick&&B?i.emit("dragStart",de(de({},s),{data:c.data})):!0;if(!q)return s.stop(),!1;if(i.continueSelect?(P=ef(i.selectedTargets,P,i.continueSelectWithoutDeselect),c.startPassedTargets=i.selectedTargets):c.startPassedTargets=[],i._select(P,L,s,!0,G&&p&&!C&&b),c.startX=u,c.startY=d,c.selectFlag=!1,c.preventDragFromInside=!1,f.target){var Z=pa(c.scaleMatrix,[u-c.containerX,d-c.containerY]);i.target.style.cssText+="position: ".concat(g?"absolute":"fixed",";")+"left:0px;top:0px;"+"transform: translate(".concat(Z[0],"px, ").concat(Z[1],"px)")}if(G&&p&&!C)f.preventDefault(),b&&(i._selectEnd(c.startSelectedTargets,c.startPassedTargets,L,s,!0),c.preventDragFromInside=!0);else{c.selectFlag=!0;var K=i.options,X=K.scrollOptions,H=K.innerScrollOptions,et=!1;if(H){for(var rt=s.inputEvent,mt=rt.target,vt=null,U=mt;U&&U!==Se(D).body;){var nt=getComputedStyle(U).overflow!=="visible";if(nt){vt=U;break}U=U.parentElement}vt&&(c.innerScrollOptions=de({container:vt,checkScrollEvent:!0},H===!0?{}:H),i.dragScroll.dragStart(s,c.innerScrollOptions),et=!0)}!et&&X&&X.container&&i.dragScroll.dragStart(s,X),G&&p&&C&&(c.selectFlag=!1,s.preventDrag())}return!0},i._onDrag=function(s){if(s.data.selectFlag){var l=i.scrollOptions,c=s.data.innerScrollOptions,u=c||l?.container;if(u&&!s.isScroll&&i.dragScroll.drag(s,c||l))return}i._checkSelected(s)},i._onDragEnd=function(s){var l=s.data,c=s.inputEvent,u=tf(s,i.options.ratio),d=l.selectFlag,f=i.container;if(c&&i.emit("dragEnd",de(de({isDouble:!!s.isDouble,isClick:!!s.isClick,isDrag:!1,isSelect:d},s),{data:l.data,rect:u})),i.target.style.cssText+="display: none;",d)l.selectFlag=!1,i.dragScroll.dragEnd();else if(i.selectByClick&&i.clickBySelectEnd){var h=i._findElement(c?.target||Om(f,s.clientX,s.clientY),l.selectableTargets);i._select(h?[h]:[],u,s)}l.preventDragFromInside||i._selectEnd(l.startSelectedTargets,l.startPassedTargets,u,s)},i._onKeyDown=function(s){var l=i.options,c=!1;if(!i._keydownContinueSelect){var u=i._sameCombiKey(s,l.toggleContinueSelect);i._keydownContinueSelect=u,c||(c=u)}if(!i._keydownContinueSelectWithoutDeselection){var u=i._sameCombiKey(s,l.toggleContinueSelectWithoutDeselect);i._keydownContinueSelectWithoutDeselection=u,c||(c=u)}c&&i.emit("keydown",{keydownContinueSelect:i._keydownContinueSelect,keydownContinueSelectWithoutDeselection:i._keydownContinueSelectWithoutDeselection})},i._onKeyUp=function(s){var l=i.options,c=!1;if(i._keydownContinueSelect){var u=i._sameCombiKey(s,l.toggleContinueSelect,!0);i._keydownContinueSelect=!u,c||(c=u)}if(i._keydownContinueSelectWithoutDeselection){var u=i._sameCombiKey(s,l.toggleContinueSelectWithoutDeselect,!0);i._keydownContinueSelectWithoutDeselection=!u,c||(c=u)}c&&i.emit("keyup",{keydownContinueSelect:i._keydownContinueSelect,keydownContinueSelectWithoutDeselection:i._keydownContinueSelectWithoutDeselection})},i._onBlur=function(){(i._keydownContinueSelect||i._keydownContinueSelectWithoutDeselection)&&(i._keydownContinueSelect=!1,i._keydownContinueSelectWithoutDeselection=!1,i.emit("keyup",{keydownContinueSelect:i._keydownContinueSelect,keydownContinueSelectWithoutDeselection:i._keydownContinueSelectWithoutDeselection}))},i._onDocumentSelectStart=function(s){var l=Se(i.container);if(i.gesto.isFlag()){var c=i.dragContainer;c===Ee(i.container)&&(c=l.documentElement);var u=pn(c)?[c]:[].slice.call(c),d=s.target;u.some(function(f){if(f===d||f.contains(d))return s.preventDefault(),!0})}},i.target=r.portalContainer;var a=r.container;i.options=de({className:"",portalContainer:null,container:null,dragContainer:null,selectableTargets:[],selectByClick:!0,selectFromInside:!0,clickBySelectEnd:!1,hitRate:100,continueSelect:!1,continueSelectWithoutDeselect:!1,toggleContinueSelect:null,toggleContinueSelectWithoutDeselect:null,keyContainer:null,scrollOptions:null,checkInput:!1,preventDefault:!1,boundContainer:!1,preventDragFromInside:!0,dragCondition:null,rootContainer:null,checkOverflow:!1,innerScrollOptions:!1,getElementRect:Ka,cspNonce:"",ratio:0},r);var o=i.options.portalContainer;return o&&(a=o.parentElement),i.container=a||document.body,i.initElement(),i.initDragScroll(),i.setKeyController(),i}var n=e.prototype;return n.setSelectedTargets=function(r){var i=this.selectedTargets,a=Rr(i,r),o=a.added,s=a.removed,l=a.prevList,c=a.list;return this.selectedTargets=r,{added:o.map(function(u){return c[u]}),removed:s.map(function(u){return l[u]}),beforeSelected:i,selected:r}},n.setSelectedTargetsByPoints=function(r,i){var a=Math.min(r[0],i[0]),o=Math.min(r[1],i[1]),s=Math.max(r[0],i[0]),l=Math.max(r[1],i[1]),c={left:a,top:o,right:s,bottom:l,width:s-a,height:l-o},u={ignoreClick:!0};this.findSelectableTargets(u);var d=this.hitTest(c,u,!0,null),f=this.setSelectedTargets(d);return de(de({},f),{rect:c})},n.selectTargetsByPoints=function(r,i){var a=new MouseEvent("mousedown",{clientX:r[0],clientY:r[1],cancelable:!0,bubbles:!0}),o=new MouseEvent("mousemove",{clientX:i[0],clientY:i[1],cancelable:!0,bubbles:!0}),s=new MouseEvent("mousemove",{clientX:i[0],clientY:i[1],cancelable:!0,bubbles:!0}),l=this.gesto,c=l.onDragStart(a);c!==!1&&(l.onDrag(o),l.onDragEnd(s))},n.getSelectedTargets=function(){return this.selectedTargets},n.triggerDragStart=function(r){return this.gesto.triggerDragStart(r),this},n.destroy=function(){var r;this.off(),this.keycon&&this.keycon.destroy(),this.gesto.unset(),this.injectResult.destroy(),this.dragScroll.dragEnd(),Jt(document,"selectstart",this._onDocumentSelectStart),this.options.portalContainer||(r=this.target.parentElement)===null||r===void 0||r.removeChild(this.target),this.keycon=null,this.gesto=null,this.injectResult=null,this.target=null,this.container=null,this.options=null},n.getElementPoints=function(r){var i=this.getElementRect||Ka,a=i(r),o=[a.pos1,a.pos2,a.pos4,a.pos3];if(i!==Ka){var s=r.getBoundingClientRect();return Ko(o,s)}return o},n.getSelectableElements=function(){var r=this.container,i=[];return this.options.selectableTargets.forEach(function(a){if(ta(a)){var o=a();o&&i.push.apply(i,[].slice.call(o))}else if(pn(a))i.push(a);else if(Te(a))i.push(a.value||a.current);else{var s=[].slice.call(Se(r).querySelectorAll(a));i.push.apply(i,s)}}),i},n.checkScroll=function(){if(this.gesto.isFlag()){var r=this.scrollOptions,i=this.gesto.getEventData().innerScrollOptions,a=i||r?.container;a&&this.dragScroll.checkScroll(de({inputEvent:this.gesto.getCurrentEvent()},i||r))}},n.findSelectableTargets=function(r){var i=this;r===void 0&&(r=this.gesto.getEventData());var a=this.getSelectableElements(),o=a.map(function(d){return i.getElementPoints(d)});r.selectableTargets=a,r.selectablePoints=o,r.selectableParentMap=null;var s=this.options,l=s.checkOverflow||s.innerScrollOptions,c=Se(this.container);if(l){var u=new Map;r.selectableInnerScrollParentMap=u,r.selectableInnerScrollPathsList=a.map(function(d,f){for(var h=d.parentElement,v=[],p=[],g=function(){var m=u.get(h);if(!m){var x=getComputedStyle(h).overflow!=="visible";if(x){var b=Ka(h);m={parentElement:h,indexes:[],points:[b.pos1,b.pos2,b.pos4,b.pos3],paths:Oi([],p,!0)},v.push(h),v.forEach(function(C){u.set(C,m)}),v=[]}}m?(h=m.parentElement,u.get(h).indexes.push(f),p.push(h)):v.push(h),h=h.parentElement};h&&h!==c.body;)g();return p})}return s.checkOverflow||(r.selectableInners=a.map(function(){return!0})),this._refreshGroups(r),a},n.clickTarget=function(r,i){var a=Am(r),o=a.clientX,s=a.clientY,l={data:{selectFlag:!1},clientX:o,clientY:s,inputEvent:r,isClick:!0,isTrusted:!1,stop:function(){return!1}};return this._onDragStart(l,i)&&this._onDragEnd(l),this},n.setKeyController=function(){var r=this.options,i=r.keyContainer,a=r.toggleContinueSelect,o=r.toggleContinueSelectWithoutDeselect;this.keycon&&(this.keycon.destroy(),this.keycon=null),(a||o)&&(this.keycon=new Mm(i||Ee(this.container)),this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on("blur",this._onBlur))},n.setClassName=function(r){this.options.className=r,this.target.setAttribute("class","".concat(af," ").concat(r||""))},n.setKeyEvent=function(){var r=this.options,i=r.toggleContinueSelect,a=r.toggleContinueSelectWithoutDeselect;!i&&!a||this.keycon||this.setKeyController()},n.setKeyContainer=function(r){var i=this,a=this.options;Js(a.keyContainer,r,function(){a.keyContainer=r,i.setKeyController()})},n.getContinueSelect=function(){var r=this.options,i=r.continueSelect,a=r.toggleContinueSelect;return!a||!this._keydownContinueSelect?i:!i},n.getContinueSelectWithoutDeselect=function(){var r=this.options,i=r.continueSelectWithoutDeselect,a=r.toggleContinueSelectWithoutDeselect;return!a||!this._keydownContinueSelectWithoutDeselection?i:!i},n.setToggleContinueSelect=function(r){var i=this,a=this.options;Js(a.toggleContinueSelect,r,function(){a.toggleContinueSelect=r,i.setKeyEvent()})},n.setToggleContinueSelectWithoutDeselect=function(r){var i=this,a=this.options;Js(a.toggleContinueSelectWithoutDeselect,r,function(){a.toggleContinueSelectWithoutDeselect=r,i.setKeyEvent()})},n.setPreventDefault=function(r){this.gesto.options.preventDefault=r},n.setCheckInput=function(r){this.gesto.options.checkInput=r},n.initElement=function(){var r=this.options,i=r.dragContainer,a=r.checkInput,o=r.preventDefault,s=r.preventClickEventOnDragStart,l=r.preventClickEventOnDrag,c=r.preventClickEventByCondition,u=r.preventRightClick,d=u===void 0?!0:u,f=r.className,h=this.container;this.target=Jd(Lm("div",{className:"".concat(af," ").concat(f||"")}),this.target,h);var v=this.target;this.dragContainer=typeof i=="string"?[].slice.call(Se(h).querySelectorAll(i)):i||this.target.parentNode,this.gesto=new ia(this.dragContainer,{checkWindowBlur:!0,container:Ee(h),checkInput:a,preventDefault:o,preventClickEventOnDragStart:s,preventClickEventOnDrag:l,preventClickEventByCondition:c,preventRightClick:d}).on({dragStart:this._onDragStart,drag:this._onDrag,dragEnd:this._onDragEnd}),re(document,"selectstart",this._onDocumentSelectStart),this.injectResult=rf.inject(v,{nonce:this.options.cspNonce})},n.hitTest=function(r,i,a,o){var s=this.options,l=s.hitRate,c=s.selectByClick,u=r.left,d=r.top,f=r.right,h=r.bottom,v=i.innerGroups,p=i.innerWidth,g=i.innerHeight,m=o?.clientX,x=o?.clientY,b=i.ignoreClick,C=[[u,d],[f,d],[f,h],[u,h]],E=function(N,G){var W=Zn(typeof l=="function"?"".concat(l(G)):"".concat(l)),B=b?!1:ma([m,x],N);if(!a&&c&&B)return!0;var q=Qo(C,N);if(!q.length)return!1;var Z=mi(q),K=0;if(Z===0&&mi(N)===0?(K=nf(N),Z=nf(q)):K=mi(N),W.unit==="px")return Z>=W.value;var X=nn(Math.round(Z/K*100),0,100);return X>=Math.min(100,W.value)},S=i.selectableTargets,D=i.selectablePoints,M=i.selectableInners;if(!v)return S.filter(function(N,G){return M[G]?E(D[G],S[G]):!1});for(var w=[],T=Math.floor(u/p),k=Math.floor(f/p),O=Math.floor(d/g),R=Math.floor(h/g),L=T;L<=k;++L){var P=v[L];if(P)for(var z=O;z<=R;++z){var V=P[z];V&&V.forEach(function(N){var G=D[N],W=M[N],B=S[N];W&&E(G,B)&&w.push(B)})}}return Rm(w)},n.initDragScroll=function(){var r=this;this.dragScroll.on("scrollDrag",function(i){var a=i.next;a(r.gesto.getCurrentEvent())}).on("scroll",function(i){var a=i.container,o=i.direction,s=r.gesto.getEventData().innerScrollOptions;s?r.emit("innerScroll",{container:a,direction:o}):r.emit("scroll",{container:a,direction:o})}).on("move",function(i){var a=i.offsetX,o=i.offsetY,s=i.inputEvent,l=r.gesto;if(!(!l||!l.isFlag())){var c=r.gesto.getEventData(),u=c.boundArea;c.startX-=a,c.startY-=o;var d=r.gesto.getEventData().innerScrollOptions,f=d?.container,h=!1;if(f){var v=c.selectableInnerScrollParentMap,p=v.get(f);p&&(p.paths.forEach(function(g){var m=v.get(g);m.points.forEach(function(x){x[0]-=a,x[1]-=o})}),p.indexes.forEach(function(g){c.selectablePoints[g].forEach(function(m){m[0]-=a,m[1]-=o})}),h=!0)}h||c.selectablePoints.forEach(function(g){g.forEach(function(m){m[0]-=a,m[1]-=o})}),r._refreshGroups(c),u.left-=a,u.right-=a,u.top-=o,u.bottom-=o,r.gesto.scrollBy(a,o,s.inputEvent),r._checkSelected(r.gesto.getCurrentEvent())}})},n._select=function(r,i,a,o,s){s===void 0&&(s=!1);var l=a.inputEvent,c=a.data,u=this.setSelectedTargets(r),d=Rr(c.startSelectedTargets,r),f=d.added,h=d.removed,v=d.prevList,p=d.list,g={startSelected:v,startAdded:f.map(function(m){return p[m]}),startRemoved:h.map(function(m){return v[m]})};o&&this.emit("selectStart",de(de(de({},u),g),{rect:i,inputEvent:l,data:c.data,isTrusted:a.isTrusted,isDragStartEnd:s})),(u.added.length||u.removed.length)&&this.emit("select",de(de(de({},u),g),{rect:i,inputEvent:l,data:c.data,isTrusted:a.isTrusted,isDragStartEnd:s}))},n._selectEnd=function(r,i,a,o,s){s===void 0&&(s=!1);var l=o.inputEvent,c=o.isDouble,u=o.data,d=l&&l.type,f=d==="mousedown"||d==="touchstart",h=Rr(r,this.selectedTargets),v=h.added,p=h.removed,g=h.prevList,m=h.list,x=Rr(i,this.selectedTargets),b=x.added,C=x.removed,E=x.prevList,S=x.list;this.emit("selectEnd",{startSelected:r,beforeSelected:i,selected:this.selectedTargets,added:v.map(function(D){return m[D]}),removed:p.map(function(D){return g[D]}),afterAdded:b.map(function(D){return S[D]}),afterRemoved:C.map(function(D){return E[D]}),isDragStart:f&&s,isDragStartEnd:f&&s,isClick:!!o.isClick,isDouble:!!c,rect:a,inputEvent:l,data:u.data,isTrusted:o.isTrusted})},n._checkSelected=function(r,i){i===void 0&&(i=tf(r,this.options.ratio));var a=r.data,o=i.top,s=i.left,l=i.width,c=i.height,u=a.selectFlag,d=a.containerX,f=a.containerY,h=a.scaleMatrix,v=pa(h,[s-d,o-f]),p=pa(h,[l,c]),g=[];if(u){this.target.style.cssText+="display: block;left:0px;top:0px;"+"transform: translate(".concat(v[0],"px, ").concat(v[1],"px);")+"width:".concat(p[0],"px;height:").concat(p[1],"px;");var m=this.hitTest(i,a,!0,r);g=ef(a.startPassedTargets,m,this.continueSelect&&this.continueSelectWithoutDeselect)}var x=this.emit("drag",de(de({},r),{data:a.data,isSelect:u,rect:i}));if(x===!1){this.target.style.cssText+="display: none;",r.stop();return}u&&this._select(g,i,r)},n._sameCombiKey=function(r,i,a){if(!i)return!1;var o=Ud(r.inputEvent,r.key),s=[].concat(i),l=qt(s[0])?s:[s];if(a){var c=r.key;return l.some(function(u){return u.some(function(d){return d===c})})}return l.some(function(u){return u.every(function(d){return o.indexOf(d)>-1})})},n._findElement=function(r,i){for(var a=r;a&&!(i.indexOf(a)>-1);)a=a.parentElement;return a},n._refreshGroups=function(r){var i,a=r.innerWidth,o=r.innerHeight,s=r.selectablePoints;if(this.options.checkOverflow){var l=(i=this.gesto.getEventData().innerScrollOptions)===null||i===void 0?void 0:i.container,c=r.selectableInnerScrollParentMap,u=r.selectableInnerScrollPathsList;r.selectableInners=u.map(function(h,v){var p=!1;return h.every(function(g){if(p)return!0;if(g===l)return p=!0,!0;var m=c.get(g);if(m){var x=s[v],b=m.points,C=Qo(x,b);if(!C.length)return!1}return!0})})}if(!a||!o)r.innerGroups=null;else{var d=r.selectablePoints,f={};d.forEach(function(h,v){var p=1/0,g=-1/0,m=1/0,x=-1/0;h.forEach(function(E){var S=Math.floor(E[0]/a),D=Math.floor(E[1]/o);p=Math.min(S,p),g=Math.max(S,g),m=Math.min(D,m),x=Math.max(D,x)});for(var b=p;b<=g;++b)for(var C=m;C<=x;++C)f[b]=f[b]||{},f[b][C]=f[b][C]||[],f[b][C].push(v)}),r.innerGroups=f}},e=km([aa(of,function(r,i){var a={enumerable:!0,configurable:!0,get:function(){return this.options[i]}},o=ea("get ".concat(i));r[o]?a.get=function(){return this[o]()}:a.get=function(){return this.options[i]};var s=ea("set ".concat(i));r[s]?a.set=function(l){this[s](l)}:a.set=function(l){this.options[i]=l},Object.defineProperty(r,i,a)})],e),e}(Qn),Im=function(t){qd(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(_m);const Pm=Im,sf="connectionControl",tl="connection anchor",Kr=8,el=[{x:-1,y:1},{x:-.5,y:1},{x:0,y:1},{x:.5,y:1},{x:1,y:1},{x:1,y:.5},{x:1,y:0},{x:1,y:-.5},{x:1,y:-1},{x:.5,y:-1},{x:0,y:-1},{x:-.5,y:-1},{x:-1,y:-1},{x:-1,y:-.5},{x:-1,y:0},{x:-1,y:.5}],ln=3,Xr=2.5,zm=({setRef:t,setAnchorsRef:e,handleMouseLeave:n})=>{const r=(0,F.useRef)(null),i=(0,Pt.of)(Nm),a=5.5,o="data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1cHgiIGhlaWdodD0iNXB4IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2Utd2lkdGg9IjIiIHN0eWxlPSJzdHJva2Utb3BhY2l0eTowLjQiIHN0cm9rZT0iI2ZmZmZmZiIvPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2U9IiMyOWI2ZjIiLz48L3N2Zz4=",s=d=>{d.target instanceof HTMLImageElement&&r.current&&d.target.style&&(r.current.style.display="block",r.current.style.top=`calc(${d.target.style.top} - ${a}px + ${ln}px)`,r.current.style.left=`calc(${d.target.style.left} - ${a}px + ${ln}px)`)},l=()=>{r.current&&(r.current.style.display="none")},c=d=>{n(d)&&l()},u=(d=el)=>d.map(f=>{const h=`${f.x},${f.y}`,v={top:`calc(${-f.y*50+50}% - ${Xr}px - ${ln}px)`,left:`calc(${f.x*50+50}% - ${Xr}px - ${ln}px)`};return(0,y.jsx)("img",{id:h,ref:p=>{p&&p.style.setProperty("pointer-events","auto","important")},alt:tl,className:i.anchor,style:v,src:o,onMouseEnter:s},h)});return(0,y.jsxs)("div",{className:i.root,ref:t,children:[(0,y.jsx)("div",{className:i.mouseoutDiv,onMouseOut:c,onBlur:c}),(0,y.jsx)("div",{id:sf,ref:r,className:i.highlightElement,onMouseLeave:l}),(0,y.jsx)("div",{ref:e,children:u()})]})},Nm=t=>({root:(0,Q.css)({position:"absolute",display:"none"}),mouseoutDiv:(0,Q.css)({position:"absolute",margin:"-30px",width:"calc(100% + 60px)",height:"calc(100% + 60px)"}),anchor:(0,Q.css)({padding:`${ln}px`,position:"absolute",cursor:"cursor",width:`calc(5px + 2 * ${ln}px)`,height:`calc(5px + 2 * ${ln}px)`,zIndex:100}),highlightElement:(0,Q.css)({backgroundColor:"#00ff00",opacity:.3,position:"absolute",cursor:"cursor",pointerEvents:"auto",width:"16px",height:"16px",borderRadius:t.shape.radius.circle,display:"none",zIndex:110})});var nl=j(49426),lf=j(57532);const Bm=(t,e,n,r)=>{switch(n){case!0:switch(r){case-1:t.parent instanceof Be?e.parent&&(Xa(t,e.parent,e.parent.elements.length),t.updateData(e.parent.scene.context)):e.parent?.reorderTree(t,e,!0);break;default:e.parent&&(Xa(t,e.parent,e.parent.elements.indexOf(e)),t.updateData(e.parent.scene.context));break}break;case!1:e instanceof Be?t.parent===e?t.parent?.reorderTree(t,e,!0):(Xa(t,e),t.updateData(e.scene.context)):t.parent===e.parent?t.parent?.reorderTree(t,e):e.parent&&(Xa(t,e.parent),t.updateData(e.parent.scene.context));break}},Xa=(t,e,n=null)=>{t.parent?.doAction(Kt.Delete,t),t.parent=e;const r=t.div?.getBoundingClientRect();t.setPlacementFromConstraint(r,e.div?.getBoundingClientRect());const i=n??e.elements.length-1;e.elements.splice(i,0,t),e.scene.save(),e.reinitializeMoveable()},be=(t,e)=>{const n=[...e];for(;n.length>0;){const r=n.shift();if(r&&r.div&&r.div===t)return r;const i=r instanceof Be?r.elements:[];for(const a of i)n.unshift(a)}},jm=t=>{t.selection.pipe((0,lf.$)()).subscribe(e=>{const n=e[0].parent,r=new Be({type:"frame",name:t.getNextElementName(!0),elements:[]},t,e[0].parent),i=Vm(e);r.options.placement=i,e.forEach(a=>{const o=a.div?.getBoundingClientRect();a.setPlacementFromConstraint(o,i),n.doAction(Kt.Delete,a),r.doAction(Kt.Duplicate,a,!1,!1)}),r.setPlacementFromConstraint(i,n.div?.getBoundingClientRect()),n.elements.push(r),t.byName.set(r.getName(),r),t.save()})},Vm=t=>{let e=1/0,n=1/0,r=0,i=0;return t.forEach(a=>{const o=a.div?.getBoundingClientRect();o&&(e>o.top&&(e=o.top),n>o.left&&(n=o.left),r<o.right&&(r=o.right),i<o.bottom&&(i=o.bottom))}),{top:e,left:n,width:r-n,height:i-e}};let Fm=0;const Gm=["input","textarea"],$m=({setSVGRef:t,setLineRef:e,setSVGVertexRef:n,setVertexPathRef:r,setVertexRef:i,scene:a})=>{const o=(0,Pt.of)(Wm),s=Date.now()+"_"+Fm++,l=(0,F.useMemo)(()=>`connectionLineId-${s}`,[s]),c=(0,F.useMemo)(()=>`editorHead-${s}`,[s]),u=ot.$W.theme2.colors.text.primary,d=2,f={mode:ft.TL.Fixed,fixed:ft.ok.Forward},h=10,[v,p]=(0,F.useState)(void 0),g=(0,F.useRef)(v);(0,F.useEffect)(()=>{g.current=v}),(0,F.useEffect)(()=>{a.panel.context.instanceState?.selectedConnection&&p(a.panel.context.instanceState?.selectedConnection)},[a.panel.context.instanceState?.selectedConnection]);const m=E=>{const S=E.target;if(S instanceof HTMLElement&&!(Gm.indexOf(S.nodeName.toLowerCase())>-1)){if(E.keyCode===8||E.keyCode===46)g.current&&g.current.source&&(g.current.source.options.connections=g.current.source.options.connections?.filter(D=>D!==g.current?.info),g.current.source.onChange(g.current.source.options),p(void 0),a.connections.select(void 0),a.connections.updateState(),a.save());else return;document.removeEventListener("keyup",m),a.selecto.rootContainer.removeEventListener("click",x)}},x=E=>{const S=E.target;!(S instanceof SVGLineElement&&S.id===l)&&(p(void 0),a.connections.select(void 0))},b=E=>{a.isEditingEnabled&&(p(E),a.connections.select(E),document.addEventListener("keyup",m),a.selecto.rootContainer.addEventListener("click",x))},C=()=>a.connections.state.sort((E,S)=>v===S&&a.panel.context.instanceState.selectedConnection?-1:0).map((E,S)=>{const{source:D,target:M,info:w,vertices:T,index:k}=E,O=D.div?.getBoundingClientRect(),R=D.div?.parentElement,L=a.scale,P=en(a);if(!O||!R||!P)return;const{x1:z,y1:V,x2:N,y2:G}=co(O,P,w,M,L);let{xStart:W,yStart:B,xEnd:q,yEnd:Z}={xStart:z,yStart:V,xEnd:N,yEnd:G};E.sourceOriginal&&E.targetOriginal?(W=E.sourceOriginal.x,B=E.sourceOriginal.y,q=E.targetOriginal.x,Z=E.targetOriginal.y):D.options.connections&&(!D.options.connections[k].sourceOriginal||!D.options.connections[k].targetOriginal)&&(D.options.connections[k].sourceOriginal={x:z,y:V},D.options.connections[k].targetOriginal={x:N,y:G});const K=In(z,V,N,G),X=q-W,H=Z-B,{strokeColor:et,strokeWidth:rt,strokeRadius:mt,arrowDirection:vt,lineStyle:U,shouldAnimate:nt}=_l(w,a,d,f.fixed??ft.ok.Forward),Rt=v===E&&a.panel.context.instanceState.selectedConnection,ut=a.isEditingEnabled?"grab":"",dt={stroke:"#44aaff",strokeOpacity:.6,strokeWidth:rt+5},yt=`connectionHeadStart-${s+Math.random()}`,Ot=`connectionHeadEnd-${s+Math.random()}`,Tt=mt,xt=[];let Ct=`M${z} ${V} `;T?.length&&(T.map((St,gt)=>{const kt=St.x,Lt=St.y,wt=kt*X+W,Bt=Lt*H+B;let Xt=wt,bt=Bt,tt=wt,Wt=Bt,Mt=0,jt=0,Yt=0;if(Tt){if(gt<T.length-1){const Ut=T[gt+1].x*X+W,Dt=T[gt+1].y*H+B;if(gt===0)jt=pe(z,V,wt,Bt),Yt=pe(wt,Bt,Ut,Dt);else{const Gt=T[gt-1],Ie=Gt.x*X+W,Cn=Gt.y*H+B;jt=pe(Ie,Cn,wt,Bt),Yt=pe(wt,Bt,Ut,Dt)}}else{if(gt>0){const Ut=T[gt-1],Dt=Ut.x*X+W,Gt=Ut.y*H+B;jt=pe(Dt,Gt,wt,Bt)}else jt=pe(z,V,wt,Bt);Yt=pe(wt,Bt,N,G)}const te=Yt-jt,ie=te<0;Mt=Tt*Math.tan(te/2),ie&&(Mt*=-1)}if(gt===0){if(xt.push(In((z-W)/(q-W),(V-B)/(Z-B),kt,Lt)),Tt){const te=Pn(wt,Bt,z,V);Math.abs(Mt)>.5*Math.abs(te)&&(Mt=.5*te);let ie=N,Ut=G;if(gt<T.length-1){const Ie=T[gt+1];ie=Ie.x*X+W,Ut=Ie.y*H+B}const Dt=Pn(wt,Bt,ie,Ut);Math.abs(Mt)>.5*Math.abs(Dt)&&(Mt=.5*Dt);const Gt=te-Mt;Xt=Math.round(Gt*Math.cos(jt)+z),bt=Math.round(Gt*Math.sin(jt)+V),tt=Math.round(Mt*Math.cos(Yt)+wt),Wt=Math.round(Mt*Math.sin(Yt)+Bt),(Xt>wt&&Xt>z||Xt<wt&&Xt<z)&&(Xt=(Gt+2*Mt)*Math.cos(jt)+z,bt=(Gt+2*Mt)*Math.sin(jt)+V,tt=-Mt*Math.cos(Yt)+wt,Wt=-Mt*Math.sin(Yt)+Bt)}}else{const te=T[gt-1];if(xt.push(In(te.x,te.y,kt,Lt)),Tt){const ie=te.x*X+W,Ut=te.y*H+B,Dt=Pn(wt,Bt,ie,Ut);Math.abs(Mt)>.5*Math.abs(Dt)&&(Mt=.5*Dt);let Gt=N,Ie=G;if(gt<T.length-1){const Jr=T[gt+1];Gt=Jr.x*X+W,Ie=Jr.y*H+B}const Cn=Pn(wt,Bt,Gt,Ie);Math.abs(Mt)>.5*Math.abs(Cn)&&(Mt=.5*Cn);const qr=Dt-Mt;Xt=Math.round(qr*Math.cos(jt)+ie),bt=Math.round(qr*Math.sin(jt)+Ut),tt=Math.round(Mt*Math.cos(Yt)+wt),Wt=Math.round(Mt*Math.sin(Yt)+Bt),(Xt>wt&&Xt>ie||Xt<wt&&Xt<ie)&&(Xt=(qr+2*Mt)*Math.cos(jt)+ie,bt=(qr+2*Mt)*Math.sin(jt)+Ut,tt=-Mt*Math.cos(Yt)+wt,Wt=-Mt*Math.sin(Yt)+Bt)}}gt===T.length-1&&xt.push(In((N-W)/(q-W),(G-B)/(Z-B),kt,Lt)),Ct+=`L${Xt} ${bt} `,Mt!==0&&(Ct+=`Q ${wt} ${Bt} ${tt} ${Wt} `)}),Ct+=`L${N} ${G}`);const Ht=vt===ft.ok.Reverse||vt===ft.ok.Both?`url(#${yt})`:void 0,Nt=vt===ft.ok.Forward||vt===ft.ok.Both?`url(#${Ot})`:void 0,lt=()=>{let St="100;0";return vt===ft.ok.Reverse&&(St="0;100"),St};return(0,y.jsx)("svg",{className:o.connection,children:(0,y.jsxs)("g",{onClick:()=>b(E),children:[(0,y.jsxs)("defs",{children:[(0,y.jsx)("marker",{id:yt,markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",stroke:et,children:(0,y.jsx)("polygon",{points:"10 0, 0 3.5, 10 7",fill:et})}),(0,y.jsx)("marker",{id:Ot,markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",stroke:et,children:(0,y.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:et})})]}),T?.length?(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{id:`${l}_transparent`,d:Ct,cursor:ut,pointerEvents:"auto",stroke:"transparent",strokeWidth:15,fill:"none",style:Rt?dt:{}}),(0,y.jsx)("path",{d:Ct,stroke:et,strokeWidth:rt,strokeDasharray:U,strokeDashoffset:1,fill:"none",markerEnd:Nt,markerStart:Ht,children:nt&&(0,y.jsx)("animate",{attributeName:"stroke-dashoffset",values:lt(),dur:"5s",calcMode:"linear",repeatCount:"indefinite",fill:"freeze"})}),Rt&&(0,y.jsxs)("g",{children:[T.map((St,gt)=>(0,y.jsx)("circle",{id:Li,"data-index":gt,cx:St.x*X+W,cy:St.y*H+B,r:5,stroke:et,className:o.vertex,cursor:"crosshair",pointerEvents:"auto"},`${Li}${gt}_${S}`)),T.length<h&&xt.map((St,gt)=>(0,y.jsx)("circle",{id:fr,"data-index":gt,cx:St.x*X+W,cy:St.y*H+B,r:4,stroke:et,className:o.addVertex,cursor:"crosshair",pointerEvents:"auto"},`${fr}${gt}_${S}`))]})]}):(0,y.jsxs)("g",{children:[(0,y.jsx)("line",{id:`${l}_transparent`,cursor:ut,pointerEvents:"auto",stroke:"transparent",strokeWidth:15,style:Rt?dt:{},x1:z,y1:V,x2:N,y2:G}),(0,y.jsx)("line",{id:l,stroke:et,pointerEvents:"auto",strokeWidth:rt,markerEnd:Nt,markerStart:Ht,strokeDasharray:U,strokeDashoffset:1,x1:z,y1:V,x2:N,y2:G,cursor:ut,children:nt&&(0,y.jsx)("animate",{attributeName:"stroke-dashoffset",values:lt(),dur:"5s",calcMode:"linear",repeatCount:"indefinite",fill:"freeze"})}),Rt&&(0,y.jsx)("circle",{id:fr,"data-index":0,cx:K.x,cy:K.y,r:4,stroke:et,className:o.addVertex,cursor:"crosshair",pointerEvents:"auto"})]})]})},S)});return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("svg",{ref:t,className:o.editorSVG,children:[(0,y.jsx)("defs",{children:(0,y.jsx)("marker",{id:c,markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",stroke:u,children:(0,y.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:u})})}),(0,y.jsx)("line",{ref:e,stroke:u,strokeWidth:2,markerEnd:`url(#${c})`})]}),(0,y.jsxs)("svg",{ref:n,className:o.editorSVG,children:[(0,y.jsx)("path",{ref:r,stroke:u,strokeWidth:2,strokeDasharray:"5, 5",fill:"none"}),(0,y.jsx)("circle",{ref:i,stroke:u,r:4,className:o.vertex})]}),C()]})},Wm=t=>({editorSVG:(0,Q.css)({position:"absolute",pointerEvents:"none",width:"100%",height:"100%",zIndex:1e3,display:"none"}),connection:(0,Q.css)({position:"absolute",width:"100%",height:"100%",zIndex:1e3,pointerEvents:"none"}),vertex:(0,Q.css)({fill:"#44aaff",strokeWidth:2}),addVertex:(0,Q.css)({fill:"#44aaff",opacity:.5,strokeWidth:1})}),Li="vertex",fr="vertexAdd",Wn=.05,Hm=5/180*Math.PI;class Ym{constructor(e){this.state=[],this.selection=new nl.t(void 0),this.select=n=>{n!==this.selection.value&&this.selection.next(n)},this.updateState=()=>{const n=this.selection.value;if(this.state=lo(this.scene.byName),n){for(let r of this.state)if(r.source===n.source&&r.index===n.index){this.selection.next(r);break}}},this.setConnectionAnchorRef=n=>{this.connectionAnchorDiv=n},this.setAnchorsRef=n=>{this.anchorsDiv=n},this.setConnectionSVGRef=n=>{this.connectionSVG=n},this.setConnectionLineRef=n=>{this.connectionLine=n},this.setConnectionSVGVertexRef=n=>{this.connectionSVGVertex=n},this.setConnectionVertexRef=n=>{this.connectionVertex=n},this.setConnectionVertexPathRef=n=>{this.connectionVertexPath=n},this.findElementTarget=n=>{let r;if(n!==this.scene.div)return r=be(n,this.scene.root.elements),!r&&n.parentElement&&(r=this.findElementTarget(n.parentElement)),r},this.handleMouseEnter=n=>{if(!(n.target instanceof Element)||!this.scene.isEditingEnabled)return;let r=this.findElementTarget(n.target);if(!r){console.log("no element");return}if(this.isDrawingConnection)this.connectionTarget=r;else if(this.connectionSource=r,!this.connectionSource){console.log("no connection source");return}const i=r?.item.customConnectionAnchors||el,a=Array.from(this.anchorsDiv?.children),o=i.length;a.forEach((f,h)=>{if(h>=o)f.style.display="none";else{const{x:v,y:p}=i[h];f.style.top=`calc(${-p*50+50}% - ${Xr}px - ${ln}px)`,f.style.left=`calc(${v*50+50}% - ${Xr}px - ${ln}px)`,f.style.display="block"}});const s=r.div.getBoundingClientRect(),l=this.scene.scale,c=en(this.scene),u=s.top-(c?.top??0),d=s.left-(c?.left??0);this.connectionAnchorDiv&&(this.connectionAnchorDiv.style.display="none",this.connectionAnchorDiv.style.display="block",this.connectionAnchorDiv.style.top=`${u/l}px`,this.connectionAnchorDiv.style.left=`${d/l}px`,this.connectionAnchorDiv.style.height=`${s.height/l}px`,this.connectionAnchorDiv.style.width=`${s.width/l}px`)},this.handleMouseLeave=n=>n.relatedTarget instanceof HTMLImageElement&&n.relatedTarget.getAttribute("alt")===tl?!1:(this.connectionTarget=void 0,this.connectionAnchorDiv.style.display="none",!0),this.connectionListener=n=>{if(n.preventDefault(),!(this.connectionLine&&this.scene.div&&this.scene.div.parentElement))return;const r=this.scene.scale,i=en(this.scene);if(!i)return;const a=n.pageX-(i.x??0),o=n.pageY-(i.y??0);this.connectionLine.setAttribute("x2",`${a/r}`),this.connectionLine.setAttribute("y2",`${o/r}`);const s=this.connectionLine.x1.baseVal.value,l=this.connectionLine.y1.baseVal.value;if(this.didConnectionLeaveHighlight||Math.hypot(a-s,o-l)>Kr&&this.connectionSVG&&(this.didConnectionLeaveHighlight=!0,this.connectionSVG.style.display="block",this.isDrawingConnection=!0),!n.buttons){if(this.connectionSource&&this.connectionSource.div&&this.connectionSource.div.parentElement){const c=this.connectionSource.div.getBoundingClientRect(),u=this.scene.scale,d=en(this.scene);if(!d)return;const f=(c.top-d.top+c.height/2)/u,h=(c.left-d.left+c.width/2)/u,v=(s-h)/(c.width/2/u),p=(f-l)/(c.height/2/u);let g,m,x;if(this.connectionTarget&&this.connectionTarget.div){const E=this.connectionTarget.div.getBoundingClientRect(),S=E.top-d.top+E.height/2,D=E.left-d.left+E.width/2;g=(a-D)/(E.width/2),m=(S-o)/(E.height/2),x=this.connectionTarget.options.name}else{const E=d.height/2,S=d.width/2;g=(a-S)/(d.width/2),m=(E-o)/(d.height/2)}const b={source:{x:v,y:p},target:{x:g,y:m},targetName:x,color:{fixed:De.$.theme2.colors.text.primary},size:{fixed:2,min:1,max:10},path:no.Straight},{options:C}=this.connectionSource;C.connections||(C.connections=[]),this.didConnectionLeaveHighlight&&(this.connectionSource.options.connections=[...C.connections,b],this.connectionSource.onChange(this.connectionSource.options))}this.connectionSVG&&(this.connectionSVG.style.display="none"),this.scene.selecto&&this.scene.selecto.rootContainer&&(this.scene.selecto.rootContainer.style.cursor="default",this.scene.selecto.rootContainer.removeEventListener("mousemove",this.connectionListener)),this.isDrawingConnection=!1,this.updateState(),this.scene.save()}},this.vertexListener=n=>{if(this.scene.selecto.rootContainer.style.cursor="crosshair",n.preventDefault(),!(this.connectionVertex&&this.scene.div&&this.scene.div.parentElement))return;const r=this.scene.scale,i=en(this.scene);if(!i)return;const a=(n.pageX-i.x)/r,o=(n.pageY-i.y)/r;this.connectionVertex?.setAttribute("cx",`${a}`),this.connectionVertex?.setAttribute("cy",`${o}`);const s=this.selection.value,l=s.source.div.getBoundingClientRect(),{x1:c,y1:u,x2:d,y2:f}=co(l,i,s?.info,s.target,r);let{xStart:h,yStart:v,xEnd:p,yEnd:g}={xStart:c,yStart:u,xEnd:d,yEnd:f};s?.sourceOriginal&&s.targetOriginal&&(h=s.sourceOriginal.x,v=s.sourceOriginal.y,p=s.targetOriginal.x,g=s.targetOriginal.y);const m=p-h,x=g-v;let b=c,C=u,E=d,S=f;s&&s.vertices&&(this.selectedVertexIndex!==void 0&&this.selectedVertexIndex>0&&(b=s.vertices[this.selectedVertexIndex-1].x*m+h,C=s.vertices[this.selectedVertexIndex-1].y*x+v),this.selectedVertexIndex!==void 0&&this.selectedVertexIndex<s.vertices.length-1&&(E=s.vertices[this.selectedVertexIndex+1].x*m+h,S=s.vertices[this.selectedVertexIndex+1].y*x+v));let D=a,M=o,w=!1;if(!n.ctrlKey){const T=Math.abs((a-b)/(o-C))<Wn,k=Math.abs((a-E)/(o-S))<Wn,O=Math.abs((o-C)/(a-b))<Wn,R=Math.abs((o-S)/(a-E))<Wn;T?D=b:k&&(D=E),O?M=C:R&&(M=S),(T||k)&&(O||R)?this.scene.selecto.rootContainer.style.cursor="move":T||k?this.scene.selecto.rootContainer.style.cursor="col-resize":(O||R)&&(this.scene.selecto.rootContainer.style.cursor="row-resize");const L=pe(b,C,E,S),P=pe(b,C,a,o);w=Math.abs(P-L)<Hm}if(w?(this.connectionVertexPath?.setAttribute("d",`M${b} ${C} L${E} ${S}`),this.connectionSVGVertex.style.display="block",this.connectionVertex.style.display="none"):(this.connectionVertexPath?.setAttribute("d",`M${b} ${C} L${D} ${M} L${E} ${S}`),this.connectionSVGVertex.style.display="block",this.connectionVertex.style.display="block"),!n.buttons){this.scene.selecto?.rootContainer?.removeEventListener("mousemove",this.vertexListener),this.scene.selecto?.rootContainer?.removeEventListener("mouseup",this.vertexListener),this.scene.selecto.rootContainer.style.cursor="auto",this.connectionSVGVertex.style.display="none";const T=s?.index,k=this.selectedVertexIndex;if(T!==void 0&&k!==void 0){const O=s.source;if(O.options.connections){const R=[...O.options.connections];if(R[T].vertices){const L=[...R[T].vertices];if(w)L.splice(k,1);else{const P={...L[k]};P.x=(D-h)/m,P.y=(M-v)/x,L[k]=P}R[T]={...R[T],vertices:L},O.onChange({...O.options,connections:R}),this.updateState(),this.scene.save()}}}}},this.vertexAddListener=n=>{if(this.scene.selecto.rootContainer.style.cursor="crosshair",n.preventDefault(),!(this.connectionVertex&&this.scene.div&&this.scene.div.parentElement))return;const r=this.scene.scale,i=en(this.scene);if(!i)return;const a=(n.pageX-i.x)/r,o=(n.pageY-i.y)/r;this.connectionVertex?.setAttribute("cx",`${a}`),this.connectionVertex?.setAttribute("cy",`${o}`);const s=this.selection.value,l=s.source.div.getBoundingClientRect(),{x1:c,y1:u,x2:d,y2:f}=co(l,i,s?.info,s.target,r);let{xStart:h,yStart:v,xEnd:p,yEnd:g}={xStart:c,yStart:u,xEnd:d,yEnd:f};s?.sourceOriginal&&s.targetOriginal&&(h=s.sourceOriginal.x,v=s.sourceOriginal.y,p=s.targetOriginal.x,g=s.targetOriginal.y);const m=p-h,x=g-v;let b=c,C=u,E=d,S=f;s&&s.vertices&&(this.selectedVertexIndex!==void 0&&this.selectedVertexIndex>0&&(b=s.vertices[this.selectedVertexIndex-1].x*m+h,C=s.vertices[this.selectedVertexIndex-1].y*x+v),this.selectedVertexIndex!==void 0&&this.selectedVertexIndex<s.vertices.length&&(E=s.vertices[this.selectedVertexIndex].x*m+h,S=s.vertices[this.selectedVertexIndex].y*x+v));let D=a,M=o;if(!n.ctrlKey){const w=Math.abs((a-b)/(o-C))<Wn,T=Math.abs((a-E)/(o-S))<Wn,k=Math.abs((o-C)/(a-b))<Wn,O=Math.abs((o-S)/(a-E))<Wn;w?D=b:T&&(D=E),k?M=C:O&&(M=S),(w||T)&&(k||O)?this.scene.selecto.rootContainer.style.cursor="move":w||T?this.scene.selecto.rootContainer.style.cursor="col-resize":(k||O)&&(this.scene.selecto.rootContainer.style.cursor="row-resize")}if(this.connectionVertexPath?.setAttribute("d",`M${b} ${C} L${D} ${M} L${E} ${S}`),this.connectionSVGVertex.style.display="block",this.connectionVertex.style.display="block",!n.buttons){this.scene.selecto?.rootContainer?.removeEventListener("mousemove",this.vertexAddListener),this.scene.selecto?.rootContainer?.removeEventListener("mouseup",this.vertexAddListener),this.scene.selecto.rootContainer.style.cursor="auto",this.connectionSVGVertex.style.display="none";const w=s?.index,T=this.selectedVertexIndex;if(w!==void 0&&T!==void 0){const k=s.source;if(k.options.connections){const O=[...k.options.connections],R={x:(a-h)/m,y:(o-v)/x};if(O[w].vertices){const L=[...O[w].vertices];L.splice(T,0,R),O[w]={...O[w],vertices:L}}else{const L=[R];O[w]={...O[w],vertices:L}}(!O[w].sourceOriginal||!O[w].targetOriginal)&&(O[w]={...O[w],sourceOriginal:{x:c,y:u},targetOriginal:{x:d,y:f}}),k.onChange({...k.options,connections:O}),this.updateState(),this.scene.save()}}}},this.handleConnectionDragStart=(n,r,i)=>{if(this.scene.selecto.rootContainer.style.cursor="crosshair",this.connectionSVG&&this.connectionLine&&this.scene.div&&this.scene.div.parentElement){const a=n.getBoundingClientRect(),o=this.scene.scale,s=en(this.scene);if(!s)return;const l=Kr*o,c=Kr*o,u=(a.x-s.x+l)/o,d=(a.y-s.y+c)/o,f=r-s.x,h=i-s.y;this.connectionLine.setAttribute("x1",`${u}`),this.connectionLine.setAttribute("y1",`${d}`),this.connectionLine.setAttribute("x2",`${f}`),this.connectionLine.setAttribute("y2",`${h}`),this.didConnectionLeaveHighlight=!1}this.scene.selecto?.rootContainer?.addEventListener("mousemove",this.connectionListener)},this.handleVertexDragStart=n=>{this.selectedVertexIndex=Number(n.getAttribute("data-index")),this.scene.selecto?.rootContainer?.addEventListener("mousemove",this.vertexListener),this.scene.selecto?.rootContainer?.addEventListener("mouseup",this.vertexListener)},this.handleVertexAddDragStart=n=>{this.selectedVertexIndex=Number(n.getAttribute("data-index")),this.scene.selecto?.rootContainer?.addEventListener("mousemove",this.vertexAddListener),this.scene.selecto?.rootContainer?.addEventListener("mouseup",this.vertexAddListener)},this.onChange=(n,r)=>{const i=n.source.options.connections?.splice(0)??[];i[n.index]=r,n.source.onChange({...n.source.options,connections:i}),this.updateState()},this.connectionsNeedUpdate=n=>Al(n)||so(n,this.scene.byName),this.scene=e,this.updateState()}render(){return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(zm,{setRef:this.setConnectionAnchorRef,setAnchorsRef:this.setAnchorsRef,handleMouseLeave:this.handleMouseLeave}),(0,y.jsx)($m,{setSVGRef:this.setConnectionSVGRef,setLineRef:this.setConnectionLineRef,setSVGVertexRef:this.setConnectionSVGVertexRef,setVertexPathRef:this.setConnectionVertexPathRef,setVertexRef:this.setConnectionVertexRef,scene:this.scene})]})}}const Km=t=>({name:"settingsViewable",props:[],events:[],render(e,n){if(t.selecto?.getSelectedTargets()&&t.selecto?.getSelectedTargets().length>1)return;const r=(s,l)=>{const c=e.getContainer(),u=new PointerEvent("contextmenu",{clientX:s,clientY:l});c.dispatchEvent(u)},i=s=>{r(s.clientX,s.clientY)},a=s=>{if(s.key==="Enter"){const l=s.currentTarget.getBoundingClientRect();r(l.x,l.y)}},o=e.getRect();return(0,y.jsxs)("div",{className:"moveable-settings",style:{position:"absolute",left:`${o.width+18}px`,top:"0px",color:"white",fontSize:"18px",cursor:"pointer",userSelect:"none",willChange:"transform",transform:"translate(-50%, 0px)",zIndex:100},onClick:i,onKeyDown:a,role:"button",tabIndex:0,children:["","\u2699\uFE0F",""]},"settings-viewable")}}),Xm={name:"dimensionViewable",props:[],events:[],render(t,e){const n=t.getRect();return(0,y.jsxs)("div",{className:"moveable-dimension",style:{position:"absolute",left:`${n.width/2}px`,top:`${n.height+20}px`,background:"#4af",borderRadius:"2px",padding:"2px 4px",color:"white",fontSize:"13px",whiteSpace:"nowrap",fontWeight:"bold",willChange:"transform",transform:"translate(-50%, 0px)",zIndex:100},children:[Math.round(n.offsetWidth)," x ",Math.round(n.offsetHeight)]},"dimension-viewable")}},Um=t=>({name:"constraintViewable",props:[],events:[],render(e,n){const r=e.getRect(),i=be(e.state.target,t.root.elements);if(t.selecto?.getSelectedTargets()&&t.selecto?.getSelectedTargets().length>1)return;let a=null,o=null;const s=i?.tempConstraint??i?.options.constraint??{},l="1px dashed #4af",c=n.createElement("div",{style:{position:"absolute",left:`${r.width/2}px`,top:`${r.height/2-r.height/16}px`,borderLeft:l,height:`${r.height/8}px`,transform:"rotate(45deg)"}}),u=n.createElement("div",{style:{position:"absolute",left:`${r.width/2}px`,top:`${r.height/2-r.height/16}px`,borderLeft:l,height:`${r.height/8}px`,transform:"rotate(-45deg)"}}),d=n.createElement("div",{},[c,u]),f=n.createElement("div",{style:{position:"absolute",left:`${r.width/2}px`,bottom:"0px",borderLeft:l,height:"100vh"}}),h=n.createElement("div",{style:{position:"absolute",left:`${r.width/2}px`,top:`${r.height}px`,borderLeft:l,height:"100vh"}}),v=n.createElement("div",{},[f,h]),p=n.createElement("div",{style:{position:"absolute",left:`${r.width/2}px`,top:`${r.height/4}px`,borderLeft:l,height:`${r.height/2}px`}}),g=n.createElement("div",{},[p,d]);switch(s.vertical){case $.gR.Top:a=f;break;case $.gR.Bottom:a=h;break;case $.gR.TopBottom:a=v;break;case $.gR.Center:a=g;break}const m=n.createElement("div",{style:{position:"absolute",right:"0px",top:`${r.height/2}px`,borderTop:l,width:"100vw"}}),x=n.createElement("div",{style:{position:"absolute",left:`${r.width}px`,top:`${r.height/2}px`,borderTop:l,width:"100vw"}}),b=n.createElement("div",{},[m,x]),C=n.createElement("div",{style:{position:"absolute",left:`${r.width/4}px`,top:`${r.height/2}px`,borderTop:l,width:`${r.width/2}px`}}),E=n.createElement("div",{},[C,d]);switch(s.horizontal){case $.en.Left:o=m;break;case $.en.Right:o=x;break;case $.en.LeftRight:o=b;break;case $.en.Center:o=E;break}return n.createElement("div",{},[a,o])}}),Zm=[.1,4],Qm=t=>{t.props={dimensionViewable:!1,constraintViewable:!1,settingsViewable:!1}},qm=t=>{t.props={dimensionViewable:!0,constraintViewable:!0,settingsViewable:!0}},Jm=(t,e)=>{let n=t.parentElement,r=!1;for(;n&&!(n===e.root.div||(r=e.selecto?.getSelectedTargets().includes(n)??!1,r));)n=n.parentElement;return r},t1=t=>{let e=[];const n=[...t];for(;n.length>0;){const r=n.shift();r&&r.div&&e.push(r.div);const i=r instanceof Be?r.elements:[];for(const a of i)n.unshift(a)}return e},_i=(t=!1,e=!0,n)=>{const r=t1(n.root.elements);t&&n.selecto&&n.selecto.destroy(),n.selecto=new Pm({rootContainer:ot.$W.featureToggles.canvasPanelPanZoom?n.viewerDiv:n.div,dragContainer:ot.$W.featureToggles.canvasPanelPanZoom?n.viewerDiv:n.div,selectableTargets:r,toggleContinueSelect:"shift",selectFromInside:!1,hitRate:0});const i={top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0},a={top:!0,left:!0,bottom:!0,right:!0,center:!0,middle:!0};n.moveable=new pm(ot.$W.featureToggles.canvasPanelPanZoom?n.viewerDiv:n.div,{draggable:e&&!n.editModeEnabled.getValue(),resizable:e,rotatable:e,throttleRotate:5,rotationPosition:["top","right"],snappable:e,snapDirections:i,elementSnapDirections:a,elementGuidelines:r,ables:[Xm,Um(n),Km(n)],props:{dimensionViewable:e,constraintViewable:e,settingsViewable:e},origin:!1}).on("rotateStart",()=>{Qm(n.moveable)}).on("rotate",l=>{const c=be(l.target,n.root.elements);c&&(c.applyRotate(l),ot.$W.featureToggles.canvasPanelPanZoom&&n.connections.connectionsNeedUpdate(c)&&n.moveableActionCallback&&n.moveableActionCallback(!0))}).on("rotateGroup",l=>{for(let c of l.events){const u=be(c.target,n.root.elements);u&&u.applyRotate(c)}}).on("rotateEnd",()=>{qm(n.moveable),n.moved.next(Date.now())}).on("click",l=>{const c=be(l.target,n.root.elements);let u=!1;c&&(u=c.item.hasEditMode??!1),l.isDouble&&e&&!n.editModeEnabled.getValue()&&u&&n.editModeEnabled.next(!0)}).on("clickGroup",l=>{n.selecto.clickTarget(l.inputEvent,l.inputTarget)}).on("dragStart",l=>{if(n.ignoreDataUpdate=!0,n.setNonTargetPointerEvents(l.target,!0),n.moveable&&n.moveable.elementGuidelines){const c=n.moveable.elementGuidelines.indexOf(l.target);c>-1&&n.moveable.elementGuidelines.splice(c,1)}}).on("dragGroupStart",l=>{if(n.ignoreDataUpdate=!0,n.moveable&&n.moveable.elementGuidelines)for(let c of l.events){const u=n.moveable.elementGuidelines.indexOf(c.target);u>-1&&n.moveable.elementGuidelines.splice(u,1)}}).on("drag",l=>{const c=be(l.target,n.root.elements);c&&(c.applyDrag(l),n.connections.connectionsNeedUpdate(c)&&n.moveableActionCallback&&n.moveableActionCallback(!0))}).on("dragGroup",l=>{let c=!1;for(let u of l.events){const d=be(u.target,n.root.elements);d&&(d.applyDrag(u),c||(c=n.connections.connectionsNeedUpdate(d)))}c&&n.moveableActionCallback&&n.moveableActionCallback(!0)}).on("dragGroupEnd",l=>{l.events.forEach(c=>{const u=be(c.target,n.root.elements);u&&(u.setPlacementFromConstraint(void 0,void 0,n.scale),n.moveable&&n.moveable.elementGuidelines&&n.moveable.elementGuidelines.push(c.target))}),n.moved.next(Date.now()),n.ignoreDataUpdate=!1}).on("dragEnd",l=>{const c=be(l.target,n.root.elements);c&&c.setPlacementFromConstraint(void 0,void 0,n.scale),n.moved.next(Date.now()),n.ignoreDataUpdate=!1,n.setNonTargetPointerEvents(l.target,!1),n.moveable&&n.moveable.elementGuidelines&&n.moveable.elementGuidelines.push(l.target)}).on("resizeStart",l=>{const c=be(l.target,n.root.elements);if(c){if(n.moveable&&n.moveable.elementGuidelines){const u=n.moveable.elementGuidelines.indexOf(l.target);u>-1&&n.moveable.elementGuidelines.splice(u,1)}c.tempConstraint={...c.options.constraint},c.options.constraint={vertical:$.gR.Top,horizontal:$.en.Left},c.setPlacementFromConstraint(void 0,void 0,n.scale)}}).on("resizeGroupStart",l=>{if(n.moveable&&n.moveable.elementGuidelines)for(let c of l.events){const u=n.moveable.elementGuidelines.indexOf(c.target);u>-1&&n.moveable.elementGuidelines.splice(u,1)}for(let c of l.events){const u=be(c.target,n.root.elements);u&&(u.tempConstraint={...u.options.constraint},u.options.constraint={vertical:$.gR.Top,horizontal:$.en.Left},u.setPlacementFromConstraint(void 0,void 0,n.scale))}}).on("resize",l=>{const c=be(l.target,n.root.elements);c&&(c.applyResize(l),n.connections.connectionsNeedUpdate(c)&&n.moveableActionCallback&&n.moveableActionCallback(!0)),n.moved.next(Date.now())}).on("resizeGroup",l=>{let c=!1;for(let u of l.events){const d=be(u.target,n.root.elements);d&&(d.applyResize(u),c||(c=n.connections.connectionsNeedUpdate(d)))}c&&n.moveableActionCallback&&n.moveableActionCallback(!0),n.moved.next(Date.now())}).on("resizeEnd",l=>{const c=be(l.target,n.root.elements);c&&(c.tempConstraint&&(c.options.constraint=c.tempConstraint,c.tempConstraint=void 0),c.setPlacementFromConstraint(void 0,void 0,n.scale),n.moveable&&n.moveable.elementGuidelines&&n.moveable.elementGuidelines.push(l.target))}).on("resizeGroupEnd",l=>{if(n.moveable&&n.moveable.elementGuidelines)for(let c of l.events)n.moveable.elementGuidelines.push(c.target)});let o=[];if(n.selecto.on("dragStart",l=>{const c=l.inputEvent.target;if(c.id===sf){n.connections.handleConnectionDragStart(c,l.inputEvent.clientX,l.inputEvent.clientY),l.stop();return}if(c.id===Li){n.connections.handleVertexDragStart(c),l.stop();return}if(c.id===fr){n.connections.handleVertexAddDragStart(c),l.stop();return}const u=n.moveable.isMoveableElement(c)||o.some(f=>f===c||f.contains(c)),d=Jm(c,n);n.isEditingEnabled&&!n.editModeEnabled.getValue()&&u&&n.selecto?.getSelectedTargets().length&&(n.selecto.getSelectedTargets()[0].style.cursor="grabbing"),(u||d||!n.isEditingEnabled)&&l.stop()}).on("select",()=>{n.editModeEnabled.next(!1),n.connections.connectionAnchorDiv&&(n.connections.connectionAnchorDiv.style.display="none")}).on("selectEnd",l=>{o=l.selected,n.updateSelection({targets:o}),l.isDragStart&&(n.isEditingEnabled&&!n.editModeEnabled.getValue()&&n.selecto?.getSelectedTargets().length&&(n.selecto.getSelectedTargets()[0].style.cursor="grabbing"),l.inputEvent.preventDefault(),l.data.timer=setTimeout(()=>{n.moveable.dragStart(l.inputEvent)}))}).on("dragEnd",l=>{clearTimeout(l.data.timer)}),ot.$W.featureToggles.canvasPanelPanZoom){let l=function(u){u.preventDefault();const d=u.clientX,f=u.clientY,h=n.infiniteViewer.getScrollLeft(),v=n.infiniteViewer.getScrollTop(),p=m=>{const x=d-m.clientX,b=f-m.clientY,C=x/n.scale,E=b/n.scale;n.infiniteViewer.scrollTo(h+C,v+E),m.preventDefault()},g=()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)};var s=l;n.infiniteViewer=new Nv(n.viewerDiv,n.viewportDiv,{preventWheelClick:!1,useAutoZoom:!0,useMouseDrag:!1,useWheelScroll:n.shouldPanZoom,displayHorizontalScroll:!1,displayVerticalScroll:!1,zoomRange:Zm}),n.infiniteViewer.setZoom(n.scale),n.infiniteViewer.scrollTo(n.scrollLeft,n.scrollTop);const c=(u,d)=>{n.openContextMenu?n.openContextMenu({x:u,y:d}):n.contextMenuOnVisibilityChange(!0)};n.viewerDiv.addEventListener("contextmenu",u=>{u.ctrlKey&&u.button===2&&n.shouldPanZoom?l(u):(u.preventDefault(),c(u.pageX,u.pageY))}),n.viewerDiv.addEventListener("mousedown",u=>{u.button===1&&n.shouldPanZoom&&l(u)}),n.viewportDiv.addEventListener("wheel",u=>{n.shouldPanZoom||(u.stopImmediatePropagation(),u.preventDefault())},{passive:!1}),n.viewerDiv.addEventListener("dblclick",u=>{!n.editModeEnabled.getValue()&&n.shouldPanZoom&&n.infiniteViewer&&(n.infiniteViewer.setZoom(1),n.infiniteViewer.scrollTo(0,0))}),n.infiniteViewer.on("dragStart",u=>{u.inputEvent.button!==1&&(u.preventDefault(),u.preventDrag())}),n.infiniteViewer.on("scroll",()=>{n.clearCurrentSelection(!0),n.updateConnectionsSize(),n.scale=n.infiniteViewer.getZoom(),n.scrollLeft=n.infiniteViewer.getScrollLeft(),n.scrollTop=n.infiniteViewer.getScrollTop()})}};function e1(t,e,n=.05){const r=r1(t),i=e.getBoundingClientRect(),a=i.width,o=i.height,s=a*(1-2*n),l=o*(1-2*n),c=s/r.width,u=l/r.height,d=Math.min(c,u),f=(r.centerX*d-a/2)/d,h=(r.centerY*d-o/2)/d;return{scale:d,centerX:f,centerY:h}}function n1(t){const e=new DOMMatrix(t);return{x:e.m41,y:e.m42}}function r1(t){let e=1/0,n=1/0,r=-1/0,i=-1/0;for(const a of t){const o=window.getComputedStyle(a),{x:s,y:l}=n1(o.transform||""),c=parseFloat(o.width),u=parseFloat(o.height),d=s,f=l,h=s+c,v=l+u;e=Math.min(e,d),n=Math.min(n,f),r=Math.max(r,h),i=Math.max(i,v)}return{left:e,top:n,right:r,bottom:i,width:r-e,height:i-n,centerX:(e+r)/2,centerY:(n+i)/2}}const yn=10,Ua=50,i1={id:"frame",name:"Frame",description:"Frame",getNewOptions:()=>({config:{}}),display:()=>(0,y.jsx)("div",{children:"FRAME!"})};class Be extends Xi{constructor(e,n,r){super(i1,e,r),this.options=e,this.parent=r,this.elements=[],this.doAction=(a,o,s=!0,l=!0)=>{switch(a){case Kt.Delete:this.elements=this.elements.filter(d=>d!==o),Vh(o,this.scene),this.scene.byName.delete(o.options.name),this.scene.save(),this.reinitializeMoveable();break;case Kt.Duplicate:if(o.item.id==="frame"){console.log("Can not duplicate frames (yet)",a,o);return}const c=(0,ne.cloneDeep)(o.options);if(l){const{constraint:d,placement:f}=o.options,{vertical:h,horizontal:v}=d??{},p={...f};switch(h){case $.gR.Top:p.top==null?p.top=25:p.top+=yn;break;case $.gR.Bottom:p.bottom==null?p.bottom=100:p.bottom-=yn;break;case $.gR.TopBottom:p.top==null?p.top=25:p.top+=yn,p.bottom==null?p.bottom=100:p.bottom-=yn;break;case $.gR.Center:p.top!=null&&(p.top-=yn);break}switch(v){case $.en.Left:p.left==null?p.left=Ua:p.left+=yn;break;case $.en.Right:p.right==null?p.right=Ua:p.right-=yn;break;case $.en.LeftRight:p.left==null?p.left=Ua:p.left+=yn,p.right==null?p.right=Ua:p.right-=yn;break;case $.en.Center:p.left!=null&&(p.left-=yn);break}c.placement=p}c.connections=void 0;const u=new Xi(o.item,c,this);u.updateData(this.scene.context),s&&(u.options.name=this.scene.getNextElementName()),this.elements.push(u),this.scene.byName.set(u.options.name,u),this.scene.byName.set(o.options.name,o),this.scene.save(),this.reinitializeMoveable(),setTimeout(()=>{this.scene.targetsToSelect.add(u.div)});break;case Kt.MoveTop:case Kt.MoveBottom:o.parent?.doMove(o,a);break;default:console.log("DO action",a,o);return}},this.scene=n;let{elements:i}=this.options;i||(this.options.elements=i=[]);for(const a of i)if(a.type==="frame")this.elements.push(new Be(a,n,this));else{const o=ai.getIfExists(a.type)??me;this.elements.push(new Xi(o,a,this))}}isRoot(){return!1}updateData(e){super.updateData(e);for(const n of this.elements)n.updateData(e)}reorder(e,n){const r=Array.from(this.elements),[i]=r.splice(e,1);r.splice(n,0,i),this.elements=r,this.reinitializeMoveable()}reorderTree(e,n,r=!1){const i=Array.from(this.elements),a=this.elements.indexOf(e),o=r?this.elements.length-1:this.elements.indexOf(n),[s]=i.splice(a,1);i.splice(o,0,s),this.elements=i,this.reinitializeMoveable()}doMove(e,n){const r=this.elements.filter(i=>i!==e);n===Kt.MoveBottom?r.unshift(e):r.push(e),this.elements=r,this.scene.save(),this.reinitializeMoveable()}reinitializeMoveable(){this.scene.clearCurrentSelection(),setTimeout(()=>_i(!0,this.scene.isEditingEnabled,this.scene))}render(){return(0,y.jsx)("div",{ref:this.initElement,children:this.elements.map(e=>e.render())},this.UID)}visit(e){super.visit(e);for(const n of this.elements)e(n)}getSaveModel(){return{...this.options,elements:this.elements.map(e=>e.getSaveModel())}}}var cf=j(39741),a1=j(64423),uf=j(36490),df=j(13752),Ii=j(15245),Ur=j(59427),Rn=j(94535),o1=j(97375);const s1=({scene:t,panel:e,onVisibilityChange:n})=>{const r=e.state.openInlineEdit,[i,a]=(0,F.useState)(!1),[o,s]=(0,F.useState)({x:0,y:0}),l=l1(),c=t.selecto?.getSelectedTargets(),u=e.context?.instanceState?.layer;(0,F.useEffect)(()=>{if(ot.$W.featureToggles.canvasPanelPanZoom)return t.openContextMenu=p=>{s(p),a(!0),n(!0)},()=>t.openContextMenu=void 0},[t,n]);const d=(0,F.useCallback)(p=>{if(!(p instanceof MouseEvent)||p.ctrlKey)return;p.preventDefault(),e.setActivePanel(),(ot.$W.featureToggles.canvasPanelPanZoom?p.currentTarget!==t.viewportDiv:p.currentTarget!==t.div)&&(p.currentTarget instanceof HTMLElement||p.currentTarget instanceof SVGElement)&&t.select({targets:[p.currentTarget]}),s({x:p.pageX,y:p.pageY}),a(!0),n(!0)},[t,e,n]);(0,F.useEffect)(()=>{t.selecto&&t.selecto.getSelectableElements().forEach(p=>{p.addEventListener("contextmenu",d)})},[d,t.selecto]),(0,F.useEffect)(()=>{t.div&&t.div.addEventListener("contextmenu",d)},[d,t.div]);const f=()=>{a(!1),n(!1)},h=()=>{const p=!t.isPanelEditing&&(0,y.jsx)(Rn.D,{label:r?(0,A.t)("canvas.canvas-context-menu.close-editor","Close Editor"):(0,A.t)("canvas.canvas-context-menu.open-editor","Open Editor"),onClick:()=>{t.inlineEditingCallback&&(r?e.closeInlineEdit():t.inlineEditingCallback()),f()},className:l.menuItem}),g=()=>{if(c?.length===1){const E=()=>{t.editModeEnabled.next(!0),f()},S=be(c[0],t.root.elements);return S&&S.item.hasEditMode&&(0,y.jsx)(Rn.D,{label:(0,A.t)("canvas.canvas-context-menu.render-menu-items.edit-element-menu-item.label-edit","Edit"),onClick:E,className:l.menuItem})}return null},m=Ui(t.shouldShowAdvancedTypes).options,x=()=>{const E=[],S=D=>{let M=o.y,w=o.x;if(t.div){const T=t.scale,k=t.div.getBoundingClientRect();M=(M-k.top)/T,w=(w-k.left)/T}else if(t.viewportDiv){const T=t.viewportDiv.getBoundingClientRect();M-=T.top,w-=T.left}oo(D,u,{...o,y:M,x:w})};return m.map(D=>{E.push((0,y.jsx)(Rn.D,{label:D.label??"Canvas item",onClick:()=>S(D)},D.value))}),E},b=(0,y.jsx)(Rn.D,{label:(0,A.t)("canvas.canvas-context-menu.render-menu-items.add-item-menu-item.label-add-item","Add item"),className:l.menuItem,childItems:x(),customSubMenuContainerStyles:{maxHeight:"150px",overflowY:"auto"}}),C=(0,y.jsx)(Rn.D,{label:(0,A.t)("canvas.canvas-context-menu.render-menu-items.set-background-menu-item.label-set-background","Set background"),onClick:()=>{t.setBackgroundCallback&&t.setBackgroundCallback(o),f()},className:l.menuItem});return c&&c.length>=1?(0,y.jsxs)(y.Fragment,{children:[g(),(0,y.jsx)(Rn.D,{label:(0,A.t)("canvas.canvas-context-menu.render-menu-items.label-delete","Delete"),onClick:()=>{v(Kt.Delete),f()},className:l.menuItem}),(0,y.jsx)(Rn.D,{label:(0,A.t)("canvas.canvas-context-menu.render-menu-items.label-duplicate","Duplicate"),onClick:()=>{v(Kt.Duplicate),f()},className:l.menuItem}),(0,y.jsx)(Rn.D,{label:(0,A.t)("canvas.canvas-context-menu.render-menu-items.label-bring-to-front","Bring to front"),onClick:()=>{v(Kt.MoveTop),f()},className:l.menuItem}),(0,y.jsx)(Rn.D,{label:(0,A.t)("canvas.canvas-context-menu.render-menu-items.label-send-to-back","Send to back"),onClick:()=>{v(Kt.MoveBottom),f()},className:l.menuItem}),p]}):(0,y.jsxs)(y.Fragment,{children:[p,C,b]})},v=p=>{t.selection.pipe((0,lf.$)()).subscribe(g=>{const m=g[0].parent;g.forEach(x=>{m.doAction(p,x)})}),setTimeout(()=>{t.addToSelection(),t.targetsToSelect.clear()})};return i?(0,y.jsx)("div",{onContextMenu:p=>{p.preventDefault(),f()},children:(0,y.jsx)(o1.t,{x:o.x,y:o.y,onClose:f,renderMenuItems:h,focusOnOpen:!1})}):(0,y.jsx)(y.Fragment,{})},l1=()=>({menuItem:(0,Q.css)({maxWidth:"200px"})});var c1=j(18828),u1=j(93225),d1=j(55386),f1=j(71076),h1=j(84522),v1=j(41530),p1=j(47466),g1=j(39064),m1=j(16913);const x1=({scene:t})=>{const e=(0,Pt.$j)(),n=(0,Pt.of)(y1),{canExecuteActions:r}=(0,wr.d2)(),i=(0,F.useMemo)(()=>r?.()??!1,[r]),a=()=>{t?.tooltipCallback&&t.tooltipPayload&&t.tooltipCallback(void 0)},o=(0,F.createRef)(),{overlayProps:s}=(0,u1.e)({onClose:a,isDismissable:!0},o),{dialogProps:l}=(0,c1.s)({},o),c=t.tooltipPayload?.element;if(!c)return(0,y.jsx)(y.Fragment,{});const u=t.data?.series[0]?.fields?.find(C=>C.type===io.PU.time),d=u?.values[u.values.length-1],f=u&&d&&c.data.field&&(0,xr.Ct)(u)!==c.data.field,h={label:c.getName(),value:""},v=[{label:c.data.field??"Fixed",value:c.data.text},...f?[{label:"Time",value:(0,d1.cN)(u?.display(d))}]:[]],p=[];if((c.options.links?.length??0)>0&&c.getLinks){const C=new Set;c.getLinks({valueRowIndex:Mr(c.data.field,t)}).forEach(E=>{const S=`${E.title}/${E.href}`;C.has(S)||(p.push(E),C.add(S))})}t.data?.series&&Gh(t.data?.series,c.options).forEach(C=>{p.push(...(0,m1.u6)(C,Mr(c.data.field,t)))});const g=[],m=new Set,x=(c.options.actions?.length??0)>0,b=t.data?.series;if(x&&b&&i){const C=(0,Dr.Xx)(c.options.links??[],c.options.actions??[]),E={__dataContext:{value:{data:b,field:C,frame:b[0],frameIndex:0}}},S={valueRowIndex:Mr(c.data.field,t)};(0,Dr.ko)(b[0],C,E,t.panel.props.replaceVariables,c.options.actions??[],S).forEach(M=>{const w=`${M.title}/${Math.random()}`;m.has(w)||(g.push(M),m.add(w))})}return(0,y.jsx)(y.Fragment,{children:t.tooltipPayload?.element&&t.tooltipPayload.anchorPoint&&(0,y.jsx)(Ii.ZL,{zIndex:e.zIndex.tooltip,children:(0,y.jsx)(f1.o,{className:(0,Q.cx)(n.tooltipWrapper,t.tooltipPayload.isOpen&&n.pinned),position:{x:t.tooltipPayload.anchorPoint.x,y:t.tooltipPayload.anchorPoint.y},offset:{x:5,y:0},allowPointerEvents:t.tooltipPayload.isOpen,children:(0,y.jsxs)("section",{ref:o,...s,...l,children:[t.tooltipPayload.isOpen&&(0,y.jsx)(h1.J,{style:{zIndex:1},onClick:a}),(0,y.jsx)(v1.A,{item:h,isPinned:t.tooltipPayload.isOpen}),c.data.text&&(0,y.jsx)(p1.o,{items:v,isPinned:t.tooltipPayload.isOpen}),(p.length>0||g.length>0)&&(0,y.jsx)(g1.S,{dataLinks:p,actions:g})]})})})})},y1=t=>({wrapper:(0,Q.css)({marginTop:"20px",background:t.colors.background.primary}),tooltipWrapper:(0,Q.css)({top:0,left:0,whiteSpace:"pre",borderRadius:t.shape.radius.default,position:"fixed",background:t.colors.background.primary,border:`1px solid ${t.colors.border.weak}`,boxShadow:t.shadows.z2,userSelect:"text",padding:0,fontSize:t.typography.bodySmall.fontSize}),pinned:(0,Q.css)({boxShadow:t.shadows.z3})}),b1="connectionControl",C1="connection anchor",db=8,S1=[{x:-1,y:1},{x:-.5,y:1},{x:0,y:1},{x:.5,y:1},{x:1,y:1},{x:1,y:.5},{x:1,y:0},{x:1,y:-.5},{x:1,y:-1},{x:.5,y:-1},{x:0,y:-1},{x:-.5,y:-1},{x:-1,y:-1},{x:-1,y:-.5},{x:-1,y:0},{x:-1,y:.5}],hr=3,ff=2.5,rl={ROOT:1e3,ANCHOR:1001,HIGHLIGHT:1002};var E1=(t=>(t.ROOT="none",t.MOUSEOUT_DIV="none",t.ANCHOR="auto",t.HIGHLIGHT="auto",t))(E1||{});const w1=({setRef:t,setAnchorsRef:e,handleMouseLeave:n})=>{const r=(0,F.useRef)(null),i=(0,Pt.of)(D1),a=5.5,o="data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1cHgiIGhlaWdodD0iNXB4IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2Utd2lkdGg9IjIiIHN0eWxlPSJzdHJva2Utb3BhY2l0eTowLjQiIHN0cm9rZT0iI2ZmZmZmZiIvPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2U9IiMyOWI2ZjIiLz48L3N2Zz4=",s=d=>{d.target instanceof HTMLImageElement&&r.current&&d.target.style&&(r.current.style.display="block",r.current.style.top=`calc(${d.target.style.top} - ${a}px + ${hr}px)`,r.current.style.left=`calc(${d.target.style.left} - ${a}px + ${hr}px)`)},l=()=>{r.current&&(r.current.style.display="none")},c=d=>{n(d)&&l()},u=(d=S1)=>d.map(f=>{const h=`${f.x},${f.y}`,v={top:`calc(${-f.y*50+50}% - ${ff}px - ${hr}px)`,left:`calc(${f.x*50+50}% - ${ff}px - ${hr}px)`};return(0,y.jsx)("img",{id:h,ref:p=>{p&&p.style.setProperty("pointer-events","auto","important")},alt:C1,className:i.anchor,style:v,src:o,onMouseEnter:s},h)});return(0,y.jsxs)("div",{className:i.root,ref:t,children:[(0,y.jsx)("div",{className:i.mouseoutDiv,onMouseOut:c,onBlur:c}),(0,y.jsx)("div",{id:b1,ref:r,className:i.highlightElement,onMouseLeave:l}),(0,y.jsx)("div",{ref:e,children:u()})]})},D1=t=>({root:(0,Q.css)({position:"absolute",display:"none",zIndex:`${rl.ROOT} !important`,pointerEvents:"none"}),mouseoutDiv:(0,Q.css)({position:"absolute",margin:"-30px",width:"calc(100% + 60px)",height:"calc(100% + 60px)",pointerEvents:"none"}),anchor:(0,Q.css)({padding:`${hr}px`,position:"absolute",cursor:"cursor",width:`calc(5px + 2 * ${hr}px)`,height:`calc(5px + 2 * ${hr}px)`,zIndex:`${rl.ANCHOR} !important`,pointerEvents:"auto",userSelect:"none"}),highlightElement:(0,Q.css)({backgroundColor:"#00ff00",opacity:.3,position:"absolute",cursor:"cursor",pointerEvents:"auto",width:"16px",height:"16px",borderRadius:t.shape.radius.circle,display:"none",zIndex:`${rl.HIGHLIGHT} !important`})});let M1=0;const T1=["input","textarea"],k1=({setLineRef:t,setVertexPathRef:e,setVertexRef:n,setConnectionsSVGRef:r,scene:i})=>{const a=(0,Pt.of)(A1),o=Date.now()+"_"+M1++,s=(0,F.useMemo)(()=>`connectionLineId-${o}`,[o]),l=(0,F.useMemo)(()=>`editorHead-${o}`,[o]),c=ot.$W.theme2.colors.text.primary,u=2,d={mode:ft.TL.Fixed,fixed:ft.ok.Forward},f=10,[h,v]=(0,F.useState)(void 0),p=(0,F.useRef)(h);(0,F.useEffect)(()=>{p.current=h}),(0,F.useEffect)(()=>{i.panel.context.instanceState?.selectedConnection&&v(i.panel.context.instanceState?.selectedConnection)},[i.panel.context.instanceState?.selectedConnection]);const g=C=>{const E=C.target;if(E instanceof HTMLElement&&!(T1.indexOf(E.nodeName.toLowerCase())>-1)){if(C.keyCode===8||C.keyCode===46)p.current&&p.current.source&&(p.current.source.options.connections=p.current.source.options.connections?.filter(S=>S!==p.current?.info),p.current.source.onChange(p.current.source.options),v(void 0),i.connections.select(void 0),i.connections.updateState(),i.save());else return;document.removeEventListener("keyup",g),i.selecto.rootContainer.removeEventListener("click",m)}},m=C=>{const E=C.target;!(E instanceof SVGLineElement&&E.id===s)&&(v(void 0),i.connections.select(void 0))},x=C=>{i.isEditingEnabled&&(v(C),i.connections.select(C),document.addEventListener("keyup",g),i.selecto.rootContainer.addEventListener("click",m))},b=()=>i.connections.state.sort((C,E)=>h===E&&i.panel.context.instanceState.selectedConnection?-1:0).map((C,E)=>{const{source:S,target:D,info:M,vertices:w,index:T}=C,k=S.div,O=S.div?.parentElement,R=i.viewportDiv;if(!k||!O||!R)return;let{x1:L,y1:P,x2:z,y2:V}=uo(S,D,M),{xStart:N,yStart:G,xEnd:W,yEnd:B}={xStart:L,yStart:P,xEnd:z,yEnd:V};C.sourceOriginal&&C.targetOriginal?(N=C.sourceOriginal.x,G=C.sourceOriginal.y,W=C.targetOriginal.x,B=C.targetOriginal.y):S.options.connections&&(!S.options.connections[T].sourceOriginal||!S.options.connections[T].targetOriginal)&&(S.options.connections[T].sourceOriginal={x:L,y:P},S.options.connections[T].targetOriginal={x:z,y:V});const q=In(L,P,z,V),Z=W-N,K=B-G,{strokeColor:X,strokeWidth:H,strokeRadius:et,arrowDirection:rt,lineStyle:mt,shouldAnimate:vt}=_l(M,i,u,d.fixed??ft.ok.Forward),U=h===C&&i.panel.context.instanceState.selectedConnection,nt=i.isEditingEnabled?"grab":"",Rt={stroke:"#44aaff",strokeOpacity:.6,strokeWidth:H+5},ut=`connectionHeadStart-${o+Math.random()}`,dt=`connectionHeadEnd-${o+Math.random()}`,yt=et,Ot=[];let Tt=`M${L} ${P} `;w?.length&&(w.map((Nt,lt)=>{const{x:St,y:gt}=Nt,kt=St*Z+N,Lt=gt*K+G;let wt=kt,Bt=Lt,Xt=kt,bt=Lt,tt=0,Wt=0,Mt=0;if(yt){if(lt<w.length-1){const te=w[lt+1].x*Z+N,ie=w[lt+1].y*K+G;if(lt===0)Wt=pe(L,P,kt,Lt),Mt=pe(kt,Lt,te,ie);else{const Ut=w[lt-1],Dt=Ut.x*Z+N,Gt=Ut.y*K+G;Wt=pe(Dt,Gt,kt,Lt),Mt=pe(kt,Lt,te,ie)}}else{if(lt>0){const te=w[lt-1],ie=te.x*Z+N,Ut=te.y*K+G;Wt=pe(ie,Ut,kt,Lt)}else Wt=pe(L,P,kt,Lt);Mt=pe(kt,Lt,z,V)}const jt=Mt-Wt,Yt=jt<0;tt=yt*Math.tan(jt/2),Yt&&(tt*=-1)}if(lt===0){if(Ot.push(In((L-N)/(W-N),(P-G)/(B-G),St,gt)),yt){const jt=Pn(kt,Lt,L,P);Math.abs(tt)>.5*Math.abs(jt)&&(tt=.5*jt);let Yt=z,te=V;if(lt<w.length-1){const Dt=w[lt+1];Yt=Dt.x*Z+N,te=Dt.y*K+G}const ie=Pn(kt,Lt,Yt,te);Math.abs(tt)>.5*Math.abs(ie)&&(tt=.5*ie);const Ut=jt-tt;wt=Math.round(Ut*Math.cos(Wt)+L),Bt=Math.round(Ut*Math.sin(Wt)+P),Xt=Math.round(tt*Math.cos(Mt)+kt),bt=Math.round(tt*Math.sin(Mt)+Lt),(wt>kt&&wt>L||wt<kt&&wt<L)&&(wt=(Ut+2*tt)*Math.cos(Wt)+L,Bt=(Ut+2*tt)*Math.sin(Wt)+P,Xt=-tt*Math.cos(Mt)+kt,bt=-tt*Math.sin(Mt)+Lt)}}else{const jt=w[lt-1];if(Ot.push(In(jt.x,jt.y,St,gt)),yt){const Yt=jt.x*Z+N,te=jt.y*K+G,ie=Pn(kt,Lt,Yt,te);Math.abs(tt)>.5*Math.abs(ie)&&(tt=.5*ie);let Ut=z,Dt=V;if(lt<w.length-1){const Cn=w[lt+1];Ut=Cn.x*Z+N,Dt=Cn.y*K+G}const Gt=Pn(kt,Lt,Ut,Dt);Math.abs(tt)>.5*Math.abs(Gt)&&(tt=.5*Gt);const Ie=ie-tt;wt=Math.round(Ie*Math.cos(Wt)+Yt),Bt=Math.round(Ie*Math.sin(Wt)+te),Xt=Math.round(tt*Math.cos(Mt)+kt),bt=Math.round(tt*Math.sin(Mt)+Lt),(wt>kt&&wt>Yt||wt<kt&&wt<Yt)&&(wt=(Ie+2*tt)*Math.cos(Wt)+Yt,Bt=(Ie+2*tt)*Math.sin(Wt)+te,Xt=-tt*Math.cos(Mt)+kt,bt=-tt*Math.sin(Mt)+Lt)}}lt===w.length-1&&Ot.push(In((z-N)/(W-N),(V-G)/(B-G),St,gt)),Tt+=`L${wt} ${Bt} `,tt!==0&&(Tt+=`Q ${kt} ${Lt} ${Xt} ${bt} `)}),Tt+=`L${z} ${V}`);const xt=rt===ft.ok.Reverse||rt===ft.ok.Both?`url(#${ut})`:void 0,Ct=rt===ft.ok.Forward||rt===ft.ok.Both?`url(#${dt})`:void 0,Ht=()=>{let Nt="100;0";return rt===ft.ok.Reverse&&(Nt="0;100"),Nt};return(0,y.jsxs)("g",{onClick:()=>x(C),children:[(0,y.jsxs)("defs",{children:[(0,y.jsx)("marker",{id:ut,markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",stroke:X,children:(0,y.jsx)("polygon",{points:"10 0, 0 3.5, 10 7",fill:X})}),(0,y.jsx)("marker",{id:dt,markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",stroke:X,children:(0,y.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:X})})]}),w?.length?(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{id:`${s}_transparent`,d:Tt,cursor:nt,pointerEvents:"auto",stroke:"transparent",strokeWidth:15,fill:"none",style:U?Rt:{}}),(0,y.jsx)("path",{d:Tt,stroke:X,strokeWidth:H,strokeDasharray:mt,strokeDashoffset:1,fill:"none",markerEnd:Ct,markerStart:xt,children:vt&&(0,y.jsx)("animate",{attributeName:"stroke-dashoffset",values:Ht(),dur:"5s",calcMode:"linear",repeatCount:"indefinite",fill:"freeze"})}),U&&(0,y.jsxs)("g",{children:[w.map((Nt,lt)=>(0,y.jsx)("circle",{id:Li,"data-index":lt,cx:Nt.x*Z+N,cy:Nt.y*K+G,r:5,stroke:X,className:a.vertex,cursor:"crosshair",pointerEvents:"auto"},`${Li}${lt}_${E}`)),w.length<f&&Ot.map((Nt,lt)=>(0,y.jsx)("circle",{id:fr,"data-index":lt,cx:Nt.x*Z+N,cy:Nt.y*K+G,r:4,stroke:X,className:a.addVertex,cursor:"crosshair",pointerEvents:"auto"},`${fr}${lt}_${E}`))]})]}):(0,y.jsxs)("g",{children:[(0,y.jsx)("line",{id:`${s}_transparent`,cursor:nt,pointerEvents:"auto",stroke:"transparent",strokeWidth:15,style:U?Rt:{},x1:L,y1:P,x2:z,y2:V}),(0,y.jsx)("line",{id:s,stroke:X,pointerEvents:"auto",strokeWidth:H,markerEnd:Ct,markerStart:xt,strokeDasharray:mt,strokeDashoffset:1,x1:L,y1:P,x2:z,y2:V,cursor:nt,children:vt&&(0,y.jsx)("animate",{attributeName:"stroke-dashoffset",values:Ht(),dur:"5s",calcMode:"linear",repeatCount:"indefinite",fill:"freeze"})}),U&&(0,y.jsx)("circle",{id:fr,"data-index":0,cx:q.x,cy:q.y,r:4,stroke:X,className:a.addVertex,cursor:"crosshair",pointerEvents:"auto"})]})]},E)});return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)("svg",{ref:r,className:a.connection,children:[(0,y.jsx)("defs",{children:(0,y.jsx)("marker",{id:l,markerWidth:"10",markerHeight:"7",refX:"10",refY:"3.5",orient:"auto",stroke:c,children:(0,y.jsx)("polygon",{points:"0 0, 10 3.5, 0 7",fill:c})})}),(0,y.jsx)("line",{ref:t,stroke:c,strokeWidth:2,markerEnd:`url(#${l})`,style:{display:"none"}}),(0,y.jsx)("path",{ref:e,stroke:c,strokeWidth:2,strokeDasharray:"5, 5",fill:"none",style:{display:"none"}}),(0,y.jsx)("circle",{ref:n,stroke:c,r:4,className:a.vertex,style:{display:"none"}}),b()]})})},A1=t=>({connection:(0,Q.css)({position:"absolute",zIndex:1e3,pointerEvents:"none"}),vertex:(0,Q.css)({fill:"#44aaff",strokeWidth:2}),addVertex:(0,Q.css)({fill:"#44aaff",opacity:.5,strokeWidth:1})}),fb="vertex",hb="vertexAdd",Hn=.05,R1=5/180*Math.PI;class O1{constructor(e){this.state=[],this.selection=new nl.t(void 0),this.select=n=>{n!==this.selection.value&&this.selection.next(n)},this.updateState=()=>{this.state=lo(this.scene.byName);const n=this.selection.value;if(n){for(let r of this.state)if(r.source===n.source&&r.index===n.index){this.selection.next(r);break}}},this.setConnectionAnchorRef=n=>{this.connectionAnchorDiv=n},this.setAnchorsRef=n=>{this.anchorsDiv=n},this.setConnectionsSVGRef=n=>{this.connectionsSVG=n},this.setConnectionLineRef=n=>{this.connectionLine=n},this.setConnectionVertexRef=n=>{this.connectionVertex=n},this.setConnectionVertexPathRef=n=>{this.connectionVertexPath=n},this.findElementTarget=n=>{let r;if(n!==this.scene.viewportDiv)return r=be(n,this.scene.root.elements),!r&&n.parentElement&&(r=this.findElementTarget(n.parentElement)),r},this.handleMouseEnter=n=>{if(!(n.target instanceof Element)||!this.scene.isEditingEnabled)return;let r=this.findElementTarget(n.target);if(!r){console.log("no element");return}if(this.isDrawingConnection)this.connectionTarget=r;else if(this.connectionSource=r,!this.connectionSource){console.log("no connection source");return}const i=r?.item.customConnectionAnchors||el,a=Array.from(this.anchorsDiv?.children),o=i.length;a.forEach((f,h)=>{if(h>=o)f.style.display="none";else{const{x:v,y:p}=i[h];f.style.top=`calc(${-p*50+50}% - ${Xr}px - ${ln}px)`,f.style.left=`calc(${v*50+50}% - ${Xr}px - ${ln}px)`,f.style.display="block"}});const{top:s,left:l,width:c,height:u,rotation:d}=fo(r.div);this.connectionAnchorDiv&&(this.connectionAnchorDiv.style.display="none",this.connectionAnchorDiv.style.display="block",this.connectionAnchorDiv.style.transform=`translate(${l}px, ${s}px) rotate(${d}deg)`,this.connectionAnchorDiv.style.height=`${u}px`,this.connectionAnchorDiv.style.width=`${c}px`)},this.handleMouseLeave=n=>n.relatedTarget instanceof HTMLImageElement&&n.relatedTarget.getAttribute("alt")===tl?!1:(this.connectionTarget=void 0,this.connectionAnchorDiv.style.display="none",!0),this.connectionListener=n=>{if(n.preventDefault(),!(this.connectionLine&&this.scene.viewportDiv&&this.scene.viewportDiv.parentElement))return;const{scale:r}=this.scene,i=en(this.scene);if(!i)return;const a=(n.pageX-i.x)/r,o=(n.pageY-i.y)/r;this.connectionLine.setAttribute("x2",`${a}`),this.connectionLine.setAttribute("y2",`${o}`);const s=this.connectionLine.x1.baseVal.value,l=this.connectionLine.y1.baseVal.value;if(this.didConnectionLeaveHighlight||Math.hypot(a-s,o-l)>Kr&&(this.didConnectionLeaveHighlight=!0,this.connectionLine.style.display="block",this.isDrawingConnection=!0),!n.buttons){if(this.connectionSource&&this.connectionSource.div&&this.connectionSource.div.parentElement){const{x:c,y:u}=Ol(this.connectionSource.div,s,l);let d,f,h;this.connectionTarget&&this.connectionTarget.div?({x:d,y:f}=Ol(this.connectionTarget.div,a,o),h=this.connectionTarget.options.name):(d=a,f=o);const v={source:{x:c,y:u},target:{x:d,y:f},targetName:h,color:{fixed:De.$.theme2.colors.text.primary},size:{fixed:2,min:1,max:10},path:no.Straight},{options:p}=this.connectionSource;p.connections||(p.connections=[]),this.didConnectionLeaveHighlight&&(this.connectionSource.options.connections=[...p.connections,v],this.connectionSource.onChange(this.connectionSource.options))}this.connectionLine&&(this.connectionLine.style.display="none"),this.scene.selecto&&this.scene.selecto.rootContainer&&(this.scene.selecto.rootContainer.style.cursor="default",this.scene.selecto.rootContainer.removeEventListener("mousemove",this.connectionListener)),this.isDrawingConnection=!1,this.updateState(),this.scene.save()}},this.vertexListener=n=>{if(this.scene.selecto.rootContainer.style.cursor="crosshair",n.preventDefault(),!(this.connectionVertex&&this.scene.viewportDiv&&this.scene.viewportDiv.parentElement))return;const r=en(this.scene);if(!r)return;const{scale:i}=this.scene,a=(n.pageX-r.x)/i,o=(n.pageY-r.y)/i;this.connectionVertex?.setAttribute("cx",`${a}`),this.connectionVertex?.setAttribute("cy",`${o}`);const s=this.selection.value,{x1:l,y1:c,x2:u,y2:d}=uo(s.source,s.target,s?.info);let{xStart:f,yStart:h,xEnd:v,yEnd:p}={xStart:l,yStart:c,xEnd:u,yEnd:d};s?.sourceOriginal&&s.targetOriginal&&(f=s.sourceOriginal.x,h=s.sourceOriginal.y,v=s.targetOriginal.x,p=s.targetOriginal.y);const g=v-f,m=p-h;let x=l,b=c,C=u,E=d;s&&s.vertices&&(this.selectedVertexIndex!==void 0&&this.selectedVertexIndex>0&&(x=s.vertices[this.selectedVertexIndex-1].x*g+f,b=s.vertices[this.selectedVertexIndex-1].y*m+h),this.selectedVertexIndex!==void 0&&this.selectedVertexIndex<s.vertices.length-1&&(C=s.vertices[this.selectedVertexIndex+1].x*g+f,E=s.vertices[this.selectedVertexIndex+1].y*m+h));let S=a,D=o,M=!1;if(!n.ctrlKey){const w=Math.abs((S-x)/(D-b))<Hn,T=Math.abs((S-C)/(D-E))<Hn,k=Math.abs((D-b)/(S-x))<Hn,O=Math.abs((D-E)/(S-C))<Hn;w?S=x:T&&(S=C),k?D=b:O&&(D=E),(w||T)&&(k||O)?this.scene.selecto.rootContainer.style.cursor="move":w||T?this.scene.selecto.rootContainer.style.cursor="col-resize":(k||O)&&(this.scene.selecto.rootContainer.style.cursor="row-resize");const R=pe(x,b,C,E),L=pe(x,b,a,o);M=Math.abs(L-R)<R1}if(M?(this.connectionVertexPath?.setAttribute("d",`M${x} ${b} L${C} ${E}`),this.connectionVertexPath.style.display="block",this.connectionVertex.style.display="none"):(this.connectionVertexPath?.setAttribute("d",`M${x} ${b} L${S} ${D} L${C} ${E}`),this.connectionVertexPath.style.display="block",this.connectionVertex.style.display="block"),!n.buttons){this.scene.selecto?.rootContainer?.removeEventListener("mousemove",this.vertexListener),this.scene.selecto?.rootContainer?.removeEventListener("mouseup",this.vertexListener),this.scene.selecto.rootContainer.style.cursor="auto",this.connectionVertexPath.style.display="none",this.connectionVertex.style.display="none";const w=s?.index,T=this.selectedVertexIndex;if(w!==void 0&&T!==void 0){const k=s.source;if(k.options.connections){const O=[...k.options.connections];if(O[w].vertices){const R=[...O[w].vertices];if(M)R.splice(T,1);else{const L={...R[T]};L.x=(S-f)/g,L.y=(D-h)/m,R[T]=L}O[w]={...O[w],vertices:R},k.onChange({...k.options,connections:O}),this.updateState(),this.scene.save()}}}}},this.vertexAddListener=n=>{if(this.scene.selecto.rootContainer.style.cursor="crosshair",n.preventDefault(),!(this.connectionVertex&&this.scene.viewportDiv&&this.scene.viewportDiv.parentElement))return;const r=en(this.scene);if(!r)return;const{scale:i}=this.scene,a=(n.pageX-r.x)/i,o=(n.pageY-r.y)/i;this.connectionVertex?.setAttribute("cx",`${a}`),this.connectionVertex?.setAttribute("cy",`${o}`);const s=this.selection.value,{x1:l,y1:c,x2:u,y2:d}=uo(s.source,s.target,s?.info);let{xStart:f,yStart:h,xEnd:v,yEnd:p}={xStart:l,yStart:c,xEnd:u,yEnd:d};s?.sourceOriginal&&s.targetOriginal&&(f=s.sourceOriginal.x,h=s.sourceOriginal.y,v=s.targetOriginal.x,p=s.targetOriginal.y);const g=v-f,m=p-h;let x=l,b=c,C=u,E=d;s&&s.vertices&&(this.selectedVertexIndex!==void 0&&this.selectedVertexIndex>0&&(x=s.vertices[this.selectedVertexIndex-1].x*g+f,b=s.vertices[this.selectedVertexIndex-1].y*m+h),this.selectedVertexIndex!==void 0&&this.selectedVertexIndex<s.vertices.length&&(C=s.vertices[this.selectedVertexIndex].x*g+f,E=s.vertices[this.selectedVertexIndex].y*m+h));let S=a,D=o;if(!n.ctrlKey){const M=Math.abs((S-x)/(D-b))<Hn,w=Math.abs((S-C)/(D-E))<Hn,T=Math.abs((D-b)/(S-x))<Hn,k=Math.abs((D-E)/(S-C))<Hn;M?S=x:w&&(S=C),T?D=b:k&&(D=E),(M||w)&&(T||k)?this.scene.selecto.rootContainer.style.cursor="move":M||w?this.scene.selecto.rootContainer.style.cursor="col-resize":(T||k)&&(this.scene.selecto.rootContainer.style.cursor="row-resize")}if(this.connectionVertexPath?.setAttribute("d",`M${x} ${b} L${S} ${D} L${C} ${E}`),this.connectionVertexPath.style.display="block",this.connectionVertex.style.display="block",!n.buttons){this.scene.selecto?.rootContainer?.removeEventListener("mousemove",this.vertexAddListener),this.scene.selecto?.rootContainer?.removeEventListener("mouseup",this.vertexAddListener),this.scene.selecto.rootContainer.style.cursor="auto",this.connectionVertexPath.style.display="none",this.connectionVertex.style.display="none";const M=s?.index,w=this.selectedVertexIndex;if(M!==void 0&&w!==void 0){const T=s.source;if(T.options.connections){const k=[...T.options.connections],O={x:(S-f)/g,y:(D-h)/m};if(k[M].vertices){const R=[...k[M].vertices];R.splice(w,0,O),k[M]={...k[M],vertices:R}}else{const R=[O];k[M]={...k[M],vertices:R}}(!k[M].sourceOriginal||!k[M].targetOriginal)&&(k[M]={...k[M],sourceOriginal:{x:l,y:c},targetOriginal:{x:u,y:d}}),T.onChange({...T.options,connections:k}),this.updateState(),this.scene.save()}}}},this.handleConnectionDragStart=(n,r,i)=>{if(this.scene.selecto.rootContainer.style.cursor="crosshair",this.connectionLine&&this.scene.viewportDiv&&this.scene.viewportDiv.parentElement){const a=n.getBoundingClientRect(),{scale:o}=this.scene,s=en(this.scene);if(!s)return;const l=Kr*o,c=Kr*o,u=(a.x-s.x+l)/o,d=(a.y-s.y+c)/o,f=r-s.x,h=i-s.y;this.connectionLine.setAttribute("x1",`${u}`),this.connectionLine.setAttribute("y1",`${d}`),this.connectionLine.setAttribute("x2",`${f}`),this.connectionLine.setAttribute("y2",`${h}`),this.didConnectionLeaveHighlight=!1}this.scene.selecto?.rootContainer?.addEventListener("mousemove",this.connectionListener)},this.handleVertexDragStart=n=>{this.selectedVertexIndex=Number(n.getAttribute("data-index")),this.scene.selecto?.rootContainer?.addEventListener("mousemove",this.vertexListener),this.scene.selecto?.rootContainer?.addEventListener("mouseup",this.vertexListener)},this.handleVertexAddDragStart=n=>{this.selectedVertexIndex=Number(n.getAttribute("data-index")),this.scene.selecto?.rootContainer?.addEventListener("mousemove",this.vertexAddListener),this.scene.selecto?.rootContainer?.addEventListener("mouseup",this.vertexAddListener)},this.onChange=(n,r)=>{const i=n.source.options.connections?.splice(0)??[];i[n.index]=r,n.source.onChange({...n.source.options,connections:i}),this.updateState()},this.connectionsNeedUpdate=n=>Al(n)||so(n,this.scene.byName),this.scene=e,this.updateState()}render(){return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(w1,{setRef:this.setConnectionAnchorRef,setAnchorsRef:this.setAnchorsRef,handleMouseLeave:this.handleMouseLeave}),(0,y.jsx)(k1,{setLineRef:this.setConnectionLineRef,setVertexPathRef:this.setConnectionVertexPathRef,setVertexRef:this.setConnectionVertexRef,setConnectionsSVGRef:this.setConnectionsSVGRef,scene:this.scene})]})}}class L1 extends Be{constructor(e,n,r){super(e,n),this.options=e,this.scene=n,this.changeCallback=r,this.setRootRef=i=>{this.div=i},this.sizeStyle={height:"100%",width:"100%"}}isRoot(){return!0}onChange(e){this.revId++,this.options={...e},this.changeCallback()}getSaveModel(){const{placement:e,constraint:n,...r}=this.options;return{...r,elements:this.elements.map(i=>i.getSaveModel())}}render(){return(0,y.jsx)("div",{onContextMenu:e=>e.preventDefault(),ref:this.setRootRef,style:{...this.sizeStyle,...this.dataStyle},children:this.elements.map(e=>(0,y.jsx)(F.Fragment,{children:e.render()},e.UID))},this.UID)}}class _1{constructor(e,n,r){this.onSave=n,this.styles=I1(),this.selection=new cf.m(1),this.moved=new df.B,this.byName=new Map,this.revId=0,this.width=0,this.height=0,this.scale=1,this.scrollLeft=0,this.scrollTop=0,this.style={},this.skipNextSelectionBroadcast=!1,this.ignoreDataUpdate=!1,this.contextMenuOnVisibilityChange=o=>{this.contextMenuVisible=o},this.isPanelEditing=uf.Ny.getSearchObject().editPanel!==void 0,this.editModeEnabled=new nl.t(!1),this.targetsToSelect=new Set,this.getNextElementName=(o=!1)=>{const s=o?"Frame":"Element";let l=this.byName.size+1;const c=l+100;for(;l<c;){const u=`${s} ${l++}`;if(!this.byName.has(u))return u}return`${s} ${Date.now()}`},this.canRename=o=>!this.byName.has(o),this.context={getColor:o=>(0,Ur.Wb)(this.data,o),getScale:o=>(0,Ur.XV)(this.data,o),getScalar:o=>(0,Ur.b5)(this.data,o),getText:o=>(0,Ur.wv)(this.data,o),getResource:o=>(0,Ur.B_)(this.data,o),getDirection:o=>(0,Ur.eO)(this.data,o),getPanelData:()=>this.data},this.save=(o=!1)=>{this.onSave(this.root.getSaveModel()),o&&setTimeout(()=>{ot.$W.featureToggles.canvasPanelPanZoom?this.viewportDiv&&this.viewerDiv&&(_i(!0,this.isEditingEnabled,this),this.updateConnectionsSize()):this.div&&_i(!0,this.isEditingEnabled,this)})},this.setNonTargetPointerEvents=(o,s)=>{const l=[...this.root.elements];for(;l.length>0;){const c=l.shift();c&&c.div&&c.div!==o&&c.applyLayoutStylesToDiv(s);const u=c instanceof Be?c.elements:[];for(const d of u)l.unshift(d)}},this.setRef=o=>{this.div=o},this.setViewerRef=o=>{this.viewerDiv=o},this.setViewportRef=o=>{this.viewportDiv=o},this.select=o=>{this.selecto&&(this.selecto.setSelectedTargets(o.targets),this.updateSelection(o),this.editModeEnabled.next(!1),this.connections.connectionAnchorDiv&&(this.connections.connectionAnchorDiv.style.display="none"))},this.updateSelection=o=>{if(this.moveable.target=o.targets,this.skipNextSelectionBroadcast){this.skipNextSelectionBroadcast=!1;return}if(o.frame)this.selection.next([o.frame]);else{const s=o.targets.map(l=>be(l,this.root.elements));this.selection.next(s)}},this.addToSelection=()=>{try{let o={targets:[]};o.targets=[...this.targetsToSelect],this.select(o)}catch{yr.A.emit(En.r1.alertError,["Unable to add to selection"])}},this.fitContent=(o,s)=>{const{root:l,viewerDiv:c,infiniteViewer:u}=o;if(s&&l.div&&u&&c){const d=e1(Array.from(l.div.children),c),{scale:f,centerX:h,centerY:v}=d;u.setZoom(f),u.scrollTo(h,v)}};const i=(0,Vi.UA)().getCurrent(),a=e.inlineEditing&&i?.editable;this.root=this.load(e,a),this.subscription=this.editModeEnabled.subscribe(o=>{!this.moveable||!this.isEditingEnabled||(this.moveable.draggable=!o)}),this.panel=r,this.connections=ot.$W.featureToggles.canvasPanelPanZoom?new O1(this):new Ym(this)}load(e,n){const{root:r,showAdvancedTypes:i,panZoom:a,zoomToContent:o,tooltip:s}=e,l=s?.mode??ft.$N.Single,c=s?.disableForOneClick??!1;return this.root=new L1(r??{type:"frame",elements:[ro]},this,this.save),this.isEditingEnabled=n,this.shouldShowAdvancedTypes=i,this.shouldPanZoom=a,this.zoomToContent=o,this.tooltipMode=l,this.tooltipDisableForOneClick=c,setTimeout(()=>{ot.$W.featureToggles.canvasPanelPanZoom?this.viewportDiv&&this.viewerDiv&&(this.shouldPanZoom||(this.scale=1,this.scrollLeft=0,this.scrollTop=0),_i(n,n,this),this.currentLayer=this.root,this.selection.next([]),this.connections.select(void 0),this.connections.updateState(),this.updateConnectionsSize(),this.fitContent(this,o)):this.div&&(_i(n,n,this),this.currentLayer=this.root,this.selection.next([]),this.connections.select(void 0),this.connections.updateState())}),this.root}updateData(e){this.data=e,this.root.updateData(this.context)}updateSize(e,n){this.width=e,this.height=n,this.style={width:e,height:n},ot.$W.featureToggles.canvasPanelPanZoom&&(this.updateConnectionsSize(),this.fitContent(this,this.zoomToContent),this.root.elements.forEach(r=>{r.applyLayoutStylesToDiv(!1)}),this.connections.connectionAnchorDiv&&(this.connections.connectionAnchorDiv.style.display="none"))}updateConnectionsSize(){const e=this.connections.connectionsSVG;if(e){const n=this.infiniteViewer.getZoom(),r=this.infiniteViewer.getScrollLeft()||0,i=this.infiniteViewer.getScrollTop()||0,a=this.width,o=this.height;e.style.left=`${r}px`,e.style.top=`${i}px`,e.style.width=`${a/n}px`,e.style.height=`${o/n}px`,e.setAttribute("viewBox",`${r} ${i} ${a/n} ${o/n}`)}}clearCurrentSelection(e=!1){this.skipNextSelectionBroadcast=e;let n=new MouseEvent("click");ot.$W.featureToggles.canvasPanelPanZoom?this.selecto?.clickTarget(n,this.viewportDiv):this.selecto?.clickTarget(n,this.div)}render(){const e=this.tooltipPayload?.element?.getLinks&&this.tooltipPayload.element.getLinks({}).length>0,n=this.tooltipPayload?.element?.options.actions&&this.tooltipPayload.element.options.actions.filter(l=>l.type===Ml.X2.Fetch||(0,Dr.Bs)(l)).length>0,r=e||n||this.tooltipPayload?.element?.data?.field,i=this.tooltipMode!==ft.$N.None,a=this.tooltipDisableForOneClick&&this.tooltipPayload?.element?.oneClickMode!==Ce.yd.Off,o=!this.isEditingEnabled&&r&&i&&!a,s=(0,y.jsxs)(y.Fragment,{children:[this.connections.render(),this.root.render(),this.isEditingEnabled&&(0,y.jsx)(Ii.ZL,{children:(0,y.jsx)(s1,{scene:this,panel:this.panel,onVisibilityChange:this.contextMenuOnVisibilityChange})}),o&&(0,y.jsx)(Ii.ZL,{children:(0,y.jsx)(x1,{scene:this})})]});return ot.$W.featureToggles.canvasPanelPanZoom?(0,y.jsx)("div",{className:this.styles.viewer,ref:this.setViewerRef,"data-testid":"canvas-scene-wrapper",children:(0,y.jsx)("div",{className:this.styles.viewport,ref:this.setViewportRef,"data-testid":"canvas-scene-pan-zoom",children:s},this.revId)},this.revId):(0,y.jsx)("div",{className:this.styles.wrap,style:this.style,ref:this.setRef,"data-testid":"canvas-scene",children:s},this.revId)}}const I1=()=>({wrap:(0,Q.css)({overflow:"hidden",position:"relative"}),selected:(0,Q.css)({zIndex:"999 !important"}),viewer:(0,Q.css)({overflow:"hidden",width:"100%",height:"100%"}),viewport:(0,Q.css)({width:"100%",height:"100%"})});var hf=j(87745),P1=j(73304),vf=j(4896);function z1({onClose:t,scene:e,anchorPoint:n}){const r=e.root.options.background?.image?.fixed??"",[i,a]=(0,F.useState)(r),o=(0,Pt.$j)(),s=N1(o,n),l=c=>{c&&(a(c),e.root&&(e.root.options.background={...e.root.options.background,image:{mode:ft.q_.Fixed,fixed:c}},e.revId++,e.save(),e.root.reinitializeMoveable()),e&&e.updateData(e.data)),t()};return(0,y.jsx)(Ii.ZL,{className:s.portalWrapper,children:(0,y.jsx)(P1.i,{onChange:l,value:i,mediaType:vf.zu.Image,folderName:vf.Iu.IOT})})}const N1=(t,e)=>({portalWrapper:(0,Q.css)({width:"315px",height:"445px",transform:`translate(${e.x}px, ${e.y-200}px)`})});var B1=j(55794),j1=j.n(B1),V1=j(66036),pf=j(29043),gf=j(86956),F1=j(74098),il=j(25797),G1=j(56424),Za=j(61215);const $1=({value:t,onChange:e})=>{const n=[{value:$.xp.Original,label:(0,A.t)("dimensions.background-size-editor.options.label-original","Original")},{value:$.xp.Contain,label:(0,A.t)("dimensions.background-size-editor.options.label-contain","Contain")},{value:$.xp.Cover,label:(0,A.t)("dimensions.background-size-editor.options.label-cover","Cover")},{value:$.xp.Fill,label:(0,A.t)("dimensions.background-size-editor.options.label-fill","Fill")},{value:$.xp.Tile,label:(0,A.t)("dimensions.background-size-editor.options.label-tile","Tile")}],r=t??$.xp.Cover,i=(0,F.useCallback)(a=>{e(a)},[e]);return(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{grow:!0,children:(0,y.jsx)(br.z,{value:r,options:n,onChange:i,fullWidth:!0})})})},W1={settings:{}},H1=({value:t,context:e,onChange:n})=>{const r=[{label:(0,A.t)("dimensions.direction-dimension-editor.label-fixed","Fixed"),value:ft.TL.Fixed,description:(0,A.t)("dimensions.direction-dimension-editor.description-fixed","Fixed direction value")},{label:(0,A.t)("dimensions.direction-dimension-editor.label-field","Field"),value:ft.TL.Field,description:(0,A.t)("dimensions.direction-dimension-editor.description-field","Direction based on field value")}],i=[{value:ft.ok.Forward,label:(0,A.t)("canvas.connection.direction-options.label-forward","Forward")},{value:ft.ok.Reverse,label:(0,A.t)("canvas.connection.direction-options.label-reverse","Reverse")},{value:ft.ok.Both,label:(0,A.t)("canvas.connection.direction-options.label-both","Both")},{value:ft.ok.None,label:(0,A.t)("canvas.connection.direction-options.label-none","None")}],a=9,o=(0,F.useCallback)(d=>{n({...t,mode:d})},[n,t]),s=(0,F.useCallback)(d=>{n({...t,field:d})},[n,t]),l=(0,F.useCallback)(d=>{n({...t,field:void 0,fixed:d.value??ft.ok.Forward})},[n,t]),c=t?.mode??ft.TL.Fixed,u=i.find(d=>d.value===t?.fixed)||i[0];return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:(0,A.t)("dimensions.direction-dimension-editor.label-source","Source"),labelWidth:a,grow:!0,children:(0,y.jsx)(br.z,{value:c,options:r,onChange:o,fullWidth:!0})})}),c===ft.TL.Field&&(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:(0,A.t)("dimensions.direction-dimension-editor.label-field","Field"),labelWidth:a,grow:!0,children:(0,y.jsx)(Cl.O,{context:e,value:t?.field??"",onChange:s,item:W1})})}),c===ft.TL.Fixed&&(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:(0,A.t)("dimensions.direction-dimension-editor.label-direction","Direction"),labelWidth:a,grow:!0,children:(0,y.jsx)(xe.l6,{value:u,options:i,onChange:l})})})]})};var mf=j(71820),Y1=j(21285);const K1=[{value:je.Solid,label:"Solid"},{value:je.Dashed,label:"Dashed"},{value:je.Dotted,label:"Dotted"}],X1={style:je.Solid,animate:!1},U1=({value:t,onChange:e})=>{t?typeof t!="object"&&(t={style:t,animate:!1}):t=X1;const n=(0,F.useCallback)(i=>{e({...t,style:i})},[e,t]),r=(0,F.useCallback)(i=>{e({...t,animate:i})},[e,t]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(br.z,{value:t.style,options:K1,onChange:n,fullWidth:!0}),t.style!==je.Solid&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("br",{}),(0,y.jsx)(wn.D,{label:(0,A.t)("canvas.line-style-editor.label-animate","Animate"),children:(0,y.jsx)(Y1.d,{value:t.animate,onChange:i=>r(i.currentTarget.checked)})})]})]})};var Z1=j(23207);function Q1({value:t,onChange:e,item:n,context:r}){const i=n.settings?.links||[];return(0,y.jsx)(Z1.G,{actions:t,onChange:a=>{a.some(({oneClick:o})=>o===!0)&&i.forEach(o=>{o.oneClick=!1}),e(a)},getSuggestions:()=>r.getSuggestions?r.getSuggestions(Ce.uP.Values):[],data:[],showOneClick:!0})}var q1=j(96822);function J1({value:t,onChange:e,item:n,context:r}){const i=n.settings?.actions||[];return(0,y.jsx)(q1.e,{links:t,onChange:a=>{a.some(({oneClick:o})=>o===!0)&&i.forEach(o=>{o.oneClick=!1}),e(a)},getSuggestions:()=>r.getSuggestions?r.getSuggestions(Ce.uP.Values):[],data:[],showOneClick:!0})}const xf=(t,e)=>e!=="frame"&&e!==void 0?[t+` (${e})`]:[t],cn={addBackground:(t,e)=>{const n=xf((0,A.t)("canvas.category-background","Background"),e.options?.type);t.addCustomEditor({category:n,id:"background.color",path:"background.color",name:(0,A.t)("canvas.label-color","Color"),editor:fe.N,settings:{},defaultValue:{fixed:""}}).addCustomEditor({category:n,id:"background.image",path:"background.image",name:(0,A.t)("canvas.label-image","Image"),editor:xl.m,settings:{resourceType:"image"}}).addCustomEditor({category:n,id:"background.size",path:"background.size",name:(0,A.t)("canvas.label-image-size","Image size"),editor:$1,settings:{resourceType:"image"},showIf:()=>e.options?.type?!ao.has(e.options.type):!0})},addBorder:(t,e)=>{const n=xf((0,A.t)("canvas.category-border","Border"),e.options?.type);t.addSliderInput({category:n,path:"border.width",name:(0,A.t)("canvas.label-width","Width"),defaultValue:2,settings:{min:0,max:20}}),e.options?.border?.width&&t.addCustomEditor({category:n,id:"border.color",path:"border.color",name:(0,A.t)("canvas.label-color","Color"),editor:fe.N,settings:{},defaultValue:{fixed:""}}),t.addSliderInput({category:n,path:"border.radius",name:(0,A.t)("canvas.label-radius","Radius"),defaultValue:0,settings:{min:0,max:60}})},addColor:(t,e)=>{const n=[(0,A.t)("canvas.category-color","Color")];t.addCustomEditor({category:n,id:"color",path:"color",name:(0,A.t)("canvas.label-color","Color"),editor:fe.N,settings:{},defaultValue:{fixed:""}})},addSize:(t,e)=>{const n=[(0,A.t)("canvas.category-size","Size")];t.addCustomEditor({category:n,id:"size",path:"size",name:(0,A.t)("canvas.label-size","Size"),editor:mf.g,settings:{min:1,max:10},defaultValue:{fixed:2,min:1,max:10}})},addRadius:(t,e)=>{const n=[(0,A.t)("canvas.category-radius","Radius")];t.addCustomEditor({category:n,id:"radius",path:"radius",name:(0,A.t)("canvas.label-radius","Radius"),editor:mf.g,settings:{min:0,max:200,filteredFieldType:io.PU.number},defaultValue:{fixed:0,min:0,max:100}})},addDirection:(t,e)=>{const n=[(0,A.t)("canvas.category-arrow-direction","Direction")];t.addCustomEditor({category:n,id:"direction",path:"direction",name:(0,A.t)("canvas.label-direction","Direction"),editor:H1,settings:{},defaultValue:{mode:ft.TL.Fixed,fixed:ft.ok.Forward}})},addLineStyle:(t,e)=>{const n=[(0,A.t)("canvas.category-line-style","Line style")];t.addCustomEditor({category:n,id:"lineStyle",path:"lineStyle",name:(0,A.t)("canvas.label-line-style","Line style"),editor:U1,settings:{},defaultValue:{value:je.Solid,label:(0,A.t)("canvas.line-style-options.label-solid","Solid")}})},addDataLinks:(t,e)=>{t.addCustomEditor({category:[(0,A.t)("canvas.category-data-links","Data links and actions")],id:"dataLinks",path:"links",name:(0,A.t)("canvas.label-links","Links"),editor:J1,settings:e.options})},addActions:(t,e)=>{t.addCustomEditor({category:[(0,A.t)("canvas.category-data-links","Data links and actions")],id:"actions",path:"actions",name:(0,A.t)("canvas.label-actions","Actions"),editor:Q1,settings:e.options})}};function yf(t){return{category:t.category,path:"--",values:e=>({getValue:n=>(0,ne.get)(t.connection.info,n),onChange:(n,r)=>{let i=t.connection.info;i=(0,Za.Sf)(i,n,r),t.scene.connections.onChange(t.connection,i)}}),build:(e,n)=>{const r={...n,options:t.connection.info};cn.addColor(e,r),cn.addSize(e,r),cn.addRadius(e,r),cn.addDirection(e,r),cn.addLineStyle(e,r)}}}var Qa=j(30703),tx=j(19753);const ex=({onVerticalConstraintChange:t,onHorizontalConstraintChange:e,currentConstraints:n})=>{const r=(0,Pt.of)(nx(n)),i=()=>{t($.gR.Top)},a=()=>{t($.gR.Bottom)},o=()=>{t($.gR.Center)},s=()=>{e($.en.Left)},l=()=>{e($.en.Right)},c=()=>{e($.en.Center)};return(0,y.jsx)("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"75.000000pt",height:"75.000000pt",viewBox:"0 0 228.000000 228.000000",preserveAspectRatio:"xMidYMid meet",style:{marginBottom:"4.8px"},children:(0,y.jsxs)("g",{transform:"translate(0.000000,228.000000) scale(0.100000,-0.100000)",fill:"#000000",stroke:"none",children:[(0,y.jsx)("path",{fill:"#e5e5e5",d:`M198 2028 l-28 -32 0 -912 0 -912 31 -31 31 -31 915 0 915 0 29 29
29 29 0 917 0 917 -27 29 -28 29 -920 0 -920 0 -27 -32z m1876 -17 c15 -16 16
-98 16 -927 0 -860 -1 -909 -18 -926 -17 -17 -66 -18 -927 -18 -862 0 -910 1
-927 18 -17 17 -18 65 -18 926 0 832 1 911 16 927 16 18 45 19 468 21 248 2
659 2 912 0 431 -2 462 -4 478 -21z`}),(0,y.jsx)("rect",{className:r.topConstraint,height:"228",width:"46",y:"1735",x:"1123"}),(0,y.jsx)("rect",{className:r.constraintHover,onClick:i,height:"350",width:"300",y:"1680",x:"995",fill:"transparent"}),(0,y.jsx)("rect",{className:r.bottomConstraint,height:"228",width:"46",y:"210",x:"1123"}),(0,y.jsx)("rect",{className:r.constraintHover,onClick:a,height:"350",width:"300",y:"135",x:"995",fill:"transparent"}),(0,y.jsx)("rect",{className:r.leftConstraint,height:"46",width:"228",y:"1060",x:"265"}),(0,y.jsx)("rect",{className:r.constraintHover,onClick:s,height:"300",width:"350",y:"925",x:"200",fill:"transparent"}),(0,y.jsx)("rect",{className:r.rightConstraint,height:"46",width:"228",y:"1060",x:"1795"}),(0,y.jsx)("rect",{className:r.constraintHover,onClick:l,height:"300",width:"350",y:"925",x:"1730",fill:"transparent"}),(0,y.jsx)("path",{className:r.box,d:`M568 1669 c-17 -9 -18 -48 -18 -584 0 -558 1 -575 19 -585 27 -14
1125 -14 1152 0 18 10 19 27 19 580 0 504 -2 570 -16 584 -14 14 -80 16 -577
16 -363 -1 -568 -4 -579 -11z m1119 -42 c4 -5 4 -1079 0 -1084 -5 -4 -1079 -4
-1084 0 -5 6 -4 1077 1 1085 4 7 1076 6 1083 -1z`}),(0,y.jsx)("rect",{className:r.verticalCenterConstraint,height:"456",width:"46",y:"855",x:"1123"}),(0,y.jsx)("rect",{className:r.constraintHover,onClick:o,height:"660",width:"300",y:"750",x:"995",fill:"transparent"}),(0,y.jsx)("rect",{className:r.horizontalCenterConstraint,height:"46",width:"456",y:"1060",x:"918"}),(0,y.jsx)("rect",{className:r.constraintHover,onClick:c,height:"300",width:"660",y:"925",x:"815",fill:"transparent"})]})})},nx=t=>e=>{const n="#daebf7",i="#0d99ff",a=e.isDark?"#ffffff":"#000000";return{constraintHover:(0,Q.css)({"&:hover":{fill:n,fillOpacity:"0.6"}}),topConstraint:(0,Q.css)({...t.vertical===$.gR.Top||t.vertical===$.gR.TopBottom?{width:"92pt",x:"1085",fill:i}:{fill:a}}),bottomConstraint:(0,Q.css)({...t.vertical===$.gR.Bottom||t.vertical===$.gR.TopBottom?{width:"92pt",x:"1085",fill:i}:{fill:a}}),leftConstraint:(0,Q.css)({...t.horizontal===$.en.Left||t.horizontal===$.en.LeftRight?{height:"92pt",y:"1014",fill:i}:{fill:a}}),rightConstraint:(0,Q.css)({...t.horizontal===$.en.Right||t.horizontal===$.en.LeftRight?{height:"92pt",y:"1014",fill:i}:{fill:a}}),horizontalCenterConstraint:(0,Q.css)({...t.horizontal===$.en.Center?{height:"92pt",y:"1014",fill:i}:{fill:a}}),verticalCenterConstraint:(0,Q.css)({...t.vertical===$.gR.Center?{width:"92pt",x:"1085",fill:i}:{fill:a}}),box:(0,Q.css)({fill:a})}},rx=({onPositionChange:t,element:e,settings:n})=>{const r=(0,Pt.of)(ix),i=s=>{const l={vertical:$.gR.Top,horizontal:$.en.Left},c={...e.options.constraint};switch(e.options.constraint=l,e.setPlacementFromConstraint(),s){case Ge.Top:t(0,"top");break;case Ge.Bottom:t(o(e.options.placement?.height??0,"bottom"),"top");break;case Ge.VerticalCenter:t(a(e.options.placement?.height??0,"v"),"top");break;case Ge.Left:t(0,"left");break;case Ge.Right:t(o(e.options.placement?.width??0,"right"),"left");break;case Ge.HorizontalCenter:t(a(e.options.placement?.width??0,"h"),"left");break}e.options.constraint=c,e.setPlacementFromConstraint()},a=(s,l)=>((l==="h"?n.scene.width:n.scene.height)-s)/2,o=(s,l)=>(l==="right"?n.scene.width:n.scene.height)-s;return(0,y.jsxs)("div",{className:r.buttonGroup,children:[(0,y.jsx)(Me.K,{name:"horizontal-align-left",onClick:()=>i(Ge.Left),className:r.button,size:"lg",tooltip:(0,A.t)("canvas.quick-positioning.tooltip-align-left","Align left")}),(0,y.jsx)(Me.K,{name:"horizontal-align-center",onClick:()=>i(Ge.HorizontalCenter),className:r.button,size:"lg",tooltip:(0,A.t)("canvas.quick-positioning.tooltip-align-horizontal-centers","Align horizontal centers")}),(0,y.jsx)(Me.K,{name:"horizontal-align-right",onClick:()=>i(Ge.Right),className:r.button,size:"lg",tooltip:(0,A.t)("canvas.quick-positioning.tooltip-align-right","Align right")}),(0,y.jsx)(Me.K,{name:"vertical-align-top",onClick:()=>i(Ge.Top),size:"lg",tooltip:(0,A.t)("canvas.quick-positioning.tooltip-align-top","Align top")}),(0,y.jsx)(Me.K,{name:"vertical-align-center",onClick:()=>i(Ge.VerticalCenter),className:r.button,size:"lg",tooltip:(0,A.t)("canvas.quick-positioning.tooltip-align-vertical-centers","Align vertical centers")}),(0,y.jsx)(Me.K,{name:"vertical-align-bottom",onClick:()=>i(Ge.Bottom),className:r.button,size:"lg",tooltip:(0,A.t)("canvas.quick-positioning.tooltip-align-bottom","Align bottom")})]})},ix=t=>({buttonGroup:(0,Q.css)({display:"flex",flexWrap:"wrap",padding:"12px 0 12px 0"}),button:(0,Q.css)({marginLeft:"5px",marginRight:"5px"})}),ax=["top","left","bottom","right","width","height","rotation"];function bf({item:t}){const e=t.settings,n=[{label:(0,A.t)("canvas.placement-editor.horizontal-options.label-left","Left"),value:$.en.Left},{label:(0,A.t)("canvas.placement-editor.horizontal-options.label-right","Right"),value:$.en.Right},{label:(0,A.t)("canvas.placement-editor.horizontal-options.label-left-and-right","Left & right"),value:$.en.LeftRight},{label:(0,A.t)("canvas.placement-editor.horizontal-options.label-center","Center"),value:$.en.Center},{label:(0,A.t)("canvas.placement-editor.horizontal-options.label-scale","Scale"),value:$.en.Scale}],r=[{label:(0,A.t)("canvas.placement-editor.vertical-options.label-top","Top"),value:$.gR.Top},{label:(0,A.t)("canvas.placement-editor.vertical-options.label-bottom","Bottom"),value:$.gR.Bottom},{label:(0,A.t)("canvas.placement-editor.vertical-options.label-top-and-bottom","Top & bottom"),value:$.gR.TopBottom},{label:(0,A.t)("canvas.placement-editor.vertical-options.label-center","Center"),value:$.gR.Center},{label:(0,A.t)("canvas.placement-editor.vertical-options.label-scale","Scale"),value:$.gR.Scale}];if((0,Hi.A)(e?.scene?e.scene.moved:new df.B),!e)return(0,y.jsx)("div",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.placement-editor.loading",children:"Loading..."})});const i=e.element;if(!i)return(0,y.jsx)("div",{children:"???"});const{options:a}=i,{placement:o,constraint:s}=a;o&&(o.rotation=o?.rotation??0);const l=()=>{setTimeout(()=>{e.scene.select({targets:[i.div]})})},c=p=>{u(p.value)},u=p=>{i.options.constraint.horizontal=p,i.setPlacementFromConstraint(void 0,void 0,e.scene.scale),e.scene.revId++,e.scene.save(!0),l()},d=p=>{f(p.value)},f=p=>{i.options.constraint.vertical=p,i.setPlacementFromConstraint(void 0,void 0,e.scene.scale),e.scene.revId++,e.scene.save(!0),l()},h=(p,g)=>{i.options.placement[g]=p??i.options.placement[g],i.applyLayoutStylesToDiv(),e.scene.clearCurrentSelection(!0),l()},v=i.tempConstraint??s??{};return(0,y.jsxs)("div",{children:[(0,y.jsx)(rx,{onPositionChange:h,settings:e,element:i}),(0,y.jsx)("br",{}),(0,y.jsx)(wn.D,{label:(0,A.t)("canvas.placement-editor.label-constraints","Constraints"),children:(0,y.jsxs)(Fe.B,{direction:"row",children:[(0,y.jsx)(ex,{onVerticalConstraintChange:f,onHorizontalConstraintChange:u,currentConstraints:v}),(0,y.jsxs)(Fe.B,{direction:"column",children:[(0,y.jsxs)(Fe.B,{direction:"row",children:[(0,y.jsx)(Qa.I,{name:"arrows-h"}),(0,y.jsx)(xe.l6,{options:n,onChange:c,value:v.horizontal})]}),(0,y.jsxs)(Fe.B,{direction:"row",children:[(0,y.jsx)(Qa.I,{name:"arrows-v"}),(0,y.jsx)(xe.l6,{options:r,onChange:d,value:v.vertical})]})]})]})}),(0,y.jsx)("br",{}),(0,y.jsx)(wn.D,{label:(0,A.t)("canvas.placement-editor.label-position","Position"),children:(0,y.jsx)(y.Fragment,{children:ax.map(p=>{const g=o[p];if(g==null)return null;const m=p==="rotation"?0:void 0,x=p==="rotation"?360:void 0;return(0,y.jsx)(Ve.C,{children:(0,y.jsx)(tn.I,{label:p,labelWidth:8,grow:!0,children:(0,y.jsx)(tx.Q,{min:m,max:x,value:g,onChange:b=>h(b,p)})})},p)})})})]})}function Cf(t){return{category:t.category,path:"--",values:e=>({getValue:n=>(0,ne.get)(t.element.options,n),onChange:(n,r)=>{let i=t.element.options;if(n==="type"&&r){const a=ai.getIfExists(r);if(!a){console.warn("layer does not exist",r);return}i={...i,...a.getNewOptions(i),type:a.id}}else i=(0,Za.Sf)(i,n,r);t.element.onChange(i),t.element.updateData(t.scene.context)}}),build:(e,n)=>{const{options:r}=t.element,i=r?.type?r.type:ro.type,a=Ui(t.scene.shouldShowAdvancedTypes,i).options,o=!t.scene.shouldShowAdvancedTypes&&!Ki.filter(h=>h.id===r?.type).length;e.addSelect({path:"type",name:void 0,settings:{options:a},description:o?(0,A.t)("canvas.element-editor.description-unsupported","Selected element type is not supported by current settings. Please enable advanced element types."):""});const s=ai.getIfExists(r?.type??ro.type);let l=r;l||(l={...s.getNewOptions(r),type:s.id,name:`Element ${Date.now()}.${Math.floor(Math.random()*100)}`});const c={...n,options:l};s?.registerOptionsUI&&s.registerOptionsUI(e,c),(t.element.item.standardEditorConfig?.layout??!0)&&e.addCustomEditor({category:[(0,A.t)("canvas.element-editor.category-layout","Layout")],id:"content",path:"__",name:(0,A.t)("canvas.element-editor.name-quick-placement","Quick placement"),editor:bf,settings:t}),(t.element.item.standardEditorConfig?.background??!0)&&cn.addBackground(e,c),(t.element.item.standardEditorConfig?.border??!0)&&cn.addBorder(e,c),cn.addDataLinks(e,c),cn.addActions(e,c)}}}var Sf=j(17437),vr=j(58168),Ef=j(82284),qe=j(89379),al=j(60436),ox=j(23029),sx=j(92901),_t=j(9417),lx=j(85501),cx=j(88293),at=j(64467),ux=j(46942),bn=j.n(ux),Zr=j(16928),wf=j(72065),Pi=j(68210),ol=F.createContext(null),dx=F.createContext({}),fx=function(e){var n=e.dropPosition,r=e.dropLevelOffset,i=e.indent,a={pointerEvents:"none",position:"absolute",right:0,backgroundColor:"red",height:2};switch(n){case-1:a.top=0,a.left=-r*i;break;case 1:a.bottom=0,a.left=-r*i;break;case 0:a.bottom=0,a.left=i;break}return F.createElement("div",{style:a})};const hx=fx;function Df(t){if(t==null)throw new TypeError("Cannot destructure "+t)}var Yn=j(5544),sl=j(80045),qa=j(30981),vx=j(79889),px=j(80979),gx=function(e){for(var n=e.prefixCls,r=e.level,i=e.isStart,a=e.isEnd,o="".concat(n,"-indent-unit"),s=[],l=0;l<r;l+=1)s.push(F.createElement("span",{key:l,className:bn()(o,(0,at.A)((0,at.A)({},"".concat(o,"-start"),i[l]),"".concat(o,"-end"),a[l]))}));return F.createElement("span",{"aria-hidden":"true",className:"".concat(n,"-indent")},s)};const mx=F.memo(gx);var Je=j(84963),zt=j(7974),xx=["eventKey","className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","isStart","isEnd","expanded","selected","checked","halfChecked","loading","domRef","active","data","onMouseMove","selectable"],Mf="open",Tf="close",yx="---",kf=function(e){var n,r,i,a=e.eventKey,o=e.className,s=e.style,l=e.dragOver,c=e.dragOverGapTop,u=e.dragOverGapBottom,d=e.isLeaf,f=e.isStart,h=e.isEnd,v=e.expanded,p=e.selected,g=e.checked,m=e.halfChecked,x=e.loading,b=e.domRef,C=e.active,E=e.data,S=e.onMouseMove,D=e.selectable,M=(0,sl.A)(e,xx),w=F.useContext(ol),T=F.useContext(dx),k=F.useRef(null),O=F.useState(!1),R=(0,Yn.A)(O,2),L=R[0],P=R[1],z=!!(w.disabled||e.disabled||(n=T.nodeDisabled)!==null&&n!==void 0&&n.call(T,E)),V=F.useMemo(function(){return!w.checkable||e.checkable===!1?!1:w.checkable},[w.checkable,e.checkable]),N=function(tt){z||w.onNodeSelect(tt,(0,zt.Hj)(e))},G=function(tt){z||!V||e.disableCheckbox||w.onNodeCheck(tt,(0,zt.Hj)(e),!g)},W=F.useMemo(function(){return typeof D=="boolean"?D:w.selectable},[D,w.selectable]),B=function(tt){w.onNodeClick(tt,(0,zt.Hj)(e)),W?N(tt):G(tt)},q=function(tt){w.onNodeDoubleClick(tt,(0,zt.Hj)(e))},Z=function(tt){w.onNodeMouseEnter(tt,(0,zt.Hj)(e))},K=function(tt){w.onNodeMouseLeave(tt,(0,zt.Hj)(e))},X=function(tt){w.onNodeContextMenu(tt,(0,zt.Hj)(e))},H=F.useMemo(function(){return!!(w.draggable&&(!w.draggable.nodeDraggable||w.draggable.nodeDraggable(E)))},[w.draggable,E]),et=function(tt){tt.stopPropagation(),P(!0),w.onNodeDragStart(tt,e);try{tt.dataTransfer.setData("text/plain","")}catch{}},rt=function(tt){tt.preventDefault(),tt.stopPropagation(),w.onNodeDragEnter(tt,e)},mt=function(tt){tt.preventDefault(),tt.stopPropagation(),w.onNodeDragOver(tt,e)},vt=function(tt){tt.stopPropagation(),w.onNodeDragLeave(tt,e)},U=function(tt){tt.stopPropagation(),P(!1),w.onNodeDragEnd(tt,e)},nt=function(tt){tt.preventDefault(),tt.stopPropagation(),P(!1),w.onNodeDrop(tt,e)},Rt=function(tt){x||w.onNodeExpand(tt,(0,zt.Hj)(e))},ut=F.useMemo(function(){var bt=(0,Je.A)(w.keyEntities,a)||{},tt=bt.children;return!!(tt||[]).length},[w.keyEntities,a]),dt=F.useMemo(function(){return d===!1?!1:d||!w.loadData&&!ut||w.loadData&&e.loaded&&!ut},[d,w.loadData,ut,e.loaded]);F.useEffect(function(){x||typeof w.loadData=="function"&&v&&!dt&&!e.loaded&&w.onNodeLoad((0,zt.Hj)(e))},[x,w.loadData,w.onNodeLoad,v,dt,e]);var yt=F.useMemo(function(){var bt;return(bt=w.draggable)!==null&&bt!==void 0&&bt.icon?F.createElement("span",{className:"".concat(w.prefixCls,"-draggable-icon")},w.draggable.icon):null},[w.draggable]),Ot=function(tt){var Wt=e.switcherIcon||w.switcherIcon;return typeof Wt=="function"?Wt((0,qe.A)((0,qe.A)({},e),{},{isLeaf:tt})):Wt},Tt=function(){if(dt){var tt=Ot(!0);return tt!==!1?F.createElement("span",{className:bn()("".concat(w.prefixCls,"-switcher"),"".concat(w.prefixCls,"-switcher-noop"))},tt):null}var Wt=Ot(!1);return Wt!==!1?F.createElement("span",{onClick:Rt,className:bn()("".concat(w.prefixCls,"-switcher"),"".concat(w.prefixCls,"-switcher_").concat(v?Mf:Tf))},Wt):null},xt=F.useMemo(function(){if(!V)return null;var bt=typeof V!="boolean"?V:null;return F.createElement("span",{className:bn()("".concat(w.prefixCls,"-checkbox"),(0,at.A)((0,at.A)((0,at.A)({},"".concat(w.prefixCls,"-checkbox-checked"),g),"".concat(w.prefixCls,"-checkbox-indeterminate"),!g&&m),"".concat(w.prefixCls,"-checkbox-disabled"),z||e.disableCheckbox)),onClick:G,role:"checkbox","aria-checked":m?"mixed":g,"aria-disabled":z||e.disableCheckbox,"aria-label":"Select ".concat(typeof e.title=="string"?e.title:"tree node")},bt)},[V,g,m,z,e.disableCheckbox,e.title]),Ct=F.useMemo(function(){return dt?null:v?Mf:Tf},[dt,v]),Ht=F.useMemo(function(){return F.createElement("span",{className:bn()("".concat(w.prefixCls,"-iconEle"),"".concat(w.prefixCls,"-icon__").concat(Ct||"docu"),(0,at.A)({},"".concat(w.prefixCls,"-icon_loading"),x))})},[w.prefixCls,Ct,x]),Nt=F.useMemo(function(){var bt=!!w.draggable,tt=!e.disabled&&bt&&w.dragOverNodeKey===a;return tt?w.dropIndicatorRender({dropPosition:w.dropPosition,dropLevelOffset:w.dropLevelOffset,indent:w.indent,prefixCls:w.prefixCls,direction:w.direction}):null},[w.dropPosition,w.dropLevelOffset,w.indent,w.prefixCls,w.direction,w.draggable,w.dragOverNodeKey,w.dropIndicatorRender]),lt=F.useMemo(function(){var bt=e.title,tt=bt===void 0?yx:bt,Wt="".concat(w.prefixCls,"-node-content-wrapper"),Mt;if(w.showIcon){var jt=e.icon||w.icon;Mt=jt?F.createElement("span",{className:bn()("".concat(w.prefixCls,"-iconEle"),"".concat(w.prefixCls,"-icon__customize"))},typeof jt=="function"?jt(e):jt):Ht}else w.loadData&&x&&(Mt=Ht);var Yt;return typeof tt=="function"?Yt=tt(E):w.titleRender?Yt=w.titleRender(E):Yt=tt,F.createElement("span",{ref:k,title:typeof tt=="string"?tt:"",className:bn()(Wt,"".concat(Wt,"-").concat(Ct||"normal"),(0,at.A)({},"".concat(w.prefixCls,"-node-selected"),!z&&(p||L))),onMouseEnter:Z,onMouseLeave:K,onContextMenu:X,onClick:B,onDoubleClick:q},Mt,F.createElement("span",{className:"".concat(w.prefixCls,"-title")},Yt),Nt)},[w.prefixCls,w.showIcon,e,w.icon,Ht,w.titleRender,E,Ct,Z,K,X,B,q]),St=(0,wf.A)(M,{aria:!0,data:!0}),gt=(0,Je.A)(w.keyEntities,a)||{},kt=gt.level,Lt=h[h.length-1],wt=!z&&H,Bt=w.draggingNodeKey===a,Xt=D!==void 0?{"aria-selected":!!D}:void 0;return F.createElement("div",(0,vr.A)({ref:b,role:"treeitem","aria-expanded":d?void 0:v,className:bn()(o,"".concat(w.prefixCls,"-treenode"),(i={},(0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)(i,"".concat(w.prefixCls,"-treenode-disabled"),z),"".concat(w.prefixCls,"-treenode-switcher-").concat(v?"open":"close"),!d),"".concat(w.prefixCls,"-treenode-checkbox-checked"),g),"".concat(w.prefixCls,"-treenode-checkbox-indeterminate"),m),"".concat(w.prefixCls,"-treenode-selected"),p),"".concat(w.prefixCls,"-treenode-loading"),x),"".concat(w.prefixCls,"-treenode-active"),C),"".concat(w.prefixCls,"-treenode-leaf-last"),Lt),"".concat(w.prefixCls,"-treenode-draggable"),H),"dragging",Bt),(0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)((0,at.A)(i,"drop-target",w.dropTargetKey===a),"drop-container",w.dropContainerKey===a),"drag-over",!z&&l),"drag-over-gap-top",!z&&c),"drag-over-gap-bottom",!z&&u),"filter-node",(r=w.filterTreeNode)===null||r===void 0?void 0:r.call(w,(0,zt.Hj)(e))),"".concat(w.prefixCls,"-treenode-leaf"),dt))),style:s,draggable:wt,onDragStart:wt?et:void 0,onDragEnter:H?rt:void 0,onDragOver:H?mt:void 0,onDragLeave:H?vt:void 0,onDrop:H?nt:void 0,onDragEnd:H?U:void 0,onMouseMove:S},Xt,St),F.createElement(mx,{prefixCls:w.prefixCls,level:kt,isStart:f,isEnd:h}),yt,Tt(),xt,lt)};kf.isTreeNode=1;const ll=kf;function bx(t,e){var n=F.useState(!1),r=(0,Yn.A)(n,2),i=r[0],a=r[1];(0,qa.A)(function(){if(i)return t(),function(){e()}},[i]),(0,qa.A)(function(){return a(!0),function(){a(!1)}},[])}const Cx=bx;var Sx=["className","style","motion","motionNodes","motionType","onMotionStart","onMotionEnd","active","treeNodeRequiredProps"],Ex=F.forwardRef(function(t,e){var n=t.className,r=t.style,i=t.motion,a=t.motionNodes,o=t.motionType,s=t.onMotionStart,l=t.onMotionEnd,c=t.active,u=t.treeNodeRequiredProps,d=(0,sl.A)(t,Sx),f=F.useState(!0),h=(0,Yn.A)(f,2),v=h[0],p=h[1],g=F.useContext(ol),m=g.prefixCls,x=a&&o!=="hide";(0,qa.A)(function(){a&&x!==v&&p(x)},[a]);var b=function(){a&&s()},C=F.useRef(!1),E=function(){a&&!C.current&&(C.current=!0,l())};Cx(b,E);var S=function(M){x===M&&E()};return a?F.createElement(px.A,(0,vr.A)({ref:e,visible:v},i,{motionAppear:o==="show",onVisibleChanged:S}),function(D,M){var w=D.className,T=D.style;return F.createElement("div",{ref:M,className:bn()("".concat(m,"-treenode-motion"),w),style:T},a.map(function(k){var O=Object.assign({},(Df(k.data),k.data)),R=k.title,L=k.key,P=k.isStart,z=k.isEnd;delete O.children;var V=(0,zt.N5)(L,u);return F.createElement(ll,(0,vr.A)({},O,V,{title:R,active:c,data:k.data,key:L,isStart:P,isEnd:z}))}))}):F.createElement(ll,(0,vr.A)({domRef:e,className:n,style:r},d,{active:c}))});const wx=Ex;function Dx(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=t.length,r=e.length;if(Math.abs(n-r)!==1)return{add:!1,key:null};function i(a,o){var s=new Map;a.forEach(function(c){s.set(c,!0)});var l=o.filter(function(c){return!s.has(c)});return l.length===1?l[0]:null}return n<r?{add:!0,key:i(t,e)}:{add:!1,key:i(e,t)}}function Af(t,e,n){var r=t.findIndex(function(s){return s.key===n}),i=t[r+1],a=e.findIndex(function(s){return s.key===n});if(i){var o=e.findIndex(function(s){return s.key===i.key});return e.slice(a+1,o)}return e.slice(a+1)}var Mx=["prefixCls","data","selectable","checkable","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","keyEntities","disabled","dragging","dragOverNodeKey","dropPosition","motion","height","itemHeight","virtual","scrollWidth","focusable","activeItem","focused","tabIndex","onKeyDown","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd"],Rf={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Tx=function(){},pr="RC_TREE_MOTION_".concat(Math.random()),cl={key:pr},Of={key:pr,level:0,index:0,pos:"0",node:cl,nodes:[cl]},Lf={parent:null,children:[],pos:Of.pos,data:cl,title:null,key:pr,isStart:[],isEnd:[]};function _f(t,e,n,r){return e===!1||!n?t:t.slice(0,Math.ceil(n/r)+1)}function If(t){var e=t.key,n=t.pos;return(0,zt.i7)(e,n)}function kx(t){for(var e=String(t.data.key),n=t;n.parent;)n=n.parent,e="".concat(n.data.key," > ").concat(e);return e}var Ax=F.forwardRef(function(t,e){var n=t.prefixCls,r=t.data,i=t.selectable,a=t.checkable,o=t.expandedKeys,s=t.selectedKeys,l=t.checkedKeys,c=t.loadedKeys,u=t.loadingKeys,d=t.halfCheckedKeys,f=t.keyEntities,h=t.disabled,v=t.dragging,p=t.dragOverNodeKey,g=t.dropPosition,m=t.motion,x=t.height,b=t.itemHeight,C=t.virtual,E=t.scrollWidth,S=t.focusable,D=t.activeItem,M=t.focused,w=t.tabIndex,T=t.onKeyDown,k=t.onFocus,O=t.onBlur,R=t.onActiveChange,L=t.onListChangeStart,P=t.onListChangeEnd,z=(0,sl.A)(t,Mx),V=F.useRef(null),N=F.useRef(null);F.useImperativeHandle(e,function(){return{scrollTo:function(St){V.current.scrollTo(St)},getIndentWidth:function(){return N.current.offsetWidth}}});var G=F.useState(o),W=(0,Yn.A)(G,2),B=W[0],q=W[1],Z=F.useState(r),K=(0,Yn.A)(Z,2),X=K[0],H=K[1],et=F.useState(r),rt=(0,Yn.A)(et,2),mt=rt[0],vt=rt[1],U=F.useState([]),nt=(0,Yn.A)(U,2),Rt=nt[0],ut=nt[1],dt=F.useState(null),yt=(0,Yn.A)(dt,2),Ot=yt[0],Tt=yt[1],xt=F.useRef(r);xt.current=r;function Ct(){var lt=xt.current;H(lt),vt(lt),ut([]),Tt(null),P()}(0,qa.A)(function(){q(o);var lt=Dx(B,o);if(lt.key!==null)if(lt.add){var St=X.findIndex(function(Xt){var bt=Xt.key;return bt===lt.key}),gt=_f(Af(X,r,lt.key),C,x,b),kt=X.slice();kt.splice(St+1,0,Lf),vt(kt),ut(gt),Tt("show")}else{var Lt=r.findIndex(function(Xt){var bt=Xt.key;return bt===lt.key}),wt=_f(Af(r,X,lt.key),C,x,b),Bt=r.slice();Bt.splice(Lt+1,0,Lf),vt(Bt),ut(wt),Tt("hide")}else X!==r&&(H(r),vt(r))},[o,r]),F.useEffect(function(){v||Ct()},[v]);var Ht=m?mt:r,Nt={expandedKeys:o,selectedKeys:s,loadedKeys:c,loadingKeys:u,checkedKeys:l,halfCheckedKeys:d,dragOverNodeKey:p,dropPosition:g,keyEntities:f};return F.createElement(F.Fragment,null,M&&D&&F.createElement("span",{style:Rf,"aria-live":"assertive"},kx(D)),F.createElement("div",null,F.createElement("input",{style:Rf,disabled:S===!1||h,tabIndex:S!==!1?w:null,onKeyDown:T,onFocus:k,onBlur:O,value:"",onChange:Tx,"aria-label":"for screen reader"})),F.createElement("div",{className:"".concat(n,"-treenode"),"aria-hidden":!0,style:{position:"absolute",pointerEvents:"none",visibility:"hidden",height:0,overflow:"hidden",border:0,padding:0}},F.createElement("div",{className:"".concat(n,"-indent")},F.createElement("div",{ref:N,className:"".concat(n,"-indent-unit")}))),F.createElement(vx.A,(0,vr.A)({},z,{data:Ht,itemKey:If,height:x,fullHeight:!1,virtual:C,itemHeight:b,scrollWidth:E,prefixCls:"".concat(n,"-list"),ref:V,role:"tree",onVisibleChange:function(St){St.every(function(gt){return If(gt)!==pr})&&Ct()}}),function(lt){var St=lt.pos,gt=Object.assign({},(Df(lt.data),lt.data)),kt=lt.title,Lt=lt.key,wt=lt.isStart,Bt=lt.isEnd,Xt=(0,zt.i7)(Lt,St);delete gt.key,delete gt.children;var bt=(0,zt.N5)(Xt,Nt);return F.createElement(wx,(0,vr.A)({},gt,bt,{title:kt,active:!!D&&Lt===D.key,pos:St,data:lt.data,isStart:wt,isEnd:Bt,motion:m,motionNodes:Lt===pr?Rt:null,motionType:Ot,onMotionStart:L,onMotionEnd:Ct,treeNodeRequiredProps:Nt,onMouseMove:function(){R(null)}}))}))});const Rx=Ax;var Ox=null;function On(t,e){if(!t)return[];var n=t.slice(),r=n.indexOf(e);return r>=0&&n.splice(r,1),n}function Kn(t,e){var n=(t||[]).slice();return n.indexOf(e)===-1&&n.push(e),n}function ul(t){return t.split("-")}function Lx(t,e){var n=[],r=(0,Je.A)(e,t);function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];a.forEach(function(o){var s=o.key,l=o.children;n.push(s),i(l)})}return i(r.children),n}function _x(t){if(t.parent){var e=ul(t.pos);return Number(e[e.length-1])===t.parent.children.length-1}return!1}function Ix(t){var e=ul(t.pos);return Number(e[e.length-1])===0}function Pf(t,e,n,r,i,a,o,s,l,c){var u,d=t.clientX,f=t.clientY,h=t.target.getBoundingClientRect(),v=h.top,p=h.height,g=(c==="rtl"?-1:1)*((i?.x||0)-d),m=(g-12)/r,x=l.filter(function(z){var V;return(V=s[z])===null||V===void 0||(V=V.children)===null||V===void 0?void 0:V.length}),b=(0,Je.A)(s,n.eventKey);if(f<v+p/2){var C=o.findIndex(function(z){return z.key===b.key}),E=C<=0?0:C-1,S=o[E].key;b=(0,Je.A)(s,S)}var D=b.key,M=b,w=b.key,T=0,k=0;if(!x.includes(D))for(var O=0;O<m&&_x(b);O+=1)b=b.parent,k+=1;var R=e.data,L=b.node,P=!0;return Ix(b)&&b.level===0&&f<v+p/2&&a({dragNode:R,dropNode:L,dropPosition:-1})&&b.key===n.eventKey?T=-1:(M.children||[]).length&&x.includes(w)?a({dragNode:R,dropNode:L,dropPosition:0})?T=0:P=!1:k===0?m>-1.5?a({dragNode:R,dropNode:L,dropPosition:1})?T=1:P=!1:a({dragNode:R,dropNode:L,dropPosition:0})?T=0:a({dragNode:R,dropNode:L,dropPosition:1})?T=1:P=!1:a({dragNode:R,dropNode:L,dropPosition:1})?T=1:P=!1,{dropPosition:T,dropLevelOffset:k,dropTargetKey:b.key,dropTargetPos:b.pos,dragOverNodeKey:w,dropContainerKey:T===0?null:((u=b.parent)===null||u===void 0?void 0:u.key)||null,dropAllowed:P}}function zf(t,e){if(t){var n=e.multiple;return n?t.slice():t.length?[t[0]]:t}}var Px=function(e){return e};function zx(t,e){if(!t)return[];var n=e||{},r=n.processProps,i=r===void 0?Px:r,a=Array.isArray(t)?t:[t];return a.map(function(o){var s=o.children,l=_objectWithoutProperties(o,Ox),c=zx(s,e);return React.createElement(TreeNode,_extends({key:l.key},i(l)),c)})}function dl(t){if(!t)return null;var e;if(Array.isArray(t))e={checkedKeys:t,halfCheckedKeys:void 0};else if((0,Ef.A)(t)==="object")e={checkedKeys:t.checked||void 0,halfCheckedKeys:t.halfChecked||void 0};else return(0,Pi.Ay)(!1,"`checkedKeys` is not an array or an object"),null;return e}function Nf(t,e){var n=new Set;function r(i){if(!n.has(i)){var a=(0,Je.A)(e,i);if(a){n.add(i);var o=a.parent,s=a.node;s.disabled||o&&r(o.key)}}}return(t||[]).forEach(function(i){r(i)}),(0,al.A)(n)}var fl=j(38820),Nx=10,hl=function(t){(0,lx.A)(n,t);var e=(0,cx.A)(n);function n(){var r;(0,ox.A)(this,n);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r=e.call.apply(e,[this].concat(a)),(0,at.A)((0,_t.A)(r),"destroyed",!1),(0,at.A)((0,_t.A)(r),"delayedDragEnterLogic",void 0),(0,at.A)((0,_t.A)(r),"loadingRetryTimes",{}),(0,at.A)((0,_t.A)(r),"state",{keyEntities:{},indent:null,selectedKeys:[],checkedKeys:[],halfCheckedKeys:[],loadedKeys:[],loadingKeys:[],expandedKeys:[],draggingNodeKey:null,dragChildrenKeys:[],dropTargetKey:null,dropPosition:null,dropContainerKey:null,dropLevelOffset:null,dropTargetPos:null,dropAllowed:!0,dragOverNodeKey:null,treeData:[],flattenNodes:[],focused:!1,activeKey:null,listChanging:!1,prevProps:null,fieldNames:(0,zt.AZ)()}),(0,at.A)((0,_t.A)(r),"dragStartMousePosition",null),(0,at.A)((0,_t.A)(r),"dragNodeProps",null),(0,at.A)((0,_t.A)(r),"currentMouseOverDroppableNodeKey",null),(0,at.A)((0,_t.A)(r),"listRef",F.createRef()),(0,at.A)((0,_t.A)(r),"onNodeDragStart",function(s,l){var c=r.state,u=c.expandedKeys,d=c.keyEntities,f=r.props.onDragStart,h=l.eventKey;r.dragNodeProps=l,r.dragStartMousePosition={x:s.clientX,y:s.clientY};var v=On(u,h);r.setState({draggingNodeKey:h,dragChildrenKeys:Lx(h,d),indent:r.listRef.current.getIndentWidth()}),r.setExpandedKeys(v),window.addEventListener("dragend",r.onWindowDragEnd),f?.({event:s,node:(0,zt.Hj)(l)})}),(0,at.A)((0,_t.A)(r),"onNodeDragEnter",function(s,l){var c=r.state,u=c.expandedKeys,d=c.keyEntities,f=c.dragChildrenKeys,h=c.flattenNodes,v=c.indent,p=r.props,g=p.onDragEnter,m=p.onExpand,x=p.allowDrop,b=p.direction,C=l.pos,E=l.eventKey;if(r.currentMouseOverDroppableNodeKey!==E&&(r.currentMouseOverDroppableNodeKey=E),!r.dragNodeProps){r.resetDragState();return}var S=Pf(s,r.dragNodeProps,l,v,r.dragStartMousePosition,x,h,d,u,b),D=S.dropPosition,M=S.dropLevelOffset,w=S.dropTargetKey,T=S.dropContainerKey,k=S.dropTargetPos,O=S.dropAllowed,R=S.dragOverNodeKey;if(f.includes(w)||!O){r.resetDragState();return}if(r.delayedDragEnterLogic||(r.delayedDragEnterLogic={}),Object.keys(r.delayedDragEnterLogic).forEach(function(L){clearTimeout(r.delayedDragEnterLogic[L])}),r.dragNodeProps.eventKey!==l.eventKey&&(s.persist(),r.delayedDragEnterLogic[C]=window.setTimeout(function(){if(r.state.draggingNodeKey!==null){var L=(0,al.A)(u),P=(0,Je.A)(d,l.eventKey);P&&(P.children||[]).length&&(L=Kn(u,l.eventKey)),r.props.hasOwnProperty("expandedKeys")||r.setExpandedKeys(L),m?.(L,{node:(0,zt.Hj)(l),expanded:!0,nativeEvent:s.nativeEvent})}},800)),r.dragNodeProps.eventKey===w&&M===0){r.resetDragState();return}r.setState({dragOverNodeKey:R,dropPosition:D,dropLevelOffset:M,dropTargetKey:w,dropContainerKey:T,dropTargetPos:k,dropAllowed:O}),g?.({event:s,node:(0,zt.Hj)(l),expandedKeys:u})}),(0,at.A)((0,_t.A)(r),"onNodeDragOver",function(s,l){var c=r.state,u=c.dragChildrenKeys,d=c.flattenNodes,f=c.keyEntities,h=c.expandedKeys,v=c.indent,p=r.props,g=p.onDragOver,m=p.allowDrop,x=p.direction;if(r.dragNodeProps){var b=Pf(s,r.dragNodeProps,l,v,r.dragStartMousePosition,m,d,f,h,x),C=b.dropPosition,E=b.dropLevelOffset,S=b.dropTargetKey,D=b.dropContainerKey,M=b.dropTargetPos,w=b.dropAllowed,T=b.dragOverNodeKey;u.includes(S)||!w||(r.dragNodeProps.eventKey===S&&E===0?r.state.dropPosition===null&&r.state.dropLevelOffset===null&&r.state.dropTargetKey===null&&r.state.dropContainerKey===null&&r.state.dropTargetPos===null&&r.state.dropAllowed===!1&&r.state.dragOverNodeKey===null||r.resetDragState():C===r.state.dropPosition&&E===r.state.dropLevelOffset&&S===r.state.dropTargetKey&&D===r.state.dropContainerKey&&M===r.state.dropTargetPos&&w===r.state.dropAllowed&&T===r.state.dragOverNodeKey||r.setState({dropPosition:C,dropLevelOffset:E,dropTargetKey:S,dropContainerKey:D,dropTargetPos:M,dropAllowed:w,dragOverNodeKey:T}),g?.({event:s,node:(0,zt.Hj)(l)}))}}),(0,at.A)((0,_t.A)(r),"onNodeDragLeave",function(s,l){r.currentMouseOverDroppableNodeKey===l.eventKey&&!s.currentTarget.contains(s.relatedTarget)&&(r.resetDragState(),r.currentMouseOverDroppableNodeKey=null);var c=r.props.onDragLeave;c?.({event:s,node:(0,zt.Hj)(l)})}),(0,at.A)((0,_t.A)(r),"onWindowDragEnd",function(s){r.onNodeDragEnd(s,null,!0),window.removeEventListener("dragend",r.onWindowDragEnd)}),(0,at.A)((0,_t.A)(r),"onNodeDragEnd",function(s,l){var c=r.props.onDragEnd;r.setState({dragOverNodeKey:null}),r.cleanDragState(),c?.({event:s,node:(0,zt.Hj)(l)}),r.dragNodeProps=null,window.removeEventListener("dragend",r.onWindowDragEnd)}),(0,at.A)((0,_t.A)(r),"onNodeDrop",function(s,l){var c,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=r.state,f=d.dragChildrenKeys,h=d.dropPosition,v=d.dropTargetKey,p=d.dropTargetPos,g=d.dropAllowed;if(g){var m=r.props.onDrop;if(r.setState({dragOverNodeKey:null}),r.cleanDragState(),v!==null){var x=(0,qe.A)((0,qe.A)({},(0,zt.N5)(v,r.getTreeNodeRequiredProps())),{},{active:((c=r.getActiveItem())===null||c===void 0?void 0:c.key)===v,data:(0,Je.A)(r.state.keyEntities,v).node}),b=f.includes(v);(0,Pi.Ay)(!b,"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.");var C=ul(p),E={event:s,node:(0,zt.Hj)(x),dragNode:r.dragNodeProps?(0,zt.Hj)(r.dragNodeProps):null,dragNodesKeys:[r.dragNodeProps.eventKey].concat(f),dropToGap:h!==0,dropPosition:h+Number(C[C.length-1])};u||m?.(E),r.dragNodeProps=null}}}),(0,at.A)((0,_t.A)(r),"cleanDragState",function(){var s=r.state.draggingNodeKey;s!==null&&r.setState({draggingNodeKey:null,dropPosition:null,dropContainerKey:null,dropTargetKey:null,dropLevelOffset:null,dropAllowed:!0,dragOverNodeKey:null}),r.dragStartMousePosition=null,r.currentMouseOverDroppableNodeKey=null}),(0,at.A)((0,_t.A)(r),"triggerExpandActionExpand",function(s,l){var c=r.state,u=c.expandedKeys,d=c.flattenNodes,f=l.expanded,h=l.key,v=l.isLeaf;if(!(v||s.shiftKey||s.metaKey||s.ctrlKey)){var p=d.filter(function(m){return m.key===h})[0],g=(0,zt.Hj)((0,qe.A)((0,qe.A)({},(0,zt.N5)(h,r.getTreeNodeRequiredProps())),{},{data:p.data}));r.setExpandedKeys(f?On(u,h):Kn(u,h)),r.onNodeExpand(s,g)}}),(0,at.A)((0,_t.A)(r),"onNodeClick",function(s,l){var c=r.props,u=c.onClick,d=c.expandAction;d==="click"&&r.triggerExpandActionExpand(s,l),u?.(s,l)}),(0,at.A)((0,_t.A)(r),"onNodeDoubleClick",function(s,l){var c=r.props,u=c.onDoubleClick,d=c.expandAction;d==="doubleClick"&&r.triggerExpandActionExpand(s,l),u?.(s,l)}),(0,at.A)((0,_t.A)(r),"onNodeSelect",function(s,l){var c=r.state.selectedKeys,u=r.state,d=u.keyEntities,f=u.fieldNames,h=r.props,v=h.onSelect,p=h.multiple,g=l.selected,m=l[f.key],x=!g;x?p?c=Kn(c,m):c=[m]:c=On(c,m);var b=c.map(function(C){var E=(0,Je.A)(d,C);return E?E.node:null}).filter(Boolean);r.setUncontrolledState({selectedKeys:c}),v?.(c,{event:"select",selected:x,node:l,selectedNodes:b,nativeEvent:s.nativeEvent})}),(0,at.A)((0,_t.A)(r),"onNodeCheck",function(s,l,c){var u=r.state,d=u.keyEntities,f=u.checkedKeys,h=u.halfCheckedKeys,v=r.props,p=v.checkStrictly,g=v.onCheck,m=l.key,x,b={event:"check",node:l,checked:c,nativeEvent:s.nativeEvent};if(p){var C=c?Kn(f,m):On(f,m),E=On(h,m);x={checked:C,halfChecked:E},b.checkedNodes=C.map(function(k){return(0,Je.A)(d,k)}).filter(Boolean).map(function(k){return k.node}),r.setUncontrolledState({checkedKeys:C})}else{var S=(0,fl.p)([].concat((0,al.A)(f),[m]),!0,d),D=S.checkedKeys,M=S.halfCheckedKeys;if(!c){var w=new Set(D);w.delete(m);var T=(0,fl.p)(Array.from(w),{checked:!1,halfCheckedKeys:M},d);D=T.checkedKeys,M=T.halfCheckedKeys}x=D,b.checkedNodes=[],b.checkedNodesPositions=[],b.halfCheckedKeys=M,D.forEach(function(k){var O=(0,Je.A)(d,k);if(O){var R=O.node,L=O.pos;b.checkedNodes.push(R),b.checkedNodesPositions.push({node:R,pos:L})}}),r.setUncontrolledState({checkedKeys:D},!1,{halfCheckedKeys:M})}g?.(x,b)}),(0,at.A)((0,_t.A)(r),"onNodeLoad",function(s){var l,c=s.key,u=r.state.keyEntities,d=(0,Je.A)(u,c);if(!(d!=null&&(l=d.children)!==null&&l!==void 0&&l.length)){var f=new Promise(function(h,v){r.setState(function(p){var g=p.loadedKeys,m=g===void 0?[]:g,x=p.loadingKeys,b=x===void 0?[]:x,C=r.props,E=C.loadData,S=C.onLoad;if(!E||m.includes(c)||b.includes(c))return null;var D=E(s);return D.then(function(){var M=r.state.loadedKeys,w=Kn(M,c);S?.(w,{event:"load",node:s}),r.setUncontrolledState({loadedKeys:w}),r.setState(function(T){return{loadingKeys:On(T.loadingKeys,c)}}),h()}).catch(function(M){if(r.setState(function(T){return{loadingKeys:On(T.loadingKeys,c)}}),r.loadingRetryTimes[c]=(r.loadingRetryTimes[c]||0)+1,r.loadingRetryTimes[c]>=Nx){var w=r.state.loadedKeys;(0,Pi.Ay)(!1,"Retry for `loadData` many times but still failed. No more retry."),r.setUncontrolledState({loadedKeys:Kn(w,c)}),h()}v(M)}),{loadingKeys:Kn(b,c)}})});return f.catch(function(){}),f}}),(0,at.A)((0,_t.A)(r),"onNodeMouseEnter",function(s,l){var c=r.props.onMouseEnter;c?.({event:s,node:l})}),(0,at.A)((0,_t.A)(r),"onNodeMouseLeave",function(s,l){var c=r.props.onMouseLeave;c?.({event:s,node:l})}),(0,at.A)((0,_t.A)(r),"onNodeContextMenu",function(s,l){var c=r.props.onRightClick;c&&(s.preventDefault(),c({event:s,node:l}))}),(0,at.A)((0,_t.A)(r),"onFocus",function(){var s=r.props.onFocus;r.setState({focused:!0});for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];s?.apply(void 0,c)}),(0,at.A)((0,_t.A)(r),"onBlur",function(){var s=r.props.onBlur;r.setState({focused:!1}),r.onActiveChange(null);for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];s?.apply(void 0,c)}),(0,at.A)((0,_t.A)(r),"getTreeNodeRequiredProps",function(){var s=r.state,l=s.expandedKeys,c=s.selectedKeys,u=s.loadedKeys,d=s.loadingKeys,f=s.checkedKeys,h=s.halfCheckedKeys,v=s.dragOverNodeKey,p=s.dropPosition,g=s.keyEntities;return{expandedKeys:l||[],selectedKeys:c||[],loadedKeys:u||[],loadingKeys:d||[],checkedKeys:f||[],halfCheckedKeys:h||[],dragOverNodeKey:v,dropPosition:p,keyEntities:g}}),(0,at.A)((0,_t.A)(r),"setExpandedKeys",function(s){var l=r.state,c=l.treeData,u=l.fieldNames,d=(0,zt.$9)(c,s,u);r.setUncontrolledState({expandedKeys:s,flattenNodes:d},!0)}),(0,at.A)((0,_t.A)(r),"onNodeExpand",function(s,l){var c=r.state.expandedKeys,u=r.state,d=u.listChanging,f=u.fieldNames,h=r.props,v=h.onExpand,p=h.loadData,g=l.expanded,m=l[f.key];if(!d){var x=c.includes(m),b=!g;if((0,Pi.Ay)(g&&x||!g&&!x,"Expand state not sync with index check"),c=b?Kn(c,m):On(c,m),r.setExpandedKeys(c),v?.(c,{node:l,expanded:b,nativeEvent:s.nativeEvent}),b&&p){var C=r.onNodeLoad(l);C&&C.then(function(){var E=(0,zt.$9)(r.state.treeData,c,f);r.setUncontrolledState({flattenNodes:E})}).catch(function(){var E=r.state.expandedKeys,S=On(E,m);r.setExpandedKeys(S)})}}}),(0,at.A)((0,_t.A)(r),"onListChangeStart",function(){r.setUncontrolledState({listChanging:!0})}),(0,at.A)((0,_t.A)(r),"onListChangeEnd",function(){setTimeout(function(){r.setUncontrolledState({listChanging:!1})})}),(0,at.A)((0,_t.A)(r),"onActiveChange",function(s){var l=r.state.activeKey,c=r.props,u=c.onActiveChange,d=c.itemScrollOffset,f=d===void 0?0:d;l!==s&&(r.setState({activeKey:s}),s!==null&&r.scrollTo({key:s,offset:f}),u?.(s))}),(0,at.A)((0,_t.A)(r),"getActiveItem",function(){var s=r.state,l=s.activeKey,c=s.flattenNodes;return l===null?null:c.find(function(u){var d=u.key;return d===l})||null}),(0,at.A)((0,_t.A)(r),"offsetActiveKey",function(s){var l=r.state,c=l.flattenNodes,u=l.activeKey,d=c.findIndex(function(v){var p=v.key;return p===u});d===-1&&s<0&&(d=c.length),d=(d+s+c.length)%c.length;var f=c[d];if(f){var h=f.key;r.onActiveChange(h)}else r.onActiveChange(null)}),(0,at.A)((0,_t.A)(r),"onKeyDown",function(s){var l=r.state,c=l.activeKey,u=l.expandedKeys,d=l.checkedKeys,f=l.fieldNames,h=r.props,v=h.onKeyDown,p=h.checkable,g=h.selectable;switch(s.which){case Zr.A.UP:{r.offsetActiveKey(-1),s.preventDefault();break}case Zr.A.DOWN:{r.offsetActiveKey(1),s.preventDefault();break}}var m=r.getActiveItem();if(m&&m.data){var x=r.getTreeNodeRequiredProps(),b=m.data.isLeaf===!1||!!(m.data[f.children]||[]).length,C=(0,zt.Hj)((0,qe.A)((0,qe.A)({},(0,zt.N5)(c,x)),{},{data:m.data,active:!0}));switch(s.which){case Zr.A.LEFT:{b&&u.includes(c)?r.onNodeExpand({},C):m.parent&&r.onActiveChange(m.parent.key),s.preventDefault();break}case Zr.A.RIGHT:{b&&!u.includes(c)?r.onNodeExpand({},C):m.children&&m.children.length&&r.onActiveChange(m.children[0].key),s.preventDefault();break}case Zr.A.ENTER:case Zr.A.SPACE:{p&&!C.disabled&&C.checkable!==!1&&!C.disableCheckbox?r.onNodeCheck({},C,!d.includes(c)):!p&&g&&!C.disabled&&C.selectable!==!1&&r.onNodeSelect({},C);break}}}v?.(s)}),(0,at.A)((0,_t.A)(r),"setUncontrolledState",function(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!r.destroyed){var u=!1,d=!0,f={};Object.keys(s).forEach(function(h){if(r.props.hasOwnProperty(h)){d=!1;return}u=!0,f[h]=s[h]}),u&&(!l||d)&&r.setState((0,qe.A)((0,qe.A)({},f),c))}}),(0,at.A)((0,_t.A)(r),"scrollTo",function(s){r.listRef.current.scrollTo(s)}),r}return(0,sx.A)(n,[{key:"componentDidMount",value:function(){this.destroyed=!1,this.onUpdated()}},{key:"componentDidUpdate",value:function(){this.onUpdated()}},{key:"onUpdated",value:function(){var i=this.props,a=i.activeKey,o=i.itemScrollOffset,s=o===void 0?0:o;a!==void 0&&a!==this.state.activeKey&&(this.setState({activeKey:a}),a!==null&&this.scrollTo({key:a,offset:s}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("dragend",this.onWindowDragEnd),this.destroyed=!0}},{key:"resetDragState",value:function(){this.setState({dragOverNodeKey:null,dropPosition:null,dropLevelOffset:null,dropTargetKey:null,dropContainerKey:null,dropTargetPos:null,dropAllowed:!1})}},{key:"render",value:function(){var i=this.state,a=i.focused,o=i.flattenNodes,s=i.keyEntities,l=i.draggingNodeKey,c=i.activeKey,u=i.dropLevelOffset,d=i.dropContainerKey,f=i.dropTargetKey,h=i.dropPosition,v=i.dragOverNodeKey,p=i.indent,g=this.props,m=g.prefixCls,x=g.className,b=g.style,C=g.showLine,E=g.focusable,S=g.tabIndex,D=S===void 0?0:S,M=g.selectable,w=g.showIcon,T=g.icon,k=g.switcherIcon,O=g.draggable,R=g.checkable,L=g.checkStrictly,P=g.disabled,z=g.motion,V=g.loadData,N=g.filterTreeNode,G=g.height,W=g.itemHeight,B=g.scrollWidth,q=g.virtual,Z=g.titleRender,K=g.dropIndicatorRender,X=g.onContextMenu,H=g.onScroll,et=g.direction,rt=g.rootClassName,mt=g.rootStyle,vt=(0,wf.A)(this.props,{aria:!0,data:!0}),U;O&&((0,Ef.A)(O)==="object"?U=O:typeof O=="function"?U={nodeDraggable:O}:U={});var nt={prefixCls:m,selectable:M,showIcon:w,icon:T,switcherIcon:k,draggable:U,draggingNodeKey:l,checkable:R,checkStrictly:L,disabled:P,keyEntities:s,dropLevelOffset:u,dropContainerKey:d,dropTargetKey:f,dropPosition:h,dragOverNodeKey:v,indent:p,direction:et,dropIndicatorRender:K,loadData:V,filterTreeNode:N,titleRender:Z,onNodeClick:this.onNodeClick,onNodeDoubleClick:this.onNodeDoubleClick,onNodeExpand:this.onNodeExpand,onNodeSelect:this.onNodeSelect,onNodeCheck:this.onNodeCheck,onNodeLoad:this.onNodeLoad,onNodeMouseEnter:this.onNodeMouseEnter,onNodeMouseLeave:this.onNodeMouseLeave,onNodeContextMenu:this.onNodeContextMenu,onNodeDragStart:this.onNodeDragStart,onNodeDragEnter:this.onNodeDragEnter,onNodeDragOver:this.onNodeDragOver,onNodeDragLeave:this.onNodeDragLeave,onNodeDragEnd:this.onNodeDragEnd,onNodeDrop:this.onNodeDrop};return F.createElement(ol.Provider,{value:nt},F.createElement("div",{className:bn()(m,x,rt,(0,at.A)((0,at.A)((0,at.A)({},"".concat(m,"-show-line"),C),"".concat(m,"-focused"),a),"".concat(m,"-active-focused"),c!==null)),style:mt},F.createElement(Rx,(0,vr.A)({ref:this.listRef,prefixCls:m,style:b,data:o,disabled:P,selectable:M,checkable:!!R,motion:z,dragging:l!==null,height:G,itemHeight:W,virtual:q,focusable:E,focused:a,tabIndex:D,activeItem:this.getActiveItem(),onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onActiveChange:this.onActiveChange,onListChangeStart:this.onListChangeStart,onListChangeEnd:this.onListChangeEnd,onContextMenu:X,onScroll:H,scrollWidth:B},this.getTreeNodeRequiredProps(),vt))))}}],[{key:"getDerivedStateFromProps",value:function(i,a){var o=a.prevProps,s={prevProps:i};function l(D){return!o&&i.hasOwnProperty(D)||o&&o[D]!==i[D]}var c,u=a.fieldNames;if(l("fieldNames")&&(u=(0,zt.AZ)(i.fieldNames),s.fieldNames=u),l("treeData")?c=i.treeData:l("children")&&((0,Pi.Ay)(!1,"`children` of Tree is deprecated. Please use `treeData` instead."),c=(0,zt.vH)(i.children)),c){s.treeData=c;var d=(0,zt.cG)(c,{fieldNames:u});s.keyEntities=(0,qe.A)((0,at.A)({},pr,Of),d.keyEntities)}var f=s.keyEntities||a.keyEntities;if(l("expandedKeys")||o&&l("autoExpandParent"))s.expandedKeys=i.autoExpandParent||!o&&i.defaultExpandParent?Nf(i.expandedKeys,f):i.expandedKeys;else if(!o&&i.defaultExpandAll){var h=(0,qe.A)({},f);delete h[pr];var v=[];Object.keys(h).forEach(function(D){var M=h[D];M.children&&M.children.length&&v.push(M.key)}),s.expandedKeys=v}else!o&&i.defaultExpandedKeys&&(s.expandedKeys=i.autoExpandParent||i.defaultExpandParent?Nf(i.defaultExpandedKeys,f):i.defaultExpandedKeys);if(s.expandedKeys||delete s.expandedKeys,c||s.expandedKeys){var p=(0,zt.$9)(c||a.treeData,s.expandedKeys||a.expandedKeys,u);s.flattenNodes=p}if(i.selectable&&(l("selectedKeys")?s.selectedKeys=zf(i.selectedKeys,i):!o&&i.defaultSelectedKeys&&(s.selectedKeys=zf(i.defaultSelectedKeys,i))),i.checkable){var g;if(l("checkedKeys")?g=dl(i.checkedKeys)||{}:!o&&i.defaultCheckedKeys?g=dl(i.defaultCheckedKeys)||{}:c&&(g=dl(i.checkedKeys)||{checkedKeys:a.checkedKeys,halfCheckedKeys:a.halfCheckedKeys}),g){var m=g,x=m.checkedKeys,b=x===void 0?[]:x,C=m.halfCheckedKeys,E=C===void 0?[]:C;if(!i.checkStrictly){var S=(0,fl.p)(b,!0,f);b=S.checkedKeys,E=S.halfCheckedKeys}s.checkedKeys=b,s.halfCheckedKeys=E}}return l("loadedKeys")&&(s.loadedKeys=i.loadedKeys),s}}]),n}(F.Component);(0,at.A)(hl,"defaultProps",{prefixCls:"rc-tree",showLine:!1,showIcon:!0,selectable:!0,multiple:!1,checkable:!1,disabled:!1,checkStrictly:!1,draggable:!1,defaultExpandParent:!0,autoExpandParent:!1,defaultExpandAll:!1,defaultExpandedKeys:[],defaultCheckedKeys:[],defaultSelectedKeys:[],dropIndicatorRender:hx,allowDrop:function(){return!0},expandAction:!1}),(0,at.A)(hl,"TreeNode",ll);const Bx=hl;function jx(t){return(0,Sf.css)({".moveable-control-box":{zIndex:999},".rc-tree":{margin:0,marginBottom:"15px",border:"1px solid transparent","&-focused:not(&-active-focused)":{borderColor:"cyan"},".rc-tree-title":{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},".rc-tree-treenode":{margin:0,padding:"1px",lineHeight:"24px",whiteSpace:"nowrap",listStyle:"none",outline:0,display:"flex",marginBottom:"3px",cursor:"pointer",".draggable":{color:"#333",MozUserSelect:"none",KhtmlUserSelect:"none",WebkitUserSelect:"none",userSelect:"none"},"&.drop-container":{"> .draggable::after":{position:"absolute",top:0,right:0,bottom:0,left:0,boxShadow:"inset 0 0 0 2px blue",content:'""'},"& ~ .rc-tree-treenode":{borderLeft:`2px solid ${t.components.input.borderColor}`}},"&.drop-target":{"& ~ .rc-tree-treenode":{borderLeft:"none"}},"&.filter-node":{"> .rc-tree-node-content-wrapper":{color:"#a60000 !important",fontWeight:"bold !important"}},ul:{margin:0,padding:"0 0 0 18px"},".rc-tree-node-content-wrapper":{position:"relative",display:"inline-block",height:"24px",margin:0,padding:0,textDecoration:"none",verticalAlign:"top",cursor:"grab",flexGrow:1,border:`1px solid ${t.components.input.borderColor}`,borderRadius:`${t.shape.radius.default}`,background:`${t.colors.background.secondary}`,minHeight:`${t.spacing.gridSize*4}px`,"&:hover":{border:`1px solid ${t.components.input.borderHover}`},"&.rc-tree-node-selected":{border:`1px solid ${t.colors.primary.border}`,opacity:1}},span:{height:"100%","&.rc-tree-checkbox, &.rc-tree-iconEle":{display:"inline-block",width:"16px",height:"16px",marginRight:"2px",lineHeight:"16px",verticalAlign:"-0.125em",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundAttachment:"scroll",border:"0 none",outline:"none",cursor:"pointer","&.rc-tree-icon__customize":{backgroundImage:"none"}},"&.rc-tree-switcher":{display:"flex",alignItems:"center",width:"16px",height:"auto",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundAttachment:"scroll",border:"0 none",outline:"none",cursor:"pointer","&.rc-tree-icon__customize":{backgroundImage:"none"},"&.rc-tree-switcher-noop":{cursor:"auto"},"&.rc-tree-switcher_open":{backgroundPosition:"-93px -56px"},"&.rc-tree-switcher_close":{backgroundPosition:"-75px -56px"}},"&.rc-tree-icon_loading":{marginRight:"2px",verticalAlign:"top",background:"url('data:image/gif;base64,R0lGODlhEAAQAKIGAMLY8YSx5HOm4Mjc88/g9Ofw+v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAGACwAAAAAEAAQAAADMGi6RbUwGjKIXCAA016PgRBElAVlG/RdLOO0X9nK61W39qvqiwz5Ls/rRqrggsdkAgAh+QQFCgAGACwCAAAABwAFAAADD2hqELAmiFBIYY4MAutdCQAh+QQFCgAGACwGAAAABwAFAAADD1hU1kaDOKMYCGAGEeYFCQAh+QQFCgAGACwKAAIABQAHAAADEFhUZjSkKdZqBQG0IELDQAIAIfkEBQoABgAsCgAGAAUABwAAAxBoVlRKgyjmlAIBqCDCzUoCACH5BAUKAAYALAYACgAHAAUAAAMPaGpFtYYMAgJgLogA610JACH5BAUKAAYALAIACgAHAAUAAAMPCAHWFiI4o1ghZZJB5i0JACH5BAUKAAYALAAABgAFAAcAAAMQCAFmIaEp1motpDQySMNFAgA7') no-repeat scroll 0 0 transparent"},"&.rc-tree-checkbox":{width:"13px",height:"13px",margin:"0 3px",backgroundPosition:"0 0","&-checked":{backgroundPosition:"-14px 0"},"&-indeterminate":{backgroundPosition:"-14px -28px"},"&-disabled":{backgroundPosition:"0 -56px"},"&.rc-tree-checkbox-checked.rc-tree-checkbox-disabled":{backgroundPosition:"-14px -56px"},"&.rc-tree-checkbox-indeterminate.rc-tree-checkbox-disabled":{position:"relative",background:"#ccc",borderRadius:t.shape.radius.default,"&::after":{position:"absolute",top:"5px",left:"3px",width:"5px",height:0,border:"2px solid #fff",borderTop:0,borderLeft:0,WebkitTransform:"scale(1)",transform:"scale(1)",content:'" "'}}}}},"&:not(.rc-tree-show-line)":{".rc-tree-treenode":{".rc-tree-switcher-noop":{background:"none"}}},"&.rc-tree-show-line":{".rc-tree-treenode:not(:last-child)":{"> ul":{background:"url('data:image/gif;base64,R0lGODlhCQACAIAAAMzMzP///yH5BAEAAAEALAAAAAAJAAIAAAIEjI9pUAA7') 0 0 repeat-y"},"> .rc-tree-switcher-noop":{backgroundPosition:"-56px -18px"}},".rc-tree-treenode:last-child":{"> .rc-tree-switcher-noop":{backgroundPosition:"-56px -36px"}}},"&-child-tree":{display:"none","&-open":{display:"block"}},"&-treenode-disabled":{"> span:not(.rc-tree-switcher), > a, > a span":{color:"#767676",cursor:"not-allowed"}},"&-treenode-active":{background:"rgba(0, 0, 0, 0.1)"},"&-node-selected":{opacity:.8},"&-icon__open":{marginRight:"2px",verticalAlign:"top",backgroundPosition:"-110px -16px"},"&-icon__close":{marginRight:"2px",verticalAlign:"top",backgroundPosition:"-110px 0"},"&-icon__docu":{marginRight:"2px",verticalAlign:"top",backgroundPosition:"-110px -32px"},"&-icon__customize":{marginRight:"2px",verticalAlign:"top"},"&-title":{display:"inline-block"},"&-indent":{display:"inline-block",height:0,verticalAlign:"bottom"},"&-indent-unit":{display:"inline-block",width:"16px"},"&-draggable-icon":{display:"inline-flex",justifyContent:"center",width:"16px"}}})}var Vx=j(34316);const Fx=({settings:t,nodeData:e,setAllowSelection:n})=>{const r=e.dataRef,i=e.dataRef.getName(),a=(0,Pt.of)(Gx),o=t.layer,s=()=>{if(t?.layer)return t.layer.scene},l=h=>{(h.parent??o).doAction(Kt.Delete,h),n(!1)},c=h=>{(h.parent??o).doAction(Kt.Duplicate,h),n(!1)},u=(h,v)=>{h.onChange({...h.options,name:v})},d=h=>!!s()?.canRename(h),f=h=>h.options.type;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Vx.R,{name:i,onChange:h=>u(r,h),verifyLayerNameUniqueness:d??void 0}),(0,y.jsxs)("div",{className:a.textWrapper,children:["\xA0 ",f(r)]}),!e.children&&(0,y.jsxs)("div",{className:a.actionButtonsWrapper,children:[(0,y.jsx)(Me.K,{name:"copy",title:(0,A.t)("canvas.tree-node-title.title-duplicate","Duplicate"),className:a.actionIcon,onClick:()=>c(r),tooltip:(0,A.t)("canvas.tree-node-title.tooltip-duplicate","Duplicate")}),(0,y.jsx)(Me.K,{name:"trash-alt",title:(0,A.t)("canvas.tree-node-title.title-remove","Remove"),className:a.actionIcon,onClick:()=>l(r),tooltip:(0,A.t)("canvas.tree-node-title.tooltip-remove","Remove")})]})]})},Gx=t=>({actionButtonsWrapper:(0,Q.css)({display:"flex",alignItems:"flex-end"}),actionIcon:(0,Q.css)({color:t.colors.text.secondary,cursor:"pointer","&:hover":{color:t.colors.text.primary}}),textWrapper:(0,Q.css)({display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginRight:t.spacing(1)}),layerName:(0,Q.css)({fontWeight:t.typography.fontWeightMedium,color:t.colors.primary.text,cursor:"pointer",overflow:"hidden",marginLeft:t.spacing(.5)})});function vl(t,e,n){let r=[];if(t)for(let i=t.elements.length;i--;i>=0){const a=t.elements[i],o={key:a.UID,title:a.getName(),selectable:!0,dataRef:a};a instanceof Be&&(o.children=vl(a,e,n)),r.push(o)}return r}function $x(t,e){const n=t.node.key,r=t.dragNode.key,i=t.node.pos.split("-"),a=t.dropPosition-Number(i[i.length-1]),o=(c,u,d)=>{c.forEach((f,h,v)=>{if(f.key===u){d(f,h,v);return}f.children&&o(f.children,u,d)})},s=[...e];let l;if(o(s,r,(c,u,d)=>{d.splice(u,1),l=c}),a===0)o(s,n,c=>{c.children=c.children||[],c.children.unshift(l)});else{let c=[],u=0;o(s,n,(d,f,h)=>{c=h,u=f}),a===-1?c.splice(u,0,l):c.splice(u+1,0,l)}return s}let Bf=!0;const Wx=({item:t})=>{const[e,n]=(0,F.useState)(vl(t?.settings?.scene.root)),[r,i]=(0,F.useState)(!0),[a,o]=(0,F.useState)([]),[s,l]=(0,F.useState)([]),c=(0,Pt.$j)(),u=jx(c),d=(0,Pt.of)(Hx),f=c.colors.primary.border,{settings:h}=t,v=(0,F.useMemo)(()=>h?.selected?h.selected.map(k=>k?.getName()):[],[h?.selected]),p=(0,F.useMemo)(()=>h?.selected?h.selected.map(k=>k?.UID):[],[h?.selected]);if((0,F.useEffect)(()=>{n(vl(t?.settings?.scene.root,v,f)),l(p),S()},[t?.settings?.scene.root,f,v,p]),!h)return(0,y.jsx)("div",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.tree-navigation-editor.no-settings",children:"No settings"})});const g=h.layer;if(!g)return(0,y.jsx)("div",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.tree-navigation-editor.missing-layer",children:"Missing layer?"})});const m=(k,O)=>{Bf&&t.settings?.scene&&Tl(t.settings.scene,O.node.dataRef)},x=()=>!0,b=k=>{const O=k.node.pos.split("-"),R=k.dropPosition-Number(O[O.length-1]),L=k.dragNode.dataRef,P=k.node.dataRef,z=$x(k,e);n(z),Bm(L,P,k.dropToGap,R)},C=k=>{o(k),i(!1)},E=k=>k.isLeaf?(0,y.jsx)(y.Fragment,{}):(0,y.jsx)(Qa.I,{name:"angle-right",title:(0,A.t)("canvas.tree-navigation-editor.switcher-icon.title-node-icon","Node Icon"),style:{transform:`rotate(${k.expanded?90:0}deg)`,fill:c.colors.text.primary}}),S=(k=!0)=>{Bf=k},D=()=>{g.scene.clearCurrentSelection()},M=k=>(0,y.jsx)(Fx,{nodeData:k,setAllowSelection:S,settings:h}),w=()=>{g.scene?jm(g.scene):console.warn("no scene!")},T=Ui(h.scene.shouldShowAdvancedTypes).options;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Sf.Global,{styles:u}),(0,y.jsx)(Bx,{selectable:!0,onSelect:m,draggable:!0,defaultExpandAll:!0,autoExpandParent:r,showIcon:!1,allowDrop:x,onDrop:b,expandedKeys:a,onExpand:C,treeData:e,titleRender:M,switcherIcon:E,selectedKeys:s,multiple:!0}),(0,y.jsxs)(Fe.B,{justifyContent:"space-between",direction:"row",children:[(0,y.jsx)("div",{className:d.addLayerButton,children:(0,y.jsx)(gf.r,{onChange:k=>oo(k,g),options:T,label:(0,A.t)("canvas.tree-navigation-editor.label-add-item","Add item")})}),v.length>0&&(0,y.jsx)(dn.$n,{size:"sm",variant:"secondary",onClick:D,children:(0,y.jsx)(A.x6,{i18nKey:"canvas.tree-navigation-editor.clear-selection",children:"Clear selection"})}),v.length>1&&De.$.featureToggles.canvasPanelNesting&&(0,y.jsx)(dn.$n,{size:"sm",variant:"secondary",onClick:w,children:(0,y.jsx)(A.x6,{i18nKey:"canvas.tree-navigation-editor.frame-selection",children:"Frame selection"})})]})]})},Hx=t=>({addLayerButton:(0,Q.css)({marginLeft:"18px",minWidth:"150px"})});function jf(t){const{selected:e,scene:n}=t;if(n.currentLayer||(n.currentLayer=n.root),e)for(const i of e){if(i instanceof Be){n.currentLayer=i;break}if(i&&i.parent){n.currentLayer=i.parent;break}}const r=n.currentLayer.options||{elements:[]};return{category:[(0,A.t)("canvas.layer-editor.category-layer","Layer")],path:"--",values:i=>({getValue:a=>(0,ne.get)(r,a),onChange:(a,o)=>{if(a==="type"&&o){console.warn("unable to change layer type");return}const s=(0,Za.Sf)(r,a,o);n.currentLayer?.onChange(s),n.currentLayer?.updateData(n.context)}}),build:(i,a)=>{const o=n.currentLayer;o&&o.isRoot(),i.addCustomEditor({id:"content",path:"root",name:(0,A.t)("canvas.layer-editor.name-elements","Elements"),editor:Wx,settings:{scene:n,layer:n.currentLayer,selected:e}});const s={...a,options:r};cn.addBackground(i,s),cn.addBorder(i,s),o&&!o.isRoot()&&i.addCustomEditor({category:[(0,A.t)("canvas.layer-editor.category-layout","Layout")],id:"content",path:"__",name:(0,A.t)("canvas.layer-editor.name-constraints","Constraints"),editor:bf,settings:{scene:t.scene,element:o}})}}}var Yx=j(54314),Kx=j(60208);const Xx=({onTabChange:t})=>{const[e,n]=(0,F.useState)(ve.SelectedElement),r=[{label:"Selected Element",value:ve.SelectedElement},{label:"Element Management",value:ve.ElementManagement}],i=a=>{t(a),n(a)};return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(Yx.U,{children:r.map((a,o)=>(0,y.jsx)(Kx.o,{label:a.label,active:a.value===e,onChangeTab:()=>i(a.value)},`${a.value}-${o}`))})})};function Ux(){const t=(0,Hi.A)(Qr),e=t?.panel.context?.instanceState,n=(0,Pt.of)(Qx),[r,i]=(0,F.useState)(ve.SelectedElement),a=(0,F.useMemo)(()=>{const d=t?.panel,f=e;if(!(f&&f.scene)||!d)return new il.C({id:"root",title:"root"});const h=v=>{r===ve.ElementManagement&&v.addNestedOptions(jf(e));const p=f.selectedConnection;p&&r===ve.SelectedElement&&v.addNestedOptions(yf({category:["Selected connection"],connection:p,scene:f.scene}));const g=f.selected;if(g?.length===1&&r===ve.SelectedElement){const m=g[0];m&&!(m instanceof Be)&&v.addNestedOptions(Cf({category:[(0,A.t)("canvas.inline-edit-body.category-selected-element","Selected element ({{element}})",{element:m.options.name})],element:m,scene:f.scene}))}gl(v)};return Zx({options:d.props.options,onChange:d.props.onOptionsChange,data:d.props.data?.series},h)},[e,t,r]),o={marginLeft:15,marginTop:10},s=d=>{i(d)},l=Ui(e?.scene.shouldShowAdvancedTypes).options,c=e?.layer,u=e&&r===ve.SelectedElement&&e.selected.length===0&&e.selectedConnection===void 0;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:o,children:a.items.map(d=>d.render())}),(0,y.jsx)("div",{style:o,children:(0,y.jsx)(gf.r,{onChange:d=>oo(d,c),options:l,label:(0,A.t)("canvas.inline-edit-body.label-add-item","Add item")})}),(0,y.jsxs)("div",{style:o,children:[(0,y.jsx)(Xx,{onTabChange:s}),a.categories.map(d=>Vf(d)),u&&(0,y.jsx)("div",{className:n.selectElement,children:(0,y.jsx)(A.x6,{i18nKey:"canvas.inline-edit-body.please-select-an-element",children:"Please select an element"})})]})]})}function Vf(t){return(0,F.createElement)(F1.D,{...t.props,key:t.props.id},(0,y.jsx)("div",{children:t.items.map(e=>e.render())}),t.categories.map(e=>Vf(e)))}function Zx(t,e){const n={data:t.data??[],options:t.options},r=new il.C({id:"root",title:"root"}),i=o=>{if(o?.length){const s=o[0];let l=r.categories.find(c=>c.props.id===s);return l||(l=new il.C({id:s,title:s}),r.categories.push(l)),l}return r},a={getValue:o=>(0,ne.get)(t.options,o),onChange:(o,s)=>{t.onChange((0,Za.Sf)(t.options,o,s))}};return(0,G1.g5)("canvas-inline",e,a,i,n),r}const Qx=t=>({selectElement:(0,Q.css)({color:t.colors.text.secondary,padding:t.spacing(2)})}),pl=10,Ff=32;function qx({onClose:t,id:e,scene:n}){const r=n.root.div?.getBoundingClientRect(),i=window.innerHeight,a=window.innerWidth,o=(0,F.useRef)(null),s=(0,Pt.of)(Jx),l="inlineEditPanel"+e.toString(),c={width:400,height:400},u=r?.width??c.width+pl*2,d=r?.x??0+u-c.width-pl,f=r?.y??0+Ff,h=pf.A.getObject(l,{x:d,y:f,w:c.width,h:c.height}),[v,p]=(0,F.useState)({width:h.w,height:h.h}),[g,m]=(0,F.useState)({x:h.x,y:h.y});(0,F.useEffect)(()=>{const E=a-v.width-pl,S=i-v.height-Ff;E<g.x&&E>0&&m({...g,x:E}),S<g.y&&S>0&&m({...g,y:S})},[i,a,g,v]);const x=(E,S)=>{let D=S.x<0?0:S.x,M=S.y<0?0:S.y;m({x:D,y:M}),C(D,M,v.width,v.height)},b=(E,S)=>{const{size:D}=S;p({width:D.width,height:D.height}),C(g.x,g.y,D.width,D.height)},C=(E,S,D,M)=>{pf.A.setObject(l,{x:E,y:S,w:D,h:M})};return(0,y.jsx)(Ii.ZL,{children:(0,y.jsx)("div",{className:s.draggableWrapper,children:(0,y.jsx)(j1(),{handle:"strong",onStop:x,position:{x:g.x,y:g.y},children:(0,y.jsx)(V1.Resizable,{height:v.height,width:v.width,onResize:b,children:(0,y.jsxs)("div",{className:s.inlineEditorContainer,style:{height:`${v.height}px`,width:`${v.width}px`},ref:o,children:[(0,y.jsxs)("strong",{className:s.inlineEditorHeader,children:[(0,y.jsx)("div",{className:s.placeholder}),(0,y.jsx)("div",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.inline-edit.canvas-inline-editor",children:"Canvas Inline Editor"})}),(0,y.jsx)(Me.K,{name:"times",size:"xl",className:s.inlineEditorClose,onClick:t,tooltip:(0,A.t)("canvas.inline-edit.tooltip-close-inline-editor","Close inline editor")})]}),(0,y.jsx)("div",{className:s.inlineEditorContentWrapper,children:(0,y.jsx)("div",{className:s.inlineEditorContent,children:(0,y.jsx)(Ux,{})})})]})})})})})}const Jx=t=>({inlineEditorContainer:(0,Q.css)({display:"flex",flexDirection:"column",background:t.components.panel.background,border:`1px solid ${t.colors.border.weak}`,boxShadow:t.shadows.z3,zIndex:1e3,opacity:1,minWidth:"400px"}),draggableWrapper:(0,Q.css)({width:0,height:0}),inlineEditorHeader:(0,Q.css)({display:"flex",alignItems:"center",justifyContent:"center",background:t.colors.background.canvas,borderBottom:`1px solid ${t.colors.border.weak}`,height:"40px",cursor:"move"}),inlineEditorContent:(0,Q.css)({whiteSpace:"pre-wrap",padding:"10px"}),inlineEditorClose:(0,Q.css)({marginLeft:"auto"}),placeholder:(0,Q.css)({width:"24px",height:"24px",visibility:"hidden",marginRight:"auto"}),inlineEditorContentWrapper:(0,Q.css)({overflow:"scroll"})});let zi=[],gr,Ja=!1,to=!1;const Qr=new cf.m(1);class ty extends F.Component{constructor(e){super(e),this.subs=new a1.yU,this.queryEditorLoaded=!1,this.needsReload=!1,this.isEditing=uf.Ny.getSearchObject().editPanel!==void 0,this.onUpdateScene=n=>{const{onOptionsChange:r,options:i}=this.props;r({...i,root:n}),this.setState({refresh:this.state.refresh+1}),Qr.next({panel:this})},this.openInlineEdit=()=>{if(Ja){this.forceUpdate(),this.setActivePanel();return}this.setActivePanel(),this.setState({openInlineEdit:!0}),Ja=!0},this.openSetBackground=n=>{if(to){this.forceUpdate(),this.setActivePanel();return}this.setActivePanel(),this.setState({openSetBackground:!0}),this.setState({contextMenuAnchorPoint:n}),to=!0},this.tooltipCallback=n=>{this.scene.tooltipPayload=n,this.forceUpdate()},this.moveableActionCallback=n=>{this.setState({moveableAction:n}),this.forceUpdate()},this.actionConfirmationCallback=()=>{this.forceUpdate()},this.closeInlineEdit=()=>{this.setState({openInlineEdit:!1}),Ja=!1},this.closeSetBackground=()=>{this.setState({openSetBackground:!1}),to=!1},this.setActivePanel=()=>{gr=this,Qr.next({panel:this})},this.renderInlineEdit=()=>(0,y.jsx)(qx,{onClose:()=>this.closeInlineEdit(),id:this.props.id,scene:this.scene}),this.renderSetBackground=()=>(0,y.jsx)(z1,{onClose:()=>this.closeSetBackground(),scene:this.scene,anchorPoint:this.state.contextMenuAnchorPoint}),this.state={refresh:0,openInlineEdit:!1,openSetBackground:!1,contextMenuAnchorPoint:{x:0,y:0},moveableAction:!1},this.scene=new _1(this.props.options,this.onUpdateScene,this),this.scene.updateSize(e.width,e.height),this.scene.updateData(e.data),this.scene.inlineEditingCallback=this.openInlineEdit,this.scene.setBackgroundCallback=this.openSetBackground,this.scene.tooltipCallback=this.tooltipCallback,this.scene.moveableActionCallback=this.moveableActionCallback,this.scene.actionConfirmationCallback=this.actionConfirmationCallback,this.subs.add(this.props.eventBus.subscribe(hf.sL,n=>{this.scene.clearCurrentSelection(),this.closeInlineEdit()})),this.subs.add(this.props.eventBus.subscribe(hf.i0,n=>{this.props.id===n.payload&&(this.needsReload=!0,this.scene.clearCurrentSelection())}))}static{this.contextType=wr.e4}componentDidMount(){gr=this,Qr.next({panel:this}),this.panelContext=this.context,this.scene.data&&this.scene.updateData(this.scene.data),this.panelContext.onInstanceStateChange&&(this.panelContext.onInstanceStateChange({scene:this.scene,layer:this.scene.root}),this.subs.add(this.scene.selection.subscribe({next:e=>{e.length&&(gr=this,Qr.next({panel:this})),zi.forEach(n=>{n!==gr&&(n.scene.clearCurrentSelection(!0),n.scene.connections.select(void 0))}),this.panelContext?.onInstanceStateChange({scene:this.scene,selected:e,layer:this.scene.root})}})),this.subs.add(this.scene.connections.selection.subscribe({next:e=>{this.context.instanceState&&(this.panelContext?.onInstanceStateChange({scene:this.scene,selected:this.context.instanceState.selected,selectedConnection:e,layer:this.scene.root}),e&&(gr=this,Qr.next({panel:this})),zi.forEach(n=>{n!==gr&&(n.scene.clearCurrentSelection(!0),n.scene.connections.select(void 0))}),setTimeout(()=>{this.forceUpdate()}))}}))),this.isEditing&&(this.queryEditorLoaded=!1),zi.push(this)}componentDidUpdate(e){this.isEditing&&!this.queryEditorLoaded&&(e.width!==this.props.width||e.height!==this.props.height)&&(this.queryEditorLoaded=!0,requestAnimationFrame(()=>{this.scene.updateSize(this.props.width,this.props.height)}))}componentWillUnmount(){this.scene.subscription.unsubscribe(),this.subs.unsubscribe(),Ja=!1,to=!1,zi=zi.filter(e=>e.props.id!==gr?.props.id)}shouldComponentUpdate(e,n){const{width:r,height:i,data:a,options:o}=this.props;let s=!1;(r!==e.width||i!==e.height)&&(this.scene.updateSize(e.width,e.height),s=!0),a!==e.data&&!this.scene.ignoreDataUpdate&&(this.scene.updateData(e.data),s=!0),o!==e.options&&!this.scene.ignoreDataUpdate&&(this.scene.updateData(e.data),s=!0),this.state.refresh!==n.refresh&&(s=!0),this.state.openInlineEdit!==n.openInlineEdit&&(s=!0),this.state.openSetBackground!==n.openSetBackground&&(s=!0),this.state.moveableAction!==n.moveableAction&&(s=!0);const l=this.props.options.inlineEditing!==e.options.inlineEditing,c=this.props.options.showAdvancedTypes!==e.options.showAdvancedTypes,u=this.props.options.panZoom!==e.options.panZoom,d=this.props.options.zoomToContent!==e.options.zoomToContent,f=this.props.options.tooltip?.mode!==e.options.tooltip?.mode,h=this.props.options.tooltip?.disableForOneClick!==e.options.tooltip?.disableForOneClick;return(this.needsReload||l||c||u||d||f||h)&&(l&&this.scene.revId++,this.needsReload=!1,this.scene.load(e.options,e.options.inlineEditing),this.scene.updateSize(e.width,e.height),this.scene.updateData(e.data),s=!0),s}render(){return(0,y.jsxs)(y.Fragment,{children:[this.scene.render(),this.state.openInlineEdit&&this.renderInlineEdit(),this.state.openSetBackground&&this.renderSetBackground()]})}}var ey=j(34999);const ny="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/canvas/",ry=({})=>{const t=(0,Pt.of)(iy);return(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(Fe.B,{direction:"row",children:(0,y.jsx)(ey.F,{title:(0,A.t)("canvas.pan-zoom-help.title-pan-and-zoom-controls","Pan and zoom controls"),severity:"info",buttonContent:(0,y.jsx)(Qa.I,{name:"question-circle",size:"xl"}),className:t.alert,onRemove:()=>{const e=window.open(ny,"_blank","noopener,noreferrer");e&&(e.opener=null)},children:(0,y.jsx)(Fe.B,{direction:"column",children:(0,y.jsxs)("ul",{children:[(0,y.jsxs)("li",{children:[(0,y.jsx)(A.x6,{i18nKey:"canvas.pan-zoom-help.pan-title",children:"Pan:"}),(0,y.jsxs)("ul",{children:[(0,y.jsx)("li",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.pan-zoom-help.middle-mouse",children:"Middle mouse"})}),(0,y.jsx)("li",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.pan-zoom-help.ctrl-right-mouse",children:"CTRL + right mouse"})})]})]}),(0,y.jsx)("li",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.pan-zoom-help.zoom-scroll-wheel",children:"Zoom: Scroll wheel"})}),(0,y.jsx)("li",{children:(0,y.jsx)(A.x6,{i18nKey:"canvas.pan-zoom-help.reset-double-click",children:"Reset: Double click"})})]})})})})})},iy=t=>({alert:(0,Q.css)({"& div":{padding:"4px",alignItems:"start"},marginBottom:"0px",marginTop:"5px",padding:"2px","ul > li":{marginLeft:"10px"}})}),ay=t=>{const e=t?.pluginVersion??"";if(e===""){const n=t.options?.root;if(n?.elements)for(const r of n.elements)r.type==="text-box"&&(r.type="rectangle")}if(e.startsWith("11.0")){const n=t.options?.root;if(n?.elements)for(const r of n.elements)r.type==="ellipse"&&(r.config.backgroundColor&&(r.background=r.config.backgroundColor,delete r.config.backgroundColor),r.config.borderColor&&(r.border.color=r.config.borderColor,delete r.config.borderColor),r.config.width&&(r.border.width=r.config.width,delete r.config.width))}if(parseFloat(e)<=11.3){const n=t.options?.root;if(n?.elements){for(const r of n.elements)if(r.actions)for(const i of r.actions)i.options&&(i.fetch={...i.options},delete i.options)}}if(parseFloat(e)<=11.6){const n=t.options?.root;if(n?.elements)for(const r of n.elements)(r.oneClickMode===Ce.yd.Link||r.oneClickLinks)&&r.links?.length?r.links[0].oneClick=!0:r.oneClickMode===Ce.yd.Action&&r.actions?.length&&(r.actions[0].oneClick=!0),delete r.oneClickMode,delete r.oneClickLinks}if(parseFloat(e)<=12.2){const n=t.options?.root;if(n?.elements)for(const r of n.elements)for(const i of r.connections||[])i.direction&&typeof i.direction=="string"?i.direction={mode:"fixed",fixed:i.direction}:i.direction||(i.direction={mode:"fixed",fixed:"forward"})}return t.options},gl=t=>{let e=[(0,A.t)("canvas.category-canvas","Canvas")];t.addBooleanSwitch({path:"inlineEditing",name:(0,A.t)("canvas.name-inline-editing","Inline editing"),category:e,description:(0,A.t)("canvas.description-inline-editing","Enable editing the panel directly"),defaultValue:!0}),t.addBooleanSwitch({path:"showAdvancedTypes",name:(0,A.t)("canvas.name-experimental-types","Experimental element types"),category:e,description:(0,A.t)("canvas.description-experimental-types","Enable selection of experimental element types"),defaultValue:!0}),t.addBooleanSwitch({path:"panZoom",name:(0,A.t)("canvas.name-pan-zoom","Pan and zoom"),category:e,description:(0,A.t)("canvas.description-pan-zoom","Enable pan and zoom"),defaultValue:!1,showIf:()=>De.$.featureToggles.canvasPanelPanZoom}),t.addCustomEditor({id:"panZoomHelp",path:"panZoomHelp",name:"",category:e,editor:ry,showIf:n=>De.$.featureToggles.canvasPanelPanZoom&&n.panZoom}),t.addBooleanSwitch({path:"zoomToContent",name:"Zoom to content",description:"Automatically zoom to fit content",defaultValue:!1,showIf:()=>De.$.featureToggles.canvasPanelPanZoom}),e=[(0,A.t)("canvas.category-tooltip","Tooltip")],t.addRadio({path:"tooltip.mode",name:(0,A.t)("canvas.tooltip-options.name-tooltip-mode","Tooltip mode"),category:e,defaultValue:ft.$N.Single,settings:{options:[{value:ft.$N.Single,label:(0,A.t)("canvas.tooltip-options.tooltip-mode-options.label-enabled","Enabled")},{value:ft.$N.None,label:(0,A.t)("canvas.tooltip-options.tooltip-mode-options.label-disabled","Disabled")}]}}),t.addBooleanSwitch({path:"tooltip.disableForOneClick",name:(0,A.t)("canvas.tooltip-options.label-disable-one-click","Disable for one-click elements"),category:e,defaultValue:!1,showIf:n=>n.tooltip?.mode!==ft.$N.None})},oy=new $t.m(ty).setNoPadding().useFieldConfig({standardOptions:{[Vt.uo.Mappings]:{settings:{icon:!0}},[Vt.uo.Links]:{settings:{showOneClick:!1}},[Vt.uo.Actions]:{settings:{showOneClick:!1}}}}).setMigrationHandler(ay,t=>{const e=t?.pluginVersion??"";return parseFloat(e)<=12.2}).setPanelOptions((t,e)=>{const n=e.instanceState;if(gl(t),n&&n.scene){t.addNestedOptions(jf(n));const r=n.selected,i=n.selectedConnection;if(r?.length===1){const a=r[0];a instanceof Be||t.addNestedOptions(Cf({category:[(0,A.t)("canvas.category-selected-element","Selected element ({{element}})",{element:a.options.name})],element:a,scene:n.scene}))}i&&t.addNestedOptions(yf({category:[(0,A.t)("canvas.category-selected-connection","Selected connection")],connection:i,scene:n.scene}))}})},77239:(Ni,un,j)=>{j.d(un,{B:()=>xr});var $t=j(74848),Vt=j(22803),A=j(96540),De=j(63142),ft=j(53371),y=j(45967),ne=j(64394),F=j(71479),ge=j(55978),me=j(55302),$=(ot=>(ot[ot.Leading=0]="Leading",ot[ot.Trailing=1]="Trailing",ot))($||{});const Kt=({color:ot=ne.F,colorIndicator:Pe=ge.Ev,position:Q=0,lineStyle:Pt,isHollow:dn})=>{const We=(0,De.of)(ve);return dn?(0,$t.jsx)("div",{style:{border:`1px solid ${ot}`},className:(0,Vt.cx)(Q===0?We.leading:We.trailing,(0,me.L$)(Pe,We))}):Pe===ge.fX.series?(0,$t.jsx)(F.p,{color:ot,lineStyle:Pt,className:Q===0?We.leading:We.trailing}):(0,$t.jsx)("span",{style:{backgroundColor:ot},className:(0,Vt.cx)(Q===0?We.leading:We.trailing,(0,me.L$)(Pe,We))})},ve=ot=>({leading:(0,Vt.css)({marginRight:ot.spacing(.5)}),trailing:(0,Vt.css)({marginLeft:ot.spacing(.5)}),series:(0,Vt.css)({width:"14px",height:"4px",borderRadius:ot.shape.radius.pill,minWidth:"14px"}),value:(0,Vt.css)({width:"12px",height:"12px",borderRadius:ot.shape.radius.default,fontWeight:500,minWidth:"12px"}),hexagon:(0,Vt.css)({}),pie_1_4:(0,Vt.css)({}),pie_2_4:(0,Vt.css)({}),pie_3_4:(0,Vt.css)({}),marker_sm:(0,Vt.css)({width:"4px",height:"4px",borderRadius:ot.shape.radius.circle,minWidth:"4px"}),marker_md:(0,Vt.css)({width:"8px",height:"8px",borderRadius:ot.shape.radius.circle,minWidth:"8px"}),marker_lg:(0,Vt.css)({width:"12px",height:"12px",borderRadius:ot.shape.radius.circle,minWidth:"12px"})});var je=(ot=>(ot.label="label",ot.value="value",ot))(je||{});const Sn="Copied to clipboard",En=2*1e3,mr=7,xr=({label:ot,value:Pe,color:Q,colorIndicator:Pt,colorPlacement:dn=ge.lJ.first,justify:We="flex-start",isActive:fe=!1,marginRight:fn="0px",isPinned:Bi,lineStyle:Ve,showValueScroll:tn,isHiddenFromViz:br})=>{const xe=(0,De.of)(yr,We,fn),wn=tn?{maxHeight:55,whiteSpace:"wrap",wordBreak:"break-word",overflowY:"auto"}:{whiteSpace:"pre-line",wordBreak:"break-word",lineHeight:1.2},[ti,Fe]=(0,A.useState)(!1),[Ln,Me]=(0,A.useState)(null),[Xn,ei]=(0,A.useState)(!1),ni=(0,A.useRef)(null),ji=(0,A.useRef)(null);(0,A.useEffect)(()=>{let le;return Xn&&(le=setTimeout(()=>{ei(!1)},En)),()=>{window.clearTimeout(le)}},[Xn]);const Cr=async(le,Sr)=>{if(!(navigator?.clipboard&&window.isSecureContext)){eo(le,Sr);return}try{await navigator.clipboard.writeText(le),Me({[`${Sr}`]:le}),ei(!0)}catch{Me(null)}},eo=(le,Sr)=>{const _n=document.createElement("textarea");ni.current?.appendChild(_n),_n.value=le,_n.focus(),_n.select();try{document.execCommand("copy")&&(Me({[`${Sr}`]:le}),ei(!0))}catch(Gi){console.error("Unable to copy to clipboard",Gi)}_n.remove()},Vi=le=>{le.currentTarget.offsetWidth<le.currentTarget.scrollWidth&&Fe(!0)},Fi=()=>Fe(!1);return ot.length*mr>window.innerWidth/2&&(ot=ot.replaceAll("{",`{
  `).replaceAll("}",`
}`).replaceAll(", ",`,
  `)),(0,$t.jsxs)("div",{className:xe.contentWrapper,children:[(Q||ot)&&(0,$t.jsxs)("div",{className:xe.valueWrapper,children:[Q&&dn===ge.lJ.first&&(0,$t.jsx)(Kt,{color:Q,colorIndicator:Pt,lineStyle:Ve,isHollow:br}),Bi?(0,$t.jsx)($t.Fragment,{children:(0,$t.jsx)(y.m,{content:ot,interactive:!1,show:ti,children:(0,$t.jsxs)($t.Fragment,{children:[Xn&&Ln?.label&&(0,$t.jsx)(ft.r,{placement:"top",referenceElement:ni.current,children:Sn}),(0,$t.jsx)("div",{className:(0,Vt.cx)(xe.label,fe&&xe.activeSeries,navigator?.clipboard&&xe.copy),onMouseEnter:Vi,onMouseLeave:Fi,onClick:()=>Cr(ot,"label"),ref:ni,children:ot})]})})}):(0,$t.jsx)("div",{className:(0,Vt.cx)(xe.label,fe&&xe.activeSeries),children:ot})]}),(0,$t.jsxs)("div",{className:xe.valueWrapper,children:[Q&&dn===ge.lJ.leading&&(0,$t.jsx)(Kt,{color:Q,colorIndicator:Pt,position:$.Leading,lineStyle:Ve}),Bi?(0,$t.jsxs)($t.Fragment,{children:[Xn&&Ln?.value&&(0,$t.jsx)(ft.r,{placement:"top",referenceElement:ji.current,children:Sn}),(0,$t.jsx)("div",{className:(0,Vt.cx)(xe.value,fe,navigator?.clipboard&&xe.copy),style:wn,onClick:()=>Cr(Pe?Pe.toString():"","value"),ref:ji,children:Pe})]}):(0,$t.jsx)("div",{className:(0,Vt.cx)(xe.value,fe),style:wn,children:Pe}),Q&&dn===ge.lJ.trailing&&(0,$t.jsx)(Kt,{color:Q,colorIndicator:Pt,position:$.Trailing,lineStyle:Ve})]})]})},yr=(ot,Pe,Q)=>({contentWrapper:(0,Vt.css)({display:"flex",alignItems:"start",justifyContent:Pe,marginRight:Q}),label:(0,Vt.css)({color:ot.colors.text.secondary,fontWeight:400,textOverflow:"ellipsis",overflow:"hidden",marginRight:ot.spacing(2)}),value:(0,Vt.css)({fontWeight:500,textOverflow:"ellipsis",overflow:"hidden"}),valueWrapper:(0,Vt.css)({display:"flex",alignItems:"center"}),activeSeries:(0,Vt.css)({fontWeight:ot.typography.fontWeightBold,color:ot.colors.text.maxContrast}),copy:(0,Vt.css)({cursor:"pointer"})})}}]);

//# sourceMappingURL=canvasPanel.572c874964db762f86b5.js.map