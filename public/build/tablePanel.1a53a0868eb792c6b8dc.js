"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3525],{16264:()=>{},25205:(ie,W,l)=>{l.d(W,{L:()=>C});var h=l(74848),N=l(22803),T=l(96540),S=l(16515),t=l(57866),I=l(84229),r=l(43173),d=l(14477),A=l(64400),P=l(18857),H=l(63142),V=l(11142),U=l(65642),M=l(73163),w=l(32776);function C(a){const{data:i,height:f,width:v,options:p,fieldConfig:b,id:m,timeRange:E,replaceVariables:x,transparent:B}=a;(0,T.useMemo)(()=>{(0,S.Fm)(i.series)},[i.series]);const J=(0,H.$j)(),j=(0,A.d2)(),q=(0,T.useMemo)(()=>j.canExecuteActions?.()??!1,[j]),te=(0,T.useCallback)((n,c,u)=>q?e(n,c,u,x):[],[x,q]),D=(0,w.gy)(i.series)?(0,w.S5)(i.series):i.series,X=D?.length,oe=D.some(n=>n.fields.length>0),Q=G(D,p),Y=D[Q];let _=f;if(!X||!oe)return(0,h.jsx)(d.a,{panelId:m,fieldConfig:b,data:i});if(X>1){const n=J.spacing.gridSize*J.components.height.md,c=J.spacing.gridSize;_=f-n-c}const ae=j.sync&&j.sync()!==I.y.Off,le=(0,U.zj)().disableSanitizeHtml,ee=(0,h.jsx)(V.i,{height:_,width:v,data:Y,noHeader:!p.showHeader,showTypeIcons:p.showTypeIcons,resizable:!0,initialSortBy:p.sortBy,onSortByChange:n=>R(n,a),onColumnResize:(n,c)=>z(n,c,a),onCellFilterAdded:j.onAddAdHocFilter,frozenColumns:p.frozenColumns?.left,enablePagination:p.enablePagination,cellHeight:p.cellHeight,maxRowHeight:p.maxRowHeight,timeRange:E,enableSharedCrosshair:r.$.featureToggles.tableSharedCrosshair&&ae,fieldConfig:b,getActions:te,structureRev:i.structureRev,transparent:B,disableSanitizeHtml:le});if(X===1)return ee;const o=D.map((n,c)=>({label:(0,S.Ri)(n),value:c}));return(0,h.jsxs)("div",{className:s.wrapper,children:[ee,(0,h.jsx)("div",{className:s.selectWrapper,children:(0,h.jsx)(P.l6,{options:o,value:o[Q],onChange:n=>$(n,a)})})]})}function G(a,i){return i.frameIndex>0&&i.frameIndex<a.length?i.frameIndex:0}function z(a,i,f){const{fieldConfig:v}=f,{overrides:p}=v,b=t.Ct.byName,m="custom.width",E=p.find(x=>x.matcher.id===b&&x.matcher.options===a);if(E){const x=E.properties.find(B=>B.id===m);x?x.value=i:E.properties.push({id:m,value:i})}else p.push({matcher:{id:b,options:a},properties:[{id:m,value:i}]});f.onFieldConfigChange({...v,overrides:p})}function R(a,i){i.onOptionsChange({...i.options,sortBy:a})}function $(a,i){i.onOptionsChange({...i.options,frameIndex:a.value||0})}const k=a=>a,e=(a,i,f,v)=>{if((i.config.actions?.length??0)>0){const b=(0,M.ko)(a,i,i.state.scopedVars,v??k,i.config.actions??[],{valueRowIndex:f});if(b.length===1)return b;{const m=[],E=new Set;return b.forEach(x=>{const B=x.title;E.has(B)||(m.push(x),E.add(B))}),m}}return[]},s={wrapper:(0,N.css)({display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}),selectWrapper:(0,N.css)({padding:"8px 8px 0px 8px"})}},32776:(ie,W,l)=>{l.d(W,{S5:()=>G,fq:()=>r,gy:()=>z,l1:()=>w});var h=l(2543),N=l.n(h),T=l(57866),S=l(4575),t=l(33553),I=l(95004);const r=e=>(!e.pluginVersion&&"columns"in e&&console.log("Was angular table",e),R(e),$(e),k(e),e.options),d={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},A={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},P={cell:"color-background",row:"color-background",value:"color-text"},H=(e,s)=>[-1/0,...e].map((a,i)=>({color:s[i],value:(0,h.isNumber)(a)?a:parseInt(a,10)})),V=(e,s)=>{const a=e.transformations??[];if(Object.keys(d).includes(s.transform)){const i={reducers:[]};s.transform==="timeseries_aggregations"&&(i.includeTimeField=!1,i.reducers=s.columns.map(f=>A[f.value])),a.push({id:d[s.transform],options:i})}return a},U=e=>{const a={matcher:{id:/^\/.*\/$/.test(e.pattern)?T.Ct.byRegexp:T.Ct.byName,options:e.pattern},properties:[]};return e.alias&&a.properties.push({id:"displayName",value:e.alias}),e.unit&&a.properties.push({id:"unit",value:e.unit}),e.decimals!==void 0&&a.properties.push({id:"decimals",value:e.decimals}),e.type==="date"&&a.properties.push({id:"unit",value:`time: ${e.dateFormat}`}),e.type==="hidden"&&a.properties.push({id:"custom.hidden",value:!0}),e.link&&a.properties.push({id:"links",value:[{title:(0,h.defaultTo)(e.linkTooltip,""),url:(0,h.defaultTo)(e.linkUrl,""),targetBlank:(0,h.defaultTo)(e.linkTargetBlank,!1)}]}),e.colorMode&&a.properties.push({id:"custom.cellOptions",value:{type:P[e.colorMode]}}),e.align&&a.properties.push({id:"custom.align",value:e.align==="auto"?null:e.align}),e.thresholds?.length&&e.colors?.length&&a.properties.push({id:"thresholds",value:{mode:t.O.Absolute,steps:H(e.thresholds,e.colors)}}),a},M=e=>{let s={custom:{}};if(e){if(s=(0,h.omitBy)({unit:e.unit,decimals:e.decimals,displayName:e.alias,custom:{align:e.align==="auto"?null:e.align}},h.isNil),e.thresholds&&e.thresholds.length){const a={mode:t.O.Absolute,steps:H(e.thresholds,e.colors)};s.thresholds=a}e.colorMode&&(s.custom.cellOptions={type:P[e.colorMode]})}return s},w=(e,s,a)=>{if(s==="table-old"&&a.angular){const i=a.angular,f=V(e,i),v=i.styles.find(m=>m.pattern==="/.*/"),p=M(v),b=i.styles.filter(m=>m.pattern!=="/.*/").map(U);e.transformations=f,e.fieldConfig={defaults:p,overrides:b}}return{}},C=e=>e?.filter(s=>s.meta?.custom?.parentRowIndex===void 0)||[e?.[0]],G=e=>{const s=[];return C(e).filter(i=>!!i&&i.length!==0)?.forEach(i=>{const f=e?.filter(m=>i.refId===m.refId&&m.meta?.custom?.parentRowIndex!==void 0),v=(0,h.groupBy)(f,m=>m.meta?.custom?.parentRowIndex),p=Object.keys(v).map(m=>v[m]),b={...i};f&&f.length>0&&b.fields.push({name:"nested",type:I.PU.nestedFrames,config:{},values:p}),s.push(b)}),s},z=e=>e?.some(s=>s.meta?.custom?.parentRowIndex!==void 0),R=e=>{if(e.fieldConfig?.defaults.custom?.wrapText!==void 0)return;const s=e.fieldConfig?.defaults.custom?.cellOptions?.wrapText;return e.fieldConfig.overrides=e.fieldConfig.overrides.map(a=>(a.properties&&(a.properties=a.properties.flatMap(i=>i.id==="custom.cellOptions"&&i.value&&i.value.wrapText!==void 0?[{...i,value:{...(0,h.omit)(i.value,"wrapText")}},{id:"custom.wrapText",value:i.value.wrapText}]:[i])),a)),e.fieldConfig.defaults.custom=e.fieldConfig.defaults.custom??{},e.fieldConfig.defaults.custom.wrapText=s,delete e.fieldConfig.defaults.custom.cellOptions?.wrapText,e},$=e=>(e.fieldConfig.overrides=e.fieldConfig.overrides.map(s=>(s.properties&&(s.properties=s.properties.map(a=>a.id==="custom.hidden"?{...a,id:"custom.hideFrom.viz"}:a)),s)),e),k=e=>{if(e.options&&"footer"in e.options){const s=e.options.footer;if(s.show){const a=s.reducer;e.fieldConfig.defaults.custom={...e.fieldConfig.defaults.custom,footer:{reducers:a}},s.countRows&&a[0]==="count"?e.fieldConfig.defaults.custom.footer.reducers=["countAll"]:s.fields&&s.fields.length>1?(delete e.fieldConfig.defaults.custom.footer,e.fieldConfig.overrides.push({matcher:{id:T.Ct.byNames,options:{mode:S.PP.include,names:s.fields}},properties:[{id:"custom.footer.reducers",value:a}]})):s.fields&&s.fields.length===1&&(delete e.fieldConfig.defaults.custom.footer,e.fieldConfig.overrides.push({matcher:{id:T.Ct.byName,options:s.fields[0]},properties:[{id:"custom.footer.reducers",value:a}]}))}s.enablePagination!=null&&(e.options.enablePagination=s.enablePagination),delete e.options.footer}}},69194:(ie,W,l)=>{l.r(W),l.d(W,{plugin:()=>ee});var h=l(16207),N=l(83340),T=l(53543),S=l(38809),t=l(92745),I=l(31114),r=l(739),d=l(74848),A=l(51898),P=l(21285);function H({onChange:o,value:n,id:c}){const u=y=>{o(y?.currentTarget.checked)};return(0,d.jsx)(P.d,{id:c,label:A.Tp.components.PanelEditor.OptionsPane.fieldLabel("Enable pagination"),value:!!n,onChange:u})}var V=l(22803),U=l(2543),M=l(96540),w=l(63142),C=l(37386),G=l(43243),z=l(41654),R=l(77824);function $({cellOptions:o,onChange:n}){const c=y=>{o.mode=y,n(o)},u=y=>{o.valueDisplayMode=y,n(o)};return(0,d.jsxs)(z.B,{direction:"column",gap:0,children:[(0,d.jsx)(C.D,{label:(0,t.t)("table.bar-gauge-cell-options-editor.label-gauge-display-mode","Gauge display mode"),children:(0,d.jsx)(R.z,{value:o?.mode??r.eX.Gradient,onChange:c,options:k})}),(0,d.jsx)(C.D,{label:(0,t.t)("table.bar-gauge-cell-options-editor.label-value-display","Value display"),children:(0,d.jsx)(R.z,{value:o?.valueDisplayMode??r.$l.Text,onChange:u,options:e})})]})}const k=[{value:r.eX.Basic,label:"Basic"},{value:r.eX.Gradient,label:"Gradient"},{value:r.eX.Lcd,label:"Retro LCD"}],e=[{value:r.$l.Color,label:"Value color"},{value:r.$l.Text,label:"Text color"},{value:r.$l.Hidden,label:"Hidden"}],s=[{value:r.Wq.Basic,label:"Basic"},{value:r.Wq.Gradient,label:"Gradient"}],a=({cellOptions:o,onChange:n})=>{const c=O=>{o.mode=O,n(o)},u=()=>{o.applyToRow=!o.applyToRow,n(o)},y=(0,M.useId)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(C.D,{label:(0,t.t)("table.color-background-cell-options-editor.label-background-display-mode","Background display mode"),children:(0,d.jsx)(R.z,{"aria-label":A.Tp.components.PanelEditor.OptionsPane.fieldLabel("Background display mode"),value:o?.mode??r.Wq.Gradient,onChange:c,options:s})}),(0,d.jsx)(C.D,{label:(0,t.t)("table.color-background-cell-options-editor.label-apply-to-entire-row","Apply to entire row"),description:(0,t.t)("table.color-background-cell-options-editor.description-apply-to-entire-row","If selected the entire row will be colored as this cell would be."),children:(0,d.jsx)(P.d,{id:y,label:A.Tp.components.PanelEditor.OptionsPane.fieldLabel("Apply to entire row"),value:o.applyToRow,onChange:u})})]})};var i=l(63527);const f=({cellOptions:o,onChange:n})=>{const c=F=>{o.alt=F.currentTarget.value,n(o)},u=F=>{o.title=F.currentTarget.value,n(o)},y=(0,M.useId)(),O=(0,M.useId)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(C.D,{label:(0,t.t)("table.image-cell-options-editor.label-alt-text","Alt text"),description:(0,t.t)("table.image-cell-options-editor.description-alt-text","Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader"),children:(0,d.jsx)(i.p,{id:y,onChange:c,defaultValue:o.alt})}),(0,d.jsx)(C.D,{label:(0,t.t)("table.image-cell-options-editor.label-title-text","Title text"),description:(0,t.t)("table.image-cell-options-editor.description-title-text","Text that will be displayed when the image is hovered by a cursor"),children:(0,d.jsx)(i.p,{id:O,onChange:u,defaultValue:o.title})})]})};var v=l(72636),p=l(99887);const b=({cellOptions:o,onChange:n})=>{const c=u=>{o.dynamicHeight=u.currentTarget.checked,n(o)};return(0,d.jsx)(C.D,{label:(0,d.jsxs)(v.J,{description:(0,t.t)("table.markdown-cell-options-editor.description-dynamic-height","We recommend enabling pagination with this option to avoid performance issues."),children:[(0,d.jsx)(t.x6,{i18nKey:"table.markdown-cell-options-editor.label-dynamic-height",children:"Dynamic height"})," ",(0,d.jsx)(p.E,{text:(0,t.t)("table.markdown-cell-options-editor.label.text-alpha","Alpha"),color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]}),children:(0,d.jsx)(P.d,{onChange:c,value:o.dynamicHeight})})};var m=l(37297),E=l(93948),x=l(12241);const B=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function J(o){const n=(0,x.V)(o);return{...n,useCustomConfig:c=>{n.useCustomConfig?.(c),c.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const j=o=>{const{cellOptions:n,onChange:c}=o,u=(0,M.useMemo)(()=>{const g=J(E.t);return(0,m.O)(g,"ChartCell")},[]),y=(0,w.of)(te),O={...E.t,...n},F=(0,M.useId)();return(0,d.jsx)(z.B,{direction:"column",children:u.list(B.map(g=>`custom.${g}`)).map(g=>{if(g.showIf&&!g.showIf(O))return null;const ne=g.editor,Z=g.path;return(0,d.jsx)(C.D,{label:g.name,className:y.field,children:(0,d.jsx)(ne,{onChange:L=>c({...n,[Z]:L}),value:(q(Z,O)?O[Z]:void 0)??g.defaultValue,item:g,context:{data:[]},id:`${F}${g.id}`})},g.id)})})};function q(o,n){return o in n}const te=()=>({field:(0,V.css)({width:"100%","[title='Use color scheme to define gradient']":{display:"none"}})}),D=({value:o,onChange:n,id:c})=>{const u=o.type,y=(0,w.of)(X),O=[{value:r.ob.Auto,label:(0,t.t)("table.cell-types.auto","Auto")},{value:r.ob.ColorText,label:(0,t.t)("table.cell-types.color-text","Colored text")},{value:r.ob.ColorBackground,label:(0,t.t)("table.cell-types.color-background","Colored background")},{value:r.ob.DataLinks,label:(0,t.t)("table.cell-types.data-links","Data links")},{value:r.ob.Gauge,label:(0,t.t)("table.cell-types.gauge","Gauge")},{value:r.ob.Sparkline,label:(0,t.t)("table.cell-types.sparkline","Sparkline")},{value:r.ob.JSONView,label:(0,t.t)("table.cell-types.json","JSON View")},{value:r.ob.Pill,label:(0,t.t)("table.cell-types.pill","Pill")},{value:r.ob.Markdown,label:(0,t.t)("table.cell-types.markdown","Markdown + HTML")},{value:r.ob.Image,label:(0,t.t)("table.cell-types.image","Image")},{value:r.ob.Actions,label:(0,t.t)("table.cell-types.actions","Actions")}],F=O.find(K=>K.value===u);let[g,ne]=(0,M.useState)({});const Z=K=>{K!==null&&(o={type:K.value},g[o.type]!==void 0&&Object.keys(g[o.type]).length>1&&(o=(0,U.merge)({},o,g[o.type])),n(o))},L=K=>{g[o.type]=(0,U.merge)({},o,K),ne(g),n(g[o.type])};return(0,d.jsxs)("div",{className:y.fixBottomMargin,children:[(0,d.jsx)(C.D,{children:(0,d.jsx)(G.G,{id:c,options:O,value:F,onChange:Z})}),u===r.ob.Gauge&&(0,d.jsx)($,{cellOptions:o,onChange:L}),u===r.ob.ColorBackground&&(0,d.jsx)(a,{cellOptions:o,onChange:L}),u===r.ob.Sparkline&&(0,d.jsx)(j,{cellOptions:o,onChange:L}),u===r.ob.Image&&(0,d.jsx)(f,{cellOptions:o,onChange:L}),u===r.ob.Markdown&&(0,d.jsx)(b,{cellOptions:o,onChange:L})]})},X=o=>({fixBottomMargin:(0,V.css)({position:"relative",marginBottom:o.spacing(-2)})});var oe=l(25205),Q=l(32776);const Y={cellHeight:r.qM.Sm,frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]},_=l.p+"static/img/icn-table-panel.3ee1d0cc.svg";var ae=l(73495);class le{getSuggestionsForData(n){const c=n.getListAppender({name:ae.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:u=>{u.fieldConfig.defaults.custom.minWidth=50}}});n.dataSummary.fieldCount===0?c.append({cardOptions:{imgSrc:_}}):c.append({})}}const ee=new h.m(oe.L).setPanelChangeHandler(Q.l1).setMigrationHandler(Q.fq).useFieldConfig({standardOptions:{[N.uo.Actions]:{hideFromDefaults:!1}},useCustomConfig:o=>{const n=[(0,t.t)("table.category-table","Table")],c=[(0,t.t)("table.category-cell-options","Cell options")];o.addNumberInput({path:"minWidth",name:(0,t.t)("table.name-min-column-width","Minimum column width"),category:n,description:(0,t.t)("table.description-min-column-width","The minimum width for column auto resizing"),settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:I.gB.minWidth}).addNumberInput({path:"width",name:(0,t.t)("table.name-column-width","Column width"),category:n,settings:{placeholder:(0,t.t)("table.placeholder-column-width","auto"),min:20},shouldApply:()=>!0,defaultValue:I.gB.width}).addRadio({path:"align",name:(0,t.t)("table.name-column-alignment","Column alignment"),category:n,settings:{options:[{label:(0,t.t)("table.column-alignment-options.label-auto","Auto"),value:"auto"},{label:(0,t.t)("table.column-alignment-options.label-left","Left"),value:"left"},{label:(0,t.t)("table.column-alignment-options.label-center","Center"),value:"center"},{label:(0,t.t)("table.column-alignment-options.label-right","Right"),value:"right"}]},defaultValue:I.gB.align}).addBooleanSwitch({path:"filterable",name:(0,t.t)("table.name-column-filter","Column filter"),category:n,description:(0,t.t)("table.description-column-filter","Enables/disables field filters in table"),defaultValue:I.gB.filterable}).addBooleanSwitch({path:"wrapText",name:(0,t.t)("table.name-wrap-text","Wrap text"),category:n}).addBooleanSwitch({path:"wrapHeaderText",name:(0,t.t)("table.name-wrap-header-text","Wrap header text"),category:n}).addBooleanSwitch({path:"hideFrom.viz",name:(0,t.t)("table.name-hide-in-table","Hide in table"),category:n,defaultValue:void 0,hideFromDefaults:!0}).addCustomEditor({id:"footer.reducers",category:[(0,t.t)("table.category-table-footer","Table footer")],path:"footer.reducers",name:(0,t.t)("table.name-calculation","Calculation"),description:(0,t.t)("table.description-calculation","Choose a reducer function / calculation"),editor:T.D.get("stats-picker").editor,override:T.D.get("stats-picker").editor,defaultValue:[],process:S.hS,shouldApply:()=>!0,settings:{allowMultiple:!0}}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:(0,t.t)("table.name-cell-type","Cell type"),editor:D,override:D,defaultValue:I.gB.cellOptions,process:S.hS,category:c,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:(0,t.t)("table.name-cell-value-inspect","Cell value inspect"),description:(0,t.t)("table.description-cell-value-inspect","Enable cell value inspection in a modal window"),defaultValue:!1,category:c,showIf:u=>u.cellOptions.type===r.ob.Auto||u.cellOptions.type===r.ob.JSONView||u.cellOptions.type===r.ob.ColorText||u.cellOptions.type===r.ob.ColorBackground}).addFieldNamePicker({path:"tooltip.field",name:(0,t.t)("table.name-tooltip-from-field","Tooltip from field"),description:(0,t.t)("table.description-tooltip-from-field","Render a cell from a field (hidden or visible) in a tooltip"),category:c}).addSelect({path:"tooltip.placement",name:(0,t.t)("table.name-tooltip-placement","Tooltip placement"),category:c,settings:{options:[{label:(0,t.t)("table.tooltip-placement-options.label-auto","Auto"),value:r.F4.Auto},{label:(0,t.t)("table.tooltip-placement-options.label-top","Top"),value:r.F4.Top},{label:(0,t.t)("table.tooltip-placement-options.label-right","Right"),value:r.F4.Right},{label:(0,t.t)("table.tooltip-placement-options.label-bottom","Bottom"),value:r.F4.Bottom},{label:(0,t.t)("table.tooltip-placement-options.label-left","Left"),value:r.F4.Left}]},showIf:u=>u.tooltip?.field!==void 0})}}).setPanelOptions(o=>{const n=[(0,t.t)("table.category-table","Table")];o.addBooleanSwitch({path:"showHeader",name:(0,t.t)("table.name-show-table-header","Show table header"),category:n,defaultValue:Y.showHeader}).addNumberInput({path:"frozenColumns.left",name:(0,t.t)("table.name-frozen-columns","Frozen columns"),description:(0,t.t)("table.description-frozen-columns","Columns are frozen from the left side of the table"),settings:{placeholder:"none"},category:n}).addRadio({path:"cellHeight",name:(0,t.t)("table.name-cell-height","Cell height"),category:n,defaultValue:Y.cellHeight,settings:{options:[{value:r.qM.Sm,label:(0,t.t)("table.cell-height-options.label-small","Small")},{value:r.qM.Md,label:(0,t.t)("table.cell-height-options.label-medium","Medium")},{value:r.qM.Lg,label:(0,t.t)("table.cell-height-options.label-large","Large")}]}}).addNumberInput({path:"maxRowHeight",name:(0,t.t)("table.name-max-height","Max row height"),category:n,settings:{placeholder:(0,t.t)("table.placeholder-max-height","none"),min:0}}).addCustomEditor({id:"enablePagination",path:"enablePagination",name:(0,t.t)("table.name-enable-pagination","Enable pagination"),category:n,editor:H,defaultValue:Y?.enablePagination})}).setSuggestionsSupplier(new le)}}]);

//# sourceMappingURL=tablePanel.1a53a0868eb792c6b8dc.js.map