"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4301],{3627:(R,p,e)=>{e.r(p),e.d(p,{plugin:()=>I});var h=e(16207),d=e(47184),n=e(92745),u=e(87826),c=e(88535),l=e(74848),i=e(96540),v=e(69192),S=e(2513);const F=({value:a,onChange:t,context:s})=>{const r=(0,i.useMemo)(()=>(0,c.L)(s.data[0]),[s.data]),[o,m]=(0,i.useState)(),[O,P]=(0,i.useState)({});return(0,i.useEffect)(()=>{a.tags||t({...a,tags:[S.Tl]})},[t,a]),r?(0,l.jsx)(v.T,{search:a,setSearch:t,trace:r,tagKeys:o,setTagKeys:m,tagValues:O,setTagValues:P}):null};var y=e(22803),T=e(16817),V=e(78282),x=e(40476),L=e(77806);const g={wrapper:(0,y.css)({height:"100%",overflow:"scroll"})},j=({data:a,options:t,replaceVariables:s})=>{const r=(0,i.createRef)(),o=(0,i.useMemo)(()=>(0,c.L)(a.series[0]),[a.series]),m=(0,T.A)(async()=>await(0,V.l)().get(a.request?.targets[0].datasource?.uid));return!a||!a.series.length||!o?(0,l.jsx)("div",{className:"panel-empty",children:(0,l.jsx)("p",{children:(0,l.jsx)(n.x6,{i18nKey:"traces.traces-panel.no-data-found-in-response",children:"No data found in response"})})}):(0,l.jsxs)("div",{className:g.wrapper,children:[(0,l.jsx)("div",{ref:r}),(0,l.jsx)(x.V,{dataFrames:a.series,scrollElementClass:g.wrapper,traceProp:o,datasource:m.value,topOfViewRef:r,createSpanLink:t.createSpanLink,focusedSpanId:t.focusedSpanId,createFocusSpanLink:t.createFocusSpanLink,spanFilters:(0,L.Q)(s,t.spanFilters),timeRange:a.timeRange})]})};var N=e(38919),f=e(73495);class C{getListWithDefaults(t){return t.getListAppender({name:f.m.Trace,pluginId:"traces"})}getSuggestionsForData(t){!t.data||!t.data.series[0]||t.data.series[0].meta?.preferredVisualisationType==="trace"&&this.getListWithDefaults(t).append({name:f.m.Trace,score:N.nQ.Best})}}const I=new h.m(j).setPanelOptions((a,t)=>{const s=[(0,n.t)("traces.category-span-filters","Span filters")],r=(0,c.L)(t?.data?.[0]);a.addTextInput({path:"spanFilters.query",name:(0,n.t)("traces.name-find-in-trace","Find in trace"),category:s}).addBooleanSwitch({path:"spanFilters.matchesOnly",name:(0,n.t)("traces.name-show-matches-only","Show matches only"),defaultValue:!1,category:s}).addBooleanSwitch({path:"spanFilters.criticalPathOnly",name:(0,n.t)("traces.name-critical-path-only","Show critical path only"),defaultValue:!1,category:s}),a.addSelect({path:"spanFilters.serviceName",name:(0,n.t)("traces.name-service-name","Service name"),category:s,settings:{options:r?(0,u.pG)(r).map(d.z):[],allowCustomValue:!0,isClearable:!0}}).addRadio({path:"spanFilters.serviceNameOperator",name:(0,n.t)("traces.name-service-name-operator","Service name operator"),defaultValue:"=",settings:{options:[{value:"=",label:"="},{value:"!=",label:"!="}]},category:s}),a.addSelect({path:"spanFilters.spanName",name:(0,n.t)("traces.name-span-name","Span name"),category:s,settings:{options:r?(0,u.m8)(r).map(d.z):[],allowCustomValue:!0,isClearable:!0}}).addRadio({path:"spanFilters.spanNameOperator",name:(0,n.t)("traces.name-span-name-operator","Span name operator"),defaultValue:"=",settings:{options:[{value:"=",label:"="},{value:"!=",label:"!="}]},category:s}),a.addTextInput({path:"spanFilters.from",name:(0,n.t)("traces.name-min-duration","Min duration"),category:s}).addTextInput({path:"spanFilters.to",name:(0,n.t)("traces.name-max-duration","Max duration"),category:s}),a.addCustomEditor({id:"tags",name:(0,n.t)("traces.name-tags","Tags"),path:"spanFilters",category:s,editor:F,defaultValue:void 0})}).setSuggestionsSupplier(new C)}}]);

//# sourceMappingURL=tracesPanel.d0de7de7ce097a340509.js.map