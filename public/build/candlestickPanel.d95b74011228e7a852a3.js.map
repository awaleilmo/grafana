{"version":3,"file":"candlestickPanel.d95b74011228e7a852a3.js","mappings":"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","sources":["webpack://grafana/./public/app/plugins/panel/timeseries/plugins/ExemplarMarker.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/ExemplarsPlugin.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/ThresholdDragHandle.tsx","webpack://grafana/./public/app/plugins/panel/timeseries/plugins/ThresholdControlsPlugin.tsx","webpack://grafana/./public/app/features/visualization/data-hover/ExemplarTooltip.tsx","webpack://grafana/./public/app/plugins/panel/candlestick/panelcfg.gen.ts","webpack://grafana/./public/app/plugins/panel/candlestick/types.ts","webpack://grafana/./public/app/plugins/panel/candlestick/fields.ts","webpack://grafana/./public/app/plugins/panel/candlestick/utils.ts","webpack://grafana/./public/app/plugins/panel/candlestick/CandlestickPanel.tsx","webpack://grafana/./public/app/plugins/panel/candlestick/suggestions.ts","webpack://grafana/./public/app/plugins/panel/candlestick/module.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport {\n  autoUpdate,\n  flip,\n  safePolygon,\n  shift,\n  useDismiss,\n  useFloating,\n  useHover,\n  useInteractions,\n} from '@floating-ui/react';\nimport { useCallback, useEffect, useState } from 'react';\nimport * as React from 'react';\n\nimport { DataFrame, Field, formattedValueToString, GrafanaTheme2, LinkModel } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { TimeZone } from '@grafana/schema';\nimport { Portal, UPlotConfigBuilder, useStyles2 } from '@grafana/ui';\nimport { VizTooltipItem } from '@grafana/ui/internal';\nimport { CloseButton } from 'app/core/components/CloseButton/CloseButton';\nimport { ExemplarTooltip } from 'app/features/visualization/data-hover/ExemplarTooltip';\n\nimport { getDataLinks } from '../../status-history/utils';\n\ninterface ExemplarMarkerProps {\n  timeZone: TimeZone;\n  dataFrame: DataFrame;\n  frameIndex: number;\n  rowIndex: number;\n  config: UPlotConfigBuilder;\n  exemplarColor?: string;\n  clickedRowIndex: number | undefined;\n  setClickedRowIndex: React.Dispatch<number | undefined>;\n  maxHeight?: number;\n  maxWidth?: number;\n}\n\nexport const ExemplarMarker = ({\n  timeZone,\n  dataFrame,\n  frameIndex,\n  rowIndex,\n  config,\n  exemplarColor,\n  clickedRowIndex,\n  setClickedRowIndex,\n  maxHeight,\n  maxWidth,\n}: ExemplarMarkerProps) => {\n  const styles = useStyles2(getExemplarMarkerStyles, maxWidth);\n  const [isOpen, setIsOpen] = useState(false);\n  const [isLocked, setIsLocked] = useState(false);\n\n  // the order of middleware is important!\n  const middleware = [\n    flip({\n      fallbackAxisSideDirection: 'end',\n      // see https://floating-ui.com/docs/flip#combining-with-shift\n      crossAxis: false,\n      boundary: document.body,\n    }),\n    shift(),\n  ];\n\n  const { context, refs, floatingStyles } = useFloating({\n    open: isOpen,\n    placement: 'bottom',\n    onOpenChange: setIsOpen,\n    middleware,\n    whileElementsMounted: autoUpdate,\n    strategy: 'fixed',\n  });\n\n  const dismiss = useDismiss(context);\n  const hover = useHover(context, {\n    handleClose: safePolygon(),\n    enabled: clickedRowIndex === undefined,\n  });\n\n  const { getReferenceProps, getFloatingProps } = useInteractions([dismiss, hover]);\n\n  useEffect(() => {\n    if (clickedRowIndex !== rowIndex) {\n      setIsLocked(false);\n    }\n  }, [clickedRowIndex, rowIndex]);\n\n  const getSymbol = () => {\n    return (\n      <rect\n        fill={exemplarColor}\n        key=\"diamond\"\n        x=\"3.38672\"\n        width=\"4.78985\"\n        height=\"4.78985\"\n        transform=\"rotate(45 3.38672 0)\"\n      />\n    );\n\n    // const symbols = [\n    //   <rect\n    //     fill={exemplarColor}\n    //     key=\"diamond\"\n    //     x=\"3.38672\"\n    //     width=\"4.78985\"\n    //     height=\"4.78985\"\n    //     transform=\"rotate(45 3.38672 0)\"\n    //   />,\n    //   <path\n    //     fill={exemplarColor}\n    //     key=\"x\"\n    //     d=\"M1.94444 3.49988L0 5.44432L1.55552 6.99984L3.49996 5.05539L5.4444 6.99983L6.99992 5.44431L5.05548 3.49988L6.99983 1.55552L5.44431 0L3.49996 1.94436L1.5556 0L8.42584e-05 1.55552L1.94444 3.49988Z\"\n    //   />,\n    //   <path fill={exemplarColor} key=\"triangle\" d=\"M4 0L7.4641 6H0.535898L4 0Z\" />,\n    //   <rect fill={exemplarColor} key=\"rectangle\" width=\"5\" height=\"5\" />,\n    //   <path\n    //     fill={exemplarColor}\n    //     key=\"pentagon\"\n    //     d=\"M3 0.5L5.85317 2.57295L4.76336 5.92705H1.23664L0.146831 2.57295L3 0.5Z\"\n    //   />,\n    //   <path\n    //     fill={exemplarColor}\n    //     key=\"plus\"\n    //     d=\"m2.35672,4.2425l0,2.357l1.88558,0l0,-2.357l2.3572,0l0,-1.88558l-2.3572,0l0,-2.35692l-1.88558,0l0,2.35692l-2.35672,0l0,1.88558l2.35672,0z\"\n    //   />,\n    // ];\n\n    // return symbols[dataFrameFieldIndex.frameIndex % symbols.length];\n  };\n\n  const lockExemplarModal = () => {\n    setIsLocked(true);\n  };\n\n  const renderMarker = useCallback(() => {\n    const onClose = () => {\n      setIsLocked(false);\n      setIsOpen(false);\n      setClickedRowIndex(undefined);\n    };\n\n    let items: VizTooltipItem[] = [];\n    let links: LinkModel[] = [];\n\n    dataFrame.fields.forEach((field: Field) => {\n      const value = field.values[rowIndex];\n\n      links.push(...getDataLinks(field, rowIndex));\n\n      const fieldDisplay = field.display?.(value) ?? { text: `${value}`, numeric: +value };\n\n      items.push({\n        label: field.state?.displayName ?? field.name,\n        value: formattedValueToString(fieldDisplay),\n      });\n    });\n\n    return (\n      <div\n        className={cx(styles.tooltipWrapper, isLocked && styles.pinned)}\n        ref={refs.setFloating}\n        style={floatingStyles}\n        {...getFloatingProps()}\n      >\n        {isLocked && <CloseButton onClick={onClose} />}\n        <ExemplarTooltip items={items} links={links} isPinned={isLocked} maxHeight={maxHeight} />\n      </div>\n    );\n  }, [\n    dataFrame.fields,\n    rowIndex,\n    styles,\n    isLocked,\n    setClickedRowIndex,\n    floatingStyles,\n    getFloatingProps,\n    refs.setFloating,\n    maxHeight,\n  ]);\n\n  const seriesColor = config.getSeries().find((s) => s.props.dataFrameFieldIndex?.frameIndex === frameIndex)\n    ?.props.lineColor;\n\n  const onExemplarClick = () => {\n    setClickedRowIndex(rowIndex);\n    lockExemplarModal();\n  };\n\n  return (\n    <>\n      <div\n        ref={refs.setReference}\n        className={styles.markerWrapper}\n        data-testid={selectors.components.DataSource.Prometheus.exemplarMarker}\n        role=\"button\"\n        tabIndex={0}\n        {...getReferenceProps()}\n        onClick={onExemplarClick}\n        onKeyDown={(e: React.KeyboardEvent) => {\n          if (e.key === 'Enter') {\n            onExemplarClick();\n          }\n        }}\n      >\n        <svg\n          viewBox=\"0 0 7 7\"\n          width=\"7\"\n          height=\"7\"\n          style={{ fill: seriesColor }}\n          className={cx(styles.marble, (isOpen || isLocked) && styles.activeMarble)}\n        >\n          {getSymbol()}\n        </svg>\n      </div>\n      {(isOpen || isLocked) && <Portal>{renderMarker()}</Portal>}\n    </>\n  );\n};\n\nconst getExemplarMarkerStyles = (theme: GrafanaTheme2, maxWidth: number | undefined) => {\n  return {\n    markerWrapper: css({\n      padding: '0 4px 4px 4px',\n      width: '8px',\n      height: '8px',\n      boxSizing: 'content-box',\n      transform: 'translate3d(-50%, 0, 0)',\n      '&:hover': {\n        '> svg': {\n          transform: 'scale(1.3)',\n          opacity: 1,\n          filter: 'drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))',\n        },\n      },\n    }),\n    marker: css({\n      width: 0,\n      height: 0,\n      borderLeft: '4px solid transparent',\n      borderRight: '4px solid transparent',\n      borderBottom: `4px solid ${theme.v1.palette.red}`,\n      pointerEvents: 'none',\n    }),\n    marble: css({\n      display: 'block',\n      opacity: 0.5,\n      [theme.transitions.handleMotion('no-preference')]: {\n        transition: 'transform 0.15s ease-out',\n      },\n    }),\n    activeMarble: css({\n      transform: 'scale(1.3)',\n      opacity: 1,\n      filter: 'drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))',\n    }),\n    tooltipWrapper: css({\n      background: theme.colors.background.elevated,\n      maxWidth: maxWidth ?? 'none',\n      whiteSpace: 'pre',\n      borderRadius: theme.shape.radius.default,\n      position: 'fixed',\n      border: `1px solid ${theme.colors.border.weak}`,\n      boxShadow: theme.shadows.z2,\n      userSelect: 'text',\n    }),\n    pinned: css({\n      boxShadow: theme.shadows.z3,\n    }),\n  };\n};\n","import { ReactNode, useCallback, useLayoutEffect, useRef, useState } from 'react';\nimport uPlot from 'uplot';\n\nimport { DataFrame, Labels, TIME_SERIES_TIME_FIELD_NAME, TIME_SERIES_VALUE_FIELD_NAME, TimeZone } from '@grafana/data';\nimport { FIXED_UNIT, EventsCanvas, UPlotConfigBuilder } from '@grafana/ui';\n\nimport { ExemplarMarker } from './ExemplarMarker';\n\ninterface ExemplarsPluginProps {\n  config: UPlotConfigBuilder;\n  exemplars: DataFrame[];\n  timeZone: TimeZone;\n  visibleSeries?: VisibleExemplarLabels;\n  maxHeight?: number;\n  maxWidth?: number;\n}\n\nexport const ExemplarsPlugin = ({\n  exemplars,\n  timeZone,\n  config,\n  visibleSeries,\n  maxHeight,\n  maxWidth,\n}: ExemplarsPluginProps) => {\n  const plotInstance = useRef<uPlot>();\n\n  const [lockedExemplarRowIndex, setLockedExemplarRowIndex] = useState<number | undefined>();\n\n  useLayoutEffect(() => {\n    config.addHook('init', (u) => {\n      plotInstance.current = u;\n    });\n  }, [config]);\n\n  const mapExemplarToXYCoords = useCallback((dataFrame: DataFrame, rowIndex: number) => {\n    const time = dataFrame.fields.find((f) => f.name === TIME_SERIES_TIME_FIELD_NAME);\n    const value = dataFrame.fields.find((f) => f.name === TIME_SERIES_VALUE_FIELD_NAME);\n\n    if (!time || !value || !plotInstance.current) {\n      return undefined;\n    }\n\n    // Filter x, y scales out\n    const yScale =\n      Object.keys(plotInstance.current.scales).find((scale) => !['x', 'y'].some((key) => key === scale)) ?? FIXED_UNIT;\n\n    const yMin = plotInstance.current.scales[yScale].min;\n    const yMax = plotInstance.current.scales[yScale].max;\n\n    let y = value.values[rowIndex];\n    // To not to show exemplars outside of the graph we set the y value to min if it is smaller and max if it is bigger than the size of the graph\n    if (yMin != null && y < yMin) {\n      y = yMin;\n    }\n\n    if (yMax != null && y > yMax) {\n      y = yMax;\n    }\n\n    return {\n      x: plotInstance.current.valToPos(time.values[rowIndex], 'x'),\n      y: plotInstance.current.valToPos(y, yScale),\n    };\n  }, []);\n\n  const renderMarker = useCallback(\n    (dataFrame: DataFrame, rowIndex: number): ReactNode => {\n      const showMarker = visibleSeries !== undefined ? showExemplarMarker(visibleSeries, dataFrame, rowIndex) : true;\n\n      const markerColor =\n        visibleSeries !== undefined ? getExemplarColor(dataFrame, rowIndex, visibleSeries) : undefined;\n\n      if (!showMarker) {\n        return <></>;\n      }\n\n      return (\n        <ExemplarMarker\n          setClickedRowIndex={setLockedExemplarRowIndex}\n          clickedRowIndex={lockedExemplarRowIndex}\n          timeZone={timeZone}\n          dataFrame={dataFrame}\n          frameIndex={0}\n          rowIndex={rowIndex}\n          config={config}\n          exemplarColor={markerColor}\n          maxHeight={maxHeight}\n          maxWidth={maxWidth}\n        />\n      );\n    },\n    [visibleSeries, lockedExemplarRowIndex, timeZone, config, maxHeight, maxWidth]\n  );\n\n  return (\n    <EventsCanvas\n      config={config}\n      id=\"exemplars\"\n      events={exemplars}\n      renderEventMarker={renderMarker}\n      mapEventToXYCoords={mapExemplarToXYCoords}\n    />\n  );\n};\n\nexport type VisibleExemplarLabels = { labels: LabelWithExemplarUIData[]; totalSeriesCount: number };\n/**\n * Get labels that are currently visible/active in the legend\n */\nexport const getVisibleLabels = (config: UPlotConfigBuilder, frames: DataFrame[] | null): VisibleExemplarLabels => {\n  const visibleSeries = config.series.filter((series) => series.props.show);\n  const visibleLabels: LabelWithExemplarUIData[] = [];\n  if (frames?.length) {\n    visibleSeries.forEach((plotInstance) => {\n      const frameIndex = plotInstance.props?.dataFrameFieldIndex?.frameIndex;\n      const fieldIndex = plotInstance.props?.dataFrameFieldIndex?.fieldIndex;\n\n      if (frameIndex !== undefined && fieldIndex !== undefined) {\n        const field = frames[frameIndex]?.fields[fieldIndex];\n        if (field?.labels) {\n          // Note that this may be an empty object in the case of a metric being rendered with no labels\n          visibleLabels.push({\n            labels: field.labels,\n            color: plotInstance.props?.lineColor ?? '',\n          });\n        }\n      }\n    });\n  }\n\n  return { labels: visibleLabels, totalSeriesCount: config.series.length };\n};\n\ninterface LabelWithExemplarUIData {\n  labels: Labels;\n  color?: string;\n}\n\n/**\n * Get color of active series in legend\n */\nconst getExemplarColor = (dataFrame: DataFrame, rowIndex: number, visibleLabels: VisibleExemplarLabels) => {\n  let exemplarColor;\n  visibleLabels.labels.some((visibleLabel) => {\n    const labelKeys = Object.keys(visibleLabel.labels);\n    const fields = dataFrame.fields.filter((field) => {\n      return labelKeys.find((labelKey) => labelKey === field.name);\n    });\n    if (fields.length) {\n      const hasMatch = fields.every((field, index, fields) => {\n        const value = field.values[rowIndex];\n        return visibleLabel.labels[field.name] === value;\n      });\n\n      if (hasMatch) {\n        exemplarColor = visibleLabel.color;\n        return true;\n      }\n    }\n    return false;\n  });\n  return exemplarColor;\n};\n\n/**\n * Determine if the current exemplar marker is filtered by what series are selected in the legend UI\n */\nconst showExemplarMarker = (visibleSeries: VisibleExemplarLabels, dataFrame: DataFrame, rowIndex: number) => {\n  let showMarker = false;\n  // If all series are visible, don't filter any exemplars\n  if (visibleSeries.labels.length === visibleSeries.totalSeriesCount) {\n    showMarker = true;\n  } else {\n    visibleSeries.labels.some((visibleLabel) => {\n      // Get the label names\n      const labelKeys = Object.keys(visibleLabel.labels);\n\n      // If there aren't any labels, the graph is only displaying a single series with exemplars, let's show all exemplars in this case as well\n      if (Object.keys(visibleLabel.labels).length === 0) {\n        showMarker = true;\n      } else {\n        // If there are labels, lets only show the exemplars with labels associated with series that are currently visible\n        const fields = dataFrame.fields.filter((field) => {\n          return labelKeys.find((labelKey) => labelKey === field.name);\n        });\n\n        if (fields.length) {\n          // Check to see if at least one value matches each field\n          showMarker = visibleSeries.labels.some((series) => {\n            return Object.keys(series.labels).every((label) => {\n              const value = series.labels[label];\n              return fields.find((field) => field.values[rowIndex] === value);\n            });\n          });\n        }\n      }\n      return showMarker;\n    });\n  }\n  return showMarker;\n};\n","import { css } from '@emotion/css';\nimport { noop } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport Draggable, { DraggableBounds } from 'react-draggable';\n\nimport { Threshold, GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2, useTheme2 } from '@grafana/ui';\n\ntype OutOfBounds = 'top' | 'bottom' | 'none';\n\ninterface ThresholdDragHandleProps {\n  step: Threshold;\n  y: number;\n  dragBounds: DraggableBounds;\n  mapPositionToValue: (y: number) => number;\n  onChange?: (value: number) => void;\n  formatValue: (value: number) => string;\n}\n\nexport const ThresholdDragHandle = ({\n  step,\n  y,\n  dragBounds,\n  mapPositionToValue,\n  formatValue,\n  onChange,\n}: ThresholdDragHandleProps) => {\n  const theme = useTheme2();\n  let yPos = y;\n  let outOfBounds: OutOfBounds = 'none';\n\n  if (y < (dragBounds.top ?? 0)) {\n    outOfBounds = 'top';\n  }\n\n  // there seems to be a 22px offset at the bottom where the threshold line is still drawn\n  // this is probably offset by the size of the x-axis component\n  if (y > (dragBounds.bottom ?? 0) + 22) {\n    outOfBounds = 'bottom';\n  }\n\n  if (outOfBounds === 'bottom') {\n    yPos = dragBounds.bottom ?? y;\n  }\n\n  if (outOfBounds === 'top') {\n    yPos = dragBounds.top ?? y;\n  }\n\n  const disabled = typeof onChange !== 'function';\n  const styles = useStyles2(getStyles, step, outOfBounds, disabled);\n  const [currentValue, setCurrentValue] = useState(step.value);\n\n  const textColor = useMemo(() => {\n    return theme.colors.getContrastText(theme.visualization.getColorByName(step.color));\n  }, [step.color, theme]);\n\n  return (\n    <Draggable\n      axis=\"y\"\n      grid={[1, 1]}\n      disabled={disabled}\n      onStop={\n        disabled\n          ? noop\n          : (_e, d) => {\n              onChange(mapPositionToValue(d.lastY));\n              // as of https://github.com/react-grid-layout/react-draggable/issues/390#issuecomment-623237835\n              return false;\n            }\n      }\n      onDrag={(_e, d) => setCurrentValue(mapPositionToValue(d.lastY))}\n      position={{ x: 0, y: yPos }}\n      bounds={dragBounds}\n    >\n      <div className={styles.handle} style={{ color: textColor }}>\n        <span className={styles.handleText}>{formatValue(currentValue)}</span>\n      </div>\n    </Draggable>\n  );\n};\n\nThresholdDragHandle.displayName = 'ThresholdDragHandle';\n\nconst getStyles = (theme: GrafanaTheme2, step: Threshold, outOfBounds: OutOfBounds, disabled?: boolean) => {\n  const mainColor = theme.visualization.getColorByName(step.color);\n  const arrowStyles = getArrowStyles(outOfBounds);\n  const isOutOfBounds = outOfBounds !== 'none';\n\n  return {\n    handle: css(\n      {\n        display: 'flex',\n        alignItems: 'center',\n        position: 'absolute',\n        left: 0,\n        width: 'calc(100% - 9px)',\n        height: '18px',\n        marginTop: '-9px',\n        borderColor: mainColor,\n        cursor: disabled ? 'initial' : 'grab',\n        borderTopRightRadius: theme.shape.radius.default,\n        borderBottomRightRadius: theme.shape.radius.default,\n        background: mainColor,\n        fontSize: theme.typography.bodySmall.fontSize,\n        '&:before': arrowStyles,\n      },\n      isOutOfBounds && {\n        marginTop: 0,\n        borderRadius: theme.shape.radius.default,\n      }\n    ),\n    handleText: css({\n      textAlign: 'center',\n      width: '100%',\n      display: 'block',\n      textOverflow: 'ellipsis',\n      whiteSpace: 'nowrap',\n      overflow: 'hidden',\n    }),\n  };\n};\n\nfunction getArrowStyles(outOfBounds: OutOfBounds) {\n  const inBounds = outOfBounds === 'none';\n\n  const triangle = (size: number) =>\n    ({\n      content: \"''\",\n      position: 'absolute',\n\n      bottom: 0,\n      top: 0,\n      width: 0,\n      height: 0,\n      left: 0,\n\n      borderRightStyle: 'solid',\n      borderRightWidth: `${size}px`,\n      borderRightColor: 'inherit',\n      borderTop: `${size}px solid transparent`,\n      borderBottom: `${size}px solid transparent`,\n    }) as const;\n\n  if (inBounds) {\n    return css({\n      ...triangle(9),\n      left: '-9px',\n    });\n  }\n\n  if (outOfBounds === 'top') {\n    return css({\n      ...triangle(5),\n      left: 'calc(50% - 2.5px)',\n      top: '-7px',\n      transform: 'rotate(90deg)',\n    });\n  }\n\n  if (outOfBounds === 'bottom') {\n    return css({\n      ...triangle(5),\n      left: 'calc(50% - 2.5px)',\n      top: 'calc(100% - 2.5px)',\n      transform: 'rotate(-90deg)',\n    });\n  }\n\n  return '';\n}\n","import { useState, useLayoutEffect, useMemo, useRef } from 'react';\nimport uPlot from 'uplot';\n\nimport { FieldConfigSource, ThresholdsConfig, getValueFormat, FieldType } from '@grafana/data';\nimport { UPlotConfigBuilder } from '@grafana/ui';\nimport { buildScaleKey } from '@grafana/ui/internal';\n\nimport { ThresholdDragHandle } from './ThresholdDragHandle';\n\nconst GUTTER_SIZE = 60;\n\ninterface ThresholdControlsPluginProps {\n  config: UPlotConfigBuilder;\n  fieldConfig: FieldConfigSource;\n  onThresholdsChange?: (thresholds: ThresholdsConfig) => void;\n}\n\nexport const ThresholdControlsPlugin = ({ config, fieldConfig, onThresholdsChange }: ThresholdControlsPluginProps) => {\n  const plotInstance = useRef<uPlot>();\n  const [renderToken, setRenderToken] = useState(0);\n\n  useLayoutEffect(() => {\n    config.setPadding([0, GUTTER_SIZE, 0, 0]);\n\n    config.addHook('init', (u) => {\n      plotInstance.current = u;\n    });\n    // render token required to re-render handles when resizing uPlot\n    config.addHook('draw', () => {\n      setRenderToken((s) => s + 1);\n    });\n  }, [config]);\n\n  const thresholdHandles = useMemo(() => {\n    const plot = plotInstance.current;\n\n    if (!plot) {\n      return null;\n    }\n    const thresholds = fieldConfig.defaults.thresholds;\n    if (!thresholds) {\n      return null;\n    }\n    const scale = buildScaleKey(fieldConfig.defaults, FieldType.number);\n\n    const decimals = fieldConfig.defaults.decimals;\n    const handles = [];\n\n    for (let i = 0; i < thresholds.steps.length; i++) {\n      const step = thresholds.steps[i];\n      const yPos = plot.valToPos(step.value, scale);\n\n      if (Number.isNaN(yPos) || !Number.isFinite(yPos)) {\n        continue;\n      }\n\n      const height = plot.bbox.height / window.devicePixelRatio;\n\n      const isEditable = typeof onThresholdsChange === 'function';\n\n      const onChange = isEditable\n        ? (value: number) => {\n            const nextSteps = [\n              ...thresholds.steps.slice(0, i),\n              ...thresholds.steps.slice(i + 1),\n              { ...thresholds.steps[i], value },\n            ].sort((a, b) => a.value - b.value);\n\n            onThresholdsChange({\n              ...thresholds,\n              steps: nextSteps,\n            });\n          }\n        : undefined;\n\n      const handle = (\n        <ThresholdDragHandle\n          key={`${step.value}-${i}`}\n          step={step}\n          y={yPos}\n          dragBounds={{ top: 0, bottom: height }}\n          mapPositionToValue={(y) => plot.posToVal(y, scale)}\n          formatValue={(v) => getValueFormat(scale)(v, decimals).text}\n          onChange={onChange}\n        />\n      );\n\n      handles.push(handle);\n    }\n\n    return handles;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [renderToken, fieldConfig, onThresholdsChange]);\n\n  if (!plotInstance.current) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        overflow: 'visible',\n        left: `${(plotInstance.current.bbox.left + plotInstance.current.bbox.width) / window.devicePixelRatio}px`,\n        top: `${plotInstance.current.bbox.top / window.devicePixelRatio}px`,\n        width: `${GUTTER_SIZE}px`,\n        height: `${plotInstance.current.bbox.height / window.devicePixelRatio}px`,\n      }}\n    >\n      {thresholdHandles}\n    </div>\n  );\n};\n\nThresholdControlsPlugin.displayName = 'ThresholdControlsPlugin';\n","import { LinkModel } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport {\n  VizTooltipContent,\n  VizTooltipFooter,\n  VizTooltipItem,\n  VizTooltipHeader,\n  VizTooltipWrapper,\n} from '@grafana/ui/internal';\n\nexport interface Props {\n  items: VizTooltipItem[];\n  links?: LinkModel[];\n  isPinned: boolean;\n  maxHeight?: number;\n}\n\nexport const ExemplarTooltip = ({ items, links, isPinned, maxHeight }: Props) => {\n  const timeItem = items.find((val) => val.label === 'Time');\n\n  return (\n    <VizTooltipWrapper>\n      <VizTooltipHeader\n        item={{\n          label: t('exemplar-tooltip-header', 'Exemplar'),\n          value: timeItem?.value ?? '',\n        }}\n        isPinned={isPinned}\n      />\n      <VizTooltipContent\n        items={items.filter((item) => item !== timeItem)}\n        isPinned={isPinned}\n        maxHeight={maxHeight}\n        scrollable={maxHeight != null}\n      />\n      <VizTooltipFooter dataLinks={links ?? []} />\n    </VizTooltipWrapper>\n  );\n};\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\nexport enum VizDisplayMode {\n  Candles = 'candles',\n  CandlesVolume = 'candles+volume',\n  Volume = 'volume',\n}\n\nexport enum CandleStyle {\n  Candles = 'candles',\n  OHLCBars = 'ohlcbars',\n}\n\nexport enum ColorStrategy {\n  CloseClose = 'close-close',\n  OpenClose = 'open-close',\n}\n\nexport interface CandlestickFieldMap {\n  /**\n   * Corresponds to the final (end) value of the given period\n   */\n  close?: string;\n  /**\n   * Corresponds to the highest value of the given period\n   */\n  high?: string;\n  /**\n   * Corresponds to the lowest value of the given period\n   */\n  low?: string;\n  /**\n   * Corresponds to the starting value of the given period\n   */\n  open?: string;\n  /**\n   * Corresponds to the sample count in the given period. (e.g. number of trades)\n   */\n  volume?: string;\n}\n\nexport interface CandlestickColors {\n  down: string;\n  flat: string;\n  up: string;\n}\n\nexport const defaultCandlestickColors: Partial<CandlestickColors> = {\n  down: 'red',\n  flat: 'gray',\n  up: 'green',\n};\n\nexport interface Options extends common.OptionsWithLegend, common.OptionsWithTooltip {\n  /**\n   * Sets the style of the candlesticks\n   */\n  candleStyle: CandleStyle;\n  /**\n   * Sets the color strategy for the candlesticks\n   */\n  colorStrategy: ColorStrategy;\n  /**\n   * Set which colors are used when the price movement is up or down\n   */\n  colors: CandlestickColors;\n  /**\n   * Map fields to appropriate dimension\n   */\n  fields: CandlestickFieldMap;\n  /**\n   * When enabled, all fields will be sent to the graph\n   */\n  includeAllFields?: boolean;\n  /**\n   * Sets which dimensions are used for the visualization\n   */\n  mode: VizDisplayMode;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  candleStyle: CandleStyle.Candles,\n  colorStrategy: ColorStrategy.OpenClose,\n  colors: {\n    down: 'red',\n    up: 'green',\n    flat: 'gray',\n  },\n  fields: {},\n  includeAllFields: false,\n  mode: VizDisplayMode.CandlesVolume,\n};\n\nexport interface FieldConfig extends common.GraphFieldConfig {}\n","import { LegendDisplayMode, SortOrder, TooltipDisplayMode } from '@grafana/schema';\n\nimport {\n  defaultOptions as defaultOptionsBase,\n  defaultCandlestickColors,\n  Options,\n  CandlestickColors,\n  CandleStyle,\n  ColorStrategy,\n  VizDisplayMode,\n  CandlestickFieldMap,\n  FieldConfig,\n} from './panelcfg.gen';\n\nexport const defaultOptions: Partial<Options> = {\n  ...defaultOptionsBase,\n  // TODO: This should be included in the cue schema in the future.\n  legend: {\n    displayMode: LegendDisplayMode.List,\n    showLegend: true,\n    placement: 'bottom',\n    calcs: [],\n  },\n  tooltip: {\n    mode: TooltipDisplayMode.Multi,\n    sort: SortOrder.None,\n  },\n};\n\nexport {\n  type Options,\n  type CandlestickColors,\n  defaultCandlestickColors,\n  CandleStyle,\n  ColorStrategy,\n  VizDisplayMode,\n  type CandlestickFieldMap,\n  type FieldConfig,\n};\n","import {\n  DataFrame,\n  Field,\n  FieldType,\n  getFieldDisplayName,\n  GrafanaTheme2,\n  outerJoinDataFrames,\n  TimeRange,\n} from '@grafana/data';\nimport { maybeSortFrame } from '@grafana/data/internal';\nimport { t } from '@grafana/i18n';\nimport { findField } from 'app/features/dimensions/utils';\n\nimport { prepareGraphableFields } from '../timeseries/utils';\n\nimport { Options, CandlestickFieldMap, VizDisplayMode } from './types';\n\nexport interface FieldPickerInfo {\n  /** property name */\n  key: keyof CandlestickFieldMap;\n\n  /** The display name */\n  name: string;\n\n  /** by default pick these fields */\n  defaults: string[];\n\n  /** How is the field used */\n  description: string;\n}\n\nexport const getCandlestickFieldsInfo: () => Record<keyof CandlestickFieldMap, FieldPickerInfo> = () => {\n  return {\n    open: {\n      key: 'open',\n      name: t('candlestick.name-open', 'Open'),\n      defaults: ['open', 'o'],\n      description: t('candlestick.description-open', 'Value at the start of the period'),\n    },\n    high: {\n      key: 'high',\n      name: t('candlestick.name-high', 'High'),\n      defaults: ['high', 'h', 'max'],\n      description: t('candlestick.description-high', 'Maximum value within the period'),\n    },\n    low: {\n      key: 'low',\n      name: t('candlestick.name-low', 'Low'),\n      defaults: ['low', 'l', 'min'],\n      description: t('candlestick.description-low', 'Minimum value within the period'),\n    },\n    close: {\n      key: 'close',\n      name: t('candlestick.name-close', 'Close'),\n      defaults: ['close', 'c'],\n      description: t('candlestick.description-close', 'Value at the end of the period'),\n    },\n    volume: {\n      key: 'volume',\n      name: t('candlestick.name-volume', 'Volume'),\n      defaults: ['volume', 'v'],\n      description: t('candlestick.description-volume', 'Sample count within the period'),\n    },\n  };\n};\n\nexport interface CandlestickData {\n  autoOpenClose?: boolean;\n\n  // Special fields\n  open?: Field;\n  high?: Field;\n  low?: Field;\n  close?: Field;\n  volume?: Field;\n\n  // All incoming values\n  aligned: DataFrame;\n\n  // The stuff passed to GraphNG\n  frame: DataFrame;\n\n  // The real names used\n  names: CandlestickFieldMap;\n}\n\nfunction findFieldOrAuto(frame: DataFrame, info: FieldPickerInfo, options: CandlestickFieldMap): Field | undefined {\n  const field = findField(frame, options[info.key]);\n  if (!field) {\n    for (const field of frame.fields) {\n      const name = getFieldDisplayName(field, frame).toLowerCase();\n      if (info.defaults.includes(name) || info.defaults.includes(field.name)) {\n        return field;\n      }\n    }\n  }\n  return field;\n}\n\nexport function prepareCandlestickFields(\n  series: DataFrame[] | undefined,\n  options: Partial<Options>,\n  theme: GrafanaTheme2,\n  timeRange?: TimeRange\n): CandlestickData | null {\n  if (!series?.length) {\n    return null;\n  }\n  const candlestickFieldsInfo = getCandlestickFieldsInfo();\n\n  // All fields\n  const fieldMap = options.fields ?? {};\n  const aligned =\n    series.length === 1\n      ? maybeSortFrame(\n          series[0],\n          series[0].fields.findIndex((f) => f.type === FieldType.time)\n        )\n      : outerJoinDataFrames({ frames: series });\n  if (!aligned?.length) {\n    return null;\n  }\n\n  const data: CandlestickData = { aligned, frame: aligned, names: {} };\n\n  // Apply same filter as everything else in timeseries\n  const timeSeriesFrames = prepareGraphableFields([aligned], theme, timeRange);\n  if (!timeSeriesFrames) {\n    return null;\n  }\n\n  const frame = (data.frame = timeSeriesFrames[0]);\n  const timeIndex = frame.fields.findIndex((f) => f.type === FieldType.time);\n\n  if (timeIndex < 0) {\n    return null;\n  }\n\n  // Find the known fields\n  const used = new Set<Field>();\n  for (const info of Object.values(candlestickFieldsInfo)) {\n    const field = findFieldOrAuto(frame, info, fieldMap);\n    if (field) {\n      data[info.key] = field;\n      used.add(field);\n    }\n  }\n\n  // Use first numeric value as open\n  if (!data.open && !data.close) {\n    data.open = frame.fields.find((f) => f.type === FieldType.number);\n    if (data.open) {\n      used.add(data.open);\n    }\n  }\n\n  // Use next open as 'close' value\n  if (data.open && !data.close && !fieldMap.close) {\n    const values = data.open.values.slice(1);\n    values.push(values[values.length - 1]); // duplicate last value\n    data.close = {\n      ...data.open,\n      values: values,\n      name: 'Next open',\n      state: undefined,\n    };\n    used.add(data.close);\n    frame.fields.push(data.close);\n    data.autoOpenClose = true;\n  }\n\n  // Use previous close as 'open' value\n  if (data.close && !data.open && !fieldMap.open) {\n    const values = data.close.values.slice();\n    values.unshift(values[0]); // duplicate first value\n    values.length = frame.length;\n    data.open = {\n      ...data.close,\n      values: values,\n      name: 'Previous close',\n      state: undefined,\n    };\n    used.add(data.open);\n    frame.fields.push(data.open);\n    data.autoOpenClose = true;\n  }\n\n  // Use the open field for min/max if nothing is set\n  if (!data.high && !fieldMap.high) {\n    data.high = data.open;\n  }\n  if (!data.low && !fieldMap.low) {\n    data.low = data.open;\n  }\n\n  // unmap low and high fields in volume-only mode, and volume field in candles-only mode\n  // so they fall through to unmapped fields and get appropriate includeAllFields treatment\n  if (options.mode === VizDisplayMode.Volume) {\n    if (data.high) {\n      if (data.high !== data.open) {\n        used.delete(data.high);\n      }\n      data.high = undefined;\n    }\n    if (data.low) {\n      if (data.low !== data.open) {\n        used.delete(data.low);\n      }\n      data.low = undefined;\n    }\n  } else if (options.mode === VizDisplayMode.Candles) {\n    if (data.volume) {\n      used.delete(data.volume);\n      data.volume = undefined;\n    }\n  }\n\n  // Register the name of each mapped field\n  for (const info of Object.values(candlestickFieldsInfo)) {\n    const f = data[info.key];\n    if (f) {\n      data.names[info.key] = getFieldDisplayName(f, data.frame);\n    }\n  }\n\n  const timeField = frame.fields[timeIndex];\n\n  // Make sure first field is time!\n  const fields: Field[] = [timeField];\n\n  if (!options.includeAllFields) {\n    fields.push(...used);\n  } else {\n    fields.push(...frame.fields.filter((f) => f !== timeField));\n  }\n\n  data.frame = {\n    ...data.frame,\n    fields,\n  };\n\n  // Force update all the indicies\n  for (let i = 0; i < data.frame.fields.length; i++) {\n    const field = data.frame.fields[i];\n\n    field.state = {\n      ...field.state,\n\n      // time is unused (-1), y series enumerate from 0\n      seriesIndex: i - 1,\n\n      origin: {\n        fieldIndex: i,\n        frameIndex: 0,\n      },\n    };\n  }\n\n  return data;\n}\n","import uPlot from 'uplot';\n\nimport { colorManipulator } from '@grafana/data';\n\nimport { VizDisplayMode, ColorStrategy, CandleStyle } from './types';\n\nconst { alpha } = colorManipulator;\n\nexport type FieldIndices = Record<string, number>;\n\ninterface RendererOpts {\n  mode: VizDisplayMode;\n  candleStyle: CandleStyle;\n  fields: FieldIndices;\n  colorStrategy: ColorStrategy;\n  upColor: string;\n  downColor: string;\n  flatColor: string;\n  volumeAlpha: number;\n  flatAsUp: boolean;\n}\n\nexport function drawMarkers(opts: RendererOpts) {\n  let { mode, candleStyle, fields, colorStrategy, upColor, downColor, flatColor, volumeAlpha, flatAsUp = true } = opts;\n\n  const drawPrice = mode !== VizDisplayMode.Volume && fields.high != null && fields.low != null;\n  const asCandles = drawPrice && candleStyle === CandleStyle.Candles;\n  const drawVolume = mode !== VizDisplayMode.Candles && fields.volume != null;\n\n  function selectPath(priceDir: number, flatPath: Path2D, upPath: Path2D, downPath: Path2D, flatAsUp: boolean) {\n    return priceDir > 0 ? upPath : priceDir < 0 ? downPath : flatAsUp ? upPath : flatPath;\n  }\n\n  let tIdx = 0,\n    oIdx = fields.open,\n    hIdx = fields.high,\n    lIdx = fields.low,\n    cIdx = fields.close,\n    vIdx = fields.volume;\n\n  return (u: uPlot) => {\n    // split by discrete color to reduce draw calls\n    let downPath, upPath, flatPath;\n    // with adjusted reduced\n    let downPathVol, upPathVol, flatPathVol;\n\n    if (drawPrice) {\n      flatPath = new Path2D();\n      upPath = new Path2D();\n      downPath = new Path2D();\n    }\n\n    if (drawVolume) {\n      downPathVol = new Path2D();\n      upPathVol = new Path2D();\n      flatPathVol = new Path2D();\n    }\n\n    let hollowPath = new Path2D();\n\n    let ctx = u.ctx;\n\n    let tData = u.data[tIdx!];\n\n    let oData = u.data[oIdx!];\n    let cData = u.data[cIdx!];\n\n    let hData = drawPrice ? u.data[hIdx!] : null;\n    let lData = drawPrice ? u.data[lIdx!] : null;\n    let vData = drawVolume ? u.data[vIdx!] : null;\n\n    let zeroPx = vIdx != null ? Math.round(u.valToPos(0, u.series[vIdx!].scale!, true)) : null;\n\n    let [idx0, idx1] = u.series[0].idxs!;\n\n    let dataX = u.data[0];\n    let dataY = oData;\n\n    let colWidth = u.bbox.width;\n\n    if (dataX.length > 1) {\n      // prior index with non-undefined y data\n      let prevIdx = null;\n\n      // scan full dataset for smallest adjacent delta\n      // will not work properly for non-linear x scales, since does not do expensive valToPosX calcs till end\n      for (let i = 0, minDelta = Infinity; i < dataX.length; i++) {\n        if (dataY[i] !== undefined) {\n          if (prevIdx != null) {\n            let delta = Math.abs(dataX[i] - dataX[prevIdx]);\n\n            if (delta < minDelta) {\n              minDelta = delta;\n              colWidth = Math.abs(u.valToPos(dataX[i], 'x', true) - u.valToPos(dataX[prevIdx], 'x', true));\n            }\n          }\n\n          prevIdx = i;\n        }\n      }\n    }\n\n    let barWidth = Math.round(0.6 * colWidth);\n\n    let stickWidth = 2;\n    let outlineWidth = 2;\n\n    if (barWidth <= 12) {\n      stickWidth = outlineWidth = 1;\n    }\n\n    let halfWidth = Math.floor(barWidth / 2);\n\n    for (let i = idx0; i <= idx1; i++) {\n      let tPx = Math.round(u.valToPos(tData[i]!, 'x', true));\n\n      // current close vs prior close\n      let interDir = i === idx0 ? 0 : Math.sign(cData[i]! - cData[i - 1]!);\n      // current close vs current open\n      let intraDir = Math.sign(cData[i]! - oData[i]!);\n\n      // volume\n      if (drawVolume && flatPathVol && upPathVol && downPathVol) {\n        let outerPath = selectPath(\n          colorStrategy === ColorStrategy.CloseClose ? interDir : intraDir,\n          flatPathVol,\n          upPathVol,\n          downPathVol,\n          i === idx0 && ColorStrategy.CloseClose ? false : flatAsUp\n        );\n\n        let vPx = Math.round(u.valToPos(vData![i]!, u.series[vIdx!].scale!, true));\n        outerPath.rect(tPx - halfWidth, vPx, barWidth, zeroPx! - vPx);\n      }\n\n      if (drawPrice && flatPath && upPath && downPath) {\n        let outerPath = selectPath(\n          colorStrategy === ColorStrategy.CloseClose ? interDir : intraDir,\n          flatPath,\n          upPath,\n          downPath,\n          i === idx0 && ColorStrategy.CloseClose ? false : flatAsUp\n        );\n\n        // stick\n        let hPx = Math.round(u.valToPos(hData![i]!, u.series[hIdx!].scale!, true));\n        let lPx = Math.round(u.valToPos(lData![i]!, u.series[lIdx!].scale!, true));\n        outerPath.rect(tPx - Math.floor(stickWidth / 2), hPx, stickWidth, lPx - hPx);\n\n        let oPx = Math.round(u.valToPos(oData[i]!, u.series[oIdx!].scale!, true));\n        let cPx = Math.round(u.valToPos(cData[i]!, u.series[cIdx!].scale!, true));\n\n        if (asCandles) {\n          // rect\n          let top = Math.min(oPx, cPx);\n          let btm = Math.max(oPx, cPx);\n          let hgt = Math.max(1, btm - top);\n          outerPath.rect(tPx - halfWidth, top, barWidth, hgt);\n\n          if (colorStrategy === ColorStrategy.CloseClose) {\n            if (intraDir >= 0 && hgt > outlineWidth * 2) {\n              hollowPath.rect(\n                tPx - halfWidth + outlineWidth,\n                top + outlineWidth,\n                barWidth - outlineWidth * 2,\n                hgt - outlineWidth * 2\n              );\n            }\n          }\n        } else {\n          outerPath.rect(tPx - halfWidth, oPx, halfWidth, stickWidth);\n          outerPath.rect(tPx, cPx, halfWidth, stickWidth);\n        }\n      }\n    }\n\n    ctx.save();\n\n    ctx.rect(u.bbox.left, u.bbox.top, u.bbox.width, u.bbox.height);\n    ctx.clip();\n\n    if (drawVolume && flatPathVol && upPathVol && downPathVol) {\n      ctx.fillStyle = alpha(upColor, volumeAlpha);\n      ctx.fill(upPathVol);\n\n      ctx.fillStyle = alpha(downColor, volumeAlpha);\n      ctx.fill(downPathVol);\n\n      ctx.fillStyle = alpha(flatColor, volumeAlpha);\n      ctx.fill(flatPathVol);\n    }\n\n    if (drawPrice && flatPath && upPath && downPath) {\n      ctx.fillStyle = upColor;\n      ctx.fill(upPath);\n\n      ctx.fillStyle = downColor;\n      ctx.fill(downPath);\n\n      ctx.fillStyle = flatColor;\n      ctx.fill(flatPath);\n\n      ctx.globalCompositeOperation = 'destination-out';\n      ctx.fill(hollowPath);\n    }\n\n    ctx.restore();\n  };\n}\n","// this file is pretty much a copy-paste of TimeSeriesPanel.tsx :(\n// with some extra renderers passed to the <TimeSeries> component\n\nimport { useMemo, useState } from 'react';\nimport uPlot from 'uplot';\n\nimport { Field, getDisplayProcessor, PanelProps } from '@grafana/data';\nimport { PanelDataErrorView } from '@grafana/runtime';\nimport { DashboardCursorSync, TooltipDisplayMode } from '@grafana/schema';\nimport {\n  EventBusPlugin,\n  KeyboardPlugin,\n  TooltipPlugin2,\n  UPlotConfigBuilder,\n  usePanelContext,\n  useTheme2,\n} from '@grafana/ui';\nimport { AxisProps, ScaleProps, TimeRange2, TooltipHoverMode } from '@grafana/ui/internal';\nimport { TimeSeries } from 'app/core/components/TimeSeries/TimeSeries';\nimport { config } from 'app/core/config';\n\nimport { TimeSeriesTooltip } from '../timeseries/TimeSeriesTooltip';\nimport { AnnotationsPlugin2 } from '../timeseries/plugins/AnnotationsPlugin2';\nimport { ExemplarsPlugin } from '../timeseries/plugins/ExemplarsPlugin';\nimport { OutsideRangePlugin } from '../timeseries/plugins/OutsideRangePlugin';\nimport { ThresholdControlsPlugin } from '../timeseries/plugins/ThresholdControlsPlugin';\n\nimport { prepareCandlestickFields } from './fields';\nimport { Options, defaultCandlestickColors, VizDisplayMode } from './types';\nimport { drawMarkers, FieldIndices } from './utils';\n\ninterface CandlestickPanelProps extends PanelProps<Options> {}\n\nexport const CandlestickPanel = ({\n  data,\n  id,\n  timeRange,\n  timeZone,\n  width,\n  height,\n  options,\n  fieldConfig,\n  onChangeTimeRange,\n  replaceVariables,\n}: CandlestickPanelProps) => {\n  const {\n    sync,\n    eventsScope,\n    canAddAnnotations,\n    onThresholdsChange,\n    canEditThresholds,\n    showThresholds,\n    dataLinkPostProcessor,\n    eventBus,\n    canExecuteActions,\n  } = usePanelContext();\n\n  const userCanExecuteActions = useMemo(() => canExecuteActions?.() ?? false, [canExecuteActions]);\n\n  const theme = useTheme2();\n\n  const info = useMemo(() => {\n    return prepareCandlestickFields(data.series, options, theme, timeRange);\n  }, [data.series, options, theme, timeRange]);\n\n  // temp range set for adding new annotation set by TooltipPlugin2, consumed by AnnotationPlugin2\n  const [newAnnotationRange, setNewAnnotationRange] = useState<TimeRange2 | null>(null);\n  const cursorSync = sync?.() ?? DashboardCursorSync.Off;\n\n  const { renderers, tweakScale, tweakAxis, shouldRenderPrice } = useMemo(() => {\n    let tweakScale = (opts: ScaleProps, forField: Field) => opts;\n    let tweakAxis = (opts: AxisProps, forField: Field) => opts;\n\n    let doNothing = {\n      renderers: [],\n      tweakScale,\n      tweakAxis,\n      shouldRenderPrice: false,\n    };\n\n    if (!info) {\n      return doNothing;\n    }\n\n    // Un-encoding the already parsed special fields\n    // This takes currently matched fields and saves the name so they can be looked up by name later\n    // \\_()_/  someday this can make more sense!\n    const fieldMap = info.names;\n\n    if (!Object.keys(fieldMap).length) {\n      return doNothing;\n    }\n\n    const { mode, candleStyle, colorStrategy } = options;\n    const colors = { ...defaultCandlestickColors, ...options.colors };\n    let { open, high, low, close, volume } = fieldMap; // names from matched fields\n\n    if (open == null || close == null) {\n      return doNothing;\n    }\n\n    let volumeAlpha = 0.5;\n\n    let volumeIdx = -1;\n\n    let shouldRenderVolume = false;\n\n    // find volume field and set overrides\n    if (volume != null && mode !== VizDisplayMode.Candles) {\n      let volumeField = info.volume!;\n\n      if (volumeField != null) {\n        shouldRenderVolume = true;\n\n        let { fillOpacity } = volumeField.config.custom;\n\n        if (fillOpacity) {\n          volumeAlpha = fillOpacity / 100;\n        }\n\n        // we only want to put volume on own shorter axis when rendered with price\n        if (mode !== VizDisplayMode.Volume) {\n          volumeField.config = { ...volumeField.config };\n          volumeField.config.unit = 'short';\n          volumeField.display = getDisplayProcessor({\n            field: volumeField,\n            theme: config.theme2,\n          });\n\n          tweakAxis = (opts: AxisProps, forField: Field) => {\n            // we can't do forField === info.volume because of copies :(\n            if (forField.name === info.volume?.name) {\n              let filter = (u: uPlot, splits: number[]) => {\n                let _splits = [];\n                let max = u.series[volumeIdx].max;\n\n                for (let i = 0; i < splits.length; i++) {\n                  _splits.push(splits[i]);\n\n                  if (max && splits[i] > max) {\n                    break;\n                  }\n                }\n\n                return _splits;\n              };\n\n              opts.space = 20; // reduce tick spacing\n              opts.filter = filter; // hide tick labels\n              opts.ticks = { ...opts.ticks, filter }; // hide tick marks\n            }\n\n            return opts;\n          };\n\n          tweakScale = (opts: ScaleProps, forField: Field) => {\n            // we can't do forField === info.volume because of copies :(\n            if (forField.name === info.volume?.name) {\n              opts.range = (u: uPlot, min: number, max: number) => [0, max * 7];\n            }\n\n            return opts;\n          };\n        }\n      }\n    }\n\n    let shouldRenderPrice = mode !== VizDisplayMode.Volume && high != null && low != null;\n\n    if (!shouldRenderPrice && !shouldRenderVolume) {\n      return doNothing;\n    }\n\n    let fields: Record<string, string> = {};\n    let indicesOnly = [];\n\n    if (shouldRenderPrice) {\n      fields = { open, high: high!, low: low!, close };\n    } else {\n      // these fields should not be omitted from normal rendering if they arent rendered\n      // as part of price markers. they're only here so we can get back their indicies in the\n      // init callback below. TODO: remove this when field mapping happens in the panel instead of deep\n      indicesOnly.push(open, close);\n    }\n\n    if (shouldRenderVolume) {\n      fields.volume = volume!;\n      fields.open = open;\n      fields.close = close;\n    }\n\n    return {\n      shouldRenderPrice,\n      renderers: [\n        {\n          fieldMap: fields,\n          indicesOnly,\n          init: (builder: UPlotConfigBuilder, fieldIndices: FieldIndices) => {\n            volumeIdx = fieldIndices.volume!;\n\n            builder.addHook(\n              'drawAxes',\n              drawMarkers({\n                mode,\n                fields: fieldIndices,\n                upColor: config.theme2.visualization.getColorByName(colors.up),\n                downColor: config.theme2.visualization.getColorByName(colors.down),\n                flatColor: config.theme2.visualization.getColorByName(colors.flat),\n                volumeAlpha,\n                colorStrategy,\n                candleStyle,\n                flatAsUp: true,\n              })\n            );\n          },\n        },\n      ],\n      tweakScale,\n      tweakAxis,\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [options, data.structureRev, data.series.length]);\n\n  if (!info) {\n    return (\n      <PanelDataErrorView\n        panelId={id}\n        fieldConfig={fieldConfig}\n        data={data}\n        needsTimeField={true}\n        needsNumberField={true}\n      />\n    );\n  }\n\n  if (shouldRenderPrice) {\n    // hide series from legend that are rendered as composite markers\n    for (let key in renderers[0].fieldMap) {\n      let field: Field = (info as any)[key];\n      field.config = {\n        ...field.config,\n        custom: {\n          ...field.config.custom,\n          hideFrom: { legend: true, tooltip: false, viz: false },\n        },\n      };\n    }\n  }\n\n  const enableAnnotationCreation = Boolean(canAddAnnotations?.());\n\n  return (\n    <TimeSeries\n      frames={[info.frame]}\n      structureRev={data.structureRev}\n      timeRange={timeRange}\n      timeZone={timeZone}\n      width={width}\n      height={height}\n      legend={options.legend}\n      renderers={renderers}\n      tweakAxis={tweakAxis}\n      tweakScale={tweakScale}\n      options={options}\n      replaceVariables={replaceVariables}\n      dataLinkPostProcessor={dataLinkPostProcessor}\n      cursorSync={cursorSync}\n    >\n      {(uplotConfig, alignedFrame) => {\n        return (\n          <>\n            <KeyboardPlugin config={uplotConfig} />\n            {cursorSync !== DashboardCursorSync.Off && (\n              <EventBusPlugin config={uplotConfig} eventBus={eventBus} frame={alignedFrame} />\n            )}\n            {options.tooltip.mode !== TooltipDisplayMode.None && (\n              <TooltipPlugin2\n                config={uplotConfig}\n                hoverMode={\n                  options.tooltip.mode === TooltipDisplayMode.Single ? TooltipHoverMode.xOne : TooltipHoverMode.xAll\n                }\n                queryZoom={onChangeTimeRange}\n                clientZoom={true}\n                syncMode={cursorSync}\n                syncScope={eventsScope}\n                getDataLinks={(seriesIdx, dataIdx) =>\n                  alignedFrame.fields[seriesIdx].getLinks?.({ valueRowIndex: dataIdx }) ?? []\n                }\n                render={(u, dataIdxs, seriesIdx, isPinned = false, dismiss, timeRange2, viaSync, dataLinks) => {\n                  if (enableAnnotationCreation && timeRange2 != null) {\n                    setNewAnnotationRange(timeRange2);\n                    dismiss();\n                    return;\n                  }\n\n                  const annotate = () => {\n                    let xVal = u.posToVal(u.cursor.left!, 'x');\n\n                    setNewAnnotationRange({ from: xVal, to: xVal });\n                    dismiss();\n                  };\n\n                  return (\n                    <TimeSeriesTooltip\n                      series={alignedFrame}\n                      dataIdxs={dataIdxs}\n                      seriesIdx={seriesIdx}\n                      mode={viaSync ? TooltipDisplayMode.Multi : options.tooltip.mode}\n                      sortOrder={options.tooltip.sort}\n                      isPinned={isPinned}\n                      annotate={enableAnnotationCreation ? annotate : undefined}\n                      maxHeight={options.tooltip.maxHeight}\n                      replaceVariables={replaceVariables}\n                      dataLinks={dataLinks}\n                      canExecuteActions={userCanExecuteActions}\n                    />\n                  );\n                }}\n                maxWidth={options.tooltip.maxWidth}\n              />\n            )}\n            <AnnotationsPlugin2\n              annotations={data.annotations ?? []}\n              config={uplotConfig}\n              timeZone={timeZone}\n              newRange={newAnnotationRange}\n              setNewRange={setNewAnnotationRange}\n            />\n            <OutsideRangePlugin config={uplotConfig} onChangeTimeRange={onChangeTimeRange} />\n            {data.annotations && (\n              <ExemplarsPlugin\n                config={uplotConfig}\n                exemplars={data.annotations}\n                timeZone={timeZone}\n                maxHeight={options.tooltip.maxHeight}\n                maxWidth={options.tooltip.maxWidth}\n              />\n            )}\n            {((canEditThresholds && onThresholdsChange) || showThresholds) && (\n              <ThresholdControlsPlugin\n                config={uplotConfig}\n                fieldConfig={fieldConfig}\n                onThresholdsChange={canEditThresholds ? onThresholdsChange : undefined}\n              />\n            )}\n          </>\n        );\n      }}\n    </TimeSeries>\n  );\n};\n","import { VisualizationSuggestionsBuilder, VisualizationSuggestionScore } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { SuggestionName } from 'app/types/suggestions';\n\nimport { prepareCandlestickFields } from './fields';\nimport { defaultOptions, Options } from './types';\n\nexport class CandlestickSuggestionsSupplier {\n  getSuggestionsForData(builder: VisualizationSuggestionsBuilder) {\n    const { dataSummary } = builder;\n\n    if (\n      !builder.data?.series ||\n      !dataSummary.hasData ||\n      dataSummary.timeFieldCount < 1 ||\n      dataSummary.numberFieldCount < 2 ||\n      dataSummary.numberFieldCount > 10\n    ) {\n      return;\n    }\n\n    const info = prepareCandlestickFields(builder.data.series, defaultOptions, config.theme2);\n    if (!info) {\n      return;\n    }\n\n    // Regular timeseries\n    if (info.open === info.high && info.open === info.low) {\n      return;\n    }\n\n    const list = builder.getListAppender<Options, {}>({\n      name: '',\n      pluginId: 'candlestick',\n      options: {},\n      fieldConfig: {\n        defaults: {\n          custom: {},\n        },\n        overrides: [],\n      },\n    });\n\n    list.append({\n      name: SuggestionName.Candlestick,\n      options: defaultOptions,\n      fieldConfig: {\n        defaults: {},\n        overrides: [],\n      },\n      score: info.autoOpenClose ? VisualizationSuggestionScore.Good : VisualizationSuggestionScore.Best,\n    });\n  }\n}\n","import { Field, FieldType, getFieldDisplayName, PanelOptionsEditorBuilder, PanelPlugin } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { config } from '@grafana/runtime';\nimport { GraphFieldConfig } from '@grafana/schema';\nimport { commonOptionsBuilder } from '@grafana/ui';\n\nimport { defaultGraphConfig, getGraphFieldConfig } from '../timeseries/config';\n\nimport { CandlestickPanel } from './CandlestickPanel';\nimport { CandlestickData, getCandlestickFieldsInfo, FieldPickerInfo, prepareCandlestickFields } from './fields';\nimport { CandlestickSuggestionsSupplier } from './suggestions';\nimport { defaultCandlestickColors, defaultOptions, Options, VizDisplayMode, ColorStrategy, CandleStyle } from './types';\n\nconst numericFieldFilter = (f: Field) => f.type === FieldType.number;\n\nfunction addFieldPicker(\n  builder: PanelOptionsEditorBuilder<Options>,\n  info: FieldPickerInfo,\n  data: CandlestickData | null,\n  category?: string[]\n) {\n  let placeholderText = 'Auto ';\n\n  if (data) {\n    const current = data[info.key];\n\n    if (current?.config) {\n      placeholderText += '= ' + getFieldDisplayName(current);\n\n      if (current === data?.open && info.key !== 'open') {\n        placeholderText += ` (${info.defaults.join(',')})`;\n      }\n    } else {\n      placeholderText += `(${info.defaults.join(',')})`;\n    }\n  }\n\n  builder.addFieldNamePicker({\n    path: `fields.${info.key}`,\n    name: info.name,\n    description: info.description,\n    category,\n    settings: {\n      filter: numericFieldFilter,\n      placeholderText,\n    },\n  });\n}\n\nexport const plugin = new PanelPlugin<Options, GraphFieldConfig>(CandlestickPanel)\n  .useFieldConfig(getGraphFieldConfig(defaultGraphConfig))\n  .setPanelOptions((builder, context) => {\n    const category = [t('candlestick.category-candlestick', 'Candlestick')];\n    const opts = context.options ?? defaultOptions;\n    const info = prepareCandlestickFields(context.data, opts, config.theme2);\n    builder\n      .addRadio({\n        path: 'mode',\n        name: t('candlestick.name-mode', 'Mode'),\n        category,\n        description: '',\n        defaultValue: defaultOptions.mode,\n        settings: {\n          options: [\n            { label: t('candlestick.mode-options.label-candles', 'Candles'), value: VizDisplayMode.Candles },\n            { label: t('candlestick.mode-options.label-volume', 'Volume'), value: VizDisplayMode.Volume },\n            { label: t('candlestick.mode-options.label-both', 'Both'), value: VizDisplayMode.CandlesVolume },\n          ],\n        },\n      })\n      .addRadio({\n        path: 'candleStyle',\n        name: t('candlestick.name-candle-style', 'Candle style'),\n        category,\n        description: '',\n        defaultValue: defaultOptions.candleStyle,\n        settings: {\n          options: [\n            { label: t('candlestick.candle-style-options.label-candles', 'Candles'), value: CandleStyle.Candles },\n            { label: t('candlestick.candle-style-options.label-ohlc-bars', 'OHLC Bars'), value: CandleStyle.OHLCBars },\n          ],\n        },\n        showIf: (opts) => opts.mode !== VizDisplayMode.Volume,\n      })\n      .addRadio({\n        path: 'colorStrategy',\n        name: t('candlestick.name-color-strategy', 'Color strategy'),\n        category,\n        description: '',\n        defaultValue: defaultOptions.colorStrategy,\n        settings: {\n          options: [\n            {\n              label: t('candlestick.color-strategy-options.label-since-open', 'Since Open'),\n              value: ColorStrategy.OpenClose,\n            },\n            {\n              label: t('candlestick.color-strategy-options.label-since-prior-close', 'Since Prior Close'),\n              value: ColorStrategy.CloseClose,\n            },\n          ],\n        },\n      })\n      .addColorPicker({\n        path: 'colors.up',\n        name: t('candlestick.name-up-color', 'Up color'),\n        category,\n        defaultValue: defaultCandlestickColors.up,\n      })\n      .addColorPicker({\n        path: 'colors.down',\n        name: t('candlestick.name-down-color', 'Down color'),\n        category,\n        defaultValue: defaultCandlestickColors.down,\n      });\n\n    const candlestickFieldsInfo = getCandlestickFieldsInfo();\n    addFieldPicker(builder, candlestickFieldsInfo.open, info, category);\n    if (opts.mode !== VizDisplayMode.Volume) {\n      addFieldPicker(builder, candlestickFieldsInfo.high, info, category);\n      addFieldPicker(builder, candlestickFieldsInfo.low, info, category);\n    }\n    addFieldPicker(builder, candlestickFieldsInfo.close, info, category);\n\n    if (opts.mode !== VizDisplayMode.Candles) {\n      addFieldPicker(builder, candlestickFieldsInfo.volume, info, category);\n    }\n\n    builder.addRadio({\n      path: 'includeAllFields',\n      name: t('candlestick.name-additional-fields', 'Additional fields'),\n      category,\n      description: t(\n        'candlestick.description-additional-fields',\n        'Use standard timeseries options to configure any fields not mapped above'\n      ),\n      defaultValue: defaultOptions.includeAllFields,\n      settings: {\n        options: [\n          { label: t('candlestick.additional-fields-options.label-ignore', 'Ignore'), value: false },\n          { label: t('candlestick.additional-fields-options.label-include', 'Include'), value: true },\n        ],\n      },\n    });\n\n    commonOptionsBuilder.addTooltipOptions(builder, false, true);\n    commonOptionsBuilder.addLegendOptions(builder);\n  })\n  .setDataSupport({ annotations: true, alertStates: true })\n  .setSuggestionsSupplier(new CandlestickSuggestionsSupplier());\n"],"names":["ExemplarMarker","timeZone","dataFrame","frameIndex","rowIndex","config","exemplarColor","clickedRowIndex","setClickedRowIndex","maxHeight","maxWidth","styles","getExemplarMarkerStyles","isOpen","setIsOpen","isLocked","setIsLocked","middleware","context","refs","floatingStyles","dismiss","hover","getReferenceProps","getFloatingProps","getSymbol","lockExemplarModal","renderMarker","onClose","items","links","field","value","fieldDisplay","CloseButton","ExemplarTooltip","seriesColor","onExemplarClick","selectors","e","Portal","theme","ExemplarsPlugin","exemplars","visibleSeries","plotInstance","lockedExemplarRowIndex","setLockedExemplarRowIndex","u","mapExemplarToXYCoords","time","f","yScale","scale","key","yMin","yMax","y","showMarker","showExemplarMarker","markerColor","getExemplarColor","EventsCanvas","getVisibleLabels","frames","series","visibleLabels","fieldIndex","visibleLabel","labelKeys","fields","labelKey","index","label","ThresholdDragHandle","step","dragBounds","mapPositionToValue","formatValue","onChange","yPos","outOfBounds","disabled","getStyles","currentValue","setCurrentValue","textColor","_e","d","mainColor","arrowStyles","getArrowStyles","isOutOfBounds","inBounds","triangle","size","GUTTER_SIZE","ThresholdControlsPlugin","fieldConfig","onThresholdsChange","renderToken","setRenderToken","s","thresholdHandles","plot","thresholds","decimals","handles","i","height","nextSteps","a","b","handle","v","isPinned","timeItem","val","item","VizDisplayMode","CandleStyle","ColorStrategy","defaultCandlestickColors","getCandlestickFieldsInfo","findFieldOrAuto","frame","info","options","name","prepareCandlestickFields","timeRange","candlestickFieldsInfo","fieldMap","aligned","data","timeSeriesFrames","timeIndex","used","values","timeField","alpha","colorManipulator","drawMarkers","opts","mode","candleStyle","colorStrategy","upColor","downColor","flatColor","volumeAlpha","flatAsUp","drawPrice","asCandles","drawVolume","selectPath","priceDir","flatPath","upPath","downPath","tIdx","oIdx","hIdx","lIdx","cIdx","vIdx","downPathVol","upPathVol","flatPathVol","hollowPath","ctx","tData","oData","cData","hData","lData","vData","zeroPx","idx0","idx1","dataX","dataY","colWidth","prevIdx","minDelta","delta","barWidth","stickWidth","outlineWidth","halfWidth","tPx","interDir","intraDir","outerPath","vPx","hPx","lPx","oPx","cPx","top","btm","hgt","CandlestickPanel","id","width","onChangeTimeRange","replaceVariables","sync","eventsScope","canAddAnnotations","canEditThresholds","showThresholds","dataLinkPostProcessor","eventBus","canExecuteActions","userCanExecuteActions","newAnnotationRange","setNewAnnotationRange","cursorSync","renderers","tweakScale","tweakAxis","shouldRenderPrice","forField","doNothing","colors","open","high","low","close","volume","volumeIdx","shouldRenderVolume","volumeField","fillOpacity","filter","splits","_splits","max","min","indicesOnly","builder","fieldIndices","PanelDataErrorView","enableAnnotationCreation","TimeSeries","uplotConfig","alignedFrame","KeyboardPlugin","EventBusPlugin","TooltipPlugin2","seriesIdx","dataIdx","dataIdxs","timeRange2","viaSync","dataLinks","annotate","xVal","TimeSeriesTooltip","AnnotationsPlugin2","OutsideRangePlugin","CandlestickSuggestionsSupplier","dataSummary","numericFieldFilter","addFieldPicker","category","placeholderText","current","PanelPlugin"],"sourceRoot":""}