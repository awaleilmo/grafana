"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2770],{54952:(J,m,n)=>{n.r(m),n.d(m,{plugin:()=>$});var S=n(16207),e=n(74848),l=n(96540),w=n(64423),h=n(57852),g=n(32899),d=n(92745),b=n(52718),R=n(13326);class E extends l.Component{constructor(){super(...arguments),this.subscription=new w.yU,this.state={}}componentDidMount(){const{eventBus:t}=this.props;this.subscription.add(t.subscribe(h.b_,s=>{this.setState({event:s})})),this.subscription.add(t.subscribe(h.ql,s=>{this.setState({event:s})})),this.subscription.add(t.subscribe(g.kb,s=>{this.setState({event:s})})),this.subscription.add(t.subscribe(g.Tq,s=>{this.setState({event:s})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:t}=this.state;if(!t)return(0,e.jsx)("div",{children:(0,e.jsx)(d.x6,{i18nKey:"debug.cursor-view.no-events-yet",children:"No events yet"})});const{type:s,payload:r,origin:o}=t;return(0,e.jsxs)(b.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:[(0,e.jsxs)("h3",{children:["event.origin: ",o?.path]}),(0,e.jsxs)("span",{children:["event.type: ",s]}),!!r&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("pre",{children:JSON.stringify(r.point,null,"  ")}),r.data&&(0,e.jsx)(R.e,{data:r.data,rowIndex:r.rowIndex,columnIndex:r.columnIndex})]})]})}}var I=n(94777);let p=100;class V extends l.PureComponent{constructor(t){super(t),this.history=new I.$({capacity:40,append:"head"}),this.eventObserver={next:r=>{const o=r.origin;this.history.add({key:p++,type:r.type,path:o?.path,payload:r.payload}),this.setState({counter:p})}},this.state={counter:p};const s=[];s.push(t.eventBus.getStream(h.b_).subscribe(this.eventObserver)),s.push(t.eventBus.getStream(h.ql).subscribe(this.eventObserver)),s.push(t.eventBus.getStream(h.LO).subscribe(this.eventObserver)),this.subs=s}componentWillUnmount(){for(const t of this.subs)t.unsubscribe()}render(){return(0,e.jsx)(b.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.history.map((t,s)=>(0,e.jsxs)("div",{children:[JSON.stringify(t.path)," ",t.type," / X:",JSON.stringify(t.payload.x)," / Y:",JSON.stringify(t.payload.y)]},t.key))})}}var C=n(76732),j=n(46644),f=n(16515),B=n(76319);class K extends l.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(t){const{data:s,options:r}=this.props;if(t.data!==s&&(this.counters.dataChanged++,r.counters?.schemaChanged)){const o=t.data?.series,c=s.series;c&&o&&((0,C.J3)(c,o,C.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:t,options:s}=this.props,r=s.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const o=Date.now(),c=o-this.lastRender;this.lastRender=o;const x=j.AS.get(j.gy.lastNotNull);return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(B.K,{name:"step-backward",title:(0,d.t)("debug.render-info-viewer.title-reset-counters","Reset counters"),onClick:this.resetCounters,tooltip:(0,d.t)("debug.render-info-viewer.tooltip-step-back","Step back")}),(0,e.jsxs)("span",{children:[r.render&&(0,e.jsx)("span",{children:(0,e.jsxs)(d.x6,{i18nKey:"debug.render-info-viewer.render-counter",values:{numRenders:this.counters.render},children:["Render: ","{{numRenders}}","\xA0"]})}),r.dataChanged&&(0,e.jsx)("span",{children:(0,e.jsxs)(d.x6,{i18nKey:"debug.render-info-viewer.data-counter",values:{numDataChanges:this.counters.dataChanged},children:["Data: ","{{numDataChanges}}","\xA0"]})}),r.schemaChanged&&(0,e.jsx)("span",{children:(0,e.jsxs)(d.x6,{i18nKey:"debug.render-info-viewer.schema-counter",values:{numSchemaChanges:this.counters.schemaChanged},children:["Schema: ","{{numSchemaChanges}}","\xA0"]})}),(0,e.jsx)("span",{children:(0,e.jsxs)(d.x6,{i18nKey:"debug.render-info-viewer.elapsed-time",children:["Time: ",{elapsed:c},"ms"]})})]})]}),t.series&&t.series.map((u,y)=>(0,e.jsxs)("div",{children:[(0,e.jsxs)("h4",{children:[(0,f.Ri)(u,y)," (",u.length,")"]}),(0,e.jsxs)("table",{className:"filter-table",children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,e.jsx)(d.x6,{i18nKey:"debug.render-info-viewer.field",children:"Field"})}),(0,e.jsx)("td",{children:(0,e.jsx)(d.x6,{i18nKey:"debug.render-info-viewer.type",children:"Type"})}),(0,e.jsx)("td",{children:(0,e.jsx)(d.x6,{i18nKey:"debug.render-info-viewer.last",children:"Last"})})]})}),(0,e.jsx)("tbody",{children:u.fields.map((v,F)=>{const H=x.reduce(v,!1,!1)[x.id];return(0,e.jsxs)("tr",{children:[(0,e.jsx)("td",{children:(0,f.Ct)(v,u,t.series)}),(0,e.jsx)("td",{children:v.type}),(0,e.jsx)("td",{children:`${H}`})]},`${F}/${v.name}`)})})]})]},`${y}/${u.refId}`))]})}}var O=n(64400),D=n(37386),N=n(63527);function T(i){const t=(0,O.d2)(),s=r=>{t.onInstanceStateChange({name:r.currentTarget.value})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(D.D,{label:(0,d.t)("debug.state-view.label-state-name","State name"),children:(0,e.jsx)(N.p,{value:t.instanceState?.name??"",onChange:s})})})}function P({value:i,context:t,onChange:s,item:r}){return(0,e.jsx)("div",{children:(0,e.jsxs)(d.x6,{i18nKey:"debug.state-view.current-value",values:{currentValue:t.instanceState?.name},children:["Current value: ","{{currentValue}}"," "]})})}var a=(i=>(i.Cursor="cursor",i.Events="events",i.Render="render",i.State="State",i.ThrowError="ThrowError",i))(a||{});class U extends l.Component{render(){const{options:t}=this.props;switch(t.mode){case a.Events:return(0,e.jsx)(V,{eventBus:this.props.eventBus});case a.Cursor:return(0,e.jsx)(E,{eventBus:this.props.eventBus});case a.State:return(0,e.jsx)(T,{...this.props});case a.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return(0,e.jsx)(K,{...this.props})}}}const $=new S.m(U).useFieldConfig().setPanelOptions(i=>{i.addSelect({path:"mode",name:"Mode",defaultValue:a.Render,settings:{options:[{label:"Render",value:a.Render},{label:"Events",value:a.Events},{label:"Cursor",value:a.Cursor},{label:"Cursor",value:a.Cursor},{label:"Share state",value:a.State},{label:"Throw error",value:a.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:t})=>t===a.State,editor:P}).addBooleanSwitch({path:"counters.render",name:"Render count",defaultValue:!0,showIf:({mode:t})=>t===a.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data changed count",defaultValue:!0,showIf:({mode:t})=>t===a.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema changed count",defaultValue:!0,showIf:({mode:t})=>t===a.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})})}}]);

//# sourceMappingURL=debugPanel.93c7b0ca4f9b466aea65.js.map