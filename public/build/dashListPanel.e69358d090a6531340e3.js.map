{"version":3,"file":"dashListPanel.e69358d090a6531340e3.js","mappings":"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","sources":["webpack://grafana/./node_modules/react-use/esm/useThrottle.js","webpack://grafana/./public/app/plugins/panel/dashlist/styles.ts","webpack://grafana/./public/app/plugins/panel/dashlist/utils.ts","webpack://grafana/./public/app/plugins/panel/dashlist/DashList.tsx","webpack://grafana/./public/app/plugins/panel/dashlist/migrations.ts","webpack://grafana/./public/app/plugins/panel/dashlist/panelcfg.gen.ts","webpack://grafana/./public/app/plugins/panel/dashlist/module.tsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport useUnmount from './useUnmount';\nvar useThrottle = function (value, ms) {\n    if (ms === void 0) { ms = 200; }\n    var _a = useState(value), state = _a[0], setState = _a[1];\n    var timeout = useRef();\n    var nextValue = useRef(null);\n    var hasNextValue = useRef(0);\n    useEffect(function () {\n        if (!timeout.current) {\n            setState(value);\n            var timeoutCallback_1 = function () {\n                if (hasNextValue.current) {\n                    hasNextValue.current = false;\n                    setState(nextValue.current);\n                    timeout.current = setTimeout(timeoutCallback_1, ms);\n                }\n                else {\n                    timeout.current = undefined;\n                }\n            };\n            timeout.current = setTimeout(timeoutCallback_1, ms);\n        }\n        else {\n            nextValue.current = value;\n            hasNextValue.current = true;\n        }\n    }, [value]);\n    useUnmount(function () {\n        timeout.current && clearTimeout(timeout.current);\n    });\n    return state;\n};\nexport default useThrottle;\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport const getStyles = (theme: GrafanaTheme2) => {\n  return {\n    dashlistSectionHeader: css({\n      padding: theme.spacing(0.25, 1),\n      marginRight: theme.spacing(1),\n    }),\n    dashlistSection: css({\n      marginBottom: theme.spacing(2),\n      paddingTop: theme.spacing(0.5),\n    }),\n    dashlistLink: css({\n      display: 'flex',\n      cursor: 'pointer',\n      borderBottom: `1px solid ${theme.colors.border.weak}`,\n      margin: theme.spacing(1),\n      padding: theme.spacing(1),\n      alignItems: 'center',\n\n      '&:hover': {\n        a: {\n          color: theme.colors.text.link,\n          textDecoration: 'underline',\n        },\n      },\n    }),\n    dashlistFolder: css({\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n      lineHeight: theme.typography.body.lineHeight,\n    }),\n    dashlistTitle: css({\n      '&::after': {\n        position: 'absolute',\n        content: '\"\"',\n        left: 0,\n        top: 0,\n        bottom: 0,\n        right: 0,\n      },\n    }),\n    dashlistLinkBody: css({\n      flexGrow: 1,\n    }),\n    dashlistItem: css({\n      position: 'relative',\n      listStyle: 'none',\n    }),\n  };\n};\n","import { DataLinkBuiltInVars, PanelProps, urlUtil } from '@grafana/data';\n\nimport { appEvents } from '../../../core/core';\nimport { useBusEvent } from '../../../core/hooks/useBusEvent';\nimport { VariablesChanged } from '../../../features/variables/types';\n\nimport { Options } from './panelcfg.gen';\n\nexport function useDashListUrlParams(props: PanelProps<Options>) {\n  // We don't care about the payload just want to get re-render when this event is published\n  useBusEvent(appEvents, VariablesChanged);\n\n  let query = '';\n\n  if (props.options.keepTime) {\n    query = urlUtil.appendQueryToUrl(query, `\\$${DataLinkBuiltInVars.keepTime}`);\n  }\n\n  if (props.options.includeVars) {\n    query = urlUtil.appendQueryToUrl(query, `\\$${DataLinkBuiltInVars.includeVars}`);\n  }\n\n  return props.replaceVariables(query);\n}\n","import { take } from 'lodash';\nimport { SyntheticEvent, useEffect, useMemo, useState } from 'react';\nimport { useThrottle } from 'react-use';\n\nimport { InterpolateFunction, PanelProps, textUtil } from '@grafana/data';\nimport { useStyles2, IconButton, ScrollContainer } from '@grafana/ui';\nimport { updateNavIndex } from 'app/core/actions';\nimport { getConfig } from 'app/core/config';\nimport { ID_PREFIX, setStarred } from 'app/core/reducers/navBarTree';\nimport { removeNavIndex } from 'app/core/reducers/navModel';\nimport { getBackendSrv } from 'app/core/services/backend_srv';\nimport impressionSrv from 'app/core/services/impression_srv';\nimport { getDashboardSrv } from 'app/features/dashboard/services/DashboardSrv';\nimport { DashboardSearchItem } from 'app/features/search/types';\nimport { useDispatch, useSelector } from 'app/types/store';\n\nimport { Options } from './panelcfg.gen';\nimport { getStyles } from './styles';\nimport { useDashListUrlParams } from './utils';\n\ntype Dashboard = DashboardSearchItem & { id?: number; isSearchResult?: boolean; isRecent?: boolean };\n\ninterface DashboardGroup {\n  show: boolean;\n  header: string;\n  dashboards: Dashboard[];\n}\n\nasync function fetchDashboards(options: Options, replaceVars: InterpolateFunction) {\n  let starredDashboards: Promise<DashboardSearchItem[]> = Promise.resolve([]);\n\n  if (options.showStarred) {\n    const params = { limit: options.maxItems, starred: 'true' };\n    starredDashboards = getBackendSrv().search(params);\n  }\n\n  let recentDashboards: Promise<DashboardSearchItem[]> = Promise.resolve([]);\n  let dashUIDs: string[] = [];\n  if (options.showRecentlyViewed) {\n    let uids = await impressionSrv.getDashboardOpened();\n    dashUIDs = take<string>(uids, options.maxItems);\n    recentDashboards = getBackendSrv().search({ dashboardUIDs: dashUIDs, limit: options.maxItems });\n  }\n\n  let searchedDashboards: Promise<DashboardSearchItem[]> = Promise.resolve([]);\n  if (options.showSearch) {\n    const uid = options.folderUID === '' ? 'general' : options.folderUID;\n    const params = {\n      limit: options.maxItems,\n      query: replaceVars(options.query, {}, 'text'),\n      folderUIDs: uid,\n      tag: options.tags.map((tag: string) => replaceVars(tag, {}, 'text')),\n      type: 'dash-db',\n    };\n\n    searchedDashboards = getBackendSrv().search(params);\n  }\n\n  const [starred, searched, recent] = await Promise.all([starredDashboards, searchedDashboards, recentDashboards]);\n\n  // We deliberately deal with recent dashboards first so that the order of dash IDs is preserved\n  let dashMap = new Map<string, Dashboard>();\n  for (const dashUID of dashUIDs) {\n    const dash = recent.find((d) => d.uid === dashUID);\n    if (dash) {\n      dashMap.set(dashUID, { ...dash, isRecent: true });\n    }\n  }\n\n  searched.forEach((dash) => {\n    if (!dash.uid) {\n      return;\n    }\n    if (dashMap.has(dash.uid)) {\n      dashMap.get(dash.uid)!.isSearchResult = true;\n    } else {\n      dashMap.set(dash.uid, { ...dash, isSearchResult: true });\n    }\n  });\n\n  starred.forEach((dash) => {\n    if (!dash.uid) {\n      return;\n    }\n    if (dashMap.has(dash.uid)) {\n      dashMap.get(dash.uid)!.isStarred = true;\n    } else {\n      dashMap.set(dash.uid, { ...dash, isStarred: true });\n    }\n  });\n\n  return dashMap;\n}\n\nexport function DashList(props: PanelProps<Options>) {\n  const [dashboards, setDashboards] = useState(new Map<string, Dashboard>());\n  const dispatch = useDispatch();\n  const navIndex = useSelector((state) => state.navIndex);\n\n  const throttledRenderCount = useThrottle(props.renderCounter, 5000);\n\n  useEffect(() => {\n    fetchDashboards(props.options, props.replaceVariables).then((dashes) => {\n      setDashboards(dashes);\n    });\n  }, [props.options, props.replaceVariables, throttledRenderCount]);\n\n  const toggleDashboardStar = async (e: SyntheticEvent, dash: Dashboard) => {\n    const { uid, title, url } = dash;\n    e.preventDefault();\n    e.stopPropagation();\n\n    const isStarred = await getDashboardSrv().starDashboard(dash.uid, dash.isStarred);\n    const updatedDashboards = new Map(dashboards);\n    updatedDashboards.set(dash?.uid ?? '', { ...dash, isStarred });\n    setDashboards(updatedDashboards);\n    dispatch(setStarred({ id: uid ?? '', title, url, isStarred }));\n\n    const starredNavItem = navIndex['starred'];\n    if (isStarred) {\n      starredNavItem.children?.push({\n        id: ID_PREFIX + uid,\n        text: title,\n        url: url ?? '',\n        parentItem: starredNavItem,\n      });\n    } else {\n      dispatch(removeNavIndex(ID_PREFIX + uid));\n      const indexToRemove = starredNavItem.children?.findIndex((element) => element.id === ID_PREFIX + uid);\n      if (indexToRemove) {\n        starredNavItem.children?.splice(indexToRemove, 1);\n      }\n    }\n    dispatch(updateNavIndex(starredNavItem));\n  };\n\n  const [starredDashboards, recentDashboards, searchedDashboards] = useMemo(() => {\n    const dashboardList = [...dashboards.values()];\n    return [\n      dashboardList.filter((dash) => dash.isStarred).sort((a, b) => a.title.localeCompare(b.title)),\n      dashboardList.filter((dash) => dash.isRecent),\n      dashboardList.filter((dash) => dash.isSearchResult).sort((a, b) => a.title.localeCompare(b.title)),\n    ];\n  }, [dashboards]);\n\n  const { showStarred, showRecentlyViewed, showHeadings, showFolderNames, showSearch } = props.options;\n\n  const dashboardGroups: DashboardGroup[] = [\n    {\n      header: 'Starred dashboards',\n      dashboards: starredDashboards,\n      show: showStarred,\n    },\n    {\n      header: 'Recently viewed dashboards',\n      dashboards: recentDashboards,\n      show: showRecentlyViewed,\n    },\n    {\n      header: 'Search',\n      dashboards: searchedDashboards,\n      show: showSearch,\n    },\n  ];\n\n  const css = useStyles2(getStyles);\n  const urlParams = useDashListUrlParams(props);\n\n  const renderList = (dashboards: Dashboard[]) => (\n    <ul>\n      {dashboards.map((dash) => {\n        let url = dash.url + urlParams;\n        url = getConfig().disableSanitizeHtml ? url : textUtil.sanitizeUrl(url);\n\n        return (\n          <li className={css.dashlistItem} key={`dash-${dash.uid}`}>\n            <div className={css.dashlistLink}>\n              <div className={css.dashlistLinkBody}>\n                <a className={css.dashlistTitle} href={url}>\n                  {dash.title}\n                </a>\n                {showFolderNames && dash.folderTitle && <div className={css.dashlistFolder}>{dash.folderTitle}</div>}\n              </div>\n              <IconButton\n                tooltip={dash.isStarred ? `Unmark \"${dash.title}\" as favorite` : `Mark \"${dash.title}\" as favorite`}\n                name={dash.isStarred ? 'favorite' : 'star'}\n                iconType={dash.isStarred ? 'mono' : 'default'}\n                onClick={(e) => toggleDashboardStar(e, dash)}\n              />\n            </div>\n          </li>\n        );\n      })}\n    </ul>\n  );\n\n  return (\n    <ScrollContainer minHeight=\"100%\">\n      {dashboardGroups.map(\n        ({ show, header, dashboards }, i) =>\n          show && (\n            <div className={css.dashlistSection} key={`dash-group-${i}`}>\n              {showHeadings && <h6 className={css.dashlistSectionHeader}>{header}</h6>}\n              {renderList(dashboards)}\n            </div>\n          )\n      )}\n    </ScrollContainer>\n  );\n}\n","import { PanelModel } from '@grafana/data';\nimport { getBackendSrv } from '@grafana/runtime';\nimport { FolderDTO } from 'app/types/folders';\n\nimport { Options } from './panelcfg.gen';\n\nasync function getFolderUID(folderID: number): Promise<string> {\n  // folderID 0 is always the fake General/Dashboards folder, which always has a UID of empty string\n  if (folderID === 0) {\n    return '';\n  }\n\n  const folderDTO = await getBackendSrv().get<FolderDTO>(`/api/folders/id/${folderID}`, undefined, undefined, {\n    showErrorAlert: false,\n  });\n\n  return folderDTO.uid;\n}\n\nexport interface AngularModel {\n  /** @deprecated */\n  starred?: boolean;\n  /** @deprecated */\n  recent?: boolean;\n  /** @deprecated */\n  search?: boolean;\n  /** @deprecated */\n  headings?: boolean;\n  /** @deprecated */\n  limit?: number;\n  /** @deprecated */\n  query?: string;\n  /** @deprecated */\n  folderId?: number;\n  /** @deprecated */\n  tags?: string[];\n}\n\nexport async function dashlistMigrationHandler(panel: PanelModel<Options> & AngularModel) {\n  // Convert old angular model to new react model\n  const newOptions: Options = {\n    ...panel.options,\n    showStarred: panel.options.showStarred ?? panel.starred,\n    showRecentlyViewed: panel.options.showRecentlyViewed ?? panel.recent,\n    showSearch: panel.options.showSearch ?? panel.search,\n    showHeadings: panel.options.showHeadings ?? panel.headings,\n    maxItems: panel.options.maxItems ?? panel.limit,\n    query: panel.options.query ?? panel.query,\n    folderId: panel.options.folderId ?? panel.folderId,\n    tags: panel.options.tags ?? panel.tags,\n  };\n\n  // Delete old angular properties\n  const previousVersion = parseFloat(panel.pluginVersion || '6.1');\n  if (previousVersion < 6.3) {\n    const oldProps = ['starred', 'recent', 'search', 'headings', 'limit', 'query', 'folderId'] as const;\n    oldProps.forEach((prop) => delete panel[prop]);\n  }\n\n  // Convert the folderId to folderUID. Uses the API to do the conversion.\n  if (newOptions.folderId !== undefined) {\n    const folderId = newOptions.folderId;\n\n    // If converting ID to UID fails, the panel will not be migrated and will show incorrectly\n    try {\n      const folderUID = await getFolderUID(folderId);\n      newOptions.folderUID = folderUID;\n      delete newOptions.folderId;\n    } catch (err) {\n      console.warn('Dashlist: Error migrating folder ID to UID', err);\n    }\n  }\n\n  return newOptions;\n}\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nexport interface Options {\n  /**\n   * folderId is deprecated, and migrated to folderUid on panel init\n   */\n  folderId?: number;\n  folderUID?: string;\n  includeVars: boolean;\n  keepTime: boolean;\n  maxItems: number;\n  query: string;\n  showFolderNames: boolean;\n  showHeadings: boolean;\n  showRecentlyViewed: boolean;\n  showSearch: boolean;\n  showStarred: boolean;\n  tags: Array<string>;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  includeVars: false,\n  keepTime: false,\n  maxItems: 10,\n  query: '',\n  showFolderNames: true,\n  showHeadings: true,\n  showRecentlyViewed: false,\n  showSearch: false,\n  showStarred: true,\n  tags: [],\n};\n","import { PanelPlugin } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { TagsInput } from '@grafana/ui';\nimport { FolderPicker } from 'app/core/components/Select/FolderPicker';\n\nimport { DashList } from './DashList';\nimport { dashlistMigrationHandler } from './migrations';\nimport { defaultOptions, Options } from './panelcfg.gen';\n\nexport const plugin = new PanelPlugin<Options>(DashList)\n  .setPanelOptions((builder) => {\n    const category = [t('dashlist.category-dashboard-list', 'Dashboard list')];\n    builder\n      .addBooleanSwitch({\n        path: 'keepTime',\n        name: t('dashlist.name-include-current-time-range', 'Include current time range'),\n        category,\n        defaultValue: defaultOptions.keepTime,\n      })\n      .addBooleanSwitch({\n        path: 'includeVars',\n        name: t('dashlist.name-include-current-template-variables', 'Include current template variable values'),\n        category,\n        defaultValue: defaultOptions.includeVars,\n      })\n      .addBooleanSwitch({\n        path: 'showStarred',\n        name: t('dashlist.name-starred', 'Starred'),\n        category,\n        defaultValue: defaultOptions.showStarred,\n      })\n      .addBooleanSwitch({\n        path: 'showRecentlyViewed',\n        name: t('dashlist.name-recently-viewed', 'Recently viewed'),\n        category,\n        defaultValue: defaultOptions.showRecentlyViewed,\n      })\n      .addBooleanSwitch({\n        path: 'showSearch',\n        name: t('dashlist.name-search', 'Search'),\n        category,\n        defaultValue: defaultOptions.showSearch,\n      })\n      .addBooleanSwitch({\n        path: 'showHeadings',\n        name: t('dashlist.name-show-headings', 'Show headings'),\n        category,\n        defaultValue: defaultOptions.showHeadings,\n      })\n      .addBooleanSwitch({\n        path: 'showFolderNames',\n        name: t('dashlist.name-show-folder-names', 'Show folder names'),\n        category,\n        defaultValue: defaultOptions.showFolderNames,\n      })\n      .addNumberInput({\n        path: 'maxItems',\n        name: t('dashlist.name-max-items', 'Max items'),\n        category,\n        defaultValue: defaultOptions.maxItems,\n      })\n      .addTextInput({\n        path: 'query',\n        name: t('dashlist.name-query', 'Query'),\n        category,\n        defaultValue: defaultOptions.query,\n      })\n      .addCustomEditor({\n        path: 'folderUID',\n        name: t('dashlist.name-folder', 'Folder'),\n        category,\n        id: 'folderUID',\n        defaultValue: undefined,\n        editor: function RenderFolderPicker({ value, onChange }) {\n          return (\n            <FolderPicker clearable permission=\"view\" value={value} onChange={(folderUID) => onChange(folderUID)} />\n          );\n        },\n      })\n      .addCustomEditor({\n        id: 'tags',\n        path: 'tags',\n        name: t('dashlist.name-tags', 'Tags'),\n        category,\n        description: '',\n        defaultValue: defaultOptions.tags,\n        editor(props) {\n          return <TagsInput tags={props.value} onChange={props.onChange} />;\n        },\n      });\n  })\n  .setMigrationHandler(dashlistMigrationHandler);\n"],"names":["useThrottle","value","ms","_a","state","setState","timeout","nextValue","hasNextValue","timeoutCallback_1","useUnmount","getStyles","theme","useDashListUrlParams","props","useBusEvent","query","url","fetchDashboards","options","replaceVars","starredDashboards","params","recentDashboards","dashUIDs","uids","searchedDashboards","uid","tag","starred","searched","recent","dashMap","dashUID","dash","d","DashList","dashboards","setDashboards","dispatch","navIndex","throttledRenderCount","dashes","toggleDashboardStar","e","title","isStarred","updatedDashboards","starredNavItem","indexToRemove","element","dashboardList","b","showStarred","showRecentlyViewed","showHeadings","showFolderNames","showSearch","dashboardGroups","css","urlParams","renderList","IconButton","ScrollContainer","show","header","i","getFolderUID","folderID","dashlistMigrationHandler","panel","newOptions","prop","folderId","folderUID","err","defaultOptions","PanelPlugin","builder","category","onChange","FolderPicker","TagsInput"],"sourceRoot":""}