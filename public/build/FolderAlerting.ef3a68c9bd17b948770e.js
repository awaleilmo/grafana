"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4333],{85185:(ga,P,a)=>{a.r(P),a.d(P,{BrowseFolderAlertingPage:()=>B,default:()=>oa});var e=a(74848),x=a(96540),M=a(54148),g=a(92745),A=a(34999),N=a(98970),b=a(13791),R=a(66198),v=a(22803),D=a(2543),E=a(40996),Y=a(63142),S=a(41654),Z=a(12737),U=a(18857),I=a(30703),j=a(8073),W=a(37658),$=a(34213),G=a(95943),C=a(1404),H=a(74048),K=a(20962),O=a(86017),T=a(52161),z=a(63895),J=a(29442),Q=(t=>(t.Ascending="alpha-asc",t.Descending="alpha-desc",t))(Q||{});const V=[{label:"Alphabetically [A-Z]",value:"alpha-asc"},{label:"Alphabetically [Z-A]",value:"alpha-desc"}],X=({folder:t,rules:s})=>{const r=(0,Y.of)(aa),h=c=>{const L=(0,O.EU)(o,c);i(L)},{nameFilter:n,labelFilter:o,sortOrder:l,setNameFilter:u,setLabelFilter:i,setSortOrder:m}=k(),F=q(s,n,o,l??"alpha-asc"),d=F.length===0,{page:f,numberOfPages:p,onPageChange:y,pageItems:ia}=(0,H.W)(F,1,G.FG);return(0,e.jsx)("div",{className:r.container,children:(0,e.jsxs)(S.B,{direction:"column",gap:3,children:[(0,e.jsx)(Z.Z,{value:n,onChange:u,placeholder:(0,g.t)("alerting.alerts-folder-view.name-filter-placeholder-search-alert-rules-by-name","Search alert rules by name"),"data-testid":"name-filter"}),(0,e.jsxs)(S.B,{direction:"row",children:[(0,e.jsx)(U.l6,{value:l,onChange:({value:c})=>c&&m(c),options:V,width:25,"aria-label":(0,g.t)("alerting.alerts-folder-view.aria-label-sort","Sort"),placeholder:(0,g.t)("alerting.alerts-folder-view.placeholder-sort-default-az","Sort (Default A-Z)"),prefix:(0,e.jsx)(I.I,{name:l==="alpha-asc"?"sort-amount-up":"sort-amount-down"})}),(0,e.jsx)(Z.Z,{value:o,onChange:i,placeholder:(0,g.t)("alerting.alerts-folder-view.label-filter-placeholder-search-alerts-by-labels","Search alerts by labels"),className:r.filterLabelsInput,"data-testid":"label-filter"})]}),(0,e.jsx)(S.B,{direction:"column",gap:1,children:ia.map(({grafana_alert:c,labels:L={}})=>(0,e.jsxs)(j.Z,{href:_(c),className:r.card,"data-testid":"alert-card-row",children:[(0,e.jsx)(j.Z.Heading,{children:c.title}),(0,e.jsx)(j.Z.Tags,{children:(0,e.jsx)(W.L,{onClick:h,tags:Object.entries(L).map(([da,ca])=>`${da}=${ca}`)})}),(0,e.jsx)(j.Z.Meta,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)(I.I,{name:"folder"})," ",t.title]})})]},c.uid))}),d&&(0,e.jsx)("div",{className:r.noResults,children:(0,e.jsx)(g.x6,{i18nKey:"alerting.alerts-folder-view.no-alert-rules-found",children:"No alert rules found"})}),(0,e.jsx)("div",{className:r.pagination,children:(0,e.jsx)($.d,{currentPage:f,numberOfPages:p,onNavigate:y,hideWhenSinglePage:!0})})]})})};var w=(t=>(t.nameFilter="nameFilter",t.labelFilter="labelFilter",t.sortOrder="sort",t))(w||{});function k(){const[t,s]=(0,K.l)(),[r,h]=(0,x.useState)(t.get("nameFilter")??""),[n,o]=(0,x.useState)(t.get("labelFilter")??""),l=t.get("sort"),u=(()=>{if(l==="alpha-asc")return"alpha-asc";if(l==="alpha-desc")return"alpha-desc"})(),[i,m]=(0,x.useState)(u);return(0,E.A)(()=>s({nameFilter:(0,C.fE)(r),labelFilter:(0,C.fE)(n),sort:(0,C.fE)(i)},!0),400,[r,n,i]),{nameFilter:r,labelFilter:n,sortOrder:i,setNameFilter:h,setLabelFilter:o,setSortOrder:m}}function q(t,s,r,h){const n=(0,z.Zc)(r),o=t.filter(l=>{const u=l.grafana_alert.title.toLowerCase().includes(s.toLowerCase()),i=(0,O.Av)(l.labels??{},n);return u&&i});return(0,D.orderBy)(o,l=>l.grafana_alert.title.toLowerCase(),[h==="alpha-asc"?"asc":"desc"])}function _(t){return J.PP.detailsPageLink(T.hY,{uid:t.uid,ruleSourceName:T.hY},void 0)}const aa=t=>({container:(0,v.css)({padding:t.spacing(1)}),card:(0,v.css)({gridTemplateColumns:"auto 1fr 2fr",margin:0}),pagination:(0,v.css)({alignSelf:"center"}),filterLabelsInput:(0,v.css)({flex:1,width:"auto",minWidth:"240px"}),noResults:(0,v.css)({padding:t.spacing(2),backgroundColor:t.colors.background.secondary,fontStyle:"italic"})});var ea=a(70327),ta=a(55143),sa=a(77256),ra=a(29609),la=a(43003);const{useRulerNamespaceQuery:na}=ea.hK;function B(){const{uid:t=""}=(0,M.g)(),{data:s,isLoading:r}=(0,N.u$)(t),{data:h={},isLoading:n,error:o}=na({rulerConfig:ta.b,namespace:t}),[l]=(0,N.HP)(),u=(0,x.useMemo)(()=>{if(!s)return;const d=(0,R.R4)(s),f=(0,R.Fk)(s.uid),p=d.children?.find(y=>y.id===f);return p&&(p.active=!0),d},[s]),i=t?async d=>{if(s){const f=await l({...s,title:d});if("error"in f)throw f.error}}:void 0,m=r||n,F=Object.values(h).flatMap(d=>d).flatMap(d=>d.rules).filter(ra.p.grafana.rule);return(0,e.jsx)(b.Y,{navId:"dashboards/browse",pageNav:u,onEditTitle:i,actions:(0,e.jsx)(e.Fragment,{children:s&&(0,e.jsx)(la.m,{folder:s})}),children:(0,e.jsxs)(b.Y.Contents,{isLoading:m,children:[!s&&(0,e.jsx)(A.F,{title:(0,g.t)("browse-dashboards.browse-folder-alerting-page.title-folder-not-found","Folder not found")}),!!o&&(0,e.jsx)(A.F,{title:(0,g.t)("browse-dashboards.browse-folder-alerting-page.title-ruler-namespace-error","Cannot load rules"),severity:"error",children:(0,sa.JZ)(o)}),s&&(0,e.jsx)(X,{folder:s,rules:F})]})})}const oa=B}}]);

//# sourceMappingURL=FolderAlerting.ef3a68c9bd17b948770e.js.map