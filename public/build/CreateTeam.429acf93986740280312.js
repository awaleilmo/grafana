"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5436],{84974:(L,P,e)=>{e.r(P),e.d(P,{CreateTeam:()=>u,default:()=>I});var a=e(74848),A=e(96540),D=e(49785),s=e(92745),i=e(68143),M=e(36490),m=e(45861),R=e(41654),_=e(37386),l=e(16780),n=e(63527),o=e(13791),E=e(99929),c=e(34418),t=e(99686),r=e(73427),C=e(11257);const f={icon:"users-alt",id:"team-new",text:"New team",subTitle:"Create a new team. Teams let you grant permissions to a group of users."},u=()=>{const T=r.TP.user.orgId,[v,h]=(0,A.useState)([]),[{roleOptions:O}]=(0,t.o)(T),{handleSubmit:g,register:U,formState:{errors:p}}=(0,D.mN)(),B=r.TP.hasPermission(C.w.ActionUserRolesAdd)&&r.TP.hasPermission(C.w.ActionUserRolesRemove),W=async K=>{try{const d=await(0,i.AI)().post("/api/teams",K);d.teamId&&(await r.TP.fetchUserPermissions(),r.TP.licensedAccessControlEnabled()&&B&&await(0,c.G3)(v,d.teamId,d.orgId),M.Ny.push(`/org/teams/edit/${d.uid}`))}catch(d){console.error(d)}};return(0,a.jsx)(o.Y,{navId:"teams",pageNav:f,children:(0,a.jsx)(o.Y.Contents,{children:(0,a.jsxs)("form",{onSubmit:g(W),style:{maxWidth:"600px"},children:[(0,a.jsx)(l.n,{children:(0,a.jsxs)(R.B,{direction:"column",gap:2,children:[(0,a.jsx)(_.D,{noMargin:!0,label:(0,s.t)("teams.create-team.label-name","Name"),required:!0,invalid:!!p.name,error:"Team name is required",children:(0,a.jsx)(n.p,{...U("name",{required:!0}),id:"team-name"})}),r.TP.licensedAccessControlEnabled()&&(0,a.jsx)(_.D,{noMargin:!0,label:(0,s.t)("teams.create-team.label-role","Role"),children:(0,a.jsx)(E.Y,{teamId:0,roleOptions:O,disabled:!1,apply:!0,onApplyRoles:h,pendingRoles:v,maxWidth:"100%"})}),(0,a.jsx)(_.D,{noMargin:!0,label:(0,s.t)("teams.create-team.label-email","Email"),description:(0,s.t)("teams.create-team.description-email","This is optional and is primarily used for allowing custom team avatars"),children:(0,a.jsx)(n.p,{...U("email"),type:"email",id:"team-email",placeholder:"email@test.com"})})]})}),(0,a.jsx)(m.$n,{type:"submit",variant:"primary",children:(0,a.jsx)(s.x6,{i18nKey:"teams.create-team.create",children:"Create"})})]})})})},I=u},99686:(L,P,e)=>{e.d(P,{o:()=>R});var a=e(2543),A=e.n(a),D=e(96540),s=e(24705),i=e(73427),M=e(11257),m=e(34418);const R=l=>{const[n,o]=(0,D.useState)(l),{value:E=[]}=(0,s.A)(async()=>i.TP.licensedAccessControlEnabled()&&i.TP.hasPermission(M.w.ActionRolesList)?(0,m.RL)(n):Promise.resolve([]),[n]);return[{roleOptions:E},o]},_=l=>{const[n,o]=useState({});return useDeepCompareEffect(()=>{if(!contextSrv.licensedAccessControlEnabled()||!contextSrv.hasPermission(AccessControlAction.ActionRolesList))return;const E=Object.keys(n).map(t=>typeof t=="number"?t:parseInt(t,10)),c=difference(l,E);Promise.all(c.map(t=>fetchRoleOptions(t).then(r=>[t,r]))).then(t=>{o({...n,...Object.fromEntries(t)})})},[l]),n}},99929:(L,P,e)=>{e.d(P,{Y:()=>R});var a=e(74848),A=e(96540),D=e(41053),s=e(73427),i=e(11257),M=e(59812),m=e(34418);const R=({teamId:_,roleOptions:l,disabled:n,roles:o,onApplyRoles:E,pendingRoles:c,apply:t=!1,maxWidth:r,width:C,isLoading:f})=>{const[{loading:u,value:I=o||[]},T]=(0,D.A)(async()=>{try{if(o)return o;if(t&&c?.length)return c;if(s.TP.hasPermission(i.w.ActionTeamsRolesList)&&_>0)return await(0,m.xN)(_)}catch(O){console.error("Error loading options",O)}return[]},[_,c,o]);(0,A.useEffect)(()=>{T()},[T]);const v=async O=>{t?E&&E(O):(await(0,m.G3)(O,_),await T())},h=s.TP.hasPermission(i.w.ActionTeamsRolesAdd)&&s.TP.hasPermission(i.w.ActionTeamsRolesRemove);return(0,a.jsx)(M.n,{apply:t,onRolesChange:v,roleOptions:l,appliedRoles:I,isLoading:u||f,disabled:n,basicRoleDisabled:!0,canUpdateRoles:h,maxWidth:r,width:C})}}}]);

//# sourceMappingURL=CreateTeam.429acf93986740280312.js.map