"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1036],{22942:(I,M,a)=>{a.d(M,{q:()=>r});var e=a(74848),P=a(92745),n=a(39118);function r(){return(0,e.jsx)(n.I,{text:(0,P.t)("cloud-enterprise-feature-badge","Cloud & Enterprise")})}},25096:(I,M,a)=>{a.d(M,{J:()=>d});var e=a(74848),P=a(22803),n=a(96540),r=a(27489),l=a(63142);const d=({text:_="PRO",className:u,experimentId:f,eventVariant:v="",...T})=>{const o=(0,l.of)(i);return(0,n.useEffect)(()=>{f&&(0,r.Xp)(f,"test",v)},[f,v]),(0,e.jsx)("span",{className:(0,P.cx)(o.badge,u),...T,children:_})},i=_=>({badge:(0,P.css)({marginLeft:_.spacing(1.25),borderRadius:_.shape.borderRadius(5),backgroundColor:_.colors.success.main,padding:_.spacing(.25,.75),color:"white",fontWeight:_.typography.fontWeightMedium,fontSize:_.typography.pxToRem(10)})})},27644:(I,M,a)=>{a.d(M,{$:()=>g,Z:()=>p});var e=a(74848),P=a(22803),n=a(96540),r=a(41607),l=a(92745),d=a(43173),i=a(45861),_=a(66404),u=a(41654),f=a(63142),v=a(22942),T=a(73427),o=a(83873);function g({page:E}){const B=(0,f.of)(h),C=T.TP.user.helpFlags1,L=4,[D,A]=(0,n.useState)(!!(C&L)),t=()=>{o.IB.put(`/api/user/helpflags/${L}`,void 0,{showSuccessAlert:!1}).then(s=>{T.TP.user.helpFlags1=s.helpFlags1,A(!0)})};return D||!p()?null:(0,e.jsxs)("div",{className:B.box,children:[(0,e.jsxs)(u.B,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,e.jsx)(v.q,{}),(0,e.jsx)(i.$n,{variant:"secondary",fill:"text",icon:"times",onClick:t,"aria-label":(0,l.t)("admin.enterprise-auth-features-card.dismiss","Dismiss")})]}),(0,e.jsxs)(u.B,{direction:"column",gap:.5,children:[(0,e.jsx)(_.E,{variant:"h4",children:(0,e.jsx)(l.x6,{i18nKey:"admin.enterprise-auth-features-card.heading",children:"Enterprise authentication"})}),(0,e.jsx)(_.E,{variant:"body",color:"secondary",children:(0,e.jsxs)(l.x6,{i18nKey:"admin.enterprise-auth-features-card.text",children:["Manage users, teams, and permissions automatically with ",(0,e.jsx)("strong",{children:"SAML"}),", ",(0,e.jsx)("strong",{children:"SCIM"}),","," ",(0,e.jsx)("strong",{children:"LDAP"}),", and ",(0,e.jsx)("strong",{children:"RBAC"})," \u2014 available in Grafana Cloud and Enterprise."]})})]}),(0,e.jsx)("div",{children:(0,e.jsx)(i.z9,{href:`https://grafana.com/auth/sign-up/create-user?cloud-auth=&redirectPath=cloud-auth&utm_source=oss-grafana&cnt-admin-${E}`,icon:"external-link-alt",variant:"secondary",target:"_blank",rel:"noopener noreferrer",children:(0,e.jsx)(l.x6,{i18nKey:"admin.enterprise-auth-features-card.learn-more-link",children:"Learn more"})})})]})}function h(E){return{cloudBadge:(0,P.css)({display:"flex",alignItems:"center",background:E.colors.gradients.brandHorizontal,color:E.colors.primary.contrastText,padding:E.spacing(.5,1),borderRadius:E.shape.radius.pill,fontSize:E.typography.bodySmall.fontSize,gap:E.spacing(1)}),box:(0,P.css)({padding:E.spacing(3),border:`1px solid ${E.colors.border.weak}`,backgroundColor:E.colors.background.secondary,display:"flex",flexDirection:"column",gap:E.spacing(1.5),borderRadius:E.shape.radius.default,marginTop:E.spacing(3),strong:{color:E.colors.text.primary}}),icon:(0,P.css)({position:"relative",top:-1})}}function p(){return d.$.buildInfo.edition===r.r.OpenSource||d.$.licenseInfo.stateInfo!=="Licensed"}},34314:(I,M,a)=>{a.r(M),a.d(M,{TeamList:()=>U,default:()=>b});var e=a(74848),P=a(22803),n=a(96540),r=a(70255),l=a(71468),d=a(92745),i=a(44458),_=a(50201),u=a(27594),f=a(34213),v=a(94018),T=a(45861),o=a(89640),g=a(41654),h=a(18027),p=a(12737),E=a(71555),B=a(63142),C=a(13791),L=a(34418),D=a(15130),A=a(11257),t=a(99929),s=a(27644),m=a(77174);const R=new Array(3).fill(null).map((O,$)=>({id:$,uid:"",memberCount:0,name:"",orgId:0,isProvisioned:!1})),U=({teams:O,query:$,noTeams:Z,hasFetched:x,loadTeams:Y,deleteTeam:Q,changeQuery:X,totalPages:w,page:k,rolesLoading:F,changePage:q,changeSort:aa})=>{const[J,ea]=(0,n.useState)([]),W=(0,B.of)(S);(0,n.useEffect)(()=>{Y(!0)},[Y]),(0,n.useEffect)(()=>{D.TP.licensedAccessControlEnabled()&&D.TP.hasPermission(A.w.ActionRolesList)&&(0,L.RL)().then(c=>ea(c))},[]);const G=D.TP.hasPermission(A.w.ActionTeamsCreate),V=j(),sa=(0,n.useMemo)(()=>[{id:"avatarUrl",header:"",disableGrow:!0,cell:({cell:{value:c}})=>x?c&&(0,e.jsx)(E.e,{src:c,alt:"User avatar"}):(0,e.jsx)(r.A,{containerClassName:W.blockSkeleton,width:24,height:24,circle:!0})},{id:"name",header:"Name",cell:({cell:{value:c},row:{original:y}})=>x?D.TP.hasPermissionInMetadata(A.w.ActionTeamsRead,y)?(0,e.jsx)(o.Y,{color:"primary",inline:!1,href:`/org/teams/edit/${y.uid}`,title:(0,d.t)("teams.team-list.columns.title-edit-team","Edit team"),children:c}):c:(0,e.jsx)(r.A,{width:100}),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:c}})=>x?c:(0,e.jsx)(r.A,{width:60}),sortType:"string"},{id:"memberCount",header:"Members",disableGrow:!0,cell:({cell:{value:c}})=>x?c:(0,e.jsx)(r.A,{width:40}),sortType:"number"},...V?[{id:"role",header:"Role",cell:({cell:{value:c},row:{original:y}})=>x?D.TP.hasPermissionInMetadata(A.w.ActionTeamsRolesList,y)&&(0,e.jsx)(t.Y,{teamId:y.id,roles:y.roles||[],isLoading:F,roleOptions:J,width:40}):(0,e.jsx)(r.A,{width:320,height:32,containerClassName:W.blockSkeleton})}]:[],{id:"isProvisioned",header:"",cell:({cell:{value:c}})=>x?!!c&&(0,e.jsx)(v.v,{colorIndex:14,name:"Provisioned"}):(0,e.jsx)(r.A,{width:240})},{id:"actions",header:"",disableGrow:!0,cell:({row:{original:c}})=>{if(!x)return(0,e.jsxs)(g.B,{direction:"row",justifyContent:"flex-end",alignItems:"center",children:[(0,e.jsx)(r.A,{containerClassName:W.blockSkeleton,width:16,height:16}),(0,e.jsx)(r.A,{containerClassName:W.blockSkeleton,width:22,height:24})]});const y=D.TP.hasPermissionInMetadata(A.w.ActionTeamsRead,c),H=D.TP.hasPermissionInMetadata(A.w.ActionTeamsDelete,c)&&!c.isProvisioned;return(0,e.jsxs)(g.B,{direction:"row",justifyContent:"flex-end",gap:2,children:[y&&(0,e.jsx)(T.z9,{href:`org/teams/edit/${c.uid}`,"aria-label":(0,d.t)("teams.team-list.columns.aria-label-edit-team","Edit team {{teamName}}",{teamName:c.name}),icon:"pen",size:"sm",variant:"secondary",tooltip:(0,d.t)("teams.team-list.columns.tooltip-edit-team","Edit team")}),(0,e.jsx)(i.e,{"aria-label":(0,d.t)("teams.team-list.columns.aria-label-delete-button","Delete team {{teamName}}",{teamName:c.name}),size:"sm",disabled:!H,onConfirm:()=>Q(c.uid)})]})}}],[V,x,F,J,Q,W]);return(0,e.jsx)(C.Y,{navId:"teams",actions:Z?void 0:(0,e.jsx)(T.z9,{href:G?"org/teams/new":"#",disabled:!G,children:(0,e.jsx)(d.x6,{i18nKey:"teams.team-list.new-team",children:"New Team"})}),children:(0,e.jsxs)(C.Y.Contents,{children:[Z?(0,e.jsx)(_.p,{variant:"call-to-action",button:(0,e.jsx)(T.z9,{disabled:!G,href:"org/teams/new",icon:"users-alt",size:"lg",children:(0,e.jsx)(d.x6,{i18nKey:"teams.empty-state.button-title",children:"New team"})}),message:(0,d.t)("teams.empty-state.title","You haven't created any teams yet"),children:(0,e.jsxs)(d.x6,{i18nKey:"teams.empty-state.pro-tip",children:["Assign folder and dashboard permissions to teams instead of users to ease administration."," ",(0,e.jsx)(o.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/administration/team-management",children:"Learn more"})]})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"page-action-bar",children:(0,e.jsx)(h.I,{grow:!0,children:(0,e.jsx)(p.Z,{placeholder:(0,d.t)("teams.team-list.placeholder-search-teams","Search teams"),value:$,onChange:X})})}),x&&O.length===0?(0,e.jsx)(_.p,{variant:"not-found",message:(0,d.t)("teams.empty-state.message","No teams found")}):(0,e.jsxs)(g.B,{direction:"column",gap:2,children:[(0,e.jsx)(u.j,{columns:sa,data:x?O:R,getRowId:c=>String(c.id),fetchData:aa}),(0,e.jsx)(g.B,{justifyContent:"flex-end",children:(0,e.jsx)(f.d,{hideWhenSinglePage:!0,currentPage:k,numberOfPages:w,onNavigate:q})})]})]}),!$&&(0,e.jsx)(s.$,{page:"teams"})]})})};function j(){return D.TP.licensedAccessControlEnabled()&&D.TP.hasPermission(A.w.ActionTeamsRolesList)&&D.TP.hasPermission(A.w.ActionRolesList)}function z(O){return{teams:O.teams.teams,query:O.teams.query,perPage:O.teams.perPage,page:O.teams.page,noTeams:O.teams.noTeams,totalPages:O.teams.totalPages,hasFetched:O.teams.hasFetched,rolesLoading:O.teams.rolesLoading}}const K={loadTeams:m.Bu,deleteTeam:m.To,changePage:m.yd,changeQuery:m.nM,changeSort:m.Vk},b=(0,l.connect)(z,K)(U),S=O=>({blockSkeleton:(0,P.css)({lineHeight:1,display:"flex"})})},39118:(I,M,a)=>{a.d(M,{I:()=>l});var e=a(74848),P=a(22803),n=a(30703),r=a(63142);function l({text:i}){const _=(0,r.of)(d);return(0,e.jsxs)("div",{className:_.wrapper,children:[(0,e.jsx)(n.I,{name:"cloud",size:"sm"}),i]})}const d=i=>({wrapper:(0,P.css)({display:"inline-flex",padding:i.spacing(.5,1),borderRadius:i.shape.radius.pill,background:i.colors.gradients.brandHorizontal,color:i.colors.primary.contrastText,fontWeight:i.typography.fontWeightMedium,gap:i.spacing(.5),fontSize:i.typography.bodySmall.fontSize,lineHeight:i.typography.bodySmall.lineHeight,alignItems:"center"})})},42939:(I,M,a)=>{a.d(M,{pL:()=>P,z5:()=>r});var e=a(43173);const P=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function n(){const l=e.$.licenseInfo?.trialExpiry;return!!(l&&l>0)}const r=()=>n()&&e.$.featureToggles.featureHighlights},67145:(I,M,a)=>{a.d(M,{R:()=>v,X:()=>T});var e=a(92745),P=a(62061),n=a(25096),r=a(65642),l=a(15130),d=a(42939),i=a(11257),_=a(70590);const f={avatarUrl:a.p+"static/img/user_profile.4d4fc140.png",id:1,uid:"",name:"Loading",email:"loading",memberCount:0,permission:_.Xe.Member,accessControl:{isEditor:!1},orgId:0,updated:"",isProvisioned:!1};function v(o){const g={img:o.avatarUrl,id:"team-"+o.uid,subTitle:(0,e.t)("teams.build-nav-model.nav-model.subTitle.manage-members-and-settings","Manage members and settings"),url:`org/teams/edit/${o.uid}`,text:o.name,children:[{active:!1,icon:"sliders-v-alt",id:`team-settings-${o.uid}`,text:(0,e.t)("teams.build-nav-model.nav-model.text.settings","Settings"),url:`org/teams/edit/${o.uid}/settings`}]};(o===f||l.TP.hasPermissionInMetadata(i.w.ActionTeamsPermissionsRead,o))&&g.children.unshift({active:!1,icon:"users-alt",id:`team-members-${o.uid}`,text:(0,e.t)("teams.build-nav-model.text.members","Members"),url:`org/teams/edit/${o.uid}/members`});const h={active:!1,icon:"sync",id:`team-groupsync-${o.uid}`,text:(0,e.t)("teams.build-nav-model.team-group-sync.text.external-group-sync","External group sync"),url:`org/teams/edit/${o.uid}/groupsync`},p=o===f;return(0,d.z5)()&&(h.tabSuffix=()=>(0,n.J)({experimentId:p?"":"feature-highlights-team-sync-badge",eventVariant:"trial"})),(0,P.a)("teamsync")?(p||l.TP.hasPermissionInMetadata(i.w.ActionTeamsPermissionsRead,o))&&g.children.push(h):r.Ay.featureToggles.featureHighlights&&g.children.push({...h,tabSuffix:()=>(0,n.J)({experimentId:p?"":"feature-highlights-team-sync-badge"})}),g}function T(o){const g=v(f);let h;for(const p of g.children)if(p.id.indexOf(o)>0){p.active=!0,h=p;break}return{main:g,node:h}}},77174:(I,M,a)=>{a.d(M,{Bu:()=>f,It:()=>L,To:()=>o,Vk:()=>p,aK:()=>C,eo:()=>T,n7:()=>B,nC:()=>D,nM:()=>g,yd:()=>h});var e=a(2543),P=a.n(e),n=a(68143),r=a(6890),l=a(73427),d=a(81871),i=a(11257),_=a(67145),u=a(27104);function f(t=!1){return async(s,m)=>{const{query:R,page:U,perPage:j,sort:z}=m().teams;if(!l.TP.hasPermission(i.w.ActionTeamsRead)){s((0,u.Q9)({teams:[],totalCount:0,page:1,perPage:j,noTeams:!0}));return}const K=await(0,n.AI)().get("/api/teams/search",(0,d.F)({query:R,page:U,perpage:j,sort:z}));let N=!1;if(t&&(N=K.teams.length===0),l.TP.licensedAccessControlEnabled()&&l.TP.hasPermission(i.w.ActionTeamsRolesList)){s((0,u.dJ)());const b=K?.teams.map(O=>O.id),S=await(0,n.AI)().post("/api/access-control/teams/roles/search",{teamIds:b});K.teams.forEach(O=>{O.roles=S?S[O.id]||[]:[]}),s((0,u.jE)())}s((0,u.Q9)({noTeams:N,...K}))}}const v=(0,e.debounce)(t=>t(f()),500);function T(t){return async s=>{const m=await(0,n.AI)().get(`/api/teams/${t}`,(0,d.F)());s((0,u.$T)(m)),s((0,r.Vz)((0,_.R)(m)))}}function o(t){return async s=>{await(0,n.AI)().delete(`/api/teams/${t}`),await l.TP.fetchUserPermissions(),s(f())}}function g(t){return async s=>{s((0,u.L5)(t)),v(s)}}function h(t){return async s=>{s((0,u.EC)(t)),s(f())}}function p({sortBy:t}){const s=t.length?`${t[0].id}-${t[0].desc?"desc":"asc"}`:void 0;return async m=>{m((0,u.$u)(s)),m(f())}}function E(){return async(t,s)=>{const m=s().team.team,R=await getBackendSrv().get(`/api/teams/${m.uid}/members`);t(teamMembersLoaded(R))}}function B(t,s){return async(m,R)=>{const U=R().team.team;await(0,n.AI)().put(`/api/teams/${U.uid}`,{name:t,email:s}),m(T(U.uid))}}function C(){return async(t,s)=>{const m=s().team.team,R=await(0,n.AI)().get(`/api/teams/${m.uid}/groups`);t((0,u.tC)(R))}}function L(t){return async(s,m)=>{const R=m().team.team;await(0,n.AI)().post(`/api/teams/${R.uid}/groups`,{groupId:t}),s(C())}}function D(t){return async(s,m)=>{const R=m().team.team;await(0,n.AI)().delete(`/api/teams/${R.uid}/groups?groupId=${encodeURIComponent(t)}`),s(C())}}function A(t){return async s=>{await getBackendSrv().put(`/api/teams/${t.teamId}/members/${t.userId}`,{permission:t.permission}),s(E())}}},99929:(I,M,a)=>{a.d(M,{Y:()=>_});var e=a(74848),P=a(96540),n=a(41053),r=a(73427),l=a(11257),d=a(59812),i=a(34418);const _=({teamId:u,roleOptions:f,disabled:v,roles:T,onApplyRoles:o,pendingRoles:g,apply:h=!1,maxWidth:p,width:E,isLoading:B})=>{const[{loading:C,value:L=T||[]},D]=(0,n.A)(async()=>{try{if(T)return T;if(h&&g?.length)return g;if(r.TP.hasPermission(l.w.ActionTeamsRolesList)&&u>0)return await(0,i.xN)(u)}catch(s){console.error("Error loading options",s)}return[]},[u,g,T]);(0,P.useEffect)(()=>{D()},[D]);const A=async s=>{h?o&&o(s):(await(0,i.G3)(s,u),await D())},t=r.TP.hasPermission(l.w.ActionTeamsRolesAdd)&&r.TP.hasPermission(l.w.ActionTeamsRolesRemove);return(0,e.jsx)(d.n,{apply:h,onRolesChange:A,roleOptions:f,appliedRoles:L,isLoading:C||B,disabled:v,basicRoleDisabled:!0,canUpdateRoles:t,maxWidth:p,width:E})}}}]);

//# sourceMappingURL=TeamList.f1e173ef709f3d80eba2.js.map