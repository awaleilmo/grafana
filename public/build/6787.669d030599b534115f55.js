"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6787],{1332:(Y,O,e)=>{e.d(O,{K:()=>D});var t=e(74848),g=e(96540),o=e(50992),M=e(2543),l=e(56652);function d(n){const s=n.languages.CompletionItemKind.Function;return[{label:l.AlertmanagerTemplateFunction.toUpper,detail:"function(s string)",kind:s},{label:l.AlertmanagerTemplateFunction.toLower,detail:"function(s string)",kind:s},{label:l.AlertmanagerTemplateFunction.title,documentation:"Capitalizes the first letter of each word",detail:"function(s string)",kind:s},{label:l.AlertmanagerTemplateFunction.join,documentation:{value:"Joins an array of strings using the separator provided."},detail:"function(separator string, s []string)",kind:s},{label:l.AlertmanagerTemplateFunction.match,detail:"function",kind:s},{label:l.AlertmanagerTemplateFunction.safeHtml,detail:"function(pattern, repl, text)",kind:s},{label:l.AlertmanagerTemplateFunction.reReplaceAll,detail:"function(pattern, repl, text)",kind:s},{label:l.AlertmanagerTemplateFunction.stringSlice,detail:"function(s ...string)",kind:s}]}function T(n){const s=n.languages.CompletionItemKind.Function;return Object.values(l.GomplateFunctions).flatMap(m=>m.map(c=>({label:c.keyword,detail:c.usage,documentation:`${c.definition}

${c.example}`,kind:s})))}var A=e(32443);function p(n){const s={triggerCharacters:["."],provideCompletionItems(m,c,P){const j=m.getWordUntilPosition(c),w={startLineNumber:c.lineNumber,endLineNumber:c.lineNumber,startColumn:j.startColumn,endColumn:j.endColumn},B=new C(n,w);if(!a(m,c))return B.getSnippetsSuggestions();if(P.triggerKind===n.languages.CompletionTriggerKind.Invoke&&!P.triggerCharacter)return B.getFunctionsSuggestions();const Q=m.getWordUntilPosition({lineNumber:c.lineNumber,column:c.column-1});return B.getTemplateDataSuggestions(Q.word)}};return n.languages.registerCompletionItemProvider("go-template",s)}function a(n,s){return n.findMatches("\\{\\{(?:.|\\n)+?\\}\\}",n.getFullModelRange(),!0,!1,null,!1).some(P=>P.range.containsPosition({lineNumber:s.lineNumber,column:s.column+1}))}class C{constructor(s,m){this.monaco=s,this.range=m,this.getSnippetsSuggestions=()=>this.getCompletionsFromDefinitions((0,A.Mq)(this.monaco)),this.getFunctionsSuggestions=()=>this.getCompletionsFromDefinitions(d(this.monaco),T(this.monaco)),this.getTemplateDataSuggestions=c=>{switch(c){case"":return this.getCompletionsFromDefinitions((0,A.Xt)(this.monaco),(0,A.So)(this.monaco));case"Alerts":return this.getCompletionsFromDefinitions((0,A.J2)(this.monaco));case"GroupLabels":case"CommonLabels":case"CommonAnnotations":case"Labels":case"Annotations":return this.getCompletionsFromDefinitions((0,A.KS)(this.monaco));default:return{suggestions:[]}}},this.getCompletionsFromDefinitions=(...c)=>({suggestions:(0,M.concat)(...c).map(j=>K(j,this.range))})}}function K({label:n,detail:s,documentation:m,kind:c,insertText:P},j){const w=typeof n=="string"?n:n.label,B=typeof n=="string"?{label:n,description:s}:{...n};return B.description??=s,{label:B,kind:c,insertText:P??w,range:j,documentation:m,detail:s}}const u="go-template",J={id:u,extensions:[],aliases:[],mimetypes:[],loader:()=>Promise.resolve().then(e.bind(e,56652))},V=(n,s)=>{const{id:m,loader:c}=s;n.languages.getLanguages().find(j=>j.id===m)||(n.languages.register({id:m}),c().then(j=>{n.languages.setMonarchTokensProvider(m,j.language),n.languages.setLanguageConfiguration(m,j.conf)}))},D=n=>{const s=!!n.autoHeight,m=(0,g.useRef)(null),c=P=>{if(s){const j=P.getContentHeight();try{P.layout({height:j,width:NaN})}catch{}}};return(0,g.useEffect)(()=>()=>{m.current?.dispose()},[]),(0,t.jsx)(o.B,{showLineNumbers:!0,showMiniMap:!1,...n,monacoOptions:{scrollBeyondLastLine:!1},onEditorDidMount:c,onBeforeEditorMount:P=>{V(P,J),m.current=p(P)},language:u})}},27911:(Y,O,e)=>{e.d(O,{L:()=>g});var t=e(22803);const g=o=>({table:(0,t.css)({width:"100%",borderRadius:o.shape.radius.default,border:`solid 1px ${o.colors.border.weak}`,backgroundColor:o.colors.background.secondary,th:{padding:o.spacing(1)},td:{padding:`0 ${o.spacing(1)}`},tr:{height:"38px"}}),evenRow:(0,t.css)({backgroundColor:o.colors.background.primary}),colExpand:(0,t.css)({width:"36px"}),nameCell:(0,t.css)({gap:o.spacing(1)}),actionsCell:(0,t.css)({textAlign:"right",width:"1%",whiteSpace:"nowrap","& > * + *":{marginLeft:o.spacing(.5)}})})},32443:(Y,O,e)=>{e.d(O,{So:()=>K,J2:()=>u,Xt:()=>C,KS:()=>$,Mq:()=>V,L:()=>J});var t=e(92745);const g=`
{{ range .Alerts }}
  Status: {{ .Status }}
  Starts at: {{ .StartsAt }}
{{ end }}
`,o=`
[{{.Status}}] {{ .Labels.alertname }}

Labels:
{{ range .Labels.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}

{{ if gt (len .Annotations) 0 }}
Annotations:
{{ range .Annotations.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}
{{ end }}

{{ if gt (len .SilenceURL ) 0 }}
  Silence alert: {{ .SilenceURL }}
{{ end }}
{{ if gt (len .DashboardURL ) 0 }}
  Go to dashboard: {{ .DashboardURL }}
{{ end }}
`,M=`
{{ coll.Dict
  "receiver" .Receiver
  "status" .Status
  "alerts" ( len .Alerts )
| data.ToJSONPretty " " }}
`,l=a("GroupLabels.SortedPairs"),d=a("CommonLabels.SortedPairs"),T=a("CommonAnnotations.SortedPairs"),A=a("Labels.SortedPairs"),p=a("Annotations.SortedPairs");function a(D){return`
{{ range .${D} }}
  {{ .Name }} = {{ .Value }}
{{ end }}`}function C(D){const n=D.languages.CompletionItemKind.Field;return[{label:"Alerts",kind:n,detail:"Alert[]",documentation:{value:(0,t.t)("alerting.get-global-suggestions.value.an-array-containing-all-alerts","An Array containing all alerts")}},{label:"Receiver",kind:n,detail:"string"},{label:"Status",kind:n,detail:"string"},{label:"GroupLabels",kind:n,detail:"[]KeyValue"},{label:"CommonLabels",kind:n,detail:"[]KeyValue"},{label:"CommonAnnotations",kind:n,detail:"[]KeyValue"},{label:"ExternalURL",kind:n,detail:"string"},{label:"GroupKey",kind:n,detail:"string"},{label:"TruncatedAlerts",kind:n,detail:"integer"}]}function K(D){const n=D.languages.CompletionItemKind.Field;return[{label:{label:"Status",detail:"(Alert)",description:"string"},kind:n,detail:"string",documentation:{value:(0,t.t)("alerting.get-alert-suggestions.value.status-alert-firing-resolved","Status of the alert. It can be `firing` or `resolved`")}},{label:{label:"Labels",detail:"(Alert)"},kind:n,detail:"[]KeyValue",documentation:{value:(0,t.t)("alerting.get-alert-suggestions.value.labels-attached-alert","A set of labels attached to the alert.")}},{label:{label:"Annotations",detail:"(Alert)"},kind:n,detail:"[]KeyValue",documentation:(0,t.t)("alerting.get-alert-suggestions.documentation.annotations-attached-alert","A set of annotations attached to the alert.")},{label:{label:"StartsAt",detail:"(Alert)"},kind:n,detail:"time.Time",documentation:(0,t.t)("alerting.get-alert-suggestions.documentation.time-the-alert-started-firing","Time the alert started firing.")},{label:{label:"EndsAt",detail:"(Alert)"},kind:n,detail:"time.Time",documentation:"Only set if the end time of an alert is known. Otherwise set to a configurable timeout period from the time since the last alert was received."},{label:{label:"GeneratorURL",detail:"(Alert)"},kind:n,detail:"string",documentation:(0,t.t)("alerting.get-alert-suggestions.documentation.grafana-external-alertmanager","Back link to Grafana or external Alertmanager.")},{label:{label:"SilenceURL",detail:"(Alert)"},kind:n,detail:"string",documentation:"Link to Grafana silence for with labels for this alert pre-filled. Only for Grafana managed alerts."},{label:{label:"DashboardURL",detail:"(Alert)"},kind:n,detail:"string",documentation:"Link to Grafana dashboard, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"PanelURL",detail:"(Alert)"},kind:n,detail:"string",documentation:"Link to Grafana dashboard panel, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"Fingerprint",detail:"(Alert)"},kind:n,detail:"string",documentation:(0,t.t)("alerting.get-alert-suggestions.documentation.fingerprint-identify-alert","Fingerprint that can be used to identify the alert.")},{label:{label:"ValueString",detail:"(Alert)"},kind:n,detail:"string",documentation:"String that contains labels and values of each reduced expression in the alert."},{label:{label:"OrgID",detail:"(Alert)"},kind:n,detail:"integer",documentation:(0,t.t)("alerting.get-alert-suggestions.documentation.organization-alert","The ID of the organization that owns the alert.")}]}function u(D){const n=D.languages.CompletionItemKind.Field;return[{label:"Firing",kind:n,detail:"Alert[]"},{label:"Resolved",kind:n,detail:"Alert[]"}]}function $(D){const n=D.languages.CompletionItemKind.Field;return[{label:"SortedPairs",kind:n,detail:"[]KeyValue"},{label:"Names",kind:n,detail:"[]string"},{label:"Values",kind:n,detail:"[]string"},{label:"Remove",detail:"KeyValue[] function(keys []string)",kind:D.languages.CompletionItemKind.Method}]}const J={alerts:{label:"alertsloop",description:"Renders a loop through alerts",snippet:g},alertDetails:{label:"alertdetails",description:"Renders all information available about the alert",snippet:o},groupLabels:{label:"grouplabelsloop",description:"Renders a loop through group labels",snippet:l},commonLabels:{label:"commonlabelsloop",description:"Renders a loop through common labels",snippet:d},commonAnnotations:{label:"commonannotationsloop",description:"Renders a loop through common annotations",snippet:T},labels:{label:"labelsloop",description:"Renders a loop through labels",snippet:A},annotations:{label:"annotationsloop",description:"Renders a loop through annotations",snippet:p},json:{label:"json",description:"Renders a JSON object",snippet:M}};function V(D){const n=D.languages.CompletionItemKind.Snippet,s=D.languages.CompletionItemInsertTextRule.InsertAsSnippet,{alerts:m,alertDetails:c,groupLabels:P,commonLabels:j,commonAnnotations:w,labels:B,annotations:H,json:Q}=J;return[{label:m.label,documentation:m.description,kind:n,insertText:m.snippet,insertTextRules:s},{label:{label:c.label,detail:"(Alert)"},documentation:c.description,kind:n,insertText:c.snippet,insertTextRules:s},{label:P.label,documentation:P.description,kind:n,insertText:P.snippet,insertTextRules:s},{label:j.label,documentation:j.description,kind:n,insertText:j.snippet,insertTextRules:s},{label:w.label,documentation:w.description,kind:n,insertText:w.snippet,insertTextRules:s},{label:{label:B.label,detail:"(Alert)"},documentation:B.description,kind:n,insertText:B.snippet,insertTextRules:s},{label:{label:H.label,detail:"(Alert)"},documentation:H.description,kind:n,insertText:H.snippet,insertTextRules:s},{label:Q.label,documentation:Q.description,kind:n,insertText:Q.snippet,insertTextRules:D.languages.CompletionItemInsertTextRule.KeepWhitespace}]}},40403:(Y,O,e)=>{e.d(O,{A1:()=>B,J2:()=>P,OA:()=>q,_3:()=>H,cC:()=>n,lx:()=>Q,xW:()=>w});var t=e(96540),g=e(85618),o=e(91984),M=e(43730),l=e(80218),d=e(43100),T=e(55614),A=e(22628),p=e(56476),a=e(42801);const{useGetAlertmanagerConfigurationQuery:C,useLazyGetAlertmanagerConfigurationQuery:K}=o.m,{useListNamespacedTemplateGroupQuery:u,useLazyReadNamespacedTemplateGroupQuery:$,useCreateNamespacedTemplateGroupMutation:J,useReplaceNamespacedTemplateGroupMutation:V,useDeleteNamespacedTemplateGroupMutation:D}=M.E3;function n({alertmanager:r}){const b=(0,p.dM)(r),U=u({namespace:(0,g.Ge)()},{skip:!b,selectFromResult:y=>({...y,data:y.data?s(y.data):void 0,currentData:y.currentData?s(y.currentData):void 0})}),E=C(r,{skip:b,selectFromResult:y=>({...y,data:y.data?c(y.data):void 0,currentData:y.currentData?c(y.currentData):void 0})});return b?U:E}function s(r){return r.items.map(b=>m(b))}function m(r){const b=(0,p.gw)(r,A.T.Provenance)??A.rh;return{uid:r.metadata.name??r.spec.title,title:r.spec.title,content:r.spec.content,provenance:b}}function c(r){const{alertmanager_config:b}=r,{templates:U=[]}=b;return Object.entries(r.template_files).map(([E,y])=>({uid:E,title:E,content:y,provenance:(r.template_file_provenances??{})[E]||A.rh,missing:!U.includes(E)}))}function P({alertmanager:r,uid:b}){const[U,E]=K({selectFromResult:f=>({...f,data:f.data?j(f.data,b):void 0,currentData:f.currentData?j(f.currentData,b):void 0})}),[y,z]=$({selectFromResult:f=>({...f,data:f.data?m(f.data):void 0,currentData:f.currentData?m(f.currentData):void 0})}),S=(0,p.dM)(r);return(0,t.useEffect)(()=>{S?y({namespace:(0,g.Ge)(),name:b}):U(r)},[r,b,S,U,y]),S?z:E}function j(r,b){return c(r).find(E=>E.title===b)}function w({alertmanager:r}){const[b]=J(),[U]=(0,d.d)(),E=(0,p.dM)(r),y=(0,l.Yb)(({templateValues:S})=>{const f=(0,T.FB)({template:S});return U(f)}),z=(0,l.Yb)(({templateValues:S})=>{const f=(0,a.o)(S.title,S.content);return b({namespace:(0,g.Ge)(),comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup:{spec:{title:S.title,content:f},metadata:{}}}).unwrap()});return E?z:y}function B({alertmanager:r}){const[b]=V(),[U]=(0,d.d)(),E=(0,p.dM)(r),y=(0,l.Yb)(({template:S,patch:f})=>{const k=(0,T.jS)({name:S.title,template:f});return U(k)}),z=(0,l.Yb)(({template:S,patch:f})=>{const k=(0,a.o)(f.title,f.content);return b({namespace:(0,g.Ge)(),name:S.uid,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup:{spec:{title:f.title,content:k},metadata:{name:S.uid}}}).unwrap()});return E?z:y}function H({alertmanager:r}){const[b]=D(),[U]=(0,d.d)(),E=(0,l.Yb)(async({uid:S})=>{const f=(0,T.JI)({name:S});return U(f)}),y=(0,l.Yb)(({uid:S})=>b({namespace:(0,g.Ge)(),name:S,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{}}).unwrap());return(0,p.dM)(r)?y:E}function Q({alertmanager:r,originalTemplate:b}){const{useLazyGetAlertmanagerConfigurationQuery:U}=o.m,[E]=U();return{titleIsUnique:async z=>{if((0,p.dM)(r)||b?.title===z)return!0;const f=await E(r).unwrap();return c(f).some(_=>_.title===z)?"Another template with this name already exists":!0}}}function q(r){return r?{isProvisioned:!!r.provenance&&r.provenance!==A.rh}:{isProvisioned:!1}}},43730:(Y,O,e)=>{e.d(O,{E3:()=>T,vj:()=>A});const t=`{{ define "__subject" }}[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ if gt (.Alerts.Resolved | len) 0 }}, RESOLVED:{{ .Alerts.Resolved | len }}{{ end }}{{ end }}] {{ .GroupLabels.SortedPairs.Values | join " " }} {{ if gt (len .CommonLabels) (len .GroupLabels) }}({{ with .CommonLabels.Remove .GroupLabels.Names }}{{ .Values | join " " }}{{ end }}){{ end }}{{ end }}

{{ define "__text_values_list" }}{{ if len .Values }}{{ $first := true }}{{ range $refID, $value := .Values -}}
{{ if $first }}{{ $first = false }}{{ else }}, {{ end }}{{ $refID }}={{ $value }}{{ end -}}
{{ else }}[no value]{{ end }}{{ end }}

{{ define "__text_alert_list" }}{{ range . }}
Value: {{ template "__text_values_list" . }}
Labels:
{{ range .Labels.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}Annotations:
{{ range .Annotations.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}{{ if gt (len .GeneratorURL) 0 }}Source: {{ .GeneratorURL }}
{{ end }}{{ if gt (len .SilenceURL) 0 }}Silence: {{ .SilenceURL }}
{{ end }}{{ if gt (len .DashboardURL) 0 }}Dashboard: {{ .DashboardURL }}
{{ end }}{{ if gt (len .PanelURL) 0 }}Panel: {{ .PanelURL }}
{{ end }}{{ end }}{{ end }}

{{ define "default.title" }}{{ template "__subject" . }}{{ end }}

{{ define "default.message" }}{{ if gt (len .Alerts.Firing) 0 }}**Firing**
{{ template "__text_alert_list" .Alerts.Firing }}{{ if gt (len .Alerts.Resolved) 0 }}

{{ end }}{{ end }}{{ if gt (len .Alerts.Resolved) 0 }}**Resolved**
{{ template "__text_alert_list" .Alerts.Resolved }}{{ end }}{{ end }}

{{ define "__teams_text_alert_list" }}{{ range . }}
Value: {{ template "__text_values_list" . }}
Labels:
{{ range .Labels.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}
Annotations:
{{ range .Annotations.SortedPairs }} - {{ .Name }} = {{ .Value }}
{{ end }}
{{ if gt (len .GeneratorURL) 0 }}Source: [{{ .GeneratorURL }}]({{ .GeneratorURL }})

{{ end }}{{ if gt (len .SilenceURL) 0 }}Silence: [{{ .SilenceURL }}]({{ .SilenceURL }})

{{ end }}{{ if gt (len .DashboardURL) 0 }}Dashboard: [{{ .DashboardURL }}]({{ .DashboardURL }})

{{ end }}{{ if gt (len .PanelURL) 0 }}Panel: [{{ .PanelURL }}]({{ .PanelURL }})

{{ end }}
{{ end }}{{ end }}

{{ define "teams.default.message" }}{{ if gt (len .Alerts.Firing) 0 }}**Firing**
{{ template "__teams_text_alert_list" .Alerts.Firing }}{{ if gt (len .Alerts.Resolved) 0 }}

{{ end }}{{ end }}{{ if gt (len .Alerts.Resolved) 0 }}**Resolved**
{{ template "__teams_text_alert_list" .Alerts.Resolved }}{{ end }}{{ end }}`;var g=e(87988),o=e(5709);const M=["TemplateGroup"],l=o.H.enhanceEndpoints({addTagTypes:M}).injectEndpoints({endpoints:p=>({listNamespacedTemplateGroup:p.query({query:a=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${a.namespace}/templategroups`,params:{pretty:a.pretty,allowWatchBookmarks:a.allowWatchBookmarks,continue:a.continue,fieldSelector:a.fieldSelector,labelSelector:a.labelSelector,limit:a.limit,resourceVersion:a.resourceVersion,resourceVersionMatch:a.resourceVersionMatch,sendInitialEvents:a.sendInitialEvents,timeoutSeconds:a.timeoutSeconds,watch:a.watch}}),providesTags:["TemplateGroup"]}),createNamespacedTemplateGroup:p.mutation({query:a=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${a.namespace}/templategroups`,method:"POST",body:a.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup,params:{pretty:a.pretty,dryRun:a.dryRun,fieldManager:a.fieldManager,fieldValidation:a.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),readNamespacedTemplateGroup:p.query({query:a=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${a.namespace}/templategroups/${a.name}`,params:{pretty:a.pretty}}),providesTags:["TemplateGroup"]}),replaceNamespacedTemplateGroup:p.mutation({query:a=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${a.namespace}/templategroups/${a.name}`,method:"PUT",body:a.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TemplateGroup,params:{pretty:a.pretty,dryRun:a.dryRun,fieldManager:a.fieldManager,fieldValidation:a.fieldValidation}}),invalidatesTags:["TemplateGroup"]}),deleteNamespacedTemplateGroup:p.mutation({query:a=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${a.namespace}/templategroups/${a.name}`,method:"DELETE",body:a.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:a.pretty,dryRun:a.dryRun,gracePeriodSeconds:a.gracePeriodSeconds,orphanDependents:a.orphanDependents,propagationPolicy:a.propagationPolicy}}),invalidatesTags:["TemplateGroup"]})}),overrideExisting:!1}),d="/api/alertmanager/grafana/config/api/v1/templates/test";l.enhanceEndpoints({endpoints:{readNamespacedTemplateGroup:p=>{const a={hideErrorMessage:!0};p.extraOptions=a}}});const T=l.injectEndpoints({endpoints:p=>({previewTemplate:p.mutation({query:({template:a,alerts:C,name:K})=>({url:d,data:{template:a,alerts:C,name:K},method:"POST"})}),getDefaultTemplates:p.query({queryFn:async()=>({data:(0,g.D)(t)})})})}),{usePreviewTemplateMutation:A}=T},46787:(Y,O,e)=>{e.r(O),e.d(O,{ActiveTab:()=>et,ContactPointsPageContents:()=>ct,default:()=>It});var t=e(74848),g=e(96540),o=e(92745),M=e(6975),l=e(50201),d=e(45861),T=e(41654),A=e(34999),p=e(66404),a=e(54314),C=e(60208),K=e(13941),u=e(34213),$=e(73427),J=e(56476),V=e(77256),D=e(11257),n=e(16692),s=e(74048),m=e(20962),c=e(5358),P=e(15633),j=e(52161),w=e(88547),B=e(36826),H=e(35526),Q=e(24961),q=e(25992),r=e(63142),b=e(71599),U=e(45967),E=e(99887),y=e(64762),z=e(16194),S=e(24898),f=e(27911),k=e(12266),ot=e(40165),_=e(1972),tt=e(40403),Z=e(71774),dt=e(1332);const pt=({alertManagerName:i,templates:h})=>{const L=(0,y._2)(),[I]=(0,tt._3)({alertmanager:i}),R=(0,r.of)(f.L),[x,N]=(0,g.useState)(),G=async()=>{if(x)try{await I.execute({uid:x.uid}),L.success("Template deleted",`Template ${x.title} has been deleted`)}catch(v){L.error("Error deleting template",`Error deleting template ${x.title}`);const F=v instanceof Error?v:new Error((0,V.JZ)(v));(0,q.vV)(F)}N(void 0)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("table",{className:R.table,"data-testid":"templates-table",children:[(0,t.jsxs)("colgroup",{children:[(0,t.jsx)("col",{className:R.colExpand}),(0,t.jsx)("col",{}),(0,t.jsx)("col",{})]}),(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{}),(0,t.jsx)("th",{children:(0,t.jsx)(o.x6,{i18nKey:"alerting.templates-table.template-group",children:"Template group"})}),(0,t.jsx)(S._,{actions:[n.QI.CreateNotificationTemplate,n.QI.UpdateNotificationTemplate,n.QI.DeleteNotificationTemplate],children:(0,t.jsx)("th",{children:(0,t.jsx)(o.x6,{i18nKey:"alerting.templates-table.actions",children:"Actions"})})})]})}),(0,t.jsxs)("tbody",{children:[!h.length&&(0,t.jsx)("tr",{className:R.evenRow,children:(0,t.jsx)("td",{colSpan:3,children:(0,t.jsx)(o.x6,{i18nKey:"alerting.templates-table.no-templates-defined",children:"No templates defined."})})}),h.map((v,F)=>(0,t.jsx)(mt,{notificationTemplate:v,idx:F,alertManagerName:i,onDeleteClick:N},v.uid))]})]}),!!x&&(0,t.jsx)(b.u,{isOpen:!0,title:(0,o.t)("alerting.templates-table.title-delete-template-group","Delete template group"),body:(0,o.t)("alerting.templates-table.body-delete-template-group",'Are you sure you want to delete template group "{{template}}"?',{template:x.title}),confirmText:(0,o.t)("alerting.templates-table.confirmText-yes-delete","Yes, delete"),onConfirm:G,onDismiss:()=>N(void 0)})]})};function mt({notificationTemplate:i,idx:h,alertManagerName:L,onDeleteClick:I}){const R=(0,r.of)(f.L),x=L===j.hY,[N,G]=(0,g.useState)(!1),{isProvisioned:v}=(0,tt.OA)(i),{uid:F,title:W,content:X,missing:nt}=i,at=(0,o.t)("alerting.templates.misconfigured-badge-text","Misconfigured");return(0,t.jsxs)(g.Fragment,{children:[(0,t.jsxs)("tr",{className:h%2===0?R.evenRow:void 0,children:[(0,t.jsx)("td",{children:(0,t.jsx)(k.e,{isCollapsed:!N,onToggle:()=>G(!N)})}),(0,t.jsxs)("td",{children:[W," ",v&&(0,t.jsx)(_.rS,{})," ",nt&&!x&&(0,t.jsx)(U.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.x6,{i18nKey:"alerting.templates.misconfigured-warning",children:"This template is misconfigured."}),(0,t.jsx)("br",{}),(0,t.jsxs)(o.x6,{i18nKey:"alerting.templates.misconfigured-warning-details",children:["Templates must be defined in both the"," ",(0,t.jsx)(z.X,{content:(0,o.t)("alerting.template-row.content-templatefiles","template_files")})," and"," ",(0,t.jsx)(z.X,{content:(0,o.t)("alerting.template-row.content-templates","templates")})," sections of your alertmanager configuration."]})]}),children:(0,t.jsx)("span",{children:(0,t.jsx)(E.E,{text:at,color:"orange"})})})]}),(0,t.jsxs)("td",{className:R.actionsCell,children:[v&&(0,t.jsx)(Z.M,{to:(0,V.nL)(`/alerting/notifications/templates/${encodeURIComponent(F)}/edit`,L),tooltip:(0,o.t)("alerting.template-row.tooltip-view-template","view template"),icon:"file-alt"}),!v&&(0,t.jsx)(S._,{actions:[n.QI.UpdateNotificationTemplate],children:(0,t.jsx)(Z.M,{to:(0,V.nL)(`/alerting/notifications/templates/${encodeURIComponent(F)}/edit`,L),tooltip:(0,o.t)("alerting.template-row.tooltip-edit-template-group","Edit template group"),icon:"pen"})}),(0,t.jsx)(S._,{actions:[n.QI.CreateNotificationTemplate],children:(0,t.jsx)(Z.M,{to:(0,V.nL)(`/alerting/notifications/templates/${encodeURIComponent(F)}/duplicate`,L),tooltip:(0,o.t)("alerting.template-row.tooltip-copy-template-group","Copy template group"),icon:"copy"})}),!v&&(0,t.jsx)(S._,{actions:[n.QI.DeleteNotificationTemplate],children:(0,t.jsx)(Z.M,{onClick:()=>I(i),tooltip:(0,o.t)("alerting.template-row.tooltip-delete-template-group","Delete template group"),icon:"trash-alt"})})]})]}),N&&(0,t.jsxs)("tr",{className:h%2===0?R.evenRow:void 0,children:[(0,t.jsx)("td",{}),(0,t.jsx)("td",{colSpan:2,children:(0,t.jsx)(ot.X,{label:"",horizontal:!0,children:(0,t.jsx)(dt.K,{width:"auto",height:"auto",autoHeight:!0,value:X,showLineNumbers:!1,monacoOptions:{readOnly:!0,scrollBeyondLastLine:!1}})})})]})]},F)}const gt=()=>{const{selectedAlertmanager:i}=(0,c.VI)(),{data:h,isLoading:L,error:I}=(0,tt.cC)({alertmanager:i??""});return I?(0,t.jsx)(A.F,{title:(0,o.t)("alerting.notification-templates.title-failed-to-fetch-notification-templates","Failed to fetch notification templates"),children:(0,V.JZ)(I)}):L?(0,t.jsx)(M._,{text:(0,o.t)("alerting.notification-templates.text-loading-notification-templates","Loading notification templates")}):h?(0,t.jsx)(pt,{alertManagerName:i,templates:h}):null};var ut=e(22803),ft=e(40996),ht=e(37386),xt=e(63527),bt=e(30703);const vt=()=>{const i=(0,r.of)(Tt),[h,L]=(0,m.l)(),I=h.get("search")??"",[R,x]=(0,g.useState)(I),[N,G]=(0,ft.A)(()=>{L({search:R},!0)},300,[L,R]),v=(0,g.useCallback)(()=>{G(),x(""),L({search:""},!0)},[G,L]),F=!!I;return(0,t.jsxs)(T.B,{direction:"row",alignItems:"end",gap:.5,children:[(0,t.jsx)(ht.D,{className:i.noBottom,label:(0,o.t)("alerting.contact-points-filter.label-search-by-name-or-type","Search by name or type"),children:(0,t.jsx)(xt.p,{"aria-label":(0,o.t)("alerting.contact-points-filter.aria-label-search-contact-points","search contact points"),placeholder:(0,o.t)("alerting.contact-points-filter.placeholder-search","Search"),width:46,prefix:(0,t.jsx)(bt.I,{name:"search"}),onChange:W=>{x(W.currentTarget.value)},value:R})}),(0,t.jsx)(d.$n,{variant:"secondary",icon:"times",onClick:()=>v(),disabled:!F,"aria-label":(0,o.t)("alerting.contact-points-filter.aria-label-clear","clear"),children:(0,t.jsx)(o.x6,{i18nKey:"alerting.contact-points-filter.clear",children:"Clear"})})]})},Tt=()=>({noBottom:(0,ut.css)({marginBottom:0})}),At=({alertManagerName:i})=>{const h=(0,j.AL)(i);return(0,t.jsx)(S._,{actions:[n.QI.UpdateExternalConfiguration],children:(0,t.jsxs)(A.F,{severity:"info",title:(0,o.t)("alerting.global-config-alert.title-global-config-for-contact-points","Global config for contact points"),children:[(0,t.jsx)("p",{children:(0,t.jsx)(o.x6,{i18nKey:"alerting.global-config-alert.body",children:"For each external Alertmanager you can define global settings, like server addresses, usernames and password, for all the supported contact points."})}),(0,t.jsx)(d.z9,{href:(0,V.nL)("alerting/notifications/global-config",i),variant:"secondary",children:h?(0,o.t)("alerting.global-config-alert.view-global-config","View global config"):(0,o.t)("alerting.global-config-alert.edit-global-config","Edit global config")})]})})};var it=e(97507),Ct=e(84139),yt=e(2543),St=e(3887);const st=new Ct.A({intraMode:1,intraIns:1,intraSub:1,intraDel:1,intraTrn:1}),jt=(i,h)=>{const L=(0,g.useMemo)(()=>i.map(G=>G.name),[i]),I=(0,g.useMemo)(()=>i.map(G=>G.grafana_managed_receiver_configs.map(v=>v[St.MX].name).join(" ")),[i]);if(!h)return i;const R=st.filter(L,h)??[],x=st.filter(I,h)??[],N=[...R,...x];return(0,yt.uniq)(N).map(G=>i[G])??[]};var lt=e(8307),et=(i=>(i.ContactPoints="contact_points",i.NotificationTemplates="templates",i))(et||{});const rt=10,Lt=()=>{const{selectedAlertmanager:i}=(0,c.VI)(),[h]=(0,m.l)(),L=!(0,J.dM)(i),I=$.TP.hasPermission(D.w.AlertingNotificationsRead),{isLoading:R,error:x,contactPoints:N}=(0,it.dK)({alertmanager:i,fetchPolicies:L,fetchStatuses:I}),[G,v]=(0,n.L7)(n.QI.CreateContactPoint),[F,W]=(0,n.L7)(n.QI.ExportContactPoint),[X,nt]=(0,lt.G)(),at=h.get("search");if(R)return(0,t.jsx)(M._,{text:(0,o.t)("alerting.contact-points-tab.text-loading","Loading...")});const Gt=i===j.hY;return N.length===0?(0,t.jsx)(l.p,{variant:v?"call-to-action":"not-found",button:v&&(0,t.jsx)(d.z9,{href:(0,V.nL)("/alerting/notifications/receivers/new",i),icon:"plus",size:"lg",children:(0,t.jsx)(o.x6,{i18nKey:"alerting.contact-points.create",children:"Create contact point"})}),message:(0,o.t)("alerting.contact-points.empty-state.title","You don't have any contact points yet")}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(T.B,{direction:"row",alignItems:"end",justifyContent:"space-between",children:[(0,t.jsx)(vt,{}),(0,t.jsxs)(T.B,{direction:"row",gap:1,children:[G&&(0,t.jsx)(d.z9,{icon:"plus","aria-label":(0,o.t)("alerting.contact-points-tab.aria-label-add-contact-point","add contact point"),variant:"primary",href:"/alerting/notifications/receivers/new",disabled:!v,children:(0,t.jsx)(o.x6,{i18nKey:"alerting.contact-points.create",children:"Create contact point"})}),F&&(0,t.jsx)(d.$n,{icon:"download-alt",variant:"secondary","aria-label":(0,o.t)("alerting.contact-points-tab.aria-label-export-all","export all"),disabled:!W,onClick:()=>nt(lt.B),children:(0,t.jsx)(o.x6,{i18nKey:"alerting.contact-points-tab.export-all",children:"Export all"})})]})]}),x?(0,t.jsx)(A.F,{title:(0,o.t)("alerting.contact-points-tab.title-failed-to-fetch-contact-points","Failed to fetch contact points"),children:(0,V.JZ)(x)}):(0,t.jsx)(Dt,{contactPoints:N,search:at,pageSize:rt}),!Gt&&!(0,P.b)(i)&&(0,t.jsx)(At,{alertManagerName:i}),X]})},Pt=()=>{const[i,h]=(0,n.L7)(n.QI.CreateNotificationTemplate);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(T.B,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,t.jsx)(p.E,{variant:"body",color:"secondary",children:(0,t.jsx)(o.x6,{i18nKey:"alerting.notification-templates-tab.create-notification-templates-customize-notifications",children:"Create notification templates to customize your notifications."})}),i&&(0,t.jsx)(d.z9,{icon:"plus",variant:"primary",href:"/alerting/notifications/templates/new",disabled:!h,children:(0,t.jsx)(o.x6,{i18nKey:"alerting.notification-templates-tab.add-notification-template-group",children:"Add notification template group"})})]}),(0,t.jsx)(gt,{})]})},Rt=i=>{const[h,L]=(0,m.l)();return[(0,g.useMemo)(()=>{const x=h.get("tab");return!x||!Object.values(et).map(String).includes(x)?i:x||i},[i,h]),x=>L({tab:x})]},ct=()=>{const{selectedAlertmanager:i}=(0,c.VI)(),[,h]=(0,n.L7)(n.QI.ViewContactPoint),[,L]=(0,n.L7)(n.QI.CreateContactPoint),[,I]=(0,n.L7)(n.QI.ViewNotificationTemplate),R=h||L,x=[R&&"contact_points",I&&"templates"].filter(X=>!!X)[0],[N,G]=Rt(x),{contactPoints:v}=(0,it.dK)({alertmanager:i}),F=N==="contact_points",W=N==="templates";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.e,{currentAlertmanager:i}),(0,t.jsxs)(T.B,{direction:"column",children:[(0,t.jsxs)(a.U,{children:[R&&(0,t.jsx)(C.o,{label:(0,o.t)("alerting.contact-points-page-contents.label-contact-points","Contact Points"),active:F,counter:v.length,onChangeTab:()=>G("contact_points")}),I&&(0,t.jsx)(C.o,{label:(0,o.t)("alerting.contact-points-page-contents.label-notification-templates","Notification Templates"),active:W,onChangeTab:()=>G("templates")})]}),(0,t.jsx)(K.J,{children:(0,t.jsxs)(T.B,{direction:"column",children:[F&&(0,t.jsx)(Lt,{}),W&&(0,t.jsx)(Pt,{})]})})]})]})},Dt=({contactPoints:i,search:h,pageSize:L=rt})=>{const I=jt(i,h),{page:R,pageItems:x,numberOfPages:N,onPageChange:G}=(0,s.W)(I,1,L);if(x.length===0){const v=(0,o.t)("alerting.contact-points.no-contact-points-found","No contact points found");return(0,t.jsx)(l.p,{variant:"not-found",message:v})}return(0,t.jsxs)(t.Fragment,{children:[x.map((v,F)=>{const W=`${v.name}-${F}`;return(0,t.jsx)(Q.z8,{contactPoint:v},W)}),(0,t.jsx)(u.d,{currentPage:R,numberOfPages:N,onNavigate:G,hideWhenSinglePage:!0})]})};function Et(){return(0,t.jsx)(B.y,{navId:"receivers",accessType:"notification",children:(0,t.jsx)(ct,{})})}const It=(0,w.S)(Et)},71774:(Y,O,e)=>{e.d(O,{M:()=>o});var t=e(74848),g=e(45861);const o=({tooltip:M,icon:l,to:d,target:T,onClick:A,className:p,tooltipPlacement:a="top",...C})=>{const K=typeof M=="string"?M:void 0;return d?(0,t.jsx)(g.z9,{tooltip:M,tooltipPlacement:a,variant:"secondary",fill:"text",icon:l,href:d,size:"sm",target:T,...C,"aria-label":K}):(0,t.jsx)(g.$n,{tooltip:M,tooltipPlacement:a,className:p,variant:"secondary",fill:"text",size:"sm",icon:l,type:"button",onClick:A,...C,"aria-label":K})}},87988:(Y,O,e)=>{e.d(O,{D:()=>t,G7:()=>M,Jl:()=>g,gY:()=>o});function t(l){const d={},T=[],A=/{{-?\s*(define|end|if|range|else|with|template|block)\b(.*?)-?}}/gs;let p,a=0;for(;(p=A.exec(l))!==null;){const[,C,K]=p;if(a=p.index,C==="define"){const u=K?.match(/"([^"]+)"/);u&&T.push({type:"define",startIndex:a,name:u[1]})}else if(C==="end"){let u=T.pop();for(;u&&u.type!=="define"&&u.type!=="if"&&u.type!=="range"&&u.type!=="with"&&u.type!=="block";)u=T.pop();if(u){const $=A.lastIndex;u.type==="define"&&!u.name?.startsWith("__")&&(d[u.name]={name:u.name,content:l.slice(u.startIndex,$)})}}else(C==="if"||C==="range"||C==="else"||C==="with"||C==="block")&&T.push({type:C,startIndex:a})}for(const C of Object.values(d)){const K=/{{ template "([^"]+)" }}/g;let u;for(;(u=K.exec(C.content))!==null;){const $=u[1];d[$]?.content&&(C.content+=`
`+d[$]?.content,delete d[$])}}return Object.values(d)}function g(l){return`{{ template "${l}" . }}`}function o(l){const d=l.match(/\{\{\s*template\s*"(.*)"\s*\.\s*\}\}/);return d?d[1]:""}function M(l){const d=/\{\{\s*template\s*".*?"\s*\.\s*\}\}/g;if(l.match(d)?.length!==1)return!1;const A=l.split(d);for(const p of A)if(p.trim()!=="")return!1;return!0}}}]);

//# sourceMappingURL=6787.669d030599b534115f55.js.map