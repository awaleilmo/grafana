{"version":3,"file":"canvasPanel.572c874964db762f86b5.js","mappings":"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","sources":["webpack://grafana/./public/app/plugins/panel/status-history/utils.ts","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipHeader.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipContent.tsx","webpack://grafana/./public/app/features/canvas/elements/notFound.tsx","webpack://grafana/./public/app/plugins/panel/canvas/types.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ParamsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/utils.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/APIEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ButtonStyleEditor.tsx","webpack://grafana/./public/app/features/canvas/element.ts","webpack://grafana/./public/app/features/canvas/types.ts","webpack://grafana/./public/app/features/canvas/elements/button.tsx","webpack://grafana/./public/app/features/canvas/elements/cloud.tsx","webpack://grafana/./public/app/features/canvas/elements/droneFront.tsx","webpack://grafana/./public/app/features/canvas/elements/droneSide.tsx","webpack://grafana/./public/app/features/canvas/elements/droneTop.tsx","webpack://grafana/./public/app/features/canvas/elements/ellipse.tsx","webpack://grafana/./public/app/features/canvas/elements/icon.tsx","webpack://grafana/./public/app/features/canvas/elements/metricValue.tsx","webpack://grafana/./public/app/features/canvas/elements/parallelogram.tsx","webpack://grafana/./public/app/features/canvas/elements/rectangle.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/database.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/single.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/stack.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/terminal.tsx","webpack://grafana/./public/app/features/canvas/elements/server/server.tsx","webpack://grafana/./public/app/features/canvas/elements/text.tsx","webpack://grafana/./public/app/features/canvas/elements/triangle.tsx","webpack://grafana/./public/app/features/canvas/elements/windTurbine.tsx","webpack://grafana/./public/app/features/canvas/registry.ts","webpack://grafana/./public/app/features/canvas/runtime/element.tsx","webpack://grafana/./public/app/plugins/panel/canvas/utils.ts","webpack://grafana/./node_modules/@daybrush/utils/dist/utils.esm.js","webpack://grafana/./node_modules/@scena/event-emitter/dist/event-emitter.esm.js","webpack://grafana/./node_modules/gesto/dist/gesto.esm.js","webpack://grafana/./node_modules/framework-utils/dist/utils.esm.js","webpack://grafana/./node_modules/css-styled/dist/styled.esm.js","webpack://grafana/./node_modules/@egjs/agent/dist/agent.esm.js","webpack://grafana/./node_modules/infinite-viewer/dist/infinite-viewer.esm.js","webpack://grafana/./node_modules/@egjs/list-differ/dist/list-differ.esm.js","webpack://grafana/./node_modules/croact/dist/croact.esm.js","webpack://grafana/./node_modules/@scena/matrix/dist/matrix.esm.js","webpack://grafana/./node_modules/css-to-mat/dist/css-to-mat.esm.js","webpack://grafana/./node_modules/@egjs/children-differ/dist/children-differ.esm.js","webpack://grafana/./node_modules/@scena/dragscroll/dist/dragscroll.esm.js","webpack://grafana/./node_modules/overlap-area/dist/overlap-area.esm.js","webpack://grafana/./node_modules/croact-css-styled/dist/styled.esm.js","webpack://grafana/./node_modules/croact-moveable/dist/moveable.esm.js","webpack://grafana/./node_modules/moveable/dist/moveable.esm.js","webpack://grafana/./node_modules/keycon/dist/keycon.esm.js","webpack://grafana/./node_modules/selecto/dist/selecto.esm.js","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionAnchors.tsx","webpack://grafana/./public/app/features/canvas/runtime/sceneElementManagement.ts","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionSVG.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/Connections.tsx","webpack://grafana/./public/app/features/canvas/runtime/ables.tsx","webpack://grafana/./public/app/features/canvas/runtime/sceneAbleManagement.ts","webpack://grafana/./public/app/features/canvas/runtime/frame.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/CanvasContextMenu.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/CanvasTooltip.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionAnchors2.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionSVG2.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/Connections2.tsx","webpack://grafana/./public/app/features/canvas/runtime/root.tsx","webpack://grafana/./public/app/features/canvas/runtime/scene.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/SetBackground.tsx","webpack://grafana/./public/app/features/dimensions/editors/BackgroundSizeEditor.tsx","webpack://grafana/./public/app/features/dimensions/editors/DirectionDimensionEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/LineStyleEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ActionsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/DataLinksEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/options.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/connectionEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ConstraintSelectionBox.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/QuickPositioning.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/PlacementEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/elementEditor.tsx","webpack://grafana/./node_modules/rc-tree/es/contextTypes.js","webpack://grafana/./node_modules/rc-tree/es/DropIndicator.js","webpack://grafana/./node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js","webpack://grafana/./node_modules/rc-tree/es/Indent.js","webpack://grafana/./node_modules/rc-tree/es/TreeNode.js","webpack://grafana/./node_modules/rc-tree/es/useUnmount.js","webpack://grafana/./node_modules/rc-tree/es/MotionTreeNode.js","webpack://grafana/./node_modules/rc-tree/es/utils/diffUtil.js","webpack://grafana/./node_modules/rc-tree/es/NodeList.js","webpack://grafana/./node_modules/rc-tree/es/util.js","webpack://grafana/./node_modules/rc-tree/es/Tree.js","webpack://grafana/./node_modules/rc-tree/es/index.js","webpack://grafana/./public/app/plugins/panel/canvas/globalStyles.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/TreeNodeTitle.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/tree.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/TreeNavigationEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/layerEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/TabsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/InlineEditBody.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/InlineEdit.tsx","webpack://grafana/./public/app/plugins/panel/canvas/CanvasPanel.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/panZoomHelp.tsx","webpack://grafana/./public/app/plugins/panel/canvas/migrations.ts","webpack://grafana/./public/app/plugins/panel/canvas/module.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipColorIndicator.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipRow.tsx"],"sourcesContent":["import { DataFrame, ActionModel, Field, InterpolateFunction, LinkModel } from '@grafana/data';\nimport { getActions } from 'app/features/actions/utils';\n\nexport const getDataLinks = (field: Field, rowIdx: number) => {\n  const links: Array<LinkModel<Field>> = [];\n\n  if ((field.config.links?.length ?? 0) > 0 && field.getLinks != null) {\n    const v = field.values[rowIdx];\n    const disp = field.display ? field.display(v) : { text: `${v}`, numeric: +v };\n\n    const linkLookup = new Set<string>();\n\n    field.getLinks({ calculatedValue: disp, valueRowIndex: rowIdx }).forEach((link) => {\n      const key = `${link.title}/${link.href}`;\n      if (!linkLookup.has(key)) {\n        links.push(link);\n        linkLookup.add(key);\n      }\n    });\n  }\n\n  return links;\n};\n\nexport const getAllFrameActions = (dataFrame: DataFrame) => {};\n\nexport const getFieldActions = (\n  dataFrame: DataFrame,\n  field: Field,\n  replaceVars: InterpolateFunction,\n  rowIndex: number\n) => {\n  const actions: Array<ActionModel<Field>> = [];\n  const actionLookup = new Set<string>();\n\n  const actionsModel = getActions(dataFrame, field, field.state!.scopedVars!, replaceVars, field.config.actions ?? [], {\n    valueRowIndex: rowIndex,\n  });\n\n  actionsModel.forEach((action) => {\n    const key = `${action.title}`;\n    if (!actionLookup.has(key)) {\n      actions.push(action);\n      actionLookup.add(key);\n    }\n  });\n\n  return actions;\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface Props {\n  item: VizTooltipItem;\n  isPinned: boolean;\n}\nexport const VizTooltipHeader = ({ item, isPinned }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const { label, value, color, colorIndicator } = item;\n\n  return (\n    <div className={styles.wrapper}>\n      <VizTooltipRow\n        label={label}\n        value={value}\n        color={color}\n        colorIndicator={colorIndicator}\n        marginRight={'22px'}\n        isPinned={isPinned}\n      />\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    padding: theme.spacing(1),\n    lineHeight: 1,\n  }),\n});\n","import { css } from '@emotion/css';\nimport { CSSProperties, ReactNode } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface VizTooltipContentProps {\n  items: VizTooltipItem[];\n  children?: ReactNode;\n  scrollable?: boolean;\n  isPinned: boolean;\n  maxHeight?: number;\n}\n\nexport const VizTooltipContent = ({\n  items,\n  children,\n  isPinned,\n  scrollable = false,\n  maxHeight,\n}: VizTooltipContentProps) => {\n  const styles = useStyles2(getStyles);\n\n  const scrollableStyle: CSSProperties = scrollable\n    ? {\n        maxHeight: maxHeight,\n        overflowY: 'auto',\n      }\n    : {};\n\n  return (\n    <div className={styles.wrapper} style={scrollableStyle}>\n      {items.map(({ label, value, color, colorIndicator, colorPlacement, isActive, lineStyle, isHiddenFromViz }, i) => (\n        <VizTooltipRow\n          key={i}\n          label={label}\n          value={value}\n          color={color}\n          colorIndicator={colorIndicator}\n          colorPlacement={colorPlacement}\n          isActive={isActive}\n          justify={'space-between'}\n          isPinned={isPinned}\n          lineStyle={lineStyle}\n          showValueScroll={!scrollable}\n          isHiddenFromViz={isHiddenFromViz}\n        />\n      ))}\n      {children}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    gap: 2,\n    borderTop: `1px solid ${theme.colors.border.weak}`,\n    padding: theme.spacing(1),\n  }),\n});\n","import { PureComponent } from 'react';\n\nimport { Trans } from '@grafana/i18n';\n\nimport { CanvasElementItem, CanvasElementProps } from '../element';\n\nclass NotFoundDisplay extends PureComponent<CanvasElementProps> {\n  render() {\n    const { config } = this.props;\n    return (\n      <div>\n        <Trans\n          i18nKey=\"canvas.not-found-display.not-found\"\n          components={{ config: <pre>{JSON.stringify(config, null, 2)}</pre> }}\n        >\n          <h3>Not found: </h3>\n          {'<config />'}\n        </Trans>\n      </div>\n    );\n  }\n}\n\nexport const notFoundItem: CanvasElementItem = {\n  id: 'not-found',\n  name: 'Not found',\n  description: 'Display when element type is not found in the registry',\n\n  display: NotFoundDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: () => ({\n    config: {},\n  }),\n};\n","import { ElementState } from '../../../features/canvas/runtime/element';\n\nimport { CanvasConnection, ConnectionCoordinates } from './panelcfg.gen';\n\nexport enum LayerActionID {\n  Delete = 'delete',\n  Duplicate = 'duplicate',\n  MoveTop = 'move-top',\n  MoveBottom = 'move-bottom',\n}\n\nexport interface DragNode {\n  key: number;\n  dataRef: ElementState;\n}\n\nexport interface DropNode extends DragNode {\n  pos: string;\n}\n\nexport enum InlineEditTabs {\n  ElementManagement = 'element-management',\n  SelectedElement = 'selected-element',\n  SelectedConnection = 'selected-connection',\n}\n\nexport type AnchorPoint = {\n  x: number;\n  y: number;\n};\n\nexport interface CanvasTooltipPayload {\n  anchorPoint: AnchorPoint | undefined;\n  element: ElementState | undefined;\n  isOpen?: boolean;\n}\n\nexport interface ConnectionState {\n  index: number; // array index from the source\n  source: ElementState;\n  target: ElementState;\n  info: CanvasConnection;\n  vertices?: ConnectionCoordinates[];\n  sourceOriginal?: ConnectionCoordinates;\n  targetOriginal?: ConnectionCoordinates;\n}\n\nexport enum LineStyle {\n  Solid = 'solid',\n  Dashed = 'dashed',\n  Dotted = 'dotted',\n}\n\nexport enum StrokeDasharray {\n  Solid = '0',\n  Dashed = '8 8',\n  Dotted = '3',\n}\n","import { useState } from 'react';\nimport * as React from 'react';\n\nimport { t } from '@grafana/i18n';\nimport { IconButton, Input, Stack } from '@grafana/ui';\n\ninterface Props {\n  onChange: (v: Array<[string, string]>) => void;\n  value: Array<[string, string]>;\n}\n\nexport const ParamsEditor = ({ value, onChange }: Props) => {\n  const [paramName, setParamName] = useState('');\n  const [paramValue, setParamValue] = useState('');\n\n  const changeParamValue = ({ currentTarget }: React.ChangeEvent<HTMLInputElement>) => {\n    setParamValue(currentTarget.value);\n  };\n\n  const changeParamName = ({ currentTarget }: React.ChangeEvent<HTMLInputElement>) => {\n    setParamName(currentTarget.value);\n  };\n\n  const removeParam = (key: string) => () => {\n    const updatedParams = value.filter((param) => param[0] !== key);\n    onChange(updatedParams);\n  };\n\n  const addParam = () => {\n    const key = paramName;\n    let newParams: Array<[string, string]>;\n    if (value) {\n      newParams = value.filter((e) => e[0] !== key);\n    } else {\n      newParams = [];\n    }\n    newParams.push([key, paramValue]);\n    newParams.sort((a, b) => a[0].localeCompare(b[0]));\n\n    setParamName('');\n    setParamValue('');\n    onChange(newParams);\n  };\n\n  const isAddParamsDisabled = !paramName && !paramValue;\n\n  return (\n    <div>\n      <Stack direction=\"row\">\n        <Input\n          placeholder={t('canvas.params-editor.placeholder-key', 'Key')}\n          value={paramName}\n          onChange={changeParamName}\n        />\n        <Input\n          placeholder={t('canvas.params-editor.placeholder-value', 'Value')}\n          value={paramValue}\n          onChange={changeParamValue}\n        />\n        <IconButton\n          aria-label={t('canvas.params-editor.aria-label-add', 'Add')}\n          name=\"plus-circle\"\n          onClick={addParam}\n          disabled={isAddParamsDisabled}\n        />\n      </Stack>\n      <Stack direction=\"column\">\n        {Array.from(value || []).map((entry) => (\n          <Stack key={entry[0]} direction=\"row\">\n            <Input disabled value={entry[0]} />\n            <Input disabled value={entry[1]} />\n            <IconButton\n              aria-label={t('canvas.params-editor.aria-label-delete', 'Delete')}\n              onClick={removeParam(entry[0])}\n              name=\"trash-alt\"\n            />\n          </Stack>\n        ))}\n      </Stack>\n    </div>\n  );\n};\n","import { AppEvents, textUtil } from '@grafana/data';\nimport { BackendSrvRequest, getBackendSrv, getTemplateSrv } from '@grafana/runtime';\nimport { appEvents } from 'app/core/core';\nimport { createAbsoluteUrl, RelativeUrl } from 'app/features/alerting/unified/utils/url';\nimport { getDashboardSrv } from 'app/features/dashboard/services/DashboardSrv';\n\nimport { HttpRequestMethod } from '../../panelcfg.gen';\n\nimport { APIEditorConfig } from './APIEditor';\n\ntype IsLoadingCallback = (loading: boolean) => void;\n\nexport const callApi = (api: APIEditorConfig, updateLoadingStateCallback?: IsLoadingCallback) => {\n  if (!api.endpoint) {\n    appEvents.emit(AppEvents.alertError, ['API endpoint is not defined.']);\n    return;\n  }\n\n  const request = getRequest(api);\n\n  getBackendSrv()\n    .fetch(request)\n    .subscribe({\n      error: (error) => {\n        appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n        console.error('API call error: ', error);\n        updateLoadingStateCallback && updateLoadingStateCallback(false);\n      },\n      complete: () => {\n        appEvents.emit(AppEvents.alertSuccess, ['API call was successful']);\n        updateLoadingStateCallback && updateLoadingStateCallback(false);\n      },\n    });\n};\n\nexport const interpolateVariables = (text: string) => {\n  const panel = getDashboardSrv().getCurrent()?.panelInEdit;\n  return getTemplateSrv().replace(text, panel?.scopedVars);\n};\n\nexport const getRequest = (api: APIEditorConfig) => {\n  const endpoint = getEndpoint(interpolateVariables(api.endpoint));\n  const url = new URL(endpoint);\n\n  const requestHeaders: Record<string, string> = {};\n\n  let request: BackendSrvRequest = {\n    url: url.toString(),\n    method: api.method,\n    data: getData(api),\n    headers: requestHeaders,\n  };\n\n  if (api.headerParams) {\n    api.headerParams.forEach(([name, value]) => {\n      requestHeaders[interpolateVariables(name)] = interpolateVariables(value);\n    });\n  }\n\n  if (api.queryParams) {\n    api.queryParams?.forEach(([name, value]) => {\n      url.searchParams.append(interpolateVariables(name), interpolateVariables(value));\n    });\n\n    request.url = url.toString();\n  }\n\n  if (api.method === HttpRequestMethod.POST) {\n    requestHeaders['Content-Type'] = api.contentType!;\n  }\n\n  requestHeaders['X-Grafana-Action'] = '1';\n  request.headers = requestHeaders;\n\n  return request;\n};\n\nconst getData = (api: APIEditorConfig) => {\n  let data: string | undefined = api.data ? interpolateVariables(api.data) : '{}';\n  if (api.method === HttpRequestMethod.GET) {\n    data = undefined;\n  }\n\n  return data;\n};\n\nconst getEndpoint = (endpoint: string) => {\n  const isRelativeUrl = endpoint.startsWith('/');\n  if (isRelativeUrl) {\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const sanitizedRelativeURL = textUtil.sanitizeUrl(endpoint) as RelativeUrl;\n    endpoint = createAbsoluteUrl(sanitizedRelativeURL, []);\n  }\n\n  return endpoint;\n};\n","import { useCallback } from 'react';\n\nimport {\n  StandardEditorProps,\n  StandardEditorsRegistryItem,\n  StringFieldConfigSettings,\n  SelectableValue,\n} from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { Button, Field, InlineField, InlineFieldRow, JSONFormatter, RadioButtonGroup, Select } from '@grafana/ui';\nimport { StringValueEditor } from 'app/core/components/OptionsUI/string';\nimport { defaultApiConfig } from 'app/features/canvas/elements/button';\n\nimport { HttpRequestMethod } from '../../panelcfg.gen';\n\nimport { ParamsEditor } from './ParamsEditor';\nimport { callApi, interpolateVariables } from './utils';\n\nexport interface APIEditorConfig {\n  method: string;\n  endpoint: string;\n  data?: string;\n  contentType?: string;\n  queryParams?: Array<[string, string]>;\n  headerParams?: Array<[string, string]>;\n}\n\nconst dummyStringSettings: StandardEditorsRegistryItem<string, StringFieldConfigSettings> = {\n  id: '',\n  name: '',\n  description: '',\n  editor: StringValueEditor,\n  settings: {},\n};\n\ntype Props = StandardEditorProps<APIEditorConfig>;\n\nconst httpMethodOptions = [\n  { label: HttpRequestMethod.GET, value: HttpRequestMethod.GET },\n  { label: HttpRequestMethod.POST, value: HttpRequestMethod.POST },\n  { label: HttpRequestMethod.PUT, value: HttpRequestMethod.PUT },\n];\n\nconst contentTypeOptions: SelectableValue[] = [\n  { label: 'JSON', value: 'application/json' },\n  { label: 'Text', value: 'text/plain' },\n  { label: 'JavaScript', value: 'application/javascript' },\n  { label: 'HTML', value: 'text/html' },\n  { label: 'XML', value: 'application/XML' },\n  { label: 'x-www-form-urlencoded', value: 'application/x-www-form-urlencoded' },\n];\n\nexport function APIEditor({ value, context, onChange }: Props) {\n  const LABEL_WIDTH = 13;\n\n  if (!value) {\n    value = defaultApiConfig;\n  }\n\n  const onEndpointChange = useCallback(\n    (endpoint = '') => {\n      onChange({\n        ...value,\n        endpoint,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onDataChange = useCallback(\n    (data?: string) => {\n      onChange({\n        ...value,\n        data,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onMethodChange = useCallback(\n    (method: string) => {\n      onChange({\n        ...value,\n        method,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onContentTypeChange = useCallback(\n    (contentType: SelectableValue<string>) => {\n      onChange({\n        ...value,\n        contentType: contentType?.value,\n      });\n    },\n    [onChange, value]\n  );\n\n  const formatCreateLabel = (input: string) => {\n    return input;\n  };\n\n  const onQueryParamsChange = useCallback(\n    (queryParams: Array<[string, string]>) => {\n      onChange({\n        ...value,\n        queryParams,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onHeaderParamsChange = useCallback(\n    (headerParams: Array<[string, string]>) => {\n      onChange({\n        ...value,\n        headerParams,\n      });\n    },\n    [onChange, value]\n  );\n\n  const renderJSON = (data: string) => {\n    try {\n      const json = JSON.parse(interpolateVariables(data));\n      return <JSONFormatter json={json} />;\n    } catch (error) {\n      if (error instanceof Error) {\n        return `Invalid JSON provided: ${error.message}`;\n      } else {\n        return 'Invalid JSON provided';\n      }\n    }\n  };\n\n  const renderTestAPIButton = (api: APIEditorConfig) => {\n    if (api && api.endpoint) {\n      return (\n        <Button\n          onClick={() => callApi(api)}\n          title={t('canvas.apieditor.render-test-apibutton.title-test-api', 'Test API')}\n        >\n          <Trans i18nKey=\"canvas.apieditor.render-test-apibutton.test-api\">Test API</Trans>\n        </Button>\n      );\n    }\n\n    return;\n  };\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label={t('canvas.apieditor.label-endpoint', 'Endpoint')} labelWidth={LABEL_WIDTH} grow={true}>\n          <StringValueEditor\n            context={context}\n            value={value?.endpoint}\n            onChange={onEndpointChange}\n            item={dummyStringSettings}\n          />\n        </InlineField>\n      </InlineFieldRow>\n      <InlineFieldRow>\n        <InlineField label={t('canvas.apieditor.label-method', 'Method')} labelWidth={LABEL_WIDTH} grow={true}>\n          <RadioButtonGroup value={value?.method} options={httpMethodOptions} onChange={onMethodChange} fullWidth />\n        </InlineField>\n      </InlineFieldRow>\n      {value?.method !== HttpRequestMethod.GET && (\n        <InlineFieldRow>\n          <InlineField\n            // eslint-disable-next-line @grafana/i18n/no-untranslated-strings\n            label=\"Content-Type\"\n            labelWidth={LABEL_WIDTH}\n            grow={true}\n          >\n            <Select\n              options={contentTypeOptions}\n              allowCustomValue={true}\n              formatCreateLabel={formatCreateLabel}\n              value={value?.contentType}\n              onChange={onContentTypeChange}\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n\n      <br />\n      <Field label={t('canvas.apieditor.label-query-parameters', 'Query parameters')}>\n        <ParamsEditor value={value?.queryParams ?? []} onChange={onQueryParamsChange} />\n      </Field>\n      <Field label={t('canvas.apieditor.label-header-parameters', 'Header parameters')}>\n        <ParamsEditor value={value?.headerParams ?? []} onChange={onHeaderParamsChange} />\n      </Field>\n      {value?.method !== HttpRequestMethod.GET && value?.contentType && (\n        <Field label={t('canvas.apieditor.label-payload', 'Payload')}>\n          <StringValueEditor\n            context={context}\n            value={value?.data ?? '{}'}\n            onChange={onDataChange}\n            item={{ ...dummyStringSettings, settings: { useTextarea: true } }}\n          />\n        </Field>\n      )}\n      {renderTestAPIButton(value)}\n      <br />\n      {value?.method !== HttpRequestMethod.GET &&\n        value?.contentType === defaultApiConfig.contentType &&\n        renderJSON(value?.data ?? '{}')}\n    </>\n  );\n}\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ButtonVariant, InlineField, InlineFieldRow, Select } from '@grafana/ui';\nimport { defaultStyleConfig } from 'app/features/canvas/elements/button';\n\nexport interface ButtonStyleConfig {\n  variant: ButtonVariant;\n}\n\ntype Props = StandardEditorProps<ButtonStyleConfig>;\n\nconst variantOptions: SelectableValue[] = [\n  { label: 'primary', value: 'primary' },\n  { label: 'secondary', value: 'secondary' },\n  { label: 'success', value: 'success' },\n  { label: 'destructive', value: 'destructive' },\n];\n\nexport const ButtonStyleEditor = ({ value, onChange }: Props) => {\n  if (!value) {\n    value = defaultStyleConfig;\n  }\n\n  const onVariantChange = useCallback(\n    (variant: SelectableValue<ButtonVariant>) => {\n      onChange({\n        ...value,\n        variant: variant?.value ?? defaultStyleConfig.variant,\n      });\n    },\n    [onChange, value]\n  );\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label={t('canvas.button-style-editor.label-variant', 'Variant')} grow={true}>\n          <Select options={variantOptions} value={value?.variant} onChange={onVariantChange} />\n        </InlineField>\n      </InlineFieldRow>\n    </>\n  );\n};\n","import { ComponentType } from 'react';\n\nimport { DataLink, RegistryItem, Action } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/internal';\nimport { ColorDimensionConfig, ScaleDimensionConfig, DirectionDimensionConfig } from '@grafana/schema';\nimport { config } from 'app/core/config';\nimport { BackgroundConfig, Constraint, LineConfig, Placement } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { LineStyleConfig } from '../../plugins/panel/canvas/editor/LineStyleEditor';\nimport { DimensionContext } from '../dimensions/context';\n\nimport { StandardEditorConfig } from './types';\n\n/**\n * This gets saved in panel json\n *\n * depending on the type, it may have additional config\n *\n * @alpha\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport interface CanvasElementOptions<TConfig = any> {\n  name: string; // configured unique display name\n  type: string;\n\n  // Custom options depending on the type\n  config?: TConfig;\n\n  // Standard options available for all elements\n  constraint?: Constraint; // defaults vertical - top, horizontal - left\n  placement?: Placement;\n  background?: BackgroundConfig;\n  border?: LineConfig;\n  connections?: CanvasConnection[];\n  links?: DataLink[];\n  actions?: Action[];\n}\n\n// Unit is percentage from the middle of the element\n// 0, 0 middle; -1, -1 bottom left; 1, 1 top right\nexport interface ConnectionCoordinates {\n  x: number;\n  y: number;\n}\n\nexport enum ConnectionPath {\n  Straight = 'straight',\n}\n\nexport enum ConnectionDirection {\n  Forward = 'forward',\n  Reverse = 'reverse',\n  Both = 'both',\n  None = 'none',\n}\n\nexport interface CanvasConnection {\n  source: ConnectionCoordinates;\n  target: ConnectionCoordinates;\n  targetName?: string;\n  path: ConnectionPath;\n  color?: ColorDimensionConfig;\n  size?: ScaleDimensionConfig;\n  lineStyle?: LineStyleConfig;\n  vertices?: ConnectionCoordinates[];\n  radius?: ScaleDimensionConfig;\n  direction?: DirectionDimensionConfig;\n  sourceOriginal?: ConnectionCoordinates;\n  targetOriginal?: ConnectionCoordinates;\n  // See https://github.com/anseki/leader-line#options for more examples of more properties\n}\n\nexport interface CanvasElementProps<TConfig = unknown, TData = unknown> {\n  // Saved config\n  config: TConfig;\n\n  // Raw data\n  data?: TData;\n\n  // If the element is currently selected\n  isSelected?: boolean;\n}\n\n/**\n * Canvas item builder\n *\n * @alpha\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport interface CanvasElementItem<TConfig = any, TData = any> extends RegistryItem {\n  /** The default width/height to use when adding  */\n  defaultSize?: Placement;\n\n  prepareData?: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TConfig>) => TData;\n\n  /** Component used to draw */\n  display: ComponentType<CanvasElementProps<TConfig, TData>>;\n\n  getNewOptions: (options?: CanvasElementOptions) => Omit<CanvasElementOptions<TConfig>, 'type' | 'name'>;\n\n  /** Build the configuration UI */\n  registerOptionsUI?: PanelOptionsSupplier<CanvasElementOptions<TConfig>>;\n\n  /** If item has an edit mode */\n  hasEditMode?: boolean;\n\n  /** Optional config to customize what standard element editor options are available for the item */\n  standardEditorConfig?: StandardEditorConfig;\n\n  /** Custom connection anchor coordinates, like for svg elements such as triangle, cloud, etc */\n  customConnectionAnchors?: Array<{\n    x: number;\n    y: number;\n  }>;\n}\n\nexport const defaultBgColor = '#D9D9D9';\nexport const defaultTextColor = '#000000';\nexport const defaultLightTextColor = '#F0F4FD';\nexport const defaultThemeTextColor = config.theme2.colors.text.primary;\n","import { LinkModel } from '@grafana/data';\nimport { ColorDimensionConfig, ResourceDimensionConfig, TextDimensionConfig } from '@grafana/schema';\nimport { BackgroundImageSize } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nexport enum QuickPlacement {\n  Top = 'top',\n  Bottom = 'bottom',\n  Left = 'left',\n  Right = 'right',\n  HorizontalCenter = 'hcenter',\n  VerticalCenter = 'vcenter',\n}\n\nexport enum Align {\n  Left = 'left',\n  Center = 'center',\n  Right = 'right',\n}\n\nexport enum VAlign {\n  Top = 'top',\n  Middle = 'middle',\n  Bottom = 'bottom',\n}\n\nexport interface TextData {\n  text?: string;\n  color?: string;\n  size?: number; // 0 or missing will \"auto size\"\n  align: Align;\n  valign: VAlign;\n  links?: LinkModel[];\n  field?: string;\n}\n\nexport interface TextConfig {\n  text?: TextDimensionConfig;\n  color?: ColorDimensionConfig;\n  size?: number; // 0 or missing will \"auto size\"\n  align: Align;\n  valign: VAlign;\n}\n\nexport interface CanvasElementConfig extends TextConfig {\n  backgroundColor?: ColorDimensionConfig;\n  backgroundImage?: ResourceDimensionConfig;\n  backgroundSize?: BackgroundImageSize;\n  borderColor?: ColorDimensionConfig;\n  borderWidth?: number;\n}\n\nexport interface CanvasElementData extends TextData {\n  backgroundColor?: string;\n  backgroundImage?: string;\n  backgroundSize?: string;\n  borderColor?: string;\n  borderWidth?: number;\n}\n\nexport interface StandardEditorConfig {\n  layout?: boolean;\n  background?: boolean;\n  border?: boolean;\n}\n","import { css } from '@emotion/css';\nimport { useState } from 'react';\n\nimport { GrafanaTheme2, PluginState } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { TextDimensionMode } from '@grafana/schema';\nimport { Button, Spinner, useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\nimport { APIEditor, APIEditorConfig } from 'app/plugins/panel/canvas/editor/element/APIEditor';\nimport { ButtonStyleConfig, ButtonStyleEditor } from 'app/plugins/panel/canvas/editor/element/ButtonStyleEditor';\nimport { callApi } from 'app/plugins/panel/canvas/editor/element/utils';\nimport { HttpRequestMethod } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultLightTextColor } from '../element';\nimport { Align, TextConfig, TextData } from '../types';\n\ninterface ButtonData extends Omit<TextData, 'valign'> {\n  api?: APIEditorConfig;\n  style?: ButtonStyleConfig;\n}\n\ninterface ButtonConfig extends Omit<TextConfig, 'valign'> {\n  api?: APIEditorConfig;\n  style?: ButtonStyleConfig;\n}\n\nexport const defaultApiConfig: APIEditorConfig = {\n  endpoint: '',\n  method: HttpRequestMethod.POST,\n  data: '{}',\n  contentType: 'application/json',\n  queryParams: [],\n  headerParams: [],\n};\n\nexport const defaultStyleConfig: ButtonStyleConfig = {\n  variant: 'primary',\n};\n\nconst ButtonDisplay = ({ data }: CanvasElementProps<ButtonConfig, ButtonData>) => {\n  const styles = useStyles2(getStyles, data);\n\n  const [isLoading, setIsLoading] = useState(false);\n\n  const updateLoadingStateCallback = (loading: boolean) => {\n    setIsLoading(loading);\n  };\n\n  const onClick = () => {\n    if (data?.api && data?.api?.endpoint) {\n      setIsLoading(true);\n      callApi(data.api, updateLoadingStateCallback);\n    }\n  };\n\n  return (\n    <Button type=\"submit\" variant={data?.style?.variant} onClick={onClick} className={styles.button}>\n      <span>\n        {isLoading && <Spinner inline={true} className={styles.buttonSpinner} />}\n        {data?.text}\n      </span>\n    </Button>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: ButtonData | undefined) => ({\n  button: css({\n    height: '100%',\n    width: '100%',\n    display: 'grid',\n\n    '> span': {\n      display: 'inline-grid',\n      gridAutoFlow: 'column',\n      textAlign: data?.align,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    },\n  }),\n  buttonSpinner: css({\n    marginRight: theme.spacing(0.5),\n  }),\n});\n\nexport const buttonItem: CanvasElementItem<ButtonConfig, ButtonData> = {\n  id: 'button',\n  name: 'Button',\n  description: 'Button',\n  state: PluginState.beta,\n\n  standardEditorConfig: {\n    background: false,\n  },\n\n  display: ButtonDisplay,\n\n  defaultSize: {\n    width: 150,\n    height: 45,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      text: {\n        mode: TextDimensionMode.Fixed,\n        fixed: 'Button',\n      },\n      align: Align.Center,\n      color: {\n        fixed: defaultLightTextColor,\n      },\n      size: 14,\n      api: defaultApiConfig,\n      style: defaultStyleConfig,\n    },\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 32,\n      height: options?.placement?.height ?? 78,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<ButtonConfig>) => {\n    const buttonConfig = elementOptions.config;\n\n    const getAPIConfig = () => {\n      if (buttonConfig?.api) {\n        buttonConfig.api = {\n          ...buttonConfig.api,\n          method: buttonConfig.api.method ?? defaultApiConfig.method,\n          contentType: buttonConfig.api.contentType ?? defaultApiConfig.contentType,\n        };\n        return buttonConfig.api;\n      }\n\n      return undefined;\n    };\n\n    const data: ButtonData = {\n      text: buttonConfig?.text ? dimensionContext.getText(buttonConfig.text).value() : '',\n      align: buttonConfig?.align ?? Align.Center,\n      size: buttonConfig?.size ?? 14,\n      api: getAPIConfig(),\n      style: buttonConfig?.style ?? defaultStyleConfig,\n    };\n\n    if (buttonConfig?.color) {\n      data.color = dimensionContext.getColor(buttonConfig.color).value();\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.button-item.category-button', 'Button')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'styleSelector',\n        path: 'config.style',\n        name: t('canvas.button-item.name-style', 'Style'),\n        editor: ButtonStyleEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.button-item.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.button-item.name-text-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.button-item.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.button-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.button-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.button-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.button-item.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.button-item.placeholder.auto', 'Auto'),\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'apiSelector',\n        path: 'config.api',\n        name: t('canvas.button-item.name-api', 'API'),\n        editor: APIEditor,\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Cloud = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 110 70\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"110\" height=\"70\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`cloudClip-${uniqueId}`}>\n            <path d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#cloudClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <path\n          d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <path\n          d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\"\n          clipPath={`url(#cloudClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const cloudItem: CanvasElementItem = {\n  id: 'cloud',\n  name: 'Cloud',\n  description: 'Cloud',\n\n  display: Cloud,\n\n  defaultSize: {\n    width: 110,\n    height: 70,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 110,\n      height: options?.placement?.height ?? 70,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.cloud-item.category-cloud', 'Cloud')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.cloud-item.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.cloud-item.name-text-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.cloud-item.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.cloud-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.cloud-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.cloud-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: t('canvas.cloud-item.name-vertical-align', 'Vertical align'),\n        settings: {\n          options: [\n            { value: VAlign.Top, label: t('canvas.cloud-item.label.top', 'Top') },\n            { value: VAlign.Middle, label: t('canvas.cloud-item.label.middle', 'Middle') },\n            { value: VAlign.Bottom, label: t('canvas.cloud-item.label.bottom', 'Bottom') },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.cloud-item.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.cloud-item.placeholder.auto', 'Auto'),\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    { x: -0.58, y: 0.63 }, // Top Left\n    { x: -0.22, y: 0.99 }, // Top Middle\n    { x: 0.235, y: 0.75 }, // Top Right\n\n    { x: 0.8, y: 0.6 }, // Right Top\n    { x: 0.785, y: 0.06 }, // Right Middle\n    { x: 0.91, y: -0.51 }, // Right Bottom\n\n    { x: 0.62, y: -0.635 }, // Bottom Right\n    { x: 0.05, y: -0.98 }, // Bottom Middle\n    { x: -0.45, y: -0.635 }, // Bottom Left\n\n    { x: -0.8, y: -0.58 }, // Left Bottom\n    { x: -0.78, y: -0.06 }, // Left Middle\n    { x: -0.9, y: 0.48 }, // Left Top\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors/ScalarDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneFrontData {\n  rollAngle?: number;\n}\n\ninterface DroneFrontConfig {\n  rollAngle?: ScalarDimensionConfig;\n}\n\nconst DroneFrontDisplay = ({ data }: CanvasElementProps<DroneFrontConfig, DroneFrontData>) => {\n  const styles = useStyles2(getStyles);\n\n  const droneFrontTransformStyle = `rotate(${data?.rollAngle ? data.rollAngle : 0}deg)`;\n\n  return (\n    <svg\n      className={styles.droneFront}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"0 0 1300 290\"\n      style={{ transform: droneFrontTransformStyle, stroke: defaultBgColor }}\n    >\n      <g className=\"arms\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <line x1=\"510\" x2=\"320\" y1=\"100\" y2=\"150\" />\n        <line x1=\"510\" x2=\"320\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"100\" y2=\"150\" />\n      </g>\n      <g className=\"body\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          fill=\"none\"\n          d=\" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z \"\n        />\n        <circle cx=\"650\" cy=\"160\" r=\"40\" fill=\"none\" />\n      </g>\n      <g className=\"motors\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z \"\n        />\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z \"\n        />\n      </g>\n      <g className=\"propellers\" fill={defaultBgColor}>\n        <path\n          className=\"prop\"\n          d=\" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z \"\n        />\n        <path\n          className=\"prop\"\n          d=\" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneFrontItem: CanvasElementItem = {\n  id: 'droneFront',\n  name: 'Drone Front',\n  description: 'Drone front',\n\n  display: DroneFrontDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 26,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 26,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneFrontConfig>) => {\n    const droneFrontConfig = elementOptions.config;\n\n    const data: DroneFrontData = {\n      rollAngle: droneFrontConfig?.rollAngle ? dimensionContext.getScalar(droneFrontConfig.rollAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.drone-front-item.category-drone-front', 'Drone Front')];\n    builder.addCustomEditor({\n      category,\n      id: 'rollAngle',\n      path: 'config.rollAngle',\n      name: t('canvas.drone-front-item.name-roll-angle', 'Roll Angle'),\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  droneFront: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    transition: 'transform 0.4s',\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors/ScalarDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneSideData {\n  pitchAngle?: number;\n}\n\ninterface DroneSideConfig {\n  pitchAngle?: ScalarDimensionConfig;\n}\n\nconst DroneSideDisplay = ({ data }: CanvasElementProps<DroneSideConfig, DroneSideData>) => {\n  const styles = useStyles2(getStyles);\n\n  const droneSidePitchTransformStyle = `rotate(${data?.pitchAngle ? data.pitchAngle : 0}deg)`;\n\n  return (\n    <svg\n      className={styles.droneSide}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"0 0 1300 290\"\n      style={{ transform: droneSidePitchTransformStyle, stroke: defaultBgColor }}\n    >\n      <g className=\"arms\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <line x1=\"510\" x2=\"320\" y1=\"100\" y2=\"150\" />\n        <line x1=\"510\" x2=\"320\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"100\" y2=\"150\" />\n      </g>\n      <g className=\"body\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          fill=\"none\"\n          d=\" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z \"\n        />\n      </g>\n      <g className=\"motors\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z \"\n        />\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z \"\n        />\n      </g>\n      <g className=\"propellers\" fill={defaultBgColor}>\n        <path\n          className=\"prop\"\n          d=\" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z \"\n        />\n        <path\n          className=\"prop\"\n          d=\" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneSideItem: CanvasElementItem = {\n  id: 'droneSide',\n  name: 'Drone Side',\n  description: 'Drone Side',\n\n  display: DroneSideDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 26,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 26,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneSideConfig>) => {\n    const droneSideConfig = elementOptions.config;\n\n    const data: DroneSideData = {\n      pitchAngle: droneSideConfig?.pitchAngle ? dimensionContext.getScalar(droneSideConfig.pitchAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.drone-side-item.category-drone-side', 'Drone Side')];\n    builder.addCustomEditor({\n      category,\n      id: 'pitchAngle',\n      path: 'config.pitchAngle',\n      name: t('canvas.drone-side-item.name-pitch-angle', 'Pitch Angle'),\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  droneSide: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    transition: 'transform 0.4s',\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors/ScalarDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneTopData {\n  bRightRotorRPM?: number;\n  bLeftRotorRPM?: number;\n  fRightRotorRPM?: number;\n  fLeftRotorRPM?: number;\n  yawAngle?: number;\n}\n\ninterface DroneTopConfig {\n  bRightRotorRPM?: ScalarDimensionConfig;\n  bLeftRotorRPM?: ScalarDimensionConfig;\n  fRightRotorRPM?: ScalarDimensionConfig;\n  fLeftRotorRPM?: ScalarDimensionConfig;\n  yawAngle?: ScalarDimensionConfig;\n}\n\nconst DroneTopDisplay = ({ data }: CanvasElementProps<DroneTopConfig, DroneTopData>) => {\n  const styles = useStyles2(getStyles);\n\n  const fRightRotorAnimation = `spin ${data?.fRightRotorRPM ? 60 / Math.abs(data.fRightRotorRPM) : 0}s linear infinite`;\n\n  const fLeftRotorAnimation = `spin ${data?.fLeftRotorRPM ? 60 / Math.abs(data.fLeftRotorRPM) : 0}s linear infinite`;\n\n  const bRightRotorAnimation = `spin ${data?.bRightRotorRPM ? 60 / Math.abs(data.bRightRotorRPM) : 0}s linear infinite`;\n\n  const bLeftRotorAnimation = `spin ${data?.bLeftRotorRPM ? 60 / Math.abs(data.bLeftRotorRPM) : 0}s linear infinite`;\n\n  const droneTopTransformStyle = `rotate(${data?.yawAngle ? data.yawAngle : 0}deg)`;\n\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"-43 -43 640 640\"\n      xmlSpace=\"preserve\"\n      style={{ transform: droneTopTransformStyle, fill: defaultBgColor }}\n    >\n      <path\n        fillRule=\"evenodd\"\n        d=\" M 137.95 127.967 C 137.14 127.157 136.189 126.58 135.178 126.218 C 138.173 121.545 139.967 116.036 140.125 110.123 L 217.64 151.862 C 214.049 157.411 211.8 163.922 211.386 170.95 L 209.694 199.712 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 Z  M 134.268 426.981 C 130.211 421.314 124.328 417.045 117.482 415.041 L 201.999 330.523 L 201.385 340.955 C 200.67 353.107 202.829 364.914 207.563 375.673 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 Z  M 324.765 373.673 L 228.527 373.673 Q 215.374 358.611 216.361 341.835 L 226.361 171.832 C 226.825 163.94 231.012 157.096 237.146 152.957 L 316.146 152.957 C 322.28 157.096 326.466 163.94 326.931 171.832 L 336.931 341.835 Q 337.918 358.611 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 Z  M 435.81 415.041 C 428.964 417.045 423.081 421.314 419.024 426.981 L 345.727 375.673 C 350.461 364.914 352.62 353.107 351.905 340.955 L 351.291 330.523 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 Z  M 343.596 199.713 L 341.904 170.951 C 341.49 163.923 339.242 157.411 335.651 151.863 L 413.167 110.124 C 413.325 116.037 415.119 121.546 418.114 126.219 C 417.103 126.581 416.152 127.158 415.342 127.968 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 Z  M 444.646 92.771 C 453.744 92.771 461.146 100.172 461.146 109.271 C 461.146 118.369 453.744 125.771 444.646 125.771 C 435.548 125.771 428.146 118.369 428.146 109.271 C 428.146 100.172 435.548 92.771 444.646 92.771 L 444.646 92.771 L 444.646 92.771 L 444.646 92.771 Z  M 108.647 92.771 C 117.745 92.771 125.147 100.172 125.147 109.271 C 125.147 118.369 117.745 125.771 108.647 125.771 C 99.549 125.771 92.147 118.369 92.147 109.271 C 92.147 100.172 99.549 92.771 108.647 92.771 L 108.647 92.771 L 108.647 92.771 Z  M 108.647 461.771 C 99.549 461.771 92.147 454.369 92.147 445.271 C 92.147 436.172 99.549 428.771 108.647 428.771 C 117.745 428.771 125.147 436.172 125.147 445.271 C 125.147 454.369 117.745 461.771 108.647 461.771 L 108.647 461.771 Z  M 92.322 136.202 C 97.086 139.1 102.675 140.771 108.647 140.771 C 114.883 140.771 120.697 138.941 125.594 135.802 C 125.956 136.813 126.534 137.764 127.343 138.573 L 207.342 218.573 C 207.711 218.942 208.109 219.264 208.528 219.54 L 203.212 309.908 C 201.794 310.182 200.44 310.869 199.342 311.967 L 95.343 415.967 C 94.954 416.356 94.62 416.779 94.335 417.224 C 93.651 417.575 92.976 417.942 92.322 418.34 Q 84.615 424.182 81.716 428.946 C 78.817 433.71 77.147 439.299 77.147 445.271 C 77.147 462.64 91.278 476.771 108.647 476.771 C 114.619 476.771 120.208 475.1 124.972 472.202 C 129.736 469.304 132.678 466.36 135.577 461.596 C 138.476 456.832 140.147 451.243 140.147 445.271 C 140.147 443.943 140.055 442.637 139.895 441.352 L 214.997 388.78 C 217.05 391.677 336.242 391.678 338.295 388.78 L 413.398 441.352 C 413.238 442.637 413.146 443.943 413.146 445.271 C 413.146 451.243 414.817 456.832 417.715 461.596 C 420.613 466.36 423.557 469.304 428.321 472.202 C 433.085 475.1 438.674 476.771 444.646 476.771 C 462.015 476.771 476.146 462.64 476.146 445.271 C 476.146 439.299 474.475 433.71 471.577 428.946 C 468.679 424.182 459.642 417.575 458.958 417.224 C 458.672 416.779 458.339 416.356 457.95 415.967 L 353.95 311.967 C 352.852 310.869 351.498 310.182 350.08 309.908 L 344.764 219.54 C 345.183 219.264 345.581 218.942 345.95 218.573 L 425.95 138.573 C 426.76 137.763 427.337 136.812 427.699 135.802 C 432.596 138.941 438.409 140.771 444.646 140.771 C 450.618 140.771 456.207 139.1 460.971 136.202 C 465.735 133.304 468.679 130.36 471.577 125.596 C 474.475 120.832 476.146 115.243 476.146 109.271 C 476.146 91.903 462.015 77.772 444.646 77.772 C 438.674 77.772 433.085 79.442 428.321 82.34 L 416.215 91.446 L 324.765 140.688 C 318.402 136.324 310.718 133.771 302.473 133.771 L 250.819 133.771 C 242.574 133.771 234.89 136.324 228.527 140.688 L 137.078 91.446 L 124.972 82.34 C 120.208 79.442 114.619 77.772 108.647 77.772 C 91.278 77.772 77.147 91.903 77.147 109.271 C 77.147 115.243 78.818 120.832 81.716 125.595 C 84.614 130.358 87.558 133.304 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 Z  M 444.646 461.771 C 435.548 461.771 428.146 454.369 428.146 445.271 C 428.146 436.172 435.548 428.771 444.646 428.771 C 453.744 428.771 461.146 436.172 461.146 445.271 C 461.146 454.369 453.744 461.771 444.646 461.771 Z \"\n      />\n      <path\n        fillRule=\"evenodd\"\n        d=\" M 259.458 334.235 L 259.458 337.211 L 254.514 337.211 L 254.514 350.795 L 250.842 350.795 L 250.842 337.211 L 245.898 337.211 L 245.898 334.235 L 259.458 334.235 Z  M 266.226 347.939 L 272.586 347.939 L 272.754 350.627 L 272.754 350.627 Q 270.498 350.867 265.074 350.867 L 265.074 350.867 L 265.074 350.867 Q 263.418 350.867 262.434 349.967 L 262.434 349.967 L 262.434 349.967 Q 261.45 349.067 261.426 347.531 L 261.426 347.531 L 261.426 337.499 L 261.426 337.499 Q 261.45 335.963 262.434 335.063 L 262.434 335.063 L 262.434 335.063 Q 263.418 334.163 265.074 334.163 L 265.074 334.163 L 265.074 334.163 Q 270.498 334.163 272.754 334.403 L 272.754 334.403 L 272.586 337.115 L 266.226 337.115 L 266.226 337.115 Q 265.626 337.115 265.362 337.403 L 265.362 337.403 L 265.362 337.403 Q 265.098 337.691 265.098 338.339 L 265.098 338.339 L 265.098 340.859 L 271.698 340.859 L 271.698 343.499 L 265.098 343.499 L 265.098 346.691 L 265.098 346.691 Q 265.098 347.363 265.362 347.651 L 265.362 347.651 L 265.362 347.651 Q 265.626 347.939 266.226 347.939 L 266.226 347.939 Z  M 275.202 333.995 L 278.73 333.995 L 278.73 346.931 L 278.73 346.931 Q 278.73 348.131 280.074 348.131 L 280.074 348.131 L 281.034 348.131 L 281.442 350.603 L 281.442 350.603 Q 280.53 351.083 278.61 351.083 L 278.61 351.083 L 278.61 351.083 Q 277.026 351.083 276.114 350.231 L 276.114 350.231 L 276.114 350.231 Q 275.202 349.379 275.202 347.819 L 275.202 347.819 L 275.202 333.995 Z  M 283.05 333.995 L 286.578 333.995 L 286.578 346.931 L 286.578 346.931 Q 286.578 348.131 287.922 348.131 L 287.922 348.131 L 288.882 348.131 L 289.29 350.603 L 289.29 350.603 Q 288.378 351.083 286.458 351.083 L 286.458 351.083 L 286.458 351.083 Q 284.874 351.083 283.962 350.231 L 283.962 350.231 L 283.962 350.231 Q 283.05 349.379 283.05 347.819 L 283.05 347.819 L 283.05 333.995 Z  M 292.086 335.759 L 292.086 335.759 L 292.086 335.759 Q 293.634 333.923 297.618 333.923 L 297.618 333.923 L 297.618 333.923 Q 301.602 333.923 303.162 335.759 L 303.162 335.759 L 303.162 335.759 Q 304.722 337.595 304.722 342.515 L 304.722 342.515 L 304.722 342.515 Q 304.722 347.435 303.162 349.271 L 303.162 349.271 L 303.162 349.271 Q 301.602 351.107 297.618 351.107 L 297.618 351.107 L 297.618 351.107 Q 293.634 351.107 292.086 349.271 L 292.086 349.271 L 292.086 349.271 Q 290.538 347.435 290.538 342.515 L 290.538 342.515 L 290.538 342.515 Q 290.538 337.595 292.086 335.759 Z  M 300.174 338.051 L 300.174 338.051 L 300.174 338.051 Q 299.49 336.875 297.618 336.875 L 297.618 336.875 L 297.618 336.875 Q 295.746 336.875 295.062 338.051 L 295.062 338.051 L 295.062 338.051 Q 294.378 339.227 294.378 342.515 L 294.378 342.515 L 294.378 342.515 Q 294.378 345.803 295.062 346.979 L 295.062 346.979 L 295.062 346.979 Q 295.746 348.155 297.618 348.155 L 297.618 348.155 L 297.618 348.155 Q 299.49 348.155 300.174 346.979 L 300.174 346.979 L 300.174 346.979 Q 300.858 345.803 300.858 342.515 L 300.858 342.515 L 300.858 342.515 Q 300.858 339.227 300.174 338.051 Z \"\n      />\n      <g className=\"propeller-group\">\n        <path\n          className={`${styles.propeller} ${styles.propellerCW}`}\n          style={{ animation: bRightRotorAnimation }}\n          d=\" M 461.563 418.77 L 463.992 416.34 Q 465.495 407.116 466.461 400.395 C 467.426 393.675 469.363 388.087 474.731 383.284 Q 533.862 341.514 538.196 338.859 C 542.529 336.203 548.345 334.299 551.492 338.29 C 554.639 342.282 553.481 346.02 549.419 350.082 L 471.147 428.354 L 461.563 418.77 Z  M 427.729 471.772 L 425.299 474.202 Q 423.797 483.426 422.831 490.146 C 421.866 496.867 419.929 502.454 414.561 507.257 Q 355.43 549.028 351.096 551.683 C 346.763 554.338 340.947 556.243 337.8 552.251 C 334.653 548.26 335.811 544.522 339.873 540.46 L 418.145 462.187 L 427.729 471.772 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCCW}`}\n          style={{ animation: fRightRotorAnimation }}\n          d=\" M 461.563 135.773 L 463.992 138.203 Q 465.495 147.426 466.461 154.147 C 467.426 160.868 469.363 166.455 474.731 171.258 Q 533.862 213.028 538.196 215.684 C 542.529 218.339 548.345 220.244 551.492 216.252 C 554.639 212.26 553.481 208.523 549.419 204.46 L 471.147 126.188 L 461.563 135.773 Z  M 427.729 82.77 L 425.299 80.34 Q 423.797 71.117 422.831 64.396 C 421.866 57.675 419.929 52.088 414.561 47.285 Q 355.43 5.515 351.096 2.859 C 346.763 0.204 340.947 -1.701 337.8 2.291 C 334.653 6.282 335.811 10.02 339.873 14.082 L 418.145 92.355 L 427.729 82.77 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCCW}`}\n          style={{ animation: bLeftRotorAnimation }}\n          d=\" M 125.563 471.772 L 127.993 474.202 Q 129.496 483.426 130.461 490.146 C 131.427 496.867 133.363 502.454 138.731 507.257 Q 197.863 549.028 202.196 551.683 C 206.53 554.338 212.345 556.243 215.492 552.251 C 218.639 548.26 217.482 544.522 213.419 540.46 L 135.148 462.187 L 125.563 471.772 Z  M 91.73 418.77 L 89.3 416.34 Q 87.797 407.116 86.832 400.395 C 85.866 393.675 83.93 388.087 78.562 383.284 Q 19.431 341.514 15.097 338.859 C 10.763 336.203 4.948 334.299 1.801 338.29 C -1.346 342.282 -0.189 346.02 3.874 350.082 L 82.146 428.354 L 91.73 418.77 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCW}`}\n          style={{ animation: fLeftRotorAnimation }}\n          d=\" M 125.563 82.77 L 127.993 80.34 Q 129.496 71.117 130.461 64.396 C 131.427 57.675 133.363 52.088 138.731 47.285 Q 197.863 5.515 202.196 2.859 C 206.53 0.204 212.345 -1.701 215.492 2.291 C 218.639 6.282 217.482 10.02 213.419 14.083 L 135.147 92.355 L 125.563 82.77 Z  M 91.73 135.773 L 89.3 138.203 Q 87.797 147.426 86.832 154.147 C 85.866 160.868 83.93 166.455 78.562 171.258 Q 19.431 213.028 15.097 215.684 C 10.763 218.339 4.948 220.243 1.801 216.252 C -1.346 212.26 -0.189 208.523 3.874 204.46 L 82.146 126.188 L 91.73 135.773 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneTopItem: CanvasElementItem = {\n  id: 'droneTop',\n  name: 'Drone Top',\n  description: 'Drone top',\n\n  display: DroneTopDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneTopConfig>) => {\n    const droneTopConfig = elementOptions.config;\n\n    const data: DroneTopData = {\n      bRightRotorRPM: droneTopConfig?.bRightRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.bRightRotorRPM).value()\n        : 0,\n      bLeftRotorRPM: droneTopConfig?.bLeftRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.bLeftRotorRPM).value()\n        : 0,\n      fRightRotorRPM: droneTopConfig?.fRightRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.fRightRotorRPM).value()\n        : 0,\n      fLeftRotorRPM: droneTopConfig?.fLeftRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.fLeftRotorRPM).value()\n        : 0,\n      yawAngle: droneTopConfig?.yawAngle ? dimensionContext.getScalar(droneTopConfig.yawAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.drone-top-item.category-drone-top', 'Drone Top')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'yawAngle',\n        path: 'config.yawAngle',\n        name: t('canvas.drone-top-item.name-yaw-angle', 'Yaw Angle'),\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'fRightRotorRPM',\n        path: 'config.fRightRotorRPM',\n        name: t('canvas.drone-top-item.name-front-right-rotor-rpm', 'Front Right Rotor RPM'),\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'fLeftRotorRPM',\n        path: 'config.fLeftRotorRPM',\n        name: t('canvas.drone-top-item.name-front-left-rotor-rpm', 'Front Left Rotor RPM'),\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'bRightRotorRPM',\n        path: 'config.bRightRotorRPM',\n        name: t('canvas.drone-top-item.name-back-right-rotor-rpm', 'Back Right Rotor RPM'),\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'bLeftRotorRPM',\n        path: 'config.bLeftRotorRPM',\n        name: t('canvas.drone-top-item.name-back-left-rotor-rpm', 'Back Left Rotor RPM'),\n        editor: ScalarDimensionEditor,\n      });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  propeller: css({\n    transformOrigin: '50% 50%',\n    transformBox: 'fill-box',\n    display: 'block',\n    '@keyframes spin': {\n      from: {\n        transform: 'rotate(0deg)',\n      },\n      to: {\n        transform: 'rotate(360deg)',\n      },\n    },\n  }),\n  propellerCW: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    animationDirection: 'normal',\n  }),\n  propellerCCW: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    animationDirection: 'reverse',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Ellipse = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 200 200\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"200\" height=\"200\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`ellipseClip-${uniqueId}`}>\n            <ellipse cx=\"50%\" cy=\"50%\" rx=\"50%\" ry=\"50%\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#ellipseClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <ellipse\n          cx=\"50%\"\n          cy=\"50%\"\n          rx=\"50%\"\n          ry=\"50%\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <ellipse\n          cx=\"50%\"\n          cy=\"50%\"\n          rx=\"50%\"\n          ry=\"50%\"\n          clipPath={`url(#ellipseClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const ellipseItem: CanvasElementItem<CanvasElementConfig, CanvasElementData> = {\n  id: 'ellipse',\n  name: 'Ellipse',\n  description: 'Ellipse',\n\n  display: Ellipse,\n\n  defaultSize: {\n    width: 160,\n    height: 160,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 160,\n      height: options?.placement?.height ?? 138,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.ellipse-item.category-ellipse', 'Ellipse')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.ellipse-item.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.ellipse-item.name-text-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.ellipse-item.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.ellipse-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.ellipse-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.ellipse-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: t('canvas.ellipse-item.name-vertical-align', 'Vertical align'),\n        settings: {\n          options: [\n            { value: VAlign.Top, label: t('canvas.ellipse-item.label.top', 'Top') },\n            { value: VAlign.Middle, label: t('canvas.ellipse-item.label.middle', 'Middle') },\n            { value: VAlign.Bottom, label: t('canvas.ellipse-item.label.bottom', 'Bottom') },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.ellipse-item.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.ellipse-item.placeholder.auto', 'Auto'),\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    // points along the left edge\n    { x: -1, y: 0 }, // middle left\n    { x: -0.7, y: 0.7 },\n\n    // points along the top edge\n    { x: 0, y: 1 }, // top\n    { x: 0.7, y: 0.7 },\n\n    // points along the right edge\n    { x: 1, y: 0 }, // middle right\n    { x: 0.7, y: -0.7 },\n\n    // points along the bottom edge\n    { x: 0, y: -1 }, // bottom\n    { x: -0.7, y: -0.7 },\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport { isString } from 'lodash';\nimport { CSSProperties } from 'react';\n\nimport { LinkModel } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ColorDimensionConfig, ResourceDimensionConfig, ResourceDimensionMode } from '@grafana/schema';\nimport { SanitizedSVG } from 'app/core/components/SVG/SanitizedSVG';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { ResourceDimensionEditor } from 'app/features/dimensions/editors/ResourceDimensionEditor';\nimport { getPublicOrAbsoluteUrl } from 'app/features/dimensions/resource';\nimport { LineConfig } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\nexport interface IconConfig {\n  path?: ResourceDimensionConfig;\n  fill?: ColorDimensionConfig;\n  stroke?: LineConfig;\n}\n\ninterface IconData {\n  path: string;\n  fill: string;\n  strokeColor?: string;\n  stroke?: number;\n  links?: LinkModel[];\n}\n\n// When a stoke is defined, we want the path to be in page units\nconst svgStrokePathClass = css({\n  path: {\n    vectorEffect: 'non-scaling-stroke',\n  },\n});\n\nexport function IconDisplay(props: CanvasElementProps<IconConfig, IconData>) {\n  const { data } = props;\n  if (!data?.path) {\n    return null;\n  }\n\n  const svgStyle: CSSProperties = {\n    fill: data?.fill,\n    stroke: data?.strokeColor,\n    strokeWidth: data?.stroke,\n    height: '100%',\n    width: '100%',\n  };\n\n  return (\n    <SanitizedSVG src={data.path} style={svgStyle} className={svgStyle.strokeWidth ? svgStrokePathClass : undefined} />\n  );\n}\n\nexport const iconItem: CanvasElementItem<IconConfig, IconData> = {\n  id: 'icon',\n  name: 'Icon',\n  description: 'SVG Icon display',\n\n  display: IconDisplay,\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      path: {\n        mode: ResourceDimensionMode.Fixed,\n        fixed: 'img/icons/unicons/question-circle.svg',\n      },\n      fill: { fixed: defaultBgColor },\n    },\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<IconConfig>) => {\n    const iconConfig = elementOptions.config;\n\n    let path: string | undefined = undefined;\n    if (iconConfig?.path) {\n      path = dimensionContext.getResource(iconConfig.path).value();\n    }\n    if (!path || !isString(path)) {\n      path = getPublicOrAbsoluteUrl('img/icons/unicons/question-circle.svg');\n    }\n\n    const data: IconData = {\n      path,\n      fill: iconConfig?.fill ? dimensionContext.getColor(iconConfig.fill).value() : defaultBgColor,\n    };\n\n    if (iconConfig?.stroke?.width && iconConfig?.stroke.color) {\n      if (iconConfig.stroke.width > 0) {\n        data.stroke = iconConfig.stroke?.width;\n        data.strokeColor = dimensionContext.getColor(iconConfig.stroke.color).value();\n      }\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.icon-item.category-icon', 'Icon')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'iconSelector',\n        path: 'config.path',\n        name: t('canvas.icon-item.name-svg-path', 'SVG Path'),\n        editor: ResourceDimensionEditor,\n        settings: {\n          resourceType: 'icon',\n          maxFiles: 2000,\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.fill',\n        path: 'config.fill',\n        name: t('canvas.icon-item.name-fill-color', 'Fill color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: 'grey',\n        },\n      });\n    // .addSliderInput({\n    //   category,\n    //   path: 'config.stroke.width',\n    //   name: 'Stroke',\n    //   defaultValue: 0,\n    //   settings: {\n    //     min: 0,\n    //     max: 10,\n    //   },\n    // })\n    // .addCustomEditor({\n    //   category,\n    //   id: 'config.stroke.color',\n    //   path: 'config.stroke.color',\n    //   name: 'Stroke color',\n    //   editor: ColorDimensionEditor,\n    //   settings: {},\n    //   defaultValue: {\n    //     // Configured values\n    //     fixed: 'grey',\n    //   },\n    //   showIf: (cfg) => Boolean(cfg?.config?.stroke?.width),\n    // })\n  },\n};\n","import { css } from '@emotion/css';\nimport { useCallback } from 'react';\nimport { useObservable } from 'react-use';\nimport { of } from 'rxjs';\n\nimport { DataFrame, FieldNamePickerConfigSettings, GrafanaTheme2, StandardEditorsRegistryItem } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { TextDimensionMode } from '@grafana/schema';\nimport { usePanelContext, useStyles2 } from '@grafana/ui';\nimport { FieldNamePicker, frameHasName, getFrameFieldsDisplayNames } from '@grafana/ui/internal';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { ElementState } from '../runtime/element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\n// eslint-disable-next-line\nconst dummyFieldSettings: StandardEditorsRegistryItem<string, FieldNamePickerConfigSettings> = {\n  settings: {},\n} as StandardEditorsRegistryItem<string, FieldNamePickerConfigSettings>;\n\nconst MetricValueDisplay = (props: CanvasElementProps<TextConfig, TextData>) => {\n  const { data, isSelected, config } = props;\n  const styles = useStyles2(getStyles(data));\n\n  const context = usePanelContext();\n  const scene = context.instanceState?.scene;\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const isEditMode = useObservable<boolean>(scene?.editModeEnabled ?? of(false));\n\n  const getDisplayValue = () => {\n    if (panelData && config.text?.field && fieldNotFound()) {\n      return 'Field not found';\n    }\n\n    if (panelData && config.text?.field && !data?.text) {\n      return 'No data';\n    }\n\n    return data?.text ? data.text : 'Double click to set field';\n  };\n\n  const fieldNotFound = () => {\n    const fieldNames = getFrameFieldsDisplayNames(panelData);\n    return !frameHasName(config.text?.field, fieldNames);\n  };\n\n  if (isEditMode && isSelected) {\n    return <MetricValueEdit {...props} />;\n  }\n\n  return (\n    <div className={styles.container}>\n      <span className={styles.span}>{getDisplayValue()}</span>\n    </div>\n  );\n};\n\nconst MetricValueEdit = (props: CanvasElementProps<TextConfig, TextData>) => {\n  let { data, config } = props;\n  const context = usePanelContext();\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const onFieldChange = useCallback(\n    (field: string | undefined) => {\n      let selectedElement: ElementState;\n      selectedElement = context.instanceState?.selected[0];\n      if (selectedElement) {\n        const options = selectedElement.options;\n        selectedElement.onChange({\n          ...options,\n          config: {\n            ...options.config,\n            text: { fixed: '', field: field, mode: TextDimensionMode.Field },\n          },\n          background: {\n            color: { field: field, fixed: options.background?.color?.fixed ?? '' },\n          },\n        });\n\n        // Force a re-render (update scene data after config update)\n        const scene = context.instanceState?.scene;\n        if (scene) {\n          scene.editModeEnabled.next(false);\n          scene.updateData(scene.data);\n        }\n      }\n    },\n    [context.instanceState?.scene, context.instanceState?.selected]\n  );\n\n  const styles = useStyles2(getStyles(data));\n  return (\n    <div className={styles.inlineEditorContainer}>\n      {panelData && (\n        <FieldNamePicker\n          context={{ data: panelData }}\n          value={config.text?.field ?? ''}\n          onChange={onFieldChange}\n          item={dummyFieldSettings}\n        />\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (data: TextData | undefined) => (theme: GrafanaTheme2) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  inlineEditorContainer: css({\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(1),\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n});\n\nexport const metricValueItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'metric-value',\n  name: 'Metric Value',\n  description: 'Display a field value',\n\n  display: MetricValueDisplay,\n\n  hasEditMode: true,\n\n  defaultSize: {\n    width: 260,\n    height: 50,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n      text: { mode: TextDimensionMode.Field, fixed: '', field: '' },\n      size: 20,\n    },\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width,\n      height: options?.placement?.height,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.category-metric-value', 'Metric value')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.name-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.metric-value-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.metric-value-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.metric-value-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: t('canvas.name-vertical-align', 'Vertical align'),\n        settings: {\n          options: [\n            { value: VAlign.Top, label: t('canvas.metric-value-item.label.top', 'Top') },\n            { value: VAlign.Middle, label: t('canvas.metric-value-item.label.middle', 'Middle') },\n            { value: VAlign.Bottom, label: t('canvas.metric-value-item.label.bottom', 'Bottom') },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.metric-value-item.placeholder.auto', 'Auto'),\n        },\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Parallelogram = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 250 150\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"250\" height=\"150\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"350\" height=\"200\"></image>\n          </pattern>\n          <clipPath id={`parallelogramClip-${uniqueId}`}>\n            <polygon points=\"0,150 50,0 250,0 200,150\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#parallelogramClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <polygon\n          points=\"0,150 50,0 250,0 200,150\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <polygon\n          points=\"0,150 50,0 250,0 200,150\"\n          clipPath={`url(#parallelogramClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const parallelogramItem: CanvasElementItem = {\n  id: 'parallelogram',\n  name: 'Parallelogram',\n  description: 'Parallelogram',\n\n  display: Parallelogram,\n\n  defaultSize: {\n    width: 250,\n    height: 150,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 250,\n      height: options?.placement?.height ?? 150,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.parallelogram-item.category-parallelogram', 'Parallelogram')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.parallelogram-item.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.parallelogram-item.name-text-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.parallelogram-item.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.parallelogram-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.parallelogram-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.parallelogram-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: t('canvas.parallelogram-item.name-vertical-align', 'Vertical align'),\n        settings: {\n          options: [\n            { value: VAlign.Top, label: t('canvas.parallelogram-item.label.top', 'Top') },\n            { value: VAlign.Middle, label: t('canvas.parallelogram-item.label.middle', 'Middle') },\n            { value: VAlign.Bottom, label: t('canvas.parallelogram-item.label.bottom', 'Bottom') },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.parallelogram-item.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.parallelogram-item.placeholder.auto', 'Auto'),\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    { x: -0.6, y: 1 }, // Angled Top Left\n    { x: -0.1, y: 1 }, // Top Middle\n    { x: 0.5, y: 1 }, // Angled Top Right\n    { x: 1, y: 1 }, // Top Right\n    { x: 0.925, y: 0.6 }, // Angled Right Top\n    { x: 0.84, y: 0.2 }, // Right Middle\n    { x: 0.76, y: -0.2 }, // Angled Right Bottom\n    { x: 0.675, y: -0.6 }, // Bottom Right\n    { x: -0.5, y: -1 }, // Angled Bottom Right\n    { x: 0.1, y: -1 }, // Bottom Middle\n    { x: 0.6, y: -1 }, // Angled Bottom Left\n    { x: -1, y: -1 }, // Bottom Left\n    { x: -0.925, y: -0.6 }, // Angled Left Bottom\n    { x: -0.84, y: -0.2 }, // Left Middle\n    { x: -0.76, y: 0.2 }, // Angled Left Top\n    { x: -0.675, y: 0.6 }, // Top Left 2\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport { PureComponent } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { stylesFactory } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\nclass RectangleDisplay extends PureComponent<CanvasElementProps<TextConfig, TextData>> {\n  render() {\n    const { data } = this.props;\n    const styles = getStyles(config.theme2, data);\n\n    return (\n      <div className={styles.container}>\n        <span className={styles.span}>{data?.text}</span>\n      </div>\n    );\n  }\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2, data) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n}));\n\nexport const rectangleItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'rectangle',\n  name: 'Rectangle',\n  description: 'Rectangle',\n\n  display: RectangleDisplay,\n\n  defaultSize: {\n    width: 240,\n    height: 160,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.rectangle-item.category-rectangle', 'Rectangle')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.rectangle-item.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.rectangle-item.name-text-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.rectangle-item.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.rectangle-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.rectangle-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.rectangle-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: t('canvas.rectangle-item.name-vertical-align', 'Vertical align'),\n        settings: {\n          options: [\n            { value: VAlign.Top, label: t('canvas.rectangle-item.label.top', 'Top') },\n            { value: VAlign.Middle, label: t('canvas.rectangle-item.label.middle', 'Middle') },\n            { value: VAlign.Bottom, label: t('canvas.rectangle-item.label.bottom', 'Bottom') },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.rectangle-item.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.rectangle-item.placeholder.auto', 'Auto'),\n        },\n      });\n  },\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerDatabase = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline}>\n      <g className={styles.server}>\n        <path d=\"m2.6953 37.5v20.883c0 7.6725 15.592 13.922 34.805 13.922s34.805-6.2493 34.805-13.922v-20.883\" />\n        <path d=\"m2.6953 16.617v20.883c0 7.7035 15.592 13.922 34.805 13.922s34.805-6.2184 34.805-13.922v-20.883\" />\n        <path d=\"m37.5 30.539c19.212 0 34.805-6.2185 34.805-13.922 0-7.7034-15.592-13.922-34.805-13.922s-34.805 6.2184-34.805 13.922c0 7.7035 15.592 13.922 34.805 13.922z\" />\n      </g>\n      <g className={styles.circleBack}>\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -132.86 -110.58)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -122.04 -111.7)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.21 -114.77)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n      <g className={styles.circle}>\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -52.337 -30.65)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -41.518 -31.769)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.688 -34.842)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerSingle = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g>\n      <g className={styles.outline} transform=\"matrix(1.01 0 0 1.01 -.375 -.375)\">\n        <g className={styles.server}>\n          <path d=\"m3.2812 55.659 9.125-52.377h50.188l9.125 52.377\" />\n          <path d=\"m3.2812 56.328c0-2.5246 2.0379-4.5625 4.5625-4.5625h59.313c2.5245 0 4.5625 2.0379 4.5625 4.5625v10.828c0 2.5245-2.038 4.5625-4.5625 4.5625h-59.313c-2.5246 0-4.5625-2.038-4.5625-4.5625z\" />\n        </g>\n        <path d=\"m12.406 61.742h30.69\" />\n        <path d=\"m52.8 51.765v19.953\" />\n        <path\n          className={styles.circleBack}\n          transform=\"matrix(2.7592 0 0 2.7592 -109.42 -108.61)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          className={styles.circle}\n          transform=\"matrix(1.4775 0 0 1.4775 -29.697 -29.479)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerStack = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline} transform=\"translate(.5 .49865)\">\n      <g className={styles.server}>\n        <path d=\"m3.4834 21.768 8.0783-19.456h50.875l8.0784 19.456\" />\n        <path d=\"m2.3125 24.852c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n        <path d=\"m2.3125 42.031c0-2.5592 2.0658-4.6251 4.625-4.6251h60.125c2.5592 0 4.625 2.0659 4.625 4.6251v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n        <path d=\"m2.3125 59.172c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n      </g>\n      <path d=\"m11.562 28.797h31.111\" />\n      <path d=\"m52.508 20.227v17.143\" />\n      <path d=\"m11.562 63.117h31.111\" />\n      <path d=\"m52.508 54.547v17.143\" />\n      <path d=\"m11.562 45.977h31.111\" />\n      <path d=\"m52.508 37.406v17.143\" />\n      <g className={styles.circleBack}>\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -143.2)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -126.14)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -108.86)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n      <g className={styles.circle}>\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -63.277)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -46.209)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -28.93)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerTerminal = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline}>\n      <g className={styles.server}>\n        <path d=\"m5.3125 9.6562c0-3.5621 2.8754-6.4375 6.4375-6.4375h51.5c3.5621 0 6.4375 2.8754 6.4375 6.4375v28.625c0 3.5621-2.8754 6.4375-6.4375 6.4375h-51.5c-3.5621 0-6.4375-2.8754-6.4375-6.4375z\" />\n        <path d=\"m2.8125 59.859c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n      </g>\n      <path d=\"m37.5 46.719v2.875\" />\n      <path d=\"m24.625 51.343h25.75\" />\n      <path d=\"m12.062 63.804h31.111\" />\n      <path d=\"m53.008 55.234v17.143\" />\n      <path\n        className={styles.circleBack}\n        transform=\"matrix(2.7868 0 0 2.7868 -110.81 -108.2)\"\n        d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n      />\n      <path\n        className={styles.circle}\n        transform=\"matrix(1.4922 0 0 1.4922 -30.294 -28.27)\"\n        d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n      />\n    </g>\n  );\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, LinkModel } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ColorDimensionConfig, ScalarDimensionConfig } from '@grafana/schema';\nimport config from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors/ScalarDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps } from '../../element';\n\nimport { ServerDatabase } from './types/database';\nimport { ServerSingle } from './types/single';\nimport { ServerStack } from './types/stack';\nimport { ServerTerminal } from './types/terminal';\n\ninterface ServerConfig {\n  blinkRate?: ScalarDimensionConfig;\n  statusColor?: ColorDimensionConfig;\n  bulbColor?: ColorDimensionConfig;\n  type: ServerType;\n}\n\nexport interface ServerData {\n  blinkRate?: number;\n  statusColor?: string;\n  bulbColor?: string;\n  type: ServerType;\n  links?: LinkModel[];\n}\n\nenum ServerType {\n  Single = 'Single',\n  Stack = 'Stack',\n  Database = 'Database',\n  Terminal = 'Terminal',\n}\n\ntype Props = CanvasElementProps<ServerConfig, ServerData>;\nconst outlineColor = config.theme2.colors.text.primary;\n\nconst ServerDisplay = ({ data }: Props) => {\n  return data ? (\n    <svg viewBox=\"0 0 75 75\">\n      {data.type === ServerType.Single ? (\n        <ServerSingle {...data} />\n      ) : data.type === ServerType.Stack ? (\n        <ServerStack {...data} />\n      ) : data.type === ServerType.Database ? (\n        <ServerDatabase {...data} />\n      ) : data.type === ServerType.Terminal ? (\n        <ServerTerminal {...data} />\n      ) : null}\n    </svg>\n  ) : null;\n};\n\nexport const serverItem: CanvasElementItem<ServerConfig, ServerData> = {\n  id: 'server',\n  name: 'Server',\n  description: 'Basic server with status',\n\n  display: ServerDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    config: {\n      type: ServerType.Single,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<ServerConfig>) => {\n    const serverConfig = elementOptions.config;\n\n    const data: ServerData = {\n      blinkRate: serverConfig?.blinkRate ? dimensionContext.getScalar(serverConfig.blinkRate).value() : 0,\n      statusColor: serverConfig?.statusColor\n        ? dimensionContext.getColor(serverConfig.statusColor).value()\n        : 'transparent',\n      bulbColor: serverConfig?.bulbColor ? dimensionContext.getColor(serverConfig.bulbColor).value() : 'green',\n      type: serverConfig?.type ?? ServerType.Single,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.server-item.category-server', 'Server')];\n    builder\n      .addSelect({\n        category,\n        path: 'config.type',\n        name: t('canvas.server-item.name-type', 'Type'),\n        settings: {\n          options: [\n            { value: ServerType.Single, label: t('canvas.server-item.type-options.label-single', 'Single') },\n            { value: ServerType.Stack, label: t('canvas.server-item.type-options.label-stack', 'Stack') },\n            { value: ServerType.Database, label: t('canvas.server-item.type-options.label-database', 'Database') },\n            { value: ServerType.Terminal, label: t('canvas.server-item.type-options.label-terminal', 'Terminal') },\n          ],\n        },\n        defaultValue: ServerType.Single,\n      })\n      .addCustomEditor({\n        category,\n        id: 'statusColor',\n        path: 'config.statusColor',\n        name: t('canvas.server-item.name-status-color', 'Status color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          fixed: 'transparent',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'bulbColor',\n        path: 'config.bulbColor',\n        name: t('canvas.server-item.name-bulb-color', 'Bulb color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          fixed: 'green',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'blinkRate',\n        path: 'config.blinkRate',\n        name: t('canvas.server-item.name-blink-rate', 'Blink rate [hz] (0 = off)'),\n        editor: ScalarDimensionEditor,\n        settings: { min: 0, max: 100 },\n      });\n  },\n};\n\nexport const getServerStyles = (data: ServerData | undefined) => (theme: GrafanaTheme2) => ({\n  bulb: css({\n    '@keyframes blink': {\n      '0%': {\n        fillOpacity: 0,\n      },\n      '50%': {\n        fillOpacity: 1,\n      },\n      '100%': {\n        fillOpacity: 0,\n      },\n    },\n  }),\n  server: css({\n    fill: data?.statusColor ?? 'transparent',\n  }),\n  circle: css({\n    [theme.transitions.handleMotion('no-preference', 'reduce')]: {\n      animation: `blink ${data?.blinkRate ? 1 / data.blinkRate : 0}s infinite step-end`,\n    },\n    fill: data?.bulbColor,\n    stroke: 'none',\n  }),\n  circleBack: css({\n    fill: outlineColor,\n    stroke: 'none',\n    opacity: 1,\n  }),\n  outline: css({\n    stroke: outlineColor,\n    strokeLinecap: 'round',\n    strokeLinejoin: 'round',\n    strokeWidth: '4px',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useRef } from 'react';\nimport * as React from 'react';\nimport { useObservable } from 'react-use';\nimport { of } from 'rxjs';\n\nimport { DataFrame, GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { Input, usePanelContext, useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultThemeTextColor } from '../element';\nimport { ElementState } from '../runtime/element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\nconst TextDisplay = (props: CanvasElementProps<TextConfig, TextData>) => {\n  const { data, isSelected } = props;\n  const styles = useStyles2(getStyles(data));\n\n  const context = usePanelContext();\n  const scene = context.instanceState?.scene;\n\n  const isEditMode = useObservable<boolean>(scene?.editModeEnabled ?? of(false));\n\n  if (isEditMode && isSelected) {\n    return <TextEdit {...props} />;\n  }\n  return (\n    <div className={styles.container}>\n      <span className={styles.span}>\n        {data?.text ? data.text : t('canvas.text-display.double-click-to-set', 'Double click to set text')}\n      </span>\n    </div>\n  );\n};\n\nconst TextEdit = (props: CanvasElementProps<TextConfig, TextData>) => {\n  let { data, config } = props;\n  const context = usePanelContext();\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const textRef = useRef<string>(config.text?.fixed ?? '');\n\n  // Save text on TextEdit unmount\n  useEffect(() => {\n    return () => {\n      saveText(textRef.current);\n    };\n  });\n\n  const onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      const scene = context.instanceState?.scene;\n      if (scene) {\n        scene.editModeEnabled.next(false);\n      }\n    }\n  };\n\n  const onKeyUp = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    textRef.current = event.currentTarget.value;\n  };\n\n  const saveText = useCallback(\n    (textValue: string) => {\n      let selectedElement: ElementState;\n      selectedElement = context.instanceState?.selected[0];\n      if (selectedElement) {\n        const options = selectedElement.options;\n        selectedElement.onChange({\n          ...options,\n          config: {\n            ...options.config,\n            text: { ...selectedElement.options.config.text, fixed: textValue },\n          },\n        });\n\n        // Force a re-render (update scene data after config update)\n        const scene = context.instanceState?.scene;\n        if (scene) {\n          scene.updateData(scene.data);\n        }\n      }\n    },\n    [context.instanceState?.scene, context.instanceState?.selected]\n  );\n\n  const styles = useStyles2(getStyles(data));\n  return (\n    <div className={styles.inlineEditorContainer}>\n      {panelData && <Input defaultValue={config.text?.fixed ?? ''} onKeyDown={onKeyDown} onKeyUp={onKeyUp} autoFocus />}\n    </div>\n  );\n};\n\nconst getStyles = (data: TextData | undefined) => (theme: GrafanaTheme2) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  inlineEditorContainer: css({\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(1),\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n});\n\nexport const textItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'text',\n  name: 'Text',\n  description: 'Display text',\n\n  display: TextDisplay,\n\n  hasEditMode: true,\n\n  defaultSize: {\n    width: 100,\n    height: 50,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultThemeTextColor,\n      },\n      size: 16,\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.text-item.category-text', 'Text')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.text-item.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.text-item.name-text-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.text-item.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.text-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.text-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.text-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: t('canvas.text-item.name-vertical-align', 'Vertical align'),\n        settings: {\n          options: [\n            { value: VAlign.Top, label: t('canvas.text-item.label.top', 'Top') },\n            { value: VAlign.Middle, label: t('canvas.text-item.label.middle', 'Middle') },\n            { value: VAlign.Bottom, label: t('canvas.text-item.label.bottom', 'Bottom') },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.text-item.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.text-item.placeholder.auto', 'Auto'),\n        },\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Triangle = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 200 200\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"200\" height=\"200\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`triangleClip-${uniqueId}`}>\n            <polygon points=\"100,0 200,200 0,200\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#triangleClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <polygon\n          points=\"100,0 200,200 0,200\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <polygon\n          points=\"100,0 200,200 0,200\"\n          clipPath={`url(#triangleClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const triangleItem: CanvasElementItem = {\n  id: 'triangle',\n  name: 'Triangle',\n  description: 'Triangle',\n\n  display: Triangle,\n\n  defaultSize: {\n    width: 160,\n    height: 138,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 160,\n      height: options?.placement?.height ?? 138,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.triangle-item.category-triangle', 'Triangle')];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: t('canvas.triangle-item.name-text', 'Text'),\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: t('canvas.triangle-item.name-text-color', 'Text color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: t('canvas.triangle-item.name-align-text', 'Align text'),\n        settings: {\n          options: [\n            { value: Align.Left, label: t('canvas.triangle-item.label.left', 'Left') },\n            { value: Align.Center, label: t('canvas.triangle-item.label.center', 'Center') },\n            { value: Align.Right, label: t('canvas.triangle-item.label.right', 'Right') },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: t('canvas.triangle-item.name-vertical-align', 'Vertical align'),\n        settings: {\n          options: [\n            { value: VAlign.Top, label: t('canvas.triangle-item.label.top', 'Top') },\n            { value: VAlign.Middle, label: t('canvas.triangle-item.label.middle', 'Middle') },\n            { value: VAlign.Bottom, label: t('canvas.triangle-item.label.bottom', 'Bottom') },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: t('canvas.triangle-item.name-text-size', 'Text size'),\n        settings: {\n          placeholder: t('canvas.triangle-item.placeholder.auto', 'Auto'),\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    // points along the left edge\n    { x: -1, y: -1 }, // bottom left\n    { x: -0.8, y: -0.6 },\n    { x: -0.6, y: -0.2 },\n    { x: -0.4, y: 0.2 },\n    { x: -0.2, y: 0.6 },\n    { x: 0, y: 1 }, // top\n\n    // points along the right edge\n    { x: 0.2, y: 0.6 },\n    { x: 0.4, y: 0.2 },\n    { x: 0.6, y: -0.2 },\n    { x: 0.8, y: -0.6 },\n    { x: 1, y: -1 }, // bottom right\n\n    // points along the bottom edge\n    { x: 0.6, y: -1 },\n    { x: 0.2, y: -1 },\n    { x: -0.2, y: -1 },\n    { x: -0.6, y: -1 },\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, LinkModel } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors/ScalarDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface WindTurbineData {\n  rpm?: number;\n  links?: LinkModel[];\n}\n\ninterface WindTurbineConfig {\n  rpm?: ScalarDimensionConfig;\n}\n\nconst WindTurbineDisplay = ({ data }: CanvasElementProps<WindTurbineConfig, WindTurbineData>) => {\n  const styles = useStyles2(getStyles);\n\n  const windTurbineAnimation = `spin ${data?.rpm ? 60 / Math.abs(data.rpm) : 0}s linear infinite`;\n\n  return (\n    <svg viewBox=\"0 0 189.326 283.989\" preserveAspectRatio=\"xMidYMid meet\" style={{ fill: defaultBgColor }}>\n      <symbol id=\"blade\">\n        <path\n          fill=\"#e6e6e6\"\n          id=\"blade-front\"\n          d=\"M14.6491879,1.85011601 C14.2684455,-0.0535962877 10.7150812,-0.815081206 9.06473318,3.37308585 L0.434338747,70.7658933 L8.93805104,91.9607889 L15.4106729,90.437819 L17.5684455,78.3807425 L14.5218097,1.97679814 L14.6491879,1.85011601 Z\"\n        />\n        <path\n          fill=\"#d0d6d7\"\n          id=\"blade-side\"\n          d=\"M11.0951276,0.581206497 C10.3336427,0.961948956 9.57215777,1.85011601 8.93735499,3.24640371 L0.306960557,70.6392111 L8.81067285,91.8341067 L3.35359629,70.0044084 L11.0951276,0.581206497 Z\"\n        />\n      </symbol>\n\n      <g>\n        <g id=\"structure\" transform=\"translate(58.123, 82.664)\" fillRule=\"nonzero\">\n          <polygon id=\"tower\" fill=\"#e6e6e6\" points=\"33.111,10.984 39.965,10.984 44.28,196.176 28.796,196.176\" />\n          <path\n            id=\"yaw\"\n            fill=\"rgba(0,0,0,0.25)\"\n            d=\"M40.3454756,23.2948956 L40.7262181,34.8445476 C38.8225058,35.0986079 35.7765661,35.0986079 32.349884,34.337123 L32.7306265,23.2955916 L40.3454756,23.2955916 L40.3454756,23.2948956 Z\"\n          />\n          <path\n            id=\"base\"\n            fill=\"#d0d6d7\"\n            transform=\"translate(0 42)\"\n            d=\"M26.3846868,150.591647 L46.5640371,150.591647 C48.8484919,150.591647 50.7522042,152.49536 50.7522042,154.779814 L50.7522042,158.967981 L22.0691415,158.967981 L22.0691415,154.779814 C22.0691415,152.49536 23.9728538,150.591647 26.2573086,150.591647 L26.3846868,150.591647 Z\"\n          />\n          <circle id=\"nacelle\" fill=\"#e6e6e6\" cx=\"36.54\" cy=\"12\" r=\"11.93\" />\n          <circle id=\"gearbox\" fill=\"none\" stroke=\"#d0d6d7\" strokeWidth=\"2.75\" cx=\"36.538\" cy=\"11.999\" r=\"5.8\" />\n        </g>\n        <g className={styles.blade} style={{ animation: windTurbineAnimation }}>\n          <use id=\"blade1\" href=\"#blade\" x=\"83.24\" y=\"0\" />\n          <use id=\"blade2\" href=\"#blade\" x=\"83.24\" y=\"0\" transform=\"rotate(120 94.663 94.663)\" />\n          <use id=\"blade3\" href=\"#blade\" x=\"83.24\" y=\"0\" transform=\"rotate(-120 94.663 94.663)\" />\n        </g>\n      </g>\n    </svg>\n  );\n};\n\nexport const windTurbineItem: CanvasElementItem = {\n  id: 'windTurbine',\n  name: 'Wind Turbine',\n  description: 'Spinny spinny',\n\n  display: WindTurbineDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 155,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 155,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<WindTurbineConfig>) => {\n    const windTurbineConfig = elementOptions.config;\n\n    const data: WindTurbineData = {\n      rpm: windTurbineConfig?.rpm ? dimensionContext.getScalar(windTurbineConfig.rpm).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = [t('canvas.wind-turbine-item.category-wind-turbine', 'Wind Turbine')];\n    builder.addCustomEditor({\n      category,\n      id: 'rpm',\n      path: 'config.rpm',\n      name: t('canvas.wind-turbine-item.name-rpm', 'RPM'),\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  blade: css({\n    transformOrigin: '94.663px 94.663px',\n    transform: 'rotate(15deg)',\n    '@keyframes spin': {\n      from: {\n        transform: 'rotate(0deg)',\n      },\n      to: {\n        transform: 'rotate(360deg)',\n      },\n    },\n  }),\n});\n","import { Registry } from '@grafana/data';\n\nimport { CanvasElementItem, CanvasElementOptions } from './element';\nimport { buttonItem } from './elements/button';\nimport { cloudItem } from './elements/cloud';\nimport { droneFrontItem } from './elements/droneFront';\nimport { droneSideItem } from './elements/droneSide';\nimport { droneTopItem } from './elements/droneTop';\nimport { ellipseItem } from './elements/ellipse';\nimport { iconItem } from './elements/icon';\nimport { metricValueItem } from './elements/metricValue';\nimport { parallelogramItem } from './elements/parallelogram';\nimport { rectangleItem } from './elements/rectangle';\nimport { serverItem } from './elements/server/server';\nimport { textItem } from './elements/text';\nimport { triangleItem } from './elements/triangle';\nimport { windTurbineItem } from './elements/windTurbine';\n\nexport const DEFAULT_CANVAS_ELEMENT_CONFIG: CanvasElementOptions = {\n  ...metricValueItem.getNewOptions(),\n  placement: { ...metricValueItem.getNewOptions().placement, ...metricValueItem.defaultSize },\n  type: metricValueItem.id,\n  name: `Element 1`,\n};\n\nexport const defaultElementItems = [\n  metricValueItem, // default for now\n  textItem,\n  ellipseItem,\n  rectangleItem,\n  iconItem,\n  serverItem,\n  triangleItem,\n  cloudItem,\n  parallelogramItem,\n];\n\nexport const advancedElementItems = [buttonItem, windTurbineItem, droneTopItem, droneFrontItem, droneSideItem];\n\nexport const canvasElementRegistry = new Registry<CanvasElementItem>(() => [\n  ...defaultElementItems,\n  ...advancedElementItems,\n]);\n","import * as React from 'react';\nimport { CSSProperties } from 'react';\nimport { OnDrag, OnResize, OnRotate } from 'react-moveable/declaration/types';\n\nimport {\n  FieldType,\n  getLinksSupplier,\n  LinkModel,\n  ScopedVars,\n  ValueLinkConfig,\n  OneClickMode,\n  ActionModel,\n  ActionVariableInput,\n  ActionType,\n} from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { TooltipDisplayMode } from '@grafana/schema';\nimport { ConfirmModal, VariablesInputModal } from '@grafana/ui';\nimport { LayerElement } from 'app/core/components/Layers/types';\nimport { config } from 'app/core/config';\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport {\n  BackgroundImageSize,\n  Constraint,\n  HorizontalConstraint,\n  Placement,\n  VerticalConstraint,\n} from 'app/plugins/panel/canvas/panelcfg.gen';\nimport {\n  applyStyles,\n  getConnectionsByTarget,\n  getRowIndex,\n  isConnectionTarget,\n  removeStyles,\n} from 'app/plugins/panel/canvas/utils';\n\nimport { getActions, getActionsDefaultField, isInfinityActionWithAuth } from '../../actions/utils';\nimport { CanvasElementItem, CanvasElementOptions } from '../element';\nimport { canvasElementRegistry } from '../registry';\n\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\n\nlet counter = 0;\n\nexport const SVGElements = new Set<string>(['parallelogram', 'triangle', 'cloud', 'ellipse']);\n\nexport class ElementState implements LayerElement {\n  // UID necessary for moveable to work (for now)\n  readonly UID = counter++;\n  revId = 0;\n  sizeStyle: CSSProperties = {};\n  dataStyle: CSSProperties = {};\n\n  // Temp stored constraint for visualization purposes (switch to top / left constraint to simplify some functionality)\n  tempConstraint: Constraint | undefined;\n\n  // Filled in by ref\n  div?: HTMLDivElement;\n\n  // Calculated\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  data?: any; // depends on the type\n\n  getLinks?: (config: ValueLinkConfig) => LinkModel[];\n\n  // cached for tooltips/mousemove\n  oneClickMode = OneClickMode.Off;\n  showActionConfirmation = false;\n\n  showActionVarsModal = false;\n  actionVars: ActionVariableInput = {};\n\n  setActionVars = (vars: ActionVariableInput) => {\n    this.actionVars = vars;\n    this.forceUpdate();\n  };\n\n  constructor(\n    public item: CanvasElementItem,\n    public options: CanvasElementOptions,\n    public parent?: FrameState\n  ) {\n    const fallbackName = `Element ${Date.now()}`;\n    if (!options) {\n      this.options = { type: item.id, name: fallbackName };\n    }\n\n    options.constraint = options.constraint ?? {\n      vertical: VerticalConstraint.Top,\n      horizontal: HorizontalConstraint.Left,\n    };\n    options.placement = options.placement ?? { width: 100, height: 100, top: 0, left: 0, rotation: 0 };\n    options.background = options.background ?? { color: { fixed: 'transparent' } };\n    options.border = options.border ?? { color: { fixed: 'dark-green' } };\n\n    const scene = this.getScene();\n    if (!options.name) {\n      const newName = scene?.getNextElementName();\n      options.name = newName ?? fallbackName;\n    }\n    scene?.byName.set(options.name, this);\n  }\n\n  private getScene(): Scene | undefined {\n    let trav = this.parent;\n    while (trav) {\n      if (trav.isRoot()) {\n        return trav.scene;\n      }\n      trav = trav.parent;\n    }\n\n    return undefined;\n  }\n\n  getName() {\n    return this.options.name;\n  }\n\n  /** Use the configured options to update CSS style properties directly on the wrapper div **/\n  applyLayoutStylesToDiv(disablePointerEvents?: boolean) {\n    if (config.featureToggles.canvasPanelPanZoom) {\n      this.applyLayoutStylesToDiv2(disablePointerEvents);\n      return;\n    }\n    if (this.isRoot()) {\n      // Root supersedes layout engine and is always 100% width + height of panel\n      return;\n    }\n\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n    const placement: Placement = this.options.placement ?? {};\n\n    const editingEnabled = this.getScene()?.isEditingEnabled;\n\n    const style: React.CSSProperties = {\n      cursor: editingEnabled ? 'grab' : 'auto',\n      pointerEvents: disablePointerEvents ? 'none' : 'auto',\n      position: 'absolute',\n      // Minimum element size is 10x10\n      minWidth: '10px',\n      minHeight: '10px',\n      rotate: `${placement.rotation ?? 0}deg`,\n    };\n\n    const translate = ['0px', '0px'];\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        style.top = `${placement.top}px`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = placement.bottom ?? 0;\n        placement.height = placement.height ?? 100;\n        style.bottom = `${placement.bottom}px`;\n        style.height = `${placement.height}px`;\n        delete placement.top;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        style.top = `${placement.top}px`;\n        style.bottom = `${placement.bottom}px`;\n        delete placement.height;\n        style.height = '';\n        break;\n      case VerticalConstraint.Center:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        translate[1] = '-50%';\n        style.top = `calc(50% - ${placement.top}px)`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        style.top = `${placement.top}%`;\n        style.bottom = `${placement.bottom}%`;\n        delete placement.height;\n        style.height = '';\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        style.left = `${placement.left}px`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = placement.right ?? 0;\n        placement.width = placement.width ?? 100;\n        style.right = `${placement.right}px`;\n        style.width = `${placement.width}px`;\n        delete placement.left;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        style.left = `${placement.left}px`;\n        style.right = `${placement.right}px`;\n        delete placement.width;\n        style.width = '';\n        break;\n      case HorizontalConstraint.Center:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        translate[0] = '-50%';\n        style.left = `calc(50% - ${placement.left}px)`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        style.left = `${placement.left}%`;\n        style.right = `${placement.right}%`;\n        delete placement.width;\n        style.width = '';\n        break;\n    }\n\n    style.transform = `translate(${translate[0]}, ${translate[1]})`;\n    this.options.placement = placement;\n    this.sizeStyle = style;\n\n    if (this.div) {\n      applyStyles(this.sizeStyle, this.div);\n\n      // TODO: This is a hack, we should have a better way to handle this\n      const elementType = this.options.type;\n      if (!SVGElements.has(elementType)) {\n        // apply styles to div if it's not an SVG element\n        applyStyles(this.dataStyle, this.div);\n      } else {\n        // ELEMENT IS SVG\n        // clean data styles from div if it's an SVG element; SVG elements have their own data styles;\n        // this is necessary for changing type of element cases;\n        // wrapper div element (this.div) doesn't re-render (has static `key` property),\n        // so we have to clean styles manually;\n        removeStyles(this.dataStyle, this.div);\n      }\n    }\n  }\n\n  /** Use the configured options to update CSS style properties directly on the wrapper div **/\n  applyLayoutStylesToDiv2(disablePointerEvents?: boolean) {\n    if (this.isRoot()) {\n      // Root supersedes layout engine and is always 100% width + height of panel\n      return;\n    }\n\n    const scene = this.getScene();\n    const { width: sceneWidth, height: sceneHeight } = scene ?? {};\n\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n    const placement: Placement = this.options.placement ?? {};\n\n    const editingEnabled = scene?.isEditingEnabled;\n\n    const style: React.CSSProperties = {\n      cursor: editingEnabled ? 'grab' : 'auto',\n      pointerEvents: disablePointerEvents ? 'none' : 'auto',\n      position: 'absolute',\n      // Minimum element size is 10x10\n      minWidth: '10px',\n      minHeight: '10px',\n    };\n\n    let transformY = '0px';\n    let transformX = '0px';\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        transformY = `${placement.top ?? 0}px`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = placement.bottom ?? 0;\n        placement.height = placement.height ?? 100;\n        transformY = `${sceneHeight! - (placement.bottom ?? 0) - (placement.height ?? 100)}px`;\n        style.height = `${placement.height}px`;\n        delete placement.top;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        transformY = `${placement.top ?? 0}px`;\n        style.height = `${sceneHeight! - (placement.top ?? 0) - (placement.bottom ?? 0)}px`;\n        delete placement.height;\n        break;\n      case VerticalConstraint.Center:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        transformY = `${sceneHeight! / 2 - (placement.top ?? 0) - (placement.height ?? 0) / 2}px`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        transformY = `${(placement.top ?? 0) * (sceneHeight! / 100)}px`;\n        style.height = `${sceneHeight! - (placement.top ?? 0) * (sceneHeight! / 100) - (placement.bottom ?? 0) * (sceneHeight! / 100)}px`;\n        delete placement.height;\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        transformX = `${placement.left ?? 0}px`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = placement.right ?? 0;\n        placement.width = placement.width ?? 100;\n        transformX = `${sceneWidth! - (placement.right ?? 0) - (placement.width ?? 100)}px`;\n        style.width = `${placement.width}px`;\n        delete placement.left;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        transformX = `${placement.left ?? 0}px`;\n        style.width = `${sceneWidth! - (placement.left ?? 0) - (placement.right ?? 0)}px`;\n        delete placement.width;\n        break;\n      case HorizontalConstraint.Center:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        transformX = `${sceneWidth! / 2 - (placement.left ?? 0) - (placement.width ?? 0) / 2}px`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        transformX = `${(placement.left ?? 0) * (sceneWidth! / 100)}px`;\n        style.width = `${sceneWidth! - (placement.left ?? 0) * (sceneWidth! / 100) - (placement.right ?? 0) * (sceneWidth! / 100)}px`;\n        delete placement.width;\n        break;\n    }\n    this.options.placement = placement;\n    style.transform = `translate(${transformX}, ${transformY}) rotate(${placement.rotation ?? 0}deg)`;\n    this.sizeStyle = style;\n\n    if (this.div) {\n      applyStyles(this.sizeStyle, this.div);\n\n      // TODO: This is a hack, we should have a better way to handle this\n      const elementType = this.options.type;\n      if (!SVGElements.has(elementType)) {\n        // apply styles to div if it's not an SVG element\n        applyStyles(this.dataStyle, this.div);\n      } else {\n        // ELEMENT IS SVG\n        // clean data styles from div if it's an SVG element; SVG elements have their own data styles;\n        // this is necessary for changing type of element cases;\n        // wrapper div element (this.div) doesn't re-render (has static `key` property),\n        // so we have to clean styles manually;\n        removeStyles(this.dataStyle, this.div);\n      }\n    }\n  }\n\n  getTopLeftValues(element: Element) {\n    const style = window.getComputedStyle(element);\n    const matrix = new DOMMatrix(style.transform || '');\n    return {\n      left: matrix.m41,\n      top: matrix.m42,\n      width: style.width ? parseFloat(style.width) : element.clientWidth,\n      height: style.height ? parseFloat(style.height) : element.clientHeight,\n    }; // m41 = translateX, m42 = translateY\n  }\n\n  setPlacementFromConstraint(elementContainer?: DOMRect, parentContainer?: DOMRect, transformScale = 1) {\n    if (config.featureToggles.canvasPanelPanZoom) {\n      this.setPlacementFromConstraint2(elementContainer, parentContainer, transformScale);\n      return;\n    }\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n\n    if (!elementContainer) {\n      elementContainer = this.div && this.div.getBoundingClientRect();\n    }\n    let parentBorderWidth = 0;\n    if (!parentContainer) {\n      parentContainer = this.div && this.div.parentElement?.getBoundingClientRect();\n      parentBorderWidth = this.parent?.isRoot()\n        ? 0\n        : parseFloat(getComputedStyle(this.div?.parentElement!).borderWidth);\n    }\n\n    // For elements with rotation, a delta needs to be applied to account for bounding box rotation\n    // TODO: Fix behavior for top+bottom, left+right, center, and scale constraints\n    let rotationTopOffset = 0;\n    let rotationLeftOffset = 0;\n    if (this.options.placement?.rotation && this.options.placement?.width && this.options.placement?.height) {\n      const rotationDegrees = this.options.placement.rotation;\n      const rotationRadians = (Math.PI / 180) * rotationDegrees;\n      let rotationOffset = rotationRadians;\n\n      switch (true) {\n        case rotationDegrees >= 0 && rotationDegrees < 90:\n          // no-op\n          break;\n        case rotationDegrees >= 90 && rotationDegrees < 180:\n          rotationOffset = Math.PI - rotationRadians;\n          break;\n        case rotationDegrees >= 180 && rotationDegrees < 270:\n          rotationOffset = Math.PI + rotationRadians;\n          break;\n        case rotationDegrees >= 270:\n          rotationOffset = -rotationRadians;\n          break;\n      }\n\n      const calculateDelta = (dimension1: number, dimension2: number) =>\n        (dimension1 / 2) * Math.sin(rotationOffset) + (dimension2 / 2) * (Math.cos(rotationOffset) - 1);\n\n      rotationTopOffset = calculateDelta(this.options.placement.width, this.options.placement.height);\n      rotationLeftOffset = calculateDelta(this.options.placement.height, this.options.placement.width);\n    }\n\n    const relativeTop =\n      elementContainer && parentContainer\n        ? Math.round(elementContainer.top - parentContainer.top - parentBorderWidth + rotationTopOffset) /\n          transformScale\n        : 0;\n    const relativeBottom =\n      elementContainer && parentContainer\n        ? Math.round(parentContainer.bottom - parentBorderWidth - elementContainer.bottom + rotationTopOffset) /\n          transformScale\n        : 0;\n    const relativeLeft =\n      elementContainer && parentContainer\n        ? Math.round(elementContainer.left - parentContainer.left - parentBorderWidth + rotationLeftOffset) /\n          transformScale\n        : 0;\n    const relativeRight =\n      elementContainer && parentContainer\n        ? Math.round(parentContainer.right - parentBorderWidth - elementContainer.right + rotationLeftOffset) /\n          transformScale\n        : 0;\n\n    const placement: Placement = {};\n\n    const width = (elementContainer?.width ?? 100) / transformScale;\n    const height = (elementContainer?.height ?? 100) / transformScale;\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = relativeTop;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = relativeBottom;\n        placement.height = height;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = relativeTop;\n        placement.bottom = relativeBottom;\n        break;\n      case VerticalConstraint.Center:\n        const elementCenter = elementContainer ? relativeTop + height / 2 : 0;\n        const parentCenter = parentContainer ? parentContainer.height / 2 : 0;\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.top = distanceFromCenter;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = (relativeTop / (parentContainer?.height ?? height)) * 100 * transformScale;\n        placement.bottom = (relativeBottom / (parentContainer?.height ?? height)) * 100 * transformScale;\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = relativeLeft;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = relativeRight;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = relativeLeft;\n        placement.right = relativeRight;\n        break;\n      case HorizontalConstraint.Center:\n        const elementCenter = elementContainer ? relativeLeft + width / 2 : 0;\n        const parentCenter = parentContainer ? parentContainer.width / 2 : 0;\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.left = distanceFromCenter;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = (relativeLeft / (parentContainer?.width ?? width)) * 100 * transformScale;\n        placement.right = (relativeRight / (parentContainer?.width ?? width)) * 100 * transformScale;\n        break;\n    }\n\n    if (this.options.placement?.rotation) {\n      placement.rotation = this.options.placement.rotation;\n      placement.width = this.options.placement.width;\n      placement.height = this.options.placement.height;\n    }\n\n    this.options.placement = placement;\n\n    this.applyLayoutStylesToDiv();\n    this.revId++;\n\n    this.getScene()?.save();\n  }\n\n  setPlacementFromConstraint2(elementContainer?: DOMRect, parentContainer?: DOMRect, transformScale = 1) {\n    const scene = this.getScene()!;\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n\n    const elementRect = this.getTopLeftValues(this.div!);\n\n    if (!elementContainer) {\n      elementContainer = this.div && this.div.getBoundingClientRect();\n    }\n    // let parentBorderWidth = 0;\n    if (!parentContainer) {\n      parentContainer = this.div && this.div.parentElement?.getBoundingClientRect();\n    }\n\n    const relativeTop = Math.round(elementRect.top);\n    const relativeBottom = Math.round(scene.height - elementRect.top - elementRect.height);\n    const relativeLeft = Math.round(elementRect.left);\n    const relativeRight = Math.round(scene.width - elementRect.left - elementRect.width);\n\n    const placement: Placement = {};\n\n    const width = elementRect.width;\n    const height = elementRect.height;\n\n    // INFO: calculate it anyway to be able to use it for pan&zoom\n    placement.top = relativeTop;\n    placement.left = relativeLeft;\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = relativeTop;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = relativeBottom;\n        placement.height = height;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = relativeTop;\n        placement.bottom = relativeBottom;\n        break;\n      case VerticalConstraint.Center:\n        const elementCenter = elementContainer ? relativeTop + height / 2 : 0;\n        const parentCenter = scene.height / 2; // Use scene height instead of scaled viewport height\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.top = distanceFromCenter;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = (relativeTop / (parentContainer?.height ?? height)) * 100 * transformScale;\n        placement.bottom = (relativeBottom / (parentContainer?.height ?? height)) * 100 * transformScale;\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = relativeLeft;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = relativeRight;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = relativeLeft;\n        placement.right = relativeRight;\n        break;\n      case HorizontalConstraint.Center:\n        const elementCenter = elementContainer ? relativeLeft + width / 2 : 0;\n        const parentCenter = scene.width / 2; // Use scene width instead of scaled viewport width\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.left = distanceFromCenter;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = (relativeLeft / (parentContainer?.width ?? width)) * 100 * transformScale;\n        placement.right = (relativeRight / (parentContainer?.width ?? width)) * 100 * transformScale;\n        break;\n    }\n\n    if (this.options.placement?.rotation) {\n      placement.rotation = this.options.placement.rotation;\n      placement.width = this.options.placement.width;\n      placement.height = this.options.placement.height;\n    }\n\n    this.options.placement = placement;\n\n    this.applyLayoutStylesToDiv();\n    this.revId++;\n\n    this.getScene()?.save();\n  }\n\n  updateData(ctx: DimensionContext) {\n    if (this.item.prepareData) {\n      this.data = this.item.prepareData(ctx, this.options);\n      this.revId++; // rerender\n    }\n\n    const scene = this.getScene();\n    const frames = scene?.data?.series;\n\n    this.options.links = this.options.links?.filter((link) => link !== null);\n\n    if (this.options.links?.some((link) => link.oneClick === true)) {\n      this.oneClickMode = OneClickMode.Link;\n    } else if (\n      this.options.actions\n        ?.filter((action) => action.type === ActionType.Fetch || isInfinityActionWithAuth(action))\n        .some((action) => action.oneClick)\n    ) {\n      const scene = this.getScene();\n      const canExecuteActions = scene?.panel?.panelContext?.canExecuteActions;\n      const userCanExecuteActions = canExecuteActions?.() ?? false;\n\n      this.oneClickMode = userCanExecuteActions ? OneClickMode.Action : OneClickMode.Off;\n    } else {\n      this.oneClickMode = OneClickMode.Off;\n    }\n\n    if (frames) {\n      const defaultField = {\n        name: 'Default field',\n        type: FieldType.string,\n        config: { links: this.options.links ?? [], actions: this.options.actions ?? [] },\n        values: [],\n      };\n\n      this.getLinks = getLinksSupplier(\n        frames[0],\n        defaultField,\n        {\n          __dataContext: {\n            value: {\n              data: frames,\n              field: defaultField,\n              frame: frames[0],\n              frameIndex: 0,\n            },\n          },\n        },\n        scene?.panel.props.replaceVariables!\n      );\n    }\n\n    const { background, border } = this.options;\n    const css: CSSProperties = {};\n    if (background) {\n      if (background.color) {\n        const color = ctx.getColor(background.color);\n        css.backgroundColor = color.value();\n      }\n      if (background.image) {\n        const image = ctx.getResource(background.image);\n        if (image) {\n          const v = image.value();\n          if (v) {\n            css.backgroundImage = `url(\"${v}\")`;\n            switch (background.size ?? BackgroundImageSize.Contain) {\n              case BackgroundImageSize.Contain:\n                css.backgroundSize = 'contain';\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Cover:\n                css.backgroundSize = 'cover';\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Original:\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Tile:\n                css.backgroundRepeat = 'repeat';\n                break;\n              case BackgroundImageSize.Fill:\n                css.backgroundSize = '100% 100%';\n                break;\n            }\n          } else {\n            css.backgroundImage = '';\n          }\n        }\n      }\n    }\n\n    if (border && border.color && border.width !== undefined) {\n      const color = ctx.getColor(border.color);\n      css.borderWidth = `${border.width}px`;\n      css.borderStyle = 'solid';\n      css.borderColor = color.value();\n\n      // Move the image to inside the border\n      if (css.backgroundImage) {\n        css.backgroundOrigin = 'padding-box';\n      }\n    }\n\n    if (border && border.radius !== undefined) {\n      css.borderRadius = `${border.radius}px`;\n    }\n\n    this.dataStyle = css;\n    this.applyLayoutStylesToDiv();\n  }\n\n  isRoot(): this is RootElement {\n    return false;\n  }\n\n  /** Recursively visit all nodes */\n  visit(visitor: (v: ElementState) => void) {\n    visitor(this);\n  }\n\n  onChange(options: CanvasElementOptions) {\n    if (this.item.id !== options.type) {\n      this.item = canvasElementRegistry.getIfExists(options.type) ?? notFoundItem;\n    }\n\n    // rename handling\n    const oldName = this.options.name;\n    const newName = options.name;\n\n    this.revId++;\n    this.options = { ...options };\n    let trav = this.parent;\n    while (trav) {\n      if (trav.isRoot()) {\n        trav.scene.save();\n        break;\n      }\n      trav.revId++;\n      trav = trav.parent;\n    }\n\n    const scene = this.getScene();\n    if (oldName !== newName && scene) {\n      if (isConnectionTarget(this, scene.byName)) {\n        getConnectionsByTarget(this, scene).forEach((connection) => {\n          connection.info.targetName = newName;\n        });\n      }\n\n      scene.byName.delete(oldName);\n      scene.byName.set(newName, this);\n    }\n  }\n\n  getSaveModel() {\n    return { ...this.options };\n  }\n\n  initElement = (target: HTMLDivElement) => {\n    this.div = target;\n    this.applyLayoutStylesToDiv();\n  };\n\n  applyDrag = (event: OnDrag) => {\n    const hasHorizontalCenterConstraint = this.options.constraint?.horizontal === HorizontalConstraint.Center;\n    const hasVerticalCenterConstraint = this.options.constraint?.vertical === VerticalConstraint.Center;\n    if (hasHorizontalCenterConstraint || hasVerticalCenterConstraint) {\n      const numberOfTargets = this.getScene()?.selecto?.getSelectedTargets().length ?? 0;\n      const isMultiSelection = numberOfTargets > 1;\n      if (!isMultiSelection) {\n        const elementContainer = this.div?.getBoundingClientRect();\n        const height = elementContainer?.height ?? 100;\n        const yOffset = hasVerticalCenterConstraint ? height / 4 : 0;\n        event.target.style.transform = `translate(${event.translate[0]}px, ${event.translate[1] - yOffset}px)`;\n        return;\n      }\n    }\n\n    event.target.style.transform = event.transform;\n  };\n\n  applyRotate = (event: OnRotate) => {\n    const rotationDelta = event.delta;\n    const placement = this.options.placement!;\n    const placementRotation = placement.rotation ?? 0;\n\n    const calculatedRotation = placementRotation + rotationDelta;\n\n    // Ensure rotation is between 0 and 360\n    placement.rotation = calculatedRotation - Math.floor(calculatedRotation / 360) * 360;\n    event.target.style.transform = event.transform;\n  };\n\n  // kinda like:\n  // https://github.com/grafana/grafana-edge-app/blob/main/src/panels/draw/WrapItem.tsx#L44\n  applyResize = (event: OnResize) => {\n    const placement = this.options.placement!;\n\n    const style = event.target.style;\n    let deltaX = event.delta[0];\n    let deltaY = event.delta[1];\n    let dirLR = event.direction[0];\n    let dirTB = event.direction[1];\n\n    // Handle case when element is rotated\n    if (placement.rotation) {\n      const rotation = placement.rotation ?? 0;\n      const rotationInRadians = (rotation * Math.PI) / 180;\n      const originalDirLR = dirLR;\n      const originalDirTB = dirTB;\n\n      dirLR = Math.sign(originalDirLR * Math.cos(rotationInRadians) - originalDirTB * Math.sin(rotationInRadians));\n      dirTB = Math.sign(originalDirLR * Math.sin(rotationInRadians) + originalDirTB * Math.cos(rotationInRadians));\n    }\n\n    if (dirLR === 1) {\n      placement.width = event.width;\n      style.width = `${placement.width}px`;\n    } else if (dirLR === -1) {\n      placement.left! -= deltaX;\n      placement.width = event.width;\n      if (config.featureToggles.canvasPanelPanZoom) {\n        style.transform = `translate(${placement.left}px, ${placement.top}px) rotate(${placement.rotation ?? 0}deg)`;\n      } else {\n        style.left = `${placement.left}px`;\n      }\n      style.width = `${placement.width}px`;\n    }\n\n    if (dirTB === -1) {\n      placement.top! -= deltaY;\n      placement.height = event.height;\n      if (config.featureToggles.canvasPanelPanZoom) {\n        style.transform = `translate(${placement.left}px, ${placement.top}px) rotate(${placement.rotation ?? 0}deg)`;\n      } else {\n        style.top = `${placement.top}px`;\n      }\n      style.height = `${placement.height}px`;\n    } else if (dirTB === 1) {\n      placement.height = event.height;\n      style.height = `${placement.height}px`;\n    }\n  };\n\n  handleMouseEnter = (event: React.MouseEvent, isSelected: boolean | undefined) => {\n    const scene = this.getScene();\n\n    const shouldHandleTooltip =\n      !scene?.isEditingEnabled && (!scene?.tooltipPayload?.isOpen || scene?.tooltipPayload?.element === this);\n    if (shouldHandleTooltip) {\n      this.handleTooltip(event);\n    } else if (!isSelected) {\n      scene?.connections.handleMouseEnter(event);\n    }\n\n    if (this.div != null) {\n      if (this.oneClickMode === OneClickMode.Link) {\n        const primaryDataLink = this.getPrimaryDataLink();\n        if (primaryDataLink) {\n          this.div.style.cursor = 'pointer';\n          this.div.title = `Navigate to ${primaryDataLink.title === '' ? 'data link' : primaryDataLink.title}`;\n        }\n      } else if (this.oneClickMode === OneClickMode.Action) {\n        const primaryAction = this.getPrimaryAction();\n        if (primaryAction) {\n          this.div.style.cursor = 'pointer';\n          this.div.title = primaryAction.title;\n        }\n      }\n    }\n  };\n\n  getPrimaryDataLink = () => {\n    if (this.getLinks) {\n      const links = this.getLinks({ valueRowIndex: getRowIndex(this.data.field, this.getScene()!) });\n      return links.find((link) => link.oneClick === true);\n    }\n\n    return undefined;\n  };\n\n  getPrimaryAction = () => {\n    const scene = this.getScene();\n    const canExecuteActions = scene?.panel?.panelContext?.canExecuteActions;\n    const userCanExecuteActions = canExecuteActions?.() ?? false;\n\n    if (!userCanExecuteActions) {\n      return undefined;\n    }\n\n    const config: ValueLinkConfig = { valueRowIndex: getRowIndex(this.data.field, scene!) };\n    const actionsDefaultFieldConfig = { links: this.options.links ?? [], actions: this.options.actions ?? [] };\n    const frames = scene?.data?.series;\n\n    if (frames) {\n      const defaultField = getActionsDefaultField(actionsDefaultFieldConfig.links, actionsDefaultFieldConfig.actions);\n      const scopedVars: ScopedVars = {\n        __dataContext: {\n          value: {\n            data: frames,\n            field: defaultField,\n            frame: frames[0],\n            frameIndex: 0,\n          },\n        },\n      };\n\n      const actions = getActions(\n        frames[0],\n        defaultField,\n        scopedVars,\n        scene?.panel.props.replaceVariables!,\n        actionsDefaultFieldConfig.actions,\n        config\n      );\n      return actions.find((action) => action.oneClick === true);\n    }\n\n    return undefined;\n  };\n\n  handleTooltip = (event: React.MouseEvent) => {\n    const scene = this.getScene();\n    if (!scene || !scene.tooltipCallback) {\n      return;\n    }\n\n    const shouldDisableForOneClick = scene.tooltipDisableForOneClick && this.oneClickMode !== OneClickMode.Off;\n    const shouldShowTooltip = scene.tooltipMode !== TooltipDisplayMode.None && !shouldDisableForOneClick;\n\n    if (shouldShowTooltip) {\n      const rect = this.div?.getBoundingClientRect();\n      scene.tooltipCallback({\n        anchorPoint: { x: rect?.right ?? event.pageX, y: rect?.top ?? event.pageY },\n        element: this,\n        isOpen: false,\n      });\n    }\n  };\n\n  handleMouseLeave = (event: React.MouseEvent) => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback && !scene?.tooltipPayload?.isOpen) {\n      scene.tooltipCallback(undefined);\n    }\n\n    if (this.oneClickMode !== OneClickMode.Off && this.div) {\n      this.div.style.cursor = 'auto';\n      this.div.title = '';\n    }\n  };\n\n  onElementClick = (event: React.MouseEvent) => {\n    // If one-click access is enabled, open the primary link\n    if (this.oneClickMode === OneClickMode.Link) {\n      let primaryDataLink = this.getPrimaryDataLink();\n      if (primaryDataLink) {\n        window.open(primaryDataLink.href, primaryDataLink.target ?? '_self');\n      }\n    } else if (this.oneClickMode === OneClickMode.Action) {\n      const primaryAction = this.getPrimaryAction();\n      const actionHasVariables = primaryAction?.variables && primaryAction.variables.length > 0;\n\n      if (actionHasVariables) {\n        this.showActionVarsModal = true;\n        this.forceUpdate();\n      } else {\n        this.showActionConfirmation = true;\n        this.forceUpdate();\n      }\n    } else {\n      this.handleTooltip(event);\n      this.onTooltipCallback();\n    }\n  };\n\n  onElementKeyDown = (event: React.KeyboardEvent) => {\n    if (\n      event.key === 'Enter' &&\n      (event.currentTarget instanceof HTMLElement || event.currentTarget instanceof SVGElement)\n    ) {\n      const scene = this.getScene();\n      scene?.select({ targets: [event.currentTarget] });\n    }\n  };\n\n  onTooltipCallback = () => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback && scene.tooltipPayload?.anchorPoint) {\n      scene.tooltipCallback({\n        anchorPoint: { x: scene.tooltipPayload.anchorPoint.x, y: scene.tooltipPayload.anchorPoint.y },\n        element: this,\n        isOpen: true,\n      });\n    }\n  };\n\n  forceUpdate = () => {\n    const scene = this.getScene();\n    if (scene?.actionConfirmationCallback) {\n      scene.actionConfirmationCallback();\n    }\n  };\n\n  renderActionsConfirmModal = (action: ActionModel | undefined) => {\n    if (!action) {\n      return;\n    }\n\n    return (\n      <>\n        {this.showActionConfirmation && action && (\n          <ConfirmModal\n            isOpen={true}\n            title={t('grafana-ui.action-editor.button.confirm-action', 'Confirm action')}\n            body={action.confirmation(/** TODO: implement actionVars */)}\n            confirmText={t('grafana-ui.action-editor.button.confirm', 'Confirm')}\n            confirmButtonVariant=\"primary\"\n            onConfirm={() => {\n              this.showActionConfirmation = false;\n              action.onClick(new MouseEvent('click'), null, this.actionVars);\n              this.forceUpdate();\n            }}\n            onDismiss={() => {\n              this.showActionConfirmation = false;\n              this.forceUpdate();\n            }}\n          />\n        )}\n      </>\n    );\n  };\n\n  renderVariablesInputModal = (action: ActionModel | undefined) => {\n    if (!action || !action.variables || action.variables.length === 0) {\n      return;\n    }\n\n    const onModalContinue = () => {\n      this.showActionVarsModal = false;\n      this.showActionConfirmation = true;\n      this.forceUpdate();\n    };\n\n    return (\n      <VariablesInputModal\n        action={action}\n        variables={this.actionVars}\n        setVariables={this.setActionVars}\n        onDismiss={() => {\n          this.showActionVarsModal = false;\n          this.forceUpdate();\n        }}\n        onShowConfirm={onModalContinue}\n      />\n    );\n  };\n\n  render() {\n    const { item, div } = this;\n    const scene = this.getScene();\n    const isSelected = div && scene && scene.selecto && scene.selecto.getSelectedTargets().includes(div);\n\n    return (\n      <>\n        <div\n          key={this.UID}\n          ref={this.initElement}\n          onMouseEnter={(e: React.MouseEvent) => this.handleMouseEnter(e, isSelected)}\n          onMouseLeave={!scene?.isEditingEnabled ? this.handleMouseLeave : undefined}\n          onClick={!scene?.isEditingEnabled ? this.onElementClick : undefined}\n          onKeyDown={!scene?.isEditingEnabled ? this.onElementKeyDown : undefined}\n          role=\"button\"\n          tabIndex={0}\n          style={{ userSelect: 'none' }}\n        >\n          <item.display\n            key={`${this.UID}/${this.revId}`}\n            config={this.options.config}\n            data={this.data}\n            isSelected={isSelected}\n          />\n        </div>\n        {this.showActionConfirmation && this.renderActionsConfirmModal(this.getPrimaryAction())}\n        {this.showActionVarsModal && this.renderVariablesInputModal(this.getPrimaryAction())}\n      </>\n    );\n  }\n}\n","import { isNumber, isString } from 'lodash';\n\nimport { DataFrame, Field, AppEvents, getFieldDisplayName, PluginState, SelectableValue } from '@grafana/data';\nimport { ConnectionDirection } from '@grafana/schema';\nimport appEvents from 'app/core/app_events';\nimport { hasAlphaPanels, config } from 'app/core/config';\nimport { CanvasConnection, CanvasElementItem, CanvasElementOptions } from 'app/features/canvas/element';\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { advancedElementItems, canvasElementRegistry, defaultElementItems } from 'app/features/canvas/registry';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene, SelectionParams } from 'app/features/canvas/runtime/scene';\n\nimport { AnchorPoint, ConnectionState, LineStyle, StrokeDasharray } from './types';\n\nexport function doSelect(scene: Scene, element: ElementState | FrameState) {\n  try {\n    let selection: SelectionParams = { targets: [] };\n    if (element instanceof FrameState) {\n      const targetElements: HTMLDivElement[] = [];\n      targetElements.push(element?.div!);\n      selection.targets = targetElements;\n      selection.frame = element;\n      scene.select(selection);\n    } else {\n      scene.currentLayer = element.parent;\n      selection.targets = [element?.div!];\n      scene.select(selection);\n    }\n  } catch (error) {\n    appEvents.emit(AppEvents.alertError, ['Unable to select element, try selecting element in panel instead']);\n  }\n}\n\nexport function getElementTypes(shouldShowAdvancedTypes: boolean | undefined, current?: string): RegistrySelectInfo {\n  if (shouldShowAdvancedTypes) {\n    return getElementTypesOptions([...defaultElementItems, ...advancedElementItems], current);\n  }\n\n  return getElementTypesOptions([...defaultElementItems], current);\n}\n\ninterface RegistrySelectInfo {\n  options: Array<SelectableValue<string>>;\n  current: Array<SelectableValue<string>>;\n}\n\nexport function getElementTypesOptions(items: CanvasElementItem[], current: string | undefined): RegistrySelectInfo {\n  const selectables: RegistrySelectInfo = { options: [], current: [] };\n  const alpha: Array<SelectableValue<string>> = [];\n\n  for (const item of items) {\n    const option: SelectableValue<string> = { label: item.name, value: item.id, description: item.description };\n    if (item.state === PluginState.alpha) {\n      if (!hasAlphaPanels) {\n        continue;\n      }\n      option.label = `${item.name} (Alpha)`;\n      alpha.push(option);\n    } else {\n      selectables.options.push(option);\n    }\n\n    if (item.id === current) {\n      selectables.current.push(option);\n    }\n  }\n\n  for (const a of alpha) {\n    selectables.options.push(a);\n  }\n\n  return selectables;\n}\n\nexport function onAddItem(sel: SelectableValue<string>, rootLayer: FrameState | undefined, anchorPoint?: AnchorPoint) {\n  const newItem = canvasElementRegistry.getIfExists(sel.value) ?? notFoundItem;\n  const newElementOptions: CanvasElementOptions = {\n    ...newItem.getNewOptions(),\n    type: newItem.id,\n    name: '',\n  };\n\n  if (anchorPoint) {\n    newElementOptions.placement = { ...newElementOptions.placement, top: anchorPoint.y, left: anchorPoint.x };\n  }\n\n  if (newItem.defaultSize) {\n    newElementOptions.placement = { ...newElementOptions.placement, ...newItem.defaultSize };\n  }\n\n  if (rootLayer) {\n    const newElement = new ElementState(newItem, newElementOptions, rootLayer);\n    newElement.updateData(rootLayer.scene.context);\n    rootLayer.elements.push(newElement);\n    rootLayer.scene.save();\n    rootLayer.reinitializeMoveable();\n\n    setTimeout(() => doSelect(rootLayer.scene, newElement));\n  }\n}\n\nexport function isConnectionSource(element: ElementState) {\n  return element.options.connections && element.options.connections.length > 0;\n}\n\nexport function isConnectionTarget(element: ElementState, sceneByName: Map<string, ElementState>) {\n  const connections = getConnections(sceneByName);\n  return connections.some((connection) => connection.target === element);\n}\n\nexport function getConnections(sceneByName: Map<string, ElementState>) {\n  const connections: ConnectionState[] = [];\n  for (let v of sceneByName.values()) {\n    if (v.options.connections) {\n      v.options.connections.forEach((c, index) => {\n        // @TODO Remove after v10.x\n        if (isString(c.color)) {\n          c.color = { fixed: c.color };\n        }\n\n        if (isNumber(c.size)) {\n          c.size = { fixed: 2, min: 1, max: 10 };\n        }\n\n        const target = c.targetName ? sceneByName.get(c.targetName) : v.parent;\n        if (target) {\n          connections.push({\n            index,\n            source: v,\n            target,\n            info: c,\n            vertices: c.vertices ?? undefined,\n            sourceOriginal: c.sourceOriginal ?? undefined,\n            targetOriginal: c.targetOriginal ?? undefined,\n          });\n        }\n      });\n    }\n  }\n\n  return connections;\n}\n\nexport function getConnectionsByTarget(element: ElementState, scene: Scene) {\n  return scene.connections.state.filter((connection) => connection.target === element);\n}\n\nexport function updateConnectionsForSource(element: ElementState, scene: Scene) {\n  const targetConnections = getConnectionsByTarget(element, scene);\n  targetConnections.forEach((connection) => {\n    const sourceConnections = connection.source.options.connections?.splice(0) ?? [];\n    const connections = sourceConnections.filter((con) => con.targetName !== element.getName());\n    connection.source.onChange({ ...connection.source.options, connections });\n  });\n\n  // Update scene connection state to clear out old connections\n  scene.connections.updateState();\n}\n\nexport const calculateCoordinates = (\n  sourceRect: DOMRect,\n  parentRect: DOMRect,\n  info: CanvasConnection,\n  target: ElementState,\n  transformScale: number\n) => {\n  const sourceHorizontalCenter = sourceRect.left - parentRect.left + sourceRect.width / 2;\n  const sourceVerticalCenter = sourceRect.top - parentRect.top + sourceRect.height / 2;\n\n  // Convert from connection coords to DOM coords\n  const x1 = (sourceHorizontalCenter + (info.source.x * sourceRect.width) / 2) / transformScale;\n  const y1 = (sourceVerticalCenter - (info.source.y * sourceRect.height) / 2) / transformScale;\n\n  let x2: number;\n  let y2: number;\n  const targetRect = target.div?.getBoundingClientRect();\n  if (info.targetName && targetRect) {\n    const targetHorizontalCenter = targetRect.left - parentRect.left + targetRect.width / 2;\n    const targetVerticalCenter = targetRect.top - parentRect.top + targetRect.height / 2;\n\n    x2 = targetHorizontalCenter + (info.target.x * targetRect.width) / 2;\n    y2 = targetVerticalCenter - (info.target.y * targetRect.height) / 2;\n  } else {\n    const parentHorizontalCenter = parentRect.width / 2;\n    const parentVerticalCenter = parentRect.height / 2;\n\n    x2 = parentHorizontalCenter + (info.target.x * parentRect.width) / 2;\n    y2 = parentVerticalCenter - (info.target.y * parentRect.height) / 2;\n  }\n  x2 /= transformScale;\n  y2 /= transformScale;\n\n  // TODO look into a better way to avoid division by zero\n  if (x2 - x1 === 0) {\n    x2 += 1;\n  }\n  if (y2 - y1 === 0) {\n    y2 += 1;\n  }\n  return { x1, y1, x2, y2 };\n};\n\nexport const calculateCoordinates2 = (source: ElementState, target: ElementState, info: CanvasConnection) => {\n  const { x: x1, y: y1 } = getRotatedConnectionPoint(source.div!, info.source.x, info.source.y);\n\n  let x2 = 0;\n  let y2 = 0;\n  const targetDiv = target.div;\n  if (info.targetName && targetDiv) {\n    ({ x: x2, y: y2 } = getRotatedConnectionPoint(targetDiv, info.target.x, info.target.y));\n  } else {\n    x2 = info.target.x;\n    y2 = info.target.y;\n  }\n\n  return { x1, y1, x2, y2 };\n};\n\nexport const getElementTransformAndDimensions = (element: Element) => {\n  const style = window.getComputedStyle(element);\n\n  const transform = style.transform;\n\n  let x = 0;\n  let y = 0;\n  let rotation = 0;\n\n  if (transform !== 'none') {\n    // Use DOMMatrix to parse the transform string\n    const matrix = new DOMMatrix(transform);\n\n    // Extract x and y values\n    x = matrix.m41;\n    y = matrix.m42;\n\n    // Extract rotation in radians and convert to degrees\n    // For 2D transforms, rotation = atan2(m21, m11)\n    rotation = -Math.atan2(matrix.m21, matrix.m11) * (180 / Math.PI);\n  }\n\n  // Get the width and height of the element\n  // TODO: there sould be a better way than parseFloat\n  const width = parseFloat(style.width);\n  const height = parseFloat(style.height);\n\n  return { left: x, top: y, width, height, x, y, rotation };\n};\n\nexport const getNormalizedRotatedOffset = (div: HTMLDivElement, x: number, y: number) => {\n  const { left, top, width, height, rotation } = getElementTransformAndDimensions(div);\n  // Calculate center of source element\n  const centerX = left + width / 2;\n  const centerY = top + height / 2;\n\n  // Calculate the offset from the center to the connection start point\n  let dx = x - centerX;\n  let dy = y - centerY;\n\n  // Adjust for rotation\n  const rad = rotation * (Math.PI / 180);\n  const cos = Math.cos(-rad);\n  const sin = Math.sin(-rad);\n  // Rotate the delta by the negative of the element's rotation\n  const rotatedDx = dx * cos - dy * sin;\n  const rotatedDy = dx * sin + dy * cos;\n\n  // Convert to normalized coordinates\n  const normalizedX = rotatedDx / (width / 2);\n  const normalizedY = -rotatedDy / (height / 2);\n\n  return { x: normalizedX, y: normalizedY };\n};\n\nexport const getRotatedConnectionPoint = (div: HTMLDivElement, normalizedX: number, normalizedY: number) => {\n  const { left, top, width, height, rotation } = getElementTransformAndDimensions(div);\n  const centerX = left + width / 2;\n  const centerY = top + height / 2;\n\n  // Calculate offset from center before rotation\n  const offsetX = (normalizedX * width) / 2;\n  const offsetY = -(normalizedY * height) / 2;\n\n  // Convert rotation to radians\n  const rad = rotation * (Math.PI / 180);\n  const cos = Math.cos(rad);\n  const sin = Math.sin(rad);\n  // Apply rotation to offset\n  const rotatedOffsetX = offsetX * cos - offsetY * sin;\n  const rotatedOffsetY = offsetX * sin + offsetY * cos;\n\n  const x = centerX + rotatedOffsetX;\n  const y = centerY + rotatedOffsetY;\n\n  return { x, y };\n};\n\nexport const calculateMidpoint = (x1: number, y1: number, x2: number, y2: number) => {\n  return { x: (x1 + x2) / 2, y: (y1 + y2) / 2 };\n};\n\nexport const calculateAbsoluteCoords = (\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  valueX: number,\n  valueY: number,\n  deltaX: number,\n  deltaY: number\n) => {\n  return { x: valueX * deltaX + x1, y: valueY * deltaY + y1 };\n};\n\n// Calculate angle between two points and return angle in radians\nexport const calculateAngle = (x1: number, y1: number, x2: number, y2: number) => {\n  return Math.atan2(y2 - y1, x2 - x1);\n};\n\nexport const calculateDistance = (x1: number, y1: number, x2: number, y2: number) => {\n  //TODO add sqrt approx option\n  return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);\n};\n\n// @TODO revisit, currently returning last row index for field\nexport const getRowIndex = (fieldName: string | undefined, scene: Scene) => {\n  if (fieldName) {\n    const series = scene.data?.series[0];\n    const field = series?.fields.find((field) => field.name === fieldName);\n    const data = field?.values;\n    return data ? data.length - 1 : 0;\n  }\n  return 0;\n};\n\nexport const getConnectionStyles = (\n  info: CanvasConnection,\n  scene: Scene,\n  defaultArrowSize: number,\n  defaultArrowDirection: ConnectionDirection\n) => {\n  const defaultArrowColor = config.theme2.colors.text.primary;\n  const lastRowIndex = getRowIndex(info.size?.field, scene);\n  const strokeColor = info.color ? scene.context.getColor(info.color).value() : defaultArrowColor;\n  const strokeWidth = info.size ? scene.context.getScale(info.size).get(lastRowIndex) : defaultArrowSize;\n  const strokeRadius = info.radius ? scene.context.getScale(info.radius).get(lastRowIndex) : 0;\n  const arrowDirection = info.direction\n    ? scene.context.getDirection(info.direction).get(lastRowIndex)\n    : defaultArrowDirection;\n  const lineStyle = getLineStyle(info.lineStyle?.style);\n  const shouldAnimate = info.lineStyle?.animate;\n\n  return { strokeColor, strokeWidth, strokeRadius, arrowDirection, lineStyle, shouldAnimate };\n};\n\nconst getLineStyle = (lineStyle?: LineStyle) => {\n  switch (lineStyle) {\n    case LineStyle.Dashed:\n      return StrokeDasharray.Dashed;\n    case LineStyle.Dotted:\n      return StrokeDasharray.Dotted;\n    default:\n      return StrokeDasharray.Solid;\n  }\n};\n\nexport const getParentBoundingClientRect = (scene: Scene) => {\n  if (config.featureToggles.canvasPanelPanZoom) {\n    return scene.viewportDiv?.getBoundingClientRect();\n  }\n\n  return scene.div?.getBoundingClientRect();\n};\n\nexport function getElementFields(frames: DataFrame[], opts: CanvasElementOptions) {\n  const fields = new Set<Field>();\n  const cfg = opts.config ?? {};\n\n  frames.forEach((frame) => {\n    frame.fields.forEach((field) => {\n      const name = getFieldDisplayName(field, frame, frames);\n\n      // (intentional fall-through)\n      switch (name) {\n        // General element config\n        case opts.background?.color?.field:\n        case opts.background?.image?.field:\n        case opts.border?.color?.field:\n        // Text config\n        case cfg.text?.field:\n        case cfg.color?.field:\n        // Icon config\n        case cfg.path?.field:\n        case cfg.fill?.field:\n        // Server config\n        case cfg.blinkRate?.field:\n        case cfg.statusColor?.field:\n        case cfg.bulbColor?.field:\n        // Wind turbine config (maybe remove / not support this?)\n        case cfg.rpm?.field:\n          fields.add(field);\n      }\n    });\n  });\n\n  return [...fields];\n}\n\nexport function applyStyles(styles: React.CSSProperties, target: HTMLDivElement) {\n  // INFO: CSSProperties can't be applied using setProperty, so we use Object.assign\n  Object.assign(target.style, styles);\n}\n\nexport function removeStyles(styles: React.CSSProperties, target: HTMLDivElement) {\n  for (const key in styles) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n    target.style[key as any] = '';\n  }\n}\n","/*\nCopyright (c) 2018 Daybrush\n@name: @daybrush/utils\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/utils\n@version 1.13.0\n*/\n/**\n* @namespace\n* @name Consts\n*/\n/**\n* get string \"rgb\"\n* @memberof Color\n* @example\nimport {RGB} from \"@daybrush/utils\";\n\nconsole.log(RGB); // \"rgb\"\n*/\nvar RGB = \"rgb\";\n/**\n* get string \"rgba\"\n* @memberof Color\n* @example\nimport {RGBA} from \"@daybrush/utils\";\n\nconsole.log(RGBA); // \"rgba\"\n*/\nvar RGBA = \"rgba\";\n/**\n* get string \"hsl\"\n* @memberof Color\n* @example\nimport {HSL} from \"@daybrush/utils\";\n\nconsole.log(HSL); // \"hsl\"\n*/\nvar HSL = \"hsl\";\n/**\n* get string \"hsla\"\n* @memberof Color\n* @example\nimport {HSLA} from \"@daybrush/utils\";\n\nconsole.log(HSLA); // \"hsla\"\n*/\nvar HSLA = \"hsla\";\n/**\n* gets an array of color models.\n* @memberof Color\n* @example\nimport {COLOR_MODELS} from \"@daybrush/utils\";\n\nconsole.log(COLOR_MODELS); // [\"rgb\", \"rgba\", \"hsl\", \"hsla\"];\n*/\nvar COLOR_MODELS = [RGB, RGBA, HSL, HSLA];\n/**\n* get string \"function\"\n* @memberof Consts\n* @example\nimport {FUNCTION} from \"@daybrush/utils\";\n\nconsole.log(FUNCTION); // \"function\"\n*/\nvar FUNCTION = \"function\";\n/**\n* get string \"property\"\n* @memberof Consts\n* @example\nimport {PROPERTY} from \"@daybrush/utils\";\n\nconsole.log(PROPERTY); // \"property\"\n*/\nvar PROPERTY = \"property\";\n/**\n* get string \"array\"\n* @memberof Consts\n* @example\nimport {ARRAY} from \"@daybrush/utils\";\n\nconsole.log(ARRAY); // \"array\"\n*/\nvar ARRAY = \"array\";\n/**\n* get string \"object\"\n* @memberof Consts\n* @example\nimport {OBJECT} from \"@daybrush/utils\";\n\nconsole.log(OBJECT); // \"object\"\n*/\nvar OBJECT = \"object\";\n/**\n* get string \"string\"\n* @memberof Consts\n* @example\nimport {STRING} from \"@daybrush/utils\";\n\nconsole.log(STRING); // \"string\"\n*/\nvar STRING = \"string\";\n/**\n* get string \"number\"\n* @memberof Consts\n* @example\nimport {NUMBER} from \"@daybrush/utils\";\n\nconsole.log(NUMBER); // \"number\"\n*/\nvar NUMBER = \"number\";\n/**\n* get string \"undefined\"\n* @memberof Consts\n* @example\nimport {UNDEFINED} from \"@daybrush/utils\";\n\nconsole.log(UNDEFINED); // \"undefined\"\n*/\nvar UNDEFINED = \"undefined\";\n/**\n* Check whether the environment is window or node.js.\n* @memberof Consts\n* @example\nimport {IS_WINDOW} from \"@daybrush/utils\";\n\nconsole.log(IS_WINDOW); // false in node.js\nconsole.log(IS_WINDOW); // true in browser\n*/\nvar IS_WINDOW = typeof window !== UNDEFINED;\n/**\n* Check whether the environment is window or node.js.\n* @memberof Consts\n* @name document\n* @example\nimport {IS_WINDOW} from \"@daybrush/utils\";\n\nconsole.log(IS_WINDOW); // false in node.js\nconsole.log(IS_WINDOW); // true in browser\n*/\nvar doc = typeof document !== UNDEFINED && document; // FIXME: this type maybe false\nvar prefixes = [\"webkit\", \"ms\", \"moz\", \"o\"];\n/**\n * @namespace CrossBrowser\n */\n/**\n* Get a CSS property with a vendor prefix that supports cross browser.\n* @function\n* @param {string} property - A CSS property\n* @return {string} CSS property with cross-browser vendor prefix\n* @memberof CrossBrowser\n* @example\nimport {getCrossBrowserProperty} from \"@daybrush/utils\";\n\nconsole.log(getCrossBrowserProperty(\"transform\")); // \"transform\", \"-ms-transform\", \"-webkit-transform\"\nconsole.log(getCrossBrowserProperty(\"filter\")); // \"filter\", \"-webkit-filter\"\n*/\nvar getCrossBrowserProperty = /*#__PURE__*/function (property) {\n  if (!doc) {\n    return \"\";\n  }\n  var styles = (doc.body || doc.documentElement).style;\n  var length = prefixes.length;\n  if (typeof styles[property] !== UNDEFINED) {\n    return property;\n  }\n  for (var i = 0; i < length; ++i) {\n    var name = \"-\" + prefixes[i] + \"-\" + property;\n    if (typeof styles[name] !== UNDEFINED) {\n      return name;\n    }\n  }\n  return \"\";\n};\n/**\n* get string \"transfrom\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {TRANSFORM} from \"@daybrush/utils\";\n\nconsole.log(TRANSFORM); // \"transform\", \"-ms-transform\", \"-webkit-transform\"\n*/\nvar TRANSFORM = /*#__PURE__*/getCrossBrowserProperty(\"transform\");\n/**\n* get string \"filter\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {FILTER} from \"@daybrush/utils\";\n\nconsole.log(FILTER); // \"filter\", \"-ms-filter\", \"-webkit-filter\"\n*/\nvar FILTER = /*#__PURE__*/getCrossBrowserProperty(\"filter\");\n/**\n* get string \"animation\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {ANIMATION} from \"@daybrush/utils\";\n\nconsole.log(ANIMATION); // \"animation\", \"-ms-animation\", \"-webkit-animation\"\n*/\nvar ANIMATION = /*#__PURE__*/getCrossBrowserProperty(\"animation\");\n/**\n* get string \"keyframes\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {KEYFRAMES} from \"@daybrush/utils\";\n\nconsole.log(KEYFRAMES); // \"keyframes\", \"-ms-keyframes\", \"-webkit-keyframes\"\n*/\nvar KEYFRAMES = /*#__PURE__*/ANIMATION.replace(\"animation\", \"keyframes\");\nvar OPEN_CLOSED_CHARACTERS = [{\n  open: \"(\",\n  close: \")\"\n}, {\n  open: \"\\\"\",\n  close: \"\\\"\"\n}, {\n  open: \"'\",\n  close: \"'\"\n}, {\n  open: \"\\\\\\\"\",\n  close: \"\\\\\\\"\"\n}, {\n  open: \"\\\\'\",\n  close: \"\\\\'\"\n}];\nvar TINY_NUM = 0.0000001;\nvar REVERSE_TINY_NUM = 1 / TINY_NUM;\nvar DEFAULT_UNIT_PRESETS = {\n  \"cm\": function (pos) {\n    return pos * 96 / 2.54;\n  },\n  \"mm\": function (pos) {\n    return pos * 96 / 254;\n  },\n  \"in\": function (pos) {\n    return pos * 96;\n  },\n  \"pt\": function (pos) {\n    return pos * 96 / 72;\n  },\n  \"pc\": function (pos) {\n    return pos * 96 / 6;\n  },\n  \"%\": function (pos, size) {\n    return pos * size / 100;\n  },\n  \"vw\": function (pos, size) {\n    if (size === void 0) {\n      size = window.innerWidth;\n    }\n    return pos / 100 * size;\n  },\n  \"vh\": function (pos, size) {\n    if (size === void 0) {\n      size = window.innerHeight;\n    }\n    return pos / 100 * size;\n  },\n  \"vmax\": function (pos, size) {\n    if (size === void 0) {\n      size = Math.max(window.innerWidth, window.innerHeight);\n    }\n    return pos / 100 * size;\n  },\n  \"vmin\": function (pos, size) {\n    if (size === void 0) {\n      size = Math.min(window.innerWidth, window.innerHeight);\n    }\n    return pos / 100 * size;\n  }\n};\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n  return r;\n}\n\n/**\n* @namespace\n* @name Utils\n*/\n/**\n * Returns the inner product of two numbers(`a1`, `a2`) by two criteria(`b1`, `b2`).\n * @memberof Utils\n * @param - The first number\n * @param - The second number\n * @param - The first number to base on the inner product\n * @param - The second number to base on the inner product\n * @return - Returns the inner product\nimport { dot } from \"@daybrush/utils\";\n\nconsole.log(dot(0, 15, 2, 3)); // 6\nconsole.log(dot(5, 15, 2, 3)); // 9\nconsole.log(dot(5, 15, 1, 1)); // 10\n */\nfunction dot(a1, a2, b1, b2) {\n  return (a1 * b2 + a2 * b1) / (b1 + b2);\n}\n/**\n* Check the type that the value is undefined.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {boolean} true if the type is correct, false otherwise\n* @example\nimport {isUndefined} from \"@daybrush/utils\";\n\nconsole.log(isUndefined(undefined)); // true\nconsole.log(isUndefined(\"\")); // false\nconsole.log(isUndefined(1)); // false\nconsole.log(isUndefined(null)); // false\n*/\nfunction isUndefined(value) {\n  return typeof value === UNDEFINED;\n}\n/**\n* Check the type that the value is object.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isObject} from \"@daybrush/utils\";\n\nconsole.log(isObject({})); // true\nconsole.log(isObject(undefined)); // false\nconsole.log(isObject(\"\")); // false\nconsole.log(isObject(null)); // false\n*/\nfunction isObject(value) {\n  return value && typeof value === OBJECT;\n}\n/**\n* Check the type that the value is isArray.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isArray} from \"@daybrush/utils\";\n\nconsole.log(isArray([])); // true\nconsole.log(isArray({})); // false\nconsole.log(isArray(undefined)); // false\nconsole.log(isArray(null)); // false\n*/\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n/**\n* Check the type that the value is string.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isString} from \"@daybrush/utils\";\n\nconsole.log(isString(\"1234\")); // true\nconsole.log(isString(undefined)); // false\nconsole.log(isString(1)); // false\nconsole.log(isString(null)); // false\n*/\nfunction isString(value) {\n  return typeof value === STRING;\n}\nfunction isNumber(value) {\n  return typeof value === NUMBER;\n}\n/**\n* Check the type that the value is function.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isFunction} from \"@daybrush/utils\";\n\nconsole.log(isFunction(function a() {})); // true\nconsole.log(isFunction(() => {})); // true\nconsole.log(isFunction(\"1234\")); // false\nconsole.log(isFunction(1)); // false\nconsole.log(isFunction(null)); // false\n*/\nfunction isFunction(value) {\n  return typeof value === FUNCTION;\n}\nfunction isEqualSeparator(character, separator) {\n  var isCharacterSpace = character === \"\" || character == \" \";\n  var isSeparatorSpace = separator === \"\" || separator == \" \";\n  return isSeparatorSpace && isCharacterSpace || character === separator;\n}\nfunction findOpen(openCharacter, texts, index, length, openCloseCharacters) {\n  var isIgnore = findIgnore(openCharacter, texts, index);\n  if (!isIgnore) {\n    return findClose(openCharacter, texts, index + 1, length, openCloseCharacters);\n  }\n  return index;\n}\nfunction findIgnore(character, texts, index) {\n  if (!character.ignore) {\n    return null;\n  }\n  var otherText = texts.slice(Math.max(index - 3, 0), index + 3).join(\"\");\n  return new RegExp(character.ignore).exec(otherText);\n}\nfunction findClose(closeCharacter, texts, index, length, openCloseCharacters) {\n  var _loop_1 = function (i) {\n    var character = texts[i].trim();\n    if (character === closeCharacter.close && !findIgnore(closeCharacter, texts, i)) {\n      return {\n        value: i\n      };\n    }\n    var nextIndex = i;\n    // re open\n    var openCharacter = find(openCloseCharacters, function (_a) {\n      var open = _a.open;\n      return open === character;\n    });\n    if (openCharacter) {\n      nextIndex = findOpen(openCharacter, texts, i, length, openCloseCharacters);\n    }\n    if (nextIndex === -1) {\n      return out_i_1 = i, \"break\";\n    }\n    i = nextIndex;\n    out_i_1 = i;\n  };\n  var out_i_1;\n  for (var i = index; i < length; ++i) {\n    var state_1 = _loop_1(i);\n    i = out_i_1;\n    if (typeof state_1 === \"object\") return state_1.value;\n    if (state_1 === \"break\") break;\n  }\n  return -1;\n}\nfunction splitText(text, splitOptions) {\n  var _a = isString(splitOptions) ? {\n      separator: splitOptions\n    } : splitOptions,\n    _b = _a.separator,\n    separator = _b === void 0 ? \",\" : _b,\n    isSeparateFirst = _a.isSeparateFirst,\n    isSeparateOnlyOpenClose = _a.isSeparateOnlyOpenClose,\n    _c = _a.isSeparateOpenClose,\n    isSeparateOpenClose = _c === void 0 ? isSeparateOnlyOpenClose : _c,\n    _d = _a.openCloseCharacters,\n    openCloseCharacters = _d === void 0 ? OPEN_CLOSED_CHARACTERS : _d;\n  var openClosedText = openCloseCharacters.map(function (_a) {\n    var open = _a.open,\n      close = _a.close;\n    if (open === close) {\n      return open;\n    }\n    return open + \"|\" + close;\n  }).join(\"|\");\n  var regexText = \"(\\\\s*\" + separator + \"\\\\s*|\" + openClosedText + \"|\\\\s+)\";\n  var regex = new RegExp(regexText, \"g\");\n  var texts = text.split(regex).filter(function (chr) {\n    return chr && chr !== \"undefined\";\n  });\n  var length = texts.length;\n  var values = [];\n  var tempValues = [];\n  function resetTemp() {\n    if (tempValues.length) {\n      values.push(tempValues.join(\"\"));\n      tempValues = [];\n      return true;\n    }\n    return false;\n  }\n  var _loop_2 = function (i) {\n    var character = texts[i].trim();\n    var nextIndex = i;\n    var openCharacter = find(openCloseCharacters, function (_a) {\n      var open = _a.open;\n      return open === character;\n    });\n    var closeCharacter = find(openCloseCharacters, function (_a) {\n      var close = _a.close;\n      return close === character;\n    });\n    if (openCharacter) {\n      nextIndex = findOpen(openCharacter, texts, i, length, openCloseCharacters);\n      if (nextIndex !== -1 && isSeparateOpenClose) {\n        if (resetTemp() && isSeparateFirst) {\n          return out_i_2 = i, \"break\";\n        }\n        values.push(texts.slice(i, nextIndex + 1).join(\"\"));\n        i = nextIndex;\n        if (isSeparateFirst) {\n          return out_i_2 = i, \"break\";\n        }\n        return out_i_2 = i, \"continue\";\n      }\n    } else if (closeCharacter && !findIgnore(closeCharacter, texts, i)) {\n      var nextOpenCloseCharacters = __spreadArrays(openCloseCharacters);\n      nextOpenCloseCharacters.splice(openCloseCharacters.indexOf(closeCharacter), 1);\n      return {\n        value: splitText(text, {\n          separator: separator,\n          isSeparateFirst: isSeparateFirst,\n          isSeparateOnlyOpenClose: isSeparateOnlyOpenClose,\n          isSeparateOpenClose: isSeparateOpenClose,\n          openCloseCharacters: nextOpenCloseCharacters\n        })\n      };\n    } else if (isEqualSeparator(character, separator) && !isSeparateOnlyOpenClose) {\n      resetTemp();\n      if (isSeparateFirst) {\n        return out_i_2 = i, \"break\";\n      }\n      return out_i_2 = i, \"continue\";\n    }\n    if (nextIndex === -1) {\n      nextIndex = length - 1;\n    }\n    tempValues.push(texts.slice(i, nextIndex + 1).join(\"\"));\n    i = nextIndex;\n    out_i_2 = i;\n  };\n  var out_i_2;\n  for (var i = 0; i < length; ++i) {\n    var state_2 = _loop_2(i);\n    i = out_i_2;\n    if (typeof state_2 === \"object\") return state_2.value;\n    if (state_2 === \"break\") break;\n  }\n  if (tempValues.length) {\n    values.push(tempValues.join(\"\"));\n  }\n  return values;\n}\n/**\n* divide text by space.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {Array} divided texts\n* @example\nimport {spliceSpace} from \"@daybrush/utils\";\n\nconsole.log(splitSpace(\"a b c d e f g\"));\n// [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"]\nconsole.log(splitSpace(\"'a,b' c 'd,e' f g\"));\n// [\"'a,b'\", \"c\", \"'d,e'\", \"f\", \"g\"]\n*/\nfunction splitSpace(text) {\n  // divide comma(space)\n  return splitText(text, \"\");\n}\n/**\n* divide text by comma.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {Array} divided texts\n* @example\nimport {splitComma} from \"@daybrush/utils\";\n\nconsole.log(splitComma(\"a,b,c,d,e,f,g\"));\n// [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"]\nconsole.log(splitComma(\"'a,b',c,'d,e',f,g\"));\n// [\"'a,b'\", \"c\", \"'d,e'\", \"f\", \"g\"]\n*/\nfunction splitComma(text) {\n  // divide comma(,)\n  // \"[^\"]*\"|'[^']*'\n  return splitText(text, \",\");\n}\n/**\n* divide text by bracket \"(\", \")\".\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {object} divided texts\n* @example\nimport {splitBracket} from \"@daybrush/utils\";\n\nconsole.log(splitBracket(\"a(1, 2)\"));\n// {prefix: \"a\", value: \"1, 2\", suffix: \"\"}\nconsole.log(splitBracket(\"a(1, 2)b\"));\n// {prefix: \"a\", value: \"1, 2\", suffix: \"b\"}\n*/\nfunction splitBracket(text) {\n  var matches = /([^(]*)\\(([\\s\\S]*)\\)([\\s\\S]*)/g.exec(text);\n  if (!matches || matches.length < 4) {\n    return {};\n  } else {\n    return {\n      prefix: matches[1],\n      value: matches[2],\n      suffix: matches[3]\n    };\n  }\n}\n/**\n* divide text by number and unit.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {} divided texts\n* @example\nimport {splitUnit} from \"@daybrush/utils\";\n\nconsole.log(splitUnit(\"10px\"));\n// {prefix: \"\", value: 10, unit: \"px\"}\nconsole.log(splitUnit(\"-10px\"));\n// {prefix: \"\", value: -10, unit: \"px\"}\nconsole.log(splitUnit(\"a10%\"));\n// {prefix: \"a\", value: 10, unit: \"%\"}\n*/\nfunction splitUnit(text) {\n  var matches = /^([^\\d|e|\\-|\\+]*)((?:\\d|\\.|-|e-|e\\+)+)(\\S*)$/g.exec(text);\n  if (!matches) {\n    return {\n      prefix: \"\",\n      unit: \"\",\n      value: NaN\n    };\n  }\n  var prefix = matches[1];\n  var value = matches[2];\n  var unit = matches[3];\n  return {\n    prefix: prefix,\n    unit: unit,\n    value: parseFloat(value)\n  };\n}\n/**\n* transform strings to camel-case\n* @memberof Utils\n* @param {String} text - string\n* @return {String} camel-case string\n* @example\nimport {camelize} from \"@daybrush/utils\";\n\nconsole.log(camelize(\"transform-origin\")); // transformOrigin\nconsole.log(camelize(\"abcd_efg\")); // abcdEfg\nconsole.log(camelize(\"abcd efg\")); // abcdEfg\n*/\nfunction camelize(str) {\n  return str.replace(/[\\s-_]+([^\\s-_])/g, function (all, letter) {\n    return letter.toUpperCase();\n  });\n}\n/**\n* transform a camelized string into a lowercased string.\n* @memberof Utils\n* @param {string} text - a camel-cased string\n* @param {string} [separator=\"-\"] - a separator\n* @return {string}  a lowercased string\n* @example\nimport {decamelize} from \"@daybrush/utils\";\n\nconsole.log(decamelize(\"transformOrigin\")); // transform-origin\nconsole.log(decamelize(\"abcdEfg\", \"_\")); // abcd_efg\n*/\nfunction decamelize(str, separator) {\n  if (separator === void 0) {\n    separator = \"-\";\n  }\n  return str.replace(/([a-z])([A-Z])/g, function (all, letter, letter2) {\n    return \"\" + letter + separator + letter2.toLowerCase();\n  });\n}\n/**\n* transforms something in an array into an array.\n* @memberof Utils\n* @param - Array form\n* @return an array\n* @example\nimport {toArray} from \"@daybrush/utils\";\n\nconst arr1 = toArray(document.querySelectorAll(\".a\")); // Element[]\nconst arr2 = toArray(document.querySelectorAll<HTMLElement>(\".a\")); // HTMLElement[]\n*/\nfunction toArray(value) {\n  return [].slice.call(value);\n}\n/**\n* Date.now() method\n* @memberof CrossBrowser\n* @return {number} milliseconds\n* @example\nimport {now} from \"@daybrush/utils\";\n\nconsole.log(now()); // 12121324241(milliseconds)\n*/\nfunction now() {\n  return Date.now ? Date.now() : new Date().getTime();\n}\n/**\n* Returns the index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findIndex } from \"@daybrush/utils\";\n\nfindIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\nfunction findIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n  var length = arr.length;\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n  return defaultIndex;\n}\n/**\n* Returns the reverse direction index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findLastIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findLastIndex } from \"@daybrush/utils\";\n\nfindLastIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\nfunction findLastIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n  var length = arr.length;\n  for (var i = length - 1; i >= 0; --i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n  return defaultIndex;\n}\n/**\n* Returns the value of the reverse direction element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findLast` was called upon.\n* @param - A function to execute on each value in the array,\n* @param - Returns defalutValue if not found by the function.\n* @example\nimport { find } from \"@daybrush/utils\";\n\nfind([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // {a: 2}\n*/\nfunction findLast(arr, callback, defalutValue) {\n  var index = findLastIndex(arr, callback);\n  return index > -1 ? arr[index] : defalutValue;\n}\n/**\n* Returns the value of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `find` was called upon.\n* @param - A function to execute on each value in the array,\n* @param - Returns defalutValue if not found by the function.\n* @example\nimport { find } from \"@daybrush/utils\";\n\nfind([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // {a: 2}\n*/\nfunction find(arr, callback, defalutValue) {\n  var index = findIndex(arr, callback);\n  return index > -1 ? arr[index] : defalutValue;\n}\n/**\n* window.requestAnimationFrame() method with cross browser.\n* @function\n* @memberof CrossBrowser\n* @param {FrameRequestCallback} callback - The function to call when it's time to update your animation for the next repaint.\n* @return {number} id\n* @example\nimport {requestAnimationFrame} from \"@daybrush/utils\";\n\nrequestAnimationFrame((timestamp) => {\n  console.log(timestamp);\n});\n*/\nvar requestAnimationFrame = /*#__PURE__*/function () {\n  var firstTime = now();\n  var raf = IS_WINDOW && (window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame);\n  return raf ? raf.bind(window) : function (callback) {\n    var currTime = now();\n    var id = setTimeout(function () {\n      callback(currTime - firstTime);\n    }, 1000 / 60);\n    return id;\n  };\n}();\n/**\n* window.cancelAnimationFrame() method with cross browser.\n* @function\n* @memberof CrossBrowser\n* @param {number} handle - the id obtained through requestAnimationFrame method\n* @return {void}\n* @example\nimport { requestAnimationFrame, cancelAnimationFrame } from \"@daybrush/utils\";\n\nconst id = requestAnimationFrame((timestamp) => {\n  console.log(timestamp);\n});\n\ncancelAnimationFrame(id);\n*/\nvar cancelAnimationFrame = /*#__PURE__*/function () {\n  var caf = IS_WINDOW && (window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.msCancelAnimationFrame);\n  return caf ? caf.bind(window) : function (handle) {\n    clearTimeout(handle);\n  };\n}();\n/**\n* @function\n* @memberof Utils\n*/\nfunction getKeys(obj) {\n  return Object.keys(obj);\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction getValues(obj) {\n  var keys = getKeys(obj);\n  return keys.map(function (key) {\n    return obj[key];\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction getEntries(obj) {\n  var keys = getKeys(obj);\n  return keys.map(function (key) {\n    return [key, obj[key]];\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction sortOrders(keys, orders) {\n  if (orders === void 0) {\n    orders = [];\n  }\n  keys.sort(function (a, b) {\n    var index1 = orders.indexOf(a);\n    var index2 = orders.indexOf(b);\n    if (index2 === -1 && index1 === -1) {\n      return 0;\n    }\n    if (index1 === -1) {\n      return 1;\n    }\n    if (index2 === -1) {\n      return -1;\n    }\n    return index1 - index2;\n  });\n}\n/**\n* convert unit size to px size\n* @function\n* @memberof Utils\n*/\nfunction convertUnitSize(pos, size) {\n  var _a = splitUnit(pos),\n    value = _a.value,\n    unit = _a.unit;\n  if (isObject(size)) {\n    var sizeFunction = size[unit];\n    if (sizeFunction) {\n      if (isFunction(sizeFunction)) {\n        return sizeFunction(value);\n      } else if (DEFAULT_UNIT_PRESETS[unit]) {\n        return DEFAULT_UNIT_PRESETS[unit](value, sizeFunction);\n      }\n    }\n  } else if (unit === \"%\") {\n    return value * size / 100;\n  }\n  if (DEFAULT_UNIT_PRESETS[unit]) {\n    return DEFAULT_UNIT_PRESETS[unit](value);\n  }\n  return value;\n}\n/**\n* calculate between min, max\n* @function\n* @memberof Utils\n*/\nfunction between(value, min, max) {\n  return Math.max(min, Math.min(value, max));\n}\nfunction checkBoundSize(targetSize, compareSize, isMax, ratio) {\n  if (ratio === void 0) {\n    ratio = targetSize[0] / targetSize[1];\n  }\n  return [[throttle(compareSize[0], TINY_NUM), throttle(compareSize[0] / ratio, TINY_NUM)], [throttle(compareSize[1] * ratio, TINY_NUM), throttle(compareSize[1], TINY_NUM)]].filter(function (size) {\n    return size.every(function (value, i) {\n      var defaultSize = compareSize[i];\n      var throttledSize = throttle(defaultSize, TINY_NUM);\n      return isMax ? value <= defaultSize || value <= throttledSize : value >= defaultSize || value >= throttledSize;\n    });\n  })[0] || targetSize;\n}\n/**\n* calculate bound size\n* @function\n* @memberof Utils\n*/\nfunction calculateBoundSize(size, minSize, maxSize, keepRatio) {\n  if (!keepRatio) {\n    return size.map(function (value, i) {\n      return between(value, minSize[i], maxSize[i]);\n    });\n  }\n  var width = size[0],\n    height = size[1];\n  var ratio = keepRatio === true ? width / height : keepRatio;\n  // width : height = minWidth : minHeight;\n  var _a = checkBoundSize(size, minSize, false, ratio),\n    minWidth = _a[0],\n    minHeight = _a[1];\n  var _b = checkBoundSize(size, maxSize, true, ratio),\n    maxWidth = _b[0],\n    maxHeight = _b[1];\n  if (width < minWidth || height < minHeight) {\n    width = minWidth;\n    height = minHeight;\n  } else if (width > maxWidth || height > maxHeight) {\n    width = maxWidth;\n    height = maxHeight;\n  }\n  return [width, height];\n}\n/**\n* Add all the numbers.\n* @function\n* @memberof Utils\n*/\nfunction sum(nums) {\n  var length = nums.length;\n  var total = 0;\n  for (var i = length - 1; i >= 0; --i) {\n    total += nums[i];\n  }\n  return total;\n}\n/**\n* Average all numbers.\n* @function\n* @memberof Utils\n*/\nfunction average(nums) {\n  var length = nums.length;\n  var total = 0;\n  for (var i = length - 1; i >= 0; --i) {\n    total += nums[i];\n  }\n  return length ? total / length : 0;\n}\n/**\n* Get the angle of two points. (0 <= rad < 359)\n* @function\n* @memberof Utils\n*/\nfunction getRad(pos1, pos2) {\n  var distX = pos2[0] - pos1[0];\n  var distY = pos2[1] - pos1[1];\n  var rad = Math.atan2(distY, distX);\n  return rad >= 0 ? rad : rad + Math.PI * 2;\n}\n/**\n* Get the average point of all points.\n* @function\n* @memberof Utils\n*/\nfunction getCenterPoint(points) {\n  return [0, 1].map(function (i) {\n    return average(points.map(function (pos) {\n      return pos[i];\n    }));\n  });\n}\n/**\n* Gets the direction of the shape.\n* @function\n* @memberof Utils\n*/\nfunction getShapeDirection(points) {\n  var center = getCenterPoint(points);\n  var pos1Rad = getRad(center, points[0]);\n  var pos2Rad = getRad(center, points[1]);\n  return pos1Rad < pos2Rad && pos2Rad - pos1Rad < Math.PI || pos1Rad > pos2Rad && pos2Rad - pos1Rad < -Math.PI ? 1 : -1;\n}\n/**\n* Get the distance between two points.\n* @function\n* @memberof Utils\n*/\nfunction getDist(a, b) {\n  return Math.sqrt(Math.pow((b ? b[0] : 0) - a[0], 2) + Math.pow((b ? b[1] : 0) - a[1], 2));\n}\n/**\n* throttle number depending on the unit.\n* @function\n* @memberof Utils\n*/\nfunction throttle(num, unit) {\n  if (!unit) {\n    return num;\n  }\n  var reverseUnit = 1 / unit;\n  return Math.round(num / unit) / reverseUnit;\n}\n/**\n* throttle number array depending on the unit.\n* @function\n* @memberof Utils\n*/\nfunction throttleArray(nums, unit) {\n  nums.forEach(function (_, i) {\n    nums[i] = throttle(nums[i], unit);\n  });\n  return nums;\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction counter(num) {\n  var nums = [];\n  for (var i = 0; i < num; ++i) {\n    nums.push(i);\n  }\n  return nums;\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction replaceOnce(text, fromText, toText) {\n  var isOnce = false;\n  return text.replace(fromText, function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    if (isOnce) {\n      return args[0];\n    }\n    isOnce = true;\n    return isString(toText) ? toText : toText.apply(void 0, args);\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction flat(arr) {\n  return arr.reduce(function (prev, cur) {\n    return prev.concat(cur);\n  }, []);\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction deepFlat(arr) {\n  return arr.reduce(function (prev, cur) {\n    if (isArray(cur)) {\n      prev.push.apply(prev, deepFlat(cur));\n    } else {\n      prev.push(cur);\n    }\n    return prev;\n  }, []);\n}\n/**\n * @function\n * @memberof Utils\n */\nfunction pushSet(elements, element) {\n  if (elements.indexOf(element) === -1) {\n    elements.push(element);\n  }\n}\n\n/**\n* @namespace\n* @name Color\n*/\n/**\n* Remove the # from the hex color.\n* @memberof Color\n* @param {} hex - hex color\n* @return {} hex color\n* @example\nimport {cutHex} from \"@daybrush/utils\";\n\nconsole.log(cutHex(\"#000000\")) // \"000000\"\n*/\nfunction cutHex(hex) {\n  return hex.replace(\"#\", \"\");\n}\n/**\n* convert hex color to rgb color.\n* @memberof Color\n* @param {} hex - hex color\n* @return {} rgb color\n* @example\nimport {hexToRGBA} from \"@daybrush/utils\";\n\nconsole.log(hexToRGBA(\"#00000005\"));\n// [0, 0, 0, 1]\nconsole.log(hexToRGBA(\"#201045\"));\n// [32, 16, 69, 1]\n*/\nfunction hexToRGBA(hex) {\n  var h = cutHex(hex);\n  var r = parseInt(h.substring(0, 2), 16);\n  var g = parseInt(h.substring(2, 4), 16);\n  var b = parseInt(h.substring(4, 6), 16);\n  var a = parseInt(h.substring(6, 8), 16) / 255;\n  if (isNaN(a)) {\n    a = 1;\n  }\n  return [r, g, b, a];\n}\n/**\n* convert 3(or 4)-digit hex color to 6(or 8)-digit hex color.\n* @memberof Color\n* @param {} hex - 3(or 4)-digit hex color\n* @return {} 6(or 8)-digit hex color\n* @example\nimport {toFullHex} from \"@daybrush/utils\";\n\nconsole.log(toFullHex(\"#123\")); // \"#112233\"\nconsole.log(toFullHex(\"#123a\")); // \"#112233aa\"\n*/\nfunction toFullHex(h) {\n  var r = h.charAt(1);\n  var g = h.charAt(2);\n  var b = h.charAt(3);\n  var a = h.charAt(4);\n  var arr = [\"#\", r, r, g, g, b, b, a, a];\n  return arr.join(\"\");\n}\n/**\n* convert hsl color to rgba color.\n* @memberof Color\n* @param {} hsl - hsl color(hue: 0 ~ 360, saturation: 0 ~ 1, lightness: 0 ~ 1, alpha: 0 ~ 1)\n* @return {} rgba color\n* @example\nimport {hslToRGBA} from \"@daybrush/utils\";\n\nconsole.log(hslToRGBA([150, 0.5, 0.4]));\n// [51, 153, 102, 1]\n*/\nfunction hslToRGBA(hsl) {\n  var _a;\n  var h = hsl[0];\n  var s = hsl[1];\n  var l = hsl[2];\n  if (h < 0) {\n    h += Math.floor((Math.abs(h) + 360) / 360) * 360;\n  }\n  h %= 360;\n  var c = (1 - Math.abs(2 * l - 1)) * s;\n  var x = c * (1 - Math.abs(h / 60 % 2 - 1));\n  var m = l - c / 2;\n  var rgb;\n  if (h < 60) {\n    rgb = [c, x, 0];\n  } else if (h < 120) {\n    rgb = [x, c, 0];\n  } else if (h < 180) {\n    rgb = [0, c, x];\n  } else if (h < 240) {\n    rgb = [0, x, c];\n  } else if (h < 300) {\n    rgb = [x, 0, c];\n  } else if (h < 360) {\n    rgb = [c, 0, x];\n  } else {\n    rgb = [0, 0, 0];\n  }\n  return [Math.round((rgb[0] + m) * 255), Math.round((rgb[1] + m) * 255), Math.round((rgb[2] + m) * 255), (_a = hsl[3]) !== null && _a !== void 0 ? _a : 1];\n}\n/**\n* convert string to rgba color.\n* @memberof Color\n* @param {} - 3-hex(#000), 4-hex(#0000) 6-hex(#000000), 8-hex(#00000000) or RGB(A), or HSL(A)\n* @return {} rgba color\n* @example\nimport {stringToRGBA} from \"@daybrush/utils\";\n\nconsole.log(stringToRGBA(\"#000000\")); // [0, 0, 0, 1]\nconsole.log(stringToRGBA(\"rgb(100, 100, 100)\")); // [100, 100, 100, 1]\nconsole.log(stringToRGBA(\"hsl(150, 0.5, 0.4)\")); // [51, 153, 102, 1]\n*/\nfunction stringToRGBA(color) {\n  if (color.charAt(0) === \"#\") {\n    if (color.length === 4 || color.length === 5) {\n      return hexToRGBA(toFullHex(color));\n    } else {\n      return hexToRGBA(color);\n    }\n  } else if (color.indexOf(\"(\") !== -1) {\n    // in bracket.\n    var _a = splitBracket(color),\n      prefix = _a.prefix,\n      value = _a.value;\n    if (!prefix || !value) {\n      return undefined;\n    }\n    var arr = splitComma(value);\n    var colorArr = [0, 0, 0, 1];\n    var length = arr.length;\n    switch (prefix) {\n      case RGB:\n      case RGBA:\n        for (var i = 0; i < length; ++i) {\n          colorArr[i] = parseFloat(arr[i]);\n        }\n        return colorArr;\n      case HSL:\n      case HSLA:\n        for (var i = 0; i < length; ++i) {\n          if (arr[i].indexOf(\"%\") !== -1) {\n            colorArr[i] = parseFloat(arr[i]) / 100;\n          } else {\n            colorArr[i] = parseFloat(arr[i]);\n          }\n        }\n        // hsl, hsla to rgba\n        return hslToRGBA(colorArr);\n    }\n  }\n  return undefined;\n}\n\n/**\n * Returns all element descendants of node that\n * match selectors.\n */\n/**\n * Checks if the specified class value exists in the element's class attribute.\n * @memberof DOM\n * @param - A DOMString containing one or more selectors to match\n * @param - If multi is true, a DOMString containing one or more selectors to match against.\n * @example\nimport {$} from \"@daybrush/utils\";\n\nconsole.log($(\"div\")); // div element\nconsole.log($(\"div\", true)); // [div, div] elements\n*/\nfunction $(selectors, multi) {\n  if (!doc) {\n    return multi ? [] : null;\n  }\n  return multi ? doc.querySelectorAll(selectors) : doc.querySelector(selectors);\n}\n/**\n* Checks if the specified class value exists in the element's class attribute.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to search\n* @return {boolean} return false if the class is not found.\n* @example\nimport {hasClass} from \"@daybrush/utils\";\n\nconsole.log(hasClass(element, \"start\")); // true or false\n*/\nfunction hasClass(element, className) {\n  if (element.classList) {\n    return element.classList.contains(className);\n  }\n  return !!element.className.match(new RegExp(\"(\\\\s|^)\" + className + \"(\\\\s|$)\"));\n}\n/**\n* Add the specified class value. If these classe already exist in the element's class attribute they are ignored.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to add\n* @example\nimport {addClass} from \"@daybrush/utils\";\n\naddClass(element, \"start\");\n*/\nfunction addClass(element, className) {\n  if (element.classList) {\n    element.classList.add(className);\n  } else {\n    element.className += \" \" + className;\n  }\n}\n/**\n* Removes the specified class value.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to remove\n* @example\nimport {removeClass} from \"@daybrush/utils\";\n\nremoveClass(element, \"start\");\n*/\nfunction removeClass(element, className) {\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    var reg = new RegExp(\"(\\\\s|^)\" + className + \"(\\\\s|$)\");\n    element.className = element.className.replace(reg, \" \");\n  }\n}\n/**\n* Gets the CSS properties from the element.\n* @memberof DOM\n* @param elements - elements\n* @param properites - the CSS properties\n* @return returns CSS properties and values.\n* @example\nimport {fromCSS} from \"@daybrush/utils\";\n\nconsole.log(fromCSS(element, [\"left\", \"opacity\", \"top\"])); // {\"left\": \"10px\", \"opacity\": 1, \"top\": \"10px\"}\n*/\nfunction fromCSS(elements, properties) {\n  if (!elements || !properties || !properties.length) {\n    return {};\n  }\n  var element;\n  if (elements instanceof Element) {\n    element = elements;\n  } else if (elements.length) {\n    element = elements[0];\n  } else {\n    return {};\n  }\n  var cssObject = {};\n  var styles = getWindow(element).getComputedStyle(element);\n  var length = properties.length;\n  for (var i = 0; i < length; ++i) {\n    cssObject[properties[i]] = styles[properties[i]];\n  }\n  return cssObject;\n}\n/**\n* Sets up a function that will be called whenever the specified event is delivered to the target\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The object which receives a notification (an object that implements the Event interface) when an event of the specified type occurs\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent} from \"@daybrush/utils\";\n\naddEvent(el, \"click\", e => {\n  console.log(e);\n});\n*/\nfunction addEvent(el, type, listener, options) {\n  el.addEventListener(type, listener, options);\n}\n/**\n* removes from the EventTarget an event listener previously registered with EventTarget.addEventListener()\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The EventListener function of the event handler to remove from the event target.\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent, removeEvent} from \"@daybrush/utils\";\nconst listener = e => {\n  console.log(e);\n};\naddEvent(el, \"click\", listener);\nremoveEvent(el, \"click\", listener);\n*/\nfunction removeEvent(el, type, listener, options) {\n  el.removeEventListener(type, listener, options);\n}\nfunction getDocument(el) {\n  return (el === null || el === void 0 ? void 0 : el.ownerDocument) || doc;\n}\nfunction getDocumentElement(el) {\n  return getDocument(el).documentElement;\n}\nfunction getDocumentBody(el) {\n  return getDocument(el).body;\n}\nfunction getWindow(el) {\n  var _a;\n  return ((_a = el === null || el === void 0 ? void 0 : el.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) || window;\n}\nfunction isWindow(val) {\n  return val && \"postMessage\" in val && \"blur\" in val && \"self\" in val;\n}\nfunction isNode(el) {\n  return isObject(el) && el.nodeName && el.nodeType && \"ownerDocument\" in el;\n}\n\nexport { RGB, RGBA, HSL, HSLA, COLOR_MODELS, FUNCTION, PROPERTY, ARRAY, OBJECT, STRING, NUMBER, UNDEFINED, IS_WINDOW, doc as document, getCrossBrowserProperty, TRANSFORM, FILTER, ANIMATION, KEYFRAMES, OPEN_CLOSED_CHARACTERS, TINY_NUM, REVERSE_TINY_NUM, DEFAULT_UNIT_PRESETS, cutHex, hexToRGBA, toFullHex, hslToRGBA, stringToRGBA, dot, isUndefined, isObject, isArray, isString, isNumber, isFunction, splitText, splitSpace, splitComma, splitBracket, splitUnit, camelize, decamelize, toArray, now, findIndex, findLastIndex, findLast, find, requestAnimationFrame, cancelAnimationFrame, getKeys, getValues, getEntries, sortOrders, convertUnitSize, between, checkBoundSize, calculateBoundSize, sum, average, getRad, getCenterPoint, getShapeDirection, getDist, throttle, throttleArray, counter, replaceOnce, flat, deepFlat, pushSet, $, hasClass, addClass, removeClass, fromCSS, addEvent, removeEvent, getDocument, getDocumentElement, getDocumentBody, getWindow, isWindow, isNode };\n//# sourceMappingURL=utils.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: @scena/event-emitter\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesture.git\nversion: 1.0.5\n*/\nimport { isObject, findIndex } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\n/**\n * Implement EventEmitter on object or component.\n */\n\nvar EventEmitter =\n/*#__PURE__*/\nfunction () {\n  function EventEmitter() {\n    this._events = {};\n  }\n  /**\n   * Add a listener to the registered event.\n   * @param - Name of the event to be added\n   * @param - listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add listener in \"a\" event\n   * emitter.on(\"a\", () => {\n   * });\n   * // Add listeners\n   * emitter.on({\n   *  a: () => {},\n   *  b: () => {},\n   * });\n   */\n\n\n  var __proto = EventEmitter.prototype;\n\n  __proto.on = function (eventName, listener) {\n    if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.on(name, eventName[name]);\n      }\n    } else {\n      this._addEvent(eventName, listener, {});\n    }\n\n    return this;\n  };\n  /**\n   * Remove listeners registered in the event target.\n   * @param - Name of the event to be removed\n   * @param - listener function of the event to be removed\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Remove all listeners.\n   * emitter.off();\n   *\n   * // Remove all listeners in \"A\" event.\n   * emitter.off(\"a\");\n   *\n   *\n   * // Remove \"listener\" listener in \"a\" event.\n   * emitter.off(\"a\", listener);\n   */\n\n\n  __proto.off = function (eventName, listener) {\n    if (!eventName) {\n      this._events = {};\n    } else if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.off(name);\n      }\n    } else if (!listener) {\n      this._events[eventName] = [];\n    } else {\n      var events = this._events[eventName];\n\n      if (events) {\n        var index = findIndex(events, function (e) {\n          return e.listener === listener;\n        });\n\n        if (index > -1) {\n          events.splice(index, 1);\n        }\n      }\n    }\n\n    return this;\n  };\n  /**\n   * Add a disposable listener and Use promise to the registered event.\n   * @param - Name of the event to be added\n   * @param - disposable listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add a disposable listener in \"a\" event\n   * emitter.once(\"a\", () => {\n   * });\n   *\n   * // Use Promise\n   * emitter.once(\"a\").then(e => {\n   * });\n   */\n\n\n  __proto.once = function (eventName, listener) {\n    var _this = this;\n\n    if (listener) {\n      this._addEvent(eventName, listener, {\n        once: true\n      });\n    }\n\n    return new Promise(function (resolve) {\n      _this._addEvent(eventName, resolve, {\n        once: true\n      });\n    });\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n\n  __proto.emit = function (eventName, param) {\n    var _this = this;\n\n    if (param === void 0) {\n      param = {};\n    }\n\n    var events = this._events[eventName];\n\n    if (!eventName || !events) {\n      return true;\n    }\n\n    var isStop = false;\n    param.eventType = eventName;\n\n    param.stop = function () {\n      isStop = true;\n    };\n\n    param.currentTarget = this;\n\n    __spreadArrays(events).forEach(function (info) {\n      info.listener(param);\n\n      if (info.once) {\n        _this.off(eventName, info.listener);\n      }\n    });\n\n    return !isStop;\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n  /**\n  * Fires an event to call listeners.\n  * @param - Event name\n  * @param - Event parameter\n  * @return If false, stop the event.\n  * @example\n  *\n  * import EventEmitter from \"@scena/event-emitter\";\n  *\n  *\n  * const emitter = new EventEmitter();\n  *\n  * emitter.on(\"a\", e => {\n  * });\n  *\n  * // emit\n  * emitter.trigger(\"a\", {\n  *   a: 1,\n  * });\n  */\n\n\n  __proto.trigger = function (eventName, param) {\n    if (param === void 0) {\n      param = {};\n    }\n\n    return this.emit(eventName, param);\n  };\n\n  __proto._addEvent = function (eventName, listener, options) {\n    var events = this._events;\n    events[eventName] = events[eventName] || [];\n    var listeners = events[eventName];\n    listeners.push(__assign({\n      listener: listener\n    }, options));\n  };\n\n  return EventEmitter;\n}();\n\nexport default EventEmitter;\n//# sourceMappingURL=event-emitter.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: gesto\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesto.git\nversion: 1.19.4\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport { removeEvent, addEvent, now, isWindow, getWindow } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction getRad(pos1, pos2) {\n    var distX = pos2[0] - pos1[0];\n    var distY = pos2[1] - pos1[1];\n    var rad = Math.atan2(distY, distX);\n    return rad >= 0 ? rad : rad + Math.PI * 2;\n}\nfunction getRotatiion(touches) {\n    return getRad([\n        touches[0].clientX,\n        touches[0].clientY,\n    ], [\n        touches[1].clientX,\n        touches[1].clientY,\n    ]) / Math.PI * 180;\n}\nfunction isMultiTouch(e) {\n    return e.touches && e.touches.length >= 2;\n}\nfunction getEventClients(e) {\n    if (!e) {\n        return [];\n    }\n    if (e.touches) {\n        return getClients(e.touches);\n    }\n    else {\n        return [getClient(e)];\n    }\n}\nfunction isMouseEvent(e) {\n    return e && (e.type.indexOf(\"mouse\") > -1 || \"button\" in e);\n}\nfunction getPosition(clients, prevClients, startClients) {\n    var length = startClients.length;\n    var _a = getAverageClient(clients, length), clientX = _a.clientX, clientY = _a.clientY, originalClientX = _a.originalClientX, originalClientY = _a.originalClientY;\n    var _b = getAverageClient(prevClients, length), prevX = _b.clientX, prevY = _b.clientY;\n    var _c = getAverageClient(startClients, length), startX = _c.clientX, startY = _c.clientY;\n    var deltaX = clientX - prevX;\n    var deltaY = clientY - prevY;\n    var distX = clientX - startX;\n    var distY = clientY - startY;\n    return {\n        clientX: originalClientX,\n        clientY: originalClientY,\n        deltaX: deltaX,\n        deltaY: deltaY,\n        distX: distX,\n        distY: distY,\n    };\n}\nfunction getDist(clients) {\n    return Math.sqrt(Math.pow(clients[0].clientX - clients[1].clientX, 2)\n        + Math.pow(clients[0].clientY - clients[1].clientY, 2));\n}\nfunction getClients(touches) {\n    var length = Math.min(touches.length, 2);\n    var clients = [];\n    for (var i = 0; i < length; ++i) {\n        clients.push(getClient(touches[i]));\n    }\n    return clients;\n}\nfunction getClient(e) {\n    return {\n        clientX: e.clientX,\n        clientY: e.clientY,\n    };\n}\nfunction getAverageClient(clients, length) {\n    if (length === void 0) { length = clients.length; }\n    var sumClient = {\n        clientX: 0,\n        clientY: 0,\n        originalClientX: 0,\n        originalClientY: 0,\n    };\n    var minLength = Math.min(clients.length, length);\n    for (var i = 0; i < minLength; ++i) {\n        var client = clients[i];\n        sumClient.originalClientX += \"originalClientX\" in client ? client.originalClientX : client.clientX;\n        sumClient.originalClientY += \"originalClientY\" in client ? client.originalClientY : client.clientY;\n        sumClient.clientX += client.clientX;\n        sumClient.clientY += client.clientY;\n    }\n    if (!length) {\n        return sumClient;\n    }\n    return {\n        clientX: sumClient.clientX / length,\n        clientY: sumClient.clientY / length,\n        originalClientX: sumClient.originalClientX / length,\n        originalClientY: sumClient.originalClientY / length,\n    };\n}\n\nvar ClientStore = /*#__PURE__*/ (function () {\n    function ClientStore(clients) {\n        this.prevClients = [];\n        this.startClients = [];\n        this.movement = 0;\n        this.length = 0;\n        this.startClients = clients;\n        this.prevClients = clients;\n        this.length = clients.length;\n    }\n    ClientStore.prototype.getAngle = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getRotatiion(clients);\n    };\n    ClientStore.prototype.getRotation = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getRotatiion(clients) - getRotatiion(this.startClients);\n    };\n    ClientStore.prototype.getPosition = function (clients, isAdd) {\n        if (clients === void 0) { clients = this.prevClients; }\n        var position = getPosition(clients || this.prevClients, this.prevClients, this.startClients);\n        var deltaX = position.deltaX, deltaY = position.deltaY;\n        this.movement += Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n        this.prevClients = clients;\n        return position;\n    };\n    ClientStore.prototype.getPositions = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        var prevClients = this.prevClients;\n        var startClients = this.startClients;\n        var minLength = Math.min(this.length, prevClients.length);\n        var positions = [];\n        for (var i = 0; i < minLength; ++i) {\n            positions[i] = getPosition([clients[i]], [prevClients[i]], [startClients[i]]);\n        }\n        return positions;\n    };\n    ClientStore.prototype.getMovement = function (clients) {\n        var movement = this.movement;\n        if (!clients) {\n            return movement;\n        }\n        var currentClient = getAverageClient(clients, this.length);\n        var prevClient = getAverageClient(this.prevClients, this.length);\n        var deltaX = currentClient.clientX - prevClient.clientX;\n        var deltaY = currentClient.clientY - prevClient.clientY;\n        return Math.sqrt(deltaX * deltaX + deltaY * deltaY) + movement;\n    };\n    ClientStore.prototype.getDistance = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getDist(clients);\n    };\n    ClientStore.prototype.getScale = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getDist(clients) / getDist(this.startClients);\n    };\n    ClientStore.prototype.move = function (deltaX, deltaY) {\n        this.startClients.forEach(function (client) {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n        this.prevClients.forEach(function (client) {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n    };\n    return ClientStore;\n}());\n\nvar INPUT_TAGNAMES = [\"textarea\", \"input\"];\n/**\n * You can set up drag, pinch events in any browser.\n */\nvar Gesto = /*#__PURE__*/ (function (_super) {\n    __extends(Gesto, _super);\n    /**\n     *\n     */\n    function Gesto(targets, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.options = {};\n        _this.flag = false;\n        _this.pinchFlag = false;\n        _this.data = {};\n        _this.isDrag = false;\n        _this.isPinch = false;\n        _this.clientStores = [];\n        _this.targets = [];\n        _this.prevTime = 0;\n        _this.doubleFlag = false;\n        _this._useMouse = false;\n        _this._useTouch = false;\n        _this._useDrag = false;\n        _this._dragFlag = false;\n        _this._isTrusted = false;\n        _this._isMouseEvent = false;\n        _this._isSecondaryButton = false;\n        _this._preventMouseEvent = false;\n        _this._prevInputEvent = null;\n        _this._isDragAPI = false;\n        _this._isIdle = true;\n        _this._preventMouseEventId = 0;\n        _this._window = window;\n        _this.onDragStart = function (e, isTrusted) {\n            if (isTrusted === void 0) { isTrusted = true; }\n            if (!_this.flag && e.cancelable === false) {\n                return;\n            }\n            var isDragAPI = e.type.indexOf(\"drag\") >= -1;\n            if (_this.flag && isDragAPI) {\n                return;\n            }\n            _this._isDragAPI = true;\n            var _a = _this.options, container = _a.container, pinchOutside = _a.pinchOutside, preventWheelClick = _a.preventWheelClick, preventRightClick = _a.preventRightClick, preventDefault = _a.preventDefault, checkInput = _a.checkInput, dragFocusedInput = _a.dragFocusedInput, preventClickEventOnDragStart = _a.preventClickEventOnDragStart, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickEventByCondition = _a.preventClickEventByCondition;\n            var useTouch = _this._useTouch;\n            var isDragStart = !_this.flag;\n            _this._isSecondaryButton = e.which === 3 || e.button === 2;\n            if ((preventWheelClick && (e.which === 2 || e.button === 1))\n                || (preventRightClick && (e.which === 3 || e.button === 2))) {\n                _this.stop();\n                return false;\n            }\n            if (isDragStart) {\n                var activeElement = _this._window.document.activeElement;\n                var target = e.target;\n                if (target) {\n                    var tagName = target.tagName.toLowerCase();\n                    var hasInput = INPUT_TAGNAMES.indexOf(tagName) > -1;\n                    var hasContentEditable = target.isContentEditable;\n                    if (hasInput || hasContentEditable) {\n                        if (checkInput || (!dragFocusedInput && activeElement === target)) {\n                            // force false or already focused.\n                            return false;\n                        }\n                        // no focus\n                        if (activeElement && (activeElement === target\n                            || (hasContentEditable && activeElement.isContentEditable && activeElement.contains(target)))) {\n                            if (dragFocusedInput) {\n                                target.blur();\n                            }\n                            else {\n                                return false;\n                            }\n                        }\n                    }\n                    else if ((preventDefault || e.type === \"touchstart\") && activeElement) {\n                        var activeTagName = activeElement.tagName.toLowerCase();\n                        if (activeElement.isContentEditable || INPUT_TAGNAMES.indexOf(activeTagName) > -1) {\n                            activeElement.blur();\n                        }\n                    }\n                    if (preventClickEventOnDragStart || preventClickEventOnDrag || preventClickEventByCondition) {\n                        addEvent(_this._window, \"click\", _this._onClick, true);\n                    }\n                }\n                _this.clientStores = [new ClientStore(getEventClients(e))];\n                _this._isIdle = false;\n                _this.flag = true;\n                _this.isDrag = false;\n                _this._isTrusted = isTrusted;\n                _this._dragFlag = true;\n                _this._prevInputEvent = e;\n                _this.data = {};\n                _this.doubleFlag = now() - _this.prevTime < 200;\n                _this._isMouseEvent = isMouseEvent(e);\n                if (!_this._isMouseEvent && _this._preventMouseEvent) {\n                    _this._allowMouseEvent();\n                }\n                var result = _this._preventMouseEvent || _this.emit(\"dragStart\", __assign(__assign({ data: _this.data, datas: _this.data, inputEvent: e, isMouseEvent: _this._isMouseEvent, isSecondaryButton: _this._isSecondaryButton, isTrusted: isTrusted, isDouble: _this.doubleFlag }, _this.getCurrentStore().getPosition()), { preventDefault: function () {\n                        e.preventDefault();\n                    }, preventDrag: function () {\n                        _this._dragFlag = false;\n                    } }));\n                if (result === false) {\n                    _this.stop();\n                }\n                if (_this._isMouseEvent && _this.flag && preventDefault) {\n                    e.preventDefault();\n                }\n            }\n            if (!_this.flag) {\n                return false;\n            }\n            var timer = 0;\n            if (isDragStart) {\n                _this._attchDragEvent();\n                // wait pinch\n                if (useTouch && pinchOutside) {\n                    timer = setTimeout(function () {\n                        addEvent(container, \"touchstart\", _this.onDragStart, {\n                            passive: false\n                        });\n                    });\n                }\n            }\n            else if (useTouch && pinchOutside) {\n                // pinch is occured\n                removeEvent(container, \"touchstart\", _this.onDragStart);\n            }\n            if (_this.flag && isMultiTouch(e)) {\n                clearTimeout(timer);\n                if (isDragStart && (e.touches.length !== e.changedTouches.length)) {\n                    return;\n                }\n                if (!_this.pinchFlag) {\n                    _this.onPinchStart(e);\n                }\n            }\n        };\n        _this.onDrag = function (e, isScroll) {\n            if (!_this.flag) {\n                return;\n            }\n            var preventDefault = _this.options.preventDefault;\n            if (!_this._isMouseEvent && preventDefault) {\n                e.preventDefault();\n            }\n            _this._prevInputEvent = e;\n            var clients = getEventClients(e);\n            var result = _this.moveClients(clients, e, false);\n            if (_this._dragFlag) {\n                if (_this.pinchFlag || result.deltaX || result.deltaY) {\n                    var dragResult = _this._preventMouseEvent || _this.emit(\"drag\", __assign(__assign({}, result), { isScroll: !!isScroll, inputEvent: e }));\n                    if (dragResult === false) {\n                        _this.stop();\n                        return;\n                    }\n                }\n                if (_this.pinchFlag) {\n                    _this.onPinch(e, clients);\n                }\n            }\n            _this.getCurrentStore().getPosition(clients, true);\n        };\n        _this.onDragEnd = function (e) {\n            if (!_this.flag) {\n                return;\n            }\n            var _a = _this.options, pinchOutside = _a.pinchOutside, container = _a.container, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickEventOnDragStart = _a.preventClickEventOnDragStart, preventClickEventByCondition = _a.preventClickEventByCondition;\n            var isDrag = _this.isDrag;\n            if (preventClickEventOnDrag || preventClickEventOnDragStart || preventClickEventByCondition) {\n                requestAnimationFrame(function () {\n                    _this._allowClickEvent();\n                });\n            }\n            if (!preventClickEventByCondition && !preventClickEventOnDragStart && preventClickEventOnDrag && !isDrag) {\n                _this._allowClickEvent();\n            }\n            if (_this._useTouch && pinchOutside) {\n                removeEvent(container, \"touchstart\", _this.onDragStart);\n            }\n            if (_this.pinchFlag) {\n                _this.onPinchEnd(e);\n            }\n            var clients = (e === null || e === void 0 ? void 0 : e.touches) ? getEventClients(e) : [];\n            var clientsLength = clients.length;\n            if (clientsLength === 0 || !_this.options.keepDragging) {\n                _this.flag = false;\n            }\n            else {\n                _this._addStore(new ClientStore(clients));\n            }\n            var position = _this._getPosition();\n            var currentTime = now();\n            var isDouble = !isDrag && _this.doubleFlag;\n            _this._prevInputEvent = null;\n            _this.prevTime = isDrag || isDouble ? 0 : currentTime;\n            if (!_this.flag) {\n                _this._dettachDragEvent();\n                _this._preventMouseEvent || _this.emit(\"dragEnd\", __assign({ data: _this.data, datas: _this.data, isDouble: isDouble, isDrag: isDrag, isClick: !isDrag, isMouseEvent: _this._isMouseEvent, isSecondaryButton: _this._isSecondaryButton, inputEvent: e, isTrusted: _this._isTrusted }, position));\n                _this.clientStores = [];\n                if (!_this._isMouseEvent) {\n                    _this._preventMouseEvent = true;\n                    // Prevent the problem of touch event and mouse event occurring simultaneously\n                    clearTimeout(_this._preventMouseEventId);\n                    _this._preventMouseEventId = setTimeout(function () {\n                        _this._preventMouseEvent = false;\n                    }, 200);\n                }\n                _this._isIdle = true;\n            }\n        };\n        _this.onBlur = function () {\n            _this.onDragEnd();\n        };\n        _this._allowClickEvent = function () {\n            removeEvent(_this._window, \"click\", _this._onClick, true);\n        };\n        _this._onClick = function (e) {\n            _this._allowClickEvent();\n            _this._allowMouseEvent();\n            var preventClickEventByCondition = _this.options.preventClickEventByCondition;\n            if (preventClickEventByCondition === null || preventClickEventByCondition === void 0 ? void 0 : preventClickEventByCondition(e)) {\n                return;\n            }\n            e.stopPropagation();\n            e.preventDefault();\n        };\n        _this._onContextMenu = function (e) {\n            var options = _this.options;\n            if (!options.preventRightClick) {\n                e.preventDefault();\n            }\n            else {\n                _this.onDragEnd(e);\n            }\n        };\n        _this._passCallback = function () { };\n        var elements = [].concat(targets);\n        var firstTarget = elements[0];\n        _this._window = isWindow(firstTarget) ? firstTarget : getWindow(firstTarget);\n        _this.options = __assign({ checkInput: false, container: firstTarget && !(\"document\" in firstTarget) ? getWindow(firstTarget) : firstTarget, preventRightClick: true, preventWheelClick: true, preventClickEventOnDragStart: false, preventClickEventOnDrag: false, preventClickEventByCondition: null, preventDefault: true, checkWindowBlur: false, keepDragging: false, pinchThreshold: 0, events: [\"touch\", \"mouse\"] }, options);\n        var _a = _this.options, container = _a.container, events = _a.events, checkWindowBlur = _a.checkWindowBlur;\n        _this._useDrag = events.indexOf(\"drag\") > -1;\n        _this._useTouch = events.indexOf(\"touch\") > -1;\n        _this._useMouse = events.indexOf(\"mouse\") > -1;\n        _this.targets = elements;\n        if (_this._useDrag) {\n            elements.forEach(function (el) {\n                addEvent(el, \"dragstart\", _this.onDragStart);\n            });\n        }\n        if (_this._useMouse) {\n            elements.forEach(function (el) {\n                addEvent(el, \"mousedown\", _this.onDragStart);\n                addEvent(el, \"mousemove\", _this._passCallback);\n            });\n            addEvent(container, \"contextmenu\", _this._onContextMenu);\n        }\n        if (checkWindowBlur) {\n            addEvent(getWindow(), \"blur\", _this.onBlur);\n        }\n        if (_this._useTouch) {\n            var passive_1 = {\n                passive: false,\n            };\n            elements.forEach(function (el) {\n                addEvent(el, \"touchstart\", _this.onDragStart, passive_1);\n                addEvent(el, \"touchmove\", _this._passCallback, passive_1);\n            });\n        }\n        return _this;\n    }\n    /**\n     * Stop Gesto's drag events.\n     */\n    Gesto.prototype.stop = function () {\n        this.isDrag = false;\n        this.data = {};\n        this.clientStores = [];\n        this.pinchFlag = false;\n        this.doubleFlag = false;\n        this.prevTime = 0;\n        this.flag = false;\n        this._isIdle = true;\n        this._allowClickEvent();\n        this._dettachDragEvent();\n        this._isDragAPI = false;\n    };\n    /**\n     * The total moved distance\n     */\n    Gesto.prototype.getMovement = function (clients) {\n        return this.getCurrentStore().getMovement(clients) + this.clientStores.slice(1).reduce(function (prev, cur) {\n            return prev + cur.movement;\n        }, 0);\n    };\n    /**\n     * Whether to drag\n     */\n    Gesto.prototype.isDragging = function () {\n        return this.isDrag;\n    };\n    /**\n     * Whether the operation of gesto is finished and is in idle state\n     */\n    Gesto.prototype.isIdle = function () {\n        return this._isIdle;\n    };\n    /**\n     * Whether to start drag\n     */\n    Gesto.prototype.isFlag = function () {\n        return this.flag;\n    };\n    /**\n     * Whether to start pinch\n     */\n    Gesto.prototype.isPinchFlag = function () {\n        return this.pinchFlag;\n    };\n    /**\n     * Whether to start double click\n     */\n    Gesto.prototype.isDoubleFlag = function () {\n        return this.doubleFlag;\n    };\n    /**\n     * Whether to pinch\n     */\n    Gesto.prototype.isPinching = function () {\n        return this.isPinch;\n    };\n    /**\n     * If a scroll event occurs, it is corrected by the scroll distance.\n     */\n    Gesto.prototype.scrollBy = function (deltaX, deltaY, e, isCallDrag) {\n        if (isCallDrag === void 0) { isCallDrag = true; }\n        if (!this.flag) {\n            return;\n        }\n        this.clientStores[0].move(deltaX, deltaY);\n        isCallDrag && this.onDrag(e, true);\n    };\n    /**\n     * Create a virtual drag event.\n     */\n    Gesto.prototype.move = function (_a, inputEvent) {\n        var deltaX = _a[0], deltaY = _a[1];\n        var store = this.getCurrentStore();\n        var nextClients = store.prevClients;\n        return this.moveClients(nextClients.map(function (_a) {\n            var clientX = _a.clientX, clientY = _a.clientY;\n            return {\n                clientX: clientX + deltaX,\n                clientY: clientY + deltaY,\n                originalClientX: clientX,\n                originalClientY: clientY,\n            };\n        }), inputEvent, true);\n    };\n    /**\n     * The dragStart event is triggered by an external event.\n     */\n    Gesto.prototype.triggerDragStart = function (e) {\n        this.onDragStart(e, false);\n    };\n    /**\n     * Set the event data while dragging.\n     */\n    Gesto.prototype.setEventData = function (data) {\n        var currentData = this.data;\n        for (var name_1 in data) {\n            currentData[name_1] = data[name_1];\n        }\n        return this;\n    };\n    /**\n     * Set the event data while dragging.\n     * Use `setEventData`\n     * @deprecated\n     */\n    Gesto.prototype.setEventDatas = function (data) {\n        return this.setEventData(data);\n    };\n    /**\n     * Get the current event state while dragging.\n     */\n    Gesto.prototype.getCurrentEvent = function (inputEvent) {\n        if (inputEvent === void 0) { inputEvent = this._prevInputEvent; }\n        return __assign(__assign({ data: this.data, datas: this.data }, this._getPosition()), { movement: this.getMovement(), isDrag: this.isDrag, isPinch: this.isPinch, isScroll: false, inputEvent: inputEvent });\n    };\n    /**\n     * Get & Set the event data while dragging.\n     */\n    Gesto.prototype.getEventData = function () {\n        return this.data;\n    };\n    /**\n     * Get & Set the event data while dragging.\n     * Use getEventData method\n     * @depreacated\n     */\n    Gesto.prototype.getEventDatas = function () {\n        return this.data;\n    };\n    /**\n     * Unset Gesto\n     */\n    Gesto.prototype.unset = function () {\n        var _this = this;\n        var targets = this.targets;\n        var container = this.options.container;\n        this.off();\n        removeEvent(this._window, \"blur\", this.onBlur);\n        if (this._useDrag) {\n            targets.forEach(function (el) {\n                removeEvent(el, \"dragstart\", _this.onDragStart);\n            });\n        }\n        if (this._useMouse) {\n            targets.forEach(function (target) {\n                removeEvent(target, \"mousedown\", _this.onDragStart);\n            });\n            removeEvent(container, \"contextmenu\", this._onContextMenu);\n        }\n        if (this._useTouch) {\n            targets.forEach(function (target) {\n                removeEvent(target, \"touchstart\", _this.onDragStart);\n            });\n            removeEvent(container, \"touchstart\", this.onDragStart);\n        }\n        this._prevInputEvent = null;\n        this._allowClickEvent();\n        this._dettachDragEvent();\n    };\n    Gesto.prototype.onPinchStart = function (e) {\n        var _this = this;\n        var pinchThreshold = this.options.pinchThreshold;\n        if (this.isDrag && this.getMovement() > pinchThreshold) {\n            return;\n        }\n        var store = new ClientStore(getEventClients(e));\n        this.pinchFlag = true;\n        this._addStore(store);\n        var result = this.emit(\"pinchStart\", __assign(__assign({ data: this.data, datas: this.data, angle: store.getAngle(), touches: this.getCurrentStore().getPositions() }, store.getPosition()), { inputEvent: e, isTrusted: this._isTrusted, preventDefault: function () {\n                e.preventDefault();\n            }, preventDrag: function () {\n                _this._dragFlag = false;\n            } }));\n        if (result === false) {\n            this.pinchFlag = false;\n        }\n    };\n    Gesto.prototype.onPinch = function (e, clients) {\n        if (!this.flag || !this.pinchFlag || clients.length < 2) {\n            return;\n        }\n        var store = this.getCurrentStore();\n        this.isPinch = true;\n        this.emit(\"pinch\", __assign(__assign({ data: this.data, datas: this.data, movement: this.getMovement(clients), angle: store.getAngle(clients), rotation: store.getRotation(clients), touches: store.getPositions(clients), scale: store.getScale(clients), distance: store.getDistance(clients) }, store.getPosition(clients)), { inputEvent: e, isTrusted: this._isTrusted }));\n    };\n    Gesto.prototype.onPinchEnd = function (e) {\n        if (!this.pinchFlag) {\n            return;\n        }\n        var isPinch = this.isPinch;\n        this.isPinch = false;\n        this.pinchFlag = false;\n        var store = this.getCurrentStore();\n        this.emit(\"pinchEnd\", __assign(__assign({ data: this.data, datas: this.data, isPinch: isPinch, touches: store.getPositions() }, store.getPosition()), { inputEvent: e }));\n    };\n    Gesto.prototype.getCurrentStore = function () {\n        return this.clientStores[0];\n    };\n    Gesto.prototype.moveClients = function (clients, inputEvent, isAdd) {\n        var position = this._getPosition(clients, isAdd);\n        var isPrevDrag = this.isDrag;\n        if (position.deltaX || position.deltaY) {\n            this.isDrag = true;\n        }\n        var isFirstDrag = false;\n        if (!isPrevDrag && this.isDrag) {\n            isFirstDrag = true;\n        }\n        return __assign(__assign({ data: this.data, datas: this.data }, position), { movement: this.getMovement(clients), isDrag: this.isDrag, isPinch: this.isPinch, isScroll: false, isMouseEvent: this._isMouseEvent, isSecondaryButton: this._isSecondaryButton, inputEvent: inputEvent, isTrusted: this._isTrusted, isFirstDrag: isFirstDrag });\n    };\n    Gesto.prototype._addStore = function (store) {\n        this.clientStores.splice(0, 0, store);\n    };\n    Gesto.prototype._getPosition = function (clients, isAdd) {\n        var store = this.getCurrentStore();\n        var position = store.getPosition(clients, isAdd);\n        var _a = this.clientStores.slice(1).reduce(function (prev, cur) {\n            var storePosition = cur.getPosition();\n            prev.distX += storePosition.distX;\n            prev.distY += storePosition.distY;\n            return prev;\n        }, position), distX = _a.distX, distY = _a.distY;\n        return __assign(__assign({}, position), { distX: distX, distY: distY });\n    };\n    Gesto.prototype._attchDragEvent = function () {\n        var win = this._window;\n        var container = this.options.container;\n        var passive = {\n            passive: false\n        };\n        if (this._isDragAPI) {\n            addEvent(container, \"dragover\", this.onDrag, passive);\n            addEvent(win, \"dragend\", this.onDragEnd);\n        }\n        if (this._useMouse) {\n            addEvent(container, \"mousemove\", this.onDrag);\n            addEvent(win, \"mouseup\", this.onDragEnd);\n        }\n        if (this._useTouch) {\n            addEvent(container, \"touchmove\", this.onDrag, passive);\n            addEvent(win, \"touchend\", this.onDragEnd, passive);\n            addEvent(win, \"touchcancel\", this.onDragEnd, passive);\n        }\n    };\n    Gesto.prototype._dettachDragEvent = function () {\n        var win = this._window;\n        var container = this.options.container;\n        if (this._isDragAPI) {\n            removeEvent(container, \"dragover\", this.onDrag);\n            removeEvent(win, \"dragend\", this.onDragEnd);\n        }\n        if (this._useMouse) {\n            removeEvent(container, \"mousemove\", this.onDrag);\n            removeEvent(win, \"mouseup\", this.onDragEnd);\n        }\n        if (this._useTouch) {\n            removeEvent(container, \"touchstart\", this.onDragStart);\n            removeEvent(container, \"touchmove\", this.onDrag);\n            removeEvent(win, \"touchend\", this.onDragEnd);\n            removeEvent(win, \"touchcancel\", this.onDragEnd);\n        }\n    };\n    Gesto.prototype._allowMouseEvent = function () {\n        this._preventMouseEvent = false;\n        clearTimeout(this._preventMouseEventId);\n    };\n    return Gesto;\n}(EventEmitter));\n\nexport { Gesto as default };\n//# sourceMappingURL=gesto.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: framework-utils\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/framework-utils.git\nversion: 1.1.0\n*/\nfunction prefixNames(prefix) {\n  var classNames = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    classNames[_i - 1] = arguments[_i];\n  }\n\n  return classNames.map(function (className) {\n    return className.split(\" \").map(function (name) {\n      return name ? \"\" + prefix + name : \"\";\n    }).join(\" \");\n  }).join(\" \");\n}\nfunction prefixCSS(prefix, css) {\n  return css.replace(/([^}{]*){/gm, function (_, selector) {\n    return selector.replace(/\\.([^{,\\s\\d.]+)/g, \".\" + prefix + \"$1\") + \"{\";\n  });\n}\n/* react */\n\nfunction ref(target, name) {\n  return function (e) {\n    e && (target[name] = e);\n  };\n}\nfunction refs(target, name, i) {\n  return function (e) {\n    e && (target[name][i] = e);\n  };\n}\n/* Class Decorator */\n\nfunction Properties(properties, action) {\n  return function (component) {\n    var prototype = component.prototype;\n    properties.forEach(function (property) {\n      action(prototype, property);\n    });\n  };\n}\n/* Property Decorator */\n\nfunction withMethods(methods, duplicate) {\n  if (duplicate === void 0) {\n    duplicate = {};\n  }\n\n  return function (prototype, propertyName) {\n    methods.forEach(function (name) {\n      var methodName = duplicate[name] || name;\n\n      if (methodName in prototype) {\n        return;\n      }\n\n      prototype[methodName] = function () {\n        var _a;\n\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var result = (_a = this[propertyName])[name].apply(_a, args);\n\n        if (result === this[propertyName]) {\n          return this;\n        } else {\n          return result;\n        }\n      };\n    });\n  };\n}\n\nexport { Properties, prefixCSS, prefixNames, ref, refs, withMethods };\n//# sourceMappingURL=utils.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-styled.git\nversion: 1.0.8\n*/\nimport { getDocument, splitComma } from '@daybrush/utils';\n\nfunction hash(str) {\n  var hash = 5381,\n      i    = str.length;\n\n  while(i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */\n  return hash >>> 0;\n}\n\nvar stringHash = hash;\n\nfunction getHash(str) {\n  return stringHash(str).toString(36);\n}\nfunction getShadowRoot(parentElement) {\n  if (parentElement && parentElement.getRootNode) {\n    var rootNode = parentElement.getRootNode();\n    if (rootNode.nodeType === 11) {\n      return rootNode;\n    }\n  }\n  return;\n}\nfunction replaceStyle(className, css, options) {\n  if (options.original) {\n    return css;\n  }\n  return css.replace(/([^};{\\s}][^};{]*|^\\s*){/mg, function (_, selector) {\n    var trimmedSelector = selector.trim();\n    return (trimmedSelector ? splitComma(trimmedSelector) : [\"\"]).map(function (subSelector) {\n      var trimmedSubSelector = subSelector.trim();\n      if (trimmedSubSelector.indexOf(\"@\") === 0) {\n        return trimmedSubSelector;\n      } else if (trimmedSubSelector.indexOf(\":global\") > -1) {\n        return trimmedSubSelector.replace(/\\:global/g, \"\");\n      } else if (trimmedSubSelector.indexOf(\":host\") > -1) {\n        return \"\".concat(trimmedSubSelector.replace(/\\:host/g, \".\".concat(className)));\n      } else if (trimmedSubSelector) {\n        return \".\".concat(className, \" \").concat(trimmedSubSelector);\n      } else {\n        return \".\".concat(className);\n      }\n    }).join(\", \") + \" {\";\n  });\n}\nfunction injectStyle(className, css, options, el, shadowRoot) {\n  var doc = getDocument(el);\n  var style = doc.createElement(\"style\");\n  style.setAttribute(\"type\", \"text/css\");\n  style.setAttribute(\"data-styled-id\", className);\n  style.setAttribute(\"data-styled-count\", \"1\");\n  if (options.nonce) {\n    style.setAttribute(\"nonce\", options.nonce);\n  }\n  style.innerHTML = replaceStyle(className, css, options);\n  (shadowRoot || doc.head || doc.body).appendChild(style);\n  return style;\n}\n\n/**\n * Create an styled object that can be defined and inserted into the css.\n * @param - css styles\n */\nfunction styled(css) {\n  var injectClassName = \"rCS\" + getHash(css);\n  return {\n    className: injectClassName,\n    inject: function (el, options) {\n      if (options === void 0) {\n        options = {};\n      }\n      var shadowRoot = getShadowRoot(el);\n      var styleElement = (shadowRoot || el.ownerDocument || document).querySelector(\"style[data-styled-id=\\\"\".concat(injectClassName, \"\\\"]\"));\n      if (!styleElement) {\n        styleElement = injectStyle(injectClassName, css, options, el, shadowRoot);\n      } else {\n        var count = parseFloat(styleElement.getAttribute(\"data-styled-count\")) || 0;\n        styleElement.setAttribute(\"data-styled-count\", \"\".concat(count + 1));\n      }\n      return {\n        destroy: function () {\n          var _a;\n          var injectCount = parseFloat(styleElement.getAttribute(\"data-styled-count\")) || 0;\n          if (injectCount <= 1) {\n            if (styleElement.remove) {\n              styleElement.remove();\n            } else {\n              (_a = styleElement.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(styleElement);\n            }\n            styleElement = null;\n          } else {\n            styleElement.setAttribute(\"data-styled-count\", \"\".concat(injectCount - 1));\n          }\n        }\n      };\n    }\n  };\n}\n\nexport default styled;\n//# sourceMappingURL=styled.esm.js.map\n","/*\nCopyright (c) 2015 NAVER Corp.\nname: @egjs/agent\nlicense: MIT\nauthor: NAVER Corp.\nrepository: git+https://github.com/naver/agent.git\nversion: 2.3.0\n*/\nfunction some(arr, callback) {\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i)) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction find(arr, callback) {\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i)) {\n      return arr[i];\n    }\n  }\n\n  return null;\n}\nfunction getUserAgent(agent) {\n  var userAgent = agent;\n\n  if (typeof userAgent === \"undefined\") {\n    if (typeof navigator === \"undefined\" || !navigator) {\n      return \"\";\n    }\n\n    userAgent = navigator.userAgent || \"\";\n  }\n\n  return userAgent.toLowerCase();\n}\nfunction execRegExp(pattern, text) {\n  try {\n    return new RegExp(pattern, \"g\").exec(text);\n  } catch (e) {\n    return null;\n  }\n}\nfunction hasUserAgentData() {\n  if (typeof navigator === \"undefined\" || !navigator || !navigator.userAgentData) {\n    return false;\n  }\n\n  var userAgentData = navigator.userAgentData;\n  var brands = userAgentData.brands || userAgentData.uaList;\n  return !!(brands && brands.length);\n}\nfunction findVersion(versionTest, userAgent) {\n  var result = execRegExp(\"(\" + versionTest + \")((?:\\\\/|\\\\s|:)([0-9|\\\\.|_]+))\", userAgent);\n  return result ? result[3] : \"\";\n}\nfunction convertVersion(text) {\n  return text.replace(/_/g, \".\");\n}\nfunction findPreset(presets, userAgent) {\n  var userPreset = null;\n  var version = \"-1\";\n  some(presets, function (preset) {\n    var result = execRegExp(\"(\" + preset.test + \")((?:\\\\/|\\\\s|:)([0-9|\\\\.|_]+))?\", userAgent);\n\n    if (!result || preset.brand) {\n      return false;\n    }\n\n    userPreset = preset;\n    version = result[3] || \"-1\";\n\n    if (preset.versionAlias) {\n      version = preset.versionAlias;\n    } else if (preset.versionTest) {\n      version = findVersion(preset.versionTest.toLowerCase(), userAgent) || version;\n    }\n\n    version = convertVersion(version);\n    return true;\n  });\n  return {\n    preset: userPreset,\n    version: version\n  };\n}\nfunction findPresetBrand(presets, brands) {\n  var brandInfo = {\n    brand: \"\",\n    version: \"-1\"\n  };\n  some(presets, function (preset) {\n    var result = findBrand(brands, preset);\n\n    if (!result) {\n      return false;\n    }\n\n    brandInfo.brand = preset.id;\n    brandInfo.version = preset.versionAlias || result.version;\n    return brandInfo.version !== \"-1\";\n  });\n  return brandInfo;\n}\nfunction findBrand(brands, preset) {\n  return find(brands, function (_a) {\n    var brand = _a.brand;\n    return execRegExp(\"\" + preset.test, brand.toLowerCase());\n  });\n}\n\nvar BROWSER_PRESETS = [{\n  test: \"phantomjs\",\n  id: \"phantomjs\"\n}, {\n  test: \"whale\",\n  id: \"whale\"\n}, {\n  test: \"edgios|edge|edg\",\n  id: \"edge\"\n}, {\n  test: \"msie|trident|windows phone\",\n  id: \"ie\",\n  versionTest: \"iemobile|msie|rv\"\n}, {\n  test: \"miuibrowser\",\n  id: \"miui browser\"\n}, {\n  test: \"samsungbrowser\",\n  id: \"samsung internet\"\n}, {\n  test: \"samsung\",\n  id: \"samsung internet\",\n  versionTest: \"version\"\n}, {\n  test: \"chrome|crios\",\n  id: \"chrome\"\n}, {\n  test: \"firefox|fxios\",\n  id: \"firefox\"\n}, {\n  test: \"android\",\n  id: \"android browser\",\n  versionTest: \"version\"\n}, {\n  test: \"safari|iphone|ipad|ipod\",\n  id: \"safari\",\n  versionTest: \"version\"\n}]; // chromium's engine(blink) is based on applewebkit 537.36.\n\nvar CHROMIUM_PRESETS = [{\n  test: \"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\\\schrome)\",\n  id: \"chrome\",\n  versionTest: \"chrome\"\n}, {\n  test: \"chromium\",\n  id: \"chrome\"\n}, {\n  test: \"whale\",\n  id: \"chrome\",\n  versionAlias: \"-1\",\n  brand: true\n}];\nvar WEBKIT_PRESETS = [{\n  test: \"applewebkit\",\n  id: \"webkit\",\n  versionTest: \"applewebkit|safari\"\n}];\nvar WEBVIEW_PRESETS = [{\n  test: \"(?=(iphone|ipad))(?!(.*version))\",\n  id: \"webview\"\n}, {\n  test: \"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))\",\n  id: \"webview\"\n}, {\n  // test webview\n  test: \"webview\",\n  id: \"webview\"\n}];\nvar OS_PRESETS = [{\n  test: \"windows phone\",\n  id: \"windows phone\"\n}, {\n  test: \"windows 2000\",\n  id: \"window\",\n  versionAlias: \"5.0\"\n}, {\n  test: \"windows nt\",\n  id: \"window\"\n}, {\n  test: \"iphone|ipad|ipod\",\n  id: \"ios\",\n  versionTest: \"iphone os|cpu os\"\n}, {\n  test: \"mac os x\",\n  id: \"mac\"\n}, {\n  test: \"android\",\n  id: \"android\"\n}, {\n  test: \"tizen\",\n  id: \"tizen\"\n}, {\n  test: \"webos|web0s\",\n  id: \"webos\"\n}];\n\nfunction parseUserAgentData(osData) {\n  var userAgentData = navigator.userAgentData;\n  var brands = (userAgentData.uaList || userAgentData.brands).slice();\n  var isMobile = userAgentData.mobile || false;\n  var firstBrand = brands[0];\n  var browser = {\n    name: firstBrand.brand,\n    version: firstBrand.version,\n    majorVersion: -1,\n    webkit: false,\n    webkitVersion: \"-1\",\n    chromium: false,\n    chromiumVersion: \"-1\",\n    webview: !!findPresetBrand(WEBVIEW_PRESETS, brands).brand\n  };\n  var os = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1\n  };\n  browser.webkit = !browser.chromium && some(WEBKIT_PRESETS, function (preset) {\n    return findBrand(brands, preset);\n  });\n  var chromiumBrand = findPresetBrand(CHROMIUM_PRESETS, brands);\n  browser.chromium = !!chromiumBrand.brand;\n  browser.chromiumVersion = chromiumBrand.version;\n\n  if (!browser.chromium) {\n    var webkitBrand = findPresetBrand(WEBKIT_PRESETS, brands);\n    browser.webkit = !!webkitBrand.brand;\n    browser.webkitVersion = webkitBrand.version;\n  }\n\n  if (osData) {\n    var platform_1 = osData.platform.toLowerCase();\n    var result = find(OS_PRESETS, function (preset) {\n      return new RegExp(\"\" + preset.test, \"g\").exec(platform_1);\n    });\n    os.name = result ? result.id : platform_1;\n    os.version = osData.platformVersion;\n  }\n\n  var browserBrand = findPresetBrand(BROWSER_PRESETS, brands);\n\n  if (browserBrand.brand) {\n    browser.name = browserBrand.brand;\n    browser.version = osData ? osData.uaFullVersion : browserBrand.version;\n  }\n\n  if (navigator.platform === \"Linux armv8l\") {\n    os.name = \"android\";\n  } else if (browser.webkit) {\n    os.name = isMobile ? \"ios\" : \"mac\";\n  }\n\n  if (os.name === \"ios\" && browser.webview) {\n    browser.version = \"-1\";\n  }\n\n  os.version = convertVersion(os.version);\n  browser.version = convertVersion(browser.version);\n  os.majorVersion = parseInt(os.version, 10);\n  browser.majorVersion = parseInt(browser.version, 10);\n  return {\n    browser: browser,\n    os: os,\n    isMobile: isMobile,\n    isHints: true\n  };\n}\n\nfunction parseUserAgent(userAgent) {\n  var nextAgent = getUserAgent(userAgent);\n  var isMobile = !!/mobi/g.exec(nextAgent);\n  var browser = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1,\n    webview: !!findPreset(WEBVIEW_PRESETS, nextAgent).preset,\n    chromium: false,\n    chromiumVersion: \"-1\",\n    webkit: false,\n    webkitVersion: \"-1\"\n  };\n  var os = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1\n  };\n\n  var _a = findPreset(BROWSER_PRESETS, nextAgent),\n      browserPreset = _a.preset,\n      browserVersion = _a.version;\n\n  var _b = findPreset(OS_PRESETS, nextAgent),\n      osPreset = _b.preset,\n      osVersion = _b.version;\n\n  var chromiumPreset = findPreset(CHROMIUM_PRESETS, nextAgent);\n  browser.chromium = !!chromiumPreset.preset;\n  browser.chromiumVersion = chromiumPreset.version;\n\n  if (!browser.chromium) {\n    var webkitPreset = findPreset(WEBKIT_PRESETS, nextAgent);\n    browser.webkit = !!webkitPreset.preset;\n    browser.webkitVersion = webkitPreset.version;\n  }\n\n  if (osPreset) {\n    os.name = osPreset.id;\n    os.version = osVersion;\n    os.majorVersion = parseInt(osVersion, 10);\n  }\n\n  if (browserPreset) {\n    browser.name = browserPreset.id;\n    browser.version = browserVersion;\n\n    if (browser.webview && os.name === \"ios\" && browser.name !== \"safari\") {\n      browser.webview = false;\n    }\n  }\n\n  browser.majorVersion = parseInt(browser.version, 10);\n  return {\n    browser: browser,\n    os: os,\n    isMobile: isMobile,\n    isHints: false\n  };\n}\n\n/**\n * @namespace eg.agent\n */\n\n/**\n* Extracts accuate browser and operating system information from the user agent string or client hints.\n* @ko     client hints     .\n* @function eg.agent#getAccurateAgent\n* @param - Callback function to get the accuate agent <ko>    callback </ko>\n* @return - get the accuate agent promise. If Promise are not supported, null is returned. <ko>   promise . Promise    , null . </ko>\n* @example\nimport { getAccurateAgent } from \"@egjs/agent\";\n// eg.agent.getAccurateAgent()\ngetAccurateAgent().then(agent => {\n   const { os, browser, isMobile } = agent;\n});\ngetAccurateAgent(agent => {\n    const { os, browser, isMobile } = agent;\n});\n*/\n\nfunction getAccurateAgent(callback) {\n  if (hasUserAgentData()) {\n    return navigator.userAgentData.getHighEntropyValues([\"architecture\", \"model\", \"platform\", \"platformVersion\", \"uaFullVersion\"]).then(function (info) {\n      var agentInfo = parseUserAgentData(info);\n      callback && callback(agentInfo);\n      return agentInfo;\n    });\n  }\n\n  callback && callback(agent());\n\n  if (typeof Promise === \"undefined\" || !Promise) {\n    return null;\n  }\n\n  return Promise.resolve(agent());\n}\n/**\n * Extracts browser and operating system information from the user agent string.\n * @ko       .\n * @function eg.agent#agent\n * @param - user agent string to parse <ko>  </ko>\n * @return - agent Info <ko>   </ko>\n * @example\nimport agent from \"@egjs/agent\";\n// eg.agent();\nconst { os, browser, isMobile } = agent();\n */\n\nfunction agent(userAgent) {\n  if (typeof userAgent === \"undefined\" && hasUserAgentData()) {\n    return parseUserAgentData();\n  } else {\n    return parseUserAgent(userAgent);\n  }\n}\n\nexport default agent;\nexport { getAccurateAgent };\n//# sourceMappingURL=agent.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: infinite-viewer\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/infinite-viewer.git\nversion: 0.29.1\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport Gesto from 'gesto';\nimport { prefixCSS, Properties } from 'framework-utils';\nimport { getDocument, addClass, getWindow, addEvent, throttle, removeEvent, isNode, isObject, isArray, between, convertUnitSize, isString, camelize } from '@daybrush/utils';\nimport styled from 'css-styled';\nimport getAgent from '@egjs/agent';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nvar agent = getAgent();\nvar IS_SAFARI = agent.browser.name === \"safari\";\nvar PREFIX = \"infinite-viewer-\";\nvar WRAPPER_CLASS_NAME = \"\".concat(PREFIX, \"wrapper\");\nvar SCROLL_AREA_CLASS_NAME = \"\".concat(PREFIX, \"scroll-area\");\nvar SCROLL_BAR_CLASS_NAME = \"\".concat(PREFIX, \"scroll-bar\");\nvar HORIZONTAL_SCROLL_BAR_CLASS_NAME = \"\".concat(PREFIX, \"horizontal-scroll-bar\");\nvar VERTICAL_SCROLL_BAR_CLASS_NAME = \"\".concat(PREFIX, \"vertical-scroll-bar\");\nvar SCROLL_THUMB_CLASS_NAME = \"\".concat(PREFIX, \"scroll-thumb\");\nvar injector = styled(prefixCSS(PREFIX, \"\\n{\\n    position: relative;\\n    overscroll-behavior: none;\\n}\\n.wrapper {\\n    position: absolute;\\n    width: 100%;\\n    height: 100%;\\n    overflow: auto;\\n    scrollbar-width: none;\\n    top: 0;\\n    left: 0;\\n    will-change: scroll-position;\\n}\\n.restrict-wrapper {\\n    position: absolute;\\n    width: 100%;\\n    height: 100%;\\n    top: 0;\\n    left: 0;\\n}\\n.wrapper::-webkit-scrollbar {\\n    display: none;\\n}\\n.scroll-area {\\n    position:absolute;\\n    top:0;\\n    left:0;\\n    transform-origin: 0 0;\\n}\\n.scroll-bar {\\n    position:absolute;\\n    width: 10px;\\n    height: 10px;\\n    box-sizing: border-box;\\n    right: 0;\\n    bottom: 0;\\n    overflow: hidden;\\n}\\n.horizontal-scroll-bar {\\n    width: calc(100% - 20px);\\n    right: 10px;\\n    height: 14px;\\n}\\n.vertical-scroll-bar {\\n    height: calc(100% - 20px);\\n    bottom: 10px;\\n    width: 14px;\\n}\\n.scroll-thumb {\\n    position:relative;\\n    opacity: 0.7;\\n    background: #333;\\n    border-radius: 3px;\\n    left: 0px;\\n    top: 0px;\\n    z-index: 10;\\n    width: 6px;\\n    height: 6px;\\n    transition: all ease 0.2s;\\n    opacity: 0;\\n}\\n.scroll-bar:hover .scroll-thumb {\\n    border-radius: 5px;\\n    opacity: 1;\\n}\\n.horizontal-scroll-bar .scroll-thumb {\\n    margin: 4px 0px;\\n    transition-property: opacity, margin, height, border-radius;\\n}\\n.vertical-scroll-bar .scroll-thumb {\\n    margin: 0px 4px;\\n    transition-property: opacity, margin, width, border-radius;\\n}\\n.horizontal-scroll-bar:hover .scroll-thumb {\\n    height: 10px;\\n    margin: 2px 0px;\\n}\\n.vertical-scroll-bar:hover .scroll-thumb {\\n    width: 10px;\\n    margin: 0px 2px;\\n}\\n\"));\nvar DEFAULT_OPTIONS = {\n  margin: 500,\n  threshold: 100,\n  zoom: 1,\n  zoomX: 1,\n  zoomY: 1,\n  rangeX: [-Infinity, Infinity],\n  rangeY: [-Infinity, Infinity],\n  rangeOffsetX: [0, 0],\n  rangeOffsetY: [0, 0],\n  wrapperElement: null,\n  scrollAreaElement: null,\n  horizontalScrollElement: null,\n  verticalScrollElement: null,\n  usePinch: false,\n  useAutoZoom: false,\n  useMouseDrag: false,\n  pinchThreshold: 30,\n  cspNonce: \"\",\n  maxPinchWheel: Infinity,\n  wheelScale: 0.01,\n  displayHorizontalScroll: true,\n  displayVerticalScroll: true,\n  useTransform: true,\n  useWheelPinch: true,\n  zoomRange: [0.001, Infinity],\n  wheelPinchKey: \"ctrl\",\n  useWheelScroll: IS_SAFARI,\n  zoomOffsetX: \"50%\",\n  zoomOffsetY: \"50%\",\n  translateZ: 0,\n  useGesture: true,\n  useResizeObserver: false,\n  pinchDirection: \"all\",\n  preventWheelClick: true,\n  useBounceScrollBar: false,\n  useOverflowScroll: false\n};\nvar DEFAULT_EASING = function (x) {\n  return 1 - Math.pow(1 - x, 3);\n};\nvar NAMES = {\n  horizontal: {\n    pos: \"Left\",\n    coord: \"X\",\n    size: \"Width\"\n  },\n  vertical: {\n    pos: \"Top\",\n    coord: \"Y\",\n    size: \"Height\"\n  }\n};\n/**\n * @memberof InfiniteViewer\n */\n\nvar CLASS_NAME = injector.className;\n/**\n * @memberof InfiniteViewer\n */\n\nvar PROPERTIES = [\"margin\", \"threshold\", \"zoomOffsetX\", \"zoomOffsetY\", \"zoom\", \"zoomX\", \"zoomY\", \"rangeX\", \"rangeY\", \"rangeOffsetX\", \"rangeOffsetY\", \"usePinch\", \"useMouseDrag\", \"pinchThreshold\", \"maxPinchWheel\", \"wheelScale\", \"displayVerticalScroll\", \"displayHorizontalScroll\", \"translateZ\", \"useAutoZoom\", \"wheelPinchKey\", \"zoomRange\", \"zoomRangeX\", \"zoomRangeY\", \"pinchDirection\", \"useOverflowScroll\"];\n/**\n * @memberof InfiniteViewer\n */\n\nvar OPTIONS = __spreadArray(__spreadArray([], PROPERTIES, true), [\"preventWheelClick\", \"useWheelPinch\", \"useWheelScroll\", \"useGesture\", \"cspNonce\", \"wrapperElement\", \"scrollAreaElement\", \"verticalScrollElement\", \"horizontalScrollElement\", \"useResizeObserver\", \"wheelContainer\", \"useBounceScrollBar\"], false);\n/**\n * @memberof InfiniteViewer\n */\n\nvar EVENTS = [\"scroll\", \"abortPinch\", \"dragStart\", \"dragEnd\", \"pinchStart\", \"pinch\"];\n/**\n * @memberof InfiniteViewer\n */\n\nvar METHODS = [\"getScrollLeft\", \"getScrollTop\", \"getScrollWidth\", \"getScrollHeight\", \"getContainerWidth\", \"getContainerHeight\", \"getViewportWidth\", \"getViewportHeight\", \"getViewportScrollWidth\", \"getViewportScrollHeight\", \"scrollTo\", \"scrollBy\", \"zoomBy\", \"scrollCenter\", \"getContainer\", \"getViewport\", \"getWrapper\", \"setZoom\", \"getRangeX\", \"getRangeY\", \"resize\", \"getZoom\", \"getZoomX\", \"getZoomY\", \"getWheelContainer\", \"setTo\", \"setBy\"];\nvar TINY_NUM = 0.000001;\n\nfunction measureSpeed(e) {\n  var deltaX = e.deltaX,\n      deltaY = e.deltaY,\n      datas = e.datas;\n  var time = Date.now();\n  var prevSpeed = datas.speed;\n\n  if (!prevSpeed) {\n    datas.speed = [0, 0];\n    datas.time = time;\n    return;\n  }\n\n  var dt = time - datas.time;\n  datas.speed = [prevSpeed[0] / 2 + deltaX / dt, prevSpeed[1] / 2 + deltaY / dt];\n}\nfunction getDuration(speed, a) {\n  var normalSpeed = Math.sqrt(speed[0] * speed[0] + speed[1] * speed[1]);\n  return Math.abs(normalSpeed / a);\n}\nfunction getDestPos(speed, a) {\n  var duration = getDuration(speed, a);\n  return [-speed[0] / 2 * duration, -speed[1] / 2 * duration];\n}\nfunction abs(v) {\n  return Math.abs(v);\n}\nfunction getRange(pos, margin, range, threshold, isReal) {\n  var min = isReal || isFinite(range[0]) ? range[0] : Math.min(-1, Math.floor(pos / margin)) * margin - threshold;\n  var max = isReal || isFinite(range[1]) ? range[1] : Math.max(1, Math.ceil(pos / margin)) * margin + threshold;\n  return [min, max];\n}\nfunction checkDefault(value, defaultValue) {\n  return value != null ? value : defaultValue;\n}\nfunction startAnimation(callback, timerCallback, options) {\n  var duration = options.duration;\n\n  var easing = options.easing || function (x) {\n    return 1 - Math.pow(1 - x, 3);\n  };\n\n  var startTime = Date.now();\n  var prevTime = startTime;\n\n  var next = function () {\n    var now = Date.now();\n    var t = now - startTime;\n\n    if (duration < t) {\n      t = duration;\n    }\n\n    var ratio = easing(t / duration);\n    var prevRatio = easing((prevTime - startTime) / duration);\n    prevTime = now;\n    callback(ratio - prevRatio);\n\n    if (t >= duration) {\n      return;\n    }\n\n    timerCallback(next);\n  };\n\n  timerCallback(next);\n}\n\nvar ScrollBar =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(ScrollBar, _super);\n\n  function ScrollBar(containerElement, type, container) {\n    var _this = _super.call(this) || this;\n\n    _this.type = type;\n    _this.isAppend = false;\n    _this.size = 0;\n    _this.scrollSize = 0;\n    _this.isHorizontal = false;\n\n    _this._onDragStart = function (e) {\n      var isHorizontal = _this.isHorizontal;\n      var target = e.inputEvent.target;\n      var datas = e.datas;\n      var isThumb = _this.thumbElement === target;\n\n      if (!isThumb) {\n        setTimeout(function () {\n          requestAnimationFrame(function () {\n            var thumbRect = _this.thumbElement.getBoundingClientRect();\n\n            var pos1 = thumbRect[isHorizontal ? \"left\" : \"top\"];\n            var thumbSize = thumbRect[isHorizontal ? \"width\" : \"height\"];\n            var pos2 = pos1 + thumbSize;\n            var clientPos = e[isHorizontal ? \"clientX\" : \"clientY\"];\n\n            if (pos1 <= clientPos && clientPos <= pos2) {\n              return;\n            }\n\n            var size = _this.size;\n            var delta = size * size / _this.scrollSize;\n\n            _this.scrollBy(pos1 < clientPos ? delta : -delta);\n          });\n        }, 100);\n      }\n\n      datas.isThumb = isThumb;\n      e.inputEvent.stopPropagation();\n      e.inputEvent.preventDefault();\n    };\n\n    _this._onDrag = function (e) {\n      if (!e.datas.isThumb) {\n        return;\n      }\n\n      _this.scrollBy(_this.isHorizontal ? e.deltaX : e.deltaY);\n    };\n\n    _this._onWheel = function (e) {\n      var delta = _this.isHorizontal ? e.deltaX : e.deltaY;\n\n      if (delta) {\n        e.preventDefault();\n      }\n\n      _this.trigger(\"scroll\", {\n        delta: delta\n      });\n    };\n\n    var isHorizontal = type === \"horizontal\";\n    var doc = getDocument(containerElement);\n    var thumbElement;\n    var barElement = container;\n\n    if (!container) {\n      barElement = doc.createElement(\"div\");\n      thumbElement = doc.createElement(\"div\");\n      barElement.insertBefore(thumbElement, null);\n      _this.isAppend = true;\n    } else {\n      thumbElement = container.querySelector(\".\".concat(SCROLL_THUMB_CLASS_NAME));\n    }\n\n    addClass(barElement, isHorizontal ? HORIZONTAL_SCROLL_BAR_CLASS_NAME : VERTICAL_SCROLL_BAR_CLASS_NAME);\n    addClass(barElement, SCROLL_BAR_CLASS_NAME);\n    addClass(thumbElement, SCROLL_THUMB_CLASS_NAME);\n    _this.thumbElement = thumbElement;\n    _this.barElement = barElement;\n    _this.isHorizontal = isHorizontal;\n    _this.gesto = new Gesto(barElement, {\n      container: getWindow(doc)\n    }).on(\"dragStart\", function (e) {\n      return _this._onDragStart(e);\n    }).on(\"drag\", function (e) {\n      return _this._onDrag(e);\n    });\n    addEvent(_this.barElement, \"wheel\", _this._onWheel, {\n      passive: false\n    });\n    return _this;\n  }\n\n  var __proto = ScrollBar.prototype;\n\n  __proto.scrollBy = function (delta, isAbsolute) {\n    var ratio = delta / this.size;\n    this.trigger(\"scroll\", {\n      delta: isAbsolute ? delta : this.scrollSize * ratio\n    });\n  };\n\n  __proto.render = function (isDisplay, pos, size, scrollSize) {\n    this.size = size;\n    this.scrollSize = scrollSize;\n    var opacity = isDisplay && throttle(scrollSize - size, 0.001) > 0 ? 1 : 0;\n\n    var _a = this.isHorizontal ? [\"X\", \"width\"] : [\"Y\", \"height\"],\n        dirName1 = _a[0],\n        sizeName = _a[1];\n\n    var sizeP = size / scrollSize * 100;\n    var posP = Math.max(0, pos) / scrollSize * 100;\n    this.thumbElement.style.cssText += \"\".concat(sizeName, \": \").concat(sizeP, \"%;opacity: \").concat(opacity, \";\") + \"transform: translate\".concat(dirName1, \"(\").concat(100 / sizeP * posP, \"%)\");\n  };\n\n  __proto.destroy = function () {\n    removeEvent(this.barElement, \"wheel\", this._onWheel);\n    this.gesto.off();\n    this.off();\n  };\n\n  return ScrollBar;\n}(EventEmitter);\n\nvar InfiniteViewer =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(InfiniteViewer, _super);\n  /**\n   * @sort 1\n   */\n\n\n  function InfiniteViewer(_containerElement, viewportElement, options) {\n    if (viewportElement === void 0) {\n      viewportElement = {};\n    }\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this._containerElement = _containerElement;\n    _this.offsetX = 0;\n    _this.offsetY = 0;\n    _this.containerWidth = 0;\n    _this.containerHeight = 0;\n    _this.viewportWidth = 0;\n    _this.viewportHeight = 0;\n    _this.viewportScrollWidth = 0;\n    _this.viewportScrollHeight = 0;\n    _this.scrollLeft = 0;\n    _this.scrollTop = 0;\n    _this._scrollTimer = 0;\n    _this._zoomTimer = 0;\n    _this._viewportElement = null;\n    _this._wheelContainerElement = null;\n    _this.dragFlag = false;\n    _this.isLoop = false;\n    _this._tempScale = [1, 1];\n    _this._tempRect = null;\n    _this._tempRectTimer = null;\n    _this._onDestroys = [];\n    _this._asLeft = 0;\n    _this._asTop = 0;\n    /**\n     * Update Viewer Sizes\n     * @method\n     */\n\n    _this.resize = function () {\n      var _a = _this._containerElement,\n          containerWidth = _a.offsetWidth,\n          containerHeight = _a.offsetHeight;\n      var _b = _this._viewportElement,\n          viewportWidth = _b.offsetWidth,\n          viewportHeight = _b.offsetHeight,\n          viewportScrollWidth = _b.scrollWidth,\n          viewportScrollHeight = _b.scrollHeight;\n      _this.containerWidth = containerWidth;\n      _this.containerHeight = containerHeight;\n      _this.viewportWidth = viewportWidth;\n      _this.viewportHeight = viewportHeight;\n      _this.viewportScrollWidth = Math.max(viewportWidth, viewportScrollWidth);\n      _this.viewportScrollHeight = Math.max(viewportHeight, viewportScrollHeight);\n\n      _this.render();\n\n      _this._scrollBy(0, 0);\n    };\n\n    _this._onScroll = function () {\n      var _a = _this.wrapperElement,\n          scrollLeft = _a.scrollLeft,\n          scrollTop = _a.scrollTop;\n      var _b = _this.zoom,\n          zoom = _b === void 0 ? DEFAULT_OPTIONS.zoom : _b;\n      var deltaX = scrollLeft - _this.scrollLeft;\n      var deltaY = scrollTop - _this.scrollTop;\n\n      var viewerScrollLeft = _this.getScrollLeft();\n\n      var viewerScrollTop = _this.getScrollTop();\n\n      if (_this.isLoop) {\n        _this.isLoop = false;\n      }\n\n      _this.scrollLeft = scrollLeft;\n      _this.scrollTop = scrollTop;\n\n      _this.scrollTo(viewerScrollLeft + deltaX / zoom, viewerScrollTop + deltaY / zoom);\n    };\n\n    _this.onWheel = function (e) {\n      var options = _this.options;\n      var pinchDirection = options.pinchDirection;\n      var maxPinchWheel = options.maxPinchWheel || Infinity;\n      var isKeydown = e[\"\".concat(_this.wheelPinchKey, \"Key\")] || e.ctrlKey;\n\n      if (options.useWheelPinch && isKeydown) {\n        var deltaY = e.deltaY;\n        var sign = deltaY >= 0 ? 1 : -1;\n        var distance = Math.min(maxPinchWheel, Math.abs(deltaY));\n        deltaY = sign * distance;\n        var delta = -deltaY;\n        var scale = Math.max(1 + delta * (options.wheelScale || 0.01), TINY_NUM);\n        clearTimeout(_this._tempRectTimer);\n        _this._tempRectTimer = window.setTimeout(function () {\n          _this._tempRect = null;\n        }, 100);\n\n        _this._triggerPinch({\n          distance: distance,\n          scale: scale,\n          rotation: 0,\n          zoom: _this.zoom * scale,\n          zoomX: _this.zoomX * (pinchDirection === \"vertical\" ? 1 : scale),\n          zoomY: _this.zoomY * (pinchDirection === \"horizontal\" ? 1 : scale),\n          inputEvent: e,\n          isWheel: true,\n          clientX: e.clientX,\n          clientY: e.clientY,\n          ratioX: 0,\n          ratioY: 0\n        });\n      } else if (options.useWheelScroll) {\n        var deltaX = e.deltaX;\n        var deltaY = e.deltaY;\n\n        if (e.shiftKey && !deltaX) {\n          deltaX = deltaY;\n          deltaY = 0;\n        }\n\n        _this.scrollBy(deltaX / _this.zoomX, deltaY / _this.zoomY);\n      } else {\n        return;\n      }\n\n      e.preventDefault();\n    };\n\n    _this.onGestureStart = function (e) {\n      _this._tempScale = [_this.zoomX, _this.zoomY];\n\n      _this._setClientRect();\n\n      e.preventDefault();\n    };\n\n    _this.onGestureChange = function (e) {\n      e.preventDefault();\n\n      if (_this.gesto.isFlag() || !_this._tempScale) {\n        _this._tempScale = [1, 1];\n        return;\n      }\n\n      var scale = e.scale;\n      var zoomX = _this._tempScale[0];\n      var zoomY = _this._tempScale[1];\n      var pinchDirection = _this.options.pinchDirection;\n\n      _this._triggerPinch({\n        distance: 0,\n        scale: scale,\n        rotation: e.rotation,\n        inputEvent: e,\n        isWheel: true,\n        zoom: (zoomX + zoomY) * scale / 2,\n        zoomX: zoomX * (pinchDirection === \"vertical\" ? 1 : scale),\n        zoomY: zoomY * (pinchDirection === \"horizontal\" ? 1 : scale),\n        clientX: e.clientX,\n        clientY: e.clientY,\n        ratioX: 0,\n        ratioY: 0\n      });\n    };\n\n    _this.onGestureEnd = function () {};\n\n    if (isNode(viewportElement)) {\n      _this._viewportElement = viewportElement;\n      _this.options = __assign(__assign({}, DEFAULT_OPTIONS), options);\n    } else {\n      _this._viewportElement = _containerElement.children[0];\n      _this.options = __assign(__assign({}, DEFAULT_OPTIONS), viewportElement);\n    }\n\n    _this.init();\n\n    return _this;\n  }\n  /**\n   * Get Container Element\n   */\n\n\n  var __proto = InfiniteViewer.prototype;\n\n  __proto.getContainer = function () {\n    return this._containerElement;\n  };\n  /**\n   * Get Wheel Container Element\n   */\n\n\n  __proto.getWheelContainer = function () {\n    return this._wheelContainerElement;\n  };\n  /**\n   * Get Viewport Element\n   */\n\n\n  __proto.getViewport = function () {\n    return this._viewportElement;\n  };\n  /**\n   * Get Wrapper Element\n   */\n\n\n  __proto.getWrapper = function () {\n    return this.wrapperElement;\n  };\n  /**\n   * Get Scroll Area Element\n   */\n\n\n  __proto.geScrollArea = function () {\n    return this.scrollAreaElement;\n  };\n  /**\n   * Destroy elements, properties, and events.\n   */\n\n\n  __proto.destroy = function () {\n    this.off();\n    this.gesto.unset();\n    this.verticalScrollbar.destroy();\n    this.horizontalScrollbar.destroy();\n    this.injectResult.destroy();\n    var containerElement = this._containerElement;\n\n    this._onDestroys.forEach(function (callback) {\n      callback();\n    });\n\n    removeEvent(this.wrapperElement, \"scroll\", this._onScroll);\n    removeEvent(this._wheelContainerElement, \"wheel\", this.onWheel);\n    removeEvent(containerElement, \"gesturestart\", this.onGestureStart);\n    removeEvent(containerElement, \"gesturechange\", this.onGestureChange);\n    removeEvent(containerElement, \"gesturesend\", this.onGestureEnd);\n    this.gesto = null;\n    this.injectResult = null;\n    this._containerElement = null;\n    this._viewportElement = null;\n    this.options = null;\n  };\n  /**\n   * Gets the number of pixels that an element's content is scrolled vertically.\n   */\n\n\n  __proto.getScrollTop = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var range = false;\n    var absolute = false;\n\n    if (isObject(options)) {\n      range = options.range;\n      absolute = options.absolute;\n    } else {\n      range = options;\n    }\n\n    var zoom = this.zoomY;\n    var pos = this.scrollTop / zoom + this.offsetY + (range ? abs(this.getRangeY()[0]) : 0);\n    return absolute ? pos * zoom : pos;\n  };\n  /**\n   * Gets the number of pixels that an element's content is scrolled vertically.\n   */\n\n\n  __proto.getScrollLeft = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var range = false;\n    var absolute = false;\n\n    if (isObject(options)) {\n      range = options.range;\n      absolute = options.absolute;\n    } else {\n      range = options;\n    }\n\n    var zoom = this.zoomX;\n    var pos = this.scrollLeft / zoom + this.offsetX + (range ? abs(this.getRangeX()[0]) : 0);\n    return absolute ? pos * zoom : pos;\n  };\n  /**\n   * Gets measurement of the width of an element's content with overflow\n   */\n\n\n  __proto.getScrollWidth = function (isZoom) {\n    var range = this._getScrollRangeX();\n\n    var zoom = this.zoomX;\n    var size = this.containerWidth / zoom + abs(range[0]) + range[1];\n    return isZoom ? size : size * zoom;\n  };\n  /**\n   * Gets measurement of the height of an element's content with overflow\n   */\n\n\n  __proto.getScrollHeight = function (isZoom) {\n    var range = this._getScrollRangeY();\n\n    var zoom = this.zoomY;\n    var size = this.containerHeight / zoom + abs(range[0]) + range[1];\n    return isZoom ? size : size * zoom;\n  };\n  /**\n   * Scroll the element to the center\n   */\n\n\n  __proto.scrollCenter = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.resize();\n    var zoomX = this.zoomX;\n    var zoomY = this.zoomY;\n    var left = -(this.containerWidth / zoomX - this.viewportWidth) / 2;\n    var top = -(this.containerHeight / zoomY - this.viewportHeight) / 2;\n\n    if (options.absolute) {\n      left *= zoomX;\n      top *= zoomY;\n    }\n\n    if (options.horizontal === false) {\n      left = this.getScrollLeft();\n    }\n\n    if (options.vertical === false) {\n      top = this.getScrollTop();\n    }\n\n    return this.scrollTo(left, top, options);\n  };\n  /**\n   * Move to that position or zoom.\n   * @since 0.25.0\n   */\n\n\n  __proto.setTo = function (options) {\n    var _a = options.x,\n        x = _a === void 0 ? this.getScrollLeft() : _a,\n        _b = options.y,\n        y = _b === void 0 ? this.getScrollTop() : _b,\n        _c = options.zoom,\n        zoom = _c === void 0 ? [this.getZoomX(), this.getZoomY()] : _c,\n        duration = options.duration;\n\n    var _d = this,\n        prevZoomX = _d.zoomX,\n        prevZoomY = _d.zoomY,\n        zoomRange = _d.zoomRange;\n\n    var _e = this,\n        _f = _e.zoomOffsetX,\n        zoomOffsetX = _f === void 0 ? DEFAULT_OPTIONS.zoomOffsetX : _f,\n        _g = _e.zoomOffsetY,\n        zoomOffsetY = _g === void 0 ? DEFAULT_OPTIONS.zoomOffsetY : _g;\n\n    if (\"zoomOffsetX\" in options) {\n      zoomOffsetX = options.zoomOffsetX;\n    }\n\n    if (\"zoomOffsetY\" in options) {\n      zoomOffsetY = options.zoomOffsetY;\n    }\n\n    var _h = isArray(zoom) ? zoom : [zoom, zoom],\n        zoomX = _h[0],\n        zoomY = _h[1];\n\n    var zoomRangeX = this.zoomRangeX || zoomRange;\n    var zoomRangeY = this.zoomRangeY || zoomRange;\n    var nextZoomX = between(zoomX, zoomRangeX[0], zoomRangeX[1]);\n    var nextZoomY = between(zoomY, zoomRangeY[0], zoomRangeY[1]);\n    var zoomXPos = convertUnitSize(\"\".concat(zoomOffsetX), this.viewportWidth) * (1 / prevZoomX - 1 / nextZoomX);\n    var zoomYPos = convertUnitSize(\"\".concat(zoomOffsetY), this.viewportHeight) * (1 / prevZoomY - 1 / nextZoomY);\n    this.scrollTo(x - zoomXPos, y - zoomYPos, {\n      duration: duration\n    });\n    this.setZoom(zoom, {\n      zoomOffsetX: zoomOffsetX,\n      zoomOffsetY: zoomOffsetY,\n      duration: duration,\n      zoomBase: \"fixed\"\n    });\n  };\n  /**\n   * Move by the position or zoom delta value.\n   * @since 0.25.0\n   */\n\n\n  __proto.setBy = function (options) {\n    var _a = options.x,\n        x = _a === void 0 ? 0 : _a,\n        _b = options.y,\n        y = _b === void 0 ? 0 : _b,\n        _c = options.zoom,\n        zoom = _c === void 0 ? [0, 0] : _c;\n\n    var _d = isArray(zoom) ? zoom : [zoom, zoom],\n        zoomX = _d[0],\n        zoomY = _d[1];\n\n    this.setTo(__assign(__assign({}, options), {\n      x: this.getScrollLeft() + x,\n      y: this.getScrollTop() + y,\n      zoom: [this.zoomX + zoomX, this.zoomY + zoomY]\n    }));\n  };\n  /**\n   * Scrolls the container by the given amount.\n   */\n\n\n  __proto.scrollBy = function (deltaX, deltaY, options) {\n    this._pauseScrollAnimation();\n\n    if (!options || !options.duration) {\n      var scrollLeft = this.getScrollLeft();\n      var scrollTop = this.getScrollTop();\n\n      if (options === null || options === void 0 ? void 0 : options.absolute) {\n        scrollLeft *= this.zoomX;\n        scrollTop *= this.zoomY;\n      }\n\n      return this._scrollTo(scrollLeft + deltaX, scrollTop + deltaY, options);\n    } else {\n      this._startScrollAnimation([deltaX, deltaY], options);\n\n      return true;\n    }\n  };\n  /**\n   * Scrolls the container to set of coordinates.\n   * @param scrollLeft\n   * @param scrollTop\n   */\n\n\n  __proto.scrollTo = function (x, y, options) {\n    this._pauseScrollAnimation();\n\n    if (!options || !options.duration) {\n      return this._scrollTo(x, y, options);\n    } else {\n      var scrollLeft = this.getScrollLeft();\n      var scrollTop = this.getScrollTop();\n\n      if (options === null || options === void 0 ? void 0 : options.absolute) {\n        scrollLeft *= this.zoomX;\n        scrollTop *= this.zoomY;\n      }\n\n      return this.scrollBy(x - scrollLeft, y - scrollTop, options);\n    }\n  };\n  /**\n   * Set viewer zoom by the given amount\n   */\n\n\n  __proto.zoomBy = function (deltaZoom, options) {\n    this._pauseZoomAnimation();\n\n    var _a = isArray(deltaZoom) ? deltaZoom : [deltaZoom, deltaZoom],\n        deltaX = _a[0],\n        deltaY = _a[1];\n\n    if (!options || !options.duration) {\n      this._setZoom([this.zoomX + deltaX, this.zoomY + deltaY], options);\n    } else {\n      this._startZoomAnimation([deltaX, deltaY], options);\n    }\n  };\n  /**\n   * Set viewer zoom\n   */\n\n\n  __proto.setZoom = function (zoom, options) {\n    this._pauseZoomAnimation();\n\n    if (!options || !options.duration) {\n      this._setZoom(zoom, options);\n    } else {\n      var _a = isArray(zoom) ? zoom : [zoom, zoom],\n          zoomX = _a[0],\n          zoomY = _a[1];\n\n      this._startZoomAnimation([zoomX - this.zoomX, zoomY - this.zoomY], options);\n    }\n  };\n\n  __proto.getViewportWidth = function () {\n    return this.viewportWidth;\n  };\n\n  __proto.getViewportHeight = function () {\n    return this.viewportWidth;\n  };\n\n  __proto.getViewportScrollWidth = function () {\n    return this.viewportScrollWidth;\n  };\n\n  __proto.getViewportScrollHeight = function () {\n    return this.viewportScrollHeight;\n  };\n\n  __proto.getContainerWidth = function () {\n    return this.containerWidth;\n  };\n\n  __proto.getContainerHeight = function () {\n    return this.containerHeight;\n  };\n  /**\n   * Get viewer zoom\n   */\n\n\n  __proto.getZoom = function () {\n    return (this.zoomX + this.zoomY) / 2;\n  };\n  /**\n   * Get viewer zoomX\n   * @since 0.20.0\n   */\n\n\n  __proto.getZoomX = function () {\n    return this.zoomX;\n  };\n  /**\n   * Get viewer zoom\n   * @since 0.20.0\n   */\n\n\n  __proto.getZoomY = function () {\n    return this.zoomY;\n  };\n  /**\n   * get x ranges\n   */\n\n\n  __proto.getRangeX = function (isZoom, isReal) {\n    return this._getRangeCoord(\"horizontal\", isZoom, isReal);\n  };\n  /**\n   * get y ranges\n   */\n\n\n  __proto.getRangeY = function (isZoom, isReal) {\n    return this._getRangeCoord(\"vertical\", isZoom, isReal);\n  };\n\n  __proto.init = function () {\n    var _this = this;\n\n    var _a; // infinite-viewer(container)\n    // viewport\n    // children\n\n\n    var containerElement = this._containerElement;\n    var options = this.options;\n    var doc = getDocument(containerElement);\n    var win = getWindow(containerElement); // vanilla\n\n    var wrapperElement = options.wrapperElement || containerElement.querySelector(\".\".concat(WRAPPER_CLASS_NAME));\n    var scrollAreaElement = options.scrollAreaElement || containerElement.querySelector(\".\".concat(SCROLL_AREA_CLASS_NAME));\n    var horizontalScrollElement = options.horizontalScrollElement || containerElement.querySelector(\".\".concat(HORIZONTAL_SCROLL_BAR_CLASS_NAME));\n    var verticalScrollElement = options.verticalScrollElement || containerElement.querySelector(\".\".concat(VERTICAL_SCROLL_BAR_CLASS_NAME));\n\n    if (!wrapperElement) {\n      wrapperElement = doc.createElement(\"div\");\n      wrapperElement.insertBefore(this._viewportElement, null);\n      containerElement.insertBefore(wrapperElement, null);\n    }\n\n    this.wrapperElement = wrapperElement;\n\n    if (!scrollAreaElement) {\n      scrollAreaElement = doc.createElement(\"div\");\n      wrapperElement.insertBefore(scrollAreaElement, wrapperElement.firstChild);\n    }\n\n    this.scrollAreaElement = scrollAreaElement;\n    addClass(containerElement, CLASS_NAME);\n    addClass(wrapperElement, WRAPPER_CLASS_NAME); // addClass(restrictElement, RESTRICT_WRAPPER_CLASS_NAME);\n\n    addClass(scrollAreaElement, SCROLL_AREA_CLASS_NAME);\n    var horizontalBar = new ScrollBar(containerElement, \"horizontal\", horizontalScrollElement);\n    var verticalBar = new ScrollBar(containerElement, \"vertical\", verticalScrollElement);\n    this.horizontalScrollbar = horizontalBar;\n    this.verticalScrollbar = verticalBar;\n    horizontalBar.on(\"scroll\", function (e) {\n      _this.scrollBy(e.delta / _this.zoomX, 0);\n    });\n    verticalBar.on(\"scroll\", function (e) {\n      _this.scrollBy(0, e.delta / _this.zoomY);\n    });\n\n    if (horizontalBar.isAppend) {\n      containerElement.insertBefore(horizontalBar.barElement, null);\n    }\n\n    if (verticalBar.isAppend) {\n      containerElement.insertBefore(verticalBar.barElement, null);\n    }\n\n    this.injectResult = injector.inject(containerElement, {\n      nonce: this.options.cspNonce\n    });\n    var wheelContainerOption = options.wheelContainer;\n    var wheelContainerElement = null;\n\n    if (wheelContainerOption) {\n      if (isString(wheelContainerOption)) {\n        wheelContainerElement = doc.querySelector(wheelContainerOption);\n      } else if (isNode(wheelContainerOption)) {\n        wheelContainerElement = wheelContainerOption;\n      } else if (\"value\" in wheelContainerOption || \"current\" in wheelContainerOption) {\n        wheelContainerElement = wheelContainerOption.current || wheelContainerOption.value;\n      }\n    }\n\n    wheelContainerElement || (wheelContainerElement = containerElement);\n    this._wheelContainerElement = wheelContainerElement;\n    /**\n     * the `dragStart` event fires when `touchstart` does occur.\n     * @memberof InfiniteViewer\n     * @event dragStart\n     * @param {InfiniteViewer.OnDragStart} - Parameters for the `dragStart` event\n     * @example\n     * import InfiniteViewer from \"infinite-viewer\";\n     *\n     * const viewer = new InfiniteViewer(\n     *   document.querySelector(\".container\"),\n     *   document.querySelector(\".viewport\"),\n     * ).on(\"dragStart\", e => {\n     *   console.log(e.inputEvent);\n     * });\n     */\n\n    /**\n     * the `drag` event fires when `touch` does occur.\n     * @memberof InfiniteViewer\n     * @event drag\n     * @param {InfiniteViewer.OnDrag} - Parameters for the `drag` event\n     * @example\n     * import InfiniteViewer from \"infinite-viewer\";\n     *\n     * const viewer = new InfiniteViewer(\n     *   document.querySelector(\".container\"),\n     *   document.querySelector(\".viewport\"),\n     * ).on(\"drag\", e => {\n     *   console.log(e.inputEvent);\n     * });\n     */\n\n    /**\n     * the `dragEnd` event fires when `touchend` does occur.\n     * @memberof InfiniteViewer\n     * @event dragEnd\n     * @param {InfiniteViewer.OnDragEnd} - Parameters for the `dragEnd` event\n     * @example\n     * import InfiniteViewer from \"infinite-viewer\";\n     *\n     * const viewer = new InfiniteViewer(\n     *   document.querySelector(\".container\"),\n     *   document.querySelector(\".viewport\"),\n     * ).on(\"dragEnd\", e => {\n     *   console.log(e.inputEvent);\n     * });\n     */\n\n    /**\n     * the `abortPinch` event fires when `pinch` event does not occur by dragging a certain area.\n     * @memberof InfiniteViewer\n     * @event abortPinch\n     * @param {InfiniteViewer.OnAbortPinch} - Parameters for the abortPinch event\n     * @example\n     * import InfiniteViewer from \"infinite-viewer\";\n     *\n     * const viewer = new InfiniteViewer(\n     *   document.querySelector(\".container\"),\n     *   document.querySelector(\".viewport\"),\n     *   {\n     *     usePinch: true,\n     *   }\n     * ).on(\"abortPinch\", e => {\n     *   console.log(e.inputEvent);\n     * });\n     */\n\n    /**\n     * the `pinch` event fires when two points pinch the viewer\n     * The pinchStart and abortPinch events do not occur when pinching through the wheel.\n     * @memberof InfiniteViewer\n     * @event pinch\n     * @param {InfiniteViewer.OnPinch} - Parameters for the `pinch` event\n     * @example\n     * import InfiniteViewer from \"infinite-viewer\";\n     *\n     * const viewer = new InfiniteViewer(\n     *   document.querySelector(\".container\"),\n     *   document.querySelector(\".viewport\"),\n     *   {\n     *     usePinch: true,\n     *   }\n     * ).on(\"pinch\", e => {\n     *   console.log(e.zoom, e.inputEvent);\n     * });\n     */\n\n    this.gesto = new Gesto(containerElement, {\n      container: getWindow(containerElement),\n      events: [\"touch\", \"mouse\"],\n      preventWheelClick: (_a = this.options.preventWheelClick) !== null && _a !== void 0 ? _a : true\n    }).on(\"dragStart\", function (e) {\n      var inputEvent = e.inputEvent,\n          stop = e.stop,\n          datas = e.datas;\n\n      if (!_this.useMouseDrag && e.isMouseEvent) {\n        stop();\n        return;\n      }\n\n      _this._pauseScrollAnimation();\n\n      _this.dragFlag = false;\n\n      var result = _this.trigger(\"dragStart\", e);\n\n      if (result === false) {\n        stop();\n        return;\n      }\n\n      inputEvent.preventDefault();\n      datas.startEvent = inputEvent;\n    }).on(\"drag\", function (e) {\n      if (!_this.options.usePinch || e.isPinch || _this.useMouseDrag && e.isMouseEvent) {\n        _this.trigger(\"drag\", __assign(__assign({}, e), {\n          inputEvent: e.inputEvent\n        }));\n\n        measureSpeed(e);\n\n        _this.scrollBy(-e.deltaX / _this.zoomX, -e.deltaY / _this.zoomY);\n      } else if (!_this.dragFlag && e.movement > options.pinchThreshold) {\n        _this.dragFlag = true;\n\n        _this.trigger(\"abortPinch\", {\n          inputEvent: e.datas.startEvent || e.inputEvent\n        });\n      }\n    }).on(\"dragEnd\", function (e) {\n      _this.trigger(\"dragEnd\", {\n        isDrag: e.isDrag,\n        isDouble: e.isDouble,\n        inputEvent: e.inputEvent\n      });\n\n      _this._startScrollAnimationBySpeed(e.datas.speed);\n    }).on(\"pinchStart\", function (_a) {\n      var inputEvent = _a.inputEvent,\n          datas = _a.datas,\n          stop = _a.stop;\n      inputEvent.preventDefault();\n\n      _this._pauseScrollAnimation();\n\n      datas.startZoom = [_this.zoomX, _this.zoomY];\n\n      var result = _this.trigger(\"pinchStart\", {\n        inputEvent: inputEvent\n      });\n\n      if (result === false) {\n        stop();\n      }\n\n      _this._setClientRect();\n    }).on(\"pinch\", function (e) {\n      var scale = e.scale;\n      var pinchDirection = _this.options.pinchDirection;\n\n      _this._triggerPinch({\n        rotation: e.rotation,\n        distance: e.distance,\n        scale: e.scale,\n        inputEvent: e.inputEvent,\n        isWheel: false,\n        zoom: e.datas.startZoom * scale,\n        zoomX: _this.zoomX * (pinchDirection === \"vertical\" ? 1 : scale),\n        zoomY: _this.zoomY * (pinchDirection === \"horizontal\" ? 1 : scale),\n        clientX: e.clientX,\n        clientY: e.clientY,\n        ratioX: 0,\n        ratioY: 0\n      });\n    }).on(\"pinchEnd\", function () {\n      _this._tempRect = null;\n    });\n    addEvent(wrapperElement, \"scroll\", this._onScroll);\n\n    if (options.useResizeObserver) {\n      var observer_1 = new win.ResizeObserver(function () {\n        _this.resize();\n      });\n      observer_1.observe(this._viewportElement);\n      observer_1.observe(this._containerElement);\n\n      this._onDestroys.push(function () {\n        observer_1.disconnect();\n      });\n    } else {\n      addEvent(win, \"resize\", this.resize);\n\n      this._onDestroys.push(function () {\n        removeEvent(win, \"resize\", _this.resize);\n      });\n    }\n\n    if (options.useWheelPinch || options.useWheelScroll) {\n      addEvent(wheelContainerElement, \"wheel\", this.onWheel, {\n        passive: false\n      });\n    }\n\n    if (options.useGesture) {\n      addEvent(containerElement, \"gesturestart\", this.onGestureStart, {\n        passive: false\n      });\n      addEvent(containerElement, \"gesturechange\", this.onGestureChange, {\n        passive: false\n      });\n    }\n\n    this.resize();\n  };\n\n  __proto.render = function () {\n    var _a = this,\n        offsetX = _a.offsetX,\n        offsetY = _a.offsetY,\n        _b = _a.zoomX,\n        zoomX = _b === void 0 ? DEFAULT_OPTIONS.zoomX : _b,\n        _c = _a.zoomY,\n        zoomY = _c === void 0 ? DEFAULT_OPTIONS.zoomY : _c,\n        _d = _a.translateZ,\n        translateZ = _d === void 0 ? 0 : _d,\n        rangeX = _a.rangeX,\n        rangeY = _a.rangeY,\n        containerWidth = _a.containerWidth,\n        containerHeight = _a.containerHeight;\n\n    var _e = this.options.useTransform,\n        useTransform = _e === void 0 ? DEFAULT_OPTIONS.useTransform : _e;\n    var nextOffsetX = -offsetX * zoomX;\n    var nextOffsetY = -offsetY * zoomY;\n    this.scrollAreaElement.style.cssText = \"width:calc(100% + \".concat(this.getScrollAreaWidth(), \"px);\") + \"height:calc(100% + \".concat(this.getScrollAreaHeight(), \"px);\");\n    var viewportStyle = this._viewportElement.style;\n\n    if (useTransform === false) {\n      viewportStyle.cssText += \"position: relative; left: \".concat(nextOffsetX, \"px; top: \").concat(nextOffsetY, \"px; \"); // if (restrictOffsetX || restrictOffsetY) {\n      //     viewportStyle.cssText += `position: relative; left: ${restrictOffsetX}px; top: ${restrictOffsetY}px`;\n      // }\n    } else {\n      viewportStyle.cssText += \"transform-origin: 0 0;\" + \"transform:translate3d(\".concat(nextOffsetX, \"px, \").concat(nextOffsetY, \"px, \").concat(translateZ, \"px) scale(\").concat(zoomX, \", \").concat(zoomY, \");\"); // if (restrictOffsetX || restrictOffsetY) {\n      //     viewportStyle.cssText += `transform:translate3d(${restrictOffsetX}px, ${restrictOffsetY}px, 0px)`;\n      // }\n    }\n\n    this.renderScroll();\n  };\n\n  __proto.renderScroll = function () {\n    var _a = this,\n        zoomX = _a.zoomX,\n        zoomY = _a.zoomY,\n        containerWidth = _a.containerWidth,\n        containerHeight = _a.containerHeight;\n\n    var horizontalBar = this.horizontalScrollbar;\n    var verticalBar = this.verticalScrollbar;\n\n    if (this.options.useBounceScrollBar) {\n      var scrollLeft = this.getScrollLeft(true) * zoomX;\n      var rangeX = this.getRangeX(true);\n      var scrollWidth = containerWidth + abs(rangeX[0]) + abs(rangeX[1]);\n      var scrollTop = this.getScrollTop(true) * zoomY;\n      var rangeY = this.getRangeY(true);\n      var scrollHeight = containerHeight + abs(rangeY[0]) + abs(rangeY[1]);\n      horizontalBar.render(this.displayHorizontalScroll, scrollLeft, containerWidth, scrollWidth);\n      verticalBar.render(this.displayVerticalScroll, scrollTop, containerHeight, scrollHeight);\n    } else {\n      var scrollRangeX = this._getScrollRangeX();\n\n      var scrollRangeY = this._getScrollRangeY();\n\n      var scrollLeft = this.getScrollLeft();\n      var scrollTop = this.getScrollTop();\n      var scrollWidth = this.containerWidth + abs(scrollRangeX[0]) + scrollRangeX[1];\n      var scrollHeight = this.containerHeight + abs(scrollRangeY[0]) + scrollRangeY[1];\n      horizontalBar.render(this.displayHorizontalScroll, scrollLeft - scrollRangeX[0], containerWidth, scrollWidth);\n      verticalBar.render(this.displayVerticalScroll, scrollTop - scrollRangeY[0], containerHeight, scrollHeight);\n    }\n  };\n\n  __proto.move = function (scrollLeft, scrollTop) {\n    var wrapperElement = this.wrapperElement;\n    wrapperElement.scrollLeft = scrollLeft;\n    wrapperElement.scrollTop = scrollTop;\n  };\n\n  __proto.setDisplayVerticalScroll = function (displayVerticalScroll) {\n    this.options.displayVerticalScroll = displayVerticalScroll;\n    this.renderScroll();\n  };\n\n  __proto.setDisplayHorizontalScroll = function (displayHorizontalScroll) {\n    this.options.displayHorizontalScroll = displayHorizontalScroll;\n    this.renderScroll();\n  };\n\n  __proto._startZoomAnimation = function (dest, options) {\n    var _this = this;\n\n    if (!dest) {\n      return;\n    }\n\n    var duration = options.duration;\n    var easing = options.easing || DEFAULT_EASING;\n    startAnimation(function (distRatio) {\n      return _this._setZoom([_this.zoomX + dest[0] * distRatio, _this.zoomY + dest[1] * distRatio], options);\n    }, function (next) {\n      _this._zoomTimer = requestAnimationFrame(next);\n    }, {\n      easing: easing,\n      duration: duration\n    });\n  };\n\n  __proto._startScrollAnimation = function (dest, options) {\n    var _this = this;\n\n    if (!dest[0] && !dest[1]) {\n      return;\n    }\n\n    var duration = options.duration;\n    var easing = options.easing || DEFAULT_EASING;\n    startAnimation(function (distRatio) {\n      return _this._scrollBy(dest[0] * distRatio, dest[1] * distRatio, options);\n    }, function (next) {\n      _this._scrollTimer = requestAnimationFrame(next);\n    }, {\n      easing: easing,\n      duration: duration\n    });\n  };\n\n  __proto._startScrollAnimationBySpeed = function (speed) {\n    if (!speed || !speed[0] && !speed[1]) {\n      return;\n    }\n\n    var a = -0.0006;\n    var duration = getDuration(speed, a);\n    var destPos = getDestPos(speed, a);\n    return this._startScrollAnimation(destPos, {\n      duration: duration\n    });\n  };\n\n  __proto._pauseScrollAnimation = function () {\n    cancelAnimationFrame(this._scrollTimer);\n    this._scrollTimer = 0;\n  };\n\n  __proto._pauseZoomAnimation = function () {\n    cancelAnimationFrame(this._zoomTimer);\n    this._zoomTimer = 0;\n  };\n\n  __proto.getScrollAreaWidth = function () {\n    var _a = this.getRangeX(true),\n        min = _a[0],\n        max = _a[1];\n\n    return min || max ? this.margin * 2 : 0;\n  };\n\n  __proto.getScrollAreaHeight = function () {\n    var _a = this.getRangeY(true),\n        min = _a[0],\n        max = _a[1];\n\n    return min || max ? this.margin * 2 : 0;\n  };\n\n  __proto._triggerPinch = function (event) {\n    var clientX = event.clientX,\n        clientY = event.clientY,\n        zoomX = event.zoomX,\n        zoomY = event.zoomY;\n\n    if (this.useAutoZoom) {\n      this._zoomByClient([zoomX, zoomY], clientX, clientY);\n    }\n\n    if (!this._tempRect) {\n      this._setClientRect();\n    }\n\n    var zoomRange = this.zoomRange;\n    var zoomRangeX = this.zoomRangeX || zoomRange;\n    var zoomRangeY = this.zoomRangeY || zoomRange;\n    var _a = this._tempRect,\n        left = _a.left,\n        top = _a.top,\n        width = _a.width,\n        height = _a.height;\n    var ratioX = (clientX - left) / width * 100;\n    var ratioY = (clientY - top) / height * 100;\n    this.trigger(\"pinch\", __assign(__assign({}, event), {\n      zoom: between((zoomX + zoomY) / 2, zoomRange[0], zoomRange[1]),\n      zoomX: between(zoomX, zoomRangeX[0], zoomRangeX[1]),\n      zoomY: between(zoomY, zoomRangeY[0], zoomRangeY[1]),\n      ratioX: ratioX,\n      ratioY: ratioY\n    }));\n  };\n\n  __proto._setClientRect = function () {\n    var rect = this.getContainer().getBoundingClientRect();\n    this._tempRect = {\n      left: rect.left,\n      top: rect.top,\n      width: rect.width,\n      height: rect.height\n    };\n  };\n\n  __proto._zoomByClient = function (zoom, clientX, clientY) {\n    if (!this._tempRect) {\n      this._setClientRect();\n    }\n\n    var _a = this._tempRect,\n        left = _a.left,\n        top = _a.top,\n        width = _a.width,\n        height = _a.height;\n    var options = this.options;\n    var originalZoomOffsetX = options.zoomOffsetX;\n    var originalZoomOffsetY = options.zoomOffsetY;\n    options.zoomOffsetX = \"\".concat((clientX - left) / width * 100, \"%\");\n    options.zoomOffsetY = \"\".concat((clientY - top) / height * 100, \"%\");\n\n    this._setZoom(zoom, {\n      zoomBase: \"screen\"\n    });\n\n    options.zoomOffsetX = originalZoomOffsetX;\n    options.zoomOffsetY = originalZoomOffsetY;\n  };\n\n  __proto._setZoom = function (zoom, zoomOptions) {\n    if (zoomOptions === void 0) {\n      zoomOptions = {};\n    }\n\n    var zoomBase = zoomOptions.zoomBase;\n\n    var _a = this,\n        containerWidth = _a.containerWidth,\n        containerHeight = _a.containerHeight,\n        prevZoomX = _a.zoomX,\n        prevZoomY = _a.zoomY,\n        zoomRange = _a.zoomRange;\n\n    var _b = this,\n        _c = _b.zoomOffsetX,\n        zoomOffsetX = _c === void 0 ? DEFAULT_OPTIONS.zoomOffsetX : _c,\n        _d = _b.zoomOffsetY,\n        zoomOffsetY = _d === void 0 ? DEFAULT_OPTIONS.zoomOffsetY : _d;\n\n    if (\"zoomOffsetX\" in zoomOptions) {\n      zoomOffsetX = zoomOptions.zoomOffsetX;\n    }\n\n    if (\"zoomOffsetY\" in zoomOptions) {\n      zoomOffsetY = zoomOptions.zoomOffsetY;\n    }\n\n    var scrollLeft = this.getScrollLeft();\n    var scrollTop = this.getScrollTop();\n\n    var _e = isArray(zoom) ? zoom : [zoom, zoom],\n        zoomX = _e[0],\n        zoomY = _e[1];\n\n    var zoomRangeX = this.zoomRangeX || zoomRange;\n    var zoomRangeY = this.zoomRangeY || zoomRange;\n    var nextZoomX = between(zoomX, zoomRangeX[0], zoomRangeX[1]);\n    var nextZoomY = between(zoomY, zoomRangeY[0], zoomRangeY[1]);\n    var options = this.options;\n    options.zoomX = nextZoomX;\n    options.zoomY = nextZoomY;\n    options.zoom = (nextZoomX + nextZoomY) / 2;\n    var nextScrollLeft = this.getScrollLeft();\n    var nextScrollTop = this.getScrollTop();\n    var zoomXPos = 0;\n    var zoomYPos = 0;\n\n    if (zoomBase === \"fixed\") {\n      zoomXPos = convertUnitSize(\"\".concat(zoomOffsetX), this.viewportWidth);\n      zoomYPos = convertUnitSize(\"\".concat(zoomOffsetY), this.viewportHeight);\n    } else if (zoomBase === \"viewport\") {\n      zoomXPos = (-scrollLeft + convertUnitSize(\"\".concat(zoomOffsetX), this.viewportWidth)) * prevZoomX;\n      zoomYPos = (-scrollTop + convertUnitSize(\"\".concat(zoomOffsetY), this.viewportHeight)) * prevZoomY;\n    } else {\n      zoomXPos = convertUnitSize(\"\".concat(zoomOffsetX), containerWidth);\n      zoomYPos = convertUnitSize(\"\".concat(zoomOffsetY), containerHeight);\n    }\n\n    var centerX = scrollLeft + zoomXPos / prevZoomX;\n    var centerY = scrollTop + zoomYPos / prevZoomY;\n    var nextCenterX = nextScrollLeft + zoomXPos / nextZoomX;\n    var nextCenterY = nextScrollTop + zoomYPos / nextZoomY;\n\n    this._scrollBy(centerX - nextCenterX, centerY - nextCenterY, {\n      zoom: !!(nextZoomX - prevZoomX || nextZoomY - prevZoomY)\n    });\n\n    this.render();\n  };\n\n  __proto._scrollBy = function (deltaX, deltaY, options) {\n    var scrollLeft = this.getScrollLeft();\n    var scrollTop = this.getScrollTop();\n\n    if (options === null || options === void 0 ? void 0 : options.absolute) {\n      scrollLeft *= this.zoomX;\n      scrollTop *= this.zoomY;\n    }\n\n    return this._scrollTo(scrollLeft + deltaX, scrollTop + deltaY, options);\n  };\n\n  __proto._scrollTo = function (x, y, options) {\n    var _this = this;\n\n    var _a = this,\n        prevScrollLeft = _a.scrollLeft,\n        prevScrollTop = _a.scrollTop;\n\n    var isAbsolute = options === null || options === void 0 ? void 0 : options.absolute;\n\n    this._scrollToType(\"horizontal\", x, isAbsolute);\n\n    this._scrollToType(\"vertical\", y, isAbsolute);\n\n    var scrollLeft = this.scrollLeft;\n    var scrollTop = this.scrollTop;\n    this.render();\n    var nextScrollAbsoluteLeft = this.getScrollLeft();\n    var nextScrollAbsoluteTop = this.getScrollTop();\n\n    this._emitScrollEvent(nextScrollAbsoluteLeft, nextScrollAbsoluteTop, options === null || options === void 0 ? void 0 : options.zoom);\n\n    if (Math.round(prevScrollLeft) !== scrollLeft || Math.round(prevScrollTop) !== scrollTop) {\n      this.isLoop = true;\n      this.move(scrollLeft, scrollTop);\n      requestAnimationFrame(function () {\n        if (!_this.isLoop) {\n          return;\n        }\n\n        _this.isLoop = false;\n        var _a = _this.wrapperElement,\n            requestScrollLeft = _a.scrollLeft,\n            requestScrollTop = _a.scrollTop;\n        _this.scrollLeft = requestScrollLeft;\n        _this.scrollTop = requestScrollTop;\n\n        if (scrollLeft !== Math.round(requestScrollLeft) || scrollTop !== Math.round(requestScrollTop)) {\n          _this._scrollTo(nextScrollAbsoluteLeft, nextScrollAbsoluteTop);\n        }\n      });\n      return false;\n    }\n\n    return true;\n  };\n\n  __proto._scrollToType = function (type, coord, isAbsolute) {\n    var names = NAMES[type];\n\n    var _a = this,\n        _b = _a.margin,\n        margin = _b === void 0 ? DEFAULT_OPTIONS.margin : _b,\n        _c = _a.threshold,\n        threshold = _c === void 0 ? DEFAULT_OPTIONS.threshold : _c;\n\n    var prevScrollPos = this[\"scroll\".concat(names.pos)];\n\n    var _d = this[\"getRange\".concat(names.coord)](true, true),\n        minCoord = _d[0],\n        maxCoord = _d[1];\n\n    var scrollPos = Math.round(prevScrollPos);\n    var scrollAreaSize = this[\"getScrollArea\".concat(names.size)]();\n    var zoom = this[\"zoom\".concat(names.coord)];\n\n    if (isAbsolute) {\n      coord = coord / zoom;\n    }\n\n    var zoomCoord = coord * zoom;\n\n    if (minCoord === maxCoord) {\n      scrollPos = minCoord;\n      coord = minCoord / zoom;\n    } else if (zoomCoord - threshold <= minCoord) {\n      var minThreshold = Math.max(0, zoomCoord - minCoord);\n      scrollPos = minThreshold;\n      coord = (minCoord + minThreshold) / zoom;\n    } else if (zoomCoord + threshold >= maxCoord) {\n      var maxThreshold = Math.max(0, maxCoord - zoomCoord);\n      scrollPos = scrollAreaSize - maxThreshold;\n      coord = (maxCoord - maxThreshold) / zoom;\n    } else if (scrollPos < threshold) {\n      scrollPos += margin;\n    } else if (scrollPos > scrollAreaSize - threshold) {\n      scrollPos -= margin;\n    }\n\n    scrollPos = Math.round(scrollPos);\n    this[\"scroll\".concat(names.pos)] = scrollPos;\n    this[\"offset\".concat(names.coord)] = coord - scrollPos / zoom;\n  };\n\n  __proto._getRangeCoord = function (type, isZoom, isReal) {\n    var _a = this,\n        _b = _a.margin,\n        margin = _b === void 0 ? DEFAULT_OPTIONS.margin : _b,\n        threshold = _a.threshold;\n\n    var names = NAMES[type];\n    var rangeCoord = checkDefault(this[\"range\".concat(names.coord)], DEFAULT_OPTIONS[\"range\".concat(names.coord)]);\n    var rangeOffsetCoord = checkDefault(this[\"rangeOffset\".concat(names.coord)], DEFAULT_OPTIONS[\"rangeOffset\".concat(names.coord)]);\n    var zoom = this[\"zoom\".concat(names.coord)];\n    var range = getRange(this[\"getScroll\".concat(names.pos)](), margin, rangeCoord, threshold, isReal);\n\n    if (!isZoom) {\n      return [range[0] + rangeOffsetCoord[0], range[1] + rangeOffsetCoord[1]];\n    }\n\n    return [range[0] * zoom + rangeOffsetCoord[0], this.options.useOverflowScroll ? Math.max(this[\"viewport\".concat(names.size)] * zoom - this[\"container\".concat(names.size)], range[1] * zoom + rangeOffsetCoord[1]) : range[1] * zoom + rangeOffsetCoord[1]];\n  };\n\n  __proto._emitScrollEvent = function (scrollLeft, scrollTop, zoom) {\n    var prevScrollLeft = this._asLeft;\n    var prevScrollTop = this._asTop;\n\n    if (!zoom && prevScrollLeft === scrollLeft && prevScrollTop === scrollTop) {\n      return;\n    }\n\n    this._asLeft = scrollLeft;\n    this._asTop = scrollTop;\n    /**\n     * The `scroll` event fires when the document view or an element has been scrolled.\n     * @memberof InfiniteViewer\n     * @event scroll\n     * @param {InfiniteViewer.OnScroll} - Parameters for the scroll event\n     * @example\n     * import InfiniteViewer from \"infinite-viewer\";\n     *\n     * const viewer = new InfiniteViewer(\n     *   document.querySelector(\".container\"),\n     *   document.querySelector(\".viewport\"),\n     * ).on(\"scroll\", () => {\n     *   console.log(viewer.getScrollLeft(), viewer.getScrollTop());\n     * });\n     */\n\n    this.trigger(\"scroll\", {\n      scrollLeft: scrollLeft,\n      scrollTop: scrollTop,\n      zoomX: this.zoomX,\n      zoomY: this.zoomY\n    });\n  };\n\n  __proto._getScrollRangeX = function () {\n    var pos = this.getScrollLeft();\n    var rangeX = this.rangeX;\n    var startRange = rangeX[0];\n    var endRange = rangeX[1];\n\n    if (this.useOverflowScroll && isFinite(endRange)) {\n      endRange = Math.max(endRange, this.viewportWidth - this.containerWidth / this.zoomX);\n    }\n\n    var startMargin = Math.min(0, isFinite(startRange) ? Math.min(startRange, pos) : pos);\n    var endMargin = Math.max(0, isFinite(endRange) ? Math.max(endRange, pos) : pos);\n    var viewportSize = this.viewportScrollWidth;\n    var margin = Math.max(this.containerWidth / this.zoomX, viewportSize) - viewportSize;\n    var startSizeOffset = Math.min(0, margin + startMargin);\n    return [startSizeOffset, endMargin];\n  };\n\n  __proto._getScrollRangeY = function () {\n    var pos = this.getScrollTop();\n    var rangeY = this.rangeY;\n    var startRange = rangeY[0];\n    var endRange = rangeY[1];\n\n    if (this.useOverflowScroll && isFinite(endRange)) {\n      endRange = Math.max(endRange, this.viewportHeight - this.containerHeight / this.zoomY);\n    }\n\n    var startMargin = Math.min(0, isFinite(startRange) ? Math.min(startRange, pos) : pos);\n    var endMargin = Math.max(0, isFinite(endRange) ? Math.max(endRange, pos) : pos);\n    var viewportSize = this.viewportScrollHeight;\n    var margin = Math.max(this.containerHeight / this.zoomY, viewportSize) - viewportSize;\n    var startSizeOffset = Math.min(0, margin + startMargin);\n    return [startSizeOffset, endMargin];\n  };\n\n  InfiniteViewer = __decorate([Properties(PROPERTIES, function (prototype, property) {\n    var attributes = {\n      enumerable: true,\n      configurable: true,\n      get: function () {\n        return this.options[property];\n      }\n    };\n    var setter = camelize(\"set \".concat(property));\n\n    if (prototype[setter]) {\n      attributes.set = function (value) {\n        this[setter](value);\n      };\n    } else {\n      attributes.set = function (value) {\n        this.options[property] = value;\n      };\n    }\n\n    Object.defineProperty(prototype, property, attributes);\n  })\n  /**\n   * @sort 1\n   */\n  ], InfiniteViewer);\n  return InfiniteViewer;\n}(EventEmitter);\n\nvar InfiniteViewer$1 =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(InfiniteViewer, _super);\n\n  function InfiniteViewer() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return InfiniteViewer;\n}(InfiniteViewer);\n\nexport default InfiniteViewer$1;\nexport { CLASS_NAME, EVENTS, METHODS, OPTIONS, PROPERTIES };\n//# sourceMappingURL=infinite-viewer.esm.js.map\n","/*\nCopyright (c) 2019-present NAVER Corp.\nname: @egjs/list-differ\nlicense: MIT\nauthor: NAVER Corp.\nrepository: https://github.com/naver/egjs-list-differ\nversion: 1.0.0\n*/\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar PolyMap =\n/*#__PURE__*/\nfunction () {\n  function PolyMap() {\n    this.keys = [];\n    this.values = [];\n  }\n\n  var __proto = PolyMap.prototype;\n\n  __proto.get = function (key) {\n    return this.values[this.keys.indexOf(key)];\n  };\n\n  __proto.set = function (key, value) {\n    var keys = this.keys;\n    var values = this.values;\n    var prevIndex = keys.indexOf(key);\n    var index = prevIndex === -1 ? keys.length : prevIndex;\n    keys[index] = key;\n    values[index] = value;\n  };\n\n  return PolyMap;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar HashMap =\n/*#__PURE__*/\nfunction () {\n  function HashMap() {\n    this.object = {};\n  }\n\n  var __proto = HashMap.prototype;\n\n  __proto.get = function (key) {\n    return this.object[key];\n  };\n\n  __proto.set = function (key, value) {\n    this.object[key] = value;\n  };\n\n  return HashMap;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar SUPPORT_MAP = typeof Map === \"function\";\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar Link =\n/*#__PURE__*/\nfunction () {\n  function Link() {}\n\n  var __proto = Link.prototype;\n\n  __proto.connect = function (prevLink, nextLink) {\n    this.prev = prevLink;\n    this.next = nextLink;\n    prevLink && (prevLink.next = this);\n    nextLink && (nextLink.prev = this);\n  };\n\n  __proto.disconnect = function () {\n    // In double linked list, diconnect the interconnected relationship.\n    var prevLink = this.prev;\n    var nextLink = this.next;\n    prevLink && (prevLink.next = nextLink);\n    nextLink && (nextLink.prev = prevLink);\n  };\n\n  __proto.getIndex = function () {\n    var link = this;\n    var index = -1;\n\n    while (link) {\n      link = link.prev;\n      ++index;\n    }\n\n    return index;\n  };\n\n  return Link;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nfunction orderChanged(changed, fixed) {\n  // It is roughly in the order of these examples.\n  // 4, 6, 0, 2, 1, 3, 5, 7\n  var fromLinks = []; // 0, 1, 2, 3, 4, 5, 6, 7\n\n  var toLinks = [];\n  changed.forEach(function (_a) {\n    var from = _a[0],\n        to = _a[1];\n    var link = new Link();\n    fromLinks[from] = link;\n    toLinks[to] = link;\n  }); // `fromLinks` are connected to each other by double linked list.\n\n  fromLinks.forEach(function (link, i) {\n    link.connect(fromLinks[i - 1]);\n  });\n  return changed.filter(function (_, i) {\n    return !fixed[i];\n  }).map(function (_a, i) {\n    var from = _a[0],\n        to = _a[1];\n\n    if (from === to) {\n      return [0, 0];\n    }\n\n    var fromLink = fromLinks[from];\n    var toLink = toLinks[to - 1];\n    var fromIndex = fromLink.getIndex(); // Disconnect the link connected to `fromLink`.\n\n    fromLink.disconnect(); // Connect `fromLink` to the right of `toLink`.\n\n    if (!toLink) {\n      fromLink.connect(undefined, fromLinks[0]);\n    } else {\n      fromLink.connect(toLink, toLink.next);\n    }\n\n    var toIndex = fromLink.getIndex();\n    return [fromIndex, toIndex];\n  });\n}\n\nvar Result =\n/*#__PURE__*/\nfunction () {\n  function Result(prevList, list, added, removed, changed, maintained, changedBeforeAdded, fixed) {\n    this.prevList = prevList;\n    this.list = list;\n    this.added = added;\n    this.removed = removed;\n    this.changed = changed;\n    this.maintained = maintained;\n    this.changedBeforeAdded = changedBeforeAdded;\n    this.fixed = fixed;\n  }\n\n  var __proto = Result.prototype;\n  Object.defineProperty(__proto, \"ordered\", {\n    get: function () {\n      if (!this.cacheOrdered) {\n        this.caculateOrdered();\n      }\n\n      return this.cacheOrdered;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(__proto, \"pureChanged\", {\n    get: function () {\n      if (!this.cachePureChanged) {\n        this.caculateOrdered();\n      }\n\n      return this.cachePureChanged;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  __proto.caculateOrdered = function () {\n    var ordered = orderChanged(this.changedBeforeAdded, this.fixed);\n    var changed = this.changed;\n    var pureChanged = [];\n    this.cacheOrdered = ordered.filter(function (_a, i) {\n      var from = _a[0],\n          to = _a[1];\n      var _b = changed[i],\n          fromBefore = _b[0],\n          toBefore = _b[1];\n\n      if (from !== to) {\n        pureChanged.push([fromBefore, toBefore]);\n        return true;\n      }\n    });\n    this.cachePureChanged = pureChanged;\n  };\n\n  return Result;\n}();\n\n/**\n *\n * @memberof eg.ListDiffer\n * @static\n * @function\n * @param - Previous List <ko>   </ko>\n * @param - List to Update <ko>    </ko>\n * @param - This callback function returns the key of the item. <ko>     .</ko>\n * @return - Returns the diff between `prevList` and `list` <ko> `prevList` `list`   .</ko>\n * @example\n * import { diff } from \"@egjs/list-differ\";\n * // script => eg.ListDiffer.diff\n * const result = diff([0, 1, 2, 3, 4, 5], [7, 8, 0, 4, 3, 6, 2, 1], e => e);\n * // List before update\n * // [1, 2, 3, 4, 5]\n * console.log(result.prevList);\n * // Updated list\n * // [4, 3, 6, 2, 1]\n * console.log(result.list);\n * // Index array of values added to `list`\n * // [0, 1, 5]\n * console.log(result.added);\n * // Index array of values removed in `prevList`\n * // [5]\n * console.log(result.removed);\n * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.changed);\n * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n * // [[4, 3], [3, 4], [2, 6]]\n * console.log(result.pureChanged);\n * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n * // [[4, 1], [4, 2], [4, 3]]\n * console.log(result.ordered);\n * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.maintained);\n */\n\nfunction diff(prevList, list, findKeyCallback) {\n  var mapClass = SUPPORT_MAP ? Map : findKeyCallback ? HashMap : PolyMap;\n\n  var callback = findKeyCallback || function (e) {\n    return e;\n  };\n\n  var added = [];\n  var removed = [];\n  var maintained = [];\n  var prevKeys = prevList.map(callback);\n  var keys = list.map(callback);\n  var prevKeyMap = new mapClass();\n  var keyMap = new mapClass();\n  var changedBeforeAdded = [];\n  var fixed = [];\n  var removedMap = {};\n  var changed = [];\n  var addedCount = 0;\n  var removedCount = 0; // Add prevKeys and keys to the hashmap.\n\n  prevKeys.forEach(function (key, prevListIndex) {\n    prevKeyMap.set(key, prevListIndex);\n  });\n  keys.forEach(function (key, listIndex) {\n    keyMap.set(key, listIndex);\n  }); // Compare `prevKeys` and `keys` and add them to `removed` if they are not in `keys`.\n\n  prevKeys.forEach(function (key, prevListIndex) {\n    var listIndex = keyMap.get(key); // In prevList, but not in list, it is removed.\n\n    if (typeof listIndex === \"undefined\") {\n      ++removedCount;\n      removed.push(prevListIndex);\n    } else {\n      removedMap[listIndex] = removedCount;\n    }\n  }); // Compare `prevKeys` and `keys` and add them to `added` if they are not in `prevKeys`.\n\n  keys.forEach(function (key, listIndex) {\n    var prevListIndex = prevKeyMap.get(key); // In list, but not in prevList, it is added.\n\n    if (typeof prevListIndex === \"undefined\") {\n      added.push(listIndex);\n      ++addedCount;\n    } else {\n      maintained.push([prevListIndex, listIndex]);\n      removedCount = removedMap[listIndex] || 0;\n      changedBeforeAdded.push([prevListIndex - removedCount, listIndex - addedCount]);\n      fixed.push(listIndex === prevListIndex);\n\n      if (prevListIndex !== listIndex) {\n        changed.push([prevListIndex, listIndex]);\n      }\n    }\n  }); // Sort by ascending order of 'to(list's index).\n\n  removed.reverse();\n  return new Result(prevList, list, added, removed, changed, maintained, changedBeforeAdded, fixed);\n}\n\n/**\n * A module that checks diff when values are added, removed, or changed in an array.\n * @ko          .\n * @memberof eg\n */\n\nvar ListDiffer =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param - Initializing Data Array. <ko>    .</ko>\n   * @param - This callback function returns the key of the item. <ko>     .</ko>\n   * @example\n   * import ListDiffer from \"@egjs/list-differ\";\n   * // script => eg.ListDiffer\n   * const differ = new ListDiffer([0, 1, 2, 3, 4, 5], e => e);\n   * const result = differ.update([7, 8, 0, 4, 3, 6, 2, 1]);\n   * // List before update\n   * // [1, 2, 3, 4, 5]\n   * console.log(result.prevList);\n   * // Updated list\n   * // [4, 3, 6, 2, 1]\n   * console.log(result.list);\n   * // Index array of values added to `list`.\n   * // [0, 1, 5]\n   * console.log(result.added);\n   * // Index array of values removed in `prevList`.\n   * // [5]\n   * console.log(result.removed);\n   * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`.\n   * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n   * console.log(result.changed);\n   * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n   * // [[4, 3], [3, 4], [2, 6]]\n   * console.log(result.pureChanged);\n   * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n   * // [[4, 1], [4, 2], [4, 3]]\n   * console.log(result.ordered);\n   * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved.\n   * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n   * console.log(result.maintained);\n   */\n  function ListDiffer(list, findKeyCallback) {\n    if (list === void 0) {\n      list = [];\n    }\n\n    this.findKeyCallback = findKeyCallback;\n    this.list = [].slice.call(list);\n  }\n  /**\n   * Update list.\n   * @ko   .\n   * @param - List to update <ko>   </ko>\n   * @return - Returns the results of an update from `prevList` to `list`.<ko> `prevList` `list`   . </ko>\n   */\n\n\n  var __proto = ListDiffer.prototype;\n\n  __proto.update = function (list) {\n    var newData = [].slice.call(list);\n    var result = diff(this.list, newData, this.findKeyCallback);\n    this.list = newData;\n    return result;\n  };\n\n  return ListDiffer;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nexport default ListDiffer;\nexport { diff };\n//# sourceMappingURL=list-differ.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: croact\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/croact.git\nversion: 1.0.4\n*/\nimport { isNode, isArray, isUndefined, getValues, find, isString, removeEvent, addEvent, getDocument, getKeys, decamelize, flat as flat$1, isNumber, pushSet, isFunction, getEntries } from '@daybrush/utils';\nimport { diff } from '@egjs/list-differ';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nfunction fillKeys(keys) {\n  var index = 0;\n  return keys.map(function (key) {\n    return key == null ? \"$compat\".concat(++index) : \"\".concat(key);\n  });\n}\nfunction flat(arr) {\n  var arr2 = [];\n  arr.forEach(function (el) {\n    arr2 = arr2.concat(isArray(el) ? flat(el) : el);\n  });\n  return arr2;\n}\nfunction fillProps(props, defaultProps) {\n  if (!defaultProps) {\n    return props;\n  }\n  for (var name_1 in defaultProps) {\n    if (isUndefined(props[name_1])) {\n      props[name_1] = defaultProps[name_1];\n    }\n  }\n  return props;\n}\nfunction isDiff(a, b) {\n  if (a === b) {\n    return false;\n  }\n  for (var i in a) {\n    if (!(i in b)) {\n      return true;\n    }\n  }\n  for (var i in b) {\n    if (a[i] !== b[i]) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction getAttributes(props) {\n  var className = props.className,\n    otherProps = __rest(props, [\"className\"]);\n  if (className != null) {\n    otherProps.class = className;\n  }\n  delete otherProps.style;\n  delete otherProps.children;\n  return otherProps;\n}\nfunction splitProps(props) {\n  var attributes = {};\n  var events = {};\n  for (var name_2 in props) {\n    if (name_2.indexOf(\"on\") === 0) {\n      events[name_2] = props[name_2];\n    } else {\n      attributes[name_2] = props[name_2];\n    }\n  }\n  return [attributes, events];\n}\nfunction findContainerNode(provider) {\n  if (!provider) {\n    return null;\n  }\n  var base = provider.b;\n  if (isNode(base)) {\n    return base;\n  }\n  return findContainerNode(provider.c);\n}\nfunction removeNode(node) {\n  var parentNode = node.parentNode;\n  if (parentNode) {\n    parentNode.removeChild(node);\n  }\n}\nfunction executeHooks(hooks) {\n  hooks.forEach(function (hook) {\n    hook();\n  });\n}\nfunction renderFunctionComponent() {\n  return this.constructor(this.props, this.context);\n}\n\nvar hooksIndex = 0;\nvar Provider = /*#__PURE__*/function () {\n  function Provider(\n  /**\n   * Type\n   */\n  t,\n  /**\n   * Depth\n   */\n  d,\n  /**\n   * Key\n   */\n  k,\n  /**\n   * index\n   */\n  i,\n  /**\n   * Container\n   */\n  c,\n  /**\n   * Ref\n   */\n  ref,\n  /**\n   * Props\n   */\n  ps) {\n    if (ps === void 0) {\n      ps = {};\n    }\n    this.t = t;\n    this.d = d;\n    this.k = k;\n    this.i = i;\n    this.c = c;\n    this.ref = ref;\n    this.ps = ps;\n    this.typ = \"prov\";\n    /**\n     * providers\n     */\n    this._ps = [];\n    /**\n     * Contexts\n     */\n    this._cs = {};\n    /**\n     * Whether to hydrate\n     */\n    this._hyd = null;\n    /**\n     * is self render\n     */\n    this._sel = false;\n  }\n  var __proto = Provider.prototype;\n  __proto.s = function () {\n    return true;\n  };\n  /**\n   * Update\n   */\n  __proto.u = function (hooks, contexts, nextElement, nextState, isForceUpdate) {\n    var self = this;\n    var currentDepth = self.d;\n    var scheduledContexts = getValues(contexts).filter(function (context) {\n      return context.$_req;\n    });\n    var scheduledSubs = flat(scheduledContexts.map(function (context) {\n      return context.$_subs;\n    }));\n    var isContextUpdate = find(scheduledSubs, function (provider) {\n      return provider.d === currentDepth;\n    });\n    if (self.b && !isString(nextElement) && !isForceUpdate && !self.s(nextElement.props, nextState) && !isContextUpdate) {\n      var nextChildSubs = scheduledSubs.reduce(function (childs, sub) {\n        var depth = sub.d;\n        if (childs[0]) {\n          if (childs[0].d === depth) {\n            childs.push(sub);\n          }\n        } else if (depth > currentDepth) {\n          childs.push(sub);\n        }\n        return childs;\n      }, []);\n      nextChildSubs.forEach(function (child) {\n        // provider.container!,\n        // [provider],\n        // [provider.original],\n        // hooks,\n        // provider._cs,\n        // { ...self.state, ...self.$_state },\n        // isForceUpdate,\n        renderProviders(child, child._ps, [child.o], hooks, contexts, true);\n      });\n      return false;\n    }\n    self.o = nextElement;\n    self.ss(nextState);\n    // render\n    var prevProps = self.ps;\n    if (!isString(nextElement)) {\n      self.ps = nextElement.props;\n      self.ref = nextElement.ref;\n    }\n    setCurrentInstance(this);\n    self.r(hooks, contexts, self.b ? prevProps : {}, nextState);\n    return true;\n  };\n  __proto.md = function () {\n    this.rr();\n  };\n  __proto.ss = function () {\n    return;\n  };\n  __proto.ud = function () {\n    this.rr();\n  };\n  /**\n   * register refs\n   */\n  __proto.rr = function () {\n    var self = this;\n    var ref = self.ref;\n    var fr = self.fr;\n    ref && ref(fr ? fr.current : self.b);\n  };\n  return Provider;\n}();\nfunction getCurrentInstance() {\n  return Object.__CROACT_CURRENT_INSTNACE__;\n}\nfunction getHooksIndex() {\n  return hooksIndex;\n}\nfunction setHooksInex(nextHooksIndex) {\n  hooksIndex = nextHooksIndex;\n}\nfunction setCurrentInstance(provider) {\n  Object.__CROACT_CURRENT_INSTNACE__ = provider;\n  hooksIndex = 0;\n  return provider;\n}\n\nvar Component = /*#__PURE__*/function () {\n  function Component(props, context) {\n    if (props === void 0) {\n      props = {};\n    }\n    this.props = props;\n    this.context = context;\n    this.state = {};\n    this.$_timer = 0;\n    this.$_state = {};\n    this.$_subs = [];\n    this.$_cs = {};\n  }\n  var __proto = Component.prototype;\n  __proto.render = function () {\n    return null;\n  };\n  __proto.shouldComponentUpdate = function (props, state) {\n    return this.props !== props || this.state !== state;\n  };\n  __proto.setState = function (state, callback, isForceUpdate) {\n    var self = this;\n    if (!self.$_timer) {\n      self.$_state = {};\n    }\n    clearTimeout(self.$_timer);\n    self.$_timer = 0;\n    self.$_state = __assign(__assign({}, self.$_state), state);\n    if (!isForceUpdate) {\n      self.$_timer = window.setTimeout(function () {\n        self.$_timer = 0;\n        self.$_setState(callback, isForceUpdate);\n      });\n    } else {\n      self.$_setState(callback, isForceUpdate);\n    }\n    return;\n  };\n  __proto.forceUpdate = function (callback) {\n    this.setState({}, callback, true);\n  };\n  __proto.componentDidMount = function () {};\n  __proto.componentDidUpdate = function (prevProps, prevState) {};\n  __proto.componentWillUnmount = function () {};\n  __proto.$_setState = function (callback, isForceUpdate) {\n    var hooks = [];\n    var provider = this.$_p;\n    var isUpdate = renderProviders(provider.c, [provider], [provider.o], hooks, provider._cs, __assign(__assign({}, this.state), this.$_state), isForceUpdate);\n    if (isUpdate) {\n      if (callback) {\n        hooks.push(callback);\n      }\n      executeHooks(hooks);\n      setCurrentInstance(null);\n    }\n  };\n  return Component;\n}();\nvar PureComponent = /*#__PURE__*/function (_super) {\n  __extends(PureComponent, _super);\n  function PureComponent() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = PureComponent.prototype;\n  __proto.shouldComponentUpdate = function (props, state) {\n    return isDiff(this.props, props) || isDiff(this.state, state);\n  };\n  return PureComponent;\n}(Component);\n\nfunction createRef(defaultValue) {\n  var refCallback = function (e) {\n    refCallback.current = e;\n  };\n  refCallback.current = defaultValue;\n  return refCallback;\n}\nfunction forwardRef(func) {\n  func._fr = true;\n  return func;\n}\n\nfunction createComponent(type, props, contextValue, self) {\n  var _a;\n  var base;\n  if ((_a = type === null || type === void 0 ? void 0 : type.prototype) === null || _a === void 0 ? void 0 : _a.render) {\n    base = new type(props, contextValue);\n  } else {\n    base = new Component(props, contextValue);\n    base.constructor = type;\n    if (type._fr) {\n      self.fr = createRef();\n      base.render = function () {\n        return this.constructor(this.props, self.fr);\n      };\n    } else {\n      base.render = renderFunctionComponent;\n    }\n  }\n  base.$_p = self;\n  return base;\n}\nvar ComponentProvider = /*#__PURE__*/function (_super) {\n  __extends(ComponentProvider, _super);\n  function ComponentProvider(type, depth, key, index, container, ref, props) {\n    if (props === void 0) {\n      props = {};\n    }\n    var _this = _super.call(this, type, depth, key, index, container, ref, fillProps(props, type.defaultProps)) || this;\n    _this.typ = \"comp\";\n    /**\n     * Update shift effects\n     */\n    _this._usefs = [];\n    /**\n     * Update effects\n     */\n    _this._uefs = [];\n    /**\n     * Destroy effects\n     */\n    _this._defs = [];\n    return _this;\n  }\n  var __proto = ComponentProvider.prototype;\n  __proto.s = function (nextProps, nextState) {\n    var base = this.b;\n    return base.shouldComponentUpdate(fillProps(nextProps, this.t.defaultProps), nextState || base.state) !== false;\n  };\n  __proto.r = function (hooks, contexts, prevProps) {\n    var _a, _b;\n    var self = this;\n    var type = self.t;\n    self.ps = fillProps(self.ps, self.t.defaultProps);\n    var props = self.ps;\n    var isMount = !self.b;\n    var contextType = type.contextType;\n    var base = self.b;\n    var contextValue = contextType === null || contextType === void 0 ? void 0 : contextType.get(self);\n    self._cs = contexts;\n    if (isMount) {\n      base = createComponent(type, props, contextValue, self);\n      self.b = base;\n    } else {\n      base.props = props;\n      base.context = contextValue;\n    }\n    var prevState = base.state;\n    self._usefs = [];\n    self._uefs = [];\n    var template = base.render();\n    if (((_b = (_a = template === null || template === void 0 ? void 0 : template.props) === null || _a === void 0 ? void 0 : _a.children) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n      template.props.children = self.ps.children;\n    }\n    var nextContexts = __assign(__assign({}, contexts), base.$_cs);\n    renderProviders(self, self._ps, template ? [template] : [], hooks, nextContexts);\n    if (isMount) {\n      self._uefs.push(function () {\n        contextType === null || contextType === void 0 ? void 0 : contextType.register(self);\n        base.componentDidMount();\n      });\n    } else {\n      self._uefs.push(function () {\n        base.componentDidUpdate(prevProps, prevState);\n      });\n    }\n    hooks.push(function () {\n      self._usefs.forEach(function (ef) {\n        ef();\n      });\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n      self._defs = self._uefs.map(function (ef) {\n        return ef();\n      });\n    });\n  };\n  __proto.ss = function (nextState) {\n    var base = this.b;\n    if (!base || !nextState) {\n      return;\n    }\n    base.state = nextState;\n  };\n  __proto.un = function () {\n    var _a;\n    var self = this;\n    self._ps.forEach(function (provider) {\n      provider.un();\n    });\n    var type = self.t;\n    (_a = type.contextType) === null || _a === void 0 ? void 0 : _a.unregister(self);\n    clearTimeout(self.b.$_timer);\n    self._defs.forEach(function (def) {\n      def && def();\n    });\n    self.b.componentWillUnmount();\n  };\n  return ComponentProvider;\n}(Provider);\n\nfunction diffAttributes(attrs1, attrs2, el) {\n  var _a = diffObject(getAttributes(attrs1), getAttributes(attrs2)),\n    added = _a.added,\n    removed = _a.removed,\n    changed = _a.changed;\n  for (var name_1 in added) {\n    el.setAttribute(name_1, added[name_1]);\n  }\n  for (var name_2 in changed) {\n    el.setAttribute(name_2, changed[name_2][1]);\n  }\n  for (var name_3 in removed) {\n    el.removeAttribute(name_3);\n  }\n}\nfunction diffEvents(events1, events2, provier) {\n  var _a = diffObject(events1, events2),\n    added = _a.added,\n    removed = _a.removed;\n  for (var name_4 in removed) {\n    provier.e(name_4, true);\n  }\n  for (var name_5 in added) {\n    provier.e(name_5);\n  }\n}\nfunction diffObject(a, b) {\n  var keys1 = getKeys(a);\n  var keys2 = getKeys(b);\n  var result = diff(keys1, keys2, function (key) {\n    return key;\n  });\n  var added = {};\n  var removed = {};\n  var changed = {};\n  result.added.forEach(function (index) {\n    var name = keys2[index];\n    added[name] = b[name];\n  });\n  result.removed.forEach(function (index) {\n    var name = keys1[index];\n    removed[name] = a[name];\n  });\n  result.maintained.forEach(function (_a) {\n    var index = _a[0];\n    var name = keys1[index];\n    var values = [a[name], b[name]];\n    if (a[name] !== b[name]) {\n      changed[name] = values;\n    }\n  });\n  return {\n    added: added,\n    removed: removed,\n    changed: changed\n  };\n}\nfunction diffStyle(style1, style2, el) {\n  var style = el.style;\n  var _a = diffObject(style1, style2),\n    added = _a.added,\n    removed = _a.removed,\n    changed = _a.changed;\n  for (var beforeName in added) {\n    var name_6 = decamelize(beforeName, \"-\");\n    style.setProperty(name_6, added[beforeName]);\n  }\n  for (var beforeName in changed) {\n    var name_7 = decamelize(beforeName, \"-\");\n    style.setProperty(name_7, changed[beforeName][1]);\n  }\n  for (var beforeName in removed) {\n    var name_8 = decamelize(beforeName, \"-\");\n    style.removeProperty(name_8);\n  }\n}\nfunction getNativeEventName(name) {\n  return name.replace(/^on/g, \"\").toLowerCase();\n}\nvar ElementProvider = /*#__PURE__*/function (_super) {\n  __extends(ElementProvider, _super);\n  function ElementProvider() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.typ = \"elem\";\n    /**\n     * Events\n     */\n    _this._es = {};\n    /**\n     * is svg\n     */\n    _this._svg = false;\n    return _this;\n  }\n  var __proto = ElementProvider.prototype;\n  __proto.e = function (name, isRemove) {\n    var self = this;\n    var events = self._es;\n    var base = self.b;\n    var eventName = getNativeEventName(name);\n    if (isRemove) {\n      removeEvent(base, eventName, events[name]);\n      delete events[name];\n    } else {\n      events[name] = function (e) {\n        var _a, _b;\n        (_b = (_a = self.ps)[name]) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n      };\n      addEvent(base, eventName, events[name]);\n    }\n  };\n  __proto.s = function (nextProps) {\n    return isDiff(this.ps, nextProps);\n  };\n  __proto.r = function (hooks, contextValues, prevProps) {\n    var _a;\n    var self = this;\n    var isMount = !self.b;\n    var nextProps = self.ps;\n    if (isMount) {\n      var containerNode = findContainerNode(self.c);\n      var isSVG = false;\n      if (self._svg || self.t === \"svg\") {\n        isSVG = true;\n      } else {\n        isSVG = containerNode && containerNode.ownerSVGElement;\n      }\n      self._svg = isSVG;\n      var element = (_a = self._hyd) === null || _a === void 0 ? void 0 : _a.splice(0, 1)[0];\n      var type = self.t;\n      if (element) {\n        self._hyd = [].slice.call(element.children || []);\n      } else {\n        var doc = getDocument(containerNode);\n        if (isSVG) {\n          element = doc.createElementNS(\"http://www.w3.org/2000/svg\", type);\n        } else {\n          element = doc.createElement(type);\n        }\n      }\n      self.b = element;\n    }\n    renderProviders(self, self._ps, nextProps.children, hooks, contextValues);\n    var base = self.b;\n    var _b = splitProps(prevProps),\n      prevAttributes = _b[0],\n      prevEvents = _b[1];\n    var _c = splitProps(nextProps),\n      nextAttributes = _c[0],\n      nextEvents = _c[1];\n    diffAttributes(prevAttributes, nextAttributes, base);\n    diffEvents(prevEvents, nextEvents, self);\n    diffStyle(prevProps.style || {}, nextProps.style || {}, base);\n    hooks.push(function () {\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n    });\n    return true;\n  };\n  __proto.un = function () {\n    var self = this;\n    var events = self._es;\n    var base = self.b;\n    for (var name_9 in events) {\n      removeEvent(base, name_9, events[name_9]);\n    }\n    self._ps.forEach(function (provider) {\n      provider.un();\n    });\n    self._es = {};\n    if (!self._sel) {\n      removeNode(base);\n    }\n  };\n  return ElementProvider;\n}(Provider);\n\nfunction findDOMNode(comp) {\n  if (!comp || isNode(comp)) {\n    return comp;\n  }\n  var providers = comp.$_p._ps;\n  if (!providers.length) {\n    return null;\n  }\n  return findDOMNode(providers[0].b);\n}\nfunction findNodeProvider(provider) {\n  if (!provider) {\n    return;\n  }\n  if (provider.b && isNode(provider.b)) {\n    return provider;\n  }\n  var providers = provider._ps;\n  if (!providers.length) {\n    return null;\n  }\n  return findNodeProvider(providers[0]);\n}\nfunction createElement(type, props) {\n  var children = [];\n  for (var _i = 2; _i < arguments.length; _i++) {\n    children[_i - 2] = arguments[_i];\n  }\n  var _a = props || {},\n    key = _a.key,\n    ref = _a.ref,\n    otherProps = __rest(_a, [\"key\", \"ref\"]);\n  return {\n    type: type,\n    key: key,\n    ref: ref,\n    props: __assign(__assign({}, otherProps), {\n      children: flat$1(children).filter(function (child) {\n        return child != null && child !== false;\n      })\n    })\n  };\n}\n\nvar ContainerProvider = /*#__PURE__*/function (_super) {\n  __extends(ContainerProvider, _super);\n  function ContainerProvider(base, depth) {\n    if (depth === void 0) {\n      depth = 0;\n    }\n    var _this = _super.call(this, \"container\", depth, \"container\", 0, null) || this;\n    _this.typ = \"container\";\n    _this.b = base;\n    return _this;\n  }\n  var __proto = ContainerProvider.prototype;\n  __proto.r = function () {\n    return true;\n  };\n  __proto.un = function () {\n    return;\n  };\n  return ContainerProvider;\n}(Provider);\nvar TextProvider = /*#__PURE__*/function (_super) {\n  __extends(TextProvider, _super);\n  function TextProvider() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.typ = \"text\";\n    return _this;\n  }\n  var __proto = TextProvider.prototype;\n  __proto.r = function (hooks) {\n    var _a;\n    var self = this;\n    var isMount = !self.b;\n    if (isMount) {\n      var containerNode = findContainerNode(self.c);\n      var b = (_a = self._hyd) === null || _a === void 0 ? void 0 : _a.splice(0, 1)[0];\n      self.b = b || getDocument(containerNode).createTextNode(self.t.replace(\"text_\", \"\"));\n    }\n    hooks.push(function () {\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n    });\n    return true;\n  };\n  __proto.un = function () {\n    removeNode(this.b);\n  };\n  return TextProvider;\n}(Provider);\nfunction diffProviders(containerProvider, providers, children) {\n  var childrenKeys = children.map(function (p) {\n    return isString(p) ? null : p.key;\n  });\n  var keys1 = fillKeys(providers.map(function (p) {\n    return p.k;\n  }));\n  var keys2 = fillKeys(childrenKeys);\n  var result = diff(keys1, keys2, function (key) {\n    return key;\n  });\n  result.removed.forEach(function (index) {\n    providers.splice(index, 1)[0].un();\n  });\n  result.ordered.forEach(function (_a) {\n    var from = _a[0],\n      to = _a[1];\n    var childrenProvider = providers.splice(from, 1)[0];\n    providers.splice(to, 0, childrenProvider);\n    var el = findDOMNode(childrenProvider.b);\n    var next = findDOMNode(providers[to + 1] && providers[to + 1].b);\n    if (el) {\n      el.parentNode.insertBefore(el, next);\n    }\n  });\n  result.added.forEach(function (index) {\n    providers.splice(index, 0, createProvider(children[index], childrenKeys[index], index, containerProvider));\n  });\n  var changed = result.maintained.filter(function (_a) {\n    _a[0];\n      var to = _a[1];\n    var el = children[to];\n    var childProvider = providers[to];\n    var type = isString(el) ? \"text_\".concat(el) : el.type;\n    if (type !== childProvider.t) {\n      childProvider.un();\n      providers.splice(to, 1, createProvider(el, childrenKeys[to], to, containerProvider));\n      return true;\n    }\n    childProvider.i = to;\n    return false;\n  });\n  return __spreadArray(__spreadArray([], result.added, true), changed.map(function (_a) {\n    _a[0];\n      var to = _a[1];\n    return to;\n  }), true);\n}\n\nfunction getNextSibiling(provider, childProvider) {\n  var childProviders = provider._ps;\n  var length = childProviders.length;\n  for (var i = childProvider.i + 1; i < length; ++i) {\n    var el = findDOMNode(childProviders[i].b);\n    if (el) {\n      return el;\n    }\n  }\n  return null;\n}\nfunction createProvider(el, key, index, containerProvider) {\n  var depth = containerProvider.d + 1;\n  if (isString(el) || isNumber(el)) {\n    return new TextProvider(\"text_\".concat(el), depth, key, index, containerProvider, null, {});\n  }\n  var type = el.type;\n  var providerClass = typeof type === \"string\" ? ElementProvider : ComponentProvider;\n  return new providerClass(type, depth, key, index, containerProvider, el.ref, el.props);\n}\nfunction renderProviders(containerProvider, providers, children, updatedHooks, nextContexts, nextState, isForceUpdate) {\n  var result = diffProviders(containerProvider, providers, children);\n  var hyd = containerProvider._hyd;\n  var updated = providers.filter(function (childProvider, i) {\n    childProvider._hyd = hyd;\n    return childProvider.u(updatedHooks, nextContexts, children[i], nextState, isForceUpdate);\n  });\n  if (containerProvider.typ === \"container\" && containerProvider._sel) {\n    providers.forEach(function (provider) {\n      var nodeProvider = findNodeProvider(provider);\n      if (nodeProvider) {\n        nodeProvider._sel = true;\n      }\n    });\n  }\n  containerProvider._hyd = null;\n  var containerNode = findContainerNode(containerProvider);\n  if (containerNode) {\n    result.reverse().forEach(function (index) {\n      var childProvider = providers[index];\n      var el = findDOMNode(childProvider.b);\n      if (!el) {\n        return;\n      }\n      if (containerNode !== el && !el.parentNode) {\n        var nextElement = getNextSibiling(containerProvider, childProvider);\n        containerNode.insertBefore(el, nextElement);\n      }\n    });\n  }\n  return updated.length > 0;\n}\nfunction renderProvider(element, container, provider, contexts) {\n  if (provider === void 0) {\n    provider = container.__CROACT__;\n  }\n  if (contexts === void 0) {\n    contexts = {};\n  }\n  var isProvider = !!provider;\n  if (!provider) {\n    provider = new ContainerProvider(container);\n  }\n  var hooks = [];\n  renderProviders(provider, provider._ps, element ? [element] : [], hooks, contexts, undefined, undefined);\n  executeHooks(hooks);\n  setCurrentInstance(null);\n  if (!isProvider) {\n    container.__CROACT__ = provider;\n  }\n  return provider;\n}\nfunction render(element, container, callback) {\n  var provider = container.__CROACT__;\n  if (element && !provider) {\n    container.innerHTML = \"\";\n  }\n  renderProvider(element, container, provider);\n  callback && callback();\n}\nfunction renderSelf(element, self, containerProvider) {\n  if (!containerProvider && element) {\n    containerProvider = new ContainerProvider(self.parentElement);\n    containerProvider._hyd = [self];\n    containerProvider._sel = true;\n  }\n  renderProvider(element, self, containerProvider);\n  return containerProvider;\n}\n\nvar i  = 0;\nfunction createContext(defaultValue) {\n  var id = \"c\".concat(++i);\n  function Provider(props) {\n    var self = this;\n    if (!self.$_cs[id]) {\n      self.$_cs[id] = self;\n      var $_subs = [];\n      self.shouldComponentUpdate = function (nextProps) {\n        if (nextProps.value !== self.props.value) {\n          // request\n          self.$_req = true;\n        }\n      };\n      self.render = function () {\n        return self.props.children[0];\n      };\n      self.$_subs = $_subs;\n    }\n    return props.children[0];\n  }\n  function Consumer(props, contextValue) {\n    return props.children(contextValue);\n  }\n  function getContext(provider) {\n    return provider._cs[id];\n  }\n  var context = {\n    $_id: id,\n    $_dv: defaultValue,\n    Consumer: Consumer,\n    Provider: Provider,\n    get: function (provider) {\n      var _a, _b;\n      return (_b = (_a = getContext(provider)) === null || _a === void 0 ? void 0 : _a.props.value) !== null && _b !== void 0 ? _b : defaultValue;\n    },\n    register: function (provider) {\n      var mainComponent = getContext(provider);\n      if (mainComponent) {\n        pushSet(mainComponent.$_subs, provider);\n      }\n    },\n    unregister: function (provider) {\n      var mainComponent = getContext(provider);\n      if (mainComponent) {\n        var subs = mainComponent.$_subs;\n        var index = subs.indexOf(provider);\n        if (index > -1) {\n          subs.splice(index, 1);\n        }\n      }\n    }\n  };\n  Consumer.contextType = context;\n  return context;\n}\n\nvar Portal = /*#__PURE__*/function (_super) {\n  __extends(Portal, _super);\n  function Portal() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = Portal.prototype;\n  __proto.componentDidMount = function () {\n    var self = this;\n    var _a = self.props,\n      element = _a.element,\n      container = _a.container;\n    var parentProvider = self.$_p;\n    self._pp = new ContainerProvider(container, parentProvider.d + 1);\n    renderProvider(element, container, self._pp, parentProvider._cs);\n  };\n  __proto.componentDidUpdate = function () {\n    var self = this;\n    var _a = self.props,\n      element = _a.element,\n      container = _a.container;\n    renderProvider(element, container, self._pp, self.$_p._cs);\n  };\n  __proto.componentWillUnmount = function () {\n    var self = this;\n    var container = self.props.container;\n    renderProvider(null, container, self._pp, self.$_p._cs);\n    this._pp = null;\n  };\n  return Portal;\n}(PureComponent);\nfunction createPortal(el, container) {\n  return createElement(Portal, {\n    element: el,\n    container: container\n  });\n}\n\nfunction _renderToString(node, parentContexts, self) {\n  if (node == null) {\n    return \"\";\n  }\n  if (isString(node) || isNumber(node) || isFunction(node)) {\n    return node;\n  }\n  var type = node.type,\n    props = node.props;\n  if (isString(type)) {\n    var stringProps_1 = {};\n    getEntries(props).forEach(function (_a) {\n      var name = _a[0],\n        value = _a[1];\n      if (name === \"style\") {\n        stringProps_1[name] = getEntries(value).map(function (_a) {\n          var styleName = _a[0],\n            styleValue = _a[1];\n          return \"\".concat(decamelize(styleName), \": \").concat(styleValue, \";\");\n        }).join(\"\");\n      } else if (name === \"children\") {\n        return;\n      } else if (!name.match(/^on[^a-z]/g)) {\n        stringProps_1[name] = \"\".concat(value);\n      }\n    });\n    var children = props.children.map(function (child) {\n      return _renderToString(child, parentContexts);\n    }).join(\"\");\n    if (self) {\n      return {\n        tagName: type,\n        props: stringProps_1,\n        children: children\n      };\n    }\n    var strings = __spreadArray([type], getEntries(stringProps_1).map(function (_a) {\n      var name = _a[0],\n        value = _a[1];\n      return \"\".concat(name, \"=\\\"\").concat(value.replace(/\"/g, \"\\\\\\\"\"), \"\\\"\");\n    }), true);\n    return \"<\".concat(strings.join(\" \"), \">\").concat(children, \"</\").concat(type, \">\");\n  } else if (isFunction(type)) {\n    var contextType = type.contextType;\n    var provider = {\n      b: null,\n      _hs: [],\n      _usefs: [],\n      _uefs: [],\n      _defs: [],\n      _cs: parentContexts\n    };\n    setCurrentInstance(provider);\n    var contextValue = contextType === null || contextType === void 0 ? void 0 : contextType.get(provider);\n    var base = createComponent(type, props, contextValue, {});\n    var nextContexts = __assign(__assign({}, parentContexts), base.$_cs);\n    provider.b = base;\n    return _renderToString(base.render(), nextContexts, self);\n  }\n  return \"\";\n}\nfunction renderToString(node) {\n  return _renderToString(node, {});\n}\nfunction renderSelfToString(node) {\n  return _renderToString(node, {}, true);\n}\n\nfunction checkHookInfo(info) {\n  var inst = getCurrentInstance();\n  var hooks = inst._hs || (inst._hs = []);\n  var index = getHooksIndex();\n  var prevHt = hooks[index];\n  setHooksInex(index + 1);\n  if (prevHt) {\n    if (!isDiff(prevHt.deps, info.deps)) {\n      prevHt.updated = false;\n      return prevHt;\n    }\n    hooks[index] = info;\n  } else {\n    hooks.push(info);\n  }\n  info.value = info.func();\n  info.updated = true;\n  return info;\n}\nfunction useMemo(defaultFunction, deps) {\n  var info = checkHookInfo({\n    func: defaultFunction,\n    deps: deps\n  });\n  return info.value;\n}\nfunction useRef(defaultValue) {\n  return useMemo(function () {\n    return createRef(defaultValue);\n  }, []);\n}\nfunction useContext(context) {\n  var inst = getCurrentInstance();\n  var contextId = context.$_id;\n  var contexts = inst._cs;\n  var providerComponent;\n  if (contextId in contexts) {\n    providerComponent = contexts[contextId];\n    providerComponent.props.value;\n  } else {\n    context.$_dv;\n  }\n  useEffect(function () {\n    context.register(inst);\n    return function () {\n      context.unregister(inst);\n    };\n  }, []);\n  return context.get(inst);\n}\nfunction useState(st) {\n  var inst = getCurrentInstance();\n  var index = getHooksIndex();\n  var comp = inst.b;\n  checkHookInfo({\n    func: function () {\n      comp.state[index] = isFunction(st) ? st() : st;\n    },\n    deps: []\n  });\n  return [comp.state[index], function (nextValue) {\n    var _a;\n    return comp.setState((_a = {}, _a[index] = nextValue, _a));\n  }];\n}\nfunction useEffect(effect, deps, unshift) {\n  var inst = getCurrentInstance();\n  var info = checkHookInfo({\n    func: function () {\n      return effect;\n    },\n    deps: deps\n  });\n  var effects = unshift ? inst._usefs : inst._uefs;\n  if (info.updated) {\n    effects.push(function () {\n      info.effect && info.effect();\n      info.effect = effect();\n      return info.effect;\n    });\n  } else {\n    effects.push(function () {\n      return info.effect;\n    });\n  }\n}\nfunction useImperativeHandle(ref, func, deps) {\n  useEffect(function () {\n    ref === null || ref === void 0 ? void 0 : ref(func());\n  }, deps, true);\n}\n\nvar version = \"simple-1.0.0\";\n\nexport { Component, ContainerProvider, PureComponent, createContext, createElement, createPortal, createRef, findDOMNode, findNodeProvider, forwardRef, render, renderSelf, renderSelfToString, renderToString, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState, version };\n//# sourceMappingURL=croact.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: @scena/matrix\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/matrix\nversion: 1.1.1\n*/\nimport { throttle, TINY_NUM, average } from '@daybrush/utils';\n\nfunction add(matrix, inverseMatrix, startIndex, fromIndex, n, k) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    var fromX = fromIndex + i * n;\n    matrix[x] += matrix[fromX] * k;\n    inverseMatrix[x] += inverseMatrix[fromX] * k;\n  }\n}\n\nfunction swap(matrix, inverseMatrix, startIndex, fromIndex, n) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    var fromX = fromIndex + i * n;\n    var v = matrix[x];\n    var iv = inverseMatrix[x];\n    matrix[x] = matrix[fromX];\n    matrix[fromX] = v;\n    inverseMatrix[x] = inverseMatrix[fromX];\n    inverseMatrix[fromX] = iv;\n  }\n}\n\nfunction divide(matrix, inverseMatrix, startIndex, n, k) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    matrix[x] /= k;\n    inverseMatrix[x] /= k;\n  }\n}\n/**\n *\n * @namespace Matrix\n */\n\n/**\n * @memberof Matrix\n */\n\n\nfunction ignoreDimension(matrix, m, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = matrix.slice();\n\n  for (var i = 0; i < n; ++i) {\n    newMatrix[i * n + m - 1] = 0;\n    newMatrix[(m - 1) * n + i] = 0;\n  }\n\n  newMatrix[(m - 1) * (n + 1)] = 1;\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction invert(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = matrix.slice();\n  var inverseMatrix = createIdentityMatrix(n);\n\n  for (var i = 0; i < n; ++i) {\n    // diagonal\n    var identityIndex = n * i + i;\n\n    if (!throttle(newMatrix[identityIndex], TINY_NUM)) {\n      // newMatrix[identityIndex] = 0;\n      for (var j = i + 1; j < n; ++j) {\n        if (newMatrix[n * i + j]) {\n          swap(newMatrix, inverseMatrix, i, j, n);\n          break;\n        }\n      }\n    }\n\n    if (!throttle(newMatrix[identityIndex], TINY_NUM)) {\n      // no inverse matrix\n      return [];\n    }\n\n    divide(newMatrix, inverseMatrix, i, n, newMatrix[identityIndex]);\n\n    for (var j = 0; j < n; ++j) {\n      var targetStartIndex = j;\n      var targetIndex = j + i * n;\n      var target = newMatrix[targetIndex];\n\n      if (!throttle(target, TINY_NUM) || i === j) {\n        continue;\n      }\n\n      add(newMatrix, inverseMatrix, targetStartIndex, i, n, -target);\n    }\n  }\n\n  return inverseMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction transpose(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = [];\n\n  for (var i = 0; i < n; ++i) {\n    for (var j = 0; j < n; ++j) {\n      newMatrix[j * n + i] = matrix[n * i + j];\n    }\n  }\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction getOrigin(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var originMatrix = [];\n  var w = matrix[n * n - 1];\n\n  for (var i = 0; i < n - 1; ++i) {\n    originMatrix[i] = matrix[n * (n - 1) + i] / w;\n  }\n\n  originMatrix[n - 1] = 0;\n  return originMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction fromTranslation(pos, n) {\n  var newMatrix = createIdentityMatrix(n);\n\n  for (var i = 0; i < n - 1; ++i) {\n    newMatrix[n * (n - 1) + i] = pos[i] || 0;\n  }\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertPositionMatrix(matrix, n) {\n  var newMatrix = matrix.slice();\n\n  for (var i = matrix.length; i < n - 1; ++i) {\n    newMatrix[i] = 0;\n  }\n\n  newMatrix[n - 1] = 1;\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertDimension(matrix, n, m) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  } // n < m\n\n\n  if (n === m) {\n    return matrix;\n  }\n\n  var newMatrix = createIdentityMatrix(m);\n  var length = Math.min(n, m);\n\n  for (var i = 0; i < length - 1; ++i) {\n    for (var j = 0; j < length - 1; ++j) {\n      newMatrix[i * m + j] = matrix[i * n + j];\n    }\n\n    newMatrix[(i + 1) * m - 1] = matrix[(i + 1) * n - 1];\n    newMatrix[(m - 1) * m + i] = matrix[(n - 1) * n + i];\n  }\n\n  newMatrix[m * m - 1] = matrix[n * n - 1];\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction multiplies(n) {\n  var matrixes = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    matrixes[_i - 1] = arguments[_i];\n  }\n\n  var m = createIdentityMatrix(n);\n  matrixes.forEach(function (matrix) {\n    m = multiply(m, matrix, n);\n  });\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction multiply(matrix, matrix2, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = []; // 1 y: n\n  // 1 x: m\n  // 2 x: m\n  // 2 y: k\n  // n * m X m * k\n\n  var m = matrix.length / n;\n  var k = matrix2.length / m;\n\n  if (!m) {\n    return matrix2;\n  } else if (!k) {\n    return matrix;\n  }\n\n  for (var i = 0; i < n; ++i) {\n    for (var j = 0; j < k; ++j) {\n      newMatrix[j * n + i] = 0;\n\n      for (var l = 0; l < m; ++l) {\n        // m1 x: m(l), y: n(i)\n        // m2 x: k(j):  y: m(l)\n        // nw x: n(i), y: k(j)\n        newMatrix[j * n + i] += matrix[l * n + i] * matrix2[j * m + l];\n      }\n    }\n  } // n * k\n\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction plus(pos1, pos2) {\n  var length = Math.min(pos1.length, pos2.length);\n  var nextPos = pos1.slice();\n\n  for (var i = 0; i < length; ++i) {\n    nextPos[i] = nextPos[i] + pos2[i];\n  }\n\n  return nextPos;\n}\n/**\n * @memberof Matrix\n */\n\nfunction minus(pos1, pos2) {\n  var length = Math.min(pos1.length, pos2.length);\n  var nextPos = pos1.slice();\n\n  for (var i = 0; i < length; ++i) {\n    nextPos[i] = nextPos[i] - pos2[i];\n  }\n\n  return nextPos;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertCSStoMatrix(a, is2d) {\n  if (is2d === void 0) {\n    is2d = a.length === 6;\n  }\n\n  if (is2d) {\n    return [a[0], a[1], 0, a[2], a[3], 0, a[4], a[5], 1];\n  }\n\n  return a;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertMatrixtoCSS(a, is2d) {\n  if (is2d === void 0) {\n    is2d = a.length === 9;\n  }\n\n  if (is2d) {\n    return [a[0], a[1], a[3], a[4], a[6], a[7]];\n  }\n\n  return a;\n}\n/**\n * @memberof Matrix\n */\n\nfunction calculate(matrix, matrix2, n) {\n  if (n === void 0) {\n    n = matrix2.length;\n  }\n\n  var result = multiply(matrix, matrix2, n);\n  var k = result[n - 1];\n  return result.map(function (v) {\n    return v / k;\n  });\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateX3d(matrix, rad) {\n  return multiply(matrix, [1, 0, 0, 0, 0, Math.cos(rad), Math.sin(rad), 0, 0, -Math.sin(rad), Math.cos(rad), 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateY3d(matrix, rad) {\n  return multiply(matrix, [Math.cos(rad), 0, -Math.sin(rad), 0, 0, 1, 0, 0, Math.sin(rad), 0, Math.cos(rad), 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateZ3d(matrix, rad) {\n  return multiply(matrix, createRotateMatrix(rad, 4));\n}\n/**\n * @memberof Matrix\n */\n\nfunction scale3d(matrix, _a) {\n  var _b = _a[0],\n      sx = _b === void 0 ? 1 : _b,\n      _c = _a[1],\n      sy = _c === void 0 ? 1 : _c,\n      _d = _a[2],\n      sz = _d === void 0 ? 1 : _d;\n  return multiply(matrix, [sx, 0, 0, 0, 0, sy, 0, 0, 0, 0, sz, 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotate(pos, rad) {\n  return calculate(createRotateMatrix(rad, 3), convertPositionMatrix(pos, 3));\n}\n/**\n * @memberof Matrix\n */\n\nfunction translate3d(matrix, _a) {\n  var _b = _a[0],\n      tx = _b === void 0 ? 0 : _b,\n      _c = _a[1],\n      ty = _c === void 0 ? 0 : _c,\n      _d = _a[2],\n      tz = _d === void 0 ? 0 : _d;\n  return multiply(matrix, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, tx, ty, tz, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction matrix3d(matrix1, matrix2) {\n  return multiply(matrix1, matrix2, 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction createRotateMatrix(rad, n) {\n  var cos = Math.cos(rad);\n  var sin = Math.sin(rad);\n  var m = createIdentityMatrix(n); // cos -sin\n  // sin cos\n\n  m[0] = cos;\n  m[1] = sin;\n  m[n] = -sin;\n  m[n + 1] = cos;\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createIdentityMatrix(n) {\n  var length = n * n;\n  var matrix = [];\n\n  for (var i = 0; i < length; ++i) {\n    matrix[i] = i % (n + 1) ? 0 : 1;\n  }\n\n  return matrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createScaleMatrix(scale, n) {\n  var m = createIdentityMatrix(n);\n  var length = Math.min(scale.length, n - 1);\n\n  for (var i = 0; i < length; ++i) {\n    m[(n + 1) * i] = scale[i];\n  }\n\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createOriginMatrix(origin, n) {\n  var m = createIdentityMatrix(n);\n  var length = Math.min(origin.length, n - 1);\n\n  for (var i = 0; i < length; ++i) {\n    m[n * (n - 1) + i] = origin[i];\n  }\n\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createWarpMatrix(pos0, pos1, pos2, pos3, nextPos0, nextPos1, nextPos2, nextPos3) {\n  var x0 = pos0[0],\n      y0 = pos0[1];\n  var x1 = pos1[0],\n      y1 = pos1[1];\n  var x2 = pos2[0],\n      y2 = pos2[1];\n  var x3 = pos3[0],\n      y3 = pos3[1];\n  var u0 = nextPos0[0],\n      v0 = nextPos0[1];\n  var u1 = nextPos1[0],\n      v1 = nextPos1[1];\n  var u2 = nextPos2[0],\n      v2 = nextPos2[1];\n  var u3 = nextPos3[0],\n      v3 = nextPos3[1];\n  var matrix = [x0, 0, x1, 0, x2, 0, x3, 0, y0, 0, y1, 0, y2, 0, y3, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, x0, 0, x1, 0, x2, 0, x3, 0, y0, 0, y1, 0, y2, 0, y3, 0, 1, 0, 1, 0, 1, 0, 1, -u0 * x0, -v0 * x0, -u1 * x1, -v1 * x1, -u2 * x2, -v2 * x2, -u3 * x3, -v3 * x3, -u0 * y0, -v0 * y0, -u1 * y1, -v1 * y1, -u2 * y2, -v2 * y2, -u3 * y3, -v3 * y3];\n  var inverseMatrix = invert(matrix, 8);\n\n  if (!inverseMatrix.length) {\n    return [];\n  }\n\n  var h = multiply(inverseMatrix, [u0, v0, u1, v1, u2, v2, u3, v3], 8);\n  h[8] = 1;\n  return convertDimension(transpose(h), 3, 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction getCenter(points) {\n  return [0, 1].map(function (i) {\n    return average(points.map(function (pos) {\n      return pos[i];\n    }));\n  });\n}\n\nexport { calculate, convertCSStoMatrix, convertDimension, convertMatrixtoCSS, convertPositionMatrix, createIdentityMatrix, createOriginMatrix, createRotateMatrix, createScaleMatrix, createWarpMatrix, fromTranslation, getCenter, getOrigin, ignoreDimension, invert, matrix3d, minus, multiplies, multiply, plus, rotate, rotateX3d, rotateY3d, rotateZ3d, scale3d, translate3d, transpose };\n//# sourceMappingURL=matrix.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: css-to-mat\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-to-mat.git\nversion: 1.1.0\n*/\nimport { isArray, splitSpace, splitBracket, isObject, splitComma, convertUnitSize, splitUnit } from '@daybrush/utils';\nimport { calculate, matrix3d, invert, translate3d, scale3d, rotateZ3d, rotateX3d, rotateY3d } from '@scena/matrix';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction createMatrix() {\n    return [\n        1, 0, 0, 0,\n        0, 1, 0, 0,\n        0, 0, 1, 0,\n        0, 0, 0, 1,\n    ];\n}\nfunction parseMat(transform, size) {\n    if (size === void 0) { size = 0; }\n    return toMat(parse(transform, size));\n}\nfunction getElementMatrix(el) {\n    return parseMat(getComputedStyle(el).transform);\n}\nfunction calculateMatrixDist(matrix, pos) {\n    var res = calculate(matrix, [pos[0], pos[1] || 0, pos[2] || 0, 1], 4);\n    var w = res[3] || 1;\n    return [\n        res[0] / w,\n        res[1] / w,\n        res[2] / w,\n    ];\n}\nfunction getDistElementMatrix(el, container) {\n    if (container === void 0) { container = document.body; }\n    var target = el;\n    var matrix = createMatrix();\n    while (target) {\n        var transform = getComputedStyle(target).transform;\n        matrix = matrix3d(parseMat(transform), matrix);\n        if (target === container) {\n            break;\n        }\n        target = target.parentElement;\n    }\n    matrix = invert(matrix, 4);\n    matrix[12] = 0;\n    matrix[13] = 0;\n    matrix[14] = 0;\n    return matrix;\n}\nfunction toMat(matrixInfos) {\n    var target = createMatrix();\n    matrixInfos.forEach(function (info) {\n        var matrixFunction = info.matrixFunction, functionValue = info.functionValue;\n        if (!matrixFunction) {\n            return;\n        }\n        target = matrixFunction(target, functionValue);\n    });\n    return target;\n}\nfunction parse(transform, size) {\n    if (size === void 0) { size = 0; }\n    var transforms = isArray(transform) ? transform : splitSpace(transform);\n    return transforms.map(function (t) {\n        var _a = splitBracket(t), name = _a.prefix, value = _a.value;\n        var matrixFunction = null;\n        var functionName = name;\n        var functionValue = \"\";\n        if (name === \"translate\" || name === \"translateX\" || name === \"translate3d\") {\n            var nextSize_1 = isObject(size) ? __assign(__assign({}, size), { \"o%\": size[\"%\"] }) : {\n                \"%\": size,\n                \"o%\": size,\n            };\n            var _b = splitComma(value).map(function (v, i) {\n                if (i === 0 && \"x%\" in nextSize_1) {\n                    nextSize_1[\"%\"] = size[\"x%\"];\n                }\n                else if (i === 1 && \"y%\" in nextSize_1) {\n                    nextSize_1[\"%\"] = size[\"y%\"];\n                }\n                else {\n                    nextSize_1[\"%\"] = size[\"o%\"];\n                }\n                return convertUnitSize(v, nextSize_1);\n            }), posX = _b[0], _c = _b[1], posY = _c === void 0 ? 0 : _c, _d = _b[2], posZ = _d === void 0 ? 0 : _d;\n            matrixFunction = translate3d;\n            functionValue = [posX, posY, posZ];\n        }\n        else if (name === \"translateY\") {\n            var nextSize = isObject(size) ? __assign({ \"%\": size[\"y%\"] }, size) : {\n                \"%\": size,\n            };\n            var posY = convertUnitSize(value, nextSize);\n            matrixFunction = translate3d;\n            functionValue = [0, posY, 0];\n        }\n        else if (name === \"translateZ\") {\n            var posZ = parseFloat(value);\n            matrixFunction = translate3d;\n            functionValue = [0, 0, posZ];\n        }\n        else if (name === \"scale\" || name === \"scale3d\") {\n            var _e = splitComma(value).map(function (v) { return parseFloat(v); }), sx = _e[0], _f = _e[1], sy = _f === void 0 ? sx : _f, _g = _e[2], sz = _g === void 0 ? 1 : _g;\n            matrixFunction = scale3d;\n            functionValue = [sx, sy, sz];\n        }\n        else if (name === \"scaleX\") {\n            var sx = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [sx, 1, 1];\n        }\n        else if (name === \"scaleY\") {\n            var sy = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [1, sy, 1];\n        }\n        else if (name === \"scaleZ\") {\n            var sz = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [1, 1, sz];\n        }\n        else if (name === \"rotate\" || name === \"rotateZ\" || name === \"rotateX\" || name === \"rotateY\") {\n            var _h = splitUnit(value), unit = _h.unit, unitValue = _h.value;\n            var rad = unit === \"rad\" ? unitValue : unitValue * Math.PI / 180;\n            if (name === \"rotate\" || name === \"rotateZ\") {\n                functionName = \"rotateZ\";\n                matrixFunction = rotateZ3d;\n            }\n            else if (name === \"rotateX\") {\n                matrixFunction = rotateX3d;\n            }\n            else if (name === \"rotateY\") {\n                matrixFunction = rotateY3d;\n            }\n            functionValue = rad;\n        }\n        else if (name === \"matrix3d\") {\n            matrixFunction = matrix3d;\n            functionValue = splitComma(value).map(function (v) { return parseFloat(v); });\n        }\n        else if (name === \"matrix\") {\n            var m = splitComma(value).map(function (v) { return parseFloat(v); });\n            matrixFunction = matrix3d;\n            functionValue = [\n                m[0], m[1], 0, 0,\n                m[2], m[3], 0, 0,\n                0, 0, 1, 0,\n                m[4], m[5], 0, 1,\n            ];\n        }\n        else {\n            functionName = \"\";\n        }\n        return {\n            name: name,\n            functionName: functionName,\n            value: value,\n            matrixFunction: matrixFunction,\n            functionValue: functionValue,\n        };\n    });\n}\n\nexport { calculateMatrixDist, createMatrix, getDistElementMatrix, getElementMatrix, parse, parseMat, toMat };\n//# sourceMappingURL=css-to-mat.esm.js.map\n","/*\nCopyright (c) 2019-present NAVER Corp.\nname: @egjs/children-differ\nlicense: MIT\nauthor: NAVER Corp.\nrepository: https://github.com/naver/egjs-children-differ\nversion: 1.0.1\n*/\nimport ListDiffer, { diff as diff$1 } from '@egjs/list-differ';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar findKeyCallback = typeof Map === \"function\" ? undefined : function () {\n  var childrenCount = 0;\n  return function (el) {\n    return el.__DIFF_KEY__ || (el.__DIFF_KEY__ = ++childrenCount);\n  };\n}();\n\n/**\n * A module that checks diff when child are added, removed, or changed .\n * @ko           .\n * @memberof eg\n * @extends eg.ListDiffer\n */\n\nvar ChildrenDiffer =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(ChildrenDiffer, _super);\n  /**\n   * @param - Initializing Children <ko>    </ko>\n   */\n\n\n  function ChildrenDiffer(list) {\n    if (list === void 0) {\n      list = [];\n    }\n\n    return _super.call(this, list, findKeyCallback) || this;\n  }\n\n  return ChildrenDiffer;\n}(ListDiffer);\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n/**\n *\n * @memberof eg.ChildrenDiffer\n * @static\n * @function\n * @param - Previous List <ko>   </ko>\n * @param - List to Update <ko>    </ko>\n * @return - Returns the diff between `prevList` and `list` <ko> `prevList` `list`   .</ko>\n * @example\n * import { diff } from \"@egjs/children-differ\";\n * // script => eg.ChildrenDiffer.diff\n * const result = diff([0, 1, 2, 3, 4, 5], [7, 8, 0, 4, 3, 6, 2, 1]);\n * // List before update\n * // [1, 2, 3, 4, 5]\n * console.log(result.prevList);\n * // Updated list\n * // [4, 3, 6, 2, 1]\n * console.log(result.list);\n * // Index array of values added to `list`\n * // [0, 1, 5]\n * console.log(result.added);\n * // Index array of values removed in `prevList`\n * // [5]\n * console.log(result.removed);\n * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.changed);\n * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n * // [[4, 3], [3, 4], [2, 6]]\n * console.log(result.pureChanged);\n * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n * // [[4, 1], [4, 2], [4, 3]]\n * console.log(result.ordered);\n * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.maintained);\n */\n\nfunction diff(prevList, list) {\n  return diff$1(prevList, list, findKeyCallback);\n}\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nexport default ChildrenDiffer;\nexport { diff };\n//# sourceMappingURL=children-differ.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: @scena/dragscroll\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/dragscroll.git\nversion: 1.4.0\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport { now, isString, isFunction } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\n\nfunction getDefaultScrollPosition(e) {\n  var container = e.container;\n  if (container === document.body) {\n    return [container.scrollLeft || document.documentElement.scrollLeft, container.scrollTop || document.documentElement.scrollTop];\n  }\n  return [container.scrollLeft, container.scrollTop];\n}\nfunction checkDefaultScrollEvent(container, callback) {\n  container.addEventListener(\"scroll\", callback);\n  return function () {\n    container.removeEventListener(\"scroll\", callback);\n  };\n}\nfunction getContainerElement(container) {\n  if (!container) {\n    return null;\n  } else if (isString(container)) {\n    return document.querySelector(container);\n  }\n  if (isFunction(container)) {\n    return container();\n  } else if (container instanceof Element) {\n    return container;\n  } else if (\"current\" in container) {\n    return container.current;\n  } else if (\"value\" in container) {\n    return container.value;\n  }\n}\n/**\n * @sort 1\n */\nvar DragScroll = /*#__PURE__*/function (_super) {\n  __extends(DragScroll, _super);\n  function DragScroll() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this._startRect = null;\n    _this._startPos = [];\n    _this._prevTime = 0;\n    _this._timer = 0;\n    _this._prevScrollPos = [0, 0];\n    _this._isWait = false;\n    _this._flag = false;\n    _this._currentOptions = null;\n    _this._lock = false;\n    _this._unregister = null;\n    _this._onScroll = function () {\n      var options = _this._currentOptions;\n      if (_this._lock || !options) {\n        return;\n      }\n      _this.emit(\"scrollDrag\", {\n        next: function (inputEvent) {\n          _this.checkScroll({\n            container: options.container,\n            inputEvent: inputEvent\n          });\n        }\n      });\n    };\n    return _this;\n  }\n  /**\n   */\n  var __proto = DragScroll.prototype;\n  __proto.dragStart = function (e, options) {\n    var container = getContainerElement(options.container);\n    if (!container) {\n      this._flag = false;\n      return;\n    }\n    var top = 0;\n    var left = 0;\n    var width = 0;\n    var height = 0;\n    if (container === document.body) {\n      width = window.innerWidth;\n      height = window.innerHeight;\n    } else {\n      var rect = container.getBoundingClientRect();\n      top = rect.top;\n      left = rect.left;\n      width = rect.width;\n      height = rect.height;\n    }\n    this._flag = true;\n    this._startPos = [e.clientX, e.clientY];\n    this._startRect = {\n      top: top,\n      left: left,\n      width: width,\n      height: height\n    };\n    this._prevScrollPos = this._getScrollPosition([0, 0], options);\n    this._currentOptions = options;\n    this._registerScrollEvent(options);\n  };\n  __proto.drag = function (e, options) {\n    clearTimeout(this._timer);\n    if (!this._flag) {\n      return;\n    }\n    var clientX = e.clientX,\n      clientY = e.clientY;\n    var _a = options.threshold,\n      threshold = _a === void 0 ? 0 : _a;\n    var _b = this,\n      _startRect = _b._startRect,\n      _startPos = _b._startPos;\n    this._currentOptions = options;\n    var direction = [0, 0];\n    if (_startRect.top > clientY - threshold) {\n      if (_startPos[1] > _startRect.top || clientY < _startPos[1]) {\n        direction[1] = -1;\n      }\n    } else if (_startRect.top + _startRect.height < clientY + threshold) {\n      if (_startPos[1] < _startRect.top + _startRect.height || clientY > _startPos[1]) {\n        direction[1] = 1;\n      }\n    }\n    if (_startRect.left > clientX - threshold) {\n      if (_startPos[0] > _startRect.left || clientX < _startPos[0]) {\n        direction[0] = -1;\n      }\n    } else if (_startRect.left + _startRect.width < clientX + threshold) {\n      if (_startPos[0] < _startRect.left + _startRect.width || clientX > _startPos[0]) {\n        direction[0] = 1;\n      }\n    }\n    if (!direction[0] && !direction[1]) {\n      return false;\n    }\n    return this._continueDrag(__assign(__assign({}, options), {\n      direction: direction,\n      inputEvent: e,\n      isDrag: true\n    }));\n  };\n  /**\n   */\n  __proto.checkScroll = function (options) {\n    var _this = this;\n    if (this._isWait) {\n      return false;\n    }\n    var _a = options.prevScrollPos,\n      prevScrollPos = _a === void 0 ? this._prevScrollPos : _a,\n      direction = options.direction,\n      _b = options.throttleTime,\n      throttleTime = _b === void 0 ? 0 : _b,\n      inputEvent = options.inputEvent,\n      isDrag = options.isDrag;\n    var nextScrollPos = this._getScrollPosition(direction || [0, 0], options);\n    var offsetX = nextScrollPos[0] - prevScrollPos[0];\n    var offsetY = nextScrollPos[1] - prevScrollPos[1];\n    var nextDirection = direction || [offsetX ? Math.abs(offsetX) / offsetX : 0, offsetY ? Math.abs(offsetY) / offsetY : 0];\n    this._prevScrollPos = nextScrollPos;\n    this._lock = false;\n    if (!offsetX && !offsetY) {\n      return false;\n    }\n    /**\n     * @event DragScroll#move\n     */\n    this.emit(\"move\", {\n      offsetX: nextDirection[0] ? offsetX : 0,\n      offsetY: nextDirection[1] ? offsetY : 0,\n      inputEvent: inputEvent\n    });\n    if (throttleTime && isDrag) {\n      clearTimeout(this._timer);\n      this._timer = window.setTimeout(function () {\n        _this._continueDrag(options);\n      }, throttleTime);\n    }\n    return true;\n  };\n  /**\n   *\n   */\n  __proto.dragEnd = function () {\n    this._flag = false;\n    this._lock = false;\n    clearTimeout(this._timer);\n    this._unregisterScrollEvent();\n  };\n  __proto._getScrollPosition = function (direction, options) {\n    var container = options.container,\n      _a = options.getScrollPosition,\n      getScrollPosition = _a === void 0 ? getDefaultScrollPosition : _a;\n    return getScrollPosition({\n      container: getContainerElement(container),\n      direction: direction\n    });\n  };\n  __proto._continueDrag = function (options) {\n    var _this = this;\n    var _a;\n    var container = options.container,\n      direction = options.direction,\n      throttleTime = options.throttleTime,\n      useScroll = options.useScroll,\n      isDrag = options.isDrag,\n      inputEvent = options.inputEvent;\n    if (!this._flag || isDrag && this._isWait) {\n      return;\n    }\n    var nowTime = now();\n    var distTime = Math.max(throttleTime + this._prevTime - nowTime, 0);\n    if (distTime > 0) {\n      clearTimeout(this._timer);\n      this._timer = window.setTimeout(function () {\n        _this._continueDrag(options);\n      }, distTime);\n      return false;\n    }\n    this._prevTime = nowTime;\n    var prevScrollPos = this._getScrollPosition(direction, options);\n    this._prevScrollPos = prevScrollPos;\n    if (isDrag) {\n      this._isWait = true;\n    }\n    // unregister native scroll event\n    if (!useScroll) {\n      this._lock = true;\n    }\n    var param = {\n      container: getContainerElement(container),\n      direction: direction,\n      inputEvent: inputEvent\n    };\n    (_a = options.requestScroll) === null || _a === void 0 ? void 0 : _a.call(options, param);\n    /**\n     * @event DragScroll#scroll\n     */\n    this.emit(\"scroll\", param);\n    this._isWait = false;\n    return useScroll || this.checkScroll(__assign(__assign({}, options), {\n      prevScrollPos: prevScrollPos,\n      direction: direction,\n      inputEvent: inputEvent\n    }));\n  };\n  __proto._registerScrollEvent = function (options) {\n    this._unregisterScrollEvent();\n    var checkScrollEvent = options.checkScrollEvent;\n    if (!checkScrollEvent) {\n      return;\n    }\n    var callback = checkScrollEvent === true ? checkDefaultScrollEvent : checkScrollEvent;\n    var container = getContainerElement(options.container);\n    if (checkScrollEvent === true && (container === document.body || container === document.documentElement)) {\n      this._unregister = checkDefaultScrollEvent(window, this._onScroll);\n    } else {\n      this._unregister = callback(container, this._onScroll);\n    }\n  };\n  __proto._unregisterScrollEvent = function () {\n    var _a;\n    (_a = this._unregister) === null || _a === void 0 ? void 0 : _a.call(this);\n    this._unregister = null;\n  };\n  return DragScroll;\n}(EventEmitter);\n\nexport default DragScroll;\n//# sourceMappingURL=dragscroll.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: overlap-area\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/overlap-area.git\nversion: 1.1.0\n*/\nimport { throttle, TINY_NUM, sum, find, getDist, getShapeDirection, findIndex } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\nfunction tinyThrottle(num) {\n  return throttle(num, TINY_NUM);\n}\nfunction isSameConstants(linearConstants1, linearConstants2) {\n  return linearConstants1.every(function (v, i) {\n    return tinyThrottle(v - linearConstants2[i]) === 0;\n  });\n}\nfunction isSamePoint(point1, point2) {\n  return !tinyThrottle(point1[0] - point2[0]) && !tinyThrottle(point1[1] - point2[1]);\n}\nfunction flat(arr) {\n  return arr.reduce(function (prev, current) {\n    prev.push.apply(prev, current);\n    return prev;\n  }, []);\n}\n\n/**\n * @namespace OverlapArea\n */\n\n/**\n * Gets the size of a shape (polygon) made of points.\n * @memberof OverlapArea\n */\n\nfunction getAreaSize(points) {\n  if (points.length < 3) {\n    return 0;\n  }\n\n  return Math.abs(sum(points.map(function (point, i) {\n    var nextPoint = points[i + 1] || points[0];\n    return point[0] * nextPoint[1] - nextPoint[0] * point[1];\n  }))) / 2;\n}\n/**\n * Get points that fit the rect,\n * @memberof OverlapArea\n */\n\nfunction fitPoints(points, rect) {\n  var width = rect.width,\n      height = rect.height,\n      left = rect.left,\n      top = rect.top;\n\n  var _a = getMinMaxs(points),\n      minX = _a.minX,\n      minY = _a.minY,\n      maxX = _a.maxX,\n      maxY = _a.maxY;\n\n  var ratioX = width / (maxX - minX);\n  var ratioY = height / (maxY - minY);\n  return points.map(function (point) {\n    return [left + (point[0] - minX) * ratioX, top + (point[1] - minY) * ratioY];\n  });\n}\n/**\n * Get the minimum and maximum points of the points.\n * @memberof OverlapArea\n */\n\nfunction getMinMaxs(points) {\n  var xs = points.map(function (point) {\n    return point[0];\n  });\n  var ys = points.map(function (point) {\n    return point[1];\n  });\n  return {\n    minX: Math.min.apply(Math, xs),\n    minY: Math.min.apply(Math, ys),\n    maxX: Math.max.apply(Math, xs),\n    maxY: Math.max.apply(Math, ys)\n  };\n}\n/**\n * Whether the point is in shape\n * @param - point pos\n * @param - shape points\n * @param - whether to check except line\n * @memberof OverlapArea\n */\n\nfunction isInside(pos, points, excludeLine) {\n  var x = pos[0],\n      y = pos[1];\n\n  var _a = getMinMaxs(points),\n      minX = _a.minX,\n      maxX = _a.maxX;\n\n  var xLine = [[minX, y], [maxX, y]];\n  var xLinearConstants = getLinearConstants(xLine[0], xLine[1]);\n  var lines = convertLines(points);\n  var intersectionPosInfos = [];\n  lines.forEach(function (line) {\n    var linearConstants = getLinearConstants(line[0], line[1]);\n    var standardPoint = line[0];\n\n    if (isSameConstants(xLinearConstants, linearConstants)) {\n      intersectionPosInfos.push({\n        pos: pos,\n        line: line,\n        type: \"line\"\n      });\n    } else {\n      var xPoints = getPointsOnLines(getIntersectionPointsByConstants(xLinearConstants, linearConstants), [xLine, line]);\n      xPoints.forEach(function (point) {\n        if (line.some(function (linePoint) {\n          return isSamePoint(linePoint, point);\n        })) {\n          intersectionPosInfos.push({\n            pos: point,\n            line: line,\n            type: \"point\"\n          });\n        } else if (tinyThrottle(standardPoint[1] - y) !== 0) {\n          intersectionPosInfos.push({\n            pos: point,\n            line: line,\n            type: \"intersection\"\n          });\n        }\n      });\n    }\n  });\n\n  if (!excludeLine) {\n    // on line\n    if (find(intersectionPosInfos, function (p) {\n      return p[0] === x;\n    })) {\n      return true;\n    }\n  }\n\n  var intersectionCount = 0;\n  var xMap = {};\n  intersectionPosInfos.forEach(function (_a) {\n    var pos = _a.pos,\n        type = _a.type,\n        line = _a.line;\n\n    if (pos[0] > x) {\n      return;\n    }\n\n    if (type === \"intersection\") {\n      ++intersectionCount;\n    } else if (type === \"line\") {\n      return;\n    } else if (type === \"point\") {\n      var point = find(line, function (linePoint) {\n        return linePoint[1] !== y;\n      });\n      var prevValue = xMap[pos[0]];\n      var nextValue = point[1] > y ? 1 : -1;\n\n      if (!prevValue) {\n        xMap[pos[0]] = nextValue;\n      } else if (prevValue !== nextValue) {\n        ++intersectionCount;\n      }\n    }\n  });\n  return intersectionCount % 2 === 1;\n}\n/**\n * Get distance from point to constants. [a, b, c] (ax + by + c = 0)\n * @return [a, b, c]\n * @memberof OverlapArea\n */\n\nfunction getDistanceFromPointToConstants(_a, pos) {\n  var a = _a[0],\n      b = _a[1],\n      c = _a[2];\n  return (a * pos[0] + b * pos[1] + c) / (a * a + b * b);\n}\n/**\n * Get the coefficient of the linear function. [a, b, c] (ax + by + c = 0)\n * @return [a, b, c]\n * @memberof OverlapArea\n */\n\nfunction getLinearConstants(point1, point2) {\n  var x1 = point1[0],\n      y1 = point1[1];\n  var x2 = point2[0],\n      y2 = point2[1]; // ax + by + c = 0\n  // [a, b, c]\n\n  var dx = x2 - x1;\n  var dy = y2 - y1;\n\n  if (Math.abs(dx) < TINY_NUM) {\n    dx = 0;\n  }\n\n  if (Math.abs(dy) < TINY_NUM) {\n    dy = 0;\n  } // b > 0\n  // ax + by + c = 0\n\n\n  var a = 0;\n  var b = 0;\n  var c = 0;\n\n  if (!dx) {\n    if (dy) {\n      // -x + 1 = 0\n      a = -1;\n      c = x1;\n    }\n  } else if (!dy) {\n    // y - 1 = 0\n    b = 1;\n    c = -y1;\n  } else {\n    // y = -a(x - x1) + y1\n    // ax + y + a * x1 - y1 = 0\n    a = -dy / dx;\n    b = 1;\n    c = -a * x1 - y1;\n  }\n\n  return [a, b, c];\n}\n/**\n * Get intersection points with linear functions.\n * @memberof OverlapArea\n */\n\nfunction getIntersectionPointsByConstants(linearConstants1, linearConstants2) {\n  var a1 = linearConstants1[0],\n      b1 = linearConstants1[1],\n      c1 = linearConstants1[2];\n  var a2 = linearConstants2[0],\n      b2 = linearConstants2[1],\n      c2 = linearConstants2[2];\n  var isZeroA = a1 === 0 && a2 === 0;\n  var isZeroB = b1 === 0 && b2 === 0;\n  var results = [];\n\n  if (isZeroA && isZeroB) {\n    return [];\n  } else if (isZeroA) {\n    // b1 * y + c1 = 0\n    // b2 * y + c2 = 0\n    var y1 = -c1 / b1;\n    var y2 = -c2 / b2;\n\n    if (y1 !== y2) {\n      return [];\n    } else {\n      return [[-Infinity, y1], [Infinity, y1]];\n    }\n  } else if (isZeroB) {\n    // a1 * x + c1 = 0\n    // a2 * x + c2 = 0\n    var x1 = -c1 / a1;\n    var x2 = -c2 / a2;\n\n    if (x1 !== x2) {\n      return [];\n    } else {\n      return [[x1, -Infinity], [x1, Infinity]];\n    }\n  } else if (a1 === 0) {\n    // b1 * y + c1 = 0\n    // y = - c1 / b1;\n    // a2 * x + b2 * y + c2 = 0\n    var y = -c1 / b1;\n    var x = -(b2 * y + c2) / a2;\n    results = [[x, y]];\n  } else if (a2 === 0) {\n    // b2 * y + c2 = 0\n    // y = - c2 / b2;\n    // a1 * x + b1 * y + c1 = 0\n    var y = -c2 / b2;\n    var x = -(b1 * y + c1) / a1;\n    results = [[x, y]];\n  } else if (b1 === 0) {\n    // a1 * x + c1 = 0\n    // x = - c1 / a1;\n    // a2 * x + b2 * y + c2 = 0\n    var x = -c1 / a1;\n    var y = -(a2 * x + c2) / b2;\n    results = [[x, y]];\n  } else if (b2 === 0) {\n    // a2 * x + c2 = 0\n    // x = - c2 / a2;\n    // a1 * x + b1 * y + c1 = 0\n    var x = -c2 / a2;\n    var y = -(a1 * x + c1) / b1;\n    results = [[x, y]];\n  } else {\n    // a1 * x + b1 * y + c1 = 0\n    // a2 * x + b2 * y + c2 = 0\n    // b2 * a1 * x + b2 * b1 * y + b2 * c1 = 0\n    // b1 * a2 * x + b1 * b2 * y + b1 * c2 = 0\n    // (b2 * a1 - b1 * a2)  * x = (b1 * c2 - b2 * c1)\n    var x = (b1 * c2 - b2 * c1) / (b2 * a1 - b1 * a2);\n    var y = -(a1 * x + c1) / b1;\n    results = [[x, y]];\n  }\n\n  return results.map(function (result) {\n    return [result[0], result[1]];\n  });\n}\n/**\n * Get intersection points to the two lines.\n * @memberof OverlapArea\n */\n\nfunction getIntersectionPoints(line1, line2, isLimit) {\n  var points = getIntersectionPointsByConstants(getLinearConstants(line1[0], line1[1]), getLinearConstants(line2[0], line2[1]));\n\n  if (isLimit) {\n    return getPointsOnLines(points, [line1, line2]);\n  }\n\n  return points;\n}\nfunction isPointOnLine(pos, line) {\n  var linearConstants = getLinearConstants(line[0], line[1]);\n  return tinyThrottle(getDistanceFromPointToConstants(linearConstants, pos)) === 0;\n}\n/**\n * Get the points on the lines (between two points).\n * @memberof OverlapArea\n */\n\nfunction getPointsOnLines(points, lines) {\n  var minMaxs = lines.map(function (line) {\n    return [0, 1].map(function (order) {\n      return [Math.min(line[0][order], line[1][order]), Math.max(line[0][order], line[1][order])];\n    });\n  });\n  var results = [];\n\n  if (points.length === 2) {\n    var _a = points[0],\n        x = _a[0],\n        y = _a[1];\n\n    if (!tinyThrottle(x - points[1][0])) {\n      /// Math.max(minY1, minY2)\n      var top = Math.max.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[1][0];\n      })); /// Math.min(maxY1, miax2)\n\n      var bottom = Math.min.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[1][1];\n      }));\n\n      if (tinyThrottle(top - bottom) > 0) {\n        return [];\n      }\n\n      results = [[x, top], [x, bottom]];\n    } else if (!tinyThrottle(y - points[1][1])) {\n      /// Math.max(minY1, minY2)\n      var left = Math.max.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[0][0];\n      })); /// Math.min(maxY1, miax2)\n\n      var right = Math.min.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[0][1];\n      }));\n\n      if (tinyThrottle(left - right) > 0) {\n        return [];\n      }\n\n      results = [[left, y], [right, y]];\n    }\n  }\n\n  if (!results.length) {\n    results = points.filter(function (point) {\n      var pointX = point[0],\n          pointY = point[1];\n      return minMaxs.every(function (minMax) {\n        return 0 <= tinyThrottle(pointX - minMax[0][0]) && 0 <= tinyThrottle(minMax[0][1] - pointX) && 0 <= tinyThrottle(pointY - minMax[1][0]) && 0 <= tinyThrottle(minMax[1][1] - pointY);\n      });\n    });\n  }\n\n  return results.map(function (result) {\n    return [tinyThrottle(result[0]), tinyThrottle(result[1])];\n  });\n}\n/**\n* Convert two points into lines.\n* @function\n* @memberof OverlapArea\n*/\n\nfunction convertLines(points) {\n  return __spreadArrays(points.slice(1), [points[0]]).map(function (point, i) {\n    return [points[i], point];\n  });\n}\n\nfunction getOverlapPointInfos(points1, points2) {\n  var targetPoints1 = points1.slice();\n  var targetPoints2 = points2.slice();\n\n  if (getShapeDirection(targetPoints1) === -1) {\n    targetPoints1.reverse();\n  }\n\n  if (getShapeDirection(targetPoints2) === -1) {\n    targetPoints2.reverse();\n  }\n\n  var lines1 = convertLines(targetPoints1);\n  var lines2 = convertLines(targetPoints2);\n  var linearConstantsList1 = lines1.map(function (line1) {\n    return getLinearConstants(line1[0], line1[1]);\n  });\n  var linearConstantsList2 = lines2.map(function (line2) {\n    return getLinearConstants(line2[0], line2[1]);\n  });\n  var overlapInfos = [];\n  linearConstantsList1.forEach(function (linearConstants1, i) {\n    var line1 = lines1[i];\n    var linePointInfos = [];\n    linearConstantsList2.forEach(function (linearConstants2, j) {\n      var intersectionPoints = getIntersectionPointsByConstants(linearConstants1, linearConstants2);\n      var points = getPointsOnLines(intersectionPoints, [line1, lines2[j]]);\n      linePointInfos.push.apply(linePointInfos, points.map(function (pos) {\n        return {\n          index1: i,\n          index2: j,\n          pos: pos,\n          type: \"intersection\"\n        };\n      }));\n    });\n    linePointInfos.sort(function (a, b) {\n      return getDist(line1[0], a.pos) - getDist(line1[0], b.pos);\n    });\n    overlapInfos.push.apply(overlapInfos, linePointInfos);\n\n    if (isInside(line1[1], targetPoints2)) {\n      overlapInfos.push({\n        index1: i,\n        index2: -1,\n        pos: line1[1],\n        type: \"inside\"\n      });\n    }\n  });\n  lines2.forEach(function (line2, i) {\n    if (!isInside(line2[1], targetPoints1)) {\n      return;\n    }\n\n    var isNext = false;\n    var index = findIndex(overlapInfos, function (_a) {\n      var index2 = _a.index2;\n\n      if (index2 === i) {\n        isNext = true;\n        return false;\n      }\n\n      if (isNext) {\n        return true;\n      }\n\n      return false;\n    });\n\n    if (index === -1) {\n      isNext = false;\n      index = findIndex(overlapInfos, function (_a) {\n        var index1 = _a.index1,\n            index2 = _a.index2;\n\n        if (index1 === -1 && index2 + 1 === i) {\n          isNext = true;\n          return false;\n        }\n\n        if (isNext) {\n          return true;\n        }\n\n        return false;\n      });\n    }\n\n    if (index === -1) {\n      overlapInfos.push({\n        index1: -1,\n        index2: i,\n        pos: line2[1],\n        type: \"inside\"\n      });\n    } else {\n      overlapInfos.splice(index, 0, {\n        index1: -1,\n        index2: i,\n        pos: line2[1],\n        type: \"inside\"\n      });\n    }\n  });\n  var pointMap = {};\n  return overlapInfos.filter(function (_a) {\n    var pos = _a.pos;\n    var key = pos[0] + \"x\" + pos[1];\n\n    if (pointMap[key]) {\n      return false;\n    }\n\n    pointMap[key] = true;\n    return true;\n  });\n}\n/**\n* Get the points of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\n\nfunction getOverlapPoints(points1, points2) {\n  var infos = getOverlapPointInfos(points1, points2);\n  return infos.map(function (_a) {\n    var pos = _a.pos;\n    return pos;\n  });\n}\n\nfunction isConnectedLine(line) {\n  var _a = line[0],\n      prevIndex1 = _a.index1,\n      prevIndex2 = _a.index2,\n      _b = line[1],\n      nextIndex1 = _b.index1,\n      nextIndex2 = _b.index2;\n\n  if (prevIndex1 !== -1) {\n    // same line\n    if (prevIndex1 === nextIndex1) {\n      return true;\n    }\n\n    if (prevIndex1 + 1 === nextIndex1) {\n      return true;\n    }\n  }\n\n  if (prevIndex2 !== -1) {\n    // same line\n    if (prevIndex2 === nextIndex2) {\n      return true;\n    }\n\n    if (prevIndex2 + 1 === nextIndex2) {\n      return true;\n    }\n  }\n\n  return false;\n}\n/**\n* Get the areas of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\n\nfunction getOverlapAreas(points1, points2) {\n  var infos = getOverlapPointInfos(points1, points2);\n  var areas = [];\n  var area;\n  getOverlapPointInfos(points1, points2).forEach(function (info, i, arr) {\n    if (i === 0 || !isConnectedLine([arr[i - 1], info])) {\n      area = [info];\n      areas.push(area);\n    } else {\n      area.push(info);\n    }\n  });\n  return areas.map(function (area) {\n    return area.map(function (_a) {\n      var pos = _a.pos;\n      return pos;\n    });\n  });\n}\n\nfunction findReversedAreas(points1, points2, index, areas) {\n  if (index === void 0) {\n    index = 0;\n  }\n\n  if (areas === void 0) {\n    areas = [];\n  }\n\n  var isFirst = areas.length === 0;\n  var length = points1.length;\n  var nextIndex = points1[index] ? index : 0;\n\n  var nextPoints1 = __spreadArrays(points1.slice(nextIndex), points1.slice(0, nextIndex));\n\n  var _loop_1 = function (i) {\n    var point1 = nextPoints1[i];\n\n    if (find(points2, function (point2) {\n      return point2[0] === point1[0] && point2[1] === point1[1];\n    })) {\n      return \"continue\";\n    }\n\n    if (areas.some(function (nextArea) {\n      return find(nextArea, function (areaPoint) {\n        return areaPoint[0] === point1[0] && areaPoint[1] === point1[1];\n      });\n    })) {\n      if (isFirst) {\n        return \"continue\";\n      } else {\n        return \"break\";\n      }\n    }\n\n    var nextArea = void 0;\n\n    if (isFirst) {\n      nextArea = [];\n      areas.push(nextArea);\n    } else {\n      nextArea = areas[areas.length - 1];\n    }\n\n    nextArea.push(point1);\n    var line = [point1, points1[index + 1] || points1[0]];\n    var nextPoint2 = points2.filter(function (point2) {\n      return isPointOnLine(point2, line);\n    }).sort(function (a, b) {\n      return getDist(point1, a) - getDist(point1, b);\n    })[0];\n\n    if (!nextPoint2) {\n      findReversedAreas(nextPoints1, points2, i + 1, areas);\n      return \"break\";\n    } else {\n      var point2Index = points2.indexOf(nextPoint2);\n      findReversedAreas(points2, points1, point2Index, areas);\n\n      if (!isFirst) {\n        return \"break\";\n      }\n    }\n  };\n\n  for (var i = 0; i < length; ++i) {\n    var state_1 = _loop_1(i);\n\n    if (state_1 === \"break\") break;\n  }\n\n  return areas;\n}\n\nfunction findConnectedAreas(points1, points2) {\n  return findReversedAreas(points1, __spreadArrays(points2).reverse());\n}\n/**\n* Get non-overlapping areas of two shapes based on points1.\n* @memberof OverlapArea\n*/\n\nfunction getUnoverlapAreas(points1, points2) {\n  if (!points2.length) {\n    return [__spreadArrays(points1)];\n  }\n\n  var overlapAreas = getOverlapAreas(points1, points2);\n  var unoverlapAreas = [points1];\n  overlapAreas.forEach(function (overlapArea) {\n    var nextOverlapArea = __spreadArrays(overlapArea).reverse();\n\n    unoverlapAreas = flat(unoverlapAreas.map(function (area) {\n      var connectedAreas = findReversedAreas(area, nextOverlapArea);\n      var firstConnectedArea = connectedAreas[0];\n\n      if (connectedAreas.length === 1 && nextOverlapArea.every(function (point) {\n        return firstConnectedArea.indexOf(point) === -1;\n      })) {\n        var lastPoint_1 = firstConnectedArea[firstConnectedArea.length - 1];\n\n        var firstPoint = __spreadArrays(nextOverlapArea).sort(function (a, b) {\n          return getDist(lastPoint_1, a) - getDist(lastPoint_1, b);\n        })[0];\n\n        var firstIndex = nextOverlapArea.indexOf(firstPoint);\n        firstConnectedArea.push.apply(firstConnectedArea, __spreadArrays(nextOverlapArea.slice(firstIndex), nextOverlapArea.slice(0, firstIndex), [nextOverlapArea[firstIndex], lastPoint_1]));\n      }\n\n      return connectedAreas;\n    }));\n  });\n  return unoverlapAreas;\n}\n/**\n* Gets the size of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\nfunction getOverlapSize(points1, points2) {\n  var points = getOverlapPoints(points1, points2);\n  return getAreaSize(points);\n}\n\nexport { convertLines, findConnectedAreas, fitPoints, getAreaSize, getDistanceFromPointToConstants, getIntersectionPoints, getIntersectionPointsByConstants, getLinearConstants, getMinMaxs, getOverlapAreas, getOverlapPoints, getOverlapSize, getPointsOnLines, getUnoverlapAreas, isInside, isPointOnLine };\n//# sourceMappingURL=overlap-area.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: croact-css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-styled.git\nversion: 1.1.9\n*/\nimport cssStyled from 'css-styled';\nimport { version, createElement, forwardRef, useRef, useImperativeHandle, useEffect, Component } from 'croact';\nimport { ref } from 'framework-utils';\n\n/*\nCopyright (c) 2019 Daybrush\nname: react-css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/css-styled/tree/master/packages/react-css-styled\nversion: 1.1.9\n*/\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nfunction __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\nvar StyledElement = /*#__PURE__*/function (_super) {\n  __extends(StyledElement, _super);\n  function StyledElement() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.injectResult = null;\n    _this.tag = \"div\";\n    return _this;\n  }\n  var __proto = StyledElement.prototype;\n  __proto.render = function () {\n    var _a = this.props,\n      _b = _a.className,\n      className = _b === void 0 ? \"\" : _b,\n      cspNonce = _a.cspNonce,\n      portalContainer = _a.portalContainer,\n      attributes = __rest(_a, [\"className\", \"cspNonce\", \"portalContainer\"]);\n    var cssId = this.injector.className;\n    var Tag = this.tag;\n    var portalAttributes = {};\n    if ((version || \"\").indexOf(\"simple\") > -1 && portalContainer) {\n      portalAttributes = {\n        portalContainer: portalContainer\n      };\n    }\n    return createElement(Tag, __assign(__assign({\n      \"ref\": ref(this, \"element\"),\n      \"data-styled-id\": cssId,\n      \"className\": \"\".concat(className, \" \").concat(cssId)\n    }, portalAttributes), attributes));\n  };\n  __proto.componentDidMount = function () {\n    this.injectResult = this.injector.inject(this.element, {\n      nonce: this.props.cspNonce\n    });\n  };\n  __proto.componentWillUnmount = function () {\n    this.injectResult.destroy();\n    this.injectResult = null;\n  };\n  __proto.getElement = function () {\n    return this.element;\n  };\n  return StyledElement;\n}(Component);\nfunction defaultStyled(tag, css) {\n  var injector = cssStyled(css);\n  return /*#__PURE__*/function (_super) {\n    __extends(Styled, _super);\n    function Styled() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n      _this.injector = injector;\n      _this.tag = tag;\n      return _this;\n    }\n    return Styled;\n  }(StyledElement);\n}\nfunction styled(Tag, css) {\n  var injector = cssStyled(css);\n  var cssId = injector.className;\n  return forwardRef(function (props, ref) {\n    var _a = props.className,\n      className = _a === void 0 ? \"\" : _a,\n      cspNonce = props.cspNonce,\n      attributes = __rest(props, [\"className\", \"cspNonce\"]);\n    var targetRef = useRef();\n    useImperativeHandle(ref, function () {\n      return targetRef.current;\n    }, []);\n    useEffect(function () {\n      var injectResult = injector.inject(targetRef.current, {\n        nonce: props.cspNonce\n      });\n      return function () {\n        injectResult.destroy();\n      };\n    }, []);\n    return createElement(Tag, __assign({\n      \"ref\": targetRef,\n      \"data-styled-id\": cssId,\n      \"className\": \"\".concat(className, \" \").concat(cssId)\n    }, attributes));\n  });\n}\n\nexport default defaultStyled;\nexport { StyledElement, styled };\n","/*\nCopyright (c) 2019 Daybrush\nname: croact-moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/croact-moveable\nversion: 0.9.0\n*/\nimport getAgent from '@egjs/agent';\nimport { prefixNames, prefixCSS, ref, withMethods, refs } from 'framework-utils';\nimport { getRad, throttle, throttleArray, isString, calculateBoundSize, getKeys, isArray, hasClass, getDist as getDist$1, isObject, decamelize, convertUnitSize, pushSet, find, findIndex, splitSpace, isNumber, isNode, isFunction, isWindow, counter, dot, addClass, requestAnimationFrame, splitBracket, splitComma, splitUnit, cancelAnimationFrame, removeClass, getWindow, TINY_NUM as TINY_NUM$1, flat as flat$1, isUndefined, getDocumentBody, between, getDocumentElement, average } from '@daybrush/utils';\nimport { plus, minus, convertDimension, calculate, convertPositionMatrix, ignoreDimension, invert, createIdentityMatrix, createWarpMatrix, multiply, fromTranslation, createRotateMatrix, getOrigin, rotate, multiplies, createOriginMatrix, convertMatrixtoCSS, createScaleMatrix, convertCSStoMatrix } from '@scena/matrix';\nimport { parseMat, parse, toMat, calculateMatrixDist } from 'css-to-mat';\nimport ChildrenDiffer, { diff } from '@egjs/children-differ';\nimport DragScroll from '@scena/dragscroll';\nimport { getMinMaxs, fitPoints, getOverlapSize, getAreaSize, isInside, getIntersectionPointsByConstants } from 'overlap-area';\nimport * as React from 'croact';\nimport { createElement } from 'croact';\nimport Gesto from 'gesto';\nimport { styled } from 'croact-css-styled';\nimport EventEmitter from '@scena/event-emitter';\nimport { diff as diff$1 } from '@egjs/list-differ';\n\n/*\nCopyright (c) 2019 Daybrush\nname: react-moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/react-moveable\nversion: 0.56.0\n*/\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nfunction makeAble(name, able) {\r\n    return __assign({ events: [], props: [], name: name }, able);\r\n}\n\nvar DIRECTIONS4 = [\"n\", \"w\", \"s\", \"e\"];\r\nvar DIRECTIONS = [\"n\", \"w\", \"s\", \"e\", \"nw\", \"ne\", \"sw\", \"se\"];\r\nfunction getSVGCursor(scale, degree) {\r\n    return \"data:image/svg+xml;utf8,<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"\".concat(32 * scale, \"px\\\" height=\\\"\").concat(32 * scale, \"px\\\" viewBox=\\\"0 0 32 32\\\" ><path d=\\\"M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"1.2\\\" fill=\\\"black\\\" stroke=\\\"white\\\" style=\\\"transform:rotate(\").concat(degree, \"deg);transform-origin: 16px 16px\\\"></path></svg>\");\r\n}\r\nfunction getCursorCSS(degree) {\r\n    var x1 = getSVGCursor(1, degree);\r\n    // const x2 = getSVGCursor(2, degree);\r\n    var degree45 = (Math.round(degree / 45) * 45) % 180;\r\n    var defaultCursor = \"ns-resize\";\r\n    if (degree45 === 135) {\r\n        defaultCursor = \"nwse-resize\";\r\n    }\r\n    else if (degree45 === 45) {\r\n        defaultCursor = \"nesw-resize\";\r\n    }\r\n    else if (degree45 === 90) {\r\n        defaultCursor = \"ew-resize\";\r\n    }\r\n    // tslint:disable-next-line: max-line-length\r\n    return \"cursor:\".concat(defaultCursor, \";cursor: url('\").concat(x1, \"') 16 16, \").concat(defaultCursor, \";\");\r\n}\r\nvar agent = getAgent();\r\nvar IS_WEBKIT = agent.browser.webkit;\r\nvar IS_WEBKIT605 = IS_WEBKIT && (function () {\r\n    var navi = typeof window === \"undefined\" ? { userAgent: \"\" } : window.navigator;\r\n    var res = /applewebkit\\/([^\\s]+)/g.exec(navi.userAgent.toLowerCase());\r\n    return res ? parseFloat(res[1]) < 605 : false;\r\n})();\r\nvar browserName = agent.browser.name;\r\nvar browserVersion = parseInt(agent.browser.version, 10);\r\nvar IS_CHROME = browserName === \"chrome\";\r\nvar IS_CHROMIUM = agent.browser.chromium;\r\nvar chromiumVersion = parseInt(agent.browser.chromiumVersion, 10) || 0;\r\nvar IS_CHROMIUM109 = (IS_CHROME && browserVersion >= 109)\r\n    || (IS_CHROMIUM && chromiumVersion >= 109);\r\nvar IS_FIREFOX = browserName === \"firefox\";\r\nvar IS_SAFARI_ABOVE15 = parseInt(agent.browser.webkitVersion, 10) >= 612\r\n    || browserVersion >= 15;\r\nvar PREFIX = \"moveable-\";\r\nvar directionCSS = DIRECTIONS.map(function (dir) {\r\n    var top = \"\";\r\n    var left = \"\";\r\n    var originX = \"center\";\r\n    var originY = \"center\";\r\n    var offset = \"calc(var(--moveable-control-padding, 20) * -1px)\";\r\n    if (dir.indexOf(\"n\") > -1) {\r\n        top = \"top: \".concat(offset, \";\");\r\n        originY = \"bottom\";\r\n    }\r\n    if (dir.indexOf(\"s\") > -1) {\r\n        top = \"top: 0px;\";\r\n        originY = \"top\";\r\n    }\r\n    if (dir.indexOf(\"w\") > -1) {\r\n        left = \"left: \".concat(offset, \";\");\r\n        originX = \"right\";\r\n    }\r\n    if (dir.indexOf(\"e\") > -1) {\r\n        left = \"left: 0px;\";\r\n        originX = \"left\";\r\n    }\r\n    return \".around-control[data-direction*=\\\"\".concat(dir, \"\\\"] {\\n        \").concat(left).concat(top, \"\\n        transform-origin: \").concat(originX, \" \").concat(originY, \";\\n    }\");\r\n}).join(\"\\n\");\r\nvar MOVEABLE_CSS = \"\\n{\\nposition: absolute;\\nwidth: 1px;\\nheight: 1px;\\nleft: 0;\\ntop: 0;\\nz-index: 3000;\\n--moveable-color: #4af;\\n--zoom: 1;\\n--zoompx: 1px;\\n--moveable-line-padding: 0;\\n--moveable-control-padding: 0;\\nwill-change: transform;\\noutline: 1px solid transparent;\\n}\\n.control-box {\\nz-index: 0;\\n}\\n.line, .control {\\nposition: absolute;\\nleft: 0;\\ntop: 0;\\nwill-change: transform;\\n}\\n.control {\\nwidth: 14px;\\nheight: 14px;\\nborder-radius: 50%;\\nborder: 2px solid #fff;\\nbox-sizing: border-box;\\nbackground: #4af;\\nbackground: var(--moveable-color);\\nmargin-top: -7px;\\nmargin-left: -7px;\\nborder: 2px solid #fff;\\nz-index: 10;\\n}\\n.around-control {\\nposition: absolute;\\nwill-change: transform;\\nwidth: calc(var(--moveable-control-padding, 20) * 1px);\\nheight: calc(var(--moveable-control-padding, 20) * 1px);\\nleft: calc(var(--moveable-control-padding, 20) * -0.5px);\\ntop: calc(var(--moveable-control-padding, 20) * -0.5px);\\nbox-sizing: border-box;\\nbackground: transparent;\\nz-index: 8;\\ncursor: alias;\\ntransform-origin: center center;\\n}\\n\".concat(directionCSS, \"\\n.padding {\\nposition: absolute;\\ntop: 0px;\\nleft: 0px;\\nwidth: 100px;\\nheight: 100px;\\ntransform-origin: 0 0;\\n}\\n.line {\\nwidth: 1px;\\nheight: 1px;\\nbackground: #4af;\\nbackground: var(--moveable-color);\\ntransform-origin: 0px 50%;\\n}\\n.line.edge {\\nz-index: 1;\\nbackground: transparent;\\n}\\n.line.dashed {\\nbox-sizing: border-box;\\nbackground: transparent;\\n}\\n.line.dashed.horizontal {\\nborder-top: 1px dashed #4af;\\nborder-top-color: #4af;\\nborder-top-color: var(--moveable-color);\\n}\\n.line.dashed.vertical {\\nborder-left: 1px dashed #4af;\\nborder-left-color: #4af;\\nborder-left-color: var(--moveable-color);\\n}\\n.line.vertical {\\ntransform: translateX(-50%);\\n}\\n.line.horizontal {\\ntransform: translateY(-50%);\\n}\\n.line.vertical.bold {\\nwidth: 2px;\\n}\\n.line.horizontal.bold {\\nheight: 2px;\\n}\\n\\n.control.origin {\\nborder-color: #f55;\\nbackground: #fff;\\nwidth: 12px;\\nheight: 12px;\\nmargin-top: -6px;\\nmargin-left: -6px;\\npointer-events: none;\\n}\\n\").concat([0, 15, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165].map(function (degree) { return \"\\n.direction[data-rotation=\\\"\".concat(degree, \"\\\"], :global .view-control-rotation\").concat(degree, \" {\\n\").concat(getCursorCSS(degree), \"\\n}\\n\"); }).join(\"\\n\"), \"\\n\\n.line.direction:before {\\ncontent: \\\"\\\";\\nposition: absolute;\\nwidth: 100%;\\nheight: calc(var(--moveable-line-padding, 0) * 1px);\\nbottom: 0;\\nleft: 0;\\n}\\n.group {\\nz-index: -1;\\n}\\n.area {\\nposition: absolute;\\n}\\n.area-pieces {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\ndisplay: none;\\n}\\n.area.avoid, .area.pass {\\npointer-events: none;\\n}\\n.area.avoid+.area-pieces {\\ndisplay: block;\\n}\\n.area-piece {\\nposition: absolute;\\n}\\n\\n\").concat(IS_WEBKIT605 ? \":global svg *:before {\\ncontent:\\\"\\\";\\ntransform-origin: inherit;\\n}\" : \"\", \"\\n\");\r\nvar NEARBY_POS = [\r\n    [0, 1, 2],\r\n    [1, 0, 3],\r\n    [2, 0, 3],\r\n    [3, 1, 2],\r\n];\r\nvar FLOAT_POINT_NUM = 0.0001;\r\nvar TINY_NUM = 0.0000001;\r\nvar MIN_SCALE = 0.000000001;\r\nvar MAX_NUM = Math.pow(10, 10);\r\nvar MIN_NUM = -MAX_NUM;\r\nvar DIRECTION_REGION_TO_DIRECTION = {\r\n    n: [0, -1],\r\n    e: [1, 0],\r\n    s: [0, 1],\r\n    w: [-1, 0],\r\n    nw: [-1, -1],\r\n    ne: [1, -1],\r\n    sw: [-1, 1],\r\n    se: [1, 1],\r\n};\r\nvar DIRECTION_INDEXES = {\r\n    n: [0, 1],\r\n    e: [1, 3],\r\n    s: [3, 2],\r\n    w: [2, 0],\r\n    nw: [0],\r\n    ne: [1],\r\n    sw: [2],\r\n    se: [3],\r\n};\r\nvar DIRECTION_ROTATIONS = {\r\n    n: 0,\r\n    s: 180,\r\n    w: 270,\r\n    e: 90,\r\n    nw: 315,\r\n    ne: 45,\r\n    sw: 225,\r\n    se: 135,\r\n};\r\nvar MOVEABLE_METHODS = [\r\n    \"isMoveableElement\",\r\n    \"updateRect\",\r\n    \"updateTarget\",\r\n    \"destroy\",\r\n    \"dragStart\",\r\n    \"isInside\",\r\n    \"hitTest\",\r\n    \"setState\",\r\n    \"getRect\",\r\n    \"request\",\r\n    \"isDragging\",\r\n    \"getManager\",\r\n    \"forceUpdate\",\r\n    \"waitToChangeTarget\",\r\n    \"updateSelectors\",\r\n    \"getTargets\",\r\n    \"stopDrag\",\r\n    \"getControlBoxElement\",\r\n    \"getMoveables\",\r\n    \"getDragElement\",\r\n];\n\nfunction setCustomDrag(e, state, delta, isPinch, isConvert, ableName) {\r\n    var _a, _b;\r\n    if (ableName === void 0) { ableName = \"draggable\"; }\r\n    var result = (_b = (_a = state.gestos[ableName]) === null || _a === void 0 ? void 0 : _a.move(delta, e.inputEvent)) !== null && _b !== void 0 ? _b : {};\r\n    var datas = result.originalDatas || result.datas;\r\n    var ableDatas = datas[ableName] || (datas[ableName] = {});\r\n    return __assign(__assign({}, (isConvert ? convertDragDist(state, result) : result)), { isPinch: !!isPinch, parentEvent: true, datas: ableDatas, originalDatas: e.originalDatas });\r\n}\r\nvar CustomGesto = /*#__PURE__*/ (function () {\r\n    function CustomGesto(ableName) {\r\n        var _a;\r\n        if (ableName === void 0) { ableName = \"draggable\"; }\r\n        this.ableName = ableName;\r\n        this.prevX = 0;\r\n        this.prevY = 0;\r\n        this.startX = 0;\r\n        this.startY = 0;\r\n        this.isDrag = false;\r\n        this.isFlag = false;\r\n        this.datas = {\r\n            draggable: {},\r\n        };\r\n        this.datas = (_a = {},\r\n            _a[ableName] = {},\r\n            _a);\r\n    }\r\n    CustomGesto.prototype.dragStart = function (client, e) {\r\n        this.isDrag = false;\r\n        this.isFlag = false;\r\n        var originalDatas = e.originalDatas;\r\n        this.datas = originalDatas;\r\n        if (!originalDatas[this.ableName]) {\r\n            originalDatas[this.ableName] = {};\r\n        }\r\n        return __assign(__assign({}, this.move(client, e.inputEvent)), { type: \"dragstart\" });\r\n    };\r\n    CustomGesto.prototype.drag = function (client, inputEvent) {\r\n        return this.move([\r\n            client[0] - this.prevX,\r\n            client[1] - this.prevY,\r\n        ], inputEvent);\r\n    };\r\n    CustomGesto.prototype.move = function (delta, inputEvent) {\r\n        var clientX;\r\n        var clientY;\r\n        var isFirstDrag = false;\r\n        if (!this.isFlag) {\r\n            this.prevX = delta[0];\r\n            this.prevY = delta[1];\r\n            this.startX = delta[0];\r\n            this.startY = delta[1];\r\n            clientX = delta[0];\r\n            clientY = delta[1];\r\n            this.isFlag = true;\r\n        }\r\n        else {\r\n            var isPrevDrag = this.isDrag;\r\n            clientX = this.prevX + delta[0];\r\n            clientY = this.prevY + delta[1];\r\n            if (delta[0] || delta[1]) {\r\n                this.isDrag = true;\r\n            }\r\n            if (!isPrevDrag && this.isDrag) {\r\n                isFirstDrag = true;\r\n            }\r\n        }\r\n        this.prevX = clientX;\r\n        this.prevY = clientY;\r\n        return {\r\n            type: \"drag\",\r\n            clientX: clientX,\r\n            clientY: clientY,\r\n            inputEvent: inputEvent,\r\n            isFirstDrag: isFirstDrag,\r\n            isDrag: this.isDrag,\r\n            distX: clientX - this.startX,\r\n            distY: clientY - this.startY,\r\n            deltaX: delta[0],\r\n            deltaY: delta[1],\r\n            datas: this.datas[this.ableName],\r\n            originalDatas: this.datas,\r\n            parentEvent: true,\r\n            parentGesto: this,\r\n        };\r\n    };\r\n    return CustomGesto;\r\n}());\n\nfunction calculateElementPosition(matrix, origin, width, height) {\r\n    var is3d = matrix.length === 16;\r\n    var n = is3d ? 4 : 3;\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    var _a = __read(poses, 4), _b = __read(_a[0], 2), x1 = _b[0], y1 = _b[1], _c = __read(_a[1], 2), x2 = _c[0], y2 = _c[1], _d = __read(_a[2], 2), x3 = _d[0], y3 = _d[1], _e = __read(_a[3], 2), x4 = _e[0], y4 = _e[1];\r\n    var _f = __read(calculatePosition(matrix, origin, n), 2), originX = _f[0], originY = _f[1];\r\n    var left = Math.min(x1, x2, x3, x4);\r\n    var top = Math.min(y1, y2, y3, y4);\r\n    var right = Math.max(x1, x2, x3, x4);\r\n    var bottom = Math.max(y1, y2, y3, y4);\r\n    x1 = (x1 - left) || 0;\r\n    x2 = (x2 - left) || 0;\r\n    x3 = (x3 - left) || 0;\r\n    x4 = (x4 - left) || 0;\r\n    y1 = (y1 - top) || 0;\r\n    y2 = (y2 - top) || 0;\r\n    y3 = (y3 - top) || 0;\r\n    y4 = (y4 - top) || 0;\r\n    originX = (originX - left) || 0;\r\n    originY = (originY - top) || 0;\r\n    var sx = matrix[0];\r\n    var sy = matrix[n + 1];\r\n    var direction = sign(sx * sy);\r\n    return {\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n        origin: [originX, originY],\r\n        pos1: [x1, y1],\r\n        pos2: [x2, y2],\r\n        pos3: [x3, y3],\r\n        pos4: [x4, y4],\r\n        direction: direction,\r\n    };\r\n}\n\nfunction calculatePointerDist(moveable, e) {\r\n    var clientX = e.clientX, clientY = e.clientY, datas = e.datas;\r\n    var _a = moveable.state, moveableClientRect = _a.moveableClientRect, rootMatrix = _a.rootMatrix, is3d = _a.is3d, pos1 = _a.pos1;\r\n    var left = moveableClientRect.left, top = moveableClientRect.top;\r\n    var n = is3d ? 4 : 3;\r\n    var _b = __read(minus(calculateInversePosition(rootMatrix, [clientX - left, clientY - top], n), pos1), 2), posX = _b[0], posY = _b[1];\r\n    var _c = __read(getDragDist({ datas: datas, distX: posX, distY: posY }), 2), distX = _c[0], distY = _c[1];\r\n    return [distX, distY];\r\n}\r\nfunction setDragStart(moveable, _a) {\r\n    var datas = _a.datas;\r\n    var _b = moveable.state, allMatrix = _b.allMatrix, beforeMatrix = _b.beforeMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, origin = _b.origin, offsetMatrix = _b.offsetMatrix, targetMatrix = _b.targetMatrix, transformOrigin = _b.transformOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    datas.is3d = is3d;\r\n    datas.matrix = allMatrix;\r\n    datas.targetMatrix = targetMatrix;\r\n    datas.beforeMatrix = beforeMatrix;\r\n    datas.offsetMatrix = offsetMatrix;\r\n    datas.transformOrigin = transformOrigin;\r\n    datas.inverseMatrix = invert(allMatrix, n);\r\n    datas.inverseBeforeMatrix = invert(beforeMatrix, n);\r\n    datas.absoluteOrigin = convertPositionMatrix(plus([left, top], origin), n);\r\n    datas.startDragBeforeDist = calculate(datas.inverseBeforeMatrix, datas.absoluteOrigin, n);\r\n    datas.startDragDist = calculate(datas.inverseMatrix, datas.absoluteOrigin, n);\r\n}\r\nfunction getTransformDirection(e) {\r\n    return calculateElementPosition(e.datas.beforeTransform, [50, 50], 100, 100).direction;\r\n}\r\nfunction resolveTransformEvent(moveable, event, functionName) {\r\n    var datas = event.datas, originalDatas = event.originalDatas.beforeRenderable;\r\n    var index = datas.transformIndex;\r\n    var nextTransforms = originalDatas.nextTransforms;\r\n    var length = nextTransforms.length;\r\n    var nextTransformAppendedIndexes = originalDatas.nextTransformAppendedIndexes;\r\n    var nextIndex = -1;\r\n    if (index === -1) {\r\n        // translate => rotate => scale\r\n        if (functionName === \"translate\") {\r\n            nextIndex = 0;\r\n        }\r\n        else if (functionName === \"rotate\") {\r\n            nextIndex = findIndex(nextTransforms, function (text) { return text.match(/scale\\(/g); });\r\n        }\r\n        if (nextIndex === -1) {\r\n            nextIndex = nextTransforms.length;\r\n        }\r\n        datas.transformIndex = nextIndex;\r\n    }\r\n    else if (find(nextTransformAppendedIndexes, function (info) { return info.index === index && info.functionName === functionName; })) {\r\n        nextIndex = index;\r\n    }\r\n    else {\r\n        nextIndex = index + nextTransformAppendedIndexes.filter(function (info) { return info.index < index; }).length;\r\n    }\r\n    var result = convertTransformInfo(nextTransforms, moveable.state, nextIndex);\r\n    var targetFunction = result.targetFunction;\r\n    var matFunctionName = functionName === \"rotate\" ? \"rotateZ\" : functionName;\r\n    datas.beforeFunctionTexts = result.beforeFunctionTexts;\r\n    datas.afterFunctionTexts = result.afterFunctionTexts;\r\n    datas.beforeTransform = result.beforeFunctionMatrix;\r\n    datas.beforeTransform2 = result.beforeFunctionMatrix2;\r\n    datas.targetTansform = result.targetFunctionMatrix;\r\n    datas.afterTransform = result.afterFunctionMatrix;\r\n    datas.afterTransform2 = result.afterFunctionMatrix2;\r\n    datas.targetAllTransform = result.allFunctionMatrix;\r\n    if (targetFunction.functionName === matFunctionName) {\r\n        datas.afterFunctionTexts.splice(0, 1);\r\n        datas.isAppendTransform = false;\r\n    }\r\n    else if (length > nextIndex) {\r\n        datas.isAppendTransform = true;\r\n        originalDatas.nextTransformAppendedIndexes = __spreadArray(__spreadArray([], __read(nextTransformAppendedIndexes), false), [{\r\n                functionName: functionName,\r\n                index: nextIndex,\r\n                isAppend: true,\r\n            }], false);\r\n    }\r\n}\r\nfunction convertTransformFormat(datas, value, dist) {\r\n    return \"\".concat(datas.beforeFunctionTexts.join(\" \"), \" \").concat(datas.isAppendTransform ? dist : value, \" \").concat(datas.afterFunctionTexts.join(\" \"));\r\n}\r\nfunction getTransformDist(_a) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var _b = __read(getBeforeDragDist({ datas: datas, distX: distX, distY: distY }), 2), bx = _b[0], by = _b[1];\r\n    // B * [tx, ty] * A = [bx, by] * targetMatrix;\r\n    // [tx, ty] = B-1 * [bx, by] * targetMatrix * A-1 * [0, 0];\r\n    var res = getTransfromMatrix(datas, fromTranslation([bx, by], 4));\r\n    return calculate(res, convertPositionMatrix([0, 0, 0], 4), 4);\r\n}\r\nfunction getTransfromMatrix(datas, targetMatrix, isAfter) {\r\n    var beforeTransform = datas.beforeTransform, afterTransform = datas.afterTransform, beforeTransform2 = datas.beforeTransform2, afterTransform2 = datas.afterTransform2, targetAllTransform = datas.targetAllTransform;\r\n    // B * afterTargetMatrix * A = (targetMatrix * targetAllTransform)\r\n    // afterTargetMatrix = B-1 * targetMatrix * targetAllTransform * A-1\r\n    // nextTargetMatrix = (targetMatrix * targetAllTransform)\r\n    var nextTargetMatrix = isAfter\r\n        ? multiply(targetAllTransform, targetMatrix, 4)\r\n        : multiply(targetMatrix, targetAllTransform, 4);\r\n    // res1 = B-1 * nextTargetMatrix\r\n    var res1 = multiply(invert(isAfter ? beforeTransform2 : beforeTransform, 4), nextTargetMatrix, 4);\r\n    // res3 = res2 * A-1\r\n    var afterTargetMatrix = multiply(res1, invert(isAfter ? afterTransform2 : afterTransform, 4), 4);\r\n    return afterTargetMatrix;\r\n}\r\nfunction getBeforeDragDist(_a) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    // TT = BT\r\n    var inverseBeforeMatrix = datas.inverseBeforeMatrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    // ABS_ORIGIN * [distX, distY] = BM * (ORIGIN + [tx, ty])\r\n    // BM -1 * ABS_ORIGIN * [distX, distY] - ORIGIN = [tx, ty]\r\n    return minus(calculate(inverseBeforeMatrix, plus(absoluteOrigin, [distX, distY]), n), startDragBeforeDist);\r\n}\r\nfunction getDragDist(_a, isBefore) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var inverseBeforeMatrix = datas.inverseBeforeMatrix, inverseMatrix = datas.inverseMatrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, startDragDist = datas.startDragDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    return minus(calculate(isBefore ? inverseBeforeMatrix : inverseMatrix, plus(absoluteOrigin, [distX, distY]), n), isBefore ? startDragBeforeDist : startDragDist);\r\n}\r\nfunction getInverseDragDist(_a, isBefore) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var beforeMatrix = datas.beforeMatrix, matrix = datas.matrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, startDragDist = datas.startDragDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    return minus(calculate(isBefore ? beforeMatrix : matrix, plus(isBefore ? startDragBeforeDist : startDragDist, [distX, distY]), n), absoluteOrigin);\r\n}\r\nfunction calculateTransformOrigin(transformOrigin, width, height, prevWidth, prevHeight, prevOrigin) {\r\n    if (prevWidth === void 0) { prevWidth = width; }\r\n    if (prevHeight === void 0) { prevHeight = height; }\r\n    if (prevOrigin === void 0) { prevOrigin = [0, 0]; }\r\n    if (!transformOrigin) {\r\n        return prevOrigin;\r\n    }\r\n    return transformOrigin.map(function (pos, i) {\r\n        var _a = splitUnit(pos), value = _a.value, unit = _a.unit;\r\n        var prevSize = (i ? prevHeight : prevWidth);\r\n        var size = (i ? height : width);\r\n        if (pos === \"%\" || isNaN(value)) {\r\n            // no value but %\r\n            var measureRatio = prevSize ? prevOrigin[i] / prevSize : 0;\r\n            return size * measureRatio;\r\n        }\r\n        else if (unit !== \"%\") {\r\n            return value;\r\n        }\r\n        return size * value / 100;\r\n    });\r\n}\r\nfunction getPosIndexesByDirection(direction) {\r\n    var indexes = [];\r\n    if (direction[1] >= 0) {\r\n        if (direction[0] >= 0) {\r\n            indexes.push(3);\r\n        }\r\n        if (direction[0] <= 0) {\r\n            indexes.push(2);\r\n        }\r\n    }\r\n    if (direction[1] <= 0) {\r\n        if (direction[0] >= 0) {\r\n            indexes.push(1);\r\n        }\r\n        if (direction[0] <= 0) {\r\n            indexes.push(0);\r\n        }\r\n    }\r\n    return indexes;\r\n}\r\nfunction getPosesByDirection(poses, direction) {\r\n    /*\r\n    [-1, -1](pos1)       [0, -1](pos1,pos2)       [1, -1](pos2)\r\n    [-1, 0](pos1, pos3)                           [1, 0](pos2, pos4)\r\n    [-1, 1](pos3)        [0, 1](pos3, pos4)       [1, 1](pos4)\r\n    */\r\n    return getPosIndexesByDirection(direction).map(function (index) { return poses[index]; });\r\n}\r\nfunction getPosBySingleDirection(poses, direction) {\r\n    var ratio = (direction + 1) / 2;\r\n    return [\r\n        dot(poses[0][0], poses[1][0], ratio, 1 - ratio),\r\n        dot(poses[0][1], poses[1][1], ratio, 1 - ratio),\r\n    ];\r\n}\r\nfunction getPosByDirection(poses, direction) {\r\n    var top = getPosBySingleDirection([poses[0], poses[1]], direction[0]);\r\n    var bottom = getPosBySingleDirection([poses[2], poses[3]], direction[0]);\r\n    return getPosBySingleDirection([top, bottom], direction[1]);\r\n}\r\nfunction getDist(startPos, matrix, width, height, n, fixedDirection) {\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    var fixedPos = getPosByDirection(poses, fixedDirection);\r\n    var distX = startPos[0] - fixedPos[0];\r\n    var distY = startPos[1] - fixedPos[1];\r\n    return [distX, distY];\r\n}\r\nfunction getNextMatrix(offsetMatrix, targetMatrix, origin, n) {\r\n    return multiply(offsetMatrix, getAbsoluteMatrix(targetMatrix, n, origin), n);\r\n}\r\nfunction getNextTransformMatrix(state, datas, transform, isAllTransform) {\r\n    var transformOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var targetTransform;\r\n    if (isString(transform)) {\r\n        var beforeTransform = datas.beforeTransform, afterTransform = datas.afterTransform;\r\n        if (isAllTransform) {\r\n            targetTransform = convertDimension(parseMat(transform), 4, n);\r\n        }\r\n        else {\r\n            targetTransform = convertDimension(multiply(multiply(beforeTransform, parseMat([transform]), 4), afterTransform, 4), 4, n);\r\n        }\r\n    }\r\n    else {\r\n        targetTransform = transform;\r\n    }\r\n    return getNextMatrix(offsetMatrix, targetTransform, transformOrigin, n);\r\n}\r\nfunction scaleMatrix(state, scale) {\r\n    var transformOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d, targetMatrix = state.targetMatrix, targetAllTransform = state.targetAllTransform;\r\n    var n = is3d ? 4 : 3;\r\n    return getNextMatrix(offsetMatrix, multiply(targetAllTransform || targetMatrix, createScaleMatrix(scale, n), n), transformOrigin, n);\r\n}\r\nfunction fillTransformStartEvent(moveable, e) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    return {\r\n        setTransform: function (transform, index) {\r\n            if (index === void 0) { index = -1; }\r\n            originalDatas.startTransforms = isArray(transform) ? transform : splitSpace(transform);\r\n            setTransformIndex(moveable, e, index);\r\n        },\r\n        setTransformIndex: function (index) {\r\n            setTransformIndex(moveable, e, index);\r\n        },\r\n    };\r\n}\r\nfunction setDefaultTransformIndex(moveable, e, property) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    var startTransforms = originalDatas.startTransforms;\r\n    setTransformIndex(moveable, e, findIndex(startTransforms, function (func) { return func.indexOf(\"\".concat(property, \"(\")) === 0; }));\r\n}\r\nfunction setTransformIndex(moveable, e, index) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    var datas = e.datas;\r\n    datas.transformIndex = index;\r\n    if (index === -1) {\r\n        return;\r\n    }\r\n    var transform = originalDatas.startTransforms[index];\r\n    if (!transform) {\r\n        return;\r\n    }\r\n    var state = moveable.state;\r\n    var info = parse([transform], {\r\n        \"x%\": function (v) { return v / 100 * state.offsetWidth; },\r\n        \"y%\": function (v) { return v / 100 * state.offsetHeight; },\r\n    });\r\n    datas.startValue = info[0].functionValue;\r\n}\r\nfunction fillOriginalTransform(e, transform) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    originalDatas.nextTransforms = splitSpace(transform);\r\n    // originalDatas.nextTargetMatrix = parseMat(transform);\r\n}\r\nfunction getBeforeRenderableDatas(e) {\r\n    return e.originalDatas.beforeRenderable;\r\n}\r\nfunction getNextTransforms(e) {\r\n    var originalDatas = e.originalDatas.beforeRenderable;\r\n    return originalDatas.nextTransforms;\r\n}\r\nfunction getNextTransformText(e) {\r\n    return (getNextTransforms(e) || []).join(\" \");\r\n}\r\nfunction getNextStyle(e) {\r\n    return getBeforeRenderableDatas(e).nextStyle;\r\n}\r\nfunction fillTransformEvent(moveable, nextTransform, delta, isPinch, e) {\r\n    fillOriginalTransform(e, nextTransform);\r\n    var drag = Draggable.drag(moveable, setCustomDrag(e, moveable.state, delta, isPinch, false));\r\n    var afterTransform = drag ? drag.transform : nextTransform;\r\n    return __assign(__assign({ transform: nextTransform, drag: drag }, fillCSSObject({\r\n        transform: afterTransform,\r\n    }, e)), { afterTransform: afterTransform });\r\n}\r\nfunction getTranslateFixedPosition(moveable, transform, fixedDirection, fixedOffset, datas, isAllTransform) {\r\n    var nextMatrix = getNextTransformMatrix(moveable.state, datas, transform, isAllTransform);\r\n    var nextFixedPosition = getDirectionOffset(moveable, fixedDirection, fixedOffset, nextMatrix);\r\n    return nextFixedPosition;\r\n}\r\nfunction getTranslateDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform) {\r\n    var nextFixedPosition = getTranslateFixedPosition(moveable, transform, fixedDirection, fixedOffset, datas, isAllTransform);\r\n    var state = moveable.state;\r\n    var left = state.left, top = state.top;\r\n    var groupable = moveable.props.groupable;\r\n    var groupLeft = groupable ? left : 0;\r\n    var groupTop = groupable ? top : 0;\r\n    var dist = minus(fixedPosition, nextFixedPosition);\r\n    return minus(dist, [groupLeft, groupTop]);\r\n}\r\nfunction getScaleDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform) {\r\n    var dist = getTranslateDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform);\r\n    return dist;\r\n}\r\nfunction getDirectionByPos(pos, width, height) {\r\n    return [\r\n        width ? -1 + pos[0] / (width / 2) : 0,\r\n        height ? -1 + pos[1] / (height / 2) : 0,\r\n    ];\r\n}\r\nfunction getDirectionOffset(moveable, fixedDirection, fixedOffset, nextMatrix) {\r\n    if (nextMatrix === void 0) { nextMatrix = moveable.state.allMatrix; }\r\n    var _a = moveable.state, width = _a.width, height = _a.height, is3d = _a.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var fixedOffsetPosition = [\r\n        width / 2 * (1 + fixedDirection[0]) + fixedOffset[0],\r\n        height / 2 * (1 + fixedDirection[1]) + fixedOffset[1],\r\n    ];\r\n    return calculatePosition(nextMatrix, fixedOffsetPosition, n);\r\n}\r\nfunction getRotateDist(moveable, rotateDist, datas) {\r\n    var fixedDirection = datas.fixedDirection;\r\n    var fixedPosition = datas.fixedPosition;\r\n    var fixedOffset = datas.fixedOffset;\r\n    return getTranslateDist(moveable, \"rotate(\".concat(rotateDist, \"deg)\"), fixedDirection, fixedPosition, fixedOffset, datas);\r\n}\r\nfunction getResizeDist(moveable, width, height, fixedPosition, transformOrigin, datas) {\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var prevOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d, prevWidth = state.width, prevHeight = state.height, left = state.left, top = state.top;\r\n    var fixedDirection = datas.fixedDirection;\r\n    var targetMatrix = datas.nextTargetMatrix || state.targetMatrix;\r\n    var n = is3d ? 4 : 3;\r\n    var nextOrigin = calculateTransformOrigin(transformOrigin, width, height, prevWidth, prevHeight, prevOrigin);\r\n    var groupLeft = groupable ? left : 0;\r\n    var groupTop = groupable ? top : 0;\r\n    var nextMatrix = getNextMatrix(offsetMatrix, targetMatrix, nextOrigin, n);\r\n    var dist = getDist(fixedPosition, nextMatrix, width, height, n, fixedDirection);\r\n    return minus(dist, [groupLeft, groupTop]);\r\n}\r\nfunction getAbsolutePosition(moveable, direction) {\r\n    return getPosByDirection(getAbsolutePosesByState(moveable.state), direction);\r\n}\n\nfunction getGestoData(moveable, ableName) {\r\n    var targetGesto = moveable.targetGesto;\r\n    var controlGesto = moveable.controlGesto;\r\n    var data;\r\n    if (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag()) {\r\n        data = targetGesto.getEventData()[ableName];\r\n    }\r\n    if (!data && (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag())) {\r\n        data = controlGesto.getEventData()[ableName];\r\n    }\r\n    return data || {};\r\n}\n\nfunction getShadowRoot(parentElement) {\r\n    if (parentElement && parentElement.getRootNode) {\r\n        var rootNode = parentElement.getRootNode();\r\n        if (rootNode.nodeType === 11) {\r\n            return rootNode;\r\n        }\r\n    }\r\n    return;\r\n}\r\nfunction getIndividualTransforms(getStyle) {\r\n    var scale = getStyle(\"scale\");\r\n    var rotate = getStyle(\"rotate\");\r\n    var translate = getStyle(\"translate\");\r\n    var individualTransforms = [];\r\n    if (translate && translate !== \"0px\" && translate !== \"none\") {\r\n        individualTransforms.push(\"translate(\".concat(translate.split(/\\s+/).join(\",\"), \")\"));\r\n    }\r\n    if (rotate && rotate !== \"1\" && rotate !== \"none\") {\r\n        individualTransforms.push(\"rotate(\".concat(rotate, \")\"));\r\n    }\r\n    if (scale && scale !== \"1\" && scale !== \"none\") {\r\n        individualTransforms.push(\"scale(\".concat(scale.split(/\\s+/).join(\",\"), \")\"));\r\n    }\r\n    return individualTransforms;\r\n}\r\nfunction getMatrixStackInfo(target, container, checkContainer) {\r\n    var el = target;\r\n    var matrixes = [];\r\n    var documentElement = getDocumentElement(target) || getDocumentBody(target);\r\n    var requestEnd = !checkContainer && target === container || target === documentElement;\r\n    var isEnd = requestEnd;\r\n    var is3d = false;\r\n    var n = 3;\r\n    var transformOrigin;\r\n    var targetTransformOrigin;\r\n    var targetMatrix;\r\n    var hasFixed = false;\r\n    var offsetContainer = getOffsetInfo(container, container, true).offsetParent;\r\n    var zoom = 1;\r\n    while (el && !isEnd) {\r\n        isEnd = requestEnd;\r\n        var getStyle = getCachedStyle(el);\r\n        var position = getStyle(\"position\");\r\n        var transform = getElementTransform(el);\r\n        var isFixed = position === \"fixed\";\r\n        var individualTransforms = getIndividualTransforms(getStyle);\r\n        var matrix = convertCSStoMatrix(getTransformMatrix(transform));\r\n        var offsetParent = void 0;\r\n        var isOffsetEnd = false;\r\n        var isStatic = false;\r\n        var parentClientLeft = 0;\r\n        var parentClientTop = 0;\r\n        var fixedClientLeft = 0;\r\n        var fixedClientTop = 0;\r\n        var fixedInfo = {\r\n            hasTransform: false,\r\n            fixedContainer: null,\r\n        };\r\n        if (isFixed) {\r\n            hasFixed = true;\r\n            fixedInfo = getPositionFixedInfo(el);\r\n            offsetContainer = fixedInfo.fixedContainer;\r\n        }\r\n        // convert 3 to 4\r\n        var length_1 = matrix.length;\r\n        if (!is3d && (length_1 === 16 || individualTransforms.length)) {\r\n            is3d = true;\r\n            n = 4;\r\n            convert3DMatrixes(matrixes);\r\n            if (targetMatrix) {\r\n                targetMatrix = convertDimension(targetMatrix, 3, 4);\r\n            }\r\n        }\r\n        if (is3d && length_1 === 9) {\r\n            matrix = convertDimension(matrix, 3, 4);\r\n        }\r\n        var _a = getOffsetPosInfo(el, target), tagName = _a.tagName, hasOffset = _a.hasOffset, isSVG = _a.isSVG, origin_1 = _a.origin, targetOrigin = _a.targetOrigin, offsetPos = _a.offset;\r\n        var _b = __read(offsetPos, 2), offsetLeft = _b[0], offsetTop = _b[1];\r\n        // no target with svg\r\n        if (tagName === \"svg\" && !el.ownerSVGElement && targetMatrix) {\r\n            // scale matrix for svg's SVGElements.\r\n            matrixes.push({\r\n                type: \"target\",\r\n                target: el,\r\n                matrix: getSVGMatrix(el, n),\r\n            });\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createIdentityMatrix(n),\r\n            });\r\n        }\r\n        var targetZoom = parseFloat(getStyle(\"zoom\")) || 1;\r\n        if (isFixed) {\r\n            offsetParent = fixedInfo.fixedContainer;\r\n            isOffsetEnd = true;\r\n        }\r\n        else {\r\n            var offsetInfo = getOffsetInfo(el, container, false, true, getStyle);\r\n            var offsetZoom = offsetInfo.offsetZoom;\r\n            offsetParent = offsetInfo.offsetParent;\r\n            isOffsetEnd = offsetInfo.isEnd;\r\n            isStatic = offsetInfo.isStatic;\r\n            zoom *= offsetZoom;\r\n            if ((offsetInfo.isCustomElement || offsetZoom !== 1) && isStatic) {\r\n                offsetLeft -= offsetParent.offsetLeft;\r\n                offsetTop -= offsetParent.offsetTop;\r\n            }\r\n            else if (IS_FIREFOX || IS_CHROMIUM109) {\r\n                var parentSlotElement = offsetInfo.parentSlotElement;\r\n                if (parentSlotElement) {\r\n                    var customOffsetParent = offsetParent;\r\n                    var customOffsetLeft = 0;\r\n                    var customOffsetTop = 0;\r\n                    while (customOffsetParent) {\r\n                        if (!getShadowRoot(customOffsetParent)) {\r\n                            break;\r\n                        }\r\n                        customOffsetLeft += customOffsetParent.offsetLeft;\r\n                        customOffsetTop += customOffsetParent.offsetTop;\r\n                        customOffsetParent = customOffsetParent.offsetParent;\r\n                    }\r\n                    offsetLeft -= customOffsetLeft;\r\n                    offsetTop -= customOffsetTop;\r\n                }\r\n            }\r\n        }\r\n        if (IS_WEBKIT && !IS_SAFARI_ABOVE15\r\n            && hasOffset && !isSVG && isStatic\r\n            && (position === \"relative\" || position === \"static\")) {\r\n            offsetLeft -= offsetParent.offsetLeft;\r\n            offsetTop -= offsetParent.offsetTop;\r\n            requestEnd = requestEnd || isOffsetEnd;\r\n        }\r\n        if (isFixed) {\r\n            if (hasOffset && fixedInfo.hasTransform) {\r\n                // border\r\n                fixedClientLeft = offsetParent.clientLeft;\r\n                fixedClientTop = offsetParent.clientTop;\r\n            }\r\n        }\r\n        else {\r\n            if (hasOffset && offsetContainer !== offsetParent) {\r\n                // border\r\n                parentClientLeft = offsetParent.clientLeft;\r\n                parentClientTop = offsetParent.clientTop;\r\n            }\r\n            if (hasOffset && offsetParent === documentElement) {\r\n                var margin = getBodyOffset(el, false);\r\n                offsetLeft += margin[0];\r\n                offsetTop += margin[1];\r\n            }\r\n        }\r\n        matrixes.push({\r\n            type: \"target\",\r\n            target: el,\r\n            matrix: getAbsoluteMatrix(matrix, n, origin_1),\r\n        });\r\n        if (individualTransforms.length) {\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createIdentityMatrix(n),\r\n            });\r\n            matrixes.push({\r\n                type: \"target\",\r\n                target: el,\r\n                matrix: getAbsoluteMatrix(parseMat(individualTransforms), n, origin_1),\r\n            });\r\n        }\r\n        if (hasOffset) {\r\n            var isElementTarget = el === target;\r\n            var scrollLeft = isElementTarget ? 0 : el.scrollLeft;\r\n            var scrollTop = isElementTarget ? 0 : el.scrollTop;\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createOriginMatrix([\r\n                    offsetLeft - scrollLeft + parentClientLeft - fixedClientLeft,\r\n                    offsetTop - scrollTop + parentClientTop - fixedClientTop,\r\n                ], n),\r\n            });\r\n        }\r\n        else {\r\n            // svg\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                origin: origin_1,\r\n            });\r\n        }\r\n        // transform   zoom  (0, 0)   matrix .\r\n        if (targetZoom !== 1) {\r\n            matrixes.push({\r\n                type: \"zoom\",\r\n                target: el,\r\n                matrix: getAbsoluteMatrix(createScaleMatrix([targetZoom, targetZoom], n), n, [0, 0]),\r\n            });\r\n        }\r\n        if (!targetMatrix) {\r\n            targetMatrix = matrix;\r\n        }\r\n        if (!transformOrigin) {\r\n            transformOrigin = origin_1;\r\n        }\r\n        if (!targetTransformOrigin) {\r\n            targetTransformOrigin = targetOrigin;\r\n        }\r\n        if (isEnd || isFixed) {\r\n            break;\r\n        }\r\n        else {\r\n            el = offsetParent;\r\n            requestEnd = isOffsetEnd;\r\n        }\r\n        if (!checkContainer || el === documentElement) {\r\n            isEnd = requestEnd;\r\n        }\r\n    }\r\n    if (!targetMatrix) {\r\n        targetMatrix = createIdentityMatrix(n);\r\n    }\r\n    if (!transformOrigin) {\r\n        transformOrigin = [0, 0];\r\n    }\r\n    if (!targetTransformOrigin) {\r\n        targetTransformOrigin = [0, 0];\r\n    }\r\n    return {\r\n        zoom: zoom,\r\n        offsetContainer: offsetContainer,\r\n        matrixes: matrixes,\r\n        targetMatrix: targetMatrix,\r\n        transformOrigin: transformOrigin,\r\n        targetOrigin: targetTransformOrigin,\r\n        is3d: is3d,\r\n        hasFixed: hasFixed,\r\n    };\r\n}\n\nvar cacheStyleMap = null;\r\nvar clientRectStyleMap = null;\r\nvar matrixContainerInfos = null;\r\nfunction setStoreCache(useCache) {\r\n    if (useCache) {\r\n        if (window.Map) {\r\n            cacheStyleMap = new Map();\r\n            clientRectStyleMap = new Map();\r\n        }\r\n        matrixContainerInfos = [];\r\n    }\r\n    else {\r\n        cacheStyleMap = null;\r\n        matrixContainerInfos = null;\r\n        clientRectStyleMap = null;\r\n    }\r\n}\r\nfunction getCachedClientRect(el) {\r\n    var clientRect = clientRectStyleMap === null || clientRectStyleMap === void 0 ? void 0 : clientRectStyleMap.get(el);\r\n    if (clientRect) {\r\n        return clientRect;\r\n    }\r\n    var nextClientRect = getClientRect(el, true);\r\n    if (clientRectStyleMap) {\r\n        clientRectStyleMap.set(el, nextClientRect);\r\n    }\r\n    return nextClientRect;\r\n}\r\nfunction getCachedMatrixContainerInfo(target, container) {\r\n    if (matrixContainerInfos) {\r\n        var result_1 = find(matrixContainerInfos, function (info) { return info[0][0] == target && info[0][1] == container; });\r\n        if (result_1) {\r\n            return result_1[1];\r\n        }\r\n    }\r\n    var result = getMatrixStackInfo(target, container, true);\r\n    if (matrixContainerInfos) {\r\n        matrixContainerInfos.push([[target, container], result]);\r\n    }\r\n    return result;\r\n}\r\nfunction getCachedStyle(element) {\r\n    var cache = cacheStyleMap === null || cacheStyleMap === void 0 ? void 0 : cacheStyleMap.get(element);\r\n    if (!cache) {\r\n        var nextStyle_1 = getWindow(element).getComputedStyle(element);\r\n        if (!cacheStyleMap) {\r\n            return function (property) {\r\n                return nextStyle_1[property];\r\n            };\r\n        }\r\n        cache = {\r\n            style: nextStyle_1,\r\n            cached: {},\r\n        };\r\n        cacheStyleMap.set(element, cache);\r\n    }\r\n    var cached = cache.cached;\r\n    var style = cache.style;\r\n    return function (property) {\r\n        if (!(property in cached)) {\r\n            cached[property] = style[property];\r\n        }\r\n        return cached[property];\r\n    };\r\n}\n\nfunction fillChildEvents(moveable, name, e) {\r\n    var datas = e.originalDatas;\r\n    datas.groupable = datas.groupable || {};\r\n    var groupableDatas = datas.groupable;\r\n    groupableDatas.childDatas = groupableDatas.childDatas || [];\r\n    var childDatas = groupableDatas.childDatas;\r\n    return moveable.moveables.map(function (_, i) {\r\n        childDatas[i] = childDatas[i] || {};\r\n        childDatas[i][name] = childDatas[i][name] || {};\r\n        return __assign(__assign({}, e), { isRequestChild: true, datas: childDatas[i][name], originalDatas: childDatas[i] });\r\n    });\r\n}\r\nfunction triggerChildGesto(moveable, able, type, delta, e, isConvert, ableName) {\r\n    var isStart = !!type.match(/Start$/g);\r\n    var isEnd = !!type.match(/End$/g);\r\n    var isPinch = e.isPinch;\r\n    var datas = e.datas;\r\n    var events = fillChildEvents(moveable, able.name, e);\r\n    var moveables = moveable.moveables;\r\n    var childEvents = [];\r\n    var eventParams = events.map(function (ev, i) {\r\n        var childMoveable = moveables[i];\r\n        var state = childMoveable.state;\r\n        var gestos = state.gestos;\r\n        var childEvent = ev;\r\n        if (isStart) {\r\n            childEvent = new CustomGesto(ableName).dragStart(delta, ev);\r\n            childEvents.push(childEvent);\r\n        }\r\n        else {\r\n            if (!gestos[ableName]) {\r\n                gestos[ableName] = datas.childGestos[i];\r\n            }\r\n            if (!gestos[ableName]) {\r\n                return;\r\n            }\r\n            childEvent = setCustomDrag(ev, state, delta, isPinch, isConvert, ableName);\r\n            childEvents.push(childEvent);\r\n        }\r\n        var result = able[type](childMoveable, __assign(__assign({}, childEvent), { parentFlag: true }));\r\n        if (isEnd) {\r\n            gestos[ableName] = null;\r\n        }\r\n        return result;\r\n    });\r\n    if (isStart) {\r\n        datas.childGestos = moveables.map(function (child) { return child.state.gestos[ableName]; });\r\n    }\r\n    return {\r\n        eventParams: eventParams,\r\n        childEvents: childEvents,\r\n    };\r\n}\r\nfunction triggerChildAbles(moveable, able, type, e, eachEvent, callback) {\r\n    if (eachEvent === void 0) { eachEvent = function (_, ev) { return ev; }; }\r\n    var isEnd = !!type.match(/End$/g);\r\n    var events = fillChildEvents(moveable, able.name, e);\r\n    var moveables = moveable.moveables;\r\n    var childs = events.map(function (ev, i) {\r\n        var childMoveable = moveables[i];\r\n        var childEvent = ev;\r\n        childEvent = eachEvent(childMoveable, ev);\r\n        var result = able[type](childMoveable, __assign(__assign({}, childEvent), { parentFlag: true }));\r\n        result && callback && callback(childMoveable, ev, result, i);\r\n        if (isEnd) {\r\n            childMoveable.state.gestos = {};\r\n        }\r\n        return result;\r\n    });\r\n    return childs;\r\n}\r\nfunction startChildDist(moveable, child, parentDatas, childEvent) {\r\n    var fixedDirection = parentDatas.fixedDirection;\r\n    var fixedPosition = parentDatas.fixedPosition;\r\n    var startPositions = childEvent.datas.startPositions || getAbsolutePosesByState(child.state);\r\n    var pos = getPosByDirection(startPositions, fixedDirection);\r\n    var _a = __read(calculate(createRotateMatrix(-moveable.rotation / 180 * Math.PI, 3), [pos[0] - fixedPosition[0], pos[1] - fixedPosition[1], 1], 3), 2), originalX = _a[0], originalY = _a[1];\r\n    childEvent.datas.originalX = originalX;\r\n    childEvent.datas.originalY = originalY;\r\n    return childEvent;\r\n}\n\nfunction renderDirectionControlsByInfos(moveable, ableName, renderDirections, React) {\r\n    var _a = moveable.getState(), renderPoses = _a.renderPoses, rotationRad = _a.rotation, direction = _a.direction;\r\n    var zoom = getProps(moveable.props, ableName).zoom;\r\n    var degRotation = absDegree(rotationRad / Math.PI * 180);\r\n    var directionMap = {};\r\n    var renderState = moveable.renderState;\r\n    if (!renderState.renderDirectionMap) {\r\n        renderState.renderDirectionMap = {};\r\n    }\r\n    var renderDirectionMap = renderState.renderDirectionMap;\r\n    renderDirections.forEach(function (_a) {\r\n        var dir = _a.dir;\r\n        directionMap[dir] = true;\r\n    });\r\n    var directionSign = sign(direction);\r\n    return renderDirections.map(function (_a) {\r\n        var data = _a.data, classNames = _a.classNames, dir = _a.dir;\r\n        var indexes = DIRECTION_INDEXES[dir];\r\n        if (!indexes || !directionMap[dir]) {\r\n            return null;\r\n        }\r\n        renderDirectionMap[dir] = true;\r\n        var directionRotation = (throttle(degRotation, 15) + directionSign * DIRECTION_ROTATIONS[dir] + 720) % 180;\r\n        var dataAttrs = {};\r\n        getKeys(data).forEach(function (name) {\r\n            dataAttrs[\"data-\".concat(name)] = data[name];\r\n        });\r\n        return (React.createElement(\"div\", __assign({ className: prefix.apply(void 0, __spreadArray([\"control\", \"direction\", dir, ableName], __read(classNames), false)), \"data-rotation\": directionRotation, \"data-direction\": dir }, dataAttrs, { key: \"direction-\".concat(dir), style: getControlTransform.apply(void 0, __spreadArray([rotationRad, zoom], __read(indexes.map(function (index) { return renderPoses[index]; })), false)) })));\r\n    });\r\n}\r\nfunction renderDirectionControls(moveable, defaultDirections, ableName, React) {\r\n    var _a = getProps(moveable.props, ableName), _b = _a.renderDirections, directions = _b === void 0 ? defaultDirections : _b, displayAroundControls = _a.displayAroundControls;\r\n    if (!directions) {\r\n        return [];\r\n    }\r\n    var renderDirections = directions === true ? DIRECTIONS : directions;\r\n    return __spreadArray(__spreadArray([], __read((displayAroundControls ? renderAroundControls(moveable, React, ableName, renderDirections) : [])), false), __read(renderDirectionControlsByInfos(moveable, ableName, renderDirections.map(function (dir) {\r\n        return {\r\n            data: {},\r\n            classNames: [],\r\n            dir: dir,\r\n        };\r\n    }), React)), false);\r\n}\r\nfunction renderLine(React, direction, pos1, pos2, zoom, key) {\r\n    var classNames = [];\r\n    for (var _i = 6; _i < arguments.length; _i++) {\r\n        classNames[_i - 6] = arguments[_i];\r\n    }\r\n    var rad = getRad(pos1, pos2);\r\n    var rotation = direction ? (throttle(rad / Math.PI * 180, 15)) % 180 : -1;\r\n    return React.createElement(\"div\", { key: \"line-\".concat(key), className: prefix.apply(void 0, __spreadArray([\"line\", \"direction\", direction ? \"edge\" : \"\", direction], __read(classNames), false)), \"data-rotation\": rotation, \"data-line-key\": key, \"data-direction\": direction, style: getLineStyle(pos1, pos2, zoom, rad) });\r\n}\r\nfunction renderEdgeLines(React, ableName, edge, poses, zoom) {\r\n    var directions = edge === true ? DIRECTIONS4 : edge;\r\n    return directions.map(function (direction, i) {\r\n        var _a = __read(DIRECTION_INDEXES[direction], 2), index1 = _a[0], index2 = _a[1];\r\n        if (index2 == null) {\r\n            return;\r\n        }\r\n        return renderLine(React, direction, poses[index1], poses[index2], zoom, \"\".concat(ableName, \"Edge\").concat(i), ableName);\r\n    }).filter(Boolean);\r\n}\r\nfunction getRenderDirections(ableName) {\r\n    return function (moveable, React) {\r\n        var edge = getProps(moveable.props, ableName).edge;\r\n        if (edge && (edge === true || edge.length)) {\r\n            return __spreadArray(__spreadArray([], __read(renderEdgeLines(React, ableName, edge, moveable.getState().renderPoses, moveable.props.zoom)), false), __read(renderDiagonalDirections(moveable, ableName, React)), false);\r\n        }\r\n        return renderAllDirections(moveable, ableName, React);\r\n    };\r\n}\r\nfunction renderAllDirections(moveable, ableName, React) {\r\n    return renderDirectionControls(moveable, DIRECTIONS, ableName, React);\r\n}\r\nfunction renderDiagonalDirections(moveable, ableName, React) {\r\n    return renderDirectionControls(moveable, [\"nw\", \"ne\", \"sw\", \"se\"], ableName, React);\r\n}\r\nfunction renderAroundControls(moveable, React, ableName, renderDirections) {\r\n    var renderState = moveable.renderState;\r\n    if (!renderState.renderDirectionMap) {\r\n        renderState.renderDirectionMap = {};\r\n    }\r\n    var _a = moveable.getState(), renderPoses = _a.renderPoses, rotationRad = _a.rotation, direction = _a.direction;\r\n    var renderDirectionMap = renderState.renderDirectionMap;\r\n    var zoom = moveable.props.zoom;\r\n    var directionSign = sign(direction);\r\n    var degRotation = rotationRad / Math.PI * 180;\r\n    return (renderDirections || getKeys(renderDirectionMap)).map(function (dir) {\r\n        var indexes = DIRECTION_INDEXES[dir];\r\n        if (!indexes) {\r\n            return null;\r\n        }\r\n        var directionRotation = (throttle(degRotation, 15) + directionSign * DIRECTION_ROTATIONS[dir] + 720) % 180;\r\n        var classNames = [\"around-control\"];\r\n        if (ableName) {\r\n            classNames.push(\"direction\", ableName);\r\n        }\r\n        return (React.createElement(\"div\", { className: prefix.apply(void 0, __spreadArray([], __read(classNames), false)), \"data-rotation\": directionRotation, \"data-direction\": dir, key: \"direction-around-\".concat(dir), style: getControlTransform.apply(void 0, __spreadArray([rotationRad, zoom], __read(indexes.map(function (index) { return renderPoses[index]; })), false)) }));\r\n    });\r\n}\n\nfunction checkBoundPoses(bounds, verticalPoses, horizontalPoses) {\r\n    var _a = bounds || {}, _b = _a.position, position = _b === void 0 ? \"client\" : _b, _c = _a.left, left = _c === void 0 ? -Infinity : _c, _d = _a.top, top = _d === void 0 ? -Infinity : _d, _e = _a.right, right = _e === void 0 ? Infinity : _e, _f = _a.bottom, bottom = _f === void 0 ? Infinity : _f;\r\n    var nextBounds = {\r\n        position: position,\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n    };\r\n    return {\r\n        vertical: checkBounds(nextBounds, verticalPoses, true),\r\n        horizontal: checkBounds(nextBounds, horizontalPoses, false),\r\n    };\r\n}\r\nfunction getBounds(moveable, externalBounds) {\r\n    var _a = moveable.state, _b = _a.containerClientRect, containerHeight = _b.clientHeight, containerWidth = _b.clientWidth, clientLeft = _b.clientLeft, clientTop = _b.clientTop, _c = _a.snapOffset, snapOffsetLeft = _c.left, snapOffsetTop = _c.top, snapOffsetRight = _c.right, snapOffsetBottom = _c.bottom;\r\n    var bounds = externalBounds || moveable.props.bounds || {};\r\n    var position = bounds.position || \"client\";\r\n    var isCSS = position === \"css\";\r\n    var _d = bounds.left, left = _d === void 0 ? -Infinity : _d, _e = bounds.top, top = _e === void 0 ? -Infinity : _e;\r\n    var _f = bounds.right, right = _f === void 0 ? isCSS ? -Infinity : Infinity : _f, _g = bounds.bottom, bottom = _g === void 0 ? isCSS ? -Infinity : Infinity : _g;\r\n    if (isCSS) {\r\n        right = containerWidth + snapOffsetRight - snapOffsetLeft - right;\r\n        bottom = containerHeight + snapOffsetBottom - snapOffsetTop - bottom;\r\n    }\r\n    return {\r\n        left: left + snapOffsetLeft - clientLeft,\r\n        right: right + snapOffsetLeft - clientLeft,\r\n        top: top + snapOffsetTop - clientTop,\r\n        bottom: bottom + snapOffsetTop - clientTop,\r\n    };\r\n}\r\nfunction checkBoundKeepRatio(moveable, startPos, endPos) {\r\n    var _a = getBounds(moveable), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n    var _b = __read(endPos, 2), endX = _b[0], endY = _b[1];\r\n    var _c = __read(minus(endPos, startPos), 2), dx = _c[0], dy = _c[1];\r\n    if (abs(dx) < TINY_NUM) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM) {\r\n        dy = 0;\r\n    }\r\n    var isBottom = dy > 0;\r\n    var isRight = dx > 0;\r\n    var verticalInfo = {\r\n        isBound: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    var horizontalInfo = {\r\n        isBound: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    if (dx === 0 && dy === 0) {\r\n        return {\r\n            vertical: verticalInfo,\r\n            horizontal: horizontalInfo,\r\n        };\r\n    }\r\n    else if (dx === 0) {\r\n        if (isBottom) {\r\n            if (bottom < endY) {\r\n                horizontalInfo.pos = bottom;\r\n                horizontalInfo.offset = endY - bottom;\r\n            }\r\n        }\r\n        else {\r\n            if (top > endY) {\r\n                horizontalInfo.pos = top;\r\n                horizontalInfo.offset = endY - top;\r\n            }\r\n        }\r\n    }\r\n    else if (dy === 0) {\r\n        if (isRight) {\r\n            if (right < endX) {\r\n                verticalInfo.pos = right;\r\n                verticalInfo.offset = endX - right;\r\n            }\r\n        }\r\n        else {\r\n            if (left > endX) {\r\n                verticalInfo.pos = left;\r\n                verticalInfo.offset = endX - left;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        // y - y1 = a * (x - x1)\r\n        var a = dy / dx;\r\n        var b = endPos[1] - a * endX;\r\n        var y = 0;\r\n        var x = 0;\r\n        var isBound = false;\r\n        if (isRight && right <= endX) {\r\n            y = a * right + b;\r\n            x = right;\r\n            isBound = true;\r\n        }\r\n        else if (!isRight && endX <= left) {\r\n            y = a * left + b;\r\n            x = left;\r\n            isBound = true;\r\n        }\r\n        if (isBound) {\r\n            if (y < top || y > bottom) {\r\n                isBound = false;\r\n            }\r\n        }\r\n        if (!isBound) {\r\n            if (isBottom && bottom <= endY) {\r\n                y = bottom;\r\n                x = (y - b) / a;\r\n                isBound = true;\r\n            }\r\n            else if (!isBottom && endY <= top) {\r\n                y = top;\r\n                x = (y - b) / a;\r\n                isBound = true;\r\n            }\r\n        }\r\n        if (isBound) {\r\n            verticalInfo.isBound = true;\r\n            verticalInfo.pos = x;\r\n            verticalInfo.offset = endX - x;\r\n            horizontalInfo.isBound = true;\r\n            horizontalInfo.pos = y;\r\n            horizontalInfo.offset = endY - y;\r\n        }\r\n    }\r\n    return {\r\n        vertical: verticalInfo,\r\n        horizontal: horizontalInfo,\r\n    };\r\n}\r\nfunction checkBounds(bounds, poses, isVertical) {\r\n    // 0   [100 - 200]  300\r\n    var startBoundPos = bounds[isVertical ? \"left\" : \"top\"];\r\n    var endBoundPos = bounds[isVertical ? \"right\" : \"bottom\"];\r\n    // 450\r\n    var minPos = Math.min.apply(Math, __spreadArray([], __read(poses), false));\r\n    var maxPos = Math.max.apply(Math, __spreadArray([], __read(poses), false));\r\n    var boundInfos = [];\r\n    if (startBoundPos + 1 > minPos) {\r\n        boundInfos.push({\r\n            direction: \"start\",\r\n            isBound: true,\r\n            offset: minPos - startBoundPos,\r\n            pos: startBoundPos,\r\n        });\r\n    }\r\n    if (endBoundPos - 1 < maxPos) {\r\n        boundInfos.push({\r\n            direction: \"end\",\r\n            isBound: true,\r\n            offset: maxPos - endBoundPos,\r\n            pos: endBoundPos,\r\n        });\r\n    }\r\n    if (!boundInfos.length) {\r\n        boundInfos.push({\r\n            isBound: false,\r\n            offset: 0,\r\n            pos: 0,\r\n        });\r\n    }\r\n    return boundInfos.sort(function (a, b) { return abs(b.offset) - abs(a.offset); });\r\n}\r\nfunction isBoundRotate$1(relativePoses, boundRect, rad) {\r\n    var nextPoses = rad ? relativePoses.map(function (pos) { return rotate(pos, rad); }) : relativePoses;\r\n    return nextPoses.some(function (pos) {\r\n        return (pos[0] < boundRect.left && abs(pos[0] - boundRect.left) > 0.1)\r\n            || (pos[0] > boundRect.right && abs(pos[0] - boundRect.right) > 0.1)\r\n            || (pos[1] < boundRect.top && abs(pos[1] - boundRect.top) > 0.1)\r\n            || (pos[1] > boundRect.bottom && abs(pos[1] - boundRect.bottom) > 0.1);\r\n    });\r\n}\r\nfunction boundRotate(vec, boundPos, index) {\r\n    var r = getDistSize(vec);\r\n    var nextPos = Math.sqrt(r * r - boundPos * boundPos) || 0;\r\n    return [nextPos, -nextPos].sort(function (a, b) {\r\n        return abs(a - vec[index ? 0 : 1]) - abs(b - vec[index ? 0 : 1]);\r\n    }).map(function (pos) {\r\n        return getRad([0, 0], index ? [pos, boundPos] : [boundPos, pos]);\r\n    });\r\n}\r\nfunction checkRotateBounds(moveable, prevPoses, nextPoses, origin, rotation) {\r\n    if (!moveable.props.bounds) {\r\n        return [];\r\n    }\r\n    var rad = rotation * Math.PI / 180;\r\n    var _a = getBounds(moveable), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n    var relativeLeft = left - origin[0];\r\n    var relativeRight = right - origin[0];\r\n    var relativeTop = top - origin[1];\r\n    var relativeBottom = bottom - origin[1];\r\n    var boundRect = {\r\n        left: relativeLeft,\r\n        top: relativeTop,\r\n        right: relativeRight,\r\n        bottom: relativeBottom,\r\n    };\r\n    if (!isBoundRotate$1(nextPoses, boundRect, 0)) {\r\n        return [];\r\n    }\r\n    var result = [];\r\n    [\r\n        [relativeLeft, 0],\r\n        [relativeRight, 0],\r\n        [relativeTop, 1],\r\n        [relativeBottom, 1],\r\n    ].forEach(function (_a) {\r\n        var _b = __read(_a, 2), boundPos = _b[0], index = _b[1];\r\n        nextPoses.forEach(function (nextPos) {\r\n            var relativeRad1 = getRad([0, 0], nextPos);\r\n            result.push.apply(result, __spreadArray([], __read(boundRotate(nextPos, boundPos, index)\r\n                .map(function (relativeRad2) { return rad + relativeRad2 - relativeRad1; })\r\n                .filter(function (nextRad) { return !isBoundRotate$1(prevPoses, boundRect, nextRad); })\r\n                .map(function (nextRad) { return throttle(nextRad * 180 / Math.PI, TINY_NUM); })), false));\r\n        });\r\n    });\r\n    return result;\r\n}\n\nvar VERTICAL_NAMES = [\"left\", \"right\", \"center\"];\r\nvar HORIZONTAL_NAMES = [\"top\", \"bottom\", \"middle\"];\r\nvar SNAP_SKIP_NAMES_MAP = {\r\n    \"left\": \"start\",\r\n    \"right\": \"end\",\r\n    \"center\": \"center\",\r\n    \"top\": \"start\",\r\n    \"bottom\": \"end\",\r\n    \"middle\": \"center\",\r\n};\r\nvar VERTICAL_NAMES_MAP = {\r\n    start: \"left\",\r\n    end: \"right\",\r\n    center: \"center\",\r\n};\r\nvar HORIZONTAL_NAMES_MAP = {\r\n    start: \"top\",\r\n    end: \"bottom\",\r\n    center: \"middle\",\r\n};\r\nfunction getInitialBounds() {\r\n    return {\r\n        left: false,\r\n        top: false,\r\n        right: false,\r\n        bottom: false,\r\n    };\r\n}\r\nfunction hasGuidelines(moveable, ableName) {\r\n    var _a = moveable.props, snappable = _a.snappable, bounds = _a.bounds, innerBounds = _a.innerBounds, verticalGuidelines = _a.verticalGuidelines, horizontalGuidelines = _a.horizontalGuidelines, snapGridWidth = _a.snapGridWidth, snapGridHeight = _a.snapGridHeight, _b = moveable.state, guidelines = _b.guidelines, enableSnap = _b.enableSnap;\r\n    if (!snappable ||\r\n        !enableSnap ||\r\n        (ableName && snappable !== true && snappable.indexOf(ableName) < 0)) {\r\n        return false;\r\n    }\r\n    if (snapGridWidth ||\r\n        snapGridHeight ||\r\n        bounds ||\r\n        innerBounds ||\r\n        (guidelines && guidelines.length) ||\r\n        (verticalGuidelines && verticalGuidelines.length) ||\r\n        (horizontalGuidelines && horizontalGuidelines.length)) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction getSnapDirections(snapDirections) {\r\n    if (snapDirections === false) {\r\n        return {};\r\n    }\r\n    else if (snapDirections === true || !snapDirections) {\r\n        return { left: true, right: true, top: true, bottom: true };\r\n    }\r\n    return snapDirections;\r\n}\r\nfunction mapSnapDirectionPoses(snapDirections, snapPoses) {\r\n    var nextSnapDirections = getSnapDirections(snapDirections);\r\n    var nextSnapPoses = {};\r\n    for (var name_1 in nextSnapDirections) {\r\n        if (name_1 in snapPoses && nextSnapDirections[name_1]) {\r\n            nextSnapPoses[name_1] = snapPoses[name_1];\r\n        }\r\n    }\r\n    return nextSnapPoses;\r\n}\r\nfunction splitSnapDirectionPoses(snapDirections, snapPoses) {\r\n    var nextSnapPoses = mapSnapDirectionPoses(snapDirections, snapPoses);\r\n    var horizontalNames = HORIZONTAL_NAMES.filter(function (name) { return name in nextSnapPoses; });\r\n    var verticalNames = VERTICAL_NAMES.filter(function (name) { return name in nextSnapPoses; });\r\n    return {\r\n        horizontalNames: horizontalNames,\r\n        verticalNames: verticalNames,\r\n        horizontal: horizontalNames.map(function (name) { return nextSnapPoses[name]; }),\r\n        vertical: verticalNames.map(function (name) { return nextSnapPoses[name]; }),\r\n    };\r\n}\r\nfunction calculateContainerPos(rootMatrix, containerRect, n) {\r\n    var clientPos = calculatePosition(rootMatrix, [containerRect.clientLeft, containerRect.clientTop], n);\r\n    return [\r\n        containerRect.left + clientPos[0],\r\n        containerRect.top + clientPos[1],\r\n    ];\r\n}\r\nfunction solveLineConstants(_a) {\r\n    var _b = __read(_a, 2), point1 = _b[0], point2 = _b[1];\r\n    var dx = point2[0] - point1[0];\r\n    var dy = point2[1] - point1[1];\r\n    if (Math.abs(dx) < TINY_NUM$1) {\r\n        dx = 0;\r\n    }\r\n    if (Math.abs(dy) < TINY_NUM$1) {\r\n        dy = 0;\r\n    }\r\n    // b > 0\r\n    // ax + by + c = 0\r\n    var a = 0;\r\n    var b = 0;\r\n    var c = 0;\r\n    if (!dx) {\r\n        // -x + 1 = 0\r\n        a = -1;\r\n        c = point1[0];\r\n    }\r\n    else if (!dy) {\r\n        // y - 1 = 0\r\n        b = 1;\r\n        c = -point1[1];\r\n    }\r\n    else {\r\n        // y = -a(x - x1) + y1\r\n        // ax + y + a * x1 - y1 = 0\r\n        a = -dy / dx;\r\n        b = 1;\r\n        c = a * point1[0] - point1[1];\r\n    }\r\n    return [a, b, c].map(function (v) { return throttle(v, TINY_NUM$1); });\r\n}\n\nvar NAME_snapRotationThreshold = \"snapRotationThreshold\";\r\nvar NAME_snapRotationDegrees = \"snapRotationDegrees\";\r\nvar NAME_snapHorizontalThreshold = \"snapHorizontalThreshold\";\r\nvar NAME_snapVerticalThreshold = \"snapVerticalThreshold\";\n\nfunction checkMoveableSnapPoses(moveable, posesX, posesY, dirXs, dirYs, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var _a;\r\n    if (dirXs === void 0) { dirXs = []; }\r\n    if (dirYs === void 0) { dirYs = []; }\r\n    var props = moveable.props;\r\n    var snapThresholdMultiples = ((_a = moveable.state.snapThresholdInfo) === null || _a === void 0 ? void 0 : _a.multiples) || [1, 1];\r\n    var snapHorizontalThreshold = selectValue(customSnapHorizontalThreshold, props[NAME_snapHorizontalThreshold], 5);\r\n    var snapVerticalThreshold = selectValue(customSnapVerticalThreshold, props[NAME_snapVerticalThreshold], 5);\r\n    return checkSnapPoses(moveable.state.guidelines, posesX, posesY, dirXs, dirYs, snapHorizontalThreshold, snapVerticalThreshold, snapThresholdMultiples);\r\n}\r\nfunction checkSnapPoses(guidelines, posesX, posesY, dirXs, dirYs, snapHorizontalThreshold, snapVerticalThreshold, multiples) {\r\n    return {\r\n        vertical: checkSnap(guidelines, \"vertical\", posesX, snapVerticalThreshold * multiples[0], dirXs),\r\n        horizontal: checkSnap(guidelines, \"horizontal\", posesY, snapHorizontalThreshold * multiples[1], dirYs),\r\n    };\r\n}\r\nfunction checkSnapKeepRatio(moveable, startPos, endPos) {\r\n    var _a = __read(endPos, 2), endX = _a[0], endY = _a[1];\r\n    var _b = __read(startPos, 2), startX = _b[0], startY = _b[1];\r\n    var _c = __read(minus(endPos, startPos), 2), dx = _c[0], dy = _c[1];\r\n    var isBottom = dy > 0;\r\n    var isRight = dx > 0;\r\n    dx = getTinyDist(dx);\r\n    dy = getTinyDist(dy);\r\n    var verticalInfo = {\r\n        isSnap: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    var horizontalInfo = {\r\n        isSnap: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    if (dx === 0 && dy === 0) {\r\n        return {\r\n            vertical: verticalInfo,\r\n            horizontal: horizontalInfo,\r\n        };\r\n    }\r\n    var _d = checkMoveableSnapPoses(moveable, dx ? [endX] : [], dy ? [endY] : [], [], [], undefined, undefined), verticalSnapInfo = _d.vertical, horizontalSnapInfo = _d.horizontal;\r\n    verticalSnapInfo.posInfos.filter(function (_a) {\r\n        var pos = _a.pos;\r\n        return isRight ? pos >= startX : pos <= startX;\r\n    });\r\n    horizontalSnapInfo.posInfos.filter(function (_a) {\r\n        var pos = _a.pos;\r\n        return isBottom ? pos >= startY : pos <= startY;\r\n    });\r\n    verticalSnapInfo.isSnap = verticalSnapInfo.posInfos.length > 0;\r\n    horizontalSnapInfo.isSnap = horizontalSnapInfo.posInfos.length > 0;\r\n    var _e = getNearestSnapGuidelineInfo(verticalSnapInfo), isVerticalSnap = _e.isSnap, verticalGuideline = _e.guideline;\r\n    var _f = getNearestSnapGuidelineInfo(horizontalSnapInfo), isHorizontalSnap = _f.isSnap, horizontalGuideline = _f.guideline;\r\n    var horizontalPos = isHorizontalSnap ? horizontalGuideline.pos[1] : 0;\r\n    var verticalPos = isVerticalSnap ? verticalGuideline.pos[0] : 0;\r\n    if (dx === 0) {\r\n        if (isHorizontalSnap) {\r\n            horizontalInfo.isSnap = true;\r\n            horizontalInfo.pos = horizontalGuideline.pos[1];\r\n            horizontalInfo.offset = endY - horizontalInfo.pos;\r\n        }\r\n    }\r\n    else if (dy === 0) {\r\n        if (isVerticalSnap) {\r\n            verticalInfo.isSnap = true;\r\n            verticalInfo.pos = verticalPos;\r\n            verticalInfo.offset = endX - verticalPos;\r\n        }\r\n    }\r\n    else {\r\n        // y - y1 = a * (x - x1)\r\n        var a = dy / dx;\r\n        var b = endPos[1] - a * endX;\r\n        var y = 0;\r\n        var x = 0;\r\n        var isSnap = false;\r\n        if (isVerticalSnap) {\r\n            x = verticalPos;\r\n            y = a * x + b;\r\n            isSnap = true;\r\n        }\r\n        else if (isHorizontalSnap) {\r\n            y = horizontalPos;\r\n            x = (y - b) / a;\r\n            isSnap = true;\r\n        }\r\n        if (isSnap) {\r\n            verticalInfo.isSnap = true;\r\n            verticalInfo.pos = x;\r\n            verticalInfo.offset = endX - x;\r\n            horizontalInfo.isSnap = true;\r\n            horizontalInfo.pos = y;\r\n            horizontalInfo.offset = endY - y;\r\n        }\r\n    }\r\n    return {\r\n        vertical: verticalInfo,\r\n        horizontal: horizontalInfo,\r\n    };\r\n}\r\nfunction getStringDirection(dir) {\r\n    var stringDirection = \"\";\r\n    if (dir === -1 || dir === \"top\" || dir === \"left\") {\r\n        stringDirection = \"start\";\r\n    }\r\n    else if (dir === 0 || dir === \"center\" || dir === \"middle\") {\r\n        stringDirection = \"center\";\r\n    }\r\n    else if (dir === 1 || dir === \"right\" || dir === \"bottom\") {\r\n        stringDirection = \"end\";\r\n    }\r\n    return stringDirection;\r\n}\r\nfunction checkSnaps(moveable, rect, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var poses = splitSnapDirectionPoses(moveable.props.snapDirections, rect);\r\n    var result = checkMoveableSnapPoses(moveable, poses.vertical, poses.horizontal, poses.verticalNames.map(function (name) { return getStringDirection(name); }), poses.horizontalNames.map(function (name) { return getStringDirection(name); }), customSnapVerticalThreshold, customSnapHorizontalThreshold);\r\n    var horizontalDirection = getStringDirection(poses.horizontalNames[result.horizontal.index]);\r\n    var verticalDirection = getStringDirection(poses.verticalNames[result.vertical.index]);\r\n    return {\r\n        vertical: __assign(__assign({}, result.vertical), { direction: verticalDirection }),\r\n        horizontal: __assign(__assign({}, result.horizontal), { direction: horizontalDirection }),\r\n    };\r\n}\r\nfunction getNearestSnapGuidelineInfo(snapInfo) {\r\n    var isSnap = snapInfo.isSnap;\r\n    if (!isSnap) {\r\n        return {\r\n            isSnap: false,\r\n            offset: 0,\r\n            dist: -1,\r\n            pos: 0,\r\n            guideline: null,\r\n        };\r\n    }\r\n    var posInfo = snapInfo.posInfos[0];\r\n    var guidelineInfo = posInfo.guidelineInfos[0];\r\n    var offset = guidelineInfo.offset;\r\n    var dist = guidelineInfo.dist;\r\n    var guideline = guidelineInfo.guideline;\r\n    return {\r\n        isSnap: isSnap,\r\n        offset: offset,\r\n        dist: dist,\r\n        pos: posInfo.pos,\r\n        guideline: guideline,\r\n    };\r\n}\r\nfunction checkSnap(guidelines, targetType, targetPoses, snapThreshold, dirs) {\r\n    var _a, _b;\r\n    if (dirs === void 0) { dirs = []; }\r\n    if (!guidelines || !guidelines.length) {\r\n        return {\r\n            isSnap: false,\r\n            index: -1,\r\n            direction: \"\",\r\n            posInfos: [],\r\n        };\r\n    }\r\n    var isVertical = targetType === \"vertical\";\r\n    var posType = isVertical ? 0 : 1;\r\n    var snapPosInfos = targetPoses.map(function (targetPos, index) {\r\n        var direction = dirs[index] || \"\";\r\n        var guidelineInfos = guidelines.map(function (guideline) {\r\n            var pos = guideline.pos;\r\n            var offset = targetPos - pos[posType];\r\n            return {\r\n                offset: offset,\r\n                dist: abs(offset),\r\n                guideline: guideline,\r\n                direction: direction,\r\n            };\r\n        }).filter(function (_a) {\r\n            var guideline = _a.guideline, dist = _a.dist;\r\n            var type = guideline.type;\r\n            if (type !== targetType\r\n                || dist > snapThreshold) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }).sort(function (a, b) { return a.dist - b.dist; });\r\n        return {\r\n            pos: targetPos,\r\n            index: index,\r\n            guidelineInfos: guidelineInfos,\r\n            direction: direction,\r\n        };\r\n    }).filter(function (snapPosInfo) {\r\n        return snapPosInfo.guidelineInfos.length > 0;\r\n    }).sort(function (a, b) {\r\n        return a.guidelineInfos[0].dist - b.guidelineInfos[0].dist;\r\n    });\r\n    var isSnap = snapPosInfos.length > 0;\r\n    return {\r\n        isSnap: isSnap,\r\n        index: isSnap ? snapPosInfos[0].index : -1,\r\n        direction: (_b = (_a = snapPosInfos[0]) === null || _a === void 0 ? void 0 : _a.direction) !== null && _b !== void 0 ? _b : \"\",\r\n        posInfos: snapPosInfos,\r\n    };\r\n}\r\nfunction getSnapInfosByDirection(moveable, \r\n// pos1 pos2 pos3 pos4\r\nposes, snapDirection, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var dirs = [];\r\n    if (snapDirection[0] && snapDirection[1]) {\r\n        dirs = [\r\n            snapDirection,\r\n            [-snapDirection[0], snapDirection[1]],\r\n            [snapDirection[0], -snapDirection[1]],\r\n        ];\r\n    }\r\n    else if (!snapDirection[0] && !snapDirection[1]) {\r\n        [\r\n            [-1, -1],\r\n            [1, -1],\r\n            [1, 1],\r\n            [-1, 1],\r\n        ].forEach(function (dir, i, arr) {\r\n            var nextDir = (arr[i + 1] || arr[0]);\r\n            dirs.push(dir);\r\n            dirs.push([\r\n                (dir[0] + nextDir[0]) / 2,\r\n                (dir[1] + nextDir[1]) / 2,\r\n            ]);\r\n        });\r\n    }\r\n    else {\r\n        if (moveable.props.keepRatio) {\r\n            dirs.push([-1, -1], [-1, 1], [1, -1], [1, 1], snapDirection);\r\n        }\r\n        else {\r\n            dirs.push.apply(dirs, __spreadArray([], __read(getPosesByDirection([\r\n                [-1, -1],\r\n                [1, -1],\r\n                [-1, -1],\r\n                [1, 1],\r\n            ], snapDirection)), false));\r\n            if (dirs.length > 1) {\r\n                dirs.push([\r\n                    (dirs[0][0] + dirs[1][0]) / 2,\r\n                    (dirs[0][1] + dirs[1][1]) / 2,\r\n                ]);\r\n            }\r\n        }\r\n    }\r\n    var nextPoses = dirs.map(function (dir) { return getPosByDirection(poses, dir); });\r\n    var xs = nextPoses.map(function (pos) { return pos[0]; });\r\n    var ys = nextPoses.map(function (pos) { return pos[1]; });\r\n    var result = checkMoveableSnapPoses(moveable, xs, ys, dirs.map(function (dir) { return getStringDirection(dir[0]); }), dirs.map(function (dir) { return getStringDirection(dir[1]); }), customSnapVerticalThreshold, customSnapHorizontalThreshold);\r\n    var verticalDirection = getStringDirection(dirs.map(function (dir) { return dir[0]; })[result.vertical.index]);\r\n    var horizontalDirection = getStringDirection(dirs.map(function (dir) { return dir[1]; })[result.horizontal.index]);\r\n    return {\r\n        vertical: __assign(__assign({}, result.vertical), { direction: verticalDirection }),\r\n        horizontal: __assign(__assign({}, result.horizontal), { direction: horizontalDirection }),\r\n    };\r\n}\r\nfunction checkSnapBoundPriority(a, b) {\r\n    var aDist = abs(a.offset);\r\n    var bDist = abs(b.offset);\r\n    if (a.isBound && b.isBound) {\r\n        return bDist - aDist;\r\n    }\r\n    else if (a.isBound) {\r\n        return -1;\r\n    }\r\n    else if (b.isBound) {\r\n        return 1;\r\n    }\r\n    else if (a.isSnap && b.isSnap) {\r\n        return bDist - aDist;\r\n    }\r\n    else if (a.isSnap) {\r\n        return -1;\r\n    }\r\n    else if (b.isSnap) {\r\n        return 1;\r\n    }\r\n    else if (aDist < TINY_NUM) {\r\n        return 1;\r\n    }\r\n    else if (bDist < TINY_NUM) {\r\n        return -1;\r\n    }\r\n    return aDist - bDist;\r\n}\r\nfunction getNearOffsetInfo(offsets, index) {\r\n    return offsets.slice().sort(function (a, b) {\r\n        var aSign = a.sign[index];\r\n        var bSign = b.sign[index];\r\n        var aOffset = a.offset[index];\r\n        var bOffset = b.offset[index];\r\n        // -1 The positions of a and b do not change.\r\n        // 1 The positions of a and b are reversed.\r\n        if (!aSign) {\r\n            return 1;\r\n        }\r\n        else if (!bSign) {\r\n            return -1;\r\n        }\r\n        return checkSnapBoundPriority({ isBound: a.isBound, isSnap: a.isSnap, offset: aOffset }, { isBound: b.isBound, isSnap: b.isSnap, offset: bOffset });\r\n    })[0];\r\n}\r\nfunction getCheckSnapDirections(direction, fixedDirection, keepRatio) {\r\n    var directions = [];\r\n    // const fixedDirection = [-direction[0], -direction[1]];\r\n    if (keepRatio) {\r\n        if (abs(fixedDirection[0]) !== 1 || abs(fixedDirection[1]) !== 1) {\r\n            directions.push([fixedDirection, [-1, -1]], [fixedDirection, [-1, 1]], [fixedDirection, [1, -1]], [fixedDirection, [1, 1]]);\r\n        }\r\n        else {\r\n            directions.push([fixedDirection, [direction[0], -direction[1]]], [fixedDirection, [-direction[0], direction[1]]]);\r\n        }\r\n        directions.push([fixedDirection, direction]);\r\n    }\r\n    else {\r\n        if ((direction[0] && direction[1]) || (!direction[0] && !direction[1])) {\r\n            var endDirection_1 = direction[0] ? direction : [1, 1];\r\n            [1, -1].forEach(function (signX) {\r\n                [1, -1].forEach(function (signY) {\r\n                    var nextDirection = [signX * endDirection_1[0], signY * endDirection_1[1]];\r\n                    if (fixedDirection[0] === nextDirection[0]\r\n                        && fixedDirection[1] === nextDirection[1]) {\r\n                        return;\r\n                    }\r\n                    directions.push([fixedDirection, nextDirection]);\r\n                });\r\n            });\r\n        }\r\n        else if (direction[0]) {\r\n            var signs = abs(fixedDirection[0]) === 1 ? [1] : [1, -1];\r\n            signs.forEach(function (sign) {\r\n                directions.push([\r\n                    [fixedDirection[0], -1],\r\n                    [sign * direction[0], -1],\r\n                ], [\r\n                    [fixedDirection[0], 0],\r\n                    [sign * direction[0], 0],\r\n                ], [\r\n                    [fixedDirection[0], 1],\r\n                    [sign * direction[0], 1],\r\n                ]);\r\n            });\r\n        }\r\n        else if (direction[1]) {\r\n            var signs = abs(fixedDirection[1]) === 1 ? [1] : [1, -1];\r\n            signs.forEach(function (sign) {\r\n                directions.push([\r\n                    [-1, fixedDirection[1]],\r\n                    [-1, sign * direction[1]],\r\n                ], [\r\n                    [0, fixedDirection[1]],\r\n                    [0, sign * direction[1]],\r\n                ], [\r\n                    [1, fixedDirection[1]],\r\n                    [1, sign * direction[1]],\r\n                ]);\r\n            });\r\n        }\r\n    }\r\n    return directions;\r\n}\n\nfunction isStartLine(dot, line) {\r\n    // l    o     => true\r\n    // o    l    => false\r\n    var cx = average([line[0][0], line[1][0]]);\r\n    var cy = average([line[0][1], line[1][1]]);\r\n    return {\r\n        vertical: cx <= dot[0],\r\n        horizontal: cy <= dot[1],\r\n    };\r\n}\r\nfunction hitTestLine(dot, _a) {\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (abs(dx) < TINY_NUM) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM) {\r\n        dy = 0;\r\n    }\r\n    var test1;\r\n    var test2;\r\n    if (!dx) {\r\n        test1 = pos1[0];\r\n        test2 = dot[0];\r\n    }\r\n    else if (!dy) {\r\n        test1 = pos1[1];\r\n        test2 = dot[1];\r\n    }\r\n    else {\r\n        var a = dy / dx;\r\n        // y = a * (x - pos1) + pos1\r\n        test1 = a * (dot[0] - pos1[0]) + pos1[1];\r\n        test2 = dot[1];\r\n    }\r\n    return test1 - test2;\r\n}\r\nfunction isSameStartLine(dots, line, centerSign, error) {\r\n    if (error === void 0) { error = TINY_NUM; }\r\n    return dots.every(function (dot) {\r\n        var value = hitTestLine(dot, line);\r\n        var sign = value <= 0;\r\n        return sign === centerSign || abs(value) <= error;\r\n    });\r\n}\r\nfunction checkInnerBoundDot(pos, start, end, isStart, threshold) {\r\n    if (threshold === void 0) { threshold = 0; }\r\n    if ((isStart && start - threshold <= pos)\r\n        || (!isStart && pos <= end + threshold)) {\r\n        // false 402 565 602 => 37 ([0, 37])\r\n        // true 400 524.9712603540036 600 => 124 ([124, 0])\r\n        // true 400 410 600 => 10 ([10, 0])\r\n        return {\r\n            isBound: true,\r\n            offset: isStart ? start - pos : end - pos,\r\n        };\r\n    }\r\n    return {\r\n        isBound: false,\r\n        offset: 0,\r\n    };\r\n}\r\nfunction checkInnerBound(moveable, _a) {\r\n    var line = _a.line, centerSign = _a.centerSign, verticalSign = _a.verticalSign, horizontalSign = _a.horizontalSign, lineConstants = _a.lineConstants;\r\n    var bounds = moveable.props.innerBounds;\r\n    if (!bounds) {\r\n        return {\r\n            isAllBound: false,\r\n            isBound: false,\r\n            isVerticalBound: false,\r\n            isHorizontalBound: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    var left = bounds.left, top = bounds.top, width = bounds.width, height = bounds.height;\r\n    var leftLine = [[left, top], [left, top + height]];\r\n    var topLine = [[left, top], [left + width, top]];\r\n    var rightLine = [[left + width, top], [left + width, top + height]];\r\n    var bottomLine = [[left, top + height], [left + width, top + height]];\r\n    if (isSameStartLine([\r\n        [left, top],\r\n        [left + width, top],\r\n        [left, top + height],\r\n        [left + width, top + height],\r\n    ], line, centerSign)) {\r\n        return {\r\n            isAllBound: false,\r\n            isBound: false,\r\n            isVerticalBound: false,\r\n            isHorizontalBound: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    // test vertical\r\n    var topBoundInfo = checkLineBoundCollision(line, lineConstants, topLine, verticalSign);\r\n    var bottomBoundInfo = checkLineBoundCollision(line, lineConstants, bottomLine, verticalSign);\r\n    // test horizontal\r\n    var leftBoundInfo = checkLineBoundCollision(line, lineConstants, leftLine, horizontalSign);\r\n    var rightBoundInfo = checkLineBoundCollision(line, lineConstants, rightLine, horizontalSign);\r\n    var isAllVerticalBound = topBoundInfo.isBound && bottomBoundInfo.isBound;\r\n    var isVerticalBound = topBoundInfo.isBound || bottomBoundInfo.isBound;\r\n    var isAllHorizontalBound = leftBoundInfo.isBound && rightBoundInfo.isBound;\r\n    var isHorizontalBound = leftBoundInfo.isBound || rightBoundInfo.isBound;\r\n    var verticalOffset = maxOffset(topBoundInfo.offset, bottomBoundInfo.offset);\r\n    var horizontalOffset = maxOffset(leftBoundInfo.offset, rightBoundInfo.offset);\r\n    var offset = [0, 0];\r\n    var isBound = false;\r\n    var isAllBound = false;\r\n    if (abs(horizontalOffset) < abs(verticalOffset)) {\r\n        offset = [verticalOffset, 0];\r\n        isBound = isVerticalBound;\r\n        isAllBound = isAllVerticalBound;\r\n    }\r\n    else {\r\n        offset = [0, horizontalOffset];\r\n        isBound = isHorizontalBound;\r\n        isAllBound = isAllHorizontalBound;\r\n    }\r\n    return {\r\n        isAllBound: isAllBound,\r\n        isVerticalBound: isVerticalBound,\r\n        isHorizontalBound: isHorizontalBound,\r\n        isBound: isBound,\r\n        offset: offset,\r\n    };\r\n}\r\nfunction checkLineBoundCollision(line, _a, boundLine, isStart, threshold, isRender) {\r\n    var _b = __read(_a, 2), a = _b[0], b = _b[1];\r\n    var dot1 = line[0];\r\n    // const dot2 = line[1];\r\n    var boundDot1 = boundLine[0];\r\n    var boundDot2 = boundLine[1];\r\n    // const dy1 = getTinyDist(dot2[1] - dot1[1]);\r\n    // const dx1 = getTinyDist(dot2[0] - dot1[0]);\r\n    var dy2 = getTinyDist(boundDot2[1] - boundDot1[1]);\r\n    var dx2 = getTinyDist(boundDot2[0] - boundDot1[0]);\r\n    var hasDx = b;\r\n    var hasDy = a;\r\n    var slope = -a / b;\r\n    // lineConstants\r\n    // ax + by + c = 0\r\n    // dx2 or dy2 is zero\r\n    if (!dx2) {\r\n        // vertical\r\n        // by + c = 0\r\n        if (isRender && !hasDy) {\r\n            // 90deg\r\n            return {\r\n                isBound: false,\r\n                offset: 0,\r\n            };\r\n        }\r\n        else if (hasDx) {\r\n            // ax + by + c = 0\r\n            // const y = dy1 ? dy1 / dx1 * (boundDot1[0] - dot1[0]) + dot1[1] : dot1[1];\r\n            var y = slope * (boundDot1[0] - dot1[0]) + dot1[1];\r\n            // boundDot1[1] <= y  <= boundDot2[1]\r\n            return checkInnerBoundDot(y, boundDot1[1], boundDot2[1], isStart, threshold);\r\n        }\r\n        else {\r\n            // ax + c = 0\r\n            var offset = boundDot1[0] - dot1[0];\r\n            var isBound = abs(offset) <= (threshold || 0);\r\n            return {\r\n                isBound: isBound,\r\n                offset: isBound ? offset : 0,\r\n            };\r\n        }\r\n    }\r\n    else if (!dy2) {\r\n        // horizontal\r\n        if (isRender && !hasDx) {\r\n            // 90deg\r\n            return {\r\n                isBound: false,\r\n                offset: 0,\r\n            };\r\n        }\r\n        else if (hasDy) {\r\n            // y = a * (x - x1) + y1\r\n            // x = (y - y1) / a + x1\r\n            // const a = dy1 / dx1;\r\n            // const x = dx1 ? (boundDot1[1] - dot1[1]) / a + dot1[0] : dot1[0];\r\n            var x = (boundDot1[1] - dot1[1]) / slope + dot1[0];\r\n            // boundDot1[0] <= x && x <= boundDot2[0]\r\n            return checkInnerBoundDot(x, boundDot1[0], boundDot2[0], isStart, threshold);\r\n        }\r\n        else {\r\n            var offset = boundDot1[1] - dot1[1];\r\n            var isBound = abs(offset) <= (threshold || 0);\r\n            return {\r\n                isBound: isBound,\r\n                offset: isBound ? offset : 0,\r\n            };\r\n        }\r\n    }\r\n    return {\r\n        isBound: false,\r\n        offset: 0,\r\n    };\r\n}\r\nfunction getInnerBoundInfo(moveable, lineInfos, datas) {\r\n    return lineInfos.map(function (info) {\r\n        var _a = checkInnerBound(moveable, info), isBound = _a.isBound, offset = _a.offset, isVerticalBound = _a.isVerticalBound, isHorizontalBound = _a.isHorizontalBound;\r\n        var multiple = info.multiple;\r\n        var sizeOffset = getDragDist({\r\n            datas: datas,\r\n            distX: offset[0],\r\n            distY: offset[1],\r\n        }).map(function (size, i) { return size * (multiple[i] ? 2 / multiple[i] : 0); });\r\n        return {\r\n            sign: multiple,\r\n            isBound: isBound,\r\n            isVerticalBound: isVerticalBound,\r\n            isHorizontalBound: isHorizontalBound,\r\n            isSnap: false,\r\n            offset: sizeOffset,\r\n        };\r\n    });\r\n}\r\nfunction getInnerBoundDragInfo(moveable, poses, datas) {\r\n    var _a;\r\n    var lines = getCheckInnerBoundLineInfos(moveable, poses, [0, 0], false).map(function (info) {\r\n        return __assign(__assign({}, info), { multiple: info.multiple.map(function (dir) { return abs(dir) * 2; }) });\r\n    });\r\n    var innerBoundInfo = getInnerBoundInfo(moveable, lines, datas);\r\n    var widthOffsetInfo = getNearOffsetInfo(innerBoundInfo, 0);\r\n    var heightOffsetInfo = getNearOffsetInfo(innerBoundInfo, 1);\r\n    var verticalOffset = 0;\r\n    var horizontalOffset = 0;\r\n    var isVerticalBound = widthOffsetInfo.isVerticalBound || heightOffsetInfo.isVerticalBound;\r\n    var isHorizontalBound = widthOffsetInfo.isHorizontalBound || heightOffsetInfo.isHorizontalBound;\r\n    if (isVerticalBound || isHorizontalBound) {\r\n        _a = __read(getInverseDragDist({\r\n            datas: datas,\r\n            distX: -widthOffsetInfo.offset[0],\r\n            distY: -heightOffsetInfo.offset[1],\r\n        }), 2), verticalOffset = _a[0], horizontalOffset = _a[1];\r\n    }\r\n    return {\r\n        vertical: {\r\n            isBound: isVerticalBound,\r\n            offset: verticalOffset,\r\n        },\r\n        horizontal: {\r\n            isBound: isHorizontalBound,\r\n            offset: horizontalOffset,\r\n        },\r\n    };\r\n}\r\nfunction getCheckSnapLineDirections(direction, keepRatio) {\r\n    var lineDirections = [];\r\n    var x = direction[0];\r\n    var y = direction[1];\r\n    if (x && y) {\r\n        lineDirections.push([[0, y * 2], direction, [-x, y]], [[x * 2, 0], direction, [x, -y]]);\r\n    }\r\n    else if (x) {\r\n        // vertcal\r\n        lineDirections.push([[x * 2, 0], [x, 1], [x, -1]]);\r\n        if (keepRatio) {\r\n            lineDirections.push([[0, -1], [x, -1], [-x, -1]], [[0, 1], [x, 1], [-x, 1]]);\r\n        }\r\n    }\r\n    else if (y) {\r\n        // horizontal\r\n        lineDirections.push([[0, y * 2], [1, y], [-1, y]]);\r\n        if (keepRatio) {\r\n            lineDirections.push([[-1, 0], [-1, y], [-1, -y]], [[1, 0], [1, y], [1, -y]]);\r\n        }\r\n    }\r\n    else {\r\n        // [0, 0] to all direction\r\n        lineDirections.push([[-1, 0], [-1, -1], [-1, 1]], [[1, 0], [1, -1], [1, 1]], [[0, -1], [-1, -1], [1, -1]], [[0, 1], [-1, 1], [1, 1]]);\r\n    }\r\n    return lineDirections;\r\n}\r\nfunction getCheckInnerBoundLineInfos(moveable, poses, direction, keepRatio) {\r\n    var _a = moveable.state, allMatrix = _a.allMatrix, is3d = _a.is3d;\r\n    var virtualPoses = calculatePoses(allMatrix, 100, 100, is3d ? 4 : 3);\r\n    var center = getPosByDirection(virtualPoses, [0, 0]);\r\n    return getCheckSnapLineDirections(direction, keepRatio).map(function (_a) {\r\n        var _b = __read(_a, 3), multiple = _b[0], dir1 = _b[1], dir2 = _b[2];\r\n        var virtualLine = [\r\n            getPosByDirection(virtualPoses, dir1),\r\n            getPosByDirection(virtualPoses, dir2),\r\n        ];\r\n        var lineConstants = solveLineConstants(virtualLine);\r\n        var _c = isStartLine(center, virtualLine), verticalSign = _c.vertical, horizontalSign = _c.horizontal;\r\n        var centerSign = hitTestLine(center, virtualLine) <= 0;\r\n        return {\r\n            multiple: multiple,\r\n            centerSign: centerSign,\r\n            verticalSign: verticalSign,\r\n            horizontalSign: horizontalSign,\r\n            lineConstants: lineConstants,\r\n            line: [\r\n                getPosByDirection(poses, dir1),\r\n                getPosByDirection(poses, dir2),\r\n            ],\r\n        };\r\n    });\r\n}\r\nfunction isBoundRotate(relativePoses, boundDots, center, rad) {\r\n    var nextPoses = rad ? relativePoses.map(function (pos) { return rotate(pos, rad); }) : relativePoses;\r\n    return [\r\n        [nextPoses[0], nextPoses[1]],\r\n        [nextPoses[1], nextPoses[3]],\r\n        [nextPoses[3], nextPoses[2]],\r\n        [nextPoses[2], nextPoses[0]],\r\n    ].some(function (line) {\r\n        var centerSign = hitTestLine(center, line) <= 0;\r\n        return !isSameStartLine(boundDots, line, centerSign);\r\n    });\r\n}\r\nfunction getDistPointLine(_a) {\r\n    // x = 0, y = 0\r\n    // d = (ax + by + c) / root(a2 + b2)\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (!dx) {\r\n        return abs(pos1[0]);\r\n    }\r\n    if (!dy) {\r\n        return abs(pos1[1]);\r\n    }\r\n    // y - y1 = a(x - x1)\r\n    // 0 = ax -y + -a * x1 + y1\r\n    var a = dy / dx;\r\n    return abs((-a * pos1[0] + pos1[1]) / Math.sqrt(Math.pow(a, 2) + 1));\r\n}\r\nfunction solveReverseLine(_a) {\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (!dx) {\r\n        return [pos1[0], 0];\r\n    }\r\n    if (!dy) {\r\n        return [0, pos1[1]];\r\n    }\r\n    var a = dy / dx;\r\n    // y - y1 = a (x  - x1)\r\n    // y = ax - a * x1 + y1\r\n    var b = -a * pos1[0] + pos1[1];\r\n    // y = ax + b = -1/a x\r\n    // x = -b / (a + 1 / a)\r\n    // y = b / (1 + 1 / a^2)\r\n    return [\r\n        -b / (a + 1 / a),\r\n        b / ((a * a) + 1),\r\n    ];\r\n}\r\nfunction checkRotateInnerBounds(moveable, prevPoses, nextPoses, origin, rotation) {\r\n    var bounds = moveable.props.innerBounds;\r\n    var rad = rotation * Math.PI / 180;\r\n    if (!bounds) {\r\n        return [];\r\n    }\r\n    var left = bounds.left, top = bounds.top, width = bounds.width, height = bounds.height;\r\n    var relativeLeft = left - origin[0];\r\n    var relativeRight = left + width - origin[0];\r\n    var relativeTop = top - origin[1];\r\n    var relativeBottom = top + height - origin[1];\r\n    var dots = [\r\n        [relativeLeft, relativeTop],\r\n        [relativeRight, relativeTop],\r\n        [relativeLeft, relativeBottom],\r\n        [relativeRight, relativeBottom],\r\n    ];\r\n    var center = getPosByDirection(nextPoses, [0, 0]);\r\n    if (!isBoundRotate(nextPoses, dots, center, 0)) {\r\n        return [];\r\n    }\r\n    var result = [];\r\n    var dotInfos = dots.map(function (dot) { return [\r\n        getDistSize(dot),\r\n        getRad([0, 0], dot),\r\n    ]; });\r\n    [\r\n        [nextPoses[0], nextPoses[1]],\r\n        [nextPoses[1], nextPoses[3]],\r\n        [nextPoses[3], nextPoses[2]],\r\n        [nextPoses[2], nextPoses[0]],\r\n    ].forEach(function (line) {\r\n        var lineRad = getRad([0, 0], solveReverseLine(line));\r\n        var lineDist = getDistPointLine(line);\r\n        result.push.apply(result, __spreadArray([], __read(dotInfos\r\n            .filter(function (_a) {\r\n            var _b = __read(_a, 1), dotDist = _b[0];\r\n            return dotDist && lineDist <= dotDist;\r\n        })\r\n            .map(function (_a) {\r\n            var _b = __read(_a, 2), dotDist = _b[0], dotRad = _b[1];\r\n            var distRad = Math.acos(dotDist ? lineDist / dotDist : 0);\r\n            var nextRad1 = dotRad + distRad;\r\n            var nextRad2 = dotRad - distRad;\r\n            return [\r\n                rad + nextRad1 - lineRad,\r\n                rad + nextRad2 - lineRad,\r\n            ];\r\n        })\r\n            .reduce(function (prev, cur) {\r\n            prev.push.apply(prev, __spreadArray([], __read(cur), false));\r\n            return prev;\r\n        }, [])\r\n            .filter(function (nextRad) { return !isBoundRotate(prevPoses, dots, center, nextRad); })\r\n            .map(function (nextRad) { return throttle(nextRad * 180 / Math.PI, TINY_NUM); })), false));\r\n    });\r\n    return result;\r\n}\r\nfunction checkInnerBoundPoses(moveable) {\r\n    var innerBounds = moveable.props.innerBounds;\r\n    var boundMap = getInitialBounds();\r\n    if (!innerBounds) {\r\n        return {\r\n            boundMap: boundMap,\r\n            vertical: [],\r\n            horizontal: [],\r\n        };\r\n    }\r\n    var _a = moveable.getRect(), pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n    var poses = [pos1, pos2, pos3, pos4];\r\n    var center = getPosByDirection(poses, [0, 0]);\r\n    var left = innerBounds.left, top = innerBounds.top, width = innerBounds.width, height = innerBounds.height;\r\n    var leftLine = [[left, top], [left, top + height]];\r\n    var topLine = [[left, top], [left + width, top]];\r\n    var rightLine = [[left + width, top], [left + width, top + height]];\r\n    var bottomLine = [[left, top + height], [left + width, top + height]];\r\n    var lineInfos = getCheckInnerBoundLineInfos(moveable, poses, [0, 0], false);\r\n    var horizontalPoses = [];\r\n    var verticalPoses = [];\r\n    lineInfos.forEach(function (lineInfo) {\r\n        var line = lineInfo.line, lineConstants = lineInfo.lineConstants;\r\n        var _a = isStartLine(center, line), isHorizontalStart = _a.horizontal, isVerticalStart = _a.vertical;\r\n        // test vertical\r\n        var topBoundInfo = checkLineBoundCollision(line, lineConstants, topLine, isVerticalStart, 1, true);\r\n        var bottomBoundInfo = checkLineBoundCollision(line, lineConstants, bottomLine, isVerticalStart, 1, true);\r\n        // test horizontal\r\n        var leftBoundInfo = checkLineBoundCollision(line, lineConstants, leftLine, isHorizontalStart, 1, true);\r\n        var rightBoundInfo = checkLineBoundCollision(line, lineConstants, rightLine, isHorizontalStart, 1, true);\r\n        if (topBoundInfo.isBound && !boundMap.top) {\r\n            horizontalPoses.push(top);\r\n            boundMap.top = true;\r\n        }\r\n        if (bottomBoundInfo.isBound && !boundMap.bottom) {\r\n            horizontalPoses.push(top + height);\r\n            boundMap.bottom = true;\r\n        }\r\n        if (leftBoundInfo.isBound && !boundMap.left) {\r\n            verticalPoses.push(left);\r\n            boundMap.left = true;\r\n        }\r\n        if (rightBoundInfo.isBound && !boundMap.right) {\r\n            verticalPoses.push(left + width);\r\n            boundMap.right = true;\r\n        }\r\n    });\r\n    return {\r\n        boundMap: boundMap,\r\n        horizontal: horizontalPoses,\r\n        vertical: verticalPoses,\r\n    };\r\n}\n\nfunction solveEquation(pos1, pos2, snapOffset, isVertical) {\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (abs(dx) < TINY_NUM$1) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM$1) {\r\n        dy = 0;\r\n    }\r\n    if (!dx) {\r\n        // y = 0 * x + b\r\n        // only horizontal\r\n        if (!isVertical) {\r\n            return [0, snapOffset];\r\n        }\r\n        return [0, 0];\r\n    }\r\n    if (!dy) {\r\n        // only vertical\r\n        if (isVertical) {\r\n            return [snapOffset, 0];\r\n        }\r\n        return [0, 0];\r\n    }\r\n    // y = ax + b\r\n    var a = dy / dx;\r\n    var b = pos1[1] - a * pos1[0];\r\n    if (isVertical) {\r\n        // y = a * x + b\r\n        var y = a * (pos2[0] + snapOffset) + b;\r\n        return [snapOffset, y - pos2[1]];\r\n    }\r\n    else {\r\n        // x = (y - b) / a\r\n        var x = (pos2[1] + snapOffset - b) / a;\r\n        return [x - pos2[0], snapOffset];\r\n    }\r\n}\r\nfunction solveNextOffset(pos1, pos2, offset, isVertical, datas) {\r\n    var sizeOffset = solveEquation(pos1, pos2, offset, isVertical);\r\n    if (!sizeOffset) {\r\n        return {\r\n            isOutside: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    var size = getDist$1(pos1, pos2);\r\n    var dist1 = getDist$1(sizeOffset, pos1);\r\n    var dist2 = getDist$1(sizeOffset, pos2);\r\n    var isOutside = dist1 > size || dist2 > size;\r\n    var _a = __read(getDragDist({\r\n        datas: datas,\r\n        distX: sizeOffset[0],\r\n        distY: sizeOffset[1],\r\n    }), 2), widthOffset = _a[0], heightOffset = _a[1];\r\n    return {\r\n        offset: [widthOffset, heightOffset],\r\n        isOutside: isOutside,\r\n    };\r\n}\r\nfunction getSnapBound(boundInfo, snapInfo) {\r\n    if (boundInfo.isBound) {\r\n        return boundInfo.offset;\r\n    }\r\n    else if (snapInfo.isSnap) {\r\n        return getNearestSnapGuidelineInfo(snapInfo).offset;\r\n    }\r\n    return 0;\r\n}\r\nfunction checkThrottleDragRotate(throttleDragRotate, _a, _b, _c, _d) {\r\n    var _e = __read(_a, 2), distX = _e[0], distY = _e[1];\r\n    var _f = __read(_b, 2), isVerticalBound = _f[0], isHorizontalBound = _f[1];\r\n    var _g = __read(_c, 2), isVerticalSnap = _g[0], isHorizontalSnap = _g[1];\r\n    var _h = __read(_d, 2), verticalOffset = _h[0], horizontalOffset = _h[1];\r\n    var offsetX = -verticalOffset;\r\n    var offsetY = -horizontalOffset;\r\n    if (throttleDragRotate && distX && distY) {\r\n        offsetX = 0;\r\n        offsetY = 0;\r\n        var adjustPoses = [];\r\n        if (isVerticalBound && isHorizontalBound) {\r\n            adjustPoses.push([0, horizontalOffset], [verticalOffset, 0]);\r\n        }\r\n        else if (isVerticalBound) {\r\n            adjustPoses.push([verticalOffset, 0]);\r\n        }\r\n        else if (isHorizontalBound) {\r\n            adjustPoses.push([0, horizontalOffset]);\r\n        }\r\n        else if (isVerticalSnap && isHorizontalSnap) {\r\n            adjustPoses.push([0, horizontalOffset], [verticalOffset, 0]);\r\n        }\r\n        else if (isVerticalSnap) {\r\n            adjustPoses.push([verticalOffset, 0]);\r\n        }\r\n        else if (isHorizontalSnap) {\r\n            adjustPoses.push([0, horizontalOffset]);\r\n        }\r\n        if (adjustPoses.length) {\r\n            adjustPoses.sort(function (a, b) {\r\n                return (getDistSize(minus([distX, distY], a)) -\r\n                    getDistSize(minus([distX, distY], b)));\r\n            });\r\n            var adjustPos = adjustPoses[0];\r\n            if (adjustPos[0] && abs(distX) > TINY_NUM$1) {\r\n                offsetX = -adjustPos[0];\r\n                offsetY =\r\n                    (distY * abs(distX + offsetX)) / abs(distX) -\r\n                        distY;\r\n            }\r\n            else if (adjustPos[1] && abs(distY) > TINY_NUM$1) {\r\n                var prevDistY = distY;\r\n                offsetY = -adjustPos[1];\r\n                offsetX =\r\n                    (distX * abs(distY + offsetY)) / abs(prevDistY) -\r\n                        distX;\r\n            }\r\n            if (throttleDragRotate && isHorizontalBound && isVerticalBound) {\r\n                if (abs(offsetX) > TINY_NUM$1 &&\r\n                    abs(offsetX) < abs(verticalOffset)) {\r\n                    var scale = abs(verticalOffset) / abs(offsetX);\r\n                    offsetX *= scale;\r\n                    offsetY *= scale;\r\n                }\r\n                else if (abs(offsetY) > TINY_NUM$1 &&\r\n                    abs(offsetY) < abs(horizontalOffset)) {\r\n                    var scale = abs(horizontalOffset) / abs(offsetY);\r\n                    offsetX *= scale;\r\n                    offsetY *= scale;\r\n                }\r\n                else {\r\n                    offsetX = maxOffset(-verticalOffset, offsetX);\r\n                    offsetY = maxOffset(-horizontalOffset, offsetY);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        offsetX = distX || isVerticalBound ? -verticalOffset : 0;\r\n        offsetY = distY || isHorizontalBound ? -horizontalOffset : 0;\r\n    }\r\n    return [offsetX, offsetY];\r\n}\r\nfunction checkSnapBoundsDrag(moveable, distX, distY, throttleDragRotate, ignoreSnap, datas) {\r\n    if (!hasGuidelines(moveable, \"draggable\")) {\r\n        return [\r\n            {\r\n                isSnap: false,\r\n                isBound: false,\r\n                offset: 0,\r\n            },\r\n            {\r\n                isSnap: false,\r\n                isBound: false,\r\n                offset: 0,\r\n            },\r\n        ];\r\n    }\r\n    var poses = getAbsolutePoses(datas.absolutePoses, [distX, distY]);\r\n    var _a = getRect(poses), left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n    var boundPoses = {\r\n        horizontal: poses.map(function (pos) { return pos[1]; }),\r\n        vertical: poses.map(function (pos) { return pos[0]; }),\r\n    };\r\n    var snapDirections = getSnapDirections(moveable.props.snapDirections);\r\n    var snapPoses = splitSnapDirectionPoses(snapDirections, {\r\n        left: left,\r\n        right: right,\r\n        top: top,\r\n        bottom: bottom,\r\n        center: (left + right) / 2,\r\n        middle: (top + bottom) / 2,\r\n    });\r\n    var _b = checkMoveableSnapBounds(moveable, ignoreSnap, snapPoses, boundPoses), verticalSnapBoundInfo = _b.vertical, horizontalSnapBoundInfo = _b.horizontal;\r\n    var _c = getInnerBoundDragInfo(moveable, poses, datas), verticalInnerBoundInfo = _c.vertical, horizontalInnerBoundInfo = _c.horizontal;\r\n    var isVerticalSnap = verticalSnapBoundInfo.isSnap;\r\n    var isHorizontalSnap = horizontalSnapBoundInfo.isSnap;\r\n    var isVerticalBound = verticalSnapBoundInfo.isBound || verticalInnerBoundInfo.isBound;\r\n    var isHorizontalBound = horizontalSnapBoundInfo.isBound || horizontalInnerBoundInfo.isBound;\r\n    var verticalOffset = maxOffset(verticalSnapBoundInfo.offset, verticalInnerBoundInfo.offset);\r\n    var horizontalOffset = maxOffset(horizontalSnapBoundInfo.offset, horizontalInnerBoundInfo.offset);\r\n    var _d = __read(checkThrottleDragRotate(throttleDragRotate, [distX, distY], [isVerticalBound, isHorizontalBound], [isVerticalSnap, isHorizontalSnap], [verticalOffset, horizontalOffset]), 2), offsetX = _d[0], offsetY = _d[1];\r\n    return [\r\n        {\r\n            isBound: isVerticalBound,\r\n            isSnap: isVerticalSnap,\r\n            offset: offsetX,\r\n        },\r\n        {\r\n            isBound: isHorizontalBound,\r\n            isSnap: isHorizontalSnap,\r\n            offset: offsetY,\r\n        },\r\n    ];\r\n}\r\nfunction checkMoveableSnapBounds(moveable, ignoreSnap, poses, boundPoses) {\r\n    if (boundPoses === void 0) { boundPoses = poses; }\r\n    var _a = checkBoundPoses(getBounds(moveable), boundPoses.vertical, boundPoses.horizontal), horizontalBoundInfos = _a.horizontal, verticalBoundInfos = _a.vertical;\r\n    var _b = ignoreSnap ? {\r\n        horizontal: { isSnap: false, index: -1 },\r\n        vertical: { isSnap: false, index: -1 },\r\n    } : checkMoveableSnapPoses(moveable, poses.vertical, poses.horizontal, undefined, undefined, undefined, undefined), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBound(horizontalBoundInfos[0], horizontalSnapInfo);\r\n    var verticalOffset = getSnapBound(verticalBoundInfos[0], verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfos[0].isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            snapIndex: horizontalSnapInfo.index,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n            bounds: horizontalBoundInfos,\r\n            snap: horizontalSnapInfo,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfos[0].isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            snapIndex: verticalSnapInfo.index,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n            bounds: verticalBoundInfos,\r\n            snap: verticalSnapInfo,\r\n        },\r\n    };\r\n}\r\nfunction checkSnapBounds(guideines, bounds, posesX, posesY, snapHorizontalThreshold, snapVerticalThreshold, multiples) {\r\n    if (multiples === void 0) { multiples = [1, 1]; }\r\n    var _a = checkBoundPoses(bounds, posesX, posesY), horizontalBoundInfos = _a.horizontal, verticalBoundInfos = _a.vertical;\r\n    // options.isRequest ? {\r\n    //     horizontal: { isSnap: false, index: -1 } as SnapInfo,\r\n    //     vertical: { isSnap: false, index: -1 } as SnapInfo,\r\n    // } :\r\n    var _b = checkSnapPoses(guideines, posesX, posesY, [], [], snapHorizontalThreshold, snapVerticalThreshold, multiples), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBound(horizontalBoundInfos[0], horizontalSnapInfo);\r\n    var verticalOffset = getSnapBound(verticalBoundInfos[0], verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfos[0].isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            snapIndex: horizontalSnapInfo.index,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n            bounds: horizontalBoundInfos,\r\n            snap: horizontalSnapInfo,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfos[0].isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            snapIndex: verticalSnapInfo.index,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n            bounds: verticalBoundInfos,\r\n            snap: verticalSnapInfo,\r\n        },\r\n    };\r\n}\r\nfunction checkSnapRightLine(startPos, endPos, snapBoundInfo, keepRatio) {\r\n    var rad = (getRad(startPos, endPos) / Math.PI) * 180;\r\n    var _a = snapBoundInfo.vertical, isVerticalBound = _a.isBound, isVerticalSnap = _a.isSnap, verticalDist = _a.dist, _b = snapBoundInfo.horizontal, isHorizontalBound = _b.isBound, isHorizontalSnap = _b.isSnap, horizontalDist = _b.dist;\r\n    var rad180 = rad % 180;\r\n    var isHorizontalLine = rad180 < 3 || rad180 > 177;\r\n    var isVerticalLine = rad180 > 87 && rad180 < 93;\r\n    if (horizontalDist < verticalDist) {\r\n        if (isVerticalBound ||\r\n            (isVerticalSnap &&\r\n                !isVerticalLine &&\r\n                (!keepRatio || !isHorizontalLine))) {\r\n            return \"vertical\";\r\n        }\r\n    }\r\n    if (isHorizontalBound ||\r\n        (isHorizontalSnap &&\r\n            !isHorizontalLine &&\r\n            (!keepRatio || !isVerticalLine))) {\r\n        return \"horizontal\";\r\n    }\r\n    return \"\";\r\n}\r\nfunction getSnapBoundInfo(moveable, poses, directions, keepRatio, isRequest, datas) {\r\n    return directions.map(function (_a) {\r\n        var _b = __read(_a, 2), startDirection = _b[0], endDirection = _b[1];\r\n        var otherStartPos = getPosByDirection(poses, startDirection);\r\n        var otherEndPos = getPosByDirection(poses, endDirection);\r\n        var snapBoundInfo = keepRatio\r\n            ? checkSnapBoundsKeepRatio(moveable, otherStartPos, otherEndPos, isRequest)\r\n            : checkMoveableSnapBounds(moveable, isRequest, {\r\n                vertical: [otherEndPos[0]],\r\n                horizontal: [otherEndPos[1]],\r\n            });\r\n        var _c = snapBoundInfo.horizontal, \r\n        // dist: otherHorizontalDist,\r\n        otherHorizontalOffset = _c.offset, isOtherHorizontalBound = _c.isBound, isOtherHorizontalSnap = _c.isSnap, _d = snapBoundInfo.vertical, \r\n        // dist: otherVerticalDist,\r\n        otherVerticalOffset = _d.offset, isOtherVerticalBound = _d.isBound, isOtherVerticalSnap = _d.isSnap;\r\n        var multiple = minus(endDirection, startDirection);\r\n        if (!otherVerticalOffset && !otherHorizontalOffset) {\r\n            return {\r\n                isBound: isOtherVerticalBound || isOtherHorizontalBound,\r\n                isSnap: isOtherVerticalSnap || isOtherHorizontalSnap,\r\n                sign: multiple,\r\n                offset: [0, 0],\r\n            };\r\n        }\r\n        var snapLine = checkSnapRightLine(otherStartPos, otherEndPos, snapBoundInfo, keepRatio);\r\n        if (!snapLine) {\r\n            return {\r\n                sign: multiple,\r\n                isBound: false,\r\n                isSnap: false,\r\n                offset: [0, 0],\r\n            };\r\n        }\r\n        var isVertical = snapLine === \"vertical\";\r\n        var sizeOffset = [0, 0];\r\n        if (!keepRatio\r\n            && abs(endDirection[0]) === 1\r\n            && abs(endDirection[1]) === 1\r\n            && startDirection[0] !== endDirection[0]\r\n            && startDirection[1] !== endDirection[1]) {\r\n            sizeOffset = getDragDist({\r\n                datas: datas,\r\n                distX: -otherVerticalOffset,\r\n                distY: -otherHorizontalOffset,\r\n            });\r\n        }\r\n        else {\r\n            sizeOffset = solveNextOffset(otherStartPos, otherEndPos, -(isVertical ? otherVerticalOffset : otherHorizontalOffset), isVertical, datas).offset;\r\n        }\r\n        sizeOffset = sizeOffset.map(function (size, i) { return size * (multiple[i] ? 2 / multiple[i] : 0); });\r\n        return {\r\n            sign: multiple,\r\n            isBound: isVertical ? isOtherVerticalBound : isOtherHorizontalBound,\r\n            isSnap: isVertical ? isOtherVerticalSnap : isOtherHorizontalSnap,\r\n            offset: sizeOffset,\r\n        };\r\n    });\r\n}\r\nfunction getSnapBoundOffset(boundInfo, snapInfo) {\r\n    if (boundInfo.isBound) {\r\n        return boundInfo.offset;\r\n    }\r\n    else if (snapInfo.isSnap) {\r\n        return snapInfo.offset;\r\n    }\r\n    return 0;\r\n}\r\nfunction checkSnapBoundsKeepRatio(moveable, startPos, endPos, isRequest) {\r\n    var _a = checkBoundKeepRatio(moveable, startPos, endPos), horizontalBoundInfo = _a.horizontal, verticalBoundInfo = _a.vertical;\r\n    var _b = isRequest ? {\r\n        horizontal: { isSnap: false },\r\n        vertical: { isSnap: false },\r\n    } : checkSnapKeepRatio(moveable, startPos, endPos), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBoundOffset(horizontalBoundInfo, horizontalSnapInfo);\r\n    var verticalOffset = getSnapBoundOffset(verticalBoundInfo, verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfo.isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfo.isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n        },\r\n    };\r\n}\r\nfunction checkMaxBounds(moveable, poses, direction, fixedPosition, datas) {\r\n    var fixedDirection = [-direction[0], -direction[1]];\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    var bounds = moveable.props.bounds;\r\n    var maxWidth = Infinity;\r\n    var maxHeight = Infinity;\r\n    if (bounds) {\r\n        var directions = [\r\n            [direction[0], -direction[1]],\r\n            [-direction[0], direction[1]],\r\n        ];\r\n        var _b = bounds.left, left_1 = _b === void 0 ? -Infinity : _b, _c = bounds.top, top_1 = _c === void 0 ? -Infinity : _c, _d = bounds.right, right_1 = _d === void 0 ? Infinity : _d, _e = bounds.bottom, bottom_1 = _e === void 0 ? Infinity : _e;\r\n        directions.forEach(function (otherDirection) {\r\n            var isCheckVertical = otherDirection[0] !== fixedDirection[0];\r\n            var isCheckHorizontal = otherDirection[1] !== fixedDirection[1];\r\n            var otherPos = getPosByDirection(poses, otherDirection);\r\n            var deg = (getRad(fixedPosition, otherPos) * 360) / Math.PI;\r\n            if (isCheckHorizontal) {\r\n                var nextOtherPos = otherPos.slice();\r\n                if (abs(deg - 360) < 2 || abs(deg - 180) < 2) {\r\n                    nextOtherPos[1] = fixedPosition[1];\r\n                }\r\n                var _a = solveNextOffset(fixedPosition, nextOtherPos, (fixedPosition[1] < otherPos[1] ? bottom_1 : top_1) -\r\n                    otherPos[1], false, datas), _b = __read(_a.offset, 2), heightOffset = _b[1], isHeightOutside = _a.isOutside;\r\n                if (!isNaN(heightOffset)) {\r\n                    maxHeight = height + (isHeightOutside ? 1 : -1) * abs(heightOffset);\r\n                }\r\n            }\r\n            if (isCheckVertical) {\r\n                var nextOtherPos = otherPos.slice();\r\n                if (abs(deg - 90) < 2 || abs(deg - 270) < 2) {\r\n                    nextOtherPos[0] = fixedPosition[0];\r\n                }\r\n                var _c = solveNextOffset(fixedPosition, nextOtherPos, (fixedPosition[0] < otherPos[0] ? right_1 : left_1) - otherPos[0], true, datas), _d = __read(_c.offset, 1), widthOffset = _d[0], isWidthOutside = _c.isOutside;\r\n                if (!isNaN(widthOffset)) {\r\n                    maxWidth = width + (isWidthOutside ? 1 : -1) * abs(widthOffset);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return {\r\n        maxWidth: maxWidth,\r\n        maxHeight: maxHeight,\r\n    };\r\n}\n\n/**\r\n * @namespace Draggable\r\n * @memberof Moveable\r\n * @description Draggable refers to the ability to drag and move targets.\r\n */\r\nvar Draggable = {\r\n    name: \"draggable\",\r\n    props: [\r\n        \"draggable\",\r\n        \"throttleDrag\",\r\n        \"throttleDragRotate\",\r\n        \"hideThrottleDragRotateLine\",\r\n        \"startDragRotate\",\r\n        \"edgeDraggable\",\r\n    ],\r\n    events: [\r\n        \"dragStart\",\r\n        \"drag\",\r\n        \"dragEnd\",\r\n        \"dragGroupStart\",\r\n        \"dragGroup\",\r\n        \"dragGroupEnd\",\r\n    ],\r\n    requestStyle: function () {\r\n        return [\"left\", \"top\", \"right\", \"bottom\"];\r\n    },\r\n    requestChildStyle: function () {\r\n        return [\"left\", \"top\", \"right\", \"bottom\"];\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, hideThrottleDragRotateLine = _a.hideThrottleDragRotateLine, throttleDragRotate = _a.throttleDragRotate, zoom = _a.zoom;\r\n        var _b = moveable.getState(), dragInfo = _b.dragInfo, beforeOrigin = _b.beforeOrigin;\r\n        if (hideThrottleDragRotateLine || !throttleDragRotate || !dragInfo) {\r\n            return [];\r\n        }\r\n        var dist = dragInfo.dist;\r\n        if (!dist[0] && !dist[1]) {\r\n            return [];\r\n        }\r\n        var width = getDistSize(dist);\r\n        var rad = getRad(dist, [0, 0]);\r\n        return [React.createElement(\"div\", { className: prefix(\"line\", \"horizontal\", \"dragline\", \"dashed\"), key: \"dragRotateGuideline\", style: {\r\n                    width: \"\".concat(width, \"px\"),\r\n                    transform: \"translate(\".concat(beforeOrigin[0], \"px, \").concat(beforeOrigin[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n                } })];\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        var datas = e.datas, parentEvent = e.parentEvent, parentGesto = e.parentGesto;\r\n        var state = moveable.state;\r\n        var gestos = state.gestos, style = state.style;\r\n        if (gestos.draggable) {\r\n            return false;\r\n        }\r\n        gestos.draggable = parentGesto || moveable.targetGesto;\r\n        datas.datas = {};\r\n        datas.left = parseFloat(style.left || \"\") || 0;\r\n        datas.top = parseFloat(style.top || \"\") || 0;\r\n        datas.bottom = parseFloat(style.bottom || \"\") || 0;\r\n        datas.right = parseFloat(style.right || \"\") || 0;\r\n        datas.startValue = [0, 0];\r\n        setDragStart(moveable, e);\r\n        setDefaultTransformIndex(moveable, e, \"translate\");\r\n        startCheckSnapDrag(moveable, datas);\r\n        datas.prevDist = [0, 0];\r\n        datas.prevBeforeDist = [0, 0];\r\n        datas.isDrag = false;\r\n        datas.deltaOffset = [0, 0];\r\n        var params = fillParams(moveable, e, __assign({ set: function (translate) {\r\n                datas.startValue = translate;\r\n            } }, fillTransformStartEvent(moveable, e)));\r\n        var result = parentEvent || triggerEvent(moveable, \"onDragStart\", params);\r\n        if (result !== false) {\r\n            datas.isDrag = true;\r\n            moveable.state.dragInfo = {\r\n                startRect: moveable.getRect(),\r\n                dist: [0, 0],\r\n            };\r\n        }\r\n        else {\r\n            gestos.draggable = null;\r\n            datas.isPinch = false;\r\n        }\r\n        return datas.isDrag ? params : false;\r\n    },\r\n    drag: function (moveable, e) {\r\n        if (!e) {\r\n            return;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"translate\");\r\n        var datas = e.datas, parentEvent = e.parentEvent, parentFlag = e.parentFlag, isPinch = e.isPinch, deltaOffset = e.deltaOffset, useSnap = e.useSnap, isRequest = e.isRequest, isGroup = e.isGroup, parentThrottleDrag = e.parentThrottleDrag;\r\n        var distX = e.distX, distY = e.distY;\r\n        var isDrag = datas.isDrag, prevDist = datas.prevDist, prevBeforeDist = datas.prevBeforeDist, startValue = datas.startValue;\r\n        if (!isDrag) {\r\n            return;\r\n        }\r\n        if (deltaOffset) {\r\n            distX += deltaOffset[0];\r\n            distY += deltaOffset[1];\r\n        }\r\n        var props = moveable.props;\r\n        var parentMoveable = props.parentMoveable;\r\n        var throttleDrag = isGroup ? 0 : (props.throttleDrag || parentThrottleDrag || 0);\r\n        var throttleDragRotate = parentEvent ? 0 : (props.throttleDragRotate || 0);\r\n        var dragRotateRad = 0;\r\n        var isVerticalSnap = false;\r\n        var isVerticalBound = false;\r\n        var isHorizontalSnap = false;\r\n        var isHorizontalBound = false;\r\n        if (!parentEvent && throttleDragRotate > 0 && (distX || distY)) {\r\n            var startDragRotate = props.startDragRotate || 0;\r\n            var deg = throttle(startDragRotate + getRad([0, 0], [distX, distY]) * 180 / Math.PI, throttleDragRotate)\r\n                - startDragRotate;\r\n            var ry = distY * Math.abs(Math.cos((deg - 90) / 180 * Math.PI));\r\n            var rx = distX * Math.abs(Math.cos(deg / 180 * Math.PI));\r\n            var r = getDistSize([rx, ry]);\r\n            dragRotateRad = deg * Math.PI / 180;\r\n            distX = r * Math.cos(dragRotateRad);\r\n            distY = r * Math.sin(dragRotateRad);\r\n        }\r\n        if (!isPinch && !parentEvent && !parentFlag) {\r\n            var _a = __read(checkSnapBoundsDrag(moveable, distX, distY, throttleDragRotate, (!useSnap && isRequest) || deltaOffset, datas), 2), verticalInfo = _a[0], horizontalInfo = _a[1];\r\n            isVerticalSnap = verticalInfo.isSnap;\r\n            isVerticalBound = verticalInfo.isBound;\r\n            isHorizontalSnap = horizontalInfo.isSnap;\r\n            isHorizontalBound = horizontalInfo.isBound;\r\n            var verticalOffset = verticalInfo.offset;\r\n            var horizontalOffset = horizontalInfo.offset;\r\n            distX += verticalOffset;\r\n            distY += horizontalOffset;\r\n        }\r\n        var beforeTranslate = plus(getBeforeDragDist({ datas: datas, distX: distX, distY: distY }), startValue);\r\n        var translate = plus(getTransformDist({ datas: datas, distX: distX, distY: distY }), startValue);\r\n        throttleArray(translate, TINY_NUM);\r\n        throttleArray(beforeTranslate, TINY_NUM);\r\n        if (!throttleDragRotate) {\r\n            if (!isVerticalSnap && !isVerticalBound) {\r\n                translate[0] = throttle(translate[0], throttleDrag);\r\n                beforeTranslate[0] = throttle(beforeTranslate[0], throttleDrag);\r\n            }\r\n            if (!isHorizontalSnap && !isHorizontalBound) {\r\n                translate[1] = throttle(translate[1], throttleDrag);\r\n                beforeTranslate[1] = throttle(beforeTranslate[1], throttleDrag);\r\n            }\r\n        }\r\n        var beforeDist = minus(beforeTranslate, startValue);\r\n        var dist = minus(translate, startValue);\r\n        var delta = minus(dist, prevDist);\r\n        var beforeDelta = minus(beforeDist, prevBeforeDist);\r\n        datas.prevDist = dist;\r\n        datas.prevBeforeDist = beforeDist;\r\n        datas.passDelta = delta; //distX - (datas.passDistX || 0);\r\n        // datas.passDeltaY = distY - (datas.passDistY || 0);\r\n        datas.passDist = dist; //distX;\r\n        // datas.passDistY = distY;\r\n        var left = datas.left + beforeDist[0];\r\n        var top = datas.top + beforeDist[1];\r\n        var right = datas.right - beforeDist[0];\r\n        var bottom = datas.bottom - beforeDist[1];\r\n        var nextTransform = convertTransformFormat(datas, \"translate(\".concat(translate[0], \"px, \").concat(translate[1], \"px)\"), \"translate(\".concat(dist[0], \"px, \").concat(dist[1], \"px)\"));\r\n        fillOriginalTransform(e, nextTransform);\r\n        moveable.state.dragInfo.dist = parentEvent ? [0, 0] : dist;\r\n        if (!parentEvent && !parentMoveable && delta.every(function (num) { return !num; }) && beforeDelta.some(function (num) { return !num; })) {\r\n            return;\r\n        }\r\n        var _b = moveable.state, width = _b.width, height = _b.height;\r\n        var params = fillParams(moveable, e, __assign({ transform: nextTransform, dist: dist, delta: delta, translate: translate, beforeDist: beforeDist, beforeDelta: beforeDelta, beforeTranslate: beforeTranslate, left: left, top: top, right: right, bottom: bottom, width: width, height: height, isPinch: isPinch }, fillCSSObject({\r\n            transform: nextTransform,\r\n        }, e)));\r\n        !parentEvent && triggerEvent(moveable, \"onDrag\", params);\r\n        return params;\r\n    },\r\n    dragAfter: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var deltaOffset = datas.deltaOffset;\r\n        if (deltaOffset[0] || deltaOffset[1]) {\r\n            datas.deltaOffset = [0, 0];\r\n            return this.drag(moveable, __assign(__assign({}, e), { deltaOffset: deltaOffset }));\r\n        }\r\n        return false;\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        var parentEvent = e.parentEvent, datas = e.datas;\r\n        moveable.state.dragInfo = null;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        datas.isDrag = false;\r\n        var param = fillEndParams(moveable, e, {});\r\n        !parentEvent && triggerEvent(moveable, \"onDragEnd\", param);\r\n        return param;\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        var _a, _b;\r\n        var datas = e.datas, clientX = e.clientX, clientY = e.clientY;\r\n        var params = this.dragStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var _c = triggerChildGesto(moveable, this, \"dragStart\", [\r\n            clientX || 0,\r\n            clientY || 0,\r\n        ], e, false, \"draggable\"), childEvents = _c.childEvents, eventParams = _c.eventParams;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: eventParams });\r\n        var result = triggerEvent(moveable, \"onDragGroupStart\", nextParams);\r\n        datas.isDrag = result !== false;\r\n        // find data.startValue and based on first child moveable\r\n        var startValue = (_b = (_a = childEvents[0]) === null || _a === void 0 ? void 0 : _a.datas.startValue) !== null && _b !== void 0 ? _b : [0, 0];\r\n        datas.throttleOffset = [startValue[0] % 1, startValue[1] % 1];\r\n        return datas.isDrag ? params : false;\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        var params = this.drag(moveable, __assign(__assign({}, e), { parentThrottleDrag: moveable.props.throttleDrag }));\r\n        var passDelta = e.datas.passDelta;\r\n        var eventParams = triggerChildGesto(moveable, this, \"drag\", passDelta, e, false, \"draggable\").eventParams;\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: eventParams }, params);\r\n        triggerEvent(moveable, \"onDragGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        this.dragEnd(moveable, e);\r\n        var eventParams = triggerChildGesto(moveable, this, \"dragEnd\", [0, 0], e, false, \"draggable\").eventParams;\r\n        triggerEvent(moveable, \"onDragGroupEnd\", fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: eventParams,\r\n        }));\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Draggable#request\r\n     * @param {object} [e] - the draggable's request parameter\r\n     * @param {number} [e.x] - x position\r\n     * @param {number} [e.y] - y position\r\n     * @param {number} [e.deltaX] - X number to move\r\n     * @param {number} [e.deltaY] - Y number to move\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * // Use Relative Value\r\n     * moveable.request(\"draggable\", { deltaX: 10, deltaY: 10 }, true);\r\n     * // Use Absolute Value\r\n     * moveable.request(\"draggable\", { x: 200, y: 100 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"draggable\");\r\n     *\r\n     * // request\r\n     * // Use Relative Value\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * // Use Absolute Value\r\n     * moveable.request(\"draggable\", { x: 200, y: 100 });\r\n     * moveable.request(\"draggable\", { x: 220, y: 100 });\r\n     * moveable.request(\"draggable\", { x: 240, y: 100 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var rect = moveable.getRect();\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var useSnap = false;\r\n        return {\r\n            isControl: false,\r\n            requestStart: function (e) {\r\n                useSnap = e.useSnap;\r\n                return { datas: datas, useSnap: useSnap };\r\n            },\r\n            request: function (e) {\r\n                if (\"x\" in e) {\r\n                    distX = e.x - rect.left;\r\n                }\r\n                else if (\"deltaX\" in e) {\r\n                    distX += e.deltaX;\r\n                }\r\n                if (\"y\" in e) {\r\n                    distY = e.y - rect.top;\r\n                }\r\n                else if (\"deltaY\" in e) {\r\n                    distY += e.deltaY;\r\n                }\r\n                return { datas: datas, distX: distX, distY: distY, useSnap: useSnap };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.gestos.draggable = null;\r\n        moveable.state.dragInfo = null;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be dragged. (default: false)\r\n * @name Moveable.Draggable#draggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.draggable = true;\r\n */\r\n/**\r\n * throttle of x, y when drag.\r\n * @name Moveable.Draggable#throttleDrag\r\n * @default 0\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleDrag = 1;\r\n */\r\n/**\r\n* throttle of angle of x, y when drag.\r\n* @name Moveable.Draggable#throttleDragRotate\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body);\r\n*\r\n* moveable.throttleDragRotate = 45;\r\n*/\r\n/**\r\n* start angle of throttleDragRotate of x, y when drag.\r\n* @name Moveable.Draggable#startDragRotate\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body);\r\n*\r\n* // 45, 135, 225, 315\r\n* moveable.throttleDragRotate = 90;\r\n* moveable.startDragRotate = 45;\r\n*/\r\n/**\r\n * When the drag starts, the dragStart event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragStart\r\n * @param {Moveable.Draggable.OnDragStart} - Parameters for the dragStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"dragStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When dragging, the drag event is called.\r\n * @memberof Moveable.Draggable\r\n * @event drag\r\n * @param {Moveable.Draggable.OnDrag} - Parameters for the drag event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"drag\", ({ target, transform }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When the drag finishes, the dragEnd event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragEnd\r\n * @param {Moveable.Draggable.OnDragEnd} - Parameters for the dragEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"dragEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group drag starts, the `dragGroupStart` event is called.\r\n* @memberof Moveable.Draggable\r\n* @event dragGroupStart\r\n* @param {Moveable.Draggable.OnDragGroupStart} - Parameters for the `dragGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     draggable: true\r\n* });\r\n* moveable.on(\"dragGroupStart\", ({ targets }) => {\r\n*     console.log(\"onDragGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group drag, the `dragGroup` event is called.\r\n* @memberof Moveable.Draggable\r\n* @event dragGroup\r\n* @param {Moveable.Draggable.OnDragGroup} - Parameters for the `dragGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     draggable: true\r\n* });\r\n* moveable.on(\"dragGroup\", ({ targets, events }) => {\r\n*     console.log(\"onDragGroup\", targets);\r\n*     events.forEach(ev => {\r\n*          // drag event\r\n*          console.log(\"onDrag left, top\", ev.left, ev.top);\r\n*          // ev.target!.style.left = `${ev.left}px`;\r\n*          // ev.target!.style.top = `${ev.top}px`;\r\n*          console.log(\"onDrag translate\", ev.dist);\r\n*          ev.target!.style.transform = ev.transform;)\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group drag finishes, the `dragGroupEnd` event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragGroupEnd\r\n * @param {Moveable.Draggable.OnDragGroupEnd} - Parameters for the `dragGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     draggable: true\r\n * });\r\n * moveable.on(\"dragGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onDragGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction getFixedDirectionInfo(startPositions, fixedDirection) {\r\n    var fixedPosition = getPosByDirection(startPositions, fixedDirection);\r\n    var fixedOffset = [0, 0];\r\n    return {\r\n        fixedPosition: fixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\r\nfunction getOffsetFixedDirectionInfo(state, fixedDirection) {\r\n    // for start\r\n    var allMatrix = state.allMatrix, is3d = state.is3d, width = state.width, height = state.height;\r\n    var n = is3d ? 4 : 3;\r\n    var nextFixedOffset = [\r\n        width / 2 * (1 + fixedDirection[0]),\r\n        height / 2 * (1 + fixedDirection[1]),\r\n    ];\r\n    var fixedPosition = calculatePosition(allMatrix, nextFixedOffset, n);\r\n    var fixedOffset = [0, 0];\r\n    return {\r\n        fixedPosition: fixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\r\nfunction getOffsetFixedPositionInfo(state, offsetFixedPosition) {\r\n    // for start\r\n    var allMatrix = state.allMatrix, is3d = state.is3d, width = state.width, height = state.height;\r\n    var n = is3d ? 4 : 3;\r\n    var fixedDirection = getDirectionByPos(offsetFixedPosition, width, height);\r\n    var nextFixedPosition = calculatePosition(allMatrix, offsetFixedPosition, n);\r\n    var fixedOffset = [\r\n        width ? 0 : offsetFixedPosition[0],\r\n        height ? 0 : offsetFixedPosition[1],\r\n    ];\r\n    return {\r\n        fixedPosition: nextFixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\n\n/**\r\n * @namespace Resizable\r\n * @memberof Moveable\r\n * @description Resizable indicates whether the target's width and height can be increased or decreased.\r\n */\r\nvar directionCondition$2 = getDirectionCondition(\"resizable\");\r\nvar Resizable = {\r\n    name: \"resizable\",\r\n    ableGroup: \"size\",\r\n    canPinch: true,\r\n    props: [\r\n        \"resizable\",\r\n        \"throttleResize\",\r\n        \"renderDirections\",\r\n        \"displayAroundControls\",\r\n        \"keepRatio\",\r\n        \"resizeFormat\",\r\n        \"keepRatioFinally\",\r\n        \"edge\",\r\n        \"checkResizableError\",\r\n    ],\r\n    events: [\r\n        \"resizeStart\",\r\n        \"beforeResize\",\r\n        \"resize\",\r\n        \"resizeEnd\",\r\n        \"resizeGroupStart\",\r\n        \"beforeResizeGroup\",\r\n        \"resizeGroup\",\r\n        \"resizeGroupEnd\",\r\n    ],\r\n    render: getRenderDirections(\"resizable\"),\r\n    dragControlCondition: directionCondition$2,\r\n    viewClassName: getDirectionViewClassName(\"resizable\"),\r\n    dragControlStart: function (moveable, e) {\r\n        var _a;\r\n        var inputEvent = e.inputEvent, isPinch = e.isPinch, isGroup = e.isGroup, parentDirection = e.parentDirection, parentGesto = e.parentGesto, datas = e.datas, parentFixedDirection = e.parentFixedDirection, parentEvent = e.parentEvent;\r\n        var direction = getTotalDirection(parentDirection, isPinch, inputEvent, datas);\r\n        var state = moveable.state;\r\n        var target = state.target, width = state.width, height = state.height, gestos = state.gestos;\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        if (gestos.resizable) {\r\n            return false;\r\n        }\r\n        gestos.resizable = parentGesto || moveable.controlGesto;\r\n        !isPinch && setDragStart(moveable, e);\r\n        datas.datas = {};\r\n        datas.direction = direction;\r\n        datas.startOffsetWidth = width;\r\n        datas.startOffsetHeight = height;\r\n        datas.prevWidth = 0;\r\n        datas.prevHeight = 0;\r\n        datas.minSize = [0, 0];\r\n        datas.startWidth = state.inlineCSSWidth || state.cssWidth;\r\n        datas.startHeight = state.inlineCSSHeight || state.cssHeight;\r\n        datas.maxSize = [Infinity, Infinity];\r\n        if (!isGroup) {\r\n            datas.minSize = [\r\n                state.minOffsetWidth,\r\n                state.minOffsetHeight,\r\n            ];\r\n            datas.maxSize = [\r\n                state.maxOffsetWidth,\r\n                state.maxOffsetHeight,\r\n            ];\r\n        }\r\n        var transformOrigin = moveable.props.transformOrigin || \"% %\";\r\n        datas.transformOrigin = transformOrigin && isString(transformOrigin)\r\n            ? transformOrigin.split(\" \")\r\n            : transformOrigin;\r\n        datas.startOffsetMatrix = state.offsetMatrix;\r\n        datas.startTransformOrigin = state.transformOrigin;\r\n        datas.isWidth = (_a = e === null || e === void 0 ? void 0 : e.parentIsWidth) !== null && _a !== void 0 ? _a : ((!direction[0] && !direction[1]) || direction[0] || !direction[1]);\r\n        function setRatio(ratio) {\r\n            datas.ratio = ratio && isFinite(ratio) ? ratio : 0;\r\n        }\r\n        datas.startPositions = getAbsolutePosesByState(moveable.state);\r\n        function setFixedDirection(fixedDirection) {\r\n            var result = getFixedDirectionInfo(datas.startPositions, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        function setFixedPosition(fixedPosition) {\r\n            var result = getOffsetFixedPositionInfo(moveable.state, fixedPosition);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        function setMin(minSize) {\r\n            datas.minSize = [\r\n                convertUnitSize(\"\".concat(minSize[0]), 0) || 0,\r\n                convertUnitSize(\"\".concat(minSize[1]), 0) || 0,\r\n            ];\r\n        }\r\n        function setMax(maxSize) {\r\n            var nextMaxSize = [\r\n                maxSize[0] || Infinity,\r\n                maxSize[1] || Infinity,\r\n            ];\r\n            if (!isNumber(nextMaxSize[0]) || isFinite(nextMaxSize[0])) {\r\n                nextMaxSize[0] = convertUnitSize(\"\".concat(nextMaxSize[0]), 0) || Infinity;\r\n            }\r\n            if (!isNumber(nextMaxSize[1]) || isFinite(nextMaxSize[1])) {\r\n                nextMaxSize[1] = convertUnitSize(\"\".concat(nextMaxSize[1]), 0) || Infinity;\r\n            }\r\n            datas.maxSize = nextMaxSize;\r\n        }\r\n        setRatio(width / height);\r\n        setFixedDirection(parentFixedDirection || [-direction[0], -direction[1]]);\r\n        datas.setFixedDirection = setFixedDirection;\r\n        datas.setFixedPosition = setFixedPosition;\r\n        datas.setMin = setMin;\r\n        datas.setMax = setMax;\r\n        var params = fillParams(moveable, e, {\r\n            direction: direction,\r\n            startRatio: datas.ratio,\r\n            set: function (_a) {\r\n                var _b = __read(_a, 2), startWidth = _b[0], startHeight = _b[1];\r\n                datas.startWidth = startWidth;\r\n                datas.startHeight = startHeight;\r\n            },\r\n            setMin: setMin,\r\n            setMax: setMax,\r\n            setRatio: setRatio,\r\n            setFixedDirection: setFixedDirection,\r\n            setFixedPosition: setFixedPosition,\r\n            setOrigin: function (origin) {\r\n                datas.transformOrigin = origin;\r\n            },\r\n            dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)),\r\n        });\r\n        var result = parentEvent || triggerEvent(moveable, \"onResizeStart\", params);\r\n        datas.startFixedDirection = datas.fixedDirection;\r\n        datas.startFixedPosition = datas.fixedPosition;\r\n        if (result !== false) {\r\n            datas.isResize = true;\r\n            moveable.state.snapRenderInfo = {\r\n                request: e.isRequest,\r\n                direction: direction,\r\n            };\r\n        }\r\n        return datas.isResize ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a;\r\n        var datas = e.datas, parentFlag = e.parentFlag, isPinch = e.isPinch, parentKeepRatio = e.parentKeepRatio, dragClient = e.dragClient, parentDist = e.parentDist, useSnap = e.useSnap, isRequest = e.isRequest, isGroup = e.isGroup, parentEvent = e.parentEvent, resolveMatrix = e.resolveMatrix;\r\n        var isResize = datas.isResize, transformOrigin = datas.transformOrigin, startWidth = datas.startWidth, startHeight = datas.startHeight, prevWidth = datas.prevWidth, prevHeight = datas.prevHeight, minSize = datas.minSize, maxSize = datas.maxSize, ratio = datas.ratio, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, isWidth = datas.isWidth;\r\n        if (!isResize) {\r\n            return;\r\n        }\r\n        if (resolveMatrix) {\r\n            var is3d = moveable.state.is3d;\r\n            var startOffsetMatrix = datas.startOffsetMatrix, startTransformOrigin = datas.startTransformOrigin;\r\n            var n = is3d ? 4 : 3;\r\n            var targetMatrix = parseMat(getNextTransforms(e));\r\n            var targetN = Math.sqrt(targetMatrix.length);\r\n            if (n !== targetN) {\r\n                targetMatrix = convertDimension(targetMatrix, targetN, n);\r\n            }\r\n            var nextAllMatrix = getNextMatrix(startOffsetMatrix, targetMatrix, startTransformOrigin, n);\r\n            var poses = calculatePoses(nextAllMatrix, startOffsetWidth, startOffsetHeight, n);\r\n            datas.startPositions = poses;\r\n            datas.nextTargetMatrix = targetMatrix;\r\n            datas.nextAllMatrix = nextAllMatrix;\r\n        }\r\n        var props = getProps(moveable.props, \"resizable\");\r\n        var resizeFormat = props.resizeFormat, _b = props.throttleResize, throttleResize = _b === void 0 ? parentFlag ? 0 : 1 : _b, parentMoveable = props.parentMoveable, keepRatioFinally = props.keepRatioFinally;\r\n        var direction = datas.direction;\r\n        var sizeDirection = direction;\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        if (!direction[0] && !direction[1]) {\r\n            sizeDirection = [1, 1];\r\n        }\r\n        var keepRatio = (ratio && (parentKeepRatio != null ? parentKeepRatio : props.keepRatio)) || false;\r\n        function getNextBoundingSize() {\r\n            var fixedDirection = datas.fixedDirection;\r\n            var nextSize = getOffsetSizeDist(sizeDirection, keepRatio, datas, e);\r\n            distWidth = nextSize.distWidth;\r\n            distHeight = nextSize.distHeight;\r\n            var nextWidth = (sizeDirection[0] - fixedDirection[0]) || keepRatio\r\n                ? Math.max(startOffsetWidth + distWidth, TINY_NUM) : startOffsetWidth;\r\n            var nextHeight = (sizeDirection[1] - fixedDirection[1]) || keepRatio\r\n                ? Math.max(startOffsetHeight + distHeight, TINY_NUM) : startOffsetHeight;\r\n            if (keepRatio && startOffsetWidth && startOffsetHeight) {\r\n                // startOffsetWidth : startOffsetHeight = nextWidth : nextHeight\r\n                if (isWidth) {\r\n                    nextHeight = nextWidth / ratio;\r\n                }\r\n                else {\r\n                    nextWidth = nextHeight * ratio;\r\n                }\r\n            }\r\n            return [nextWidth, nextHeight];\r\n        }\r\n        var _c = __read(getNextBoundingSize(), 2), boundingWidth = _c[0], boundingHeight = _c[1];\r\n        if (!parentEvent) {\r\n            datas.setFixedDirection(datas.fixedDirection);\r\n            triggerEvent(moveable, \"onBeforeResize\", fillParams(moveable, e, {\r\n                startFixedDirection: datas.startFixedDirection,\r\n                startFixedPosition: datas.startFixedPosition,\r\n                setFixedDirection: function (nextFixedDirection) {\r\n                    var _a;\r\n                    datas.setFixedDirection(nextFixedDirection);\r\n                    _a = __read(getNextBoundingSize(), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                    return [boundingWidth, boundingHeight];\r\n                },\r\n                setFixedPosition: function (nextFixedPosition) {\r\n                    var _a;\r\n                    datas.setFixedPosition(nextFixedPosition);\r\n                    _a = __read(getNextBoundingSize(), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                    return [boundingWidth, boundingHeight];\r\n                },\r\n                boundingWidth: boundingWidth,\r\n                boundingHeight: boundingHeight,\r\n                setSize: function (size) {\r\n                    var _a;\r\n                    _a = __read(size, 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                },\r\n            }, true));\r\n        }\r\n        var fixedPosition = dragClient;\r\n        if (!dragClient) {\r\n            if (!parentFlag && isPinch) {\r\n                fixedPosition = getAbsolutePosition(moveable, [0, 0]);\r\n            }\r\n            else {\r\n                fixedPosition = datas.fixedPosition;\r\n            }\r\n        }\r\n        var snapDist = [0, 0];\r\n        if (!isPinch) {\r\n            snapDist = checkSnapResize(moveable, boundingWidth, boundingHeight, direction, fixedPosition, !useSnap && isRequest, datas);\r\n        }\r\n        if (parentDist) {\r\n            !parentDist[0] && (snapDist[0] = 0);\r\n            !parentDist[1] && (snapDist[1] = 0);\r\n        }\r\n        function computeSize() {\r\n            var _a;\r\n            if (resizeFormat) {\r\n                _a = __read(resizeFormat([boundingWidth, boundingHeight]), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n            }\r\n            boundingWidth = throttle(boundingWidth, throttleResize);\r\n            boundingHeight = throttle(boundingHeight, throttleResize);\r\n        }\r\n        if (keepRatio) {\r\n            if (sizeDirection[0] && sizeDirection[1] && snapDist[0] && snapDist[1]) {\r\n                if (abs(snapDist[0]) > abs(snapDist[1])) {\r\n                    snapDist[1] = 0;\r\n                }\r\n                else {\r\n                    snapDist[0] = 0;\r\n                }\r\n            }\r\n            var isNoSnap = !snapDist[0] && !snapDist[1];\r\n            if (isNoSnap) {\r\n                // pre-compute before maintaining the ratio\r\n                computeSize();\r\n            }\r\n            if ((sizeDirection[0] && !sizeDirection[1])\r\n                || (snapDist[0] && !snapDist[1])\r\n                || (isNoSnap && isWidth)) {\r\n                boundingWidth += snapDist[0];\r\n                boundingHeight = boundingWidth / ratio;\r\n            }\r\n            else if ((!sizeDirection[0] && sizeDirection[1])\r\n                || (!snapDist[0] && snapDist[1])\r\n                || (isNoSnap && !isWidth)) {\r\n                boundingHeight += snapDist[1];\r\n                boundingWidth = boundingHeight * ratio;\r\n            }\r\n        }\r\n        else {\r\n            boundingWidth += snapDist[0];\r\n            boundingHeight += snapDist[1];\r\n            boundingWidth = Math.max(0, boundingWidth);\r\n            boundingHeight = Math.max(0, boundingHeight);\r\n        }\r\n        _a = __read(calculateBoundSize([boundingWidth, boundingHeight], minSize, maxSize, keepRatio ? ratio : false), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n        computeSize();\r\n        if (keepRatio && (isGroup || keepRatioFinally)) {\r\n            if (isWidth) {\r\n                boundingHeight = boundingWidth / ratio;\r\n            }\r\n            else {\r\n                boundingWidth = boundingHeight * ratio;\r\n            }\r\n        }\r\n        distWidth = boundingWidth - startOffsetWidth;\r\n        distHeight = boundingHeight - startOffsetHeight;\r\n        var delta = [distWidth - prevWidth, distHeight - prevHeight];\r\n        datas.prevWidth = distWidth;\r\n        datas.prevHeight = distHeight;\r\n        var inverseDelta = getResizeDist(moveable, boundingWidth, boundingHeight, fixedPosition, transformOrigin, datas);\r\n        if (!parentMoveable && delta.every(function (num) { return !num; }) && inverseDelta.every(function (num) { return !num; })) {\r\n            return;\r\n        }\r\n        var drag = Draggable.drag(moveable, setCustomDrag(e, moveable.state, inverseDelta, !!isPinch, false, \"draggable\"));\r\n        var transform = drag.transform;\r\n        var nextWidth = startWidth + distWidth;\r\n        var nextHeight = startHeight + distHeight;\r\n        var params = fillParams(moveable, e, __assign({ width: nextWidth, height: nextHeight, offsetWidth: Math.round(boundingWidth), offsetHeight: Math.round(boundingHeight), startRatio: ratio, boundingWidth: boundingWidth, boundingHeight: boundingHeight, direction: direction, dist: [distWidth, distHeight], delta: delta, isPinch: !!isPinch, drag: drag }, fillAfterTransform({\r\n            style: {\r\n                width: \"\".concat(nextWidth, \"px\"),\r\n                height: \"\".concat(nextHeight, \"px\"),\r\n            },\r\n            transform: transform,\r\n        }, drag, e)));\r\n        !parentEvent && triggerEvent(moveable, \"onResize\", params);\r\n        return params;\r\n    },\r\n    dragControlAfter: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var isResize = datas.isResize, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, prevWidth = datas.prevWidth, prevHeight = datas.prevHeight;\r\n        if (!isResize || moveable.props.checkResizableError === false) {\r\n            return;\r\n        }\r\n        var _a = moveable.state, width = _a.width, height = _a.height;\r\n        var errorWidth = width - (startOffsetWidth + prevWidth);\r\n        var errorHeight = height - (startOffsetHeight + prevHeight);\r\n        var isErrorWidth = abs(errorWidth) > 3;\r\n        var isErrorHeight = abs(errorHeight) > 3;\r\n        if (isErrorWidth) {\r\n            datas.startWidth += errorWidth;\r\n            datas.startOffsetWidth += errorWidth;\r\n            datas.prevWidth += errorWidth;\r\n        }\r\n        if (isErrorHeight) {\r\n            datas.startHeight += errorHeight;\r\n            datas.startOffsetHeight += errorHeight;\r\n            datas.prevHeight += errorHeight;\r\n        }\r\n        if (isErrorWidth || isErrorHeight) {\r\n            return this.dragControl(moveable, e);\r\n        }\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas, parentEvent = e.parentEvent;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        datas.isResize = false;\r\n        var params = fillEndParams(moveable, e, {});\r\n        !parentEvent && triggerEvent(moveable, \"onResizeEnd\", params);\r\n        return params;\r\n    },\r\n    dragGroupControlCondition: directionCondition$2,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var params = this.dragControlStart(moveable, __assign(__assign({}, e), { isGroup: true }));\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var originalEvents = fillChildEvents(moveable, \"resizable\", e);\r\n        var parentStartOffsetWidth = datas.startOffsetWidth, parentStartOffsetHeight = datas.startOffsetHeight;\r\n        function updateGroupMin() {\r\n            var originalMinSize = datas.minSize;\r\n            originalEvents.forEach(function (ev) {\r\n                var _a = ev.datas, childMinSize = _a.minSize, childStartOffsetWidth = _a.startOffsetWidth, childStartOffsetHeight = _a.startOffsetHeight;\r\n                var parentMinWidth = parentStartOffsetWidth\r\n                    * (childStartOffsetWidth ? childMinSize[0] / childStartOffsetWidth : 0);\r\n                var parentMinHeight = parentStartOffsetHeight\r\n                    * (childStartOffsetHeight ? childMinSize[1] / childStartOffsetHeight : 0);\r\n                originalMinSize[0] = Math.max(originalMinSize[0], parentMinWidth);\r\n                originalMinSize[1] = Math.max(originalMinSize[1], parentMinHeight);\r\n            });\r\n        }\r\n        function updateGroupMax() {\r\n            var originalMaxSize = datas.maxSize;\r\n            originalEvents.forEach(function (ev) {\r\n                var _a = ev.datas, childMaxSize = _a.maxSize, childStartOffsetWidth = _a.startOffsetWidth, childStartOffsetHeight = _a.startOffsetHeight;\r\n                var parentMaxWidth = parentStartOffsetWidth\r\n                    * (childStartOffsetWidth ? childMaxSize[0] / childStartOffsetWidth : 0);\r\n                var parentMaxHeight = parentStartOffsetHeight\r\n                    * (childStartOffsetHeight ? childMaxSize[1] / childStartOffsetHeight : 0);\r\n                originalMaxSize[0] = Math.min(originalMaxSize[0], parentMaxWidth);\r\n                originalMaxSize[1] = Math.min(originalMaxSize[1], parentMaxHeight);\r\n            });\r\n        }\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            return startChildDist(moveable, child, datas, ev);\r\n        });\r\n        updateGroupMin();\r\n        updateGroupMax();\r\n        var setFixedDirection = function (fixedDirection) {\r\n            params.setFixedDirection(fixedDirection);\r\n            events.forEach(function (ev, i) {\r\n                ev.setFixedDirection(fixedDirection);\r\n                startChildDist(moveable, ev.moveable, datas, originalEvents[i]);\r\n            });\r\n        };\r\n        datas.setFixedDirection = setFixedDirection;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events.map(function (ev) {\r\n                return __assign(__assign({}, ev), { setMin: function (minSize) {\r\n                        ev.setMin(minSize);\r\n                        updateGroupMin();\r\n                    }, setMax: function (maxSize) {\r\n                        ev.setMax(maxSize);\r\n                        updateGroupMax();\r\n                    } });\r\n            }), setFixedDirection: setFixedDirection, setMin: function (minSize) {\r\n                params.setMin(minSize);\r\n                updateGroupMin();\r\n            }, setMax: function (maxSize) {\r\n                params.setMax(maxSize);\r\n                updateGroupMax();\r\n            } });\r\n        var result = triggerEvent(moveable, \"onResizeGroupStart\", nextParams);\r\n        datas.isResize = result !== false;\r\n        return datas.isResize ? params : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        var props = getProps(moveable.props, \"resizable\");\r\n        catchEvent(moveable, \"onBeforeResize\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeResizeGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, __assign(__assign({}, e), { isGroup: true }));\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var boundingWidth = params.boundingWidth, boundingHeight = params.boundingHeight, dist = params.dist;\r\n        var keepRatio = props.keepRatio;\r\n        var parentScale = [\r\n            boundingWidth / (boundingWidth - dist[0]),\r\n            boundingHeight / (boundingHeight - dist[1]),\r\n        ];\r\n        var fixedPosition = datas.fixedPosition;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var _a = __read(calculate(createRotateMatrix(moveable.rotation / 180 * Math.PI, 3), [\r\n                ev.datas.originalX * parentScale[0],\r\n                ev.datas.originalY * parentScale[1],\r\n                1,\r\n            ], 3), 2), clientX = _a[0], clientY = _a[1];\r\n            return __assign(__assign({}, ev), { parentDist: null, parentScale: parentScale, dragClient: plus(fixedPosition, [clientX, clientY]), parentKeepRatio: keepRatio });\r\n        });\r\n        var nextParams = __assign({ targets: props.targets, events: events }, params);\r\n        triggerEvent(moveable, \"onResizeGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onResizeGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Resizable#request\r\n     * @param {Moveable.Resizable.ResizableRequestParam} e - the Resizable's request parameter\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * // Use Relative Value\r\n     * moveable.request(\"resizable\", { deltaWidth: 10, deltaHeight: 10 }, true);\r\n     *\r\n     * // Use Absolute Value\r\n     * moveable.request(\"resizable\", { offsetWidth: 100, offsetHeight: 100 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"resizable\");\r\n     *\r\n     * // request\r\n     * // Use Relative Value\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     *\r\n     * // Use Absolute Value\r\n     * moveable.request(\"resizable\", { offsetWidth: 100, offsetHeight: 100 });\r\n     * moveable.request(\"resizable\", { offsetWidth: 110, offsetHeight: 100 });\r\n     * moveable.request(\"resizable\", { offsetWidth: 120, offsetHeight: 100 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        var useSnap = false;\r\n        var rect = moveable.getRect();\r\n        return {\r\n            isControl: true,\r\n            requestStart: function (e) {\r\n                var _a;\r\n                useSnap = e.useSnap;\r\n                return {\r\n                    datas: datas,\r\n                    parentDirection: e.direction || [1, 1],\r\n                    parentIsWidth: (_a = e === null || e === void 0 ? void 0 : e.horizontal) !== null && _a !== void 0 ? _a : true,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            request: function (e) {\r\n                if (\"offsetWidth\" in e) {\r\n                    distWidth = e.offsetWidth - rect.offsetWidth;\r\n                }\r\n                else if (\"deltaWidth\" in e) {\r\n                    distWidth += e.deltaWidth;\r\n                }\r\n                if (\"offsetHeight\" in e) {\r\n                    distHeight = e.offsetHeight - rect.offsetHeight;\r\n                }\r\n                else if (\"deltaHeight\" in e) {\r\n                    distHeight += e.deltaHeight;\r\n                }\r\n                return {\r\n                    datas: datas,\r\n                    parentDist: [distWidth, distHeight],\r\n                    parentKeepRatio: e.keepRatio,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.gestos.resizable = null;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be resized.\r\n * @name Moveable.Resizable#resizable\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     resizable: false,\r\n * });\r\n *\r\n * moveable.resizable = true;\r\n */\r\n/**\r\n * throttle of width, height when resize. If throttleResize is set to less than 1, the target may shake.\r\n * @name Moveable.Resizable#throttleResize\r\n * @default 1\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   throttleResize: 1,\r\n * });\r\n *\r\n * moveable.throttleResize = 0;\r\n */\r\n/**\r\n * When resize or scale, keeps a ratio of the width, height.\r\n * @name Moveable.Resizable#keepRatio\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n * });\r\n *\r\n * moveable.keepRatio = true;\r\n */\r\n/**\r\n * Set directions to show the control box.\r\n * @name Moveable.Resizable#renderDirections\r\n * @default [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"]\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n * });\r\n *\r\n * moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n */\r\n/**\r\n * Function to convert size for resize\r\n * @name Moveable.Resizable#resizeFormat\r\n * @default oneself\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   resizeFormat: v => v,\r\n * });\r\n *\r\n * moveable.resizeFormat = (size: number[]) => ([Math.trunc(size[0]), Math.trunc(size[1])];\r\n */\r\n/**\r\n * When the resize starts, the resizeStart event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeStart\r\n * @param {Moveable.Resizable.OnResizeStart} - Parameters for the resizeStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resizeStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When resizing, `beforeResize` is called before `resize` occurs. In `beforeResize`, you can get and set the pre-value before resizing.\r\n * @memberof Moveable.Resizable\r\n * @event beforeResize\r\n * @param {Moveable.Resizable.OnBeforeResize} - Parameters for the `beforeResize` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"beforeResize\", ({ setFixedDirection }) => {\r\n *     if (shiftKey) {\r\n *        setFixedDirection([0, 0]);\r\n *     }\r\n * });\r\n * moveable.on(\"resize\", ({ target, width, height, drag }) => {\r\n *     target.style.width = `${width}px`;\r\n *     target.style.height = `${height}px`;\r\n *     target.style.transform = drag.transform;\r\n * });\r\n */\r\n/**\r\n * When resizing, the resize event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resize\r\n * @param {Moveable.Resizable.OnResize} - Parameters for the resize event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resize\", ({ target, width, height }) => {\r\n *     target.style.width = `${e.width}px`;\r\n *     target.style.height = `${e.height}px`;\r\n * });\r\n */\r\n/**\r\n * When the resize finishes, the resizeEnd event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeEnd\r\n * @param {Moveable.Resizable.OnResizeEnd} - Parameters for the resizeEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resizeEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group resize starts, the `resizeGroupStart` event is called.\r\n* @memberof Moveable.Resizable\r\n* @event resizeGroupStart\r\n* @param {Moveable.Resizable.OnResizeGroupStart} - Parameters for the `resizeGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     resizable: true\r\n* });\r\n* moveable.on(\"resizeGroupStart\", ({ targets }) => {\r\n*     console.log(\"onResizeGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group resize, the `resizeGroup` event is called.\r\n* @memberof Moveable.Resizable\r\n* @event resizeGroup\r\n* @param {Moveable.Resizable.onResizeGroup} - Parameters for the `resizeGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     resizable: true\r\n* });\r\n* moveable.on(\"resizeGroup\", ({ targets, events }) => {\r\n*     console.log(\"onResizeGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const offset = [\r\n*             direction[0] < 0 ? -ev.delta[0] : 0,\r\n*             direction[1] < 0 ? -ev.delta[1] : 0,\r\n*         ];\r\n*         // ev.drag is a drag event that occurs when the group resize.\r\n*         const left = offset[0] + ev.drag.beforeDist[0];\r\n*         const top = offset[1] + ev.drag.beforeDist[1];\r\n*         const width = ev.width;\r\n*         const top = ev.top;\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group resize finishes, the `resizeGroupEnd` event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeGroupEnd\r\n * @param {Moveable.Resizable.OnResizeGroupEnd} - Parameters for the `resizeGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     resizable: true\r\n * });\r\n * moveable.on(\"resizeGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onResizeGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\n/**\r\n * @namespace Rotatable\r\n * @memberof Moveable\r\n * @description Rotatable indicates whether the target can be rotated.\r\n */\r\nfunction setRotateStartInfo(moveable, datas, clientX, clientY, rect) {\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var n = state.is3d ? 4 : 3;\r\n    var origin = datas.origin;\r\n    var nextOrigin = calculatePosition(moveable.state.rootMatrix, \r\n    // TO-DO #710\r\n    minus([origin[0], origin[1]], groupable ? [0, 0] : [state.left, state.top]), n);\r\n    var startAbsoluteOrigin = plus([rect.left, rect.top], nextOrigin);\r\n    datas.startAbsoluteOrigin = startAbsoluteOrigin;\r\n    datas.prevDeg = getRad(startAbsoluteOrigin, [clientX, clientY]) / Math.PI * 180;\r\n    datas.defaultDeg = datas.prevDeg;\r\n    datas.prevSnapDeg = 0;\r\n    datas.loop = 0;\r\n    datas.startDist = getDist$1(startAbsoluteOrigin, [clientX, clientY]);\r\n}\r\nfunction getAbsoluteDist(deg, direction, datas) {\r\n    var defaultDeg = datas.defaultDeg, prevDeg = datas.prevDeg;\r\n    var normalizedPrevDeg = prevDeg % 360;\r\n    var loop = Math.floor(prevDeg / 360);\r\n    if (normalizedPrevDeg < 0) {\r\n        normalizedPrevDeg += 360;\r\n    }\r\n    if (normalizedPrevDeg > deg && normalizedPrevDeg > 270 && deg < 90) {\r\n        // 360 => 0\r\n        ++loop;\r\n    }\r\n    else if (normalizedPrevDeg < deg && normalizedPrevDeg < 90 && deg > 270) {\r\n        // 0 => 360\r\n        --loop;\r\n    }\r\n    var dist = direction * (loop * 360 + deg - defaultDeg);\r\n    datas.prevDeg = defaultDeg + dist;\r\n    return dist;\r\n}\r\nfunction getAbsoluteDistByClient(clientX, clientY, direction, datas) {\r\n    return getAbsoluteDist(getRad(datas.startAbsoluteOrigin, [clientX, clientY]) / Math.PI * 180, direction, datas);\r\n}\r\nfunction getRotateInfo(moveable, moveableRect, datas, dist, startValue, checkSnap) {\r\n    var _a = moveable.props.throttleRotate, throttleRotate = _a === void 0 ? 0 : _a;\r\n    var prevSnapDeg = datas.prevSnapDeg;\r\n    var snapRotation = 0;\r\n    var isSnap = false;\r\n    if (checkSnap) {\r\n        var result = checkSnapRotate(moveable, moveableRect, dist, startValue + dist);\r\n        isSnap = result.isSnap;\r\n        snapRotation = startValue + result.dist;\r\n    }\r\n    if (!isSnap) {\r\n        snapRotation = throttle(startValue + dist, throttleRotate);\r\n    }\r\n    var snapDeg = snapRotation - startValue;\r\n    datas.prevSnapDeg = snapDeg;\r\n    return [snapDeg - prevSnapDeg, snapDeg, snapRotation];\r\n}\r\nfunction getRotationPositions(rotationPosition, _a, direction) {\r\n    var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n    if (rotationPosition === \"none\") {\r\n        return [];\r\n    }\r\n    if (isArray(rotationPosition)) {\r\n        return rotationPosition.map(function (child) { return getRotationPositions(child, [pos1, pos2, pos3, pos4], direction)[0]; });\r\n    }\r\n    var _c = __read((rotationPosition || \"top\").split(\"-\"), 2), dir1 = _c[0], dir2 = _c[1];\r\n    var radPoses = [pos1, pos2];\r\n    if (dir1 === \"left\") {\r\n        radPoses = [pos3, pos1];\r\n    }\r\n    else if (dir1 === \"right\") {\r\n        radPoses = [pos2, pos4];\r\n    }\r\n    else if (dir1 === \"bottom\") {\r\n        radPoses = [pos4, pos3];\r\n    }\r\n    var pos = [\r\n        (radPoses[0][0] + radPoses[1][0]) / 2,\r\n        (radPoses[0][1] + radPoses[1][1]) / 2,\r\n    ];\r\n    var rad = getRotationRad(radPoses, direction);\r\n    if (dir2) {\r\n        var isStart = dir2 === \"top\" || dir2 === \"left\";\r\n        var isReverse = dir1 === \"bottom\" || dir1 === \"left\";\r\n        pos = radPoses[(isStart && !isReverse) || (!isStart && isReverse) ? 0 : 1];\r\n    }\r\n    return [[pos, rad]];\r\n}\r\nfunction dragControlCondition(moveable, e) {\r\n    if (e.isRequest) {\r\n        return e.requestAble === \"rotatable\";\r\n    }\r\n    var target = e.inputEvent.target;\r\n    if (hasClass(target, prefix(\"rotation-control\"))\r\n        || (moveable.props.rotateAroundControls && hasClass(target, prefix(\"around-control\")))\r\n        || (hasClass(target, prefix(\"control\")) && hasClass(target, prefix(\"rotatable\")))) {\r\n        return true;\r\n    }\r\n    var rotationTarget = moveable.props.rotationTarget;\r\n    if (rotationTarget) {\r\n        return getRefTargets(rotationTarget, true).some(function (element) {\r\n            if (!element) {\r\n                return false;\r\n            }\r\n            return target === element || target.contains(element);\r\n        });\r\n    }\r\n    return false;\r\n}\r\nvar css = \".rotation {\\nposition: absolute;\\nheight: 40px;\\nwidth: 1px;\\ntransform-origin: 50% 100%;\\nheight: calc(40px * var(--zoom));\\ntop: auto;\\nleft: 0;\\nbottom: 100%;\\nwill-change: transform;\\n}\\n.rotation .rotation-line {\\ndisplay: block;\\nwidth: 100%;\\nheight: 100%;\\ntransform-origin: 50% 50%;\\n}\\n.rotation .rotation-control {\\nborder-color: #4af;\\nborder-color: var(--moveable-color);\\nbackground:#fff;\\ncursor: alias;\\n}\\n:global .view-rotation-dragging, .rotatable.direction.control {\\ncursor: alias;\\n}\\n.rotatable.direction.control.move {\\ncursor: move;\\n}\\n\";\r\nvar Rotatable = {\r\n    name: \"rotatable\",\r\n    canPinch: true,\r\n    props: [\r\n        \"rotatable\",\r\n        \"rotationPosition\",\r\n        \"throttleRotate\",\r\n        \"renderDirections\",\r\n        \"rotationTarget\",\r\n        \"rotateAroundControls\",\r\n        \"edge\",\r\n        \"resolveAblesWithRotatable\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"rotateStart\",\r\n        \"beforeRotate\",\r\n        \"rotate\",\r\n        \"rotateEnd\",\r\n        \"rotateGroupStart\",\r\n        \"beforeRotateGroup\",\r\n        \"rotateGroup\",\r\n        \"rotateGroupEnd\",\r\n    ],\r\n    css: [css],\r\n    viewClassName: function (moveable) {\r\n        if (!moveable.isDragging(\"rotatable\")) {\r\n            return \"\";\r\n        }\r\n        return prefix(\"view-rotation-dragging\");\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = getProps(moveable.props, \"rotatable\"), rotatable = _a.rotatable, rotationPosition = _a.rotationPosition, zoom = _a.zoom, renderDirections = _a.renderDirections, rotateAroundControls = _a.rotateAroundControls, resolveAblesWithRotatable = _a.resolveAblesWithRotatable;\r\n        var _b = moveable.getState(), renderPoses = _b.renderPoses, direction = _b.direction;\r\n        if (!rotatable) {\r\n            return null;\r\n        }\r\n        var positions = getRotationPositions(rotationPosition, renderPoses, direction);\r\n        var jsxs = [];\r\n        positions.forEach(function (_a, i) {\r\n            var _b = __read(_a, 2), pos = _b[0], rad = _b[1];\r\n            jsxs.push(React.createElement(\"div\", { key: \"rotation\".concat(i), className: prefix(\"rotation\"), style: {\r\n                    // tslint:disable-next-line: max-line-length\r\n                    transform: \"translate(-50%) translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rad, \"rad)\"),\r\n                } },\r\n                React.createElement(\"div\", { className: prefix(\"line rotation-line\"), style: {\r\n                        transform: \"scaleX(\".concat(zoom, \")\"),\r\n                    } }),\r\n                React.createElement(\"div\", { className: prefix(\"control rotation-control\"), style: {\r\n                        transform: \"translate(0.5px) scale(\".concat(zoom, \")\"),\r\n                    } })));\r\n        });\r\n        if (renderDirections) {\r\n            var ables = getKeys(resolveAblesWithRotatable || {});\r\n            var resolveMap_1 = {};\r\n            ables.forEach(function (name) {\r\n                resolveAblesWithRotatable[name].forEach(function (direction) {\r\n                    resolveMap_1[direction] = name;\r\n                });\r\n            });\r\n            var directionControlInfos = [];\r\n            if (isArray(renderDirections)) {\r\n                directionControlInfos = renderDirections.map(function (dir) {\r\n                    var able = resolveMap_1[dir];\r\n                    return {\r\n                        data: able ? { resolve: able } : {},\r\n                        classNames: able ? [\"move\"] : [],\r\n                        dir: dir,\r\n                    };\r\n                });\r\n            }\r\n            jsxs.push.apply(jsxs, __spreadArray([], __read(renderDirectionControlsByInfos(moveable, \"rotatable\", directionControlInfos, React)), false));\r\n        }\r\n        if (rotateAroundControls) {\r\n            jsxs.push.apply(jsxs, __spreadArray([], __read(renderAroundControls(moveable, React)), false));\r\n        }\r\n        return jsxs;\r\n    },\r\n    dragControlCondition: dragControlCondition,\r\n    dragControlStart: function (moveable, e) {\r\n        var _a;\r\n        var _b;\r\n        var datas = e.datas, clientX = e.clientX, clientY = e.clientY, parentRotate = e.parentRotate, parentFlag = e.parentFlag, isPinch = e.isPinch, isRequest = e.isRequest;\r\n        var state = moveable.state;\r\n        var target = state.target, left = state.left, top = state.top, direction = state.direction, beforeDirection = state.beforeDirection, targetTransform = state.targetTransform, moveableClientRect = state.moveableClientRect, offsetMatrix = state.offsetMatrix, targetMatrix = state.targetMatrix, allMatrix = state.allMatrix, width = state.width, height = state.height;\r\n        if (!isRequest && !target) {\r\n            return false;\r\n        }\r\n        var rect = moveable.getRect();\r\n        datas.rect = rect;\r\n        datas.transform = targetTransform;\r\n        datas.left = left;\r\n        datas.top = top;\r\n        var setFixedPosition = function (fixedPosition) {\r\n            var result = getOffsetFixedPositionInfo(moveable.state, fixedPosition);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedOffset = result.fixedOffset;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            if (resizeStart) {\r\n                resizeStart.setFixedPosition(fixedPosition);\r\n            }\r\n        };\r\n        var setFixedDirection = function (fixedDirection) {\r\n            var result = getOffsetFixedDirectionInfo(moveable.state, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedOffset = result.fixedOffset;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            if (resizeStart) {\r\n                resizeStart.setFixedDirection(fixedDirection);\r\n            }\r\n        };\r\n        var startClientX = clientX;\r\n        var startClientY = clientY;\r\n        if (isRequest || isPinch || parentFlag) {\r\n            var externalRotate = parentRotate || 0;\r\n            datas.beforeInfo = {\r\n                origin: rect.beforeOrigin,\r\n                prevDeg: externalRotate,\r\n                defaultDeg: externalRotate,\r\n                prevSnapDeg: 0,\r\n                startDist: 0,\r\n            };\r\n            datas.afterInfo = __assign(__assign({}, datas.beforeInfo), { origin: rect.origin });\r\n            datas.absoluteInfo = __assign(__assign({}, datas.beforeInfo), { origin: rect.origin, startValue: externalRotate });\r\n        }\r\n        else {\r\n            var inputTarget = (_b = e.inputEvent) === null || _b === void 0 ? void 0 : _b.target;\r\n            if (inputTarget) {\r\n                var regionDirection = inputTarget.getAttribute(\"data-direction\") || \"\";\r\n                var controlDirection = DIRECTION_REGION_TO_DIRECTION[regionDirection];\r\n                if (controlDirection) {\r\n                    datas.isControl = true;\r\n                    datas.isAroundControl = hasClass(inputTarget, prefix(\"around-control\"));\r\n                    datas.controlDirection = controlDirection;\r\n                    var resolve = inputTarget.getAttribute(\"data-resolve\");\r\n                    if (resolve) {\r\n                        datas.resolveAble = resolve;\r\n                    }\r\n                    var clientPoses = calculateMoveableClientPositions(state.rootMatrix, state.renderPoses, moveableClientRect);\r\n                    _a = __read(getPosByDirection(clientPoses, controlDirection), 2), startClientX = _a[0], startClientY = _a[1];\r\n                }\r\n            }\r\n            datas.beforeInfo = { origin: rect.beforeOrigin };\r\n            datas.afterInfo = { origin: rect.origin };\r\n            datas.absoluteInfo = {\r\n                origin: rect.origin,\r\n                startValue: rect.rotation,\r\n            };\r\n            var originalFixedPosition_1 = setFixedPosition;\r\n            setFixedPosition = function (fixedPosition) {\r\n                var n = state.is3d ? 4 : 3;\r\n                var _a = __read(plus(getOrigin(targetMatrix, n), fixedPosition), 2), originX = _a[0], originY = _a[1];\r\n                var fixedBeforeOrigin = calculate(offsetMatrix, convertPositionMatrix([originX, originY], n));\r\n                var fixedAfterOrigin = calculate(allMatrix, convertPositionMatrix([fixedPosition[0], fixedPosition[1]], n));\r\n                originalFixedPosition_1(fixedPosition);\r\n                var posDelta = state.posDelta;\r\n                datas.beforeInfo.origin = minus(fixedBeforeOrigin, posDelta);\r\n                datas.afterInfo.origin = minus(fixedAfterOrigin, posDelta);\r\n                datas.absoluteInfo.origin = minus(fixedAfterOrigin, posDelta);\r\n                setRotateStartInfo(moveable, datas.beforeInfo, startClientX, startClientY, moveableClientRect);\r\n                setRotateStartInfo(moveable, datas.afterInfo, startClientX, startClientY, moveableClientRect);\r\n                setRotateStartInfo(moveable, datas.absoluteInfo, startClientX, startClientY, moveableClientRect);\r\n            };\r\n            setFixedDirection = function (fixedDirection) {\r\n                var fixedPosition = getPosByDirection([\r\n                    [0, 0],\r\n                    [width, 0],\r\n                    [0, height],\r\n                    [width, height],\r\n                ], fixedDirection);\r\n                setFixedPosition(fixedPosition);\r\n            };\r\n        }\r\n        datas.startClientX = startClientX;\r\n        datas.startClientY = startClientY;\r\n        datas.direction = direction;\r\n        datas.beforeDirection = beforeDirection;\r\n        datas.startValue = 0;\r\n        datas.datas = {};\r\n        setDefaultTransformIndex(moveable, e, \"rotate\");\r\n        var dragStart = false;\r\n        var resizeStart = false;\r\n        if (datas.isControl && datas.resolveAble) {\r\n            var resolveAble = datas.resolveAble;\r\n            if (resolveAble === \"resizable\") {\r\n                resizeStart = Resizable.dragControlStart(moveable, __assign(__assign({}, (new CustomGesto(\"resizable\").dragStart([0, 0], e))), { parentPosition: datas.controlPosition, parentFixedPosition: datas.fixedPosition }));\r\n            }\r\n        }\r\n        if (!resizeStart) {\r\n            dragStart = Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e));\r\n        }\r\n        setFixedPosition(getTotalOrigin(moveable));\r\n        var params = fillParams(moveable, e, __assign(__assign({ set: function (rotatation) {\r\n                datas.startValue = rotatation * Math.PI / 180;\r\n            }, setFixedDirection: setFixedDirection, setFixedPosition: setFixedPosition }, fillTransformStartEvent(moveable, e)), { dragStart: dragStart, resizeStart: resizeStart }));\r\n        var result = triggerEvent(moveable, \"onRotateStart\", params);\r\n        datas.isRotate = result !== false;\r\n        state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n        };\r\n        return datas.isRotate ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a, _b, _c;\r\n        var datas = e.datas, clientDistX = e.clientDistX, clientDistY = e.clientDistY, parentRotate = e.parentRotate, parentFlag = e.parentFlag, isPinch = e.isPinch, groupDelta = e.groupDelta, resolveMatrix = e.resolveMatrix;\r\n        var beforeDirection = datas.beforeDirection, beforeInfo = datas.beforeInfo, afterInfo = datas.afterInfo, absoluteInfo = datas.absoluteInfo, isRotate = datas.isRotate, startValue = datas.startValue, rect = datas.rect, startClientX = datas.startClientX, startClientY = datas.startClientY;\r\n        if (!isRotate) {\r\n            return;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"rotate\");\r\n        var targetDirection = getTransformDirection(e);\r\n        var direction = beforeDirection * targetDirection;\r\n        var parentMoveable = moveable.props.parentMoveable;\r\n        var beforeDelta = 0;\r\n        var beforeDist;\r\n        var beforeRotation;\r\n        var delta = 0;\r\n        var dist;\r\n        var rotation;\r\n        var absoluteDelta = 0;\r\n        var absoluteDist;\r\n        var absoluteRotation;\r\n        var startRotation = 180 / Math.PI * startValue;\r\n        var absoluteStartRotation = absoluteInfo.startValue;\r\n        var isSnap = false;\r\n        var nextClientX = startClientX + clientDistX;\r\n        var nextClientY = startClientY + clientDistY;\r\n        if (!parentFlag && \"parentDist\" in e) {\r\n            var parentDist = e.parentDist;\r\n            beforeDist = parentDist;\r\n            dist = parentDist;\r\n            absoluteDist = parentDist;\r\n        }\r\n        else if (isPinch || parentFlag) {\r\n            beforeDist = getAbsoluteDist(parentRotate, beforeDirection, beforeInfo);\r\n            dist = getAbsoluteDist(parentRotate, direction, afterInfo);\r\n            absoluteDist = getAbsoluteDist(parentRotate, direction, absoluteInfo);\r\n        }\r\n        else {\r\n            beforeDist = getAbsoluteDistByClient(nextClientX, nextClientY, beforeDirection, beforeInfo);\r\n            dist = getAbsoluteDistByClient(nextClientX, nextClientY, direction, afterInfo);\r\n            absoluteDist = getAbsoluteDistByClient(nextClientX, nextClientY, direction, absoluteInfo);\r\n            isSnap = true;\r\n        }\r\n        beforeRotation = startRotation + beforeDist;\r\n        rotation = startRotation + dist;\r\n        absoluteRotation = absoluteStartRotation + absoluteDist;\r\n        triggerEvent(moveable, \"onBeforeRotate\", fillParams(moveable, e, {\r\n            beforeRotation: beforeRotation,\r\n            rotation: rotation,\r\n            absoluteRotation: absoluteRotation,\r\n            setRotation: function (nextRotation) {\r\n                dist = nextRotation - startRotation;\r\n                beforeDist = dist;\r\n                absoluteDist = dist;\r\n            },\r\n        }, true));\r\n        _a = __read(getRotateInfo(moveable, rect, beforeInfo, beforeDist, startRotation, isSnap), 3), beforeDelta = _a[0], beforeDist = _a[1], beforeRotation = _a[2];\r\n        _b = __read(getRotateInfo(moveable, rect, afterInfo, dist, startRotation, isSnap), 3), delta = _b[0], dist = _b[1], rotation = _b[2];\r\n        _c = __read(getRotateInfo(moveable, rect, absoluteInfo, absoluteDist, absoluteStartRotation, isSnap), 3), absoluteDelta = _c[0], absoluteDist = _c[1], absoluteRotation = _c[2];\r\n        if (!absoluteDelta && !delta && !beforeDelta && !parentMoveable && !resolveMatrix) {\r\n            return;\r\n        }\r\n        var nextTransform = convertTransformFormat(datas, \"rotate(\".concat(rotation, \"deg)\"), \"rotate(\".concat(dist, \"deg)\"));\r\n        if (resolveMatrix) {\r\n            datas.fixedPosition = getTranslateFixedPosition(moveable, datas.targetAllTransform, datas.fixedDirection, datas.fixedOffset, datas);\r\n        }\r\n        var inverseDist = getRotateDist(moveable, dist, datas);\r\n        var inverseDelta = minus(plus(groupDelta || [0, 0], inverseDist), datas.prevInverseDist || [0, 0]);\r\n        datas.prevInverseDist = inverseDist;\r\n        datas.requestValue = null;\r\n        var dragEvent = fillTransformEvent(moveable, nextTransform, inverseDelta, isPinch, e);\r\n        var transformEvent = dragEvent;\r\n        var parentDistance = getDist$1([nextClientX, nextClientY], absoluteInfo.startAbsoluteOrigin) - absoluteInfo.startDist;\r\n        var resize = undefined;\r\n        if (datas.resolveAble === \"resizable\") {\r\n            var resizeEvent = Resizable.dragControl(moveable, __assign(__assign({}, setCustomDrag(e, moveable.state, [e.deltaX, e.deltaY], !!isPinch, false, \"resizable\")), { resolveMatrix: true, parentDistance: parentDistance }));\r\n            if (resizeEvent) {\r\n                resize = resizeEvent;\r\n                transformEvent = fillAfterTransform(transformEvent, resizeEvent, e);\r\n            }\r\n        }\r\n        var params = fillParams(moveable, e, __assign(__assign({ delta: delta, dist: dist, rotate: rotation, rotation: rotation, beforeDist: beforeDist, beforeDelta: beforeDelta, beforeRotate: beforeRotation, beforeRotation: beforeRotation, absoluteDist: absoluteDist, absoluteDelta: absoluteDelta, absoluteRotate: absoluteRotation, absoluteRotation: absoluteRotation, isPinch: !!isPinch, resize: resize }, dragEvent), transformEvent));\r\n        triggerEvent(moveable, \"onRotate\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        datas.isRotate = false;\r\n        var params = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onRotateEnd\", params);\r\n        return params;\r\n    },\r\n    dragGroupControlCondition: dragControlCondition,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var _a = moveable.state, parentLeft = _a.left, parentTop = _a.top, parentBeforeOrigin = _a.beforeOrigin;\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        params.set(datas.beforeDirection * moveable.rotation);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            var _a = child.state, left = _a.left, top = _a.top, beforeOrigin = _a.beforeOrigin;\r\n            var childClient = plus(minus([left, top], [parentLeft, parentTop]), minus(beforeOrigin, parentBeforeOrigin));\r\n            ev.datas.startGroupClient = childClient;\r\n            ev.datas.groupClient = childClient;\r\n            return __assign(__assign({}, ev), { parentRotate: 0 });\r\n        });\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events });\r\n        var result = triggerEvent(moveable, \"onRotateGroupStart\", nextParams);\r\n        datas.isRotate = result !== false;\r\n        return datas.isRotate ? params : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        catchEvent(moveable, \"onBeforeRotate\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeRotateGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: moveable.props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var direction = datas.beforeDirection;\r\n        var parentRotate = params.beforeDist;\r\n        var rad = parentRotate / 180 * Math.PI;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var startGroupClient = ev.datas.startGroupClient;\r\n            var _a = __read(ev.datas.groupClient, 2), prevClientX = _a[0], prevClientY = _a[1];\r\n            var _b = __read(rotate(startGroupClient, rad * direction), 2), clientX = _b[0], clientY = _b[1];\r\n            var delta = [clientX - prevClientX, clientY - prevClientY];\r\n            ev.datas.groupClient = [clientX, clientY];\r\n            return __assign(__assign({}, ev), { parentRotate: parentRotate, groupDelta: delta });\r\n        });\r\n        moveable.rotation = direction * params.beforeRotation;\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events, set: function (rotation) {\r\n                moveable.rotation = rotation;\r\n            }, setGroupRotation: function (rotation) {\r\n                moveable.rotation = rotation;\r\n            } }, params);\r\n        triggerEvent(moveable, \"onRotateGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onRotateGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Rotatable#request\r\n     * @param {object} [e] - the Resizable's request parameter\r\n     * @param {number} [e.deltaRotate=0] -  delta number of rotation\r\n     * @param {number} [e.rotate=0] - absolute number of moveable's rotation\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"rotatable\", { deltaRotate: 10 }, true);\r\n     *\r\n     * * moveable.request(\"rotatable\", { rotate: 10 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"rotatable\");\r\n     *\r\n     * // request\r\n     * requester.request({ deltaRotate: 10 });\r\n     * requester.request({ deltaRotate: 10 });\r\n     * requester.request({ deltaRotate: 10 });\r\n     *\r\n     * requester.request({ rotate: 10 });\r\n     * requester.request({ rotate: 20 });\r\n     * requester.request({ rotate: 30 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var distRotate = 0;\r\n        var startRotation = moveable.getRotation();\r\n        return {\r\n            isControl: true,\r\n            requestStart: function () {\r\n                return { datas: datas };\r\n            },\r\n            request: function (e) {\r\n                if (\"deltaRotate\" in e) {\r\n                    distRotate += e.deltaRotate;\r\n                }\r\n                else if (\"rotate\" in e) {\r\n                    distRotate = e.rotate - startRotation;\r\n                }\r\n                return { datas: datas, parentDist: distRotate };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be rotated. (default: false)\r\n * @name Moveable.Rotatable#rotatable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.rotatable = true;\r\n */\r\n/**\r\n * You can specify the position of the rotation. (default: \"top\")\r\n * @name Moveable.Rotatable#rotationPosition\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   rotationPosition: \"top\",\r\n * });\r\n *\r\n * moveable.rotationPosition = \"bottom\"\r\n */\r\n/**\r\n * throttle of angle(degree) when rotate.\r\n * @name Moveable.Rotatable#throttleRotate\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleRotate = 1;\r\n */\r\n/**\r\n * When the rotate starts, the rotateStart event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateStart\r\n * @param {Moveable.Rotatable.OnRotateStart} - Parameters for the rotateStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { rotatable: true });\r\n * moveable.on(\"rotateStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n* When rotating, the rotate event is called.\r\n* @memberof Moveable.Rotatable\r\n* @event rotate\r\n* @param {Moveable.Rotatable.OnRotate} - Parameters for the rotate event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, { rotatable: true });\r\n* moveable.on(\"rotate\", ({ target, transform, dist }) => {\r\n*     target.style.transform = transform;\r\n* });\r\n*/\r\n/**\r\n * When the rotate finishes, the rotateEnd event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateEnd\r\n * @param {Moveable.Rotatable.OnRotateEnd} - Parameters for the rotateEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { rotatable: true });\r\n * moveable.on(\"rotateEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n * When the group rotate starts, the `rotateGroupStart` event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateGroupStart\r\n * @param {Moveable.Rotatable.OnRotateGroupStart} - Parameters for the `rotateGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     rotatable: true\r\n * });\r\n * moveable.on(\"rotateGroupStart\", ({ targets }) => {\r\n *     console.log(\"onRotateGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n* When the group rotate, the `rotateGroup` event is called.\r\n* @memberof Moveable.Rotatable\r\n* @event rotateGroup\r\n* @param {Moveable.Rotatable.OnRotateGroup} - Parameters for the `rotateGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     rotatable: true\r\n* });\r\n* moveable.on(\"rotateGroup\", ({ targets, events }) => {\r\n*     console.log(\"onRotateGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const target = ev.target;\r\n*         // ev.drag is a drag event that occurs when the group rotate.\r\n*         const left = ev.drag.beforeDist[0];\r\n*         const top = ev.drag.beforeDist[1];\r\n*         const deg = ev.beforeDist;\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group rotate finishes, the `rotateGroupEnd` event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateGroupEnd\r\n * @param {Moveable.Rotatable.OnRotateGroupEnd} - Parameters for the `rotateGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     rotatable: true\r\n * });\r\n * moveable.on(\"rotateGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onRotateGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction renderGuideline(info, React) {\r\n    var _a;\r\n    var direction = info.direction, classNames = info.classNames, size = info.size, pos = info.pos, zoom = info.zoom, key = info.key;\r\n    var isHorizontal = direction === \"horizontal\";\r\n    var scaleType = isHorizontal ? \"Y\" : \"X\";\r\n    // const scaleType2 = isHorizontal ? \"Y\" : \"X\";\r\n    return React.createElement(\"div\", {\r\n        key: key,\r\n        className: classNames.join(\" \"),\r\n        style: (_a = {},\r\n            _a[isHorizontal ? \"width\" : \"height\"] = \"\".concat(size),\r\n            _a.transform = \"translate(\".concat(pos[0], \", \").concat(pos[1], \") translate\").concat(scaleType, \"(-50%) scale\").concat(scaleType, \"(\").concat(zoom, \")\"),\r\n            _a),\r\n    });\r\n}\r\nfunction renderInnerGuideline(info, React) {\r\n    return renderGuideline(__assign(__assign({}, info), { classNames: __spreadArray([\r\n            prefix(\"line\", \"guideline\", info.direction)\r\n        ], __read(info.classNames), false).filter(function (className) { return className; }), size: info.size || \"\".concat(info.sizeValue, \"px\"), pos: info.pos || info.posValue.map(function (v) { return \"\".concat(throttle(v, 0.1), \"px\"); }) }), React);\r\n}\r\nfunction renderSnapPoses(moveable, direction, snapPoses, minPos, targetPos, size, index, React) {\r\n    var zoom = moveable.props.zoom;\r\n    return snapPoses.map(function (_a, i) {\r\n        var type = _a.type, pos = _a.pos;\r\n        var renderPos = [0, 0];\r\n        renderPos[index] = minPos;\r\n        renderPos[index ? 0 : 1] = -targetPos + pos;\r\n        return renderInnerGuideline({\r\n            key: \"\".concat(direction, \"TargetGuideline\").concat(i),\r\n            classNames: [prefix(\"target\", \"bold\", type)],\r\n            posValue: renderPos,\r\n            sizeValue: size,\r\n            zoom: zoom,\r\n            direction: direction,\r\n        }, React);\r\n    });\r\n}\r\nfunction renderGuidelines(moveable, type, guidelines, targetPos, targetRect, React) {\r\n    var _a = moveable.props, zoom = _a.zoom, isDisplayInnerSnapDigit = _a.isDisplayInnerSnapDigit;\r\n    var mainNames = type === \"horizontal\" ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n    var targetStart = targetRect[mainNames.start];\r\n    var targetEnd = targetRect[mainNames.end];\r\n    return guidelines.filter(function (_a) {\r\n        var hide = _a.hide, elementRect = _a.elementRect;\r\n        if (hide) {\r\n            return false;\r\n        }\r\n        if (isDisplayInnerSnapDigit && elementRect) {\r\n            // inner\r\n            var rect = elementRect.rect;\r\n            if (rect[mainNames.start] <= targetStart && targetEnd <= rect[mainNames.end]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }).map(function (guideline, i) {\r\n        var pos = guideline.pos, size = guideline.size, element = guideline.element, className = guideline.className;\r\n        var renderPos = [\r\n            -targetPos[0] + pos[0],\r\n            -targetPos[1] + pos[1],\r\n        ];\r\n        return renderInnerGuideline({\r\n            key: \"\".concat(type, \"-default-guideline-\").concat(i),\r\n            classNames: element ? [prefix(\"bold\"), className] : [prefix(\"normal\"), className],\r\n            direction: type,\r\n            posValue: renderPos,\r\n            sizeValue: size,\r\n            zoom: zoom,\r\n        }, React);\r\n    });\r\n}\r\nfunction renderDigitLine(moveable, type, lineType, index, gap, renderPos, className, React) {\r\n    var _a;\r\n    var _b = moveable.props, _c = _b.snapDigit, snapDigit = _c === void 0 ? 0 : _c, _d = _b.isDisplaySnapDigit, isDisplaySnapDigit = _d === void 0 ? true : _d, _e = _b.snapDistFormat, snapDistFormat = _e === void 0 ? function (v, type) {\r\n        // Type can be used render different values.\r\n        if (type === 'vertical') {\r\n            return v;\r\n        }\r\n        return v;\r\n    } : _e, zoom = _b.zoom;\r\n    var scaleType = type === \"horizontal\" ? \"X\" : \"Y\";\r\n    var sizeName = type === \"vertical\" ? \"height\" : \"width\";\r\n    var absGap = Math.abs(gap);\r\n    var snapSize = isDisplaySnapDigit\r\n        ? parseFloat(absGap.toFixed(snapDigit))\r\n        : 0;\r\n    return React.createElement(\"div\", { key: \"\".concat(type, \"-\").concat(lineType, \"-guideline-\").concat(index), className: prefix(\"guideline-group\", type), style: (_a = {\r\n                left: \"\".concat(renderPos[0], \"px\"),\r\n                top: \"\".concat(renderPos[1], \"px\")\r\n            },\r\n            _a[sizeName] = \"\".concat(absGap, \"px\"),\r\n            _a) },\r\n        renderInnerGuideline({\r\n            direction: type,\r\n            classNames: [prefix(lineType), className],\r\n            size: \"100%\",\r\n            posValue: [0, 0],\r\n            sizeValue: absGap,\r\n            zoom: zoom,\r\n        }, React),\r\n        React.createElement(\"div\", { className: prefix(\"size-value\", \"gap\"), style: {\r\n                transform: \"translate\".concat(scaleType, \"(-50%) scale(\").concat(zoom, \")\"),\r\n            } }, snapSize > 0 ? snapDistFormat(snapSize, type) : \"\"));\r\n}\r\nfunction groupByElementGuidelines(type, guidelines, targetRect, isDisplayInnerSnapDigit) {\r\n    var index = type === \"vertical\" ? 0 : 1;\r\n    var otherIndex = type === \"vertical\" ? 1 : 0;\r\n    var names = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n    var targetStart = targetRect[names.start];\r\n    var targetEnd = targetRect[names.end];\r\n    return groupBy(guidelines, function (guideline) {\r\n        return guideline.pos[index];\r\n    }).map(function (nextGuidelines) {\r\n        var start = [];\r\n        var end = [];\r\n        var inner = [];\r\n        nextGuidelines.forEach(function (guideline) {\r\n            var _a, _b;\r\n            var element = guideline.element;\r\n            var rect = guideline.elementRect.rect;\r\n            if (rect[names.end] < targetStart) {\r\n                start.push(guideline);\r\n            }\r\n            else if (targetEnd < rect[names.start]) {\r\n                end.push(guideline);\r\n            }\r\n            else if (rect[names.start] <= targetStart && targetEnd <= rect[names.end] && isDisplayInnerSnapDigit) {\r\n                var pos = guideline.pos;\r\n                var elementRect1 = { element: element, rect: __assign(__assign({}, rect), (_a = {}, _a[names.end] = rect[names.start], _a)) };\r\n                var elementRect2 = { element: element, rect: __assign(__assign({}, rect), (_b = {}, _b[names.start] = rect[names.end], _b)) };\r\n                var nextPos1 = [0, 0];\r\n                var nextPos2 = [0, 0];\r\n                nextPos1[index] = pos[index];\r\n                nextPos1[otherIndex] = pos[otherIndex];\r\n                nextPos2[index] = pos[index];\r\n                nextPos2[otherIndex] = pos[otherIndex] + guideline.size;\r\n                start.push({\r\n                    type: type,\r\n                    pos: nextPos1,\r\n                    size: 0,\r\n                    elementRect: elementRect1,\r\n                    direction: \"\",\r\n                    elementDirection: \"end\",\r\n                });\r\n                end.push({\r\n                    type: type,\r\n                    pos: nextPos2,\r\n                    size: 0,\r\n                    elementRect: elementRect2,\r\n                    direction: \"\",\r\n                    elementDirection: \"start\",\r\n                });\r\n                // inner.push(guideline);\r\n            }\r\n        });\r\n        start.sort(function (a, b) {\r\n            return b.pos[otherIndex] - a.pos[otherIndex];\r\n        });\r\n        end.sort(function (a, b) {\r\n            return a.pos[otherIndex] - b.pos[otherIndex];\r\n        });\r\n        return {\r\n            total: nextGuidelines,\r\n            start: start,\r\n            end: end,\r\n            inner: inner,\r\n        };\r\n    });\r\n}\r\nfunction renderDashedGuidelines(moveable, guidelines, targetPos, targetRect, React) {\r\n    var isDisplayInnerSnapDigit = moveable.props.isDisplayInnerSnapDigit;\r\n    var rendered = [];\r\n    [\"vertical\", \"horizontal\"].forEach(function (type) {\r\n        var nextGuidelines = guidelines.filter(function (guideline) { return guideline.type === type; });\r\n        var index = type === \"vertical\" ? 1 : 0;\r\n        var otherIndex = index ? 0 : 1;\r\n        var groups = groupByElementGuidelines(type, nextGuidelines, targetRect, isDisplayInnerSnapDigit);\r\n        var mainNames = index ? HORIZONTAL_NAMES_MAP : VERTICAL_NAMES_MAP;\r\n        var sideNames = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        groups.forEach(function (_a) {\r\n            var total = _a.total, start = _a.start, end = _a.end, inner = _a.inner;\r\n            var sidePos = targetPos[otherIndex] + total[0].pos[otherIndex] - targetRect[sideNames.start];\r\n            var prevRect = targetRect;\r\n            start.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size = prevRect[mainNames.start] - nextRect[mainNames.end];\r\n                if (size > 0) {\r\n                    var renderPos = [0, 0];\r\n                    renderPos[index] = targetPos[index] + prevRect[mainNames.start] - targetStart - size;\r\n                    renderPos[otherIndex] = sidePos;\r\n                    rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size, renderPos, guideline.className, React));\r\n                }\r\n                prevRect = nextRect;\r\n            });\r\n            prevRect = targetRect;\r\n            end.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size = nextRect[mainNames.start] - prevRect[mainNames.end];\r\n                if (size > 0) {\r\n                    var renderPos = [0, 0];\r\n                    renderPos[index] = targetPos[index] + prevRect[mainNames.end] - targetStart;\r\n                    renderPos[otherIndex] = sidePos;\r\n                    rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size, renderPos, guideline.className, React));\r\n                }\r\n                prevRect = nextRect;\r\n            });\r\n            inner.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size1 = targetStart - nextRect[mainNames.start];\r\n                var size2 = nextRect[mainNames.end] - targetEnd;\r\n                var renderPos1 = [0, 0];\r\n                var renderPos2 = [0, 0];\r\n                renderPos1[index] = targetPos[index] - size1;\r\n                renderPos1[otherIndex] = sidePos;\r\n                renderPos2[index] = targetPos[index] + targetEnd - targetStart;\r\n                renderPos2[otherIndex] = sidePos;\r\n                rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size1, renderPos1, guideline.className, React));\r\n                rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size2, renderPos2, guideline.className, React));\r\n            });\r\n        });\r\n    });\r\n    return rendered;\r\n}\r\nfunction renderGapGuidelines(moveable, guidelines, targetPos, targetRect, React) {\r\n    var rendered = [];\r\n    [\"horizontal\", \"vertical\"].forEach(function (type) {\r\n        var nextGuidelines = guidelines.filter(function (guideline) { return guideline.type === type; }).slice(0, 1);\r\n        var index = type === \"vertical\" ? 0 : 1;\r\n        var otherIndex = index ? 0 : 1;\r\n        var mainNames = index ? HORIZONTAL_NAMES_MAP : VERTICAL_NAMES_MAP;\r\n        var sideNames = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        var targetSideStart = targetRect[sideNames.start];\r\n        var targetSideEnd = targetRect[sideNames.end];\r\n        nextGuidelines.forEach(function (_a) {\r\n            var gap = _a.gap, gapRects = _a.gapRects;\r\n            var sideStartPos = Math.max.apply(Math, __spreadArray([targetSideStart], __read(gapRects.map(function (_a) {\r\n                var rect = _a.rect;\r\n                return rect[sideNames.start];\r\n            })), false));\r\n            var sideEndPos = Math.min.apply(Math, __spreadArray([targetSideEnd], __read(gapRects.map(function (_a) {\r\n                var rect = _a.rect;\r\n                return rect[sideNames.end];\r\n            })), false));\r\n            var sideCenterPos = (sideStartPos + sideEndPos) / 2;\r\n            if (sideStartPos === sideEndPos || sideCenterPos === (targetSideStart + targetSideEnd) / 2) {\r\n                return;\r\n            }\r\n            gapRects.forEach(function (_a) {\r\n                var rect = _a.rect, className = _a.className;\r\n                var renderPos = [targetPos[0], targetPos[1]];\r\n                if (rect[mainNames.end] < targetStart) {\r\n                    renderPos[index] += rect[mainNames.end] - targetStart;\r\n                }\r\n                else if (targetEnd < rect[mainNames.start]) {\r\n                    renderPos[index] += rect[mainNames.start] - targetStart - gap;\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n                renderPos[otherIndex] += sideCenterPos - targetSideStart;\r\n                rendered.push(renderDigitLine(moveable, index ? \"vertical\" : \"horizontal\", \"gap\", rendered.length, gap, renderPos, className, React));\r\n            });\r\n        });\r\n    });\r\n    return rendered;\r\n}\n\nfunction getTotalGuidelines(moveable) {\r\n    var _a, _b;\r\n    var state = moveable.state;\r\n    var containerClientRect = state.containerClientRect, hasFixed = state.hasFixed;\r\n    var overflow = containerClientRect.overflow, containerHeight = containerClientRect.scrollHeight, containerWidth = containerClientRect.scrollWidth, containerClientHeight = containerClientRect.clientHeight, containerClientWidth = containerClientRect.clientWidth, clientLeft = containerClientRect.clientLeft, clientTop = containerClientRect.clientTop;\r\n    var _c = moveable.props, _d = _c.snapGap, snapGap = _d === void 0 ? true : _d, verticalGuidelines = _c.verticalGuidelines, horizontalGuidelines = _c.horizontalGuidelines, _e = _c.snapThreshold, snapThreshold = _e === void 0 ? 5 : _e, _f = _c.maxSnapElementGuidelineDistance, maxSnapElementGuidelineDistance = _f === void 0 ? Infinity : _f, isDisplayGridGuidelines = _c.isDisplayGridGuidelines;\r\n    var _g = getRect(getAbsolutePosesByState(moveable.state)), top = _g.top, left = _g.left, bottom = _g.bottom, right = _g.right;\r\n    var targetRect = { top: top, left: left, bottom: bottom, right: right, center: (left + right) / 2, middle: (top + bottom) / 2 };\r\n    var elementGuidelines = getElementGuidelines(moveable);\r\n    var totalGuidelines = __spreadArray([], __read(elementGuidelines), false);\r\n    var snapThresholdMultiples = ((_b = (_a = state.snapThresholdInfo) === null || _a === void 0 ? void 0 : _a.multiples) !== null && _b !== void 0 ? _b : [1, 1]).map(function (n) { return n * snapThreshold; });\r\n    if (snapGap) {\r\n        totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getGapGuidelines(moveable, targetRect, snapThresholdMultiples)), false));\r\n    }\r\n    var snapOffset = __assign({}, (state.snapOffset || {\r\n        left: 0,\r\n        top: 0,\r\n        bottom: 0,\r\n        right: 0,\r\n    }));\r\n    totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getGridGuidelines(moveable, overflow ? containerWidth : containerClientWidth, overflow ? containerHeight : containerClientHeight, clientLeft, clientTop, snapOffset, isDisplayGridGuidelines)), false));\r\n    if (hasFixed) {\r\n        var left_1 = containerClientRect.left, top_1 = containerClientRect.top;\r\n        snapOffset.left += left_1;\r\n        snapOffset.top += top_1;\r\n        snapOffset.right += left_1;\r\n        snapOffset.bottom += top_1;\r\n    }\r\n    totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getDefaultGuidelines(horizontalGuidelines || false, verticalGuidelines || false, overflow ? containerWidth : containerClientWidth, overflow ? containerHeight : containerClientHeight, clientLeft, clientTop, snapOffset)), false));\r\n    totalGuidelines = totalGuidelines.filter(function (_a) {\r\n        var element = _a.element, elementRect = _a.elementRect, type = _a.type;\r\n        if (!element || !elementRect) {\r\n            return true;\r\n        }\r\n        var rect = elementRect.rect;\r\n        return checkBetweenRects(targetRect, rect, type, maxSnapElementGuidelineDistance);\r\n    });\r\n    return totalGuidelines;\r\n}\r\nfunction getGapGuidelines(moveable, targetRect, snapThresholds) {\r\n    var _a = moveable.props, _b = _a.maxSnapElementGuidelineDistance, maxSnapElementGuidelineDistance = _b === void 0 ? Infinity : _b, _c = _a.maxSnapElementGapDistance, maxSnapElementGapDistance = _c === void 0 ? Infinity : _c;\r\n    var elementRects = moveable.state.elementRects;\r\n    var gapGuidelines = [];\r\n    [\r\n        [\"vertical\", VERTICAL_NAMES_MAP, HORIZONTAL_NAMES_MAP],\r\n        [\"horizontal\", HORIZONTAL_NAMES_MAP, VERTICAL_NAMES_MAP],\r\n    ].forEach(function (_a) {\r\n        var _b = __read(_a, 3), type = _b[0], mainNames = _b[1], sideNames = _b[2];\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        var targetCenter = targetRect[mainNames.center];\r\n        var targetStart2 = targetRect[sideNames.start];\r\n        var targetEnd2 = targetRect[sideNames.end];\r\n        // element : moveable\r\n        var snapThresholdMap = {\r\n            left: snapThresholds[0],\r\n            top: snapThresholds[1],\r\n        };\r\n        function getDist(elementRect) {\r\n            var rect = elementRect.rect;\r\n            var snapThreshold = snapThresholdMap[mainNames.start];\r\n            if (rect[mainNames.end] < targetStart + snapThreshold) {\r\n                return targetStart - rect[mainNames.end];\r\n            }\r\n            else if (targetEnd - snapThreshold < rect[mainNames.start]) {\r\n                return rect[mainNames.start] - targetEnd;\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n        }\r\n        var nextElementRects = elementRects.filter(function (elementRect) {\r\n            var rect = elementRect.rect;\r\n            if (rect[sideNames.start] > targetEnd2 || rect[sideNames.end] < targetStart2) {\r\n                return false;\r\n            }\r\n            return getDist(elementRect) > 0;\r\n        }).sort(function (a, b) {\r\n            return getDist(a) - getDist(b);\r\n        });\r\n        var groups = [];\r\n        nextElementRects.forEach(function (snapRect1) {\r\n            nextElementRects.forEach(function (snapRect2) {\r\n                if (snapRect1 === snapRect2) {\r\n                    return;\r\n                }\r\n                var rect1 = snapRect1.rect;\r\n                var rect2 = snapRect2.rect;\r\n                var rect1Start = rect1[sideNames.start];\r\n                var rect1End = rect1[sideNames.end];\r\n                var rect2Start = rect2[sideNames.start];\r\n                var rect2End = rect2[sideNames.end];\r\n                if (rect1Start > rect2End || rect2Start > rect1End) {\r\n                    return;\r\n                }\r\n                groups.push([snapRect1, snapRect2]);\r\n            });\r\n        });\r\n        groups.forEach(function (_a) {\r\n            var _b = __read(_a, 2), snapRect1 = _b[0], snapRect2 = _b[1];\r\n            var rect1 = snapRect1.rect;\r\n            var rect2 = snapRect2.rect;\r\n            var rect1Start = rect1[mainNames.start];\r\n            var rect1End = rect1[mainNames.end];\r\n            var rect2Start = rect2[mainNames.start];\r\n            var rect2End = rect2[mainNames.end];\r\n            var snapThreshold = snapThresholdMap[mainNames.start];\r\n            var gap = 0;\r\n            var pos = 0;\r\n            var isStart = false;\r\n            var isCenter = false;\r\n            var isEnd = false;\r\n            if (rect1End <= targetStart && targetEnd <= rect2Start) {\r\n                // (l)element1(r) : (l)target(r) : (l)element2(r)\r\n                isCenter = true;\r\n                gap = ((rect2Start - rect1End) - (targetEnd - targetStart)) / 2;\r\n                pos = rect1End + gap + (targetEnd - targetStart) / 2;\r\n                if (abs(pos - targetCenter) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else if (rect1End < rect2Start && rect2End < targetStart + snapThreshold) {\r\n                // (l)element1(r) : (l)element2(r) : (l)target\r\n                isStart = true;\r\n                gap = rect2Start - rect1End;\r\n                pos = rect2End + gap;\r\n                if (abs(pos - targetStart) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else if (rect1End < rect2Start && targetEnd - snapThreshold < rect1Start) {\r\n                // target(r) : (l)element1(r) : (l)element2(r)\r\n                isEnd = true;\r\n                gap = rect2Start - rect1End;\r\n                pos = rect1Start - gap;\r\n                if (abs(pos - targetEnd) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n            if (!gap) {\r\n                return;\r\n            }\r\n            if (!checkBetweenRects(targetRect, rect2, type, maxSnapElementGuidelineDistance)) {\r\n                return;\r\n            }\r\n            if (gap > maxSnapElementGapDistance) {\r\n                return;\r\n            }\r\n            gapGuidelines.push({\r\n                type: type,\r\n                pos: type === \"vertical\" ? [pos, 0] : [0, pos],\r\n                element: snapRect2.element,\r\n                size: 0,\r\n                className: snapRect2.className,\r\n                isStart: isStart,\r\n                isCenter: isCenter,\r\n                isEnd: isEnd,\r\n                gap: gap,\r\n                hide: true,\r\n                gapRects: [snapRect1, snapRect2],\r\n                direction: \"\",\r\n                elementDirection: \"\",\r\n            });\r\n        });\r\n    });\r\n    return gapGuidelines;\r\n}\r\nfunction startGridGroupGuidelines(moveable, clientLeft, clientTop, snapOffset) {\r\n    var _a, _b;\r\n    var props = moveable.props;\r\n    var state = moveable.state;\r\n    var snapGridAll = props.snapGridAll;\r\n    var _c = props.snapGridWidth, snapGridWidth = _c === void 0 ? 0 : _c, _d = props.snapGridHeight, snapGridHeight = _d === void 0 ? 0 : _d;\r\n    var snapRenderInfo = state.snapRenderInfo;\r\n    var hasDirection = snapRenderInfo && (((_a = snapRenderInfo.direction) === null || _a === void 0 ? void 0 : _a[0]) || ((_b = snapRenderInfo.direction) === null || _b === void 0 ? void 0 : _b[1]));\r\n    var moveables = moveable.moveables;\r\n    // snap group's all child to grid.\r\n    if (snapGridAll\r\n        && moveables\r\n        && hasDirection\r\n        && (snapGridWidth || snapGridHeight)) {\r\n        if (state.snapThresholdInfo) {\r\n            return;\r\n        }\r\n        state.snapThresholdInfo = {\r\n            multiples: [1, 1],\r\n            offset: [0, 0],\r\n        };\r\n        var rect_1 = moveable.getRect();\r\n        var children_1 = rect_1.children;\r\n        var direction = snapRenderInfo.direction;\r\n        if (children_1) {\r\n            var result = direction.map(function (dir, i) {\r\n                var _a = i === 0 ? {\r\n                    snapSize: snapGridWidth,\r\n                    posName: \"left\",\r\n                    sizeName: \"width\",\r\n                    clientOffset: snapOffset.left - clientLeft,\r\n                } : {\r\n                    snapSize: snapGridHeight,\r\n                    posName: \"top\",\r\n                    sizeName: \"height\",\r\n                    clientOffset: snapOffset.top - clientTop,\r\n                }, snapSize = _a.snapSize, posName = _a.posName, sizeName = _a.sizeName, clientOffset = _a.clientOffset;\r\n                if (!snapSize) {\r\n                    return {\r\n                        dir: dir,\r\n                        multiple: 1,\r\n                        snapSize: snapSize,\r\n                        snapOffset: 0,\r\n                    };\r\n                }\r\n                var rectSize = rect_1[sizeName];\r\n                var rectPos = rect_1[posName];\r\n                //     ?\r\n                var childSizes = flat$1(children_1.map(function (child) {\r\n                    return [\r\n                        (child[posName] - rectPos),\r\n                        (child[sizeName]),\r\n                        (rectSize - child[sizeName] - child[posName] + rectPos),\r\n                    ];\r\n                })).filter(function (v) { return v; }).sort(function (a, b) {\r\n                    return a - b;\r\n                });\r\n                var firstChildSize = childSizes[0];\r\n                var childSnapSizes = childSizes.map(function (size) { return throttle(size / firstChildSize, 0.1) * snapSize; });\r\n                var n = 1;\r\n                var rectRatio = throttle(rectSize / firstChildSize, 0.1);\r\n                for (n = 1; n <= 10; ++n) {\r\n                    if (childSnapSizes.every(function (childSize) {\r\n                        return childSize * n % 1 === 0;\r\n                    })) {\r\n                        break;\r\n                    }\r\n                }\r\n                // dir 1 (fixed -1)\r\n                // dir 0 (fixed 0)\r\n                // dir -1 (fixed 1)\r\n                var ratio = (-dir + 1) / 2;\r\n                var offsetPos = dot(rectPos - clientOffset, rectPos - clientOffset + rectSize, ratio, 1 - ratio);\r\n                return {\r\n                    multiple: rectRatio * n,\r\n                    dir: dir,\r\n                    snapSize: snapSize,\r\n                    snapOffset: Math.round(offsetPos / snapSize),\r\n                };\r\n            });\r\n            var multiples = result.map(function (r) { return r.multiple || 1; });\r\n            state.snapThresholdInfo.multiples = multiples;\r\n            state.snapThresholdInfo.offset = result.map(function (r) { return r.snapOffset; });\r\n            result.forEach(function (r, i) {\r\n                if (r.snapSize) ;\r\n            });\r\n        }\r\n    }\r\n    else {\r\n        state.snapThresholdInfo = null;\r\n    }\r\n}\r\nfunction getGridGuidelines(moveable, containerWidth, containerHeight, clientLeft, clientTop, snapOffset, isDisplayGridGuidelines) {\r\n    if (clientLeft === void 0) { clientLeft = 0; }\r\n    if (clientTop === void 0) { clientTop = 0; }\r\n    var props = moveable.props;\r\n    var state = moveable.state;\r\n    var _a = props.snapGridWidth, snapGridWidth = _a === void 0 ? 0 : _a, _b = props.snapGridHeight, snapGridHeight = _b === void 0 ? 0 : _b;\r\n    var guidelines = [];\r\n    var snapOffsetLeft = snapOffset.left, snapOffsetTop = snapOffset.top;\r\n    var startOffset = [0, 0];\r\n    startGridGroupGuidelines(moveable, clientLeft, clientTop, snapOffset);\r\n    var snapThresholdInfo = state.snapThresholdInfo;\r\n    var defaultSnapGridWidth = snapGridWidth;\r\n    var defaultSnapGridHeight = snapGridHeight;\r\n    if (snapThresholdInfo) {\r\n        snapGridWidth *= snapThresholdInfo.multiples[0] || 1;\r\n        snapGridHeight *= snapThresholdInfo.multiples[1] || 1;\r\n        startOffset = snapThresholdInfo.offset;\r\n    }\r\n    if (snapGridHeight) {\r\n        var pushGuideline = function (pos) {\r\n            guidelines.push({\r\n                type: \"horizontal\",\r\n                pos: [\r\n                    snapOffsetLeft,\r\n                    throttle(startOffset[1] * defaultSnapGridHeight + pos - clientTop + snapOffsetTop, 0.1),\r\n                ],\r\n                className: prefix(\"grid-guideline\"),\r\n                size: containerWidth,\r\n                hide: !isDisplayGridGuidelines,\r\n                direction: \"\",\r\n                grid: true,\r\n            });\r\n        };\r\n        for (var pos = 0; pos <= containerHeight * 2; pos += snapGridHeight) {\r\n            pushGuideline(pos);\r\n        }\r\n        for (var pos = -snapGridHeight; pos >= -containerHeight; pos -= snapGridHeight) {\r\n            pushGuideline(pos);\r\n        }\r\n    }\r\n    if (snapGridWidth) {\r\n        var pushGuideline = function (pos) {\r\n            guidelines.push({\r\n                type: \"vertical\",\r\n                pos: [\r\n                    throttle(startOffset[0] * defaultSnapGridWidth + pos - clientLeft + snapOffsetLeft, 0.1),\r\n                    snapOffsetTop,\r\n                ],\r\n                className: prefix(\"grid-guideline\"),\r\n                size: containerHeight,\r\n                hide: !isDisplayGridGuidelines,\r\n                direction: \"\",\r\n                grid: true,\r\n            });\r\n        };\r\n        for (var pos = 0; pos <= containerWidth * 2; pos += snapGridWidth) {\r\n            pushGuideline(pos);\r\n        }\r\n        for (var pos = -snapGridWidth; pos >= -containerWidth; pos -= snapGridWidth) {\r\n            pushGuideline(pos);\r\n        }\r\n    }\r\n    return guidelines;\r\n}\r\nfunction checkBetweenRects(rect1, rect2, type, distance) {\r\n    if (type === \"horizontal\") {\r\n        return abs(rect1.right - rect2.left) <= distance\r\n            || abs(rect1.left - rect2.right) <= distance\r\n            || rect1.left <= rect2.right && rect2.left <= rect1.right;\r\n    }\r\n    else if (type === \"vertical\") {\r\n        return abs(rect1.bottom - rect2.top) <= distance\r\n            || abs(rect1.top - rect2.bottom) <= distance\r\n            || rect1.top <= rect2.bottom && rect2.top <= rect1.bottom;\r\n    }\r\n    return true;\r\n}\r\nfunction getElementGuidelines(moveable) {\r\n    var state = moveable.state;\r\n    var _a = moveable.props.elementGuidelines, elementGuidelines = _a === void 0 ? [] : _a;\r\n    if (!elementGuidelines.length) {\r\n        state.elementRects = [];\r\n        return [];\r\n    }\r\n    var prevValues = (state.elementRects || []).filter(function (snapRect) { return !snapRect.refresh; });\r\n    var nextElementGuidelines = elementGuidelines.map(function (el) {\r\n        if (isObject(el) && \"element\" in el) {\r\n            return __assign(__assign({}, el), { element: getRefTarget(el.element, true) });\r\n        }\r\n        return {\r\n            element: getRefTarget(el, true),\r\n        };\r\n    }).filter(function (value) {\r\n        return value.element;\r\n    });\r\n    var _b = diff(prevValues.map(function (v) { return v.element; }), nextElementGuidelines.map(function (v) { return v.element; })), maintained = _b.maintained, added = _b.added;\r\n    var nextValues = [];\r\n    maintained.forEach(function (_a) {\r\n        var _b = __read(_a, 2), prevIndex = _b[0], nextIndex = _b[1];\r\n        nextValues[nextIndex] = prevValues[prevIndex];\r\n    });\r\n    getSnapElementRects(moveable, added.map(function (index) { return nextElementGuidelines[index]; })).map(function (rect, i) {\r\n        nextValues[added[i]] = rect;\r\n    });\r\n    state.elementRects = nextValues;\r\n    var elementSnapDirections = getSnapDirections(moveable.props.elementSnapDirections);\r\n    var nextGuidelines = [];\r\n    nextValues.forEach(function (snapRect) {\r\n        var element = snapRect.element, _a = snapRect.top, topValue = _a === void 0 ? elementSnapDirections.top : _a, _b = snapRect.left, leftValue = _b === void 0 ? elementSnapDirections.left : _b, _c = snapRect.right, rightValue = _c === void 0 ? elementSnapDirections.right : _c, _d = snapRect.bottom, bottomValue = _d === void 0 ? elementSnapDirections.bottom : _d, _e = snapRect.center, centerValue = _e === void 0 ? elementSnapDirections.center : _e, _f = snapRect.middle, middleValue = _f === void 0 ? elementSnapDirections.middle : _f, className = snapRect.className, rect = snapRect.rect;\r\n        var _g = splitSnapDirectionPoses({\r\n            top: topValue,\r\n            right: rightValue,\r\n            left: leftValue,\r\n            bottom: bottomValue,\r\n            center: centerValue,\r\n            middle: middleValue,\r\n        }, rect), horizontal = _g.horizontal, vertical = _g.vertical, horizontalNames = _g.horizontalNames, verticalNames = _g.verticalNames;\r\n        var rectTop = rect.top;\r\n        var rectLeft = rect.left;\r\n        var width = rect.right - rectLeft;\r\n        var height = rect.bottom - rectTop;\r\n        var sizes = [width, height];\r\n        vertical.forEach(function (pos, i) {\r\n            nextGuidelines.push({\r\n                type: \"vertical\",\r\n                element: element,\r\n                pos: [\r\n                    throttle(pos, 0.1),\r\n                    rectTop,\r\n                ], size: height,\r\n                sizes: sizes,\r\n                className: className,\r\n                elementRect: snapRect,\r\n                elementDirection: SNAP_SKIP_NAMES_MAP[verticalNames[i]] || verticalNames[i],\r\n                direction: \"\",\r\n            });\r\n        });\r\n        horizontal.forEach(function (pos, i) {\r\n            nextGuidelines.push({\r\n                type: \"horizontal\",\r\n                element: element,\r\n                pos: [\r\n                    rectLeft,\r\n                    throttle(pos, 0.1),\r\n                ],\r\n                size: width,\r\n                sizes: sizes,\r\n                className: className,\r\n                elementRect: snapRect,\r\n                elementDirection: SNAP_SKIP_NAMES_MAP[horizontalNames[i]] || horizontalNames[i],\r\n                direction: \"\",\r\n            });\r\n        });\r\n    });\r\n    return nextGuidelines;\r\n}\r\nfunction getObjectGuidelines(guidelines, containerSize) {\r\n    return guidelines ? guidelines.map(function (info) {\r\n        var posGuideline = isObject(info) ? info : { pos: info };\r\n        var pos = posGuideline.pos;\r\n        if (isNumber(pos)) {\r\n            return posGuideline;\r\n        }\r\n        else {\r\n            return __assign(__assign({}, posGuideline), { pos: convertUnitSize(pos, containerSize) });\r\n        }\r\n    }) : [];\r\n}\r\nfunction getDefaultGuidelines(horizontalGuidelines, verticalGuidelines, width, height, clientLeft, clientTop, snapOffset) {\r\n    if (clientLeft === void 0) { clientLeft = 0; }\r\n    if (clientTop === void 0) { clientTop = 0; }\r\n    if (snapOffset === void 0) { snapOffset = { left: 0, top: 0, right: 0, bottom: 0 }; }\r\n    var guidelines = [];\r\n    var snapOffsetLeft = snapOffset.left, snapOffsetTop = snapOffset.top, snapOffsetBottom = snapOffset.bottom, snapOffsetRight = snapOffset.right;\r\n    var snapWidth = width + snapOffsetRight - snapOffsetLeft;\r\n    var snapHeight = height + snapOffsetBottom - snapOffsetTop;\r\n    getObjectGuidelines(horizontalGuidelines, snapHeight).forEach(function (posInfo) {\r\n        guidelines.push({\r\n            type: \"horizontal\",\r\n            pos: [\r\n                snapOffsetLeft,\r\n                throttle(posInfo.pos - clientTop + snapOffsetTop, 0.1),\r\n            ],\r\n            size: snapWidth,\r\n            className: posInfo.className,\r\n            direction: \"\",\r\n        });\r\n    });\r\n    getObjectGuidelines(verticalGuidelines, snapWidth).forEach(function (posInfo) {\r\n        guidelines.push({\r\n            type: \"vertical\",\r\n            pos: [\r\n                throttle(posInfo.pos - clientLeft + snapOffsetLeft, 0.1),\r\n                snapOffsetTop,\r\n            ],\r\n            size: snapHeight,\r\n            className: posInfo.className,\r\n            direction: \"\",\r\n        });\r\n    });\r\n    return guidelines;\r\n}\r\nfunction getSnapElementRects(moveable, values) {\r\n    if (!values.length) {\r\n        return [];\r\n    }\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var containerClientRect = state.containerClientRect, \r\n    // targetClientRect: {\r\n    //     top: clientTop,\r\n    //     left: clientLeft,\r\n    // },\r\n    rootMatrix = state.rootMatrix, is3d = state.is3d, offsetDelta = state.offsetDelta;\r\n    var n = is3d ? 4 : 3;\r\n    var _a = __read(calculateContainerPos(rootMatrix, containerClientRect, n), 2), containerLeft = _a[0], containerTop = _a[1];\r\n    // const poses = getAbsolutePosesByState(state);\r\n    // const {\r\n    //     minX: targetLeft,\r\n    //     minY: targetTop,\r\n    // } = getMinMaxs(poses);\r\n    // const [distLeft, distTop] = minus([targetLeft, targetTop], calculateInversePosition(rootMatrix, [\r\n    //     clientLeft - containerLeft,\r\n    //     clientTop - containerTop,\r\n    // ], n)).map(pos => roundSign(pos));\r\n    var offsetLeft = groupable ? 0 : offsetDelta[0];\r\n    var offsetTop = groupable ? 0 : offsetDelta[1];\r\n    return values.map(function (value) {\r\n        var rect = value.element.getBoundingClientRect();\r\n        var left = rect.left - containerLeft - offsetLeft;\r\n        var top = rect.top - containerTop - offsetTop;\r\n        var bottom = top + rect.height;\r\n        var right = left + rect.width;\r\n        var _a = __read(calculateInversePosition(rootMatrix, [left, top], n), 2), elementLeft = _a[0], elementTop = _a[1];\r\n        var _b = __read(calculateInversePosition(rootMatrix, [right, bottom], n), 2), elementRight = _b[0], elementBottom = _b[1];\r\n        return __assign(__assign({}, value), { rect: {\r\n                left: elementLeft,\r\n                right: elementRight,\r\n                top: elementTop,\r\n                bottom: elementBottom,\r\n                center: (elementLeft + elementRight) / 2,\r\n                middle: (elementTop + elementBottom) / 2,\r\n            } });\r\n    });\r\n}\n\nfunction checkSnapInfo(moveable) {\r\n    var state = moveable.state;\r\n    var container = state.container;\r\n    var snapContainer = moveable.props.snapContainer || container;\r\n    if (state.snapContainer === snapContainer && state.guidelines && state.guidelines.length) {\r\n        return false;\r\n    }\r\n    var containerClientRect = state.containerClientRect;\r\n    var snapOffset = {\r\n        left: 0,\r\n        top: 0,\r\n        bottom: 0,\r\n        right: 0,\r\n    };\r\n    if (container !== snapContainer) {\r\n        var snapContainerTarget = getRefTarget(snapContainer, true);\r\n        if (snapContainerTarget) {\r\n            var snapContainerRect = getClientRect(snapContainerTarget);\r\n            var offset1 = getDragDistByState(state, [\r\n                snapContainerRect.left - containerClientRect.left,\r\n                snapContainerRect.top - containerClientRect.top,\r\n            ]);\r\n            var offset2 = getDragDistByState(state, [\r\n                snapContainerRect.right - containerClientRect.right,\r\n                snapContainerRect.bottom - containerClientRect.bottom,\r\n            ]);\r\n            snapOffset.left = throttle(offset1[0], 0.00001);\r\n            snapOffset.top = throttle(offset1[1], 0.00001);\r\n            snapOffset.right = throttle(offset2[0], 0.00001);\r\n            snapOffset.bottom = throttle(offset2[1], 0.00001);\r\n        }\r\n    }\r\n    state.snapContainer = snapContainer;\r\n    state.snapOffset = snapOffset;\r\n    state.guidelines = getTotalGuidelines(moveable);\r\n    state.enableSnap = true;\r\n    return true;\r\n}\r\nfunction getNextFixedPoses(matrix, width, height, fixedDirection, fixedPos, is3d) {\r\n    var nextPoses = calculatePoses(matrix, width, height, is3d ? 4 : 3);\r\n    var nextFixedPos = getPosByDirection(nextPoses, fixedDirection);\r\n    return getAbsolutePoses(nextPoses, minus(fixedPos, nextFixedPos));\r\n}\r\nfunction normalized(value) {\r\n    return value ? value / abs(value) : 0;\r\n}\r\nfunction getSizeOffsetInfo(moveable, poses, direction, keepRatio, isRequest, datas) {\r\n    var fixedDirection = datas.fixedDirection;\r\n    var directions = getCheckSnapDirections(direction, fixedDirection, keepRatio);\r\n    var innerBoundLineInfos = getCheckInnerBoundLineInfos(moveable, poses, direction, keepRatio);\r\n    var offsets = __spreadArray(__spreadArray([], __read(getSnapBoundInfo(moveable, poses, directions, keepRatio, isRequest, datas)), false), __read(getInnerBoundInfo(moveable, innerBoundLineInfos, datas)), false);\r\n    var widthOffsetInfo = getNearOffsetInfo(offsets, 0);\r\n    var heightOffsetInfo = getNearOffsetInfo(offsets, 1);\r\n    return {\r\n        width: {\r\n            isBound: widthOffsetInfo.isBound,\r\n            offset: widthOffsetInfo.offset[0],\r\n        },\r\n        height: {\r\n            isBound: heightOffsetInfo.isBound,\r\n            offset: heightOffsetInfo.offset[1],\r\n        },\r\n    };\r\n}\r\nfunction recheckSizeByTwoDirection(moveable, poses, width, height, maxWidth, maxHeight, direction, isRequest, datas) {\r\n    var snapPos = getPosByDirection(poses, direction);\r\n    var _a = checkMoveableSnapBounds(moveable, isRequest, {\r\n        vertical: [snapPos[0]],\r\n        horizontal: [snapPos[1]],\r\n    }), horizontalOffset = _a.horizontal.offset, verticalOffset = _a.vertical.offset;\r\n    if (throttle(verticalOffset, FLOAT_POINT_NUM) || throttle(horizontalOffset, FLOAT_POINT_NUM)) {\r\n        var _b = __read(getDragDist({\r\n            datas: datas,\r\n            distX: -verticalOffset,\r\n            distY: -horizontalOffset,\r\n        }), 2), nextWidthOffset = _b[0], nextHeightOffset = _b[1];\r\n        var nextWidth = Math.min(maxWidth || Infinity, width + direction[0] * nextWidthOffset);\r\n        var nextHeight = Math.min(maxHeight || Infinity, height + direction[1] * nextHeightOffset);\r\n        return [nextWidth - width, nextHeight - height];\r\n    }\r\n    return [0, 0];\r\n}\r\nfunction checkSizeDist(moveable, getNextPoses, width, height, direction, fixedPosition, isRequest, datas) {\r\n    var poses = getAbsolutePosesByState(moveable.state);\r\n    var keepRatio = moveable.props.keepRatio;\r\n    var widthOffset = 0;\r\n    var heightOffset = 0;\r\n    for (var i = 0; i < 2; ++i) {\r\n        var nextPoses = getNextPoses(widthOffset, heightOffset);\r\n        var _a = getSizeOffsetInfo(moveable, nextPoses, direction, keepRatio, isRequest, datas), widthOffsetInfo = _a.width, heightOffsetInfo = _a.height;\r\n        var isWidthBound = widthOffsetInfo.isBound;\r\n        var isHeightBound = heightOffsetInfo.isBound;\r\n        var nextWidthOffset = widthOffsetInfo.offset;\r\n        var nextHeightOffset = heightOffsetInfo.offset;\r\n        if (i === 1) {\r\n            if (!isWidthBound) {\r\n                nextWidthOffset = 0;\r\n            }\r\n            if (!isHeightBound) {\r\n                nextHeightOffset = 0;\r\n            }\r\n        }\r\n        if (i === 0 && isRequest && !isWidthBound && !isHeightBound) {\r\n            return [0, 0];\r\n        }\r\n        if (keepRatio) {\r\n            var widthDist = abs(nextWidthOffset) * (width ? 1 / width : 1);\r\n            var heightDist = abs(nextHeightOffset) * (height ? 1 / height : 1);\r\n            var isGetWidthOffset = isWidthBound && isHeightBound\r\n                ? widthDist < heightDist\r\n                : isHeightBound ||\r\n                    (!isWidthBound && widthDist < heightDist);\r\n            if (isGetWidthOffset) {\r\n                // width : height = ? : heightOffset\r\n                nextWidthOffset = (width * nextHeightOffset) / height;\r\n            }\r\n            else {\r\n                // width : height = widthOffset : ?\r\n                nextHeightOffset = (height * nextWidthOffset) / width;\r\n            }\r\n        }\r\n        widthOffset += nextWidthOffset;\r\n        heightOffset += nextHeightOffset;\r\n    }\r\n    if (!keepRatio && direction[0] && direction[1]) {\r\n        var _b = checkMaxBounds(moveable, poses, direction, fixedPosition, datas), maxWidth = _b.maxWidth, maxHeight = _b.maxHeight;\r\n        var _c = __read(recheckSizeByTwoDirection(moveable, getNextPoses(widthOffset, heightOffset).map(function (pos) { return pos.map(function (p) { return throttle(p, FLOAT_POINT_NUM); }); }), width + widthOffset, height + heightOffset, maxWidth, maxHeight, direction, isRequest, datas), 2), nextWidthOffset = _c[0], nextHeightOffset = _c[1];\r\n        widthOffset += nextWidthOffset;\r\n        heightOffset += nextHeightOffset;\r\n    }\r\n    return [widthOffset, heightOffset];\r\n}\r\nfunction absDegree(deg) {\r\n    if (deg < 0) {\r\n        deg = deg % 360 + 360;\r\n    }\r\n    deg %= 360;\r\n    return deg;\r\n}\r\nfunction bumpDegree(baseDeg, snapDeg) {\r\n    // baseDeg -80\r\n    // snapDeg 270\r\n    // return -90\r\n    snapDeg = absDegree(snapDeg);\r\n    var count = Math.floor(baseDeg / 360);\r\n    var deg1 = count * 360 + 360 - snapDeg;\r\n    var deg2 = count * 360 + snapDeg;\r\n    return abs(baseDeg - deg1) < abs(baseDeg - deg2) ? deg1 : deg2;\r\n}\r\nfunction getMinDegreeDistance(deg1, deg2) {\r\n    deg1 = absDegree(deg1);\r\n    deg2 = absDegree(deg2);\r\n    var deg3 = absDegree(deg1 - deg2);\r\n    return Math.min(deg3, 360 - deg3);\r\n}\r\nfunction checkSnapRotate(moveable, rect, dist, rotation) {\r\n    var _a;\r\n    var props = moveable.props;\r\n    var snapRotationThreshold = (_a = props[NAME_snapRotationThreshold]) !== null && _a !== void 0 ? _a : 5;\r\n    var snapRotationDegrees = props[NAME_snapRotationDegrees];\r\n    if (hasGuidelines(moveable, \"rotatable\")) {\r\n        var pos1 = rect.pos1, pos2 = rect.pos2, pos3 = rect.pos3, pos4 = rect.pos4, origin2_1 = rect.origin;\r\n        var rad_1 = (dist * Math.PI) / 180;\r\n        var prevPoses = [pos1, pos2, pos3, pos4].map(function (pos) { return minus(pos, origin2_1); });\r\n        var nextPoses = prevPoses.map(function (pos) { return rotate(pos, rad_1); });\r\n        // console.log(moveable.state.left, moveable.state.top, moveable.state.origin);\r\n        // console.log(pos1, pos2, pos3, pos4, origin, rad, prevPoses, nextPoses);\r\n        var result = __spreadArray(__spreadArray([], __read(checkRotateBounds(moveable, prevPoses, nextPoses, origin2_1, dist)), false), __read(checkRotateInnerBounds(moveable, prevPoses, nextPoses, origin2_1, dist)), false);\r\n        result.sort(function (a, b) { return abs(a - dist) - abs(b - dist); });\r\n        var isSnap = result.length > 0;\r\n        if (isSnap) {\r\n            return {\r\n                isSnap: isSnap,\r\n                dist: isSnap ? result[0] : dist,\r\n            };\r\n        }\r\n    }\r\n    if ((snapRotationDegrees === null || snapRotationDegrees === void 0 ? void 0 : snapRotationDegrees.length) && snapRotationThreshold) {\r\n        var sorted = snapRotationDegrees.slice().sort(function (a, b) {\r\n            return getMinDegreeDistance(a, rotation) - getMinDegreeDistance(b, rotation);\r\n        });\r\n        var firstDegree = sorted[0];\r\n        if (getMinDegreeDistance(firstDegree, rotation) <= snapRotationThreshold) {\r\n            return {\r\n                isSnap: true,\r\n                dist: dist + bumpDegree(rotation, firstDegree) - rotation,\r\n            };\r\n        }\r\n    }\r\n    return {\r\n        isSnap: false,\r\n        dist: dist,\r\n    };\r\n}\r\nfunction checkSnapResize(moveable, width, height, direction, fixedPosition, isRequest, datas) {\r\n    if (!hasGuidelines(moveable, \"resizable\")) {\r\n        return [0, 0];\r\n    }\r\n    var fixedDirection = datas.fixedDirection, nextAllMatrix = datas.nextAllMatrix;\r\n    var _a = moveable.state, allMatrix = _a.allMatrix, is3d = _a.is3d;\r\n    return checkSizeDist(moveable, function (widthOffset, heightOffset) {\r\n        return getNextFixedPoses(nextAllMatrix || allMatrix, width + widthOffset, height + heightOffset, fixedDirection, fixedPosition, is3d);\r\n    }, width, height, direction, fixedPosition, isRequest, datas);\r\n}\r\nfunction checkSnapScale(moveable, scale, direction, isRequest, datas) {\r\n    if (!hasGuidelines(moveable, \"scalable\")) {\r\n        return [0, 0];\r\n    }\r\n    var startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, fixedPosition = datas.fixedPosition, fixedDirection = datas.fixedDirection, is3d = datas.is3d;\r\n    var sizeDist = checkSizeDist(moveable, function (widthOffset, heightOffset) {\r\n        return getNextFixedPoses(scaleMatrix(datas, plus(scale, [widthOffset / startOffsetWidth, heightOffset / startOffsetHeight])), startOffsetWidth, startOffsetHeight, fixedDirection, fixedPosition, is3d);\r\n    }, startOffsetWidth, startOffsetHeight, direction, fixedPosition, isRequest, datas);\r\n    return [sizeDist[0] / startOffsetWidth, sizeDist[1] / startOffsetHeight];\r\n}\r\nfunction startCheckSnapDrag(moveable, datas) {\r\n    datas.absolutePoses = getAbsolutePosesByState(moveable.state);\r\n}\r\nfunction getSnapGuidelines(posInfos) {\r\n    var guidelines = [];\r\n    posInfos.forEach(function (posInfo) {\r\n        posInfo.guidelineInfos.forEach(function (_a) {\r\n            var guideline = _a.guideline;\r\n            if (find(guidelines, function (info) { return info.guideline === guideline; })) {\r\n                return;\r\n            }\r\n            guideline.direction = \"\";\r\n            guidelines.push({ guideline: guideline, posInfo: posInfo });\r\n        });\r\n    });\r\n    return guidelines.map(function (_a) {\r\n        var guideline = _a.guideline, posInfo = _a.posInfo;\r\n        return __assign(__assign({}, guideline), { direction: posInfo.direction });\r\n    });\r\n}\r\nfunction addBoundGuidelines(moveable, verticalPoses, horizontalPoses, verticalSnapPoses, horizontalSnapPoses, externalBounds) {\r\n    var _a = checkBoundPoses(getBounds(moveable, externalBounds), verticalPoses, horizontalPoses), verticalBoundInfos = _a.vertical, horizontalBoundInfos = _a.horizontal;\r\n    var boundMap = getInitialBounds();\r\n    verticalBoundInfos.forEach(function (info) {\r\n        if (info.isBound) {\r\n            if (info.direction === \"start\") {\r\n                boundMap.left = true;\r\n            }\r\n            if (info.direction === \"end\") {\r\n                boundMap.right = true;\r\n            }\r\n            verticalSnapPoses.push({\r\n                type: \"bounds\",\r\n                pos: info.pos,\r\n            });\r\n        }\r\n    });\r\n    horizontalBoundInfos.forEach(function (info) {\r\n        if (info.isBound) {\r\n            if (info.direction === \"start\") {\r\n                boundMap.top = true;\r\n            }\r\n            if (info.direction === \"end\") {\r\n                boundMap.bottom = true;\r\n            }\r\n            horizontalSnapPoses.push({\r\n                type: \"bounds\",\r\n                pos: info.pos,\r\n            });\r\n        }\r\n    });\r\n    var _b = checkInnerBoundPoses(moveable), innerBoundMap = _b.boundMap, verticalInnerBoundPoses = _b.vertical, horizontalInnerBoundPoses = _b.horizontal;\r\n    verticalInnerBoundPoses.forEach(function (innerPos) {\r\n        if (findIndex(verticalSnapPoses, function (_a) {\r\n            var type = _a.type, pos = _a.pos;\r\n            return type === \"bounds\" && pos === innerPos;\r\n        }) >= 0) {\r\n            return;\r\n        }\r\n        verticalSnapPoses.push({\r\n            type: \"bounds\",\r\n            pos: innerPos,\r\n        });\r\n    });\r\n    horizontalInnerBoundPoses.forEach(function (innerPos) {\r\n        if (findIndex(horizontalSnapPoses, function (_a) {\r\n            var type = _a.type, pos = _a.pos;\r\n            return type === \"bounds\" && pos === innerPos;\r\n        }) >= 0) {\r\n            return;\r\n        }\r\n        horizontalSnapPoses.push({\r\n            type: \"bounds\",\r\n            pos: innerPos,\r\n        });\r\n    });\r\n    return {\r\n        boundMap: boundMap,\r\n        innerBoundMap: innerBoundMap,\r\n    };\r\n}\r\nvar directionCondition$1 = getDirectionCondition(\"\", [\"resizable\", \"scalable\"]);\r\n/**\r\n * @namespace Moveable.Snappable\r\n * @description Whether or not target can be snapped to the guideline. (default: false)\r\n * @sort 2\r\n */\r\nvar Snappable = {\r\n    name: \"snappable\",\r\n    dragRelation: \"strong\",\r\n    props: [\r\n        \"snappable\",\r\n        \"snapContainer\",\r\n        \"snapDirections\",\r\n        \"elementSnapDirections\",\r\n        \"snapGap\",\r\n        \"snapGridWidth\",\r\n        \"snapGridHeight\",\r\n        \"isDisplaySnapDigit\",\r\n        \"isDisplayInnerSnapDigit\",\r\n        \"isDisplayGridGuidelines\",\r\n        \"snapDigit\",\r\n        \"snapThreshold\",\r\n        \"snapRenderThreshold\",\r\n        \"snapGridAll\",\r\n        NAME_snapRotationThreshold,\r\n        NAME_snapRotationDegrees,\r\n        NAME_snapHorizontalThreshold,\r\n        NAME_snapVerticalThreshold,\r\n        \"horizontalGuidelines\",\r\n        \"verticalGuidelines\",\r\n        \"elementGuidelines\",\r\n        \"bounds\",\r\n        \"innerBounds\",\r\n        \"snapDistFormat\",\r\n        \"maxSnapElementGuidelineDistance\",\r\n        \"maxSnapElementGapDistance\",\r\n    ],\r\n    events: [\"snap\", \"bound\"],\r\n    css: [\r\n        \":host {\\n--bounds-color: #d66;\\n}\\n.guideline {\\npointer-events: none;\\nz-index: 2;\\n}\\n.guideline.bounds {\\nbackground: #d66;\\nbackground: var(--bounds-color);\\n}\\n.guideline-group {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\n}\\n.guideline-group .size-value {\\nposition: absolute;\\ncolor: #f55;\\nfont-size: 12px;\\nfont-size: calc(12px * var(--zoom));\\nfont-weight: bold;\\n}\\n.guideline-group.horizontal .size-value {\\ntransform-origin: 50% 100%;\\ntransform: translateX(-50%);\\nleft: 50%;\\nbottom: 5px;\\nbottom: calc(2px + 3px * var(--zoom));\\n}\\n.guideline-group.vertical .size-value {\\ntransform-origin: 0% 50%;\\ntop: 50%;\\ntransform: translateY(-50%);\\nleft: 5px;\\nleft: calc(2px + 3px * var(--zoom));\\n}\\n.guideline.gap {\\nbackground: #f55;\\n}\\n.size-value.gap {\\ncolor: #f55;\\n}\\n\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var state = moveable.state;\r\n        var targetTop = state.top, targetLeft = state.left, pos1 = state.pos1, pos2 = state.pos2, pos3 = state.pos3, pos4 = state.pos4, snapRenderInfo = state.snapRenderInfo;\r\n        var _a = moveable.props.snapRenderThreshold, snapRenderThreshold = _a === void 0 ? 1 : _a;\r\n        if (!snapRenderInfo || !snapRenderInfo.render || !hasGuidelines(moveable, \"\")) {\r\n            // reset store\r\n            watchValue(moveable, \"boundMap\", getInitialBounds(), function (v) { return JSON.stringify(v); });\r\n            watchValue(moveable, \"innerBoundMap\", getInitialBounds(), function (v) { return JSON.stringify(v); });\r\n            return [];\r\n        }\r\n        state.guidelines = getTotalGuidelines(moveable);\r\n        var minLeft = Math.min(pos1[0], pos2[0], pos3[0], pos4[0]);\r\n        var minTop = Math.min(pos1[1], pos2[1], pos3[1], pos4[1]);\r\n        var externalPoses = snapRenderInfo.externalPoses || [];\r\n        var poses = getAbsolutePosesByState(moveable.state);\r\n        var verticalSnapPoses = [];\r\n        var horizontalSnapPoses = [];\r\n        var verticalGuidelines = [];\r\n        var horizontalGuidelines = [];\r\n        var snapInfos = [];\r\n        var _b = getRect(poses), width = _b.width, height = _b.height, top = _b.top, left = _b.left, bottom = _b.bottom, right = _b.right;\r\n        var targetRect = { left: left, right: right, top: top, bottom: bottom, center: (left + right) / 2, middle: (top + bottom) / 2 };\r\n        var hasExternalPoses = externalPoses.length > 0;\r\n        var externalRect = hasExternalPoses\r\n            ? getRect(externalPoses)\r\n            : {};\r\n        if (!snapRenderInfo.request) {\r\n            if (snapRenderInfo.direction) {\r\n                snapInfos.push(getSnapInfosByDirection(moveable, poses, snapRenderInfo.direction, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            if (snapRenderInfo.snap) {\r\n                var rect = getRect(poses);\r\n                if (snapRenderInfo.center) {\r\n                    rect.middle = (rect.top + rect.bottom) / 2;\r\n                    rect.center = (rect.left + rect.right) / 2;\r\n                }\r\n                snapInfos.push(checkSnaps(moveable, rect, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            if (hasExternalPoses) {\r\n                if (snapRenderInfo.center) {\r\n                    externalRect.middle =\r\n                        (externalRect.top + externalRect.bottom) / 2;\r\n                    externalRect.center =\r\n                        (externalRect.left + externalRect.right) / 2;\r\n                }\r\n                snapInfos.push(checkSnaps(moveable, externalRect, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            snapInfos.forEach(function (snapInfo) {\r\n                var verticalPosInfos = snapInfo.vertical.posInfos, horizontalPosInfos = snapInfo.horizontal.posInfos;\r\n                verticalSnapPoses.push.apply(verticalSnapPoses, __spreadArray([], __read(verticalPosInfos.filter(function (_a) {\r\n                    var guidelineInfos = _a.guidelineInfos;\r\n                    return guidelineInfos.some(function (_a) {\r\n                        var guideline = _a.guideline;\r\n                        return !guideline.hide;\r\n                    });\r\n                }).map(function (posInfo) { return ({\r\n                    type: \"snap\",\r\n                    pos: posInfo.pos,\r\n                }); })), false));\r\n                horizontalSnapPoses.push.apply(horizontalSnapPoses, __spreadArray([], __read(horizontalPosInfos.filter(function (_a) {\r\n                    var guidelineInfos = _a.guidelineInfos;\r\n                    return guidelineInfos.some(function (_a) {\r\n                        var guideline = _a.guideline;\r\n                        return !guideline.hide;\r\n                    });\r\n                }).map(function (posInfo) { return ({\r\n                    type: \"snap\",\r\n                    pos: posInfo.pos,\r\n                }); })), false));\r\n                verticalGuidelines.push.apply(verticalGuidelines, __spreadArray([], __read(getSnapGuidelines(verticalPosInfos)), false));\r\n                horizontalGuidelines.push.apply(horizontalGuidelines, __spreadArray([], __read(getSnapGuidelines(horizontalPosInfos)), false));\r\n            });\r\n        }\r\n        var _c = addBoundGuidelines(moveable, [left, right], [top, bottom], verticalSnapPoses, horizontalSnapPoses), boundMap = _c.boundMap, innerBoundMap = _c.innerBoundMap;\r\n        if (hasExternalPoses) {\r\n            addBoundGuidelines(moveable, [externalRect.left, externalRect.right], [externalRect.top, externalRect.bottom], verticalSnapPoses, horizontalSnapPoses, snapRenderInfo.externalBounds);\r\n        }\r\n        var allGuidelines = __spreadArray(__spreadArray([], __read(verticalGuidelines), false), __read(horizontalGuidelines), false);\r\n        var elementGuidelines = allGuidelines.filter(function (guideline) { return guideline.element && !guideline.gapRects; });\r\n        var gapGuidelines = allGuidelines.filter(function (guideline) { return guideline.gapRects; }).sort(function (a, b) {\r\n            return a.gap - b.gap;\r\n        });\r\n        triggerEvent(moveable, \"onSnap\", {\r\n            guidelines: allGuidelines.filter(function (_a) {\r\n                var element = _a.element;\r\n                return !element;\r\n            }),\r\n            elements: elementGuidelines,\r\n            gaps: gapGuidelines,\r\n        }, true);\r\n        var nextBoundMap = watchValue(moveable, \"boundMap\", boundMap, function (v) { return JSON.stringify(v); }, getInitialBounds());\r\n        var nextInnerBoundMap = watchValue(moveable, \"innerBoundMap\", innerBoundMap, function (v) { return JSON.stringify(v); }, getInitialBounds());\r\n        if (boundMap === nextBoundMap || innerBoundMap === nextInnerBoundMap) {\r\n            triggerEvent(moveable, \"onBound\", {\r\n                bounds: boundMap,\r\n                innerBounds: innerBoundMap,\r\n            }, true);\r\n        }\r\n        // verticalSnapPoses.\r\n        return __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(renderDashedGuidelines(moveable, elementGuidelines, [minLeft, minTop], targetRect, React)), false), __read(renderGapGuidelines(moveable, gapGuidelines, [minLeft, minTop], targetRect, React)), false), __read(renderGuidelines(moveable, \"horizontal\", horizontalGuidelines, [targetLeft, targetTop], targetRect, React)), false), __read(renderGuidelines(moveable, \"vertical\", verticalGuidelines, [targetLeft, targetTop], targetRect, React)), false), __read(renderSnapPoses(moveable, \"horizontal\", horizontalSnapPoses, minLeft, targetTop, width, 0, React)), false), __read(renderSnapPoses(moveable, \"vertical\", verticalSnapPoses, minTop, targetLeft, height, 1, React)), false);\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        moveable.state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            snap: true,\r\n            center: true,\r\n        };\r\n        checkSnapInfo(moveable);\r\n    },\r\n    drag: function (moveable) {\r\n        var state = moveable.state;\r\n        if (!checkSnapInfo(moveable)) {\r\n            state.guidelines = getTotalGuidelines(moveable);\r\n        }\r\n        if (state.snapRenderInfo) {\r\n            state.snapRenderInfo.render = true;\r\n        }\r\n    },\r\n    pinchStart: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (directionCondition$1(moveable, e) || dragControlCondition(moveable, e)) {\r\n            return true;\r\n        }\r\n        if (!e.isRequest && e.inputEvent) {\r\n            return hasClass(e.inputEvent.target, prefix(\"snap-control\"));\r\n        }\r\n    },\r\n    dragControlStart: function (moveable) {\r\n        moveable.state.snapRenderInfo = null;\r\n        checkSnapInfo(moveable);\r\n    },\r\n    dragControl: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragControlEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        this.dragStart(moveable, e);\r\n    },\r\n    dragGroup: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragGroupEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragGroupControlStart: function (moveable) {\r\n        moveable.state.snapRenderInfo = null;\r\n        checkSnapInfo(moveable);\r\n    },\r\n    dragGroupControl: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragGroupControlEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    unset: function (moveable) {\r\n        var state = moveable.state;\r\n        state.enableSnap = false;\r\n        state.guidelines = [];\r\n        state.snapRenderInfo = null;\r\n        state.elementRects = [];\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be snapped to the guideline. (default: false)\r\n * @name Moveable.Snappable#snappable\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snappable = true;\r\n */\r\n/**\r\n *  A snap container that is the basis for snap, bounds, and innerBounds. (default: null = container)\r\n * @name Moveable.Snappable#snapContainer\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.querySelector(\".container\"));\r\n *\r\n * moveable.snapContainer = document.body;\r\n */\r\n/**\r\n * You can specify the directions to snap to the target. (default: { left: true, top: true, right: true, bottom: true })\r\n * @name Moveable.Snappable#snapDirections\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   snapDirections: true,\r\n * });\r\n * // snap center\r\n * moveable.snapDirections = { left: true, top: true, right: true, bottom: true, center: true, middle: true };\r\n */\r\n/**\r\n * You can specify the snap directions of elements. (default: { left: true, ftrue, right: true, bottom: true })\r\n * @name Moveable.Snappable#elementSnapDirections\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   elementSnapDirections: true,\r\n * });\r\n * // snap center\r\n * moveable.elementSnapDirections = { left: true, top: true, right: true, bottom: true, center: true, middle: true };\r\n */\r\n/**\r\n * When you drag, make the gap snap in the element guidelines. (default: true)\r\n * @name Moveable.Snappable#snapGap\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   snapElement: true,\r\n *   snapGap: true,\r\n * });\r\n *\r\n * moveable.snapGap = false;\r\n */\r\n/**\r\n * Distance value that can snap to guidelines. (default: 5)\r\n * @name Moveable.Snappable#snapThreshold\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapThreshold = 5;\r\n */\r\n/**\r\n * Add guidelines in the horizontal direction. (default: [])\r\n * @name Moveable.Snappable#horizontalGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.horizontalGuidelines = [100, 200, 500];\r\n */\r\n/**\r\n * Add guidelines in the vertical direction. (default: [])\r\n * @name Moveable.Snappable#verticalGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.verticalGuidelines = [100, 200, 500];\r\n */\r\n/**\r\n * Add guidelines for the element. (default: [])\r\n * @name Moveable.Snappable#elementGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.elementGuidelines = [\r\n *   document.querySelector(\".element\"),\r\n * ];\r\n */\r\n/**\r\n * You can set up boundaries.\r\n * @name Moveable.Snappable#bounds\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.bounds = { left: 0, right: 1000, top: 0, bottom: 1000};\r\n */\r\n/**\r\n * You can set up inner boundaries.\r\n * @name Moveable.Snappable#innerBounds\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.innerBounds = { left: 500, top: 500, width: 100, height: 100};\r\n */\r\n/**\r\n * snap distance digits (default: 0)\r\n * @name Moveable.Snappable#snapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapDigit = 0\r\n */\r\n/**\r\n * If width size is greater than 0, you can vertical snap to the grid. (default: 0)\r\n * @name Moveable.Snappable#snapGridWidth\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapGridWidth = 5;\r\n */\r\n/**\r\n * If height size is greater than 0, you can horizontal snap to the grid. (default: 0)\r\n * @name Moveable.Snappable#snapGridHeight\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapGridHeight = 5;\r\n */\r\n/**\r\n * Whether to show snap distance (default: true)\r\n * @name Moveable.Snappable#isDisplaySnapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.isDisplaySnapDigit = true;\r\n */\r\n/**\r\n * Whether to show element inner snap distance (default: false)\r\n * @name Moveable.Snappable#isDisplayInnerSnapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.isDisplayInnerSnapDigit = true;\r\n */\r\n/**\r\n * You can set the text format of the distance shown in the guidelines. (default: self)\r\n * @name Moveable.Snappable#snapDistFormat\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  snappable: true,\r\n *  snapDistFormat: (v, type) => v,\r\n * });\r\n * moveable.snapDistFormat = (v, type) => `${v}px`;\r\n */\r\n/**\r\n * When you drag or dragControl, the `snap` event is called.\r\n * @memberof Moveable.Snappable\r\n * @event snap\r\n * @param {Moveable.Snappable.OnSnap} - Parameters for the `snap` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     snappable: true\r\n * });\r\n * moveable.on(\"snap\", e => {\r\n *     console.log(\"onSnap\", e);\r\n * });\r\n */\n\nfunction multiply2(pos1, pos2) {\r\n    return [\r\n        pos1[0] * pos2[0],\r\n        pos1[1] * pos2[1],\r\n    ];\r\n}\r\nfunction prefix() {\r\n    var classNames = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        classNames[_i] = arguments[_i];\r\n    }\r\n    return prefixNames.apply(void 0, __spreadArray([PREFIX], __read(classNames), false));\r\n}\r\nfunction defaultSync(fn) {\r\n    fn();\r\n}\r\nfunction getTransformMatrix(transform) {\r\n    if (!transform || transform === \"none\") {\r\n        return [1, 0, 0, 1, 0, 0];\r\n    }\r\n    if (isObject(transform)) {\r\n        return transform;\r\n    }\r\n    return parseMat(transform);\r\n}\r\nfunction getAbsoluteMatrix(matrix, n, origin) {\r\n    return multiplies(n, createOriginMatrix(origin, n), matrix, createOriginMatrix(origin.map(function (a) { return -a; }), n));\r\n}\r\nfunction measureSVGSize(el, unit, isHorizontal) {\r\n    if (unit === \"%\") {\r\n        var viewBox = getSVGViewBox(el.ownerSVGElement);\r\n        return viewBox[isHorizontal ? \"width\" : \"height\"] / 100;\r\n    }\r\n    return 1;\r\n}\r\nfunction getBeforeTransformOrigin(el) {\r\n    var relativeOrigin = getTransformOrigin(getComputedStyle(el, \":before\"));\r\n    return relativeOrigin.map(function (o, i) {\r\n        var _a = splitUnit(o), value = _a.value, unit = _a.unit;\r\n        return value * measureSVGSize(el, unit, i === 0);\r\n    });\r\n}\r\nfunction getTransformOriginArray(transformOrigin) {\r\n    return transformOrigin ? transformOrigin.split(\" \") : [\"0\", \"0\"];\r\n}\r\nfunction getTransformOrigin(style) {\r\n    return getTransformOriginArray(style.transformOrigin);\r\n}\r\nfunction getElementTransform(target) {\r\n    var getStyle = getCachedStyle(target);\r\n    var computedTransform = getStyle(\"transform\");\r\n    if (computedTransform && computedTransform !== \"none\") {\r\n        return computedTransform;\r\n    }\r\n    if (\"transform\" in target) {\r\n        var list = target.transform;\r\n        var baseVal = list.baseVal;\r\n        if (!baseVal) {\r\n            return \"\";\r\n        }\r\n        var length_1 = baseVal.length;\r\n        if (!length_1) {\r\n            return \"\";\r\n        }\r\n        var matrixes = [];\r\n        var _loop_1 = function (i) {\r\n            var matrix = baseVal[i].matrix;\r\n            matrixes.push(\"matrix(\".concat([\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"].map(function (chr) { return matrix[chr]; }).join(\", \"), \")\"));\r\n        };\r\n        for (var i = 0; i < length_1; ++i) {\r\n            _loop_1(i);\r\n        }\r\n        return matrixes.join(\" \");\r\n    }\r\n    return \"\";\r\n}\r\nfunction getOffsetInfo(el, lastParent, isParent, checkZoom, getTargetStyle) {\r\n    var _a, _b;\r\n    var documentElement = getDocumentElement(el) || getDocumentBody(el);\r\n    var hasSlot = false;\r\n    var target;\r\n    var parentSlotElement;\r\n    if (!el || isParent) {\r\n        target = el;\r\n    }\r\n    else {\r\n        var assignedSlotParentElement = (_a = el === null || el === void 0 ? void 0 : el.assignedSlot) === null || _a === void 0 ? void 0 : _a.parentElement;\r\n        var parentElement = el.parentElement;\r\n        if (assignedSlotParentElement) {\r\n            hasSlot = true;\r\n            parentSlotElement = parentElement;\r\n            target = assignedSlotParentElement;\r\n        }\r\n        else {\r\n            target = parentElement;\r\n        }\r\n    }\r\n    var isCustomElement = false;\r\n    var isEnd = el === lastParent || target === lastParent;\r\n    var position = \"relative\";\r\n    var offsetZoom = 1;\r\n    var targetZoom = parseFloat(getTargetStyle === null || getTargetStyle === void 0 ? void 0 : getTargetStyle(\"zoom\")) || 1;\r\n    var targetPosition = getTargetStyle === null || getTargetStyle === void 0 ? void 0 : getTargetStyle(\"position\");\r\n    while (target && target !== documentElement) {\r\n        if (lastParent === target) {\r\n            isEnd = true;\r\n        }\r\n        var getStyle = getCachedStyle(target);\r\n        var tagName = target.tagName.toLowerCase();\r\n        var transform = getElementTransform(target);\r\n        var willChange = getStyle(\"willChange\");\r\n        var zoom = parseFloat(getStyle(\"zoom\")) || 1;\r\n        position = getStyle(\"position\");\r\n        if (checkZoom && zoom !== 1) {\r\n            offsetZoom = zoom;\r\n            break;\r\n        }\r\n        if (\r\n        // offsetParent is the parentElement if the target's zoom is not 1 and not absolute.\r\n        !isParent && checkZoom && targetZoom !== 1 && targetPosition && targetPosition !== \"absolute\"\r\n            || tagName === \"svg\"\r\n            || tagName === \"foreignobject\"\r\n            || position !== \"static\"\r\n            || (transform && transform !== \"none\")\r\n            || willChange === \"transform\") {\r\n            break;\r\n        }\r\n        var slotParentNode = (_b = el === null || el === void 0 ? void 0 : el.assignedSlot) === null || _b === void 0 ? void 0 : _b.parentNode;\r\n        var targetParentNode = target.parentNode;\r\n        if (slotParentNode) {\r\n            hasSlot = true;\r\n            parentSlotElement = targetParentNode;\r\n        }\r\n        var parentNode = targetParentNode;\r\n        if (parentNode && parentNode.nodeType === 11) {\r\n            // Shadow Root\r\n            target = parentNode.host;\r\n            isCustomElement = true;\r\n            position = getCachedStyle(target)(\"position\");\r\n            break;\r\n        }\r\n        target = parentNode;\r\n        position = \"relative\";\r\n    }\r\n    return {\r\n        offsetZoom: offsetZoom,\r\n        hasSlot: hasSlot,\r\n        parentSlotElement: parentSlotElement,\r\n        isCustomElement: isCustomElement,\r\n        isStatic: position === \"static\",\r\n        isEnd: isEnd || !target || target === documentElement,\r\n        offsetParent: target || documentElement,\r\n    };\r\n}\r\nfunction getOffsetPosInfo(el, target) {\r\n    var _a;\r\n    var tagName = el.tagName.toLowerCase();\r\n    var offsetLeft = el.offsetLeft;\r\n    var offsetTop = el.offsetTop;\r\n    var getStyle = getCachedStyle(el);\r\n    // svg\r\n    var isSVG = isUndefined(offsetLeft);\r\n    var hasOffset = !isSVG;\r\n    var origin;\r\n    var targetOrigin;\r\n    // inner svg element\r\n    if (!hasOffset && (tagName !== \"svg\" || el.ownerSVGElement)) {\r\n        origin = IS_WEBKIT605\r\n            ? getBeforeTransformOrigin(el)\r\n            : getTransformOriginArray(getStyle(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); });\r\n        targetOrigin = origin.slice();\r\n        hasOffset = true;\r\n        if (tagName === \"svg\") {\r\n            offsetLeft = 0;\r\n            offsetTop = 0;\r\n        }\r\n        else {\r\n            _a = __read(getSVGGraphicsOffset(el, origin, el === target && target.tagName.toLowerCase() === \"g\"), 4), offsetLeft = _a[0], offsetTop = _a[1], origin[0] = _a[2], origin[1] = _a[3];\r\n        }\r\n    }\r\n    else {\r\n        origin = getTransformOriginArray(getStyle(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); });\r\n        targetOrigin = origin.slice();\r\n        // console.log(getStyle(\"transformOrigin\"), targetOrigin);\r\n    }\r\n    return {\r\n        tagName: tagName,\r\n        isSVG: isSVG,\r\n        hasOffset: hasOffset,\r\n        offset: [offsetLeft || 0, offsetTop || 0],\r\n        origin: origin,\r\n        targetOrigin: targetOrigin,\r\n    };\r\n}\r\nfunction getBodyOffset(el, isSVG) {\r\n    var getStyle = getCachedStyle(el);\r\n    var getBodyStyle = getCachedStyle(getDocumentBody(el));\r\n    var bodyPosition = getBodyStyle(\"position\");\r\n    if (!isSVG && (!bodyPosition || bodyPosition === \"static\")) {\r\n        return [0, 0];\r\n    }\r\n    var marginLeft = parseInt(getBodyStyle(\"marginLeft\"), 10);\r\n    var marginTop = parseInt(getBodyStyle(\"marginTop\"), 10);\r\n    if (getStyle(\"position\") === \"absolute\") {\r\n        if (getStyle(\"top\") !== \"auto\" || getStyle(\"bottom\") !== \"auto\") {\r\n            marginTop = 0;\r\n        }\r\n        if (getStyle(\"left\") !== \"auto\" || getStyle(\"right\") !== \"auto\") {\r\n            marginLeft = 0;\r\n        }\r\n    }\r\n    return [marginLeft, marginTop];\r\n}\r\nfunction convert3DMatrixes(matrixes) {\r\n    matrixes.forEach(function (info) {\r\n        var matrix = info.matrix;\r\n        if (matrix) {\r\n            info.matrix = convertDimension(matrix, 3, 4);\r\n        }\r\n    });\r\n}\r\nfunction getPositionFixedInfo(el) {\r\n    var fixedContainer = el.parentElement;\r\n    var hasTransform = false;\r\n    var body = getDocumentBody(el);\r\n    while (fixedContainer) {\r\n        var transform = getComputedStyle(fixedContainer).transform;\r\n        if (transform && transform !== \"none\") {\r\n            hasTransform = true;\r\n            break;\r\n        }\r\n        if (fixedContainer === body) {\r\n            break;\r\n        }\r\n        fixedContainer = fixedContainer.parentElement;\r\n    }\r\n    return {\r\n        fixedContainer: fixedContainer || body,\r\n        hasTransform: hasTransform,\r\n    };\r\n}\r\nfunction makeMatrixCSS(matrix, is3d) {\r\n    if (is3d === void 0) { is3d = matrix.length > 9; }\r\n    return \"\".concat(is3d ? \"matrix3d\" : \"matrix\", \"(\").concat(convertMatrixtoCSS(matrix, !is3d).join(\",\"), \")\");\r\n}\r\nfunction getSVGViewBox(el) {\r\n    var clientWidth = el.clientWidth;\r\n    var clientHeight = el.clientHeight;\r\n    if (!el) {\r\n        return { x: 0, y: 0, width: 0, height: 0, clientWidth: clientWidth, clientHeight: clientHeight };\r\n    }\r\n    var viewBox = el.viewBox;\r\n    var baseVal = (viewBox && viewBox.baseVal) || { x: 0, y: 0, width: 0, height: 0 };\r\n    return {\r\n        x: baseVal.x,\r\n        y: baseVal.y,\r\n        width: baseVal.width || clientWidth,\r\n        height: baseVal.height || clientHeight,\r\n        clientWidth: clientWidth,\r\n        clientHeight: clientHeight,\r\n    };\r\n}\r\nfunction getSVGMatrix(el, n) {\r\n    var _a;\r\n    var _b = getSVGViewBox(el), viewBoxWidth = _b.width, viewBoxHeight = _b.height, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\r\n    var scaleX = clientWidth / viewBoxWidth;\r\n    var scaleY = clientHeight / viewBoxHeight;\r\n    var preserveAspectRatio = el.preserveAspectRatio.baseVal;\r\n    // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/preserveAspectRatio\r\n    var align = preserveAspectRatio.align;\r\n    // 1 : meet 2: slice\r\n    var meetOrSlice = preserveAspectRatio.meetOrSlice;\r\n    var svgOrigin = [0, 0];\r\n    var scale = [scaleX, scaleY];\r\n    var translate = [0, 0];\r\n    if (align !== 1) {\r\n        var xAlign = (align - 2) % 3;\r\n        var yAlign = Math.floor((align - 2) / 3);\r\n        svgOrigin[0] = viewBoxWidth * xAlign / 2;\r\n        svgOrigin[1] = viewBoxHeight * yAlign / 2;\r\n        var scaleDimension = meetOrSlice === 2 ? Math.max(scaleY, scaleX) : Math.min(scaleX, scaleY);\r\n        scale[0] = scaleDimension;\r\n        scale[1] = scaleDimension;\r\n        translate[0] = (clientWidth - viewBoxWidth) / 2 * xAlign;\r\n        translate[1] = (clientHeight - viewBoxHeight) / 2 * yAlign;\r\n    }\r\n    var scaleMatrix = createScaleMatrix(scale, n);\r\n    _a = __read(translate, 2), scaleMatrix[n * (n - 1)] = _a[0], scaleMatrix[n * (n - 1) + 1] = _a[1];\r\n    return getAbsoluteMatrix(scaleMatrix, n, svgOrigin);\r\n}\r\nfunction getSVGGraphicsOffset(el, origin, isGTarget) {\r\n    var tagName = el.tagName.toLowerCase();\r\n    if (!el.getBBox || !isGTarget && tagName === \"g\") {\r\n        return [0, 0, 0, 0];\r\n    }\r\n    var getStyle = getCachedStyle(el);\r\n    var isFillBox = getStyle(\"transform-box\") === \"fill-box\";\r\n    var bbox = el.getBBox();\r\n    var viewBox = getSVGViewBox(el.ownerSVGElement);\r\n    var x = bbox.x;\r\n    var y = bbox.y;\r\n    // x, y 0  \r\n    if (tagName === \"foreignobject\" && (!x && !y)) {\r\n        x = parseFloat(el.getAttribute(\"x\")) || 0;\r\n        y = parseFloat(el.getAttribute(\"y\")) || 0;\r\n    }\r\n    var left = x - viewBox.x;\r\n    var top = y - viewBox.y;\r\n    var originX = isFillBox ? origin[0] : origin[0] - left;\r\n    var originY = isFillBox ? origin[1] : origin[1] - top;\r\n    // if (isFillBox) {\r\n    //     const bbox = (el as SVGGraphicsElement).getBBox();\r\n    //     const x = parseFloat(getStyle(\"x\")) || bbox.x;\r\n    //     const y = parseFloat(getStyle(\"y\")) || bbox.y;\r\n    //     const xScale = bbox.x / x;\r\n    //     const yScale = bbox.y / y;\r\n    //     console.log(x, y);\r\n    //     originX *= xScale;\r\n    //     originY *= yScale;\r\n    // }\r\n    return [left, top, originX, originY];\r\n}\r\nfunction calculatePosition(matrix, pos, n) {\r\n    return calculate(matrix, convertPositionMatrix(pos, n), n);\r\n}\r\nfunction calculatePoses(matrix, width, height, n) {\r\n    return [[0, 0], [width, 0], [0, height], [width, height]].map(function (pos) { return calculatePosition(matrix, pos, n); });\r\n}\r\nfunction getRect(poses) {\r\n    var posesX = poses.map(function (pos) { return pos[0]; });\r\n    var posesY = poses.map(function (pos) { return pos[1]; });\r\n    var left = Math.min.apply(Math, __spreadArray([], __read(posesX), false));\r\n    var top = Math.min.apply(Math, __spreadArray([], __read(posesY), false));\r\n    var right = Math.max.apply(Math, __spreadArray([], __read(posesX), false));\r\n    var bottom = Math.max.apply(Math, __spreadArray([], __read(posesY), false));\r\n    var rectWidth = right - left;\r\n    var rectHeight = bottom - top;\r\n    return {\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n        width: rectWidth,\r\n        height: rectHeight,\r\n    };\r\n}\r\nfunction calculateRect(matrix, width, height, n) {\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    return getRect(poses);\r\n}\r\nfunction getSVGOffset(offsetInfo, targetInfo, container, n, beforeMatrix) {\r\n    var _a;\r\n    var target = offsetInfo.target;\r\n    var origin = offsetInfo.origin;\r\n    var targetMatrix = targetInfo.matrix;\r\n    var _b = getSize(target), width = _b.offsetWidth, height = _b.offsetHeight;\r\n    var containerClientRect = container.getBoundingClientRect();\r\n    var margin = [0, 0];\r\n    if (container === getDocumentBody(container)) {\r\n        margin = getBodyOffset(target, true);\r\n    }\r\n    var rect = target.getBoundingClientRect();\r\n    var rectLeft = rect.left - containerClientRect.left + container.scrollLeft\r\n        - (container.clientLeft || 0) + margin[0];\r\n    var rectTop = rect.top - containerClientRect.top + container.scrollTop\r\n        - (container.clientTop || 0) + margin[1];\r\n    var rectWidth = rect.width;\r\n    var rectHeight = rect.height;\r\n    var mat = multiplies(n, beforeMatrix, targetMatrix);\r\n    var _c = calculateRect(mat, width, height, n), prevLeft = _c.left, prevTop = _c.top, prevWidth = _c.width, prevHeight = _c.height;\r\n    var posOrigin = calculatePosition(mat, origin, n);\r\n    var prevOrigin = minus(posOrigin, [prevLeft, prevTop]);\r\n    var rectOrigin = [\r\n        rectLeft + prevOrigin[0] * rectWidth / prevWidth,\r\n        rectTop + prevOrigin[1] * rectHeight / prevHeight,\r\n    ];\r\n    var offset = [0, 0];\r\n    var count = 0;\r\n    while (++count < 10) {\r\n        var inverseBeforeMatrix = invert(beforeMatrix, n);\r\n        _a = __read(minus(calculatePosition(inverseBeforeMatrix, rectOrigin, n), calculatePosition(inverseBeforeMatrix, posOrigin, n)), 2), offset[0] = _a[0], offset[1] = _a[1];\r\n        var mat2 = multiplies(n, beforeMatrix, createOriginMatrix(offset, n), targetMatrix);\r\n        var _d = calculateRect(mat2, width, height, n), nextLeft = _d.left, nextTop = _d.top;\r\n        var distLeft = nextLeft - rectLeft;\r\n        var distTop = nextTop - rectTop;\r\n        if (abs(distLeft) < 2 && abs(distTop) < 2) {\r\n            break;\r\n        }\r\n        rectOrigin[0] -= distLeft;\r\n        rectOrigin[1] -= distTop;\r\n    }\r\n    return offset.map(function (p) { return Math.round(p); });\r\n}\r\nfunction calculateMoveableClientPositions(rootMatrix, poses, rootClientRect) {\r\n    var is3d = rootMatrix.length === 16;\r\n    var n = is3d ? 4 : 3;\r\n    var rootPoses = poses.map(function (pos) { return calculatePosition(rootMatrix, pos, n); });\r\n    var left = rootClientRect.left, top = rootClientRect.top;\r\n    return rootPoses.map(function (pos) {\r\n        return [pos[0] + left, pos[1] + top];\r\n    });\r\n}\r\nfunction getDistSize(vec) {\r\n    return Math.sqrt(vec[0] * vec[0] + vec[1] * vec[1]);\r\n}\r\nfunction getDiagonalSize(pos1, pos2) {\r\n    return getDistSize([\r\n        pos2[0] - pos1[0],\r\n        pos2[1] - pos1[1],\r\n    ]);\r\n}\r\nfunction getLineStyle(pos1, pos2, zoom, rad) {\r\n    if (zoom === void 0) { zoom = 1; }\r\n    if (rad === void 0) { rad = getRad(pos1, pos2); }\r\n    var width = getDiagonalSize(pos1, pos2);\r\n    return {\r\n        transform: \"translateY(-50%) translate(\".concat(pos1[0], \"px, \").concat(pos1[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n        width: \"\".concat(width, \"px\"),\r\n    };\r\n}\r\nfunction getControlTransform(rotation, zoom) {\r\n    var poses = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        poses[_i - 2] = arguments[_i];\r\n    }\r\n    var length = poses.length;\r\n    var x = poses.reduce(function (prev, pos) { return prev + pos[0]; }, 0) / length;\r\n    var y = poses.reduce(function (prev, pos) { return prev + pos[1]; }, 0) / length;\r\n    return {\r\n        transform: \"translateZ(0px) translate(\".concat(x, \"px, \").concat(y, \"px) rotate(\").concat(rotation, \"rad) scale(\").concat(zoom, \")\"),\r\n    };\r\n}\r\nfunction getProps(props, ableName) {\r\n    var self = props[ableName];\r\n    if (isObject(self)) {\r\n        return __assign(__assign({}, props), self);\r\n    }\r\n    return props;\r\n}\r\nfunction getSize(target) {\r\n    var hasOffset = target && !isUndefined(target.offsetWidth);\r\n    var offsetWidth = 0;\r\n    var offsetHeight = 0;\r\n    var clientWidth = 0;\r\n    var clientHeight = 0;\r\n    var cssWidth = 0;\r\n    var cssHeight = 0;\r\n    var contentWidth = 0;\r\n    var contentHeight = 0;\r\n    var minWidth = 0;\r\n    var minHeight = 0;\r\n    var minOffsetWidth = 0;\r\n    var minOffsetHeight = 0;\r\n    var maxWidth = Infinity;\r\n    var maxHeight = Infinity;\r\n    var maxOffsetWidth = Infinity;\r\n    var maxOffsetHeight = Infinity;\r\n    var inlineCSSWidth = 0;\r\n    var inlineCSSHeight = 0;\r\n    var svg = false;\r\n    if (target) {\r\n        if (!hasOffset && target.ownerSVGElement) {\r\n            // check svg elements\r\n            var bbox = target.getBBox();\r\n            svg = true;\r\n            offsetWidth = bbox.width;\r\n            offsetHeight = bbox.height;\r\n            cssWidth = offsetWidth;\r\n            cssHeight = offsetHeight;\r\n            contentWidth = offsetWidth;\r\n            contentHeight = offsetHeight;\r\n            clientWidth = offsetWidth;\r\n            clientHeight = offsetHeight;\r\n        }\r\n        else {\r\n            // check html elements\r\n            var getStyle = getCachedStyle(target);\r\n            var targetStyle = target.style;\r\n            var boxSizing = getStyle(\"boxSizing\") === \"border-box\";\r\n            var borderLeft = parseFloat(getStyle(\"borderLeftWidth\")) || 0;\r\n            var borderRight = parseFloat(getStyle(\"borderRightWidth\")) || 0;\r\n            var borderTop = parseFloat(getStyle(\"borderTopWidth\")) || 0;\r\n            var borderBottom = parseFloat(getStyle(\"borderBottomWidth\")) || 0;\r\n            var paddingLeft = parseFloat(getStyle(\"paddingLeft\")) || 0;\r\n            var paddingRight = parseFloat(getStyle(\"paddingRight\")) || 0;\r\n            var paddingTop = parseFloat(getStyle(\"paddingTop\")) || 0;\r\n            var paddingBottom = parseFloat(getStyle(\"paddingBottom\")) || 0;\r\n            var horizontalPadding = paddingLeft + paddingRight;\r\n            var verticalPadding = paddingTop + paddingBottom;\r\n            var horizontalBorder = borderLeft + borderRight;\r\n            var verticalBorder = borderTop + borderBottom;\r\n            var horizontalOffset = horizontalPadding + horizontalBorder;\r\n            var verticalOffset = verticalPadding + verticalBorder;\r\n            var position = getStyle(\"position\");\r\n            var containerWidth = 0;\r\n            var containerHeight = 0;\r\n            // SVGSVGElement, HTMLElement\r\n            if (\"clientLeft\" in target) {\r\n                var parentElement = null;\r\n                if (position === \"absolute\") {\r\n                    var offsetInfo = getOffsetInfo(target, getDocumentBody(target));\r\n                    parentElement = offsetInfo.offsetParent;\r\n                }\r\n                else {\r\n                    parentElement = target.parentElement;\r\n                }\r\n                if (parentElement) {\r\n                    var getParentStyle = getCachedStyle(parentElement);\r\n                    containerWidth = parseFloat(getParentStyle(\"width\"));\r\n                    containerHeight = parseFloat(getParentStyle(\"height\"));\r\n                }\r\n            }\r\n            minWidth = Math.max(horizontalPadding, convertUnitSize(getStyle(\"minWidth\"), containerWidth) || 0);\r\n            minHeight = Math.max(verticalPadding, convertUnitSize(getStyle(\"minHeight\"), containerHeight) || 0);\r\n            maxWidth = convertUnitSize(getStyle(\"maxWidth\"), containerWidth);\r\n            maxHeight = convertUnitSize(getStyle(\"maxHeight\"), containerHeight);\r\n            if (isNaN(maxWidth)) {\r\n                maxWidth = Infinity;\r\n            }\r\n            if (isNaN(maxHeight)) {\r\n                maxHeight = Infinity;\r\n            }\r\n            inlineCSSWidth = convertUnitSize(targetStyle.width, 0) || 0;\r\n            inlineCSSHeight = convertUnitSize(targetStyle.height, 0) || 0;\r\n            cssWidth = parseFloat(getStyle(\"width\")) || 0;\r\n            cssHeight = parseFloat(getStyle(\"height\")) || 0;\r\n            contentWidth = abs(cssWidth - inlineCSSWidth) < 1\r\n                ? between(minWidth, inlineCSSWidth || cssWidth, maxWidth)\r\n                : cssWidth;\r\n            contentHeight = abs(cssHeight - inlineCSSHeight) < 1\r\n                ? between(minHeight, inlineCSSHeight || cssHeight, maxHeight)\r\n                : cssHeight;\r\n            offsetWidth = contentWidth;\r\n            offsetHeight = contentHeight;\r\n            clientWidth = contentWidth;\r\n            clientHeight = contentHeight;\r\n            if (boxSizing) {\r\n                maxOffsetWidth = maxWidth;\r\n                maxOffsetHeight = maxHeight;\r\n                minOffsetWidth = minWidth;\r\n                minOffsetHeight = minHeight;\r\n                contentWidth = offsetWidth - horizontalOffset;\r\n                contentHeight = offsetHeight - verticalOffset;\r\n            }\r\n            else {\r\n                maxOffsetWidth = maxWidth + horizontalOffset;\r\n                maxOffsetHeight = maxHeight + verticalOffset;\r\n                minOffsetWidth = minWidth + horizontalOffset;\r\n                minOffsetHeight = minHeight + verticalOffset;\r\n                offsetWidth = contentWidth + horizontalOffset;\r\n                offsetHeight = contentHeight + verticalOffset;\r\n            }\r\n            clientWidth = contentWidth + horizontalPadding;\r\n            clientHeight = contentHeight + verticalPadding;\r\n        }\r\n    }\r\n    return {\r\n        svg: svg,\r\n        offsetWidth: offsetWidth,\r\n        offsetHeight: offsetHeight,\r\n        clientWidth: clientWidth,\r\n        clientHeight: clientHeight,\r\n        contentWidth: contentWidth,\r\n        contentHeight: contentHeight,\r\n        inlineCSSWidth: inlineCSSWidth,\r\n        inlineCSSHeight: inlineCSSHeight,\r\n        cssWidth: cssWidth,\r\n        cssHeight: cssHeight,\r\n        minWidth: minWidth,\r\n        minHeight: minHeight,\r\n        maxWidth: maxWidth,\r\n        maxHeight: maxHeight,\r\n        minOffsetWidth: minOffsetWidth,\r\n        minOffsetHeight: minOffsetHeight,\r\n        maxOffsetWidth: maxOffsetWidth,\r\n        maxOffsetHeight: maxOffsetHeight,\r\n    };\r\n}\r\nfunction getRotationRad(poses, direction) {\r\n    return getRad(direction > 0 ? poses[0] : poses[1], direction > 0 ? poses[1] : poses[0]);\r\n}\r\nfunction resetClientRect() {\r\n    return {\r\n        left: 0, top: 0,\r\n        width: 0, height: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        clientLeft: 0, clientTop: 0,\r\n        clientWidth: 0, clientHeight: 0,\r\n        scrollWidth: 0, scrollHeight: 0,\r\n    };\r\n}\r\nfunction getExtendsRect(el, rect) {\r\n    var isRoot = el === getDocumentBody(el) || el === getDocumentElement(el);\r\n    var extendsRect = {\r\n        clientLeft: el.clientLeft,\r\n        clientTop: el.clientTop,\r\n        clientWidth: el.clientWidth,\r\n        clientHeight: el.clientHeight,\r\n        scrollWidth: el.scrollWidth,\r\n        scrollHeight: el.scrollHeight,\r\n        overflow: false,\r\n    };\r\n    if (isRoot) {\r\n        extendsRect.clientHeight = Math.max(rect.height, extendsRect.clientHeight);\r\n        extendsRect.scrollHeight = Math.max(rect.height, extendsRect.scrollHeight);\r\n    }\r\n    extendsRect.overflow = getCachedStyle(el)(\"overflow\") !== \"visible\";\r\n    return __assign(__assign({}, rect), extendsRect);\r\n}\r\nfunction getClientRectByPosition(position, base, el, isExtends) {\r\n    var left = position.left, right = position.right, top = position.top, bottom = position.bottom;\r\n    var baseTop = base.top;\r\n    var baseLeft = base.left;\r\n    var rect = {\r\n        left: baseLeft + left,\r\n        top: baseTop + top,\r\n        right: baseLeft + right,\r\n        bottom: baseTop + bottom,\r\n        width: right - left,\r\n        height: bottom - top,\r\n    };\r\n    if (el && isExtends) {\r\n        return getExtendsRect(el, rect);\r\n    }\r\n    return rect;\r\n}\r\nfunction getClientRect(el, isExtends) {\r\n    var left = 0;\r\n    var top = 0;\r\n    var width = 0;\r\n    var height = 0;\r\n    // let isRoot = false;\r\n    if (el) {\r\n        var clientRect = el.getBoundingClientRect();\r\n        left = clientRect.left;\r\n        top = clientRect.top;\r\n        width = clientRect.width;\r\n        height = clientRect.height;\r\n    }\r\n    var rect = {\r\n        left: left,\r\n        top: top,\r\n        width: width,\r\n        height: height,\r\n        right: left + width,\r\n        bottom: top + height,\r\n    };\r\n    if (el && isExtends) {\r\n        return getExtendsRect(el, rect);\r\n    }\r\n    return rect;\r\n}\r\nfunction getTotalOrigin(moveable) {\r\n    var _a = moveable.props, groupable = _a.groupable, svgOrigin = _a.svgOrigin;\r\n    var _b = moveable.getState(), offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight, svg = _b.svg, transformOrigin = _b.transformOrigin;\r\n    if (!groupable && svg && svgOrigin) {\r\n        return convertTransformOriginArray(svgOrigin, offsetWidth, offsetHeight);\r\n    }\r\n    return transformOrigin;\r\n}\r\nfunction getTotalDirection(parentDirection, isPinch, inputEvent, datas) {\r\n    var direction;\r\n    if (parentDirection) {\r\n        direction = parentDirection;\r\n    }\r\n    else if (isPinch) {\r\n        direction = [0, 0];\r\n    }\r\n    else {\r\n        var target = inputEvent.target;\r\n        direction = getDirection(target, datas);\r\n    }\r\n    return direction;\r\n}\r\nfunction getDirection(target, datas) {\r\n    if (!target) {\r\n        return;\r\n    }\r\n    var deg = target.getAttribute(\"data-rotation\") || \"\";\r\n    var direciton = target.getAttribute(\"data-direction\");\r\n    datas.deg = deg;\r\n    if (!direciton) {\r\n        return;\r\n    }\r\n    var dir = [0, 0];\r\n    (direciton.indexOf(\"w\") > -1) && (dir[0] = -1);\r\n    (direciton.indexOf(\"e\") > -1) && (dir[0] = 1);\r\n    (direciton.indexOf(\"n\") > -1) && (dir[1] = -1);\r\n    (direciton.indexOf(\"s\") > -1) && (dir[1] = 1);\r\n    return dir;\r\n}\r\nfunction getAbsolutePoses(poses, dist) {\r\n    return [\r\n        plus(dist, poses[0]),\r\n        plus(dist, poses[1]),\r\n        plus(dist, poses[2]),\r\n        plus(dist, poses[3]),\r\n    ];\r\n}\r\nfunction getAbsolutePosesByState(_a) {\r\n    var left = _a.left, top = _a.top, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n    return getAbsolutePoses([pos1, pos2, pos3, pos4], [left, top]);\r\n}\r\nfunction unsetAbles(self, isControl) {\r\n    self[isControl ? \"controlAbles\" : \"targetAbles\"].forEach(function (able) {\r\n        able.unset && able.unset(self);\r\n    });\r\n}\r\nfunction unsetGesto(self, isControl) {\r\n    var gestoName = isControl ? \"controlGesto\" : \"targetGesto\";\r\n    var gesto = self[gestoName];\r\n    if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n        unsetAbles(self, isControl);\r\n    }\r\n    gesto === null || gesto === void 0 ? void 0 : gesto.unset();\r\n    self[gestoName] = null;\r\n}\r\nfunction fillCSSObject(style, resolvedEvent) {\r\n    if (resolvedEvent) {\r\n        var originalDatas = getBeforeRenderableDatas(resolvedEvent);\r\n        originalDatas.nextStyle = __assign(__assign({}, originalDatas.nextStyle), style);\r\n    }\r\n    return {\r\n        style: style,\r\n        cssText: getKeys(style).map(function (name) { return \"\".concat(decamelize(name, \"-\"), \": \").concat(style[name], \";\"); }).join(\"\"),\r\n    };\r\n}\r\nfunction fillAfterTransform(prevEvent, nextEvent, resolvedEvent) {\r\n    var afterTransform = nextEvent.afterTransform || nextEvent.transform;\r\n    return __assign(__assign({}, fillCSSObject(__assign(__assign(__assign({}, prevEvent.style), nextEvent.style), { transform: afterTransform }), resolvedEvent)), { afterTransform: afterTransform, transform: prevEvent.transform });\r\n}\r\nfunction fillParams(moveable, e, params, isBeforeEvent) {\r\n    var datas = e.datas;\r\n    if (!datas.datas) {\r\n        datas.datas = {};\r\n    }\r\n    var nextParams = __assign(__assign({}, params), { target: moveable.state.target, clientX: e.clientX, clientY: e.clientY, inputEvent: e.inputEvent, currentTarget: moveable, moveable: moveable, datas: datas.datas, isRequest: e.isRequest, isRequestChild: e.isRequestChild, isFirstDrag: !!e.isFirstDrag, isTrusted: e.isTrusted !== false, stopAble: function () {\r\n            datas.isEventStart = false;\r\n        }, stopDrag: function () {\r\n            var _a;\r\n            (_a = e.stop) === null || _a === void 0 ? void 0 : _a.call(e);\r\n        } });\r\n    if (!datas.isStartEvent) {\r\n        datas.isStartEvent = true;\r\n    }\r\n    else if (!isBeforeEvent) {\r\n        datas.lastEvent = nextParams;\r\n    }\r\n    return nextParams;\r\n}\r\nfunction fillEndParams(moveable, e, params) {\r\n    var datas = e.datas;\r\n    var isDrag = \"isDrag\" in params ? params.isDrag : e.isDrag;\r\n    if (!datas.datas) {\r\n        datas.datas = {};\r\n    }\r\n    return __assign(__assign({ isDrag: isDrag }, params), { moveable: moveable, target: moveable.state.target, clientX: e.clientX, clientY: e.clientY, inputEvent: e.inputEvent, currentTarget: moveable, lastEvent: datas.lastEvent, isDouble: e.isDouble, datas: datas.datas, isFirstDrag: !!e.isFirstDrag });\r\n}\r\nfunction catchEvent(moveable, name, callback) {\r\n    moveable._emitter.on(name, callback);\r\n}\r\nfunction triggerEvent(moveable, name, params, isManager, isRequest) {\r\n    return moveable.triggerEvent(name, params, isManager, isRequest);\r\n}\r\nfunction getComputedStyle(el, pseudoElt) {\r\n    return getWindow(el).getComputedStyle(el, pseudoElt);\r\n}\r\nfunction filterAbles(ables, methods, triggerAblesSimultaneously) {\r\n    var enabledAbles = {};\r\n    var ableGroups = {};\r\n    return ables.filter(function (able) {\r\n        var name = able.name;\r\n        if (enabledAbles[name] || !methods.some(function (method) { return able[method]; })) {\r\n            return false;\r\n        }\r\n        if (!triggerAblesSimultaneously && able.ableGroup) {\r\n            if (ableGroups[able.ableGroup]) {\r\n                return false;\r\n            }\r\n            ableGroups[able.ableGroup] = true;\r\n        }\r\n        enabledAbles[name] = true;\r\n        return true;\r\n    });\r\n}\r\nfunction equals(a1, a2) {\r\n    return a1 === a2 || (a1 == null && a2 == null);\r\n}\r\nfunction selectValue() {\r\n    var values = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        values[_i] = arguments[_i];\r\n    }\r\n    var length = values.length - 1;\r\n    for (var i = 0; i < length; ++i) {\r\n        var value = values[i];\r\n        if (!isUndefined(value)) {\r\n            return value;\r\n        }\r\n    }\r\n    return values[length];\r\n}\r\nfunction groupBy(arr, func) {\r\n    var groups = [];\r\n    var groupKeys = [];\r\n    arr.forEach(function (el, index) {\r\n        var groupKey = func(el, index, arr);\r\n        var keyIndex = groupKeys.indexOf(groupKey);\r\n        var group = groups[keyIndex] || [];\r\n        if (keyIndex === -1) {\r\n            groupKeys.push(groupKey);\r\n            groups.push(group);\r\n        }\r\n        group.push(el);\r\n    });\r\n    return groups;\r\n}\r\nfunction groupByMap(arr, func) {\r\n    var groups = [];\r\n    var groupKeys = {};\r\n    arr.forEach(function (el, index) {\r\n        var groupKey = func(el, index, arr);\r\n        var group = groupKeys[groupKey];\r\n        if (!group) {\r\n            group = [];\r\n            groupKeys[groupKey] = group;\r\n            groups.push(group);\r\n        }\r\n        group.push(el);\r\n    });\r\n    return groups;\r\n}\r\nfunction flat(arr) {\r\n    return arr.reduce(function (prev, cur) {\r\n        return prev.concat(cur);\r\n    }, []);\r\n}\r\nfunction maxOffset() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    args.sort(function (a, b) { return abs(b) - abs(a); });\r\n    return args[0];\r\n}\r\nfunction calculateInversePosition(matrix, pos, n) {\r\n    return calculate(invert(matrix, n), convertPositionMatrix(pos, n), n);\r\n}\r\nfunction convertDragDist(state, e) {\r\n    var _a;\r\n    var is3d = state.is3d, rootMatrix = state.rootMatrix;\r\n    var n = is3d ? 4 : 3;\r\n    _a = __read(calculateInversePosition(rootMatrix, [e.distX, e.distY], n), 2), e.distX = _a[0], e.distY = _a[1];\r\n    return e;\r\n}\r\nfunction calculatePadding(matrix, pos, added, n) {\r\n    if (!added[0] && !added[1]) {\r\n        return pos;\r\n    }\r\n    var xAdded = calculatePosition(matrix, [normalized(added[0] || 1), 0], n);\r\n    var yAdded = calculatePosition(matrix, [0, normalized(added[1] || 1)], n);\r\n    var nextAdded = calculatePosition(matrix, [\r\n        added[0] / getDistSize(xAdded),\r\n        added[1] / getDistSize(yAdded),\r\n    ], n);\r\n    return plus(pos, nextAdded);\r\n}\r\nfunction convertCSSSize(value, size, isRelative) {\r\n    return isRelative ? \"\".concat(value / size * 100, \"%\") : \"\".concat(value, \"px\");\r\n}\r\nfunction getTinyDist(v) {\r\n    return abs(v) <= TINY_NUM ? 0 : v;\r\n}\r\nfunction getDirectionViewClassName(ableName) {\r\n    return function (moveable) {\r\n        if (!moveable.isDragging(ableName)) {\r\n            return \"\";\r\n        }\r\n        var data = getGestoData(moveable, ableName);\r\n        var deg = data.deg;\r\n        if (!deg) {\r\n            return \"\";\r\n        }\r\n        return prefix(\"view-control-rotation\".concat(deg));\r\n    };\r\n}\r\nfunction getDirectionCondition(ableName, checkAbles) {\r\n    if (checkAbles === void 0) { checkAbles = [ableName]; }\r\n    return function (moveable, e) {\r\n        if (e.isRequest) {\r\n            if (checkAbles.some(function (name) { return e.requestAble === name; })) {\r\n                return e.parentDirection;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        var target = e.inputEvent.target;\r\n        return hasClass(target, prefix(\"direction\")) && (!ableName || hasClass(target, prefix(ableName)));\r\n    };\r\n}\r\nfunction convertTransformInfo(transforms, state, index) {\r\n    var _a;\r\n    var matrixInfos = parse(transforms, {\r\n        \"x%\": function (v) { return v / 100 * state.offsetWidth; },\r\n        \"y%\": function (v) { return v / 100 * state.offsetHeight; },\r\n    });\r\n    var beforeFunctionTexts = transforms.slice(0, index < 0 ? undefined : index);\r\n    var beforeFunctionTexts2 = transforms.slice(0, index < 0 ? undefined : index + 1);\r\n    var targetFunctionText = transforms[index] || \"\";\r\n    var afterFunctionTexts = index < 0 ? [] : transforms.slice(index);\r\n    var afterFunctionTexts2 = index < 0 ? [] : transforms.slice(index + 1);\r\n    var beforeFunctions = matrixInfos.slice(0, index < 0 ? undefined : index);\r\n    var beforeFunctions2 = matrixInfos.slice(0, index < 0 ? undefined : index + 1);\r\n    var targetFunction = (_a = matrixInfos[index]) !== null && _a !== void 0 ? _a : parse([\"\"])[0];\r\n    var afterFunctions = index < 0 ? [] : matrixInfos.slice(index);\r\n    var afterFunctions2 = index < 0 ? [] : matrixInfos.slice(index + 1);\r\n    var targetFunctions = targetFunction ? [targetFunction] : [];\r\n    var beforeFunctionMatrix = toMat(beforeFunctions);\r\n    var beforeFunctionMatrix2 = toMat(beforeFunctions2);\r\n    var afterFunctionMatrix = toMat(afterFunctions);\r\n    var afterFunctionMatrix2 = toMat(afterFunctions2);\r\n    var allFunctionMatrix = multiply(beforeFunctionMatrix, afterFunctionMatrix, 4);\r\n    return {\r\n        transforms: transforms,\r\n        beforeFunctionMatrix: beforeFunctionMatrix,\r\n        beforeFunctionMatrix2: beforeFunctionMatrix2,\r\n        targetFunctionMatrix: toMat(targetFunctions),\r\n        afterFunctionMatrix: afterFunctionMatrix,\r\n        afterFunctionMatrix2: afterFunctionMatrix2,\r\n        allFunctionMatrix: allFunctionMatrix,\r\n        beforeFunctions: beforeFunctions,\r\n        beforeFunctions2: beforeFunctions2,\r\n        targetFunction: targetFunctions[0],\r\n        afterFunctions: afterFunctions,\r\n        afterFunctions2: afterFunctions2,\r\n        beforeFunctionTexts: beforeFunctionTexts,\r\n        beforeFunctionTexts2: beforeFunctionTexts2,\r\n        targetFunctionText: targetFunctionText,\r\n        afterFunctionTexts: afterFunctionTexts,\r\n        afterFunctionTexts2: afterFunctionTexts2,\r\n    };\r\n}\r\nfunction isArrayFormat(arr) {\r\n    if (!arr || !isObject(arr)) {\r\n        return false;\r\n    }\r\n    if (isNode(arr)) {\r\n        return false;\r\n    }\r\n    return isArray(arr) || \"length\" in arr;\r\n}\r\nfunction getRefTarget(target, isSelector) {\r\n    if (!target) {\r\n        return null;\r\n    }\r\n    if (isNode(target)) {\r\n        return target;\r\n    }\r\n    if (isString(target)) {\r\n        if (isSelector) {\r\n            return document.querySelector(target);\r\n        }\r\n        return target;\r\n    }\r\n    if (isFunction(target)) {\r\n        return target();\r\n    }\r\n    if (isWindow(target)) {\r\n        return target;\r\n    }\r\n    if (\"current\" in target) {\r\n        return target.current;\r\n    }\r\n    return target;\r\n}\r\nfunction getRefTargets(targets, isSelector) {\r\n    if (!targets) {\r\n        return [];\r\n    }\r\n    var userTargets = isArrayFormat(targets) ? [].slice.call(targets) : [targets];\r\n    return userTargets.reduce(function (prev, target) {\r\n        if (isString(target) && isSelector) {\r\n            return __spreadArray(__spreadArray([], __read(prev), false), __read([].slice.call(document.querySelectorAll(target))), false);\r\n        }\r\n        if (isArray(target)) {\r\n            prev.push(getRefTargets(target, isSelector));\r\n        }\r\n        else {\r\n            prev.push(getRefTarget(target, isSelector));\r\n        }\r\n        return prev;\r\n    }, []);\r\n}\r\nfunction getAbsoluteRotation(pos1, pos2, direction) {\r\n    var deg = getRad(pos1, pos2) / Math.PI * 180;\r\n    deg = direction >= 0 ? deg : 180 - deg;\r\n    deg = deg >= 0 ? deg : 360 + deg;\r\n    return deg;\r\n}\r\nfunction getDragDistByState(state, dist) {\r\n    var rootMatrix = state.rootMatrix, is3d = state.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var inverseMatrix = invert(rootMatrix, n);\r\n    if (!is3d) {\r\n        inverseMatrix = convertDimension(inverseMatrix, 3, 4);\r\n    }\r\n    inverseMatrix[12] = 0;\r\n    inverseMatrix[13] = 0;\r\n    inverseMatrix[14] = 0;\r\n    return calculateMatrixDist(inverseMatrix, dist);\r\n}\r\nfunction getSizeDistByDist(startSize, dist, ratio, direction, keepRatio) {\r\n    var _a = __read(startSize, 2), startOffsetWidth = _a[0], startOffsetHeight = _a[1];\r\n    var distWidth = 0;\r\n    var distHeight = 0;\r\n    if (keepRatio && startOffsetWidth && startOffsetHeight) {\r\n        var rad = getRad([0, 0], dist);\r\n        var standardRad = getRad([0, 0], direction);\r\n        var size = getDistSize(dist);\r\n        var signSize = Math.cos(rad - standardRad) * size;\r\n        if (!direction[0]) {\r\n            // top, bottom\r\n            distHeight = signSize;\r\n            distWidth = distHeight * ratio;\r\n        }\r\n        else if (!direction[1]) {\r\n            // left, right\r\n            distWidth = signSize;\r\n            distHeight = distWidth / ratio;\r\n        }\r\n        else {\r\n            // two-way\r\n            var startWidthSize = direction[0] * startOffsetWidth;\r\n            var startHeightSize = direction[1] * startOffsetHeight;\r\n            var secondRad = Math.atan2(startWidthSize + dist[0], startHeightSize + dist[1]);\r\n            var firstRad = Math.atan2(startWidthSize, startHeightSize);\r\n            if (secondRad < 0) {\r\n                secondRad += Math.PI * 2;\r\n            }\r\n            if (firstRad < 0) {\r\n                firstRad += Math.PI * 2;\r\n            }\r\n            var rad_1 = 0;\r\n            if (abs(secondRad - firstRad) < Math.PI / 2 || abs(secondRad - firstRad) > Math.PI / 2 * 3) {\r\n                rad_1 = secondRad - firstRad;\r\n            }\r\n            else {\r\n                firstRad += Math.PI;\r\n                rad_1 = secondRad - firstRad;\r\n            }\r\n            if (rad_1 > Math.PI * 2) {\r\n                rad_1 -= Math.PI * 2;\r\n            }\r\n            else if (rad_1 > Math.PI) {\r\n                rad_1 = 2 * Math.PI - rad_1;\r\n            }\r\n            else if (rad_1 < -Math.PI) {\r\n                rad_1 = -2 * Math.PI - rad_1;\r\n            }\r\n            //       180\r\n            // -1, -1,  // 1, -1\r\n            // 270            90\r\n            // -1, 1    // 1, 1\r\n            //       0\r\n            var distSize = getDistSize([startWidthSize + dist[0], startHeightSize + dist[1]]) * Math.cos(rad_1);\r\n            distWidth = distSize * Math.sin(firstRad) - startWidthSize;\r\n            distHeight = distSize * Math.cos(firstRad) - startHeightSize;\r\n            if (direction[0] < 0) {\r\n                distWidth *= -1;\r\n            }\r\n            if (direction[1] < 0) {\r\n                distHeight *= -1;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        distWidth = direction[0] * dist[0];\r\n        distHeight = direction[1] * dist[1];\r\n    }\r\n    return [distWidth, distHeight];\r\n}\r\nfunction getOffsetSizeDist(sizeDirection, keepRatio, datas, e) {\r\n    var _a;\r\n    var ratio = datas.ratio, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight;\r\n    var distWidth = 0;\r\n    var distHeight = 0;\r\n    var distX = e.distX, distY = e.distY, pinchScale = e.pinchScale, parentDistance = e.parentDistance, parentDist = e.parentDist, parentScale = e.parentScale;\r\n    var startFixedDirection = datas.fixedDirection;\r\n    var directionsDists = [0, 1].map(function (index) {\r\n        return abs(sizeDirection[index] - startFixedDirection[index]);\r\n    });\r\n    var directionRatios = [0, 1].map(function (index) {\r\n        var dist = directionsDists[index];\r\n        if (dist !== 0) {\r\n            dist = 2 / dist;\r\n        }\r\n        return dist;\r\n    });\r\n    if (parentDist) {\r\n        distWidth = parentDist[0];\r\n        distHeight = parentDist[1];\r\n        if (keepRatio) {\r\n            if (!distWidth) {\r\n                distWidth = distHeight * ratio;\r\n            }\r\n            else if (!distHeight) {\r\n                distHeight = distWidth / ratio;\r\n            }\r\n        }\r\n    }\r\n    else if (isNumber(pinchScale)) {\r\n        distWidth = (pinchScale - 1) * startOffsetWidth;\r\n        distHeight = (pinchScale - 1) * startOffsetHeight;\r\n    }\r\n    else if (parentScale) {\r\n        distWidth = (parentScale[0] - 1) * startOffsetWidth;\r\n        distHeight = (parentScale[1] - 1) * startOffsetHeight;\r\n    }\r\n    else if (parentDistance) {\r\n        var scaleX = startOffsetWidth * directionsDists[0];\r\n        var scaleY = startOffsetHeight * directionsDists[1];\r\n        var ratioDistance = getDistSize([scaleX, scaleY]);\r\n        distWidth = parentDistance / ratioDistance * scaleX * directionRatios[0];\r\n        distHeight = parentDistance / ratioDistance * scaleY * directionRatios[1];\r\n    }\r\n    else {\r\n        var dist_1 = getDragDist({ datas: datas, distX: distX, distY: distY });\r\n        dist_1 = directionRatios.map(function (ratio, i) {\r\n            return dist_1[i] * ratio;\r\n        });\r\n        _a = __read(getSizeDistByDist([startOffsetWidth, startOffsetHeight], dist_1, ratio, sizeDirection, keepRatio), 2), distWidth = _a[0], distHeight = _a[1];\r\n    }\r\n    return {\r\n        // direction,\r\n        // sizeDirection,\r\n        distWidth: distWidth,\r\n        distHeight: distHeight,\r\n    };\r\n}\r\nfunction convertTransformUnit(origin, xy) {\r\n    if (xy) {\r\n        if (origin === \"left\") {\r\n            return { x: \"0%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"top\") {\r\n            return { x: \"50%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"center\") {\r\n            return { x: \"50%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"right\") {\r\n            return { x: \"100%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"bottom\") {\r\n            return { x: \"50%\", y: \"100%\" };\r\n        }\r\n        var _a = __read(origin.split(\" \"), 2), left = _a[0], right = _a[1];\r\n        var leftOrigin = convertTransformUnit(left || \"\");\r\n        var rightOrigin = convertTransformUnit(right || \"\");\r\n        var originObject = __assign(__assign({}, leftOrigin), rightOrigin);\r\n        var nextOriginObject = {\r\n            x: \"50%\",\r\n            y: \"50%\",\r\n        };\r\n        if (originObject.x) {\r\n            nextOriginObject.x = originObject.x;\r\n        }\r\n        if (originObject.y) {\r\n            nextOriginObject.y = originObject.y;\r\n        }\r\n        if (originObject.value) {\r\n            if (originObject.x && !originObject.y) {\r\n                nextOriginObject.y = originObject.value;\r\n            }\r\n            if (!originObject.x && originObject.y) {\r\n                nextOriginObject.x = originObject.value;\r\n            }\r\n        }\r\n        return nextOriginObject;\r\n    }\r\n    if (origin === \"left\") {\r\n        return { x: \"0%\" };\r\n    }\r\n    if (origin === \"right\") {\r\n        return { x: \"100%\" };\r\n    }\r\n    if (origin === \"top\") {\r\n        return { y: \"0%\" };\r\n    }\r\n    if (origin === \"bottom\") {\r\n        return { y: \"100%\" };\r\n    }\r\n    if (!origin) {\r\n        return {};\r\n    }\r\n    if (origin === \"center\") {\r\n        return { value: \"50%\" };\r\n    }\r\n    return { value: origin };\r\n}\r\nfunction convertTransformOriginArray(transformOrigin, width, height) {\r\n    var _a = convertTransformUnit(transformOrigin, true), x = _a.x, y = _a.y;\r\n    return [\r\n        convertUnitSize(x, width) || 0,\r\n        convertUnitSize(y, height) || 0,\r\n    ];\r\n}\r\nfunction rotatePosesInfo(poses, origin, rad) {\r\n    var prevPoses = poses.map(function (pos) { return minus(pos, origin); });\r\n    var nextPoses = prevPoses.map(function (pos) { return rotate(pos, rad); });\r\n    return {\r\n        prev: prevPoses,\r\n        next: nextPoses,\r\n        result: nextPoses.map(function (pos) { return plus(pos, origin); }),\r\n    };\r\n}\r\nfunction isDeepArrayEquals(arr1, arr2) {\r\n    return arr1.length === arr2.length && arr1.every(function (value1, i) {\r\n        var value2 = arr2[i];\r\n        var isArray1 = isArray(value1);\r\n        var isArray2 = isArray(value2);\r\n        if (isArray1 && isArray2) {\r\n            return isDeepArrayEquals(value1, value2);\r\n        }\r\n        else if (!isArray1 && !isArray2) {\r\n            return value1 === value2;\r\n        }\r\n        return false;\r\n    });\r\n}\r\nfunction watchValue(moveable, property, nextValue, valueKey, defaultValue) {\r\n    var store = moveable._store;\r\n    var prevValue = store[property];\r\n    if (!(property in store)) {\r\n        if (defaultValue != null) {\r\n            store[property] = defaultValue;\r\n            prevValue = defaultValue;\r\n        }\r\n        else {\r\n            store[property] = nextValue;\r\n            return nextValue;\r\n        }\r\n    }\r\n    if (prevValue === nextValue || valueKey(prevValue) === valueKey(nextValue)) {\r\n        return prevValue;\r\n    }\r\n    store[property] = nextValue;\r\n    return nextValue;\r\n}\r\nfunction sign(value) {\r\n    return value >= 0 ? 1 : -1;\r\n}\r\nfunction abs(value) {\r\n    return Math.abs(value);\r\n}\r\nfunction countEach(count, callback) {\r\n    return counter(count).map(function (index) { return callback(index); });\r\n}\r\nfunction getPaddingBox(padding) {\r\n    if (isNumber(padding)) {\r\n        return {\r\n            top: padding,\r\n            left: padding,\r\n            right: padding,\r\n            bottom: padding,\r\n        };\r\n    }\r\n    return {\r\n        left: padding.left || 0,\r\n        top: padding.top || 0,\r\n        right: padding.right || 0,\r\n        bottom: padding.bottom || 0,\r\n    };\r\n}\n\n/**\r\n * @namespace Moveable.Pinchable\r\n * @description Whether or not target can be pinched with draggable, resizable, scalable, rotatable (default: false)\r\n */\r\nvar Pinchable = makeAble(\"pinchable\", {\r\n    props: [\r\n        \"pinchable\",\r\n    ],\r\n    events: [\r\n        \"pinchStart\",\r\n        \"pinch\",\r\n        \"pinchEnd\",\r\n        \"pinchGroupStart\",\r\n        \"pinchGroup\",\r\n        \"pinchGroupEnd\",\r\n    ],\r\n    dragStart: function () {\r\n        return true;\r\n    },\r\n    pinchStart: function (moveable, e) {\r\n        var datas = e.datas, targets = e.targets, angle = e.angle, originalDatas = e.originalDatas;\r\n        var _a = moveable.props, pinchable = _a.pinchable, ables = _a.ables;\r\n        if (!pinchable) {\r\n            return false;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\", \"Start\");\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"ControlStart\");\r\n        var pinchAbles = (pinchable === true ? moveable.controlAbles : ables.filter(function (able) {\r\n            return pinchable.indexOf(able.name) > -1;\r\n        })).filter(function (able) { return able.canPinch && able[controlEventName]; });\r\n        var params = fillParams(moveable, e, {});\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        var result = triggerEvent(moveable, eventName, params);\r\n        datas.isPinch = result !== false;\r\n        datas.ables = pinchAbles;\r\n        var isPinch = datas.isPinch;\r\n        if (!isPinch) {\r\n            return false;\r\n        }\r\n        pinchAbles.forEach(function (able) {\r\n            originalDatas[able.name] = originalDatas[able.name] || {};\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            var ableEvent = __assign(__assign({}, e), { datas: originalDatas[able.name], parentRotate: angle, isPinch: true });\r\n            able[controlEventName](moveable, ableEvent);\r\n        });\r\n        moveable.state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            direction: [0, 0],\r\n        };\r\n        return isPinch;\r\n    },\r\n    pinch: function (moveable, e) {\r\n        var datas = e.datas, pinchScale = e.scale, distance = e.distance, originalDatas = e.originalDatas, inputEvent = e.inputEvent, targets = e.targets, angle = e.angle;\r\n        if (!datas.isPinch) {\r\n            return;\r\n        }\r\n        var parentDistance = distance * (1 - 1 / pinchScale);\r\n        var params = fillParams(moveable, e, {});\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\");\r\n        triggerEvent(moveable, eventName, params);\r\n        var ables = datas.ables;\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"Control\");\r\n        ables.forEach(function (able) {\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            able[controlEventName](moveable, __assign(__assign({}, e), { datas: originalDatas[able.name], inputEvent: inputEvent, resolveMatrix: true, pinchScale: pinchScale, parentDistance: parentDistance, parentRotate: angle, isPinch: true }));\r\n        });\r\n        return params;\r\n    },\r\n    pinchEnd: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, inputEvent = e.inputEvent, targets = e.targets, originalDatas = e.originalDatas;\r\n        if (!datas.isPinch) {\r\n            return;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\", \"End\");\r\n        var params = fillEndParams(moveable, e, { isDrag: isPinch });\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        triggerEvent(moveable, eventName, params);\r\n        var ables = datas.ables;\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"ControlEnd\");\r\n        ables.forEach(function (able) {\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            able[controlEventName](moveable, __assign(__assign({}, e), { isDrag: isPinch, datas: originalDatas[able.name], inputEvent: inputEvent, isPinch: true }));\r\n        });\r\n        return isPinch;\r\n    },\r\n    pinchGroupStart: function (moveable, e) {\r\n        return this.pinchStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    pinchGroup: function (moveable, e) {\r\n        return this.pinch(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    pinchGroupEnd: function (moveable, e) {\r\n        return this.pinchEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n});\r\n/**\r\n * Whether or not target can be pinched with draggable, resizable, scalable, rotatable (default: false)\r\n * @name Moveable.Pinchable#pinchable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.pinchable = true;\r\n */\r\n/**\r\n * When the pinch starts, the pinchStart event is called with part of scaleStart, rotateStart, resizeStart\r\n * @memberof Moveable.Pinchable\r\n * @event pinchStart\r\n * @param {Moveable.Pinchable.OnPinchStart} - Parameters for the pinchStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinchStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotateStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scaleStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When pinching, the pinch event is called with part of scale, rotate, resize\r\n * @memberof Moveable.Pinchable\r\n * @event pinch\r\n * @param {Moveable.Pinchable.OnPinch} - Parameters for the pinch event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinch\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotate\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scale\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When the pinch finishes, the pinchEnd event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchEnd\r\n * @param {Moveable.Pinchable.OnPinchEnd} - Parameters for the pinchEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinchEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotateEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scaleEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When the group pinch starts, the `pinchGroupStart` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroupStart\r\n * @param {Moveable.Pinchable.OnPinchGroupStart} - Parameters for the `pinchGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroupStart\", ({ targets }) => {\r\n *     console.log(\"onPinchGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n * When the group pinch, the `pinchGroup` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroup\r\n * @param {Moveable.Pinchable.OnPinchGroup} - Parameters for the `pinchGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroup\", ({ targets, events }) => {\r\n *     console.log(\"onPinchGroup\", targets);\r\n * });\r\n */\r\n/**\r\n * When the group pinch finishes, the `pinchGroupEnd` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroupEnd\r\n * @param {Moveable.Pinchable.OnPinchGroupEnd} - Parameters for the `pinchGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onPinchGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nvar directionCondition = getDirectionCondition(\"scalable\");\r\n/**\r\n * @namespace Scalable\r\n * @memberof Moveable\r\n * @description Scalable indicates whether the target's x and y can be scale of transform.\r\n */\r\nvar Scalable = {\r\n    name: \"scalable\",\r\n    ableGroup: \"size\",\r\n    canPinch: true,\r\n    props: [\r\n        \"scalable\",\r\n        \"throttleScale\",\r\n        \"renderDirections\",\r\n        \"keepRatio\",\r\n        \"edge\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"scaleStart\",\r\n        \"beforeScale\",\r\n        \"scale\",\r\n        \"scaleEnd\",\r\n        \"scaleGroupStart\",\r\n        \"beforeScaleGroup\",\r\n        \"scaleGroup\",\r\n        \"scaleGroupEnd\",\r\n    ],\r\n    render: getRenderDirections(\"scalable\"),\r\n    dragControlCondition: directionCondition,\r\n    viewClassName: getDirectionViewClassName(\"scalable\"),\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, inputEvent = e.inputEvent, parentDirection = e.parentDirection;\r\n        var direction = getTotalDirection(parentDirection, isPinch, inputEvent, datas);\r\n        var _a = moveable.state, width = _a.width, height = _a.height, targetTransform = _a.targetTransform, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos4 = _a.pos4;\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        if (!isPinch) {\r\n            setDragStart(moveable, e);\r\n        }\r\n        datas.datas = {};\r\n        datas.transform = targetTransform;\r\n        datas.prevDist = [1, 1];\r\n        datas.direction = direction;\r\n        datas.startOffsetWidth = width;\r\n        datas.startOffsetHeight = height;\r\n        datas.startValue = [1, 1];\r\n        // const scaleWidth = getDist(pos1, pos2);\r\n        // const scaleHeight = getDist(pos2, pos4);\r\n        var isWidth = (!direction[0] && !direction[1]) || direction[0] || !direction[1];\r\n        // datas.scaleWidth = scaleWidth;\r\n        // datas.scaleHeight = scaleHeight;\r\n        // datas.scaleXRatio = scaleWidth / width;\r\n        // datas.scaleYRatio = scaleHeight / height;\r\n        setDefaultTransformIndex(moveable, e, \"scale\");\r\n        datas.isWidth = isWidth;\r\n        function setRatio(ratio) {\r\n            datas.ratio = ratio && isFinite(ratio) ? ratio : 0;\r\n        }\r\n        datas.startPositions = getAbsolutePosesByState(moveable.state);\r\n        function setFixedDirection(fixedDirection) {\r\n            var result = getFixedDirectionInfo(datas.startPositions, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        datas.setFixedDirection = setFixedDirection;\r\n        setRatio(getDist$1(pos1, pos2) / getDist$1(pos2, pos4));\r\n        setFixedDirection([-direction[0], -direction[1]]);\r\n        var setMinScaleSize = function (min) {\r\n            datas.minScaleSize = min;\r\n        };\r\n        var setMaxScaleSize = function (max) {\r\n            datas.maxScaleSize = max;\r\n        };\r\n        // const setMinScale = (min: number[]) => {\r\n        // };\r\n        // const setMaxScale = (max: number[]) => {\r\n        // };\r\n        setMinScaleSize([-Infinity, -Infinity]);\r\n        setMaxScaleSize([Infinity, Infinity]);\r\n        var params = fillParams(moveable, e, __assign(__assign({ direction: direction, set: function (scale) {\r\n                datas.startValue = scale;\r\n            }, setRatio: setRatio, setFixedDirection: setFixedDirection, setMinScaleSize: setMinScaleSize, setMaxScaleSize: setMaxScaleSize }, fillTransformStartEvent(moveable, e)), { dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)) }));\r\n        var result = triggerEvent(moveable, \"onScaleStart\", params);\r\n        datas.startFixedDirection = datas.fixedDirection;\r\n        if (result !== false) {\r\n            datas.isScale = true;\r\n            moveable.state.snapRenderInfo = {\r\n                request: e.isRequest,\r\n                direction: direction,\r\n            };\r\n        }\r\n        return datas.isScale ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        resolveTransformEvent(moveable, e, \"scale\");\r\n        var datas = e.datas, parentKeepRatio = e.parentKeepRatio, parentFlag = e.parentFlag, isPinch = e.isPinch, dragClient = e.dragClient, isRequest = e.isRequest, useSnap = e.useSnap, resolveMatrix = e.resolveMatrix;\r\n        var prevDist = datas.prevDist, direction = datas.direction, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, isScale = datas.isScale, startValue = datas.startValue, isWidth = datas.isWidth, ratio = datas.ratio;\r\n        if (!isScale) {\r\n            return false;\r\n        }\r\n        var props = moveable.props;\r\n        var throttleScale = props.throttleScale, parentMoveable = props.parentMoveable;\r\n        var sizeDirection = direction;\r\n        if (!direction[0] && !direction[1]) {\r\n            sizeDirection = [1, 1];\r\n        }\r\n        var keepRatio = (ratio && (parentKeepRatio != null ? parentKeepRatio : props.keepRatio)) || false;\r\n        var state = moveable.state;\r\n        var tempScaleValue = [\r\n            startValue[0],\r\n            startValue[1],\r\n        ];\r\n        function getNextScale() {\r\n            var _a = getOffsetSizeDist(sizeDirection, keepRatio, datas, e), distWidth = _a.distWidth, distHeight = _a.distHeight;\r\n            var distX = startOffsetWidth ? (startOffsetWidth + distWidth) / startOffsetWidth : 1;\r\n            var distY = startOffsetHeight ? (startOffsetHeight + distHeight) / startOffsetHeight : 1;\r\n            if (!startValue[0]) {\r\n                tempScaleValue[0] = distWidth / startOffsetWidth;\r\n            }\r\n            if (!startValue[1]) {\r\n                tempScaleValue[1] = distHeight / startOffsetHeight;\r\n            }\r\n            var scaleX = (sizeDirection[0] || keepRatio ? distX : 1) * tempScaleValue[0];\r\n            var scaleY = (sizeDirection[1] || keepRatio ? distY : 1) * tempScaleValue[1];\r\n            if (scaleX === 0) {\r\n                scaleX = sign(prevDist[0]) * MIN_SCALE;\r\n            }\r\n            if (scaleY === 0) {\r\n                scaleY = sign(prevDist[1]) * MIN_SCALE;\r\n            }\r\n            return [scaleX, scaleY];\r\n        }\r\n        var scale = getNextScale();\r\n        if (!isPinch && moveable.props.groupable) {\r\n            var snapRenderInfo = state.snapRenderInfo || {};\r\n            var stateDirection = snapRenderInfo.direction;\r\n            if (isArray(stateDirection) && (stateDirection[0] || stateDirection[1])) {\r\n                state.snapRenderInfo = { direction: direction, request: e.isRequest };\r\n            }\r\n        }\r\n        triggerEvent(moveable, \"onBeforeScale\", fillParams(moveable, e, {\r\n            scale: scale,\r\n            setFixedDirection: function (nextFixedDirection) {\r\n                datas.setFixedDirection(nextFixedDirection);\r\n                scale = getNextScale();\r\n                return scale;\r\n            },\r\n            startFixedDirection: datas.startFixedDirection,\r\n            setScale: function (nextScale) {\r\n                scale = nextScale;\r\n            },\r\n        }, true));\r\n        var dist = [\r\n            scale[0] / tempScaleValue[0],\r\n            scale[1] / tempScaleValue[1],\r\n        ];\r\n        var fixedPosition = dragClient;\r\n        var snapDist = [0, 0];\r\n        var distSign = sign(dist[0] * dist[1]);\r\n        var isSelfPinch = !dragClient && !parentFlag && isPinch;\r\n        if (isSelfPinch || resolveMatrix) {\r\n            fixedPosition = getTranslateFixedPosition(moveable, datas.targetAllTransform, [0, 0], [0, 0], datas);\r\n        }\r\n        else if (!dragClient) {\r\n            fixedPosition = datas.fixedPosition;\r\n        }\r\n        if (!isPinch) {\r\n            snapDist = checkSnapScale(moveable, dist, direction, !useSnap && isRequest, datas);\r\n        }\r\n        if (keepRatio) {\r\n            if (sizeDirection[0] && sizeDirection[1] && snapDist[0] && snapDist[1]) {\r\n                if (Math.abs(snapDist[0] * startOffsetWidth) > Math.abs(snapDist[1] * startOffsetHeight)) {\r\n                    snapDist[1] = 0;\r\n                }\r\n                else {\r\n                    snapDist[0] = 0;\r\n                }\r\n            }\r\n            var isNoSnap = !snapDist[0] && !snapDist[1];\r\n            if (isNoSnap) {\r\n                // throttle scale value (not absolute scale size)\r\n                if (isWidth) {\r\n                    dist[0] = throttle(dist[0] * tempScaleValue[0], throttleScale) / tempScaleValue[0];\r\n                }\r\n                else {\r\n                    dist[1] = throttle(dist[1] * tempScaleValue[1], throttleScale) / tempScaleValue[1];\r\n                }\r\n            }\r\n            if ((sizeDirection[0] && !sizeDirection[1])\r\n                || (snapDist[0] && !snapDist[1])\r\n                || (isNoSnap && isWidth)) {\r\n                dist[0] += snapDist[0];\r\n                var snapHeight = startOffsetWidth * dist[0] * tempScaleValue[0] / ratio;\r\n                dist[1] = sign(distSign * dist[0]) * abs(snapHeight / startOffsetHeight / tempScaleValue[1]);\r\n            }\r\n            else if ((!sizeDirection[0] && sizeDirection[1])\r\n                || (!snapDist[0] && snapDist[1])\r\n                || (isNoSnap && !isWidth)) {\r\n                dist[1] += snapDist[1];\r\n                var snapWidth = startOffsetHeight * dist[1] * tempScaleValue[1] * ratio;\r\n                dist[0] = sign(distSign * dist[1]) * abs(snapWidth / startOffsetWidth / tempScaleValue[0]);\r\n            }\r\n        }\r\n        else {\r\n            dist[0] += snapDist[0];\r\n            dist[1] += snapDist[1];\r\n            if (!snapDist[0]) {\r\n                dist[0] = throttle(dist[0] * tempScaleValue[0], throttleScale) / tempScaleValue[0];\r\n            }\r\n            if (!snapDist[1]) {\r\n                dist[1] = throttle(dist[1] * tempScaleValue[1], throttleScale) / tempScaleValue[1];\r\n            }\r\n        }\r\n        if (dist[0] === 0) {\r\n            dist[0] = sign(prevDist[0]) * MIN_SCALE;\r\n        }\r\n        if (dist[1] === 0) {\r\n            dist[1] = sign(prevDist[1]) * MIN_SCALE;\r\n        }\r\n        scale = multiply2(dist, [tempScaleValue[0], tempScaleValue[1]]);\r\n        var startOffsetSize = [\r\n            startOffsetWidth,\r\n            startOffsetHeight,\r\n        ];\r\n        var scaleSize = [\r\n            startOffsetWidth * scale[0],\r\n            startOffsetHeight * scale[1],\r\n        ];\r\n        scaleSize = calculateBoundSize(scaleSize, datas.minScaleSize, datas.maxScaleSize, keepRatio ? ratio : false);\r\n        // if (keepRatio && (isGroup || keepRatioFinally)) {\r\n        //     if (isWidth) {\r\n        //         boundingHeight = boundingWidth / ratio;\r\n        //     } else {\r\n        //         boundingWidth = boundingHeight * ratio;\r\n        //     }\r\n        // }\r\n        scale = countEach(2, function (i) {\r\n            return startOffsetSize[i] ? scaleSize[i] / startOffsetSize[i] : scaleSize[i];\r\n        });\r\n        dist = countEach(2, function (i) {\r\n            return scale[i] / tempScaleValue[i];\r\n        });\r\n        var delta = countEach(2, function (i) { return prevDist[i] ? dist[i] / prevDist[i] : dist[i]; });\r\n        var distText = \"scale(\".concat(dist.join(\", \"), \")\");\r\n        var scaleText = \"scale(\".concat(scale.join(\", \"), \")\");\r\n        var nextTransform = convertTransformFormat(datas, scaleText, distText);\r\n        var isZeroScale = !startValue[0] || !startValue[1];\r\n        var inverseDist = getScaleDist(moveable, isZeroScale ? scaleText : distText, datas.fixedDirection, fixedPosition, datas.fixedOffset, datas, isZeroScale);\r\n        var inverseDelta = isSelfPinch ? inverseDist : minus(inverseDist, datas.prevInverseDist || [0, 0]);\r\n        datas.prevDist = dist;\r\n        datas.prevInverseDist = inverseDist;\r\n        if (scale[0] === prevDist[0] && scale[1] === prevDist[1]\r\n            && inverseDelta.every(function (num) { return !num; })\r\n            && !parentMoveable\r\n            && !isSelfPinch) {\r\n            return false;\r\n        }\r\n        var params = fillParams(moveable, e, __assign({ offsetWidth: startOffsetWidth, offsetHeight: startOffsetHeight, direction: direction, scale: scale, dist: dist, delta: delta, isPinch: !!isPinch }, fillTransformEvent(moveable, nextTransform, inverseDelta, isPinch, e)));\r\n        triggerEvent(moveable, \"onScale\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return false;\r\n        }\r\n        datas.isScale = false;\r\n        var scaleEndParam = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onScaleEnd\", scaleEndParam);\r\n        return scaleEndParam;\r\n    },\r\n    dragGroupControlCondition: directionCondition,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var originalEvents = fillChildEvents(moveable, \"resizable\", e);\r\n        datas.moveableScale = moveable.scale;\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            return startChildDist(moveable, child, datas, ev);\r\n        });\r\n        var setFixedDirection = function (fixedDirection) {\r\n            params.setFixedDirection(fixedDirection);\r\n            events.forEach(function (ev, i) {\r\n                ev.setFixedDirection(fixedDirection);\r\n                startChildDist(moveable, ev.moveable, datas, originalEvents[i]);\r\n            });\r\n        };\r\n        datas.setFixedDirection = setFixedDirection;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events, setFixedDirection: setFixedDirection });\r\n        var result = triggerEvent(moveable, \"onScaleGroupStart\", nextParams);\r\n        datas.isScale = result !== false;\r\n        return datas.isScale ? nextParams : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return;\r\n        }\r\n        catchEvent(moveable, \"onBeforeScale\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeScaleGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: moveable.props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var dist = params.dist;\r\n        var moveableScale = datas.moveableScale;\r\n        moveable.scale = [\r\n            dist[0] * moveableScale[0],\r\n            dist[1] * moveableScale[1],\r\n        ];\r\n        var keepRatio = moveable.props.keepRatio;\r\n        var fixedPosition = datas.fixedPosition;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var _a = __read(calculate(createRotateMatrix(moveable.rotation / 180 * Math.PI, 3), [\r\n                ev.datas.originalX * dist[0],\r\n                ev.datas.originalY * dist[1],\r\n                1,\r\n            ], 3), 2), clientX = _a[0], clientY = _a[1];\r\n            return __assign(__assign({}, ev), { parentDist: null, parentScale: dist, parentKeepRatio: keepRatio, \r\n                // recalculate child fixed position for parent group's dragging.\r\n                dragClient: plus(fixedPosition, [clientX, clientY]) });\r\n        });\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events }, params);\r\n        triggerEvent(moveable, \"onScaleGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onScaleGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Scalable#request\r\n     * @param {Moveable.Scalable.ScalableRequestParam} e - the Scalable's request parameter\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"scalable\", { deltaWidth: 10, deltaHeight: 10 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"scalable\");\r\n     *\r\n     * // request\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function () {\r\n        var datas = {};\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        var useSnap = false;\r\n        return {\r\n            isControl: true,\r\n            requestStart: function (e) {\r\n                useSnap = e.useSnap;\r\n                return {\r\n                    datas: datas,\r\n                    parentDirection: e.direction || [1, 1],\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            request: function (e) {\r\n                distWidth += e.deltaWidth;\r\n                distHeight += e.deltaHeight;\r\n                return {\r\n                    datas: datas,\r\n                    parentDist: [distWidth, distHeight],\r\n                    parentKeepRatio: e.keepRatio,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether or not target can scaled.\r\n *\r\n * @name Moveable.Scalable#scalable\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.scalable = true;\r\n */\r\n/**\r\n * throttle of scaleX, scaleY when scale.\r\n * @name Moveable.Scalable#throttleScale\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleScale = 0.1;\r\n */\r\n/**\r\n * Set directions to show the control box. (default: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"])\r\n * @name Moveable.Scalable#renderDirections\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     scalable: true,\r\n *   renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n * });\r\n *\r\n * moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n */\r\n/**\r\n * When resize or scale, keeps a ratio of the width, height. (default: false)\r\n * @name Moveable.Scalable#keepRatio\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     scalable: true,\r\n * });\r\n *\r\n * moveable.keepRatio = true;\r\n */\r\n/**\r\n * When the scale starts, the scaleStart event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleStart\r\n * @param {Moveable.Scalable.OnScaleStart} - Parameters for the scaleStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scaleStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When scaling, `beforeScale` is called before `scale` occurs. In `beforeScale`, you can get and set the pre-value before scaling.\r\n * @memberof Moveable.Scalable\r\n * @event beforeScale\r\n * @param {Moveable.Scalable.OnBeforeScale} - Parameters for the `beforeScale` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"beforeScale\", ({ setFixedDirection }) => {\r\n *     if (shiftKey) {\r\n *        setFixedDirection([0, 0]);\r\n *     }\r\n * });\r\n * moveable.on(\"scale\", ({ target, transform, dist }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When scaling, the `scale` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scale\r\n * @param {Moveable.Scalable.OnScale} - Parameters for the `scale` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scale\", ({ target, transform, dist }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When the scale finishes, the `scaleEnd` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleEnd\r\n * @param {Moveable.Scalable.OnScaleEnd} - Parameters for the `scaleEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scaleEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group scale starts, the `scaleGroupStart` event is called.\r\n* @memberof Moveable.Scalable\r\n* @event scaleGroupStart\r\n* @param {Moveable.Scalable.OnScaleGroupStart} - Parameters for the `scaleGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     scalable: true\r\n* });\r\n* moveable.on(\"scaleGroupStart\", ({ targets }) => {\r\n*     console.log(\"onScaleGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group scale, the `scaleGroup` event is called.\r\n* @memberof Moveable.Scalable\r\n* @event scaleGroup\r\n* @param {Moveable.Scalable.OnScaleGroup} - Parameters for the `scaleGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     scalable: true\r\n* });\r\n* moveable.on(\"scaleGroup\", ({ targets, events }) => {\r\n*     console.log(\"onScaleGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const target = ev.target;\r\n*         // ev.drag is a drag event that occurs when the group scale.\r\n*         const left = ev.drag.beforeDist[0];\r\n*         const top = ev.drag.beforeDist[1];\r\n*         const scaleX = ev.scale[0];\r\n*         const scaleY = ev.scale[1];\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group scale finishes, the `scaleGroupEnd` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleGroupEnd\r\n * @param {Moveable.Scalable.OnScaleGroupEnd} - Parameters for the `scaleGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     scalable: true\r\n * });\r\n * moveable.on(\"scaleGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onScaleGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction getMiddleLinePos(pos1, pos2) {\r\n    return pos1.map(function (pos, i) { return dot(pos, pos2[i], 1, 2); });\r\n}\r\nfunction getTriangleRad(pos1, pos2, pos3) {\r\n    // pos1 Rad\r\n    var rad1 = getRad(pos1, pos2);\r\n    var rad2 = getRad(pos1, pos3);\r\n    var rad = rad2 - rad1;\r\n    return rad >= 0 ? rad : rad + 2 * Math.PI;\r\n}\r\nfunction isValidPos(poses1, poses2) {\r\n    var rad1 = getTriangleRad(poses1[0], poses1[1], poses1[2]);\r\n    var rad2 = getTriangleRad(poses2[0], poses2[1], poses2[2]);\r\n    var pi = Math.PI;\r\n    if ((rad1 >= pi && rad2 <= pi) || (rad1 <= pi && rad2 >= pi)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * @namespace Moveable.Warpable\r\n * @description Warpable indicates whether the target can be warped(distorted, bented).\r\n */\r\nvar Warpable = {\r\n    name: \"warpable\",\r\n    ableGroup: \"size\",\r\n    props: [\r\n        \"warpable\",\r\n        \"renderDirections\",\r\n        \"edge\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"warpStart\",\r\n        \"warp\",\r\n        \"warpEnd\",\r\n    ],\r\n    viewClassName: getDirectionViewClassName(\"warpable\"),\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, resizable = _a.resizable, scalable = _a.scalable, warpable = _a.warpable, zoom = _a.zoom;\r\n        if (resizable || scalable || !warpable) {\r\n            return [];\r\n        }\r\n        var _b = moveable.state, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4;\r\n        var linePosFrom1 = getMiddleLinePos(pos1, pos2);\r\n        var linePosFrom2 = getMiddleLinePos(pos2, pos1);\r\n        var linePosFrom3 = getMiddleLinePos(pos1, pos3);\r\n        var linePosFrom4 = getMiddleLinePos(pos3, pos1);\r\n        var linePosTo1 = getMiddleLinePos(pos3, pos4);\r\n        var linePosTo2 = getMiddleLinePos(pos4, pos3);\r\n        var linePosTo3 = getMiddleLinePos(pos2, pos4);\r\n        var linePosTo4 = getMiddleLinePos(pos4, pos2);\r\n        return __spreadArray([\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine1\", style: getLineStyle(linePosFrom1, linePosTo1, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine2\", style: getLineStyle(linePosFrom2, linePosTo2, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine3\", style: getLineStyle(linePosFrom3, linePosTo3, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine4\", style: getLineStyle(linePosFrom4, linePosTo4, zoom) })\r\n        ], __read(renderAllDirections(moveable, \"warpable\", React)), false);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (e.isRequest) {\r\n            return false;\r\n        }\r\n        var target = e.inputEvent.target;\r\n        return hasClass(target, prefix(\"direction\")) && hasClass(target, prefix(\"warpable\"));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas, inputEvent = e.inputEvent;\r\n        var target = moveable.props.target;\r\n        var inputTarget = inputEvent.target;\r\n        var direction = getDirection(inputTarget, datas);\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        var state = moveable.state;\r\n        var transformOrigin = state.transformOrigin, is3d = state.is3d, targetTransform = state.targetTransform, targetMatrix = state.targetMatrix, width = state.width, height = state.height, left = state.left, top = state.top;\r\n        datas.datas = {};\r\n        datas.targetTransform = targetTransform;\r\n        datas.warpTargetMatrix = is3d ? targetMatrix : convertDimension(targetMatrix, 3, 4);\r\n        datas.targetInverseMatrix = ignoreDimension(invert(datas.warpTargetMatrix, 4), 3, 4);\r\n        datas.direction = direction;\r\n        datas.left = left;\r\n        datas.top = top;\r\n        datas.poses = [\r\n            [0, 0],\r\n            [width, 0],\r\n            [0, height],\r\n            [width, height],\r\n        ].map(function (p) { return minus(p, transformOrigin); });\r\n        datas.nextPoses = datas.poses.map(function (_a) {\r\n            var _b = __read(_a, 2), x = _b[0], y = _b[1];\r\n            return calculate(datas.warpTargetMatrix, [x, y, 0, 1], 4);\r\n        });\r\n        datas.startValue = createIdentityMatrix(4);\r\n        datas.prevMatrix = createIdentityMatrix(4);\r\n        datas.absolutePoses = getAbsolutePosesByState(state);\r\n        datas.posIndexes = getPosIndexesByDirection(direction);\r\n        setDragStart(moveable, e);\r\n        setDefaultTransformIndex(moveable, e, \"matrix3d\");\r\n        state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            direction: direction,\r\n        };\r\n        var params = fillParams(moveable, e, __assign({ set: function (matrix) {\r\n                datas.startValue = matrix;\r\n            } }, fillTransformStartEvent(moveable, e)));\r\n        var result = triggerEvent(moveable, \"onWarpStart\", params);\r\n        if (result !== false) {\r\n            datas.isWarp = true;\r\n        }\r\n        return datas.isWarp;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas, isRequest = e.isRequest;\r\n        var distX = e.distX, distY = e.distY;\r\n        var targetInverseMatrix = datas.targetInverseMatrix, prevMatrix = datas.prevMatrix, isWarp = datas.isWarp, startValue = datas.startValue, poses = datas.poses, posIndexes = datas.posIndexes, absolutePoses = datas.absolutePoses;\r\n        if (!isWarp) {\r\n            return false;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"matrix3d\");\r\n        if (hasGuidelines(moveable, \"warpable\")) {\r\n            var selectedPoses = posIndexes.map(function (index) { return absolutePoses[index]; });\r\n            if (selectedPoses.length > 1) {\r\n                selectedPoses.push([\r\n                    (selectedPoses[0][0] + selectedPoses[1][0]) / 2,\r\n                    (selectedPoses[0][1] + selectedPoses[1][1]) / 2,\r\n                ]);\r\n            }\r\n            var _a = checkMoveableSnapBounds(moveable, isRequest, {\r\n                horizontal: selectedPoses.map(function (pos) { return pos[1] + distY; }),\r\n                vertical: selectedPoses.map(function (pos) { return pos[0] + distX; }),\r\n            }), horizontalSnapInfo = _a.horizontal, verticalSnapInfo = _a.vertical;\r\n            distY -= horizontalSnapInfo.offset;\r\n            distX -= verticalSnapInfo.offset;\r\n        }\r\n        var dist = getDragDist({ datas: datas, distX: distX, distY: distY }, true);\r\n        var nextPoses = datas.nextPoses.slice();\r\n        posIndexes.forEach(function (index) {\r\n            nextPoses[index] = plus(nextPoses[index], dist);\r\n        });\r\n        if (!NEARBY_POS.every(function (nearByPoses) { return isValidPos(nearByPoses.map(function (i) { return poses[i]; }), nearByPoses.map(function (i) { return nextPoses[i]; })); })) {\r\n            return false;\r\n        }\r\n        var h = createWarpMatrix(poses[0], poses[2], poses[1], poses[3], nextPoses[0], nextPoses[2], nextPoses[1], nextPoses[3]);\r\n        if (!h.length) {\r\n            return false;\r\n        }\r\n        // B * A * M\r\n        var afterMatrix = multiply(targetInverseMatrix, h, 4);\r\n        // B * M * A\r\n        var matrix = getTransfromMatrix(datas, afterMatrix, true);\r\n        var delta = multiply(invert(prevMatrix, 4), matrix, 4);\r\n        datas.prevMatrix = matrix;\r\n        var totalMatrix = multiply(startValue, matrix, 4);\r\n        var nextTransform = convertTransformFormat(datas, \"matrix3d(\".concat(totalMatrix.join(\", \"), \")\"), \"matrix3d(\".concat(matrix.join(\", \"), \")\"));\r\n        fillOriginalTransform(e, nextTransform);\r\n        triggerEvent(moveable, \"onWarp\", fillParams(moveable, e, __assign({ delta: delta, matrix: totalMatrix, dist: matrix, multiply: multiply, transform: nextTransform }, fillCSSObject({\r\n            transform: nextTransform,\r\n        }, e))));\r\n        return true;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas, isDrag = e.isDrag;\r\n        if (!datas.isWarp) {\r\n            return false;\r\n        }\r\n        datas.isWarp = false;\r\n        triggerEvent(moveable, \"onWarpEnd\", fillEndParams(moveable, e, {}));\r\n        return isDrag;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be warped. (default: false)\r\n * @name Moveable.Warpable#warpable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.warpable = true;\r\n */\r\n/**\r\n* Set directions to show the control box. (default: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"])\r\n* @name Moveable.Warpable#renderDirections\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     warpable: true,\r\n*     renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n* });\r\n*\r\n* moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n*/\r\n/**\r\n* When the warp starts, the warpStart event is called.\r\n* @memberof Moveable.Warpable\r\n* @event warpStart\r\n* @param {Moveable.Warpable.OnWarpStart} - Parameters for the warpStart event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, { warpable: true });\r\n* moveable.on(\"warpStart\", ({ target }) => {\r\n*     console.log(target);\r\n* });\r\n*/\r\n/**\r\n * When warping, the warp event is called.\r\n * @memberof Moveable.Warpable\r\n * @event warp\r\n * @param {Moveable.Warpable.OnWarp} - Parameters for the warp event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n * let matrix = [\r\n *  1, 0, 0, 0,\r\n *  0, 1, 0, 0,\r\n *  0, 0, 1, 0,\r\n *  0, 0, 0, 1,\r\n * ];\r\n * const moveable = new Moveable(document.body, { warpable: true });\r\n * moveable.on(\"warp\", ({ target, transform, delta, multiply }) => {\r\n *    // target.style.transform = transform;\r\n *    matrix = multiply(matrix, delta);\r\n *    target.style.transform = `matrix3d(${matrix.join(\",\")})`;\r\n * });\r\n */\r\n/**\r\n * When the warp finishes, the warpEnd event is called.\r\n * @memberof Moveable.Warpable\r\n * @event warpEnd\r\n * @param {Moveable.Warpable.OnWarpEnd} - Parameters for the warpEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { warpable: true });\r\n * moveable.on(\"warpEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\n\nvar AREA_PIECES = /*#__PURE__*/ prefix(\"area-pieces\");\r\nvar AREA_PIECE = /*#__PURE__*/ prefix(\"area-piece\");\r\nvar AVOID = /*#__PURE__*/ prefix(\"avoid\");\r\nvar VIEW_DRAGGING = prefix(\"view-dragging\");\n\nfunction restoreStyle(moveable) {\r\n    var el = moveable.areaElement;\r\n    if (!el) {\r\n        return;\r\n    }\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    removeClass(el, AVOID);\r\n    el.style.cssText += \"left: 0px; top: 0px; width: \".concat(width, \"px; height: \").concat(height, \"px\");\r\n}\r\nfunction renderPieces(React) {\r\n    return (React.createElement(\"div\", { key: \"area_pieces\", className: AREA_PIECES },\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE })));\r\n}\r\nvar DragArea = {\r\n    name: \"dragArea\",\r\n    props: [\r\n        \"dragArea\",\r\n        \"passDragArea\",\r\n    ],\r\n    events: [\r\n        \"click\",\r\n        \"clickGroup\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, target = _a.target, dragArea = _a.dragArea, groupable = _a.groupable, passDragArea = _a.passDragArea;\r\n        var _b = moveable.getState(), width = _b.width, height = _b.height, renderPoses = _b.renderPoses;\r\n        var className = passDragArea ? prefix(\"area\", \"pass\") : prefix(\"area\");\r\n        if (groupable) {\r\n            return [\r\n                React.createElement(\"div\", { key: \"area\", ref: ref(moveable, \"areaElement\"), className: className }),\r\n                renderPieces(React),\r\n            ];\r\n        }\r\n        if (!target || !dragArea) {\r\n            return [];\r\n        }\r\n        var h = createWarpMatrix([0, 0], [width, 0], [0, height], [width, height], renderPoses[0], renderPoses[1], renderPoses[2], renderPoses[3]);\r\n        var transform = h.length ? makeMatrixCSS(h, true) : \"none\";\r\n        return [\r\n            React.createElement(\"div\", { key: \"area\", ref: ref(moveable, \"areaElement\"), className: className, style: {\r\n                    top: \"0px\",\r\n                    left: \"0px\",\r\n                    width: \"\".concat(width, \"px\"),\r\n                    height: \"\".concat(height, \"px\"),\r\n                    transformOrigin: \"0 0\",\r\n                    transform: transform,\r\n                } }),\r\n            renderPieces(React),\r\n        ];\r\n    },\r\n    dragStart: function (moveable, _a) {\r\n        var datas = _a.datas, clientX = _a.clientX, clientY = _a.clientY, inputEvent = _a.inputEvent;\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        datas.isDragArea = false;\r\n        var areaElement = moveable.areaElement;\r\n        var state = moveable.state;\r\n        var moveableClientRect = state.moveableClientRect, renderPoses = state.renderPoses, rootMatrix = state.rootMatrix, is3d = state.is3d;\r\n        var left = moveableClientRect.left, top = moveableClientRect.top;\r\n        var _b = getRect(renderPoses), relativeLeft = _b.left, relativeTop = _b.top, width = _b.width, height = _b.height;\r\n        var n = is3d ? 4 : 3;\r\n        var _c = __read(calculateInversePosition(rootMatrix, [clientX - left, clientY - top], n), 2), posX = _c[0], posY = _c[1];\r\n        posX -= relativeLeft;\r\n        posY -= relativeTop;\r\n        var rects = [\r\n            { left: relativeLeft, top: relativeTop, width: width, height: posY - 10 },\r\n            { left: relativeLeft, top: relativeTop, width: posX - 10, height: height },\r\n            { left: relativeLeft, top: relativeTop + posY + 10, width: width, height: height - posY - 10 },\r\n            { left: relativeLeft + posX + 10, top: relativeTop, width: width - posX - 10, height: height },\r\n        ];\r\n        var children = [].slice.call(areaElement.nextElementSibling.children);\r\n        rects.forEach(function (rect, i) {\r\n            children[i].style.cssText\r\n                = \"left: \".concat(rect.left, \"px;top: \").concat(rect.top, \"px; width: \").concat(rect.width, \"px; height: \").concat(rect.height, \"px;\");\r\n        });\r\n        addClass(areaElement, AVOID);\r\n        state.disableNativeEvent = true;\r\n        return;\r\n    },\r\n    drag: function (moveable, _a) {\r\n        var datas = _a.datas, inputEvent = _a.inputEvent;\r\n        this.enableNativeEvent(moveable);\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        if (!datas.isDragArea) {\r\n            datas.isDragArea = true;\r\n            restoreStyle(moveable);\r\n        }\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        this.enableNativeEvent(moveable);\r\n        var inputEvent = e.inputEvent, datas = e.datas;\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        if (!datas.isDragArea) {\r\n            restoreStyle(moveable);\r\n        }\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    unset: function (moveable) {\r\n        restoreStyle(moveable);\r\n        moveable.state.disableNativeEvent = false;\r\n    },\r\n    enableNativeEvent: function (moveable) {\r\n        var state = moveable.state;\r\n        if (state.disableNativeEvent) {\r\n            requestAnimationFrame(function () {\r\n                state.disableNativeEvent = false;\r\n            });\r\n        }\r\n    },\r\n};\r\n/**\r\n * Add an event to the moveable area instead of the target for stopPropagation. (default: false, true in group)\r\n * @name Moveable#dragArea\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  dragArea: false,\r\n * });\r\n */\r\n/**\r\n * Set `pointerEvents: none;` css to pass events in dragArea. (default: false)\r\n * @name Moveable#passDragArea\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  dragArea: false,\r\n * });\r\n */\n\nvar Origin = makeAble(\"origin\", {\r\n    props: [\"origin\", \"svgOrigin\"],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, zoom = _a.zoom, svgOrigin = _a.svgOrigin, groupable = _a.groupable;\r\n        var _b = moveable.getState(), beforeOrigin = _b.beforeOrigin, rotation = _b.rotation, svg = _b.svg, allMatrix = _b.allMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight;\r\n        var originStyle;\r\n        if (!groupable && svg && svgOrigin) {\r\n            var _c = __read(convertTransformOriginArray(svgOrigin, offsetWidth, offsetHeight), 2), originX = _c[0], originY = _c[1];\r\n            var n = is3d ? 4 : 3;\r\n            var result = calculatePosition(allMatrix, [originX, originY], n);\r\n            originStyle = getControlTransform(rotation, zoom, minus(result, [left, top]));\r\n        }\r\n        else {\r\n            originStyle = getControlTransform(rotation, zoom, beforeOrigin);\r\n        }\r\n        return [\r\n            React.createElement(\"div\", { className: prefix(\"control\", \"origin\"), style: originStyle, key: \"beforeOrigin\" }),\r\n        ];\r\n    },\r\n});\r\n/**\r\n * Whether or not the origin controlbox will be visible or not (default: true)\r\n * @name Moveable#origin\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.origin = true;\r\n */\n\nfunction getDefaultScrollPosition(e) {\r\n    var scrollContainer = e.scrollContainer;\r\n    return [\r\n        scrollContainer.scrollLeft,\r\n        scrollContainer.scrollTop,\r\n    ];\r\n}\r\n/**\r\n * @namespace Moveable.Scrollable\r\n * @description Whether or not target can be scrolled to the scroll container (default: false)\r\n */\r\nvar Scrollable = {\r\n    name: \"scrollable\",\r\n    canPinch: true,\r\n    props: [\r\n        \"scrollable\",\r\n        \"scrollContainer\",\r\n        \"scrollThreshold\",\r\n        \"scrollThrottleTime\",\r\n        \"getScrollPosition\",\r\n        \"scrollOptions\",\r\n    ],\r\n    events: [\r\n        \"scroll\",\r\n        \"scrollGroup\",\r\n    ],\r\n    dragRelation: \"strong\",\r\n    dragStart: function (moveable, e) {\r\n        var props = moveable.props;\r\n        var _a = props.scrollContainer, scrollContainer = _a === void 0 ? moveable.getContainer() : _a, scrollOptions = props.scrollOptions;\r\n        var dragScroll = new DragScroll();\r\n        var scrollContainerElement = getRefTarget(scrollContainer, true);\r\n        e.datas.dragScroll = dragScroll;\r\n        moveable.state.dragScroll = dragScroll;\r\n        var gestoName = e.isControl ? \"controlGesto\" : \"targetGesto\";\r\n        var targets = e.targets;\r\n        dragScroll.on(\"scroll\", function (_a) {\r\n            var container = _a.container, direction = _a.direction;\r\n            var params = fillParams(moveable, e, {\r\n                scrollContainer: container,\r\n                direction: direction,\r\n            });\r\n            var eventName = targets ? \"onScrollGroup\" : \"onScroll\";\r\n            if (targets) {\r\n                params.targets = targets;\r\n            }\r\n            triggerEvent(moveable, eventName, params);\r\n        }).on(\"move\", function (_a) {\r\n            var offsetX = _a.offsetX, offsetY = _a.offsetY, inputEvent = _a.inputEvent;\r\n            moveable[gestoName].scrollBy(offsetX, offsetY, inputEvent.inputEvent, false);\r\n        }).on(\"scrollDrag\", function (_a) {\r\n            var next = _a.next;\r\n            next(moveable[gestoName].getCurrentEvent());\r\n        });\r\n        dragScroll.dragStart(e, __assign({ container: scrollContainerElement }, scrollOptions));\r\n    },\r\n    checkScroll: function (moveable, e) {\r\n        var dragScroll = e.datas.dragScroll;\r\n        if (!dragScroll) {\r\n            return;\r\n        }\r\n        var _a = moveable.props, _b = _a.scrollContainer, scrollContainer = _b === void 0 ? moveable.getContainer() : _b, _c = _a.scrollThreshold, scrollThreshold = _c === void 0 ? 0 : _c, _d = _a.scrollThrottleTime, scrollThrottleTime = _d === void 0 ? 0 : _d, _e = _a.getScrollPosition, getScrollPosition = _e === void 0 ? getDefaultScrollPosition : _e, scrollOptions = _a.scrollOptions;\r\n        dragScroll.drag(e, __assign({ container: scrollContainer, threshold: scrollThreshold, throttleTime: scrollThrottleTime, getScrollPosition: function (ev) {\r\n                return getScrollPosition({ scrollContainer: ev.container, direction: ev.direction });\r\n            } }, scrollOptions));\r\n        return true;\r\n    },\r\n    drag: function (moveable, e) {\r\n        return this.checkScroll(moveable, e);\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        e.datas.dragScroll.dragEnd();\r\n        e.datas.dragScroll = null;\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { isControl: true }));\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return this.drag(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets, isControl: true }));\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.drag(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupControEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    unset: function (moveable) {\r\n        var _a;\r\n        var state = moveable.state;\r\n        (_a = state.dragScroll) === null || _a === void 0 ? void 0 : _a.dragEnd();\r\n        state.dragScroll = null;\r\n    },\r\n};\r\n/**\r\n * When the drag cursor leaves the scrollContainer, the `scroll` event occur to scroll.\r\n * @memberof Moveable.Scrollable\r\n * @event scroll\r\n * @param {Moveable.Scrollable.OnScroll} - Parameters for the `scroll` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"scroll\", ({ scrollContainer, direction }) => {\r\n *   scrollContainer.scrollLeft += direction[0] * 10;\r\n *   scrollContainer.scrollTop += direction[1] * 10;\r\n * });\r\n */\r\n/**\r\n * When the drag cursor leaves the scrollContainer, the `scrollGroup` event occur to scroll in group.\r\n * @memberof Moveable.Scrollable\r\n * @event scrollGroup\r\n * @param {Moveable.Scrollable.OnScrollGroup} - Parameters for the `scrollGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"scroll\", ({ scrollContainer, direction }) => {\r\n *   scrollContainer.scrollLeft += direction[0] * 10;\r\n *   scrollContainer.scrollTop += direction[1] * 10;\r\n * });\r\n */\n\nvar Default = {\r\n    name: \"\",\r\n    props: [\r\n        \"target\",\r\n        \"dragTargetSelf\",\r\n        \"dragTarget\",\r\n        \"dragContainer\",\r\n        \"container\",\r\n        \"warpSelf\",\r\n        \"rootContainer\",\r\n        \"useResizeObserver\",\r\n        \"useMutationObserver\",\r\n        \"zoom\",\r\n        \"dragFocusedInput\",\r\n        \"transformOrigin\",\r\n        \"ables\",\r\n        \"className\",\r\n        \"pinchThreshold\",\r\n        \"pinchOutside\",\r\n        \"triggerAblesSimultaneously\",\r\n        \"checkInput\",\r\n        \"cspNonce\",\r\n        \"translateZ\",\r\n        \"hideDefaultLines\",\r\n        \"props\",\r\n        \"flushSync\",\r\n        \"stopPropagation\",\r\n        \"preventClickEventOnDrag\",\r\n        \"preventClickDefault\",\r\n        \"viewContainer\",\r\n        \"persistData\",\r\n        \"useAccuratePosition\",\r\n        \"firstRenderState\",\r\n        \"linePadding\",\r\n        \"controlPadding\",\r\n        \"preventDefault\",\r\n        \"preventRightClick\",\r\n        \"preventWheelClick\",\r\n        \"requestStyles\",\r\n    ],\r\n    events: [\r\n        \"changeTargets\",\r\n    ],\r\n};\n\nvar Padding = makeAble(\"padding\", {\r\n    props: [\"padding\"],\r\n    render: function (moveable, React) {\r\n        var props = moveable.props;\r\n        if (props.dragArea) {\r\n            return [];\r\n        }\r\n        var _a = getPaddingBox(props.padding || {}), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n        var _b = moveable.getState(), renderPoses = _b.renderPoses, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4;\r\n        var poses = [pos1, pos2, pos3, pos4];\r\n        var paddingDirections = [];\r\n        if (left > 0) {\r\n            paddingDirections.push([0, 2]);\r\n        }\r\n        if (top > 0) {\r\n            paddingDirections.push([0, 1]);\r\n        }\r\n        if (right > 0) {\r\n            paddingDirections.push([1, 3]);\r\n        }\r\n        if (bottom > 0) {\r\n            paddingDirections.push([2, 3]);\r\n        }\r\n        return paddingDirections.map(function (_a, i) {\r\n            var _b = __read(_a, 2), dir1 = _b[0], dir2 = _b[1];\r\n            var paddingPos1 = poses[dir1];\r\n            var paddingPos2 = poses[dir2];\r\n            var paddingPos3 = renderPoses[dir1];\r\n            var paddingPos4 = renderPoses[dir2];\r\n            var h = createWarpMatrix([0, 0], [100, 0], [0, 100], [100, 100], paddingPos1, paddingPos2, paddingPos3, paddingPos4);\r\n            if (!h.length) {\r\n                return undefined;\r\n            }\r\n            return (React.createElement(\"div\", { key: \"padding\".concat(i), className: prefix(\"padding\"), style: {\r\n                    transform: makeMatrixCSS(h, true),\r\n                } }));\r\n        });\r\n    },\r\n});\r\n/**\r\n * Add padding around the target to increase the drag area.\r\n * @name Moveable#padding\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  target: document.querySelector(\".target\"),\r\n *  padding: { left: 0, top: 0, right: 0, bottom: 0 },\r\n * });\r\n * moveable.padding = { left: 10, top: 10, right: 10, bottom: 10 },\r\n * moveable.updateRect();\r\n */\n\nvar RADIUS_DIRECTIONS = [\"nw\", \"ne\", \"se\", \"sw\"];\r\nfunction calculateRatio(values, size) {\r\n    var sumSize = values[0] + values[1];\r\n    var sumRatio = sumSize > size ? size / sumSize : 1;\r\n    values[0] *= sumRatio;\r\n    values[1] = size - values[1] * sumRatio;\r\n    return values;\r\n}\r\nvar HORIZONTAL_RADIUS_ORDER = [1, 2, 5, 6];\r\nvar VERTICAL_RADIUS_ORDER = [0, 3, 4, 7];\r\nvar HORIZONTAL_RADIUS_DIRECTIONS = [1, -1, -1, 1];\r\nvar VERTICAL_RADIUS_DIRECTIONS = [1, 1, -1, -1];\r\nfunction getRadiusStyles(nextPoses, isRelative, width, height, left, top, right, bottom) {\r\n    if (left === void 0) { left = 0; }\r\n    if (top === void 0) { top = 0; }\r\n    if (right === void 0) { right = width; }\r\n    if (bottom === void 0) { bottom = height; }\r\n    var clipStyles = [];\r\n    var isVertical = false;\r\n    var radiusPoses = nextPoses.filter(function (pos) { return !pos.virtual; });\r\n    var raws = radiusPoses.map(function (posInfo) {\r\n        var horizontal = posInfo.horizontal, vertical = posInfo.vertical, pos = posInfo.pos;\r\n        if (vertical && !isVertical) {\r\n            isVertical = true;\r\n            clipStyles.push(\"/\");\r\n        }\r\n        if (isVertical) {\r\n            var rawPos = Math.max(0, vertical === 1 ? pos[1] - top : bottom - pos[1]);\r\n            clipStyles.push(convertCSSSize(rawPos, height, isRelative));\r\n            return rawPos;\r\n        }\r\n        else {\r\n            var rawPos = Math.max(0, horizontal === 1 ? pos[0] - left : right - pos[0]);\r\n            clipStyles.push(convertCSSSize(rawPos, width, isRelative));\r\n            return rawPos;\r\n        }\r\n    });\r\n    return {\r\n        radiusPoses: radiusPoses,\r\n        styles: clipStyles,\r\n        raws: raws,\r\n    };\r\n}\r\nfunction getRadiusRange(controlPoses) {\r\n    // [start, length]\r\n    var horizontalRange = [0, 0];\r\n    var verticalRange = [0, 0];\r\n    var length = controlPoses.length;\r\n    for (var i = 0; i < length; ++i) {\r\n        var clipPose = controlPoses[i];\r\n        if (!clipPose.sub) {\r\n            continue;\r\n        }\r\n        if (clipPose.horizontal) {\r\n            if (horizontalRange[1] === 0) {\r\n                horizontalRange[0] = i;\r\n            }\r\n            horizontalRange[1] = i - horizontalRange[0] + 1;\r\n            verticalRange[0] = i + 1;\r\n        }\r\n        if (clipPose.vertical) {\r\n            if (verticalRange[1] === 0) {\r\n                verticalRange[0] = i;\r\n            }\r\n            verticalRange[1] = i - verticalRange[0] + 1;\r\n        }\r\n    }\r\n    return {\r\n        horizontalRange: horizontalRange,\r\n        verticalRange: verticalRange,\r\n    };\r\n}\r\nfunction getRadiusValues(values, width, height, left, top, minCounts, full) {\r\n    var _a, _b, _c, _d;\r\n    if (minCounts === void 0) { minCounts = [0, 0]; }\r\n    if (full === void 0) { full = false; }\r\n    var splitIndex = values.indexOf(\"/\");\r\n    var splitLength = (splitIndex > -1 ? values.slice(0, splitIndex) : values).length;\r\n    var horizontalValues = values.slice(0, splitLength);\r\n    var verticalValues = values.slice(splitLength + 1);\r\n    var horizontalValuesLength = horizontalValues.length;\r\n    var verticalValuesLength = verticalValues.length;\r\n    var hasVerticalValues = verticalValuesLength > 0;\r\n    var _e = __read(horizontalValues, 4), _f = _e[0], nwValue = _f === void 0 ? \"0px\" : _f, _g = _e[1], neValue = _g === void 0 ? nwValue : _g, _h = _e[2], seValue = _h === void 0 ? nwValue : _h, _j = _e[3], swValue = _j === void 0 ? neValue : _j;\r\n    var _k = __read(verticalValues, 4), _l = _k[0], wnValue = _l === void 0 ? nwValue : _l, _m = _k[1], enValue = _m === void 0 ? hasVerticalValues ? wnValue : neValue : _m, _o = _k[2], esValue = _o === void 0 ? hasVerticalValues ? wnValue : seValue : _o, _p = _k[3], wsValue = _p === void 0 ? hasVerticalValues ? enValue : swValue : _p;\r\n    var horizontalRawPoses = [nwValue, neValue, seValue, swValue].map(function (pos) { return convertUnitSize(pos, width); });\r\n    var verticalRawPoses = [wnValue, enValue, esValue, wsValue].map(function (pos) { return convertUnitSize(pos, height); });\r\n    var horizontalPoses = horizontalRawPoses.slice();\r\n    var verticalPoses = verticalRawPoses.slice();\r\n    _a = __read(calculateRatio([horizontalPoses[0], horizontalPoses[1]], width), 2), horizontalPoses[0] = _a[0], horizontalPoses[1] = _a[1];\r\n    _b = __read(calculateRatio([horizontalPoses[3], horizontalPoses[2]], width), 2), horizontalPoses[3] = _b[0], horizontalPoses[2] = _b[1];\r\n    _c = __read(calculateRatio([verticalPoses[0], verticalPoses[3]], height), 2), verticalPoses[0] = _c[0], verticalPoses[3] = _c[1];\r\n    _d = __read(calculateRatio([verticalPoses[1], verticalPoses[2]], height), 2), verticalPoses[1] = _d[0], verticalPoses[2] = _d[1];\r\n    var nextHorizontalPoses = full\r\n        ? horizontalPoses\r\n        : horizontalPoses.slice(0, Math.max(minCounts[0], horizontalValuesLength));\r\n    var nextVerticalPoses = full\r\n        ? verticalPoses\r\n        : verticalPoses.slice(0, Math.max(minCounts[1], verticalValuesLength));\r\n    return __spreadArray(__spreadArray([], __read(nextHorizontalPoses.map(function (pos, i) {\r\n        var direction = RADIUS_DIRECTIONS[i];\r\n        return {\r\n            virtual: i >= horizontalValuesLength,\r\n            horizontal: HORIZONTAL_RADIUS_DIRECTIONS[i],\r\n            vertical: 0,\r\n            pos: [left + pos, top + (VERTICAL_RADIUS_DIRECTIONS[i] === -1 ? height : 0)],\r\n            sub: true,\r\n            raw: horizontalRawPoses[i],\r\n            direction: direction,\r\n        };\r\n    })), false), __read(nextVerticalPoses.map(function (pos, i) {\r\n        var direction = RADIUS_DIRECTIONS[i];\r\n        return {\r\n            virtual: i >= verticalValuesLength,\r\n            horizontal: 0,\r\n            vertical: VERTICAL_RADIUS_DIRECTIONS[i],\r\n            pos: [left + (HORIZONTAL_RADIUS_DIRECTIONS[i] === -1 ? width : 0), top + pos],\r\n            sub: true,\r\n            raw: verticalRawPoses[i],\r\n            direction: direction,\r\n        };\r\n    })), false);\r\n}\r\nfunction removeRadiusPos(controlPoses, poses, index, startIndex, length) {\r\n    if (length === void 0) { length = poses.length; }\r\n    var _a = getRadiusRange(controlPoses.slice(startIndex)), horizontalRange = _a.horizontalRange, verticalRange = _a.verticalRange;\r\n    var radiuslIndex = index - startIndex;\r\n    var deleteCount = 0;\r\n    if (radiuslIndex === 0) {\r\n        deleteCount = length;\r\n    }\r\n    else if (radiuslIndex > 0 && radiuslIndex < horizontalRange[1]) {\r\n        deleteCount = horizontalRange[1] - radiuslIndex;\r\n    }\r\n    else if (radiuslIndex >= verticalRange[0]) {\r\n        deleteCount = verticalRange[0] + verticalRange[1] - radiuslIndex;\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    controlPoses.splice(index, deleteCount);\r\n    poses.splice(index, deleteCount);\r\n}\r\nfunction addRadiusPos(controlPoses, poses, startIndex, horizontalIndex, verticalIndex, distX, distY, right, bottom, left, top) {\r\n    if (left === void 0) { left = 0; }\r\n    if (top === void 0) { top = 0; }\r\n    var _a = getRadiusRange(controlPoses.slice(startIndex)), horizontalRange = _a.horizontalRange, verticalRange = _a.verticalRange;\r\n    if (horizontalIndex > -1) {\r\n        var radiusX = HORIZONTAL_RADIUS_DIRECTIONS[horizontalIndex] === 1\r\n            ? distX - left\r\n            : right - distX;\r\n        for (var i = horizontalRange[1]; i <= horizontalIndex; ++i) {\r\n            var y = VERTICAL_RADIUS_DIRECTIONS[i] === 1 ? top : bottom;\r\n            var x = 0;\r\n            if (horizontalIndex === i) {\r\n                x = distX;\r\n            }\r\n            else if (i === 0) {\r\n                x = left + radiusX;\r\n            }\r\n            else if (HORIZONTAL_RADIUS_DIRECTIONS[i] === -1) {\r\n                x = right - (poses[startIndex][0] - left);\r\n            }\r\n            controlPoses.splice(startIndex + i, 0, {\r\n                horizontal: HORIZONTAL_RADIUS_DIRECTIONS[i],\r\n                vertical: 0,\r\n                pos: [x, y],\r\n            });\r\n            poses.splice(startIndex + i, 0, [x, y]);\r\n            if (i === 0) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    else if (verticalIndex > -1) {\r\n        var radiusY = VERTICAL_RADIUS_DIRECTIONS[verticalIndex] === 1\r\n            ? distY - top\r\n            : bottom - distY;\r\n        if (horizontalRange[1] === 0 && verticalRange[1] === 0) {\r\n            var pos = [\r\n                left + radiusY,\r\n                top,\r\n            ];\r\n            controlPoses.push({\r\n                horizontal: HORIZONTAL_RADIUS_DIRECTIONS[0],\r\n                vertical: 0,\r\n                pos: pos,\r\n            });\r\n            poses.push(pos);\r\n        }\r\n        var startVerticalIndex = verticalRange[0];\r\n        for (var i = verticalRange[1]; i <= verticalIndex; ++i) {\r\n            var x = HORIZONTAL_RADIUS_DIRECTIONS[i] === 1 ? left : right;\r\n            var y = 0;\r\n            if (verticalIndex === i) {\r\n                y = distY;\r\n            }\r\n            else if (i === 0) {\r\n                y = top + radiusY;\r\n            }\r\n            else if (VERTICAL_RADIUS_DIRECTIONS[i] === 1) {\r\n                y = poses[startIndex + startVerticalIndex][1];\r\n            }\r\n            else if (VERTICAL_RADIUS_DIRECTIONS[i] === -1) {\r\n                y = bottom - (poses[startIndex + startVerticalIndex][1] - top);\r\n            }\r\n            controlPoses.push({\r\n                horizontal: 0,\r\n                vertical: VERTICAL_RADIUS_DIRECTIONS[i],\r\n                pos: [x, y],\r\n            });\r\n            poses.push([x, y]);\r\n            if (i === 0) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction splitRadiusPoses(controlPoses, raws) {\r\n    if (raws === void 0) { raws = controlPoses.map(function (pos) { return pos.raw; }); }\r\n    var horizontals = controlPoses\r\n        .map(function (pos, i) { return pos.horizontal ? raws[i] : null; }).filter(function (pos) { return pos != null; });\r\n    var verticals = controlPoses\r\n        .map(function (pos, i) { return pos.vertical ? raws[i] : null; }).filter(function (pos) { return pos != null; });\r\n    return {\r\n        horizontals: horizontals,\r\n        verticals: verticals,\r\n    };\r\n}\n\nvar CLIP_DIRECTIONS = [\r\n    [0, -1, \"n\"],\r\n    [1, 0, \"e\"],\r\n];\r\nvar CLIP_RECT_DIRECTIONS = [\r\n    [-1, -1, \"nw\"],\r\n    [0, -1, \"n\"],\r\n    [1, -1, \"ne\"],\r\n    [1, 0, \"e\"],\r\n    [1, 1, \"se\"],\r\n    [0, 1, \"s\"],\r\n    [-1, 1, \"sw\"],\r\n    [-1, 0, \"w\"],\r\n];\r\n// 1 2 5 6 0 3 4 7\r\n// 0 1 2 3 4 5 6 7\r\nfunction getClipStyles(moveable, clipPath, poses) {\r\n    var clipRelative = moveable.props.clipRelative;\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    var _b = clipPath, clipType = _b.type, clipPoses = _b.poses;\r\n    var isRect = clipType === \"rect\";\r\n    var isCircle = clipType === \"circle\";\r\n    if (clipType === \"polygon\") {\r\n        return poses.map(function (pos) { return \"\".concat(convertCSSSize(pos[0], width, clipRelative), \" \").concat(convertCSSSize(pos[1], height, clipRelative)); });\r\n    }\r\n    else if (isRect || clipType === \"inset\") {\r\n        var top_1 = poses[1][1];\r\n        var right = poses[3][0];\r\n        var left = poses[7][0];\r\n        var bottom = poses[5][1];\r\n        if (isRect) {\r\n            return [\r\n                top_1,\r\n                right,\r\n                bottom,\r\n                left,\r\n            ].map(function (pos) { return \"\".concat(pos, \"px\"); });\r\n        }\r\n        var clipStyles = [top_1, width - right, height - bottom, left]\r\n            .map(function (pos, i) { return convertCSSSize(pos, i % 2 ? width : height, clipRelative); });\r\n        if (poses.length > 8) {\r\n            var _c = __read(minus(poses[4], poses[0]), 2), subWidth = _c[0], subHeight = _c[1];\r\n            clipStyles.push.apply(clipStyles, __spreadArray([\"round\"], __read(getRadiusStyles(clipPoses.slice(8).map(function (info, i) {\r\n                return __assign(__assign({}, info), { pos: poses[i] });\r\n            }), clipRelative, subWidth, subHeight, left, top_1, right, bottom).styles), false));\r\n        }\r\n        return clipStyles;\r\n    }\r\n    else if (isCircle || clipType === \"ellipse\") {\r\n        var center = poses[0];\r\n        var ry = convertCSSSize(abs(poses[1][1] - center[1]), isCircle ? Math.sqrt((width * width + height * height) / 2) : height, clipRelative);\r\n        var clipStyles = isCircle ? [ry]\r\n            : [convertCSSSize(abs(poses[2][0] - center[0]), width, clipRelative), ry];\r\n        clipStyles.push(\"at\", convertCSSSize(center[0], width, clipRelative), convertCSSSize(center[1], height, clipRelative));\r\n        return clipStyles;\r\n    }\r\n}\r\nfunction getRectPoses(top, right, bottom, left) {\r\n    var xs = [left, (left + right) / 2, right];\r\n    var ys = [top, (top + bottom) / 2, bottom];\r\n    return CLIP_RECT_DIRECTIONS.map(function (_a) {\r\n        var _b = __read(_a, 3), dirx = _b[0], diry = _b[1], dir = _b[2];\r\n        var x = xs[dirx + 1];\r\n        var y = ys[diry + 1];\r\n        return {\r\n            vertical: abs(diry),\r\n            horizontal: abs(dirx),\r\n            direction: dir,\r\n            pos: [x, y],\r\n        };\r\n    });\r\n}\r\nfunction getControlSize(controlPoses) {\r\n    var xRange = [Infinity, -Infinity];\r\n    var yRange = [Infinity, -Infinity];\r\n    controlPoses.forEach(function (_a) {\r\n        var pos = _a.pos;\r\n        xRange[0] = Math.min(xRange[0], pos[0]);\r\n        xRange[1] = Math.max(xRange[1], pos[0]);\r\n        yRange[0] = Math.min(yRange[0], pos[1]);\r\n        yRange[1] = Math.max(yRange[1], pos[1]);\r\n    });\r\n    return [\r\n        abs(xRange[1] - xRange[0]),\r\n        abs(yRange[1] - yRange[0]),\r\n    ];\r\n}\r\nfunction getClipPath(target, width, height, defaultClip, customClip) {\r\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n    if (!target) {\r\n        return;\r\n    }\r\n    var clipText = customClip;\r\n    if (!clipText) {\r\n        var getStyle = getCachedStyle(target);\r\n        var clipPath = getStyle(\"clipPath\");\r\n        clipText = clipPath !== \"none\" ? clipPath : getStyle(\"clip\");\r\n    }\r\n    if (!clipText || clipText === \"none\" || clipText === \"auto\") {\r\n        clipText = defaultClip;\r\n        if (!clipText) {\r\n            return;\r\n        }\r\n    }\r\n    var _k = splitBracket(clipText), _l = _k.prefix, clipPrefix = _l === void 0 ? clipText : _l, _m = _k.value, value = _m === void 0 ? \"\" : _m;\r\n    var isCircle = clipPrefix === \"circle\";\r\n    var splitter = \" \";\r\n    if (clipPrefix === \"polygon\") {\r\n        var values = splitComma(value || \"0% 0%, 100% 0%, 100% 100%, 0% 100%\");\r\n        splitter = \",\";\r\n        var poses = values.map(function (pos) {\r\n            var _a = __read(pos.split(\" \"), 2), xPos = _a[0], yPos = _a[1];\r\n            return {\r\n                vertical: 1,\r\n                horizontal: 1,\r\n                pos: [\r\n                    convertUnitSize(xPos, width),\r\n                    convertUnitSize(yPos, height),\r\n                ],\r\n            };\r\n        });\r\n        var minMaxs = getMinMaxs(poses.map(function (pos) { return pos.pos; }));\r\n        return {\r\n            type: clipPrefix,\r\n            clipText: clipText,\r\n            poses: poses,\r\n            splitter: splitter,\r\n            left: minMaxs.minX,\r\n            right: minMaxs.maxX,\r\n            top: minMaxs.minY,\r\n            bottom: minMaxs.maxY,\r\n        };\r\n    }\r\n    else if (isCircle || clipPrefix === \"ellipse\") {\r\n        var xPos = \"\";\r\n        var yPos = \"\";\r\n        var radiusX_1 = 0;\r\n        var radiusY_1 = 0;\r\n        var values = splitSpace(value);\r\n        if (isCircle) {\r\n            var radius = \"\";\r\n            _a = __read(values, 4), _b = _a[0], radius = _b === void 0 ? \"50%\" : _b, _c = _a[2], xPos = _c === void 0 ? \"50%\" : _c, _d = _a[3], yPos = _d === void 0 ? \"50%\" : _d;\r\n            radiusX_1 = convertUnitSize(radius, Math.sqrt((width * width + height * height) / 2));\r\n            radiusY_1 = radiusX_1;\r\n        }\r\n        else {\r\n            var xRadius = \"\";\r\n            var yRadius = \"\";\r\n            _e = __read(values, 5), _f = _e[0], xRadius = _f === void 0 ? \"50%\" : _f, _g = _e[1], yRadius = _g === void 0 ? \"50%\" : _g, _h = _e[3], xPos = _h === void 0 ? \"50%\" : _h, _j = _e[4], yPos = _j === void 0 ? \"50%\" : _j;\r\n            radiusX_1 = convertUnitSize(xRadius, width);\r\n            radiusY_1 = convertUnitSize(yRadius, height);\r\n        }\r\n        var centerPos_1 = [\r\n            convertUnitSize(xPos, width),\r\n            convertUnitSize(yPos, height),\r\n        ];\r\n        var poses = __spreadArray([\r\n            {\r\n                vertical: 1,\r\n                horizontal: 1,\r\n                pos: centerPos_1,\r\n                direction: \"nesw\",\r\n            }\r\n        ], __read(CLIP_DIRECTIONS.slice(0, isCircle ? 1 : 2).map(function (dir) { return ({\r\n            vertical: abs(dir[1]),\r\n            horizontal: dir[0],\r\n            direction: dir[2],\r\n            sub: true,\r\n            pos: [\r\n                centerPos_1[0] + dir[0] * radiusX_1,\r\n                centerPos_1[1] + dir[1] * radiusY_1,\r\n            ],\r\n        }); })), false);\r\n        return {\r\n            type: clipPrefix,\r\n            clipText: clipText,\r\n            radiusX: radiusX_1,\r\n            radiusY: radiusY_1,\r\n            left: centerPos_1[0] - radiusX_1,\r\n            top: centerPos_1[1] - radiusY_1,\r\n            right: centerPos_1[0] + radiusX_1,\r\n            bottom: centerPos_1[1] + radiusY_1,\r\n            poses: poses,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    else if (clipPrefix === \"inset\") {\r\n        var values = splitSpace(value || \"0 0 0 0\");\r\n        var roundIndex = values.indexOf(\"round\");\r\n        var rectLength = (roundIndex > -1 ? values.slice(0, roundIndex) : values).length;\r\n        var radiusValues = values.slice(rectLength + 1);\r\n        var _o = __read(values.slice(0, rectLength), 4), topValue = _o[0], _p = _o[1], rightValue = _p === void 0 ? topValue : _p, _q = _o[2], bottomValue = _q === void 0 ? topValue : _q, _r = _o[3], leftValue = _r === void 0 ? rightValue : _r;\r\n        var _s = __read([topValue, bottomValue].map(function (pos) { return convertUnitSize(pos, height); }), 2), top_2 = _s[0], bottom = _s[1];\r\n        var _t = __read([leftValue, rightValue].map(function (pos) { return convertUnitSize(pos, width); }), 2), left = _t[0], right = _t[1];\r\n        var nextRight = width - right;\r\n        var nextBottom = height - bottom;\r\n        var radiusPoses = getRadiusValues(radiusValues, nextRight - left, nextBottom - top_2, left, top_2);\r\n        var poses = __spreadArray(__spreadArray([], __read(getRectPoses(top_2, nextRight, nextBottom, left)), false), __read(radiusPoses), false);\r\n        return {\r\n            type: \"inset\",\r\n            clipText: clipText,\r\n            poses: poses,\r\n            top: top_2,\r\n            left: left,\r\n            right: nextRight,\r\n            bottom: nextBottom,\r\n            radius: radiusValues,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    else if (clipPrefix === \"rect\") {\r\n        // top right bottom left\r\n        var values = splitComma(value || \"0px, \".concat(width, \"px, \").concat(height, \"px, 0px\"));\r\n        splitter = \",\";\r\n        var _u = __read(values.map(function (pos) {\r\n            var posValue = splitUnit(pos).value;\r\n            return posValue;\r\n        }), 4), top_3 = _u[0], right = _u[1], bottom = _u[2], left = _u[3];\r\n        var poses = getRectPoses(top_3, right, bottom, left);\r\n        return {\r\n            type: \"rect\",\r\n            clipText: clipText,\r\n            poses: poses,\r\n            top: top_3,\r\n            right: right,\r\n            bottom: bottom,\r\n            left: left,\r\n            values: values,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    return;\r\n}\n\nfunction moveControlPos(controlPoses, index, dist, isRect, keepRatio) {\r\n    var _a = controlPoses[index], direction = _a.direction, sub = _a.sub;\r\n    var dists = controlPoses.map(function () { return [0, 0]; });\r\n    var directions = direction ? direction.split(\"\") : [];\r\n    if (isRect && index < 8) {\r\n        var verticalDirections = directions.filter(function (dir) { return dir === \"w\" || dir === \"e\"; });\r\n        var horizontalDirections = directions.filter(function (dir) { return dir === \"n\" || dir === \"s\"; });\r\n        var verticalDirection_1 = verticalDirections[0];\r\n        var horizontalDirection_1 = horizontalDirections[0];\r\n        dists[index] = dist;\r\n        var _b = __read(getControlSize(controlPoses), 2), width = _b[0], height = _b[1];\r\n        var ratio = width && height ? width / height : 0;\r\n        if (ratio && keepRatio) {\r\n            // 0 1 2\r\n            // 7   3\r\n            // 6 5 4\r\n            var fixedIndex = (index + 4) % 8;\r\n            var fixedPosition = controlPoses[fixedIndex].pos;\r\n            var sizeDirection = [0, 0];\r\n            if (direction.indexOf(\"w\") > -1) {\r\n                sizeDirection[0] = -1;\r\n            }\r\n            else if (direction.indexOf(\"e\") > -1) {\r\n                sizeDirection[0] = 1;\r\n            }\r\n            if (direction.indexOf(\"n\") > -1) {\r\n                sizeDirection[1] = -1;\r\n            }\r\n            else if (direction.indexOf(\"s\") > -1) {\r\n                sizeDirection[1] = 1;\r\n            }\r\n            var nextDist = getSizeDistByDist([width, height], dist, ratio, sizeDirection, true);\r\n            var nextWidth = width + nextDist[0];\r\n            var nextHeight = height + nextDist[1];\r\n            var top_1 = fixedPosition[1];\r\n            var bottom = fixedPosition[1];\r\n            var left = fixedPosition[0];\r\n            var right = fixedPosition[0];\r\n            if (sizeDirection[0] === -1) {\r\n                left = right - nextWidth;\r\n            }\r\n            else if (sizeDirection[0] === 1) {\r\n                right = left + nextWidth;\r\n            }\r\n            else {\r\n                left = left - nextWidth / 2;\r\n                right = right + nextWidth / 2;\r\n            }\r\n            if (sizeDirection[1] === -1) {\r\n                top_1 = bottom - nextHeight;\r\n            }\r\n            else if (sizeDirection[1] === 1) {\r\n                bottom = top_1 + nextHeight;\r\n            }\r\n            else {\r\n                top_1 = bottom - nextHeight / 2;\r\n                bottom = top_1 + nextHeight;\r\n            }\r\n            var nextControlPoses_1 = getRectPoses(top_1, right, bottom, left);\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                dists[i][0] = nextControlPoses_1[i].pos[0] - controlPose.pos[0];\r\n                dists[i][1] = nextControlPoses_1[i].pos[1] - controlPose.pos[1];\r\n            });\r\n        }\r\n        else {\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                var controlDir = controlPose.direction;\r\n                if (!controlDir) {\r\n                    return;\r\n                }\r\n                if (controlDir.indexOf(verticalDirection_1) > -1) {\r\n                    dists[i][0] = dist[0];\r\n                }\r\n                if (controlDir.indexOf(horizontalDirection_1) > -1) {\r\n                    dists[i][1] = dist[1];\r\n                }\r\n            });\r\n            if (verticalDirection_1) {\r\n                dists[1][0] = dist[0] / 2;\r\n                dists[5][0] = dist[0] / 2;\r\n            }\r\n            if (horizontalDirection_1) {\r\n                dists[3][1] = dist[1] / 2;\r\n                dists[7][1] = dist[1] / 2;\r\n            }\r\n        }\r\n    }\r\n    else if (direction && !sub) {\r\n        directions.forEach(function (dir) {\r\n            var isVertical = dir === \"n\" || dir === \"s\";\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                var dirDir = controlPose.direction, dirHorizontal = controlPose.horizontal, dirVertical = controlPose.vertical;\r\n                if (!dirDir || dirDir.indexOf(dir) === -1) {\r\n                    return;\r\n                }\r\n                dists[i] = [\r\n                    isVertical || !dirHorizontal ? 0 : dist[0],\r\n                    !isVertical || !dirVertical ? 0 : dist[1],\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    else {\r\n        dists[index] = dist;\r\n    }\r\n    return dists;\r\n}\r\nfunction addClipPath(moveable, e) {\r\n    var _a = __read(calculatePointerDist(moveable, e), 2), distX = _a[0], distY = _a[1];\r\n    var _b = e.datas, clipPath = _b.clipPath, clipIndex = _b.clipIndex;\r\n    var _c = clipPath, clipType = _c.type, clipPoses = _c.poses, splitter = _c.splitter;\r\n    var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n    if (clipType === \"polygon\") {\r\n        poses.splice(clipIndex, 0, [distX, distY]);\r\n    }\r\n    else if (clipType === \"inset\") {\r\n        var horizontalIndex = HORIZONTAL_RADIUS_ORDER.indexOf(clipIndex);\r\n        var verticalIndex = VERTICAL_RADIUS_ORDER.indexOf(clipIndex);\r\n        var length_1 = clipPoses.length;\r\n        addRadiusPos(clipPoses, poses, 8, horizontalIndex, verticalIndex, distX, distY, poses[4][0], poses[4][1], poses[0][0], poses[0][1]);\r\n        if (length_1 === clipPoses.length) {\r\n            return;\r\n        }\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    var clipStyles = getClipStyles(moveable, clipPath, poses);\r\n    var clipStyle = \"\".concat(clipType, \"(\").concat(clipStyles.join(splitter), \")\");\r\n    triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"added\", clipType: clipType, poses: poses, clipStyles: clipStyles, clipStyle: clipStyle, distX: 0, distY: 0 }, fillCSSObject({\r\n        clipPath: clipStyle,\r\n    }, e))));\r\n}\r\nfunction removeClipPath(moveable, e) {\r\n    var _a = e.datas, clipPath = _a.clipPath, clipIndex = _a.clipIndex;\r\n    var _b = clipPath, clipType = _b.type, clipPoses = _b.poses, splitter = _b.splitter;\r\n    var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n    var length = poses.length;\r\n    if (clipType === \"polygon\") {\r\n        clipPoses.splice(clipIndex, 1);\r\n        poses.splice(clipIndex, 1);\r\n    }\r\n    else if (clipType === \"inset\") {\r\n        if (clipIndex < 8) {\r\n            return;\r\n        }\r\n        removeRadiusPos(clipPoses, poses, clipIndex, 8, length);\r\n        if (length === clipPoses.length) {\r\n            return;\r\n        }\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    var clipStyles = getClipStyles(moveable, clipPath, poses);\r\n    var clipStyle = \"\".concat(clipType, \"(\").concat(clipStyles.join(splitter), \")\");\r\n    triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"removed\", clipType: clipType, poses: poses, clipStyles: clipStyles, clipStyle: clipStyle, distX: 0, distY: 0 }, fillCSSObject({\r\n        clipPath: clipStyle,\r\n    }, e))));\r\n}\r\n/**\r\n * @namespace Moveable.Clippable\r\n * @description Whether to clip the target.\r\n */\r\nvar Clippable = {\r\n    name: \"clippable\",\r\n    props: [\r\n        \"clippable\",\r\n        \"defaultClipPath\",\r\n        \"customClipPath\",\r\n        \"keepRatio\",\r\n        \"clipRelative\",\r\n        \"clipArea\",\r\n        \"dragWithClip\",\r\n        \"clipTargetBounds\",\r\n        \"clipVerticalGuidelines\",\r\n        \"clipHorizontalGuidelines\",\r\n        \"clipSnapThreshold\",\r\n    ],\r\n    events: [\r\n        \"clipStart\",\r\n        \"clip\",\r\n        \"clipEnd\",\r\n    ],\r\n    css: [\r\n        \".control.clip-control {\\nbackground: #6d6;\\ncursor: pointer;\\n}\\n.control.clip-control.clip-radius {\\nbackground: #d66;\\n}\\n.line.clip-line {\\nbackground: #6e6;\\ncursor: move;\\nz-index: 1;\\n}\\n.clip-area {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\n}\\n.clip-ellipse {\\nposition: absolute;\\ncursor: move;\\nborder: 1px solid #6d6;\\nborder: var(--zoompx) solid #6d6;\\nborder-radius: 50%;\\ntransform-origin: 0px 0px;\\n}\",\r\n        \":host {\\n--bounds-color: #d66;\\n}\",\r\n        \".guideline {\\npointer-events: none;\\nz-index: 2;\\n}\",\r\n        \".line.guideline.bounds {\\nbackground: #d66;\\nbackground: var(--bounds-color);\\n}\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, customClipPath = _a.customClipPath, defaultClipPath = _a.defaultClipPath, clipArea = _a.clipArea, zoom = _a.zoom, groupable = _a.groupable;\r\n        var _b = moveable.getState(), target = _b.target, width = _b.width, height = _b.height, allMatrix = _b.allMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4, clipPathState = _b.clipPathState, snapBoundInfos = _b.snapBoundInfos, rotationRad = _b.rotation;\r\n        if (!target || groupable) {\r\n            return [];\r\n        }\r\n        var clipPath = getClipPath(target, width, height, defaultClipPath || \"inset\", clipPathState || customClipPath);\r\n        if (!clipPath) {\r\n            return [];\r\n        }\r\n        var n = is3d ? 4 : 3;\r\n        var type = clipPath.type;\r\n        var clipPoses = clipPath.poses;\r\n        var poses = clipPoses.map(function (pos) {\r\n            // return [x, y];\r\n            var calculatedPos = calculatePosition(allMatrix, pos.pos, n);\r\n            return [\r\n                calculatedPos[0] - left,\r\n                calculatedPos[1] - top,\r\n            ];\r\n        });\r\n        var controls = [];\r\n        var lines = [];\r\n        var isRect = type === \"rect\";\r\n        var isInset = type === \"inset\";\r\n        var isPolygon = type === \"polygon\";\r\n        if (isRect || isInset || isPolygon) {\r\n            var linePoses_1 = isInset ? poses.slice(0, 8) : poses;\r\n            lines = linePoses_1.map(function (to, i) {\r\n                var from = i === 0 ? linePoses_1[linePoses_1.length - 1] : linePoses_1[i - 1];\r\n                var rad = getRad(from, to);\r\n                var dist = getDiagonalSize(from, to);\r\n                return React.createElement(\"div\", { key: \"clipLine\".concat(i), className: prefix(\"line\", \"clip-line\", \"snap-control\"), \"data-clip-index\": i, style: {\r\n                        width: \"\".concat(dist, \"px\"),\r\n                        transform: \"translate(\".concat(from[0], \"px, \").concat(from[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n                    } });\r\n            });\r\n        }\r\n        controls = poses.map(function (pos, i) {\r\n            return React.createElement(\"div\", { key: \"clipControl\".concat(i), className: prefix(\"control\", \"clip-control\", \"snap-control\"), \"data-clip-index\": i, style: {\r\n                    transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rotationRad, \"rad) scale(\").concat(zoom, \")\"),\r\n                } });\r\n        });\r\n        if (isInset) {\r\n            controls.push.apply(controls, __spreadArray([], __read(poses.slice(8).map(function (pos, i) {\r\n                return React.createElement(\"div\", { key: \"clipRadiusControl\".concat(i), className: prefix(\"control\", \"clip-control\", \"clip-radius\", \"snap-control\"), \"data-clip-index\": 8 + i, style: {\r\n                        transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rotationRad, \"rad) scale(\").concat(zoom, \")\"),\r\n                    } });\r\n            })), false));\r\n        }\r\n        if (type === \"circle\" || type === \"ellipse\") {\r\n            var clipLeft = clipPath.left, clipTop = clipPath.top, radiusX = clipPath.radiusX, radiusY = clipPath.radiusY;\r\n            var _c = __read(minus(calculatePosition(allMatrix, [clipLeft, clipTop], n), calculatePosition(allMatrix, [0, 0], n)), 2), distLeft = _c[0], distTop = _c[1];\r\n            var ellipseClipPath = \"none\";\r\n            if (!clipArea) {\r\n                var piece = Math.max(10, radiusX / 5, radiusY / 5);\r\n                var areaPoses = [];\r\n                for (var i = 0; i <= piece; ++i) {\r\n                    var rad = Math.PI * 2 / piece * i;\r\n                    areaPoses.push([\r\n                        radiusX + (radiusX - zoom) * Math.cos(rad),\r\n                        radiusY + (radiusY - zoom) * Math.sin(rad),\r\n                    ]);\r\n                }\r\n                areaPoses.push([radiusX, -2]);\r\n                areaPoses.push([-2, -2]);\r\n                areaPoses.push([-2, radiusY * 2 + 2]);\r\n                areaPoses.push([radiusX * 2 + 2, radiusY * 2 + 2]);\r\n                areaPoses.push([radiusX * 2 + 2, -2]);\r\n                areaPoses.push([radiusX, -2]);\r\n                ellipseClipPath = \"polygon(\".concat(areaPoses.map(function (pos) { return \"\".concat(pos[0], \"px \").concat(pos[1], \"px\"); }).join(\", \"), \")\");\r\n            }\r\n            controls.push(React.createElement(\"div\", { key: \"clipEllipse\", className: prefix(\"clip-ellipse\", \"snap-control\"), style: {\r\n                    width: \"\".concat(radiusX * 2, \"px\"),\r\n                    height: \"\".concat(radiusY * 2, \"px\"),\r\n                    clipPath: ellipseClipPath,\r\n                    transform: \"translate(\".concat(-left + distLeft, \"px, \").concat(-top + distTop, \"px) \").concat(makeMatrixCSS(allMatrix)),\r\n                } }));\r\n        }\r\n        if (clipArea) {\r\n            var _d = getRect(__spreadArray([pos1, pos2, pos3, pos4], __read(poses), false)), allWidth = _d.width, allHeight = _d.height, allLeft_1 = _d.left, allTop_1 = _d.top;\r\n            if (isPolygon || isRect || isInset) {\r\n                var areaPoses = isInset ? poses.slice(0, 8) : poses;\r\n                controls.push(React.createElement(\"div\", { key: \"clipArea\", className: prefix(\"clip-area\", \"snap-control\"), style: {\r\n                        width: \"\".concat(allWidth, \"px\"),\r\n                        height: \"\".concat(allHeight, \"px\"),\r\n                        transform: \"translate(\".concat(allLeft_1, \"px, \").concat(allTop_1, \"px)\"),\r\n                        clipPath: \"polygon(\".concat(areaPoses.map(function (pos) { return \"\".concat(pos[0] - allLeft_1, \"px \").concat(pos[1] - allTop_1, \"px\"); }).join(\", \"), \")\"),\r\n                    } }));\r\n            }\r\n        }\r\n        if (snapBoundInfos) {\r\n            [\"vertical\", \"horizontal\"].forEach(function (directionType) {\r\n                var info = snapBoundInfos[directionType];\r\n                var isHorizontal = directionType === \"horizontal\";\r\n                if (info.isSnap) {\r\n                    lines.push.apply(lines, __spreadArray([], __read(info.snap.posInfos.map(function (_a, i) {\r\n                        var pos = _a.pos;\r\n                        var snapPos1 = minus(calculatePosition(allMatrix, isHorizontal ? [0, pos] : [pos, 0], n), [left, top]);\r\n                        var snapPos2 = minus(calculatePosition(allMatrix, isHorizontal ? [width, pos] : [pos, height], n), [left, top]);\r\n                        return renderLine(React, \"\", snapPos1, snapPos2, zoom, \"clip\".concat(directionType, \"snap\").concat(i), \"guideline\");\r\n                    })), false));\r\n                }\r\n                if (info.isBound) {\r\n                    lines.push.apply(lines, __spreadArray([], __read(info.bounds.map(function (_a, i) {\r\n                        var pos = _a.pos;\r\n                        var snapPos1 = minus(calculatePosition(allMatrix, isHorizontal ? [0, pos] : [pos, 0], n), [left, top]);\r\n                        var snapPos2 = minus(calculatePosition(allMatrix, isHorizontal ? [width, pos] : [pos, height], n), [left, top]);\r\n                        return renderLine(React, \"\", snapPos1, snapPos2, zoom, \"clip\".concat(directionType, \"bounds\").concat(i), \"guideline\", \"bounds\", \"bold\");\r\n                    })), false));\r\n                }\r\n            });\r\n        }\r\n        return __spreadArray(__spreadArray([], __read(controls), false), __read(lines), false);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        return e.inputEvent && (e.inputEvent.target.getAttribute(\"class\") || \"\").indexOf(\"clip\") > -1;\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        var props = moveable.props;\r\n        var _a = props.dragWithClip, dragWithClip = _a === void 0 ? true : _a;\r\n        if (dragWithClip) {\r\n            return false;\r\n        }\r\n        return this.dragControlStart(moveable, e);\r\n    },\r\n    drag: function (moveable, e) {\r\n        return this.dragControl(moveable, __assign(__assign({}, e), { isDragTarget: true }));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        return this.dragControlEnd(moveable, e);\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var state = moveable.state;\r\n        var _a = moveable.props, defaultClipPath = _a.defaultClipPath, customClipPath = _a.customClipPath;\r\n        var target = state.target, width = state.width, height = state.height;\r\n        var inputTarget = e.inputEvent ? e.inputEvent.target : null;\r\n        var className = (inputTarget && inputTarget.getAttribute(\"class\")) || \"\";\r\n        var datas = e.datas;\r\n        var clipPath = getClipPath(target, width, height, defaultClipPath || \"inset\", customClipPath);\r\n        if (!clipPath) {\r\n            return false;\r\n        }\r\n        var clipText = clipPath.clipText, type = clipPath.type, poses = clipPath.poses;\r\n        var result = triggerEvent(moveable, \"onClipStart\", fillParams(moveable, e, {\r\n            clipType: type,\r\n            clipStyle: clipText,\r\n            poses: poses.map(function (pos) { return pos.pos; }),\r\n        }));\r\n        if (result === false) {\r\n            datas.isClipStart = false;\r\n            return false;\r\n        }\r\n        datas.isControl = className && className.indexOf(\"clip-control\") > -1;\r\n        datas.isLine = className.indexOf(\"clip-line\") > -1;\r\n        datas.isArea = className.indexOf(\"clip-area\") > -1 || className.indexOf(\"clip-ellipse\") > -1;\r\n        datas.clipIndex = inputTarget ? parseInt(inputTarget.getAttribute(\"data-clip-index\"), 10) : -1;\r\n        datas.clipPath = clipPath;\r\n        datas.isClipStart = true;\r\n        state.clipPathState = clipText;\r\n        setDragStart(moveable, e);\r\n        return true;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a, _b, _c;\r\n        var datas = e.datas, originalDatas = e.originalDatas, isDragTarget = e.isDragTarget;\r\n        if (!datas.isClipStart) {\r\n            return false;\r\n        }\r\n        var _d = datas, isControl = _d.isControl, isLine = _d.isLine, isArea = _d.isArea, clipIndex = _d.clipIndex, clipPath = _d.clipPath;\r\n        if (!clipPath) {\r\n            return false;\r\n        }\r\n        var props = getProps(moveable.props, \"clippable\");\r\n        var keepRatio = props.keepRatio;\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var originalDraggable = originalDatas.draggable;\r\n        var originalDist = getDragDist(e);\r\n        if (isDragTarget && originalDraggable) {\r\n            _a = __read(originalDraggable.prevBeforeDist, 2), distX = _a[0], distY = _a[1];\r\n        }\r\n        else {\r\n            _b = __read(originalDist, 2), distX = _b[0], distY = _b[1];\r\n        }\r\n        var firstDist = [distX, distY];\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height;\r\n        var isDragWithTarget = !isArea && !isControl && !isLine;\r\n        var clipType = clipPath.type, clipPoses = clipPath.poses, splitter = clipPath.splitter;\r\n        var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n        if (isDragWithTarget) {\r\n            distX = -distX;\r\n            distY = -distY;\r\n        }\r\n        var isAll = !isControl || clipPoses[clipIndex].direction === \"nesw\";\r\n        var isRect = clipType === \"inset\" || clipType === \"rect\";\r\n        var dists = clipPoses.map(function () { return [0, 0]; });\r\n        if (isControl && !isAll) {\r\n            var _e = clipPoses[clipIndex], horizontal = _e.horizontal, vertical = _e.vertical;\r\n            var dist = [\r\n                distX * abs(horizontal),\r\n                distY * abs(vertical),\r\n            ];\r\n            dists = moveControlPos(clipPoses, clipIndex, dist, isRect, keepRatio);\r\n        }\r\n        else if (isAll) {\r\n            dists = poses.map(function () { return [distX, distY]; });\r\n        }\r\n        var nextPoses = poses.map(function (pos, i) { return plus(pos, dists[i]); });\r\n        var guidePoses = __spreadArray([], __read(nextPoses), false);\r\n        state.snapBoundInfos = null;\r\n        var isCircle = clipPath.type === \"circle\";\r\n        var isEllipse = clipPath.type === \"ellipse\";\r\n        if (isCircle || isEllipse) {\r\n            var guideRect = getRect(nextPoses);\r\n            var ry = abs(guideRect.bottom - guideRect.top);\r\n            var rx = abs(isEllipse ? guideRect.right - guideRect.left : ry);\r\n            var bottom = nextPoses[0][1] + ry;\r\n            var left = nextPoses[0][0] - rx;\r\n            var right = nextPoses[0][0] + rx;\r\n            // right\r\n            if (isCircle) {\r\n                guidePoses.push([right, guideRect.bottom]);\r\n                dists.push([1, 0]);\r\n            }\r\n            // bottom\r\n            guidePoses.push([guideRect.left, bottom]);\r\n            dists.push([0, 1]);\r\n            // left\r\n            guidePoses.push([left, guideRect.bottom]);\r\n            dists.push([1, 0]);\r\n        }\r\n        var guidelines = getDefaultGuidelines((props.clipHorizontalGuidelines || []).map(function (v) { return convertUnitSize(\"\".concat(v), height); }), (props.clipVerticalGuidelines || []).map(function (v) { return convertUnitSize(\"\".concat(v), width); }), width, height);\r\n        var guideXPoses = [];\r\n        var guideYPoses = [];\r\n        if (isCircle || isEllipse) {\r\n            guideXPoses = [guidePoses[4][0], guidePoses[2][0]];\r\n            guideYPoses = [guidePoses[1][1], guidePoses[3][1]];\r\n        }\r\n        else if (isRect) {\r\n            var rectPoses = [guidePoses[0], guidePoses[2], guidePoses[4], guidePoses[6]];\r\n            var rectDists_1 = [dists[0], dists[2], dists[4], dists[6]];\r\n            guideXPoses = rectPoses.filter(function (_, i) { return rectDists_1[i][0]; }).map(function (pos) { return pos[0]; });\r\n            guideYPoses = rectPoses.filter(function (_, i) { return rectDists_1[i][1]; }).map(function (pos) { return pos[1]; });\r\n        }\r\n        else {\r\n            guideXPoses = guidePoses.filter(function (_, i) { return dists[i][0]; }).map(function (pos) { return pos[0]; });\r\n            guideYPoses = guidePoses.filter(function (_, i) { return dists[i][1]; }).map(function (pos) { return pos[1]; });\r\n        }\r\n        var boundDelta = [0, 0];\r\n        var _f = checkSnapBounds(guidelines, props.clipTargetBounds && { left: 0, top: 0, right: width, bottom: height }, guideXPoses, guideYPoses, 5, 5), horizontalSnapInfo = _f.horizontal, verticalSnapInfo = _f.vertical;\r\n        var snapOffsetY = horizontalSnapInfo.offset;\r\n        var snapOffsetX = verticalSnapInfo.offset;\r\n        if (horizontalSnapInfo.isBound) {\r\n            boundDelta[1] += snapOffsetY;\r\n        }\r\n        if (verticalSnapInfo.isBound) {\r\n            boundDelta[0] += snapOffsetX;\r\n        }\r\n        if ((isEllipse || isCircle) && dists[0][0] === 0 && dists[0][1] === 0) {\r\n            var guideRect = getRect(nextPoses);\r\n            var cy = guideRect.bottom - guideRect.top;\r\n            var cx = isEllipse ? guideRect.right - guideRect.left : cy;\r\n            var distSnapX = verticalSnapInfo.isBound\r\n                ? abs(snapOffsetX)\r\n                : (verticalSnapInfo.snapIndex === 0 ? -snapOffsetX : snapOffsetX);\r\n            var distSnapY = horizontalSnapInfo.isBound\r\n                ? abs(snapOffsetY)\r\n                : (horizontalSnapInfo.snapIndex === 0 ? -snapOffsetY : snapOffsetY);\r\n            cx -= distSnapX;\r\n            cy -= distSnapY;\r\n            if (isCircle) {\r\n                cy = checkSnapBoundPriority(verticalSnapInfo, horizontalSnapInfo) > 0 ? cy : cx;\r\n                cx = cy;\r\n            }\r\n            var center = guidePoses[0];\r\n            guidePoses[1][1] = center[1] - cy;\r\n            guidePoses[2][0] = center[0] + cx;\r\n            guidePoses[3][1] = center[1] + cy;\r\n            guidePoses[4][0] = center[0] - cx;\r\n        }\r\n        else if (isRect && keepRatio && isControl) {\r\n            var _g = __read(getControlSize(clipPoses), 2), width_1 = _g[0], height_1 = _g[1];\r\n            var ratio = width_1 && height_1 ? width_1 / height_1 : 0;\r\n            var clipPose = clipPoses[clipIndex];\r\n            var direction = clipPose.direction || \"\";\r\n            var top_2 = guidePoses[1][1];\r\n            var bottom = guidePoses[5][1];\r\n            var left = guidePoses[7][0];\r\n            var right = guidePoses[3][0];\r\n            if (abs(snapOffsetY) <= abs(snapOffsetX)) {\r\n                snapOffsetY = sign(snapOffsetY) * abs(snapOffsetX) / ratio;\r\n            }\r\n            else {\r\n                snapOffsetX = sign(snapOffsetX) * abs(snapOffsetY) * ratio;\r\n            }\r\n            if (direction.indexOf(\"w\") > -1) {\r\n                left -= snapOffsetX;\r\n            }\r\n            else if (direction.indexOf(\"e\") > -1) {\r\n                right -= snapOffsetX;\r\n            }\r\n            else {\r\n                left += snapOffsetX / 2;\r\n                right -= snapOffsetX / 2;\r\n            }\r\n            if (direction.indexOf(\"n\") > -1) {\r\n                top_2 -= snapOffsetY;\r\n            }\r\n            else if (direction.indexOf(\"s\") > -1) {\r\n                bottom -= snapOffsetY;\r\n            }\r\n            else {\r\n                top_2 += snapOffsetY / 2;\r\n                bottom -= snapOffsetY / 2;\r\n            }\r\n            var nextControlPoses_2 = getRectPoses(top_2, right, bottom, left);\r\n            guidePoses.forEach(function (pos, i) {\r\n                var _a;\r\n                _a = __read(nextControlPoses_2[i].pos, 2), pos[0] = _a[0], pos[1] = _a[1];\r\n            });\r\n        }\r\n        else {\r\n            guidePoses.forEach(function (pos, j) {\r\n                var dist = dists[j];\r\n                if (dist[0]) {\r\n                    pos[0] -= snapOffsetX;\r\n                }\r\n                if (dist[1]) {\r\n                    pos[1] -= snapOffsetY;\r\n                }\r\n            });\r\n        }\r\n        var nextClipStyles = getClipStyles(moveable, clipPath, nextPoses);\r\n        var clipStyle = \"\".concat(clipType, \"(\").concat(nextClipStyles.join(splitter), \")\");\r\n        state.clipPathState = clipStyle;\r\n        if (isCircle || isEllipse) {\r\n            guideXPoses = [guidePoses[4][0], guidePoses[2][0]];\r\n            guideYPoses = [guidePoses[1][1], guidePoses[3][1]];\r\n        }\r\n        else if (isRect) {\r\n            var rectPoses = [guidePoses[0], guidePoses[2], guidePoses[4], guidePoses[6]];\r\n            guideXPoses = rectPoses.map(function (pos) { return pos[0]; });\r\n            guideYPoses = rectPoses.map(function (pos) { return pos[1]; });\r\n        }\r\n        else {\r\n            guideXPoses = guidePoses.map(function (pos) { return pos[0]; });\r\n            guideYPoses = guidePoses.map(function (pos) { return pos[1]; });\r\n        }\r\n        state.snapBoundInfos = checkSnapBounds(guidelines, props.clipTargetBounds && { left: 0, top: 0, right: width, bottom: height }, guideXPoses, guideYPoses, 1, 1);\r\n        if (originalDraggable) {\r\n            var is3d = state.is3d, allMatrix = state.allMatrix;\r\n            var n = is3d ? 4 : 3;\r\n            var dragDist = boundDelta;\r\n            if (isDragTarget) {\r\n                dragDist = [\r\n                    firstDist[0] + boundDelta[0] - originalDist[0],\r\n                    firstDist[1] + boundDelta[1] - originalDist[1],\r\n                ];\r\n            }\r\n            originalDraggable.deltaOffset = multiply(allMatrix, [dragDist[0], dragDist[1], 0, 0], n);\r\n        }\r\n        triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"changed\", clipType: clipType, poses: nextPoses, clipStyle: clipStyle, clipStyles: nextClipStyles, distX: distX, distY: distY }, fillCSSObject((_c = {},\r\n            _c[clipType === \"rect\" ? \"clip\" : \"clipPath\"] = clipStyle,\r\n            _c), e))));\r\n        return true;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        this.unset(moveable);\r\n        var isDrag = e.isDrag, datas = e.datas, isDouble = e.isDouble;\r\n        var isLine = datas.isLine, isClipStart = datas.isClipStart, isControl = datas.isControl;\r\n        if (!isClipStart) {\r\n            return false;\r\n        }\r\n        triggerEvent(moveable, \"onClipEnd\", fillEndParams(moveable, e, {}));\r\n        if (isDouble) {\r\n            if (isControl) {\r\n                removeClipPath(moveable, e);\r\n            }\r\n            else if (isLine) {\r\n                // add\r\n                addClipPath(moveable, e);\r\n            }\r\n        }\r\n        return isDouble || isDrag;\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.clipPathState = \"\";\r\n        moveable.state.snapBoundInfos = null;\r\n    },\r\n};\r\n/**\r\n * Whether to clip the target. (default: false)\r\n * @name Moveable.Clippable#clippable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n *  If clippath is not set, the default value can be set. (defaultClipPath < style < customClipPath < dragging clipPath)\r\n * @name Moveable.Clippable#defaultClipPath\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px (`rect` not possible) (default: false)\r\n * @name Moveable.Clippable#clipRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * You can force the custom clipPath. (defaultClipPath < style < customClipPath < dragging clipPath)\r\n * @name Moveable.Clippable#customClipPath\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When dragging the target, the clip also moves. (default: true)\r\n * @name Moveable.Clippable#dragWithClip\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * You can drag the clip by setting clipArea.\r\n * @name Moveable.Clippable#clipArea\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n* Whether the clip is bound to the target.\r\n* @name Moveable.Clippable#clipTargetBounds\r\n* @default false\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipTargetBounds: true,\r\n* });\r\n* moveable.on(\"clipStart\", e => {\r\n*     console.log(e);\r\n* }).on(\"clip\", e => {\r\n*     if (e.clipType === \"rect\") {\r\n*         e.target.style.clip = e.clipStyle;\r\n*     } else {\r\n*         e.target.style.clipPath = e.clipStyle;\r\n*     }\r\n* }).on(\"clipEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n * Add clip guidelines in the vertical direction.\r\n * @name Moveable.Clippable#clipVerticalGuidelines\r\n * @default 0\r\n * @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n* Add clip guidelines in the horizontal direction.\r\n* @name Moveable.Clippable#clipHorizontalGuidelines\r\n* @default []\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n* istance value that can snap to clip guidelines.\r\n* @name Moveable.Clippable#clipSnapThreshold\r\n* @default 5\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n * When drag start the clip area or controls, the `clipStart` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clipStart\r\n * @param {Moveable.Clippable.OnClipStart} - Parameters for the `clipStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag the clip area or controls, the `clip` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clip\r\n * @param {Moveable.Clippable.OnClip} - Parameters for the `clip` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the clip area or controls, the `clipEnd` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clipEnd\r\n * @param {Moveable.Clippable.OnClipEnd} - Parameters for the `clipEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\n\n/**\r\n * @namespace OriginDraggable\r\n * @memberof Moveable\r\n * @description Whether to drag origin (default: false)\r\n */\r\nvar OriginDraggable = {\r\n    name: \"originDraggable\",\r\n    props: [\r\n        \"originDraggable\",\r\n        \"originRelative\",\r\n    ],\r\n    events: [\r\n        \"dragOriginStart\",\r\n        \"dragOrigin\",\r\n        \"dragOriginEnd\",\r\n    ],\r\n    css: [\r\n        \":host[data-able-origindraggable] .control.origin {\\npointer-events: auto;\\n}\",\r\n    ],\r\n    dragControlCondition: function (_, e) {\r\n        if (e.isRequest) {\r\n            return e.requestAble === \"originDraggable\";\r\n        }\r\n        return hasClass(e.inputEvent.target, prefix(\"origin\"));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        setDragStart(moveable, e);\r\n        var params = fillParams(moveable, e, {\r\n            dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)),\r\n        });\r\n        var result = triggerEvent(moveable, \"onDragOriginStart\", params);\r\n        datas.startOrigin = moveable.state.transformOrigin;\r\n        datas.startTargetOrigin = moveable.state.targetOrigin;\r\n        datas.prevOrigin = [0, 0];\r\n        datas.isDragOrigin = true;\r\n        if (result === false) {\r\n            datas.isDragOrigin = false;\r\n            return false;\r\n        }\r\n        return params;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, isRequest = e.isRequest;\r\n        if (!datas.isDragOrigin) {\r\n            return false;\r\n        }\r\n        var _a = __read(getDragDist(e), 2), distX = _a[0], distY = _a[1];\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height, offsetMatrix = state.offsetMatrix, targetMatrix = state.targetMatrix, is3d = state.is3d;\r\n        var _b = moveable.props.originRelative, originRelative = _b === void 0 ? true : _b;\r\n        var n = is3d ? 4 : 3;\r\n        var dist = [distX, distY];\r\n        if (isRequest) {\r\n            var distOrigin = e.distOrigin;\r\n            if (distOrigin[0] || distOrigin[1]) {\r\n                dist = distOrigin;\r\n            }\r\n        }\r\n        var origin = plus(datas.startOrigin, dist);\r\n        var targetOrigin = plus(datas.startTargetOrigin, dist);\r\n        var delta = minus(dist, datas.prevOrigin);\r\n        var nextMatrix = getNextMatrix(offsetMatrix, targetMatrix, origin, n);\r\n        var rect = moveable.getRect();\r\n        var nextRect = getRect(calculatePoses(nextMatrix, width, height, n));\r\n        var dragDelta = [\r\n            rect.left - nextRect.left,\r\n            rect.top - nextRect.top,\r\n        ];\r\n        datas.prevOrigin = dist;\r\n        var transformOrigin = [\r\n            convertCSSSize(targetOrigin[0], width, originRelative),\r\n            convertCSSSize(targetOrigin[1], height, originRelative),\r\n        ].join(\" \");\r\n        var result = Draggable.drag(moveable, setCustomDrag(e, moveable.state, dragDelta, !!isPinch, false));\r\n        var params = fillParams(moveable, e, __assign(__assign({ width: width, height: height, origin: origin, dist: dist, delta: delta, transformOrigin: transformOrigin, drag: result }, fillCSSObject({\r\n            transformOrigin: transformOrigin,\r\n            transform: result.transform,\r\n        }, e)), { afterTransform: result.transform }));\r\n        triggerEvent(moveable, \"onDragOrigin\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isDragOrigin) {\r\n            return false;\r\n        }\r\n        triggerEvent(moveable, \"onDragOriginEnd\", fillEndParams(moveable, e, {}));\r\n        return true;\r\n    },\r\n    dragGroupControlCondition: function (moveable, e) {\r\n        return this.dragControlCondition(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        moveable.transformOrigin = params.transformOrigin;\r\n        return true;\r\n    },\r\n    /**\r\n    * @method Moveable.OriginDraggable#request\r\n    * @param {object} e - the OriginDraggable's request parameter\r\n    * @param {number} [e.x] - x position\r\n    * @param {number} [e.y] - y position\r\n    * @param {number} [e.deltaX] - x number to move\r\n    * @param {number} [e.deltaY] - y number to move\r\n    * @param {array} [e.deltaOrigin] - left, top number to move transform-origin\r\n    * @param {array} [e.origin] - transform-origin position\r\n    * @param {number} [e.isInstant] - Whether to execute the request instantly\r\n    * @return {Moveable.Requester} Moveable Requester\r\n    * @example\r\n\n    * // Instantly Request (requestStart - request - requestEnd)\r\n    * // Use Relative Value\r\n    * moveable.request(\"originDraggable\", { deltaX: 10, deltaY: 10 }, true);\r\n    * // Use Absolute Value\r\n    * moveable.request(\"originDraggable\", { x: 200, y: 100 }, true);\r\n    * // Use Transform Value\r\n    * moveable.request(\"originDraggable\", { deltaOrigin: [10, 0] }, true);\r\n    * moveable.request(\"originDraggable\", { origin: [100, 0] }, true);\r\n    * // requestStart\r\n    * const requester = moveable.request(\"originDraggable\");\r\n    *\r\n    * // request\r\n    * // Use Relative Value\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * // Use Absolute Value\r\n    * moveable.request(\"originDraggable\", { x: 200, y: 100 });\r\n    * moveable.request(\"originDraggable\", { x: 220, y: 100 });\r\n    * moveable.request(\"originDraggable\", { x: 240, y: 100 });\r\n    *\r\n    * // requestEnd\r\n    * requester.requestEnd();\r\n    */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var rect = moveable.getRect();\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var transformOrigin = rect.transformOrigin;\r\n        var distOrigin = [0, 0];\r\n        return {\r\n            isControl: true,\r\n            requestStart: function () {\r\n                return { datas: datas };\r\n            },\r\n            request: function (e) {\r\n                if (\"deltaOrigin\" in e) {\r\n                    distOrigin[0] += e.deltaOrigin[0];\r\n                    distOrigin[1] += e.deltaOrigin[1];\r\n                }\r\n                else if (\"origin\" in e) {\r\n                    distOrigin[0] = e.origin[0] - transformOrigin[0];\r\n                    distOrigin[1] = e.origin[1] - transformOrigin[1];\r\n                }\r\n                else {\r\n                    if (\"x\" in e) {\r\n                        distX = e.x - rect.left;\r\n                    }\r\n                    else if (\"deltaX\" in e) {\r\n                        distX += e.deltaX;\r\n                    }\r\n                    if (\"y\" in e) {\r\n                        distY = e.y - rect.top;\r\n                    }\r\n                    else if (\"deltaY\" in e) {\r\n                        distY += e.deltaY;\r\n                    }\r\n                }\r\n                return { datas: datas, distX: distX, distY: distY, distOrigin: distOrigin };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether to drag origin (default: false)\r\n * @name Moveable.OriginDraggable#originDraggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     originDraggable: true,\r\n * });\r\n * let translate = [0, 0];\r\n * moveable.on(\"dragOriginStart\", e => {\r\n *     e.dragStart && e.dragStart.set(translate);\r\n * }).on(\"dragOrigin\", e => {\r\n *     translate = e.drag.beforeTranslate;\r\n *     e.target.style.cssText\r\n *         = `transform-origin: ${e.transformOrigin};`\r\n *         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n * }).on(\"dragOriginEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px (default: true)\r\n * @name Moveable.OriginDraggable#originRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     originDraggable: true,\r\n *     originRelative: false,\r\n * });\r\n * moveable.originRelative = true;\r\n */\r\n/**\r\n* When drag start the origin, the `dragOriginStart` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOriginStart\r\n* @param {Moveable.OriginDraggable.OnDragOriginStart} - Parameters for the `dragOriginStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n* When drag the origin, the `dragOrigin` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOrigin\r\n* @param {Moveable.OriginDraggable.OnDragOrigin} - Parameters for the `dragOrigin` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n* When drag end the origin, the `dragOriginEnd` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOriginEnd\r\n* @param {Moveable.OriginDraggable.OnDragOriginEnd} - Parameters for the `dragOriginEnd` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\n\nfunction addBorderRadiusByLine(controlPoses, lineIndex, distX, distY) {\r\n    // lineIndex\r\n    // 0 top\r\n    // 1 right\r\n    // 2 bottom\r\n    // 3 left\r\n    var horizontalsLength = controlPoses.filter(function (_a) {\r\n        var virtual = _a.virtual, horizontal = _a.horizontal;\r\n        return horizontal && !virtual;\r\n    }).length;\r\n    var verticalsLength = controlPoses.filter(function (_a) {\r\n        var virtual = _a.virtual, vertical = _a.vertical;\r\n        return vertical && !virtual;\r\n    }).length;\r\n    var controlIndex = -1;\r\n    //top\r\n    if (lineIndex === 0) {\r\n        if (horizontalsLength === 0) {\r\n            controlIndex = 0;\r\n        }\r\n        else if (horizontalsLength === 1) {\r\n            controlIndex = 1;\r\n        }\r\n    }\r\n    // bottom\r\n    if (lineIndex === 2) {\r\n        if (horizontalsLength <= 2) {\r\n            controlIndex = 2;\r\n        }\r\n        else if (horizontalsLength <= 3) {\r\n            controlIndex = 3;\r\n        }\r\n    }\r\n    // left\r\n    if (lineIndex === 3) {\r\n        if (verticalsLength === 0) {\r\n            controlIndex = 4;\r\n        }\r\n        else if (verticalsLength < 4) {\r\n            controlIndex = 7;\r\n        }\r\n    }\r\n    // right\r\n    if (lineIndex === 1) {\r\n        if (verticalsLength <= 1) {\r\n            controlIndex = 5;\r\n        }\r\n        else if (verticalsLength <= 2) {\r\n            controlIndex = 6;\r\n        }\r\n    }\r\n    if (controlIndex === -1 || !controlPoses[controlIndex].virtual) {\r\n        return;\r\n    }\r\n    var controlPoseInfo = controlPoses[controlIndex];\r\n    addBorderRadius(controlPoses, controlIndex);\r\n    if (controlIndex < 4) {\r\n        controlPoseInfo.pos[0] = distX;\r\n    }\r\n    else {\r\n        controlPoseInfo.pos[1] = distY;\r\n    }\r\n}\r\nfunction addBorderRadius(controlPoses, index) {\r\n    if (index < 4) {\r\n        controlPoses.slice(0, index + 1).forEach(function (info) {\r\n            info.virtual = false;\r\n        });\r\n    }\r\n    else {\r\n        if (controlPoses[0].virtual) {\r\n            controlPoses[0].virtual = false;\r\n        }\r\n        controlPoses.slice(4, index + 1).forEach(function (info) {\r\n            info.virtual = false;\r\n        });\r\n    }\r\n}\r\nfunction removeBorderRadius(controlPoses, index) {\r\n    if (index < 4) {\r\n        controlPoses.slice(index, 4).forEach(function (info) {\r\n            info.virtual = true;\r\n        });\r\n    }\r\n    else {\r\n        controlPoses.slice(index).forEach(function (info) {\r\n            info.virtual = true;\r\n        });\r\n    }\r\n}\r\nfunction getBorderRadius(borderRadius, width, height, minCounts, full) {\r\n    if (minCounts === void 0) { minCounts = [0, 0]; }\r\n    var values = [];\r\n    if (!borderRadius || borderRadius === \"0px\") {\r\n        values = [];\r\n    }\r\n    else {\r\n        values = splitSpace(borderRadius);\r\n    }\r\n    return getRadiusValues(values, width, height, 0, 0, minCounts, full);\r\n}\r\nfunction triggerRoundEvent(moveable, e, dist, delta, nextPoses) {\r\n    var state = moveable.state;\r\n    var width = state.width, height = state.height;\r\n    var _a = getRadiusStyles(nextPoses, moveable.props.roundRelative, width, height), raws = _a.raws, styles = _a.styles, radiusPoses = _a.radiusPoses;\r\n    var _b = splitRadiusPoses(radiusPoses, raws), horizontals = _b.horizontals, verticals = _b.verticals;\r\n    var borderRadius = styles.join(\" \");\r\n    state.borderRadiusState = borderRadius;\r\n    var params = fillParams(moveable, e, __assign({ horizontals: horizontals, verticals: verticals, borderRadius: borderRadius, width: width, height: height, delta: delta, dist: dist }, fillCSSObject({\r\n        borderRadius: borderRadius,\r\n    }, e)));\r\n    triggerEvent(moveable, \"onRound\", params);\r\n    return params;\r\n}\r\nfunction getStyleBorderRadius(moveable) {\r\n    var _a, _b;\r\n    var style = moveable.getState().style;\r\n    var borderRadius = style.borderRadius || \"\";\r\n    if (!borderRadius && moveable.props.groupable) {\r\n        var firstMoveable = moveable.moveables[0];\r\n        var firstTarget = moveable.getTargets()[0];\r\n        if (firstTarget) {\r\n            if ((firstMoveable === null || firstMoveable === void 0 ? void 0 : firstMoveable.props.target) === firstTarget) {\r\n                borderRadius = (_b = (_a = moveable.moveables[0]) === null || _a === void 0 ? void 0 : _a.state.style.borderRadius) !== null && _b !== void 0 ? _b : \"\";\r\n                style.borderRadius = borderRadius;\r\n            }\r\n            else {\r\n                borderRadius = getComputedStyle(firstTarget).borderRadius;\r\n                style.borderRadius = borderRadius;\r\n            }\r\n        }\r\n    }\r\n    return borderRadius;\r\n}\r\n/**\r\n * @namespace Moveable.Roundable\r\n * @description Whether to show and drag or double click border-radius\r\n */\r\nvar Roundable = {\r\n    name: \"roundable\",\r\n    props: [\r\n        \"roundable\",\r\n        \"roundRelative\",\r\n        \"minRoundControls\",\r\n        \"maxRoundControls\",\r\n        \"roundClickable\",\r\n        \"roundPadding\",\r\n        \"isDisplayShadowRoundControls\",\r\n    ],\r\n    events: [\r\n        \"roundStart\",\r\n        \"round\",\r\n        \"roundEnd\",\r\n        \"roundGroupStart\",\r\n        \"roundGroup\",\r\n        \"roundGroupEnd\",\r\n    ],\r\n    css: [\r\n        \".control.border-radius {\\nbackground: #d66;\\ncursor: pointer;\\nz-index: 3;\\n}\",\r\n        \".control.border-radius.vertical {\\nbackground: #d6d;\\nz-index: 2;\\n}\",\r\n        \".control.border-radius.virtual {\\nopacity: 0.5;\\nz-index: 1;\\n}\",\r\n        \":host.round-line-clickable .line.direction {\\ncursor: pointer;\\n}\",\r\n    ],\r\n    className: function (moveable) {\r\n        var roundClickable = moveable.props.roundClickable;\r\n        return roundClickable === true || roundClickable === \"line\" ? prefix(\"round-line-clickable\") : \"\";\r\n    },\r\n    requestStyle: function () {\r\n        return [\"borderRadius\"];\r\n    },\r\n    requestChildStyle: function () {\r\n        return [\"borderRadius\"];\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = moveable.getState(), target = _a.target, width = _a.width, height = _a.height, allMatrix = _a.allMatrix, is3d = _a.is3d, left = _a.left, top = _a.top, borderRadiusState = _a.borderRadiusState;\r\n        var _b = moveable.props, _c = _b.minRoundControls, minRoundControls = _c === void 0 ? [0, 0] : _c, _d = _b.maxRoundControls, maxRoundControls = _d === void 0 ? [4, 4] : _d, zoom = _b.zoom, _e = _b.roundPadding, roundPadding = _e === void 0 ? 0 : _e, isDisplayShadowRoundControls = _b.isDisplayShadowRoundControls, groupable = _b.groupable;\r\n        if (!target) {\r\n            return null;\r\n        }\r\n        var borderRadius = borderRadiusState || getStyleBorderRadius(moveable);\r\n        var n = is3d ? 4 : 3;\r\n        var radiusValues = getBorderRadius(borderRadius, width, height, minRoundControls, true);\r\n        if (!radiusValues) {\r\n            return null;\r\n        }\r\n        var verticalCount = 0;\r\n        var horizontalCount = 0;\r\n        var basePos = groupable ? [0, 0] : [left, top];\r\n        return radiusValues.map(function (v, i) {\r\n            var horizontal = v.horizontal;\r\n            var vertical = v.vertical;\r\n            var direction = v.direction || \"\";\r\n            var originalPos = __spreadArray([], __read(v.pos), false);\r\n            horizontalCount += Math.abs(horizontal);\r\n            verticalCount += Math.abs(vertical);\r\n            if (horizontal && direction.indexOf(\"n\") > -1) {\r\n                originalPos[1] -= roundPadding;\r\n            }\r\n            if (vertical && direction.indexOf(\"w\") > -1) {\r\n                originalPos[0] -= roundPadding;\r\n            }\r\n            if (horizontal && direction.indexOf(\"s\") > -1) {\r\n                originalPos[1] += roundPadding;\r\n            }\r\n            if (vertical && direction.indexOf(\"e\") > -1) {\r\n                originalPos[0] += roundPadding;\r\n            }\r\n            var pos = minus(calculatePosition(allMatrix, originalPos, n), basePos);\r\n            var isDisplayVerticalShadow = isDisplayShadowRoundControls\r\n                && isDisplayShadowRoundControls !== \"horizontal\";\r\n            var isDisplay = v.vertical\r\n                ? verticalCount <= maxRoundControls[1] && (isDisplayVerticalShadow || !v.virtual)\r\n                : horizontalCount <= maxRoundControls[0] && (isDisplayShadowRoundControls || !v.virtual);\r\n            return React.createElement(\"div\", { key: \"borderRadiusControl\".concat(i), className: prefix(\"control\", \"border-radius\", v.vertical ? \"vertical\" : \"\", v.virtual ? \"virtual\" : \"\"), \"data-radius-index\": i, style: {\r\n                    display: isDisplay ? \"block\" : \"none\",\r\n                    transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) scale(\").concat(zoom, \")\"),\r\n                } });\r\n        });\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (!e.inputEvent || e.isRequest) {\r\n            return false;\r\n        }\r\n        var className = (e.inputEvent.target.getAttribute(\"class\") || \"\");\r\n        return className.indexOf(\"border-radius\") > -1\r\n            || (className.indexOf(\"moveable-line\") > -1 && className.indexOf(\"moveable-direction\") > -1);\r\n    },\r\n    dragGroupControlCondition: function (moveable, e) {\r\n        return this.dragControlCondition(moveable, e);\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var inputEvent = e.inputEvent, datas = e.datas;\r\n        var inputTarget = inputEvent.target;\r\n        var className = (inputTarget.getAttribute(\"class\") || \"\");\r\n        var isControl = className.indexOf(\"border-radius\") > -1;\r\n        var isLine = className.indexOf(\"moveable-line\") > -1 && className.indexOf(\"moveable-direction\") > -1;\r\n        var controlIndex = isControl ? parseInt(inputTarget.getAttribute(\"data-radius-index\"), 10) : -1;\r\n        var lineIndex = -1;\r\n        if (isLine) {\r\n            var indexAttr = inputTarget.getAttribute(\"data-line-key\") || \"\";\r\n            if (indexAttr) {\r\n                lineIndex = parseInt(indexAttr.replace(/render-line-/g, \"\"), 10);\r\n                if (isNaN(lineIndex)) {\r\n                    lineIndex = -1;\r\n                }\r\n            }\r\n        }\r\n        if (!isControl && !isLine) {\r\n            return false;\r\n        }\r\n        var params = fillParams(moveable, e, {});\r\n        var result = triggerEvent(moveable, \"onRoundStart\", params);\r\n        if (result === false) {\r\n            return false;\r\n        }\r\n        datas.lineIndex = lineIndex;\r\n        datas.controlIndex = controlIndex;\r\n        datas.isControl = isControl;\r\n        datas.isLine = isLine;\r\n        setDragStart(moveable, e);\r\n        var _a = moveable.props, roundRelative = _a.roundRelative, _b = _a.minRoundControls, minRoundControls = _b === void 0 ? [0, 0] : _b;\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height;\r\n        datas.isRound = true;\r\n        datas.prevDist = [0, 0];\r\n        var borderRadius = getStyleBorderRadius(moveable);\r\n        var controlPoses = getBorderRadius(borderRadius || \"\", width, height, minRoundControls, true) || [];\r\n        datas.controlPoses = controlPoses;\r\n        state.borderRadiusState = getRadiusStyles(controlPoses, roundRelative, width, height).styles.join(\" \");\r\n        return params;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var controlPoses = datas.controlPoses;\r\n        if (!datas.isRound || !datas.isControl || !controlPoses.length) {\r\n            return false;\r\n        }\r\n        var index = datas.controlIndex;\r\n        var _a = __read(getDragDist(e), 2), distX = _a[0], distY = _a[1];\r\n        var dist = [distX, distY];\r\n        var delta = minus(dist, datas.prevDist);\r\n        var _b = moveable.props.maxRoundControls, maxRoundControls = _b === void 0 ? [4, 4] : _b;\r\n        var _c = moveable.state, width = _c.width, height = _c.height;\r\n        var selectedControlPose = controlPoses[index];\r\n        var selectedVertical = selectedControlPose.vertical;\r\n        var selectedHorizontal = selectedControlPose.horizontal;\r\n        // 0: [0, 1, 2, 3] maxCount === 1\r\n        // 0: [0, 2] maxCount === 2\r\n        // 1: [1, 3] maxCount === 2\r\n        // 0: [0] maxCount === 3\r\n        // 1: [1, 3] maxCount === 3\r\n        var dists = controlPoses.map(function (pose) {\r\n            var horizontal = pose.horizontal, vertical = pose.vertical;\r\n            var poseDist = [\r\n                horizontal * selectedHorizontal * dist[0],\r\n                vertical * selectedVertical * dist[1],\r\n            ];\r\n            if (horizontal) {\r\n                if (maxRoundControls[0] === 1) {\r\n                    return poseDist;\r\n                }\r\n                else if (maxRoundControls[0] < 4 && horizontal !== selectedHorizontal) {\r\n                    return poseDist;\r\n                }\r\n            }\r\n            else if (maxRoundControls[1] === 0) {\r\n                poseDist[1] = vertical * selectedHorizontal * dist[0] / width * height;\r\n                return poseDist;\r\n            }\r\n            else if (selectedVertical) {\r\n                if (maxRoundControls[1] === 1) {\r\n                    return poseDist;\r\n                }\r\n                else if (maxRoundControls[1] < 4 && vertical !== selectedVertical) {\r\n                    return poseDist;\r\n                }\r\n            }\r\n            return [0, 0];\r\n        });\r\n        dists[index] = dist;\r\n        var nextPoses = controlPoses.map(function (info, i) {\r\n            return __assign(__assign({}, info), { pos: plus(info.pos, dists[i]) });\r\n        });\r\n        if (index < 4) {\r\n            nextPoses.slice(0, index + 1).forEach(function (info) {\r\n                info.virtual = false;\r\n            });\r\n        }\r\n        else {\r\n            nextPoses.slice(4, index + 1).forEach(function (info) {\r\n                info.virtual = false;\r\n            });\r\n        }\r\n        datas.prevDist = [distX, distY];\r\n        return triggerRoundEvent(moveable, e, dist, delta, nextPoses);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var state = moveable.state;\r\n        state.borderRadiusState = \"\";\r\n        var datas = e.datas, isDouble = e.isDouble;\r\n        if (!datas.isRound) {\r\n            return false;\r\n        }\r\n        var isControl = datas.isControl, controlIndex = datas.controlIndex, isLine = datas.isLine, lineIndex = datas.lineIndex;\r\n        var controlPoses = datas.controlPoses;\r\n        var length = controlPoses.filter(function (_a) {\r\n            var virtual = _a.virtual;\r\n            return virtual;\r\n        }).length;\r\n        var _a = moveable.props.roundClickable, roundClickable = _a === void 0 ? true : _a;\r\n        if (isDouble && roundClickable) {\r\n            if (isControl && (roundClickable === true || roundClickable === \"control\")) {\r\n                removeBorderRadius(controlPoses, controlIndex);\r\n            }\r\n            else if (isLine && (roundClickable === true || roundClickable === \"line\")) {\r\n                var _b = __read(calculatePointerDist(moveable, e), 2), distX = _b[0], distY = _b[1];\r\n                addBorderRadiusByLine(controlPoses, lineIndex, distX, distY);\r\n            }\r\n            if (length !== controlPoses.filter(function (_a) {\r\n                var virtual = _a.virtual;\r\n                return virtual;\r\n            }).length) {\r\n                triggerRoundEvent(moveable, e, [0, 0], [0, 0], controlPoses);\r\n            }\r\n        }\r\n        var params = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onRoundEnd\", params);\r\n        state.borderRadiusState = \"\";\r\n        return params;\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var result = this.dragControlStart(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                return __assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] });\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroupStart\", nextParams);\r\n        return result;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var result = this.dragControl(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                return __assign(__assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] }), fillCSSObject({\r\n                    borderRadius: result.borderRadius,\r\n                }, ev));\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        catchEvent(moveable, \"onRound\", function (parentEvent) {\r\n            var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                    return __assign(__assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] }), fillCSSObject({\r\n                        borderRadius: parentEvent.borderRadius,\r\n                    }, ev));\r\n                }) }, parentEvent);\r\n            triggerEvent(moveable, \"onRoundGroup\", nextParams);\r\n        });\r\n        var result = this.dragControlEnd(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                var _a;\r\n                return __assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i], lastEvent: (_a = ev.datas) === null || _a === void 0 ? void 0 : _a.lastEvent });\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroupEnd\", nextParams);\r\n        return nextParams;\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.borderRadiusState = \"\";\r\n    },\r\n};\r\n/**\r\n * Whether to show and drag or double click border-radius, (default: false)\r\n * @name Moveable.Roundable#roundable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px\r\n * @name Moveable.Roundable#roundRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * Minimum number of round controls. It moves in proportion by control. [horizontal, vertical] (default: [0, 0])\r\n * @name Moveable.Roundable#minRoundControls\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     minRoundControls: [0, 0],\r\n * });\r\n * moveable.minRoundControls = [1, 0];\r\n */\r\n/**\r\n * Maximum number of round controls. It moves in proportion by control. [horizontal, vertical] (default: [4, 4])\r\n * @name Moveable.Roundable#maxRoundControls\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     maxRoundControls: [4, 4],\r\n * });\r\n * moveable.maxRoundControls = [1, 0];\r\n */\r\n/**\r\n * Whether you can add/delete round controls by double-clicking a line or control.\r\n * @name Moveable.Roundable#roundClickable\r\n * @default true\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     roundClickable: true,\r\n * });\r\n * moveable.roundClickable = false;\r\n */\r\n/**\r\n * Whether to show a round control that does not actually exist as a shadow\r\n * @name Moveable.Roundable#isDisplayShadowRoundControls\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     isDisplayShadowRoundControls: false,\r\n * });\r\n * moveable.isDisplayShadowRoundControls = true;\r\n */\r\n/**\r\n * The padding value of the position of the round control\r\n * @name Moveable.Roundable#roundPadding\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundPadding: 0,\r\n * });\r\n * moveable.roundPadding = 15;\r\n */\r\n/**\r\n * When drag start the clip area or controls, the `roundStart` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundStart\r\n * @param {Moveable.Roundable.OnRoundStart} - Parameters for the `roundStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag or double click the border area or controls, the `round` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event round\r\n * @param {Moveable.Roundable.OnRound} - Parameters for the `round` event\r\n * @example\r\n  * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the border area or controls, the `roundEnd` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundEnd\r\n * @param {Moveable.Roundable.onRoundEnd} - Parameters for the `roundEnd` event\r\n * @example\r\n  * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag start the clip area or controls, the `roundGroupStart` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroupStart\r\n * @param {Moveable.Roundable.OnRoundGroupStart} - Parameters for the `roundGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *   e.events.forEach(ev => {\r\n *       ev.target.style.cssText += ev.cssText;\r\n *   });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag or double click the border area or controls, the `roundGroup` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroup\r\n * @param {Moveable.Roundable.OnRoundGroup} - Parameters for the `roundGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *   e.events.forEach(ev => {\r\n *       ev.target.style.cssText += ev.cssText;\r\n *   });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the border area or controls, the `roundGroupEnd` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroupEnd\r\n * @param {Moveable.Roundable.onRoundGroupEnd} - Parameters for the `roundGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *     e.events.forEach(ev => {\r\n *         ev.target.style.cssText += ev.cssText;\r\n *     });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\n\nfunction isIdentityMatrix(matrix, is3d) {\r\n    var n = is3d ? 4 : 3;\r\n    var identityMatrix = createIdentityMatrix(n);\r\n    var value = \"matrix\".concat(is3d ? \"3d\" : \"\", \"(\").concat(identityMatrix.join(\",\"), \")\");\r\n    return matrix === value || matrix === \"matrix(1,0,0,1,0,0)\";\r\n}\r\nvar BeforeRenderable = {\r\n    isPinch: true,\r\n    name: \"beforeRenderable\",\r\n    props: [],\r\n    events: [\r\n        \"beforeRenderStart\",\r\n        \"beforeRender\",\r\n        \"beforeRenderEnd\",\r\n        \"beforeRenderGroupStart\",\r\n        \"beforeRenderGroup\",\r\n        \"beforeRenderGroupEnd\",\r\n    ],\r\n    dragRelation: \"weak\",\r\n    setTransform: function (moveable, e) {\r\n        var _a = moveable.state, is3d = _a.is3d, targetMatrix = _a.targetMatrix, inlineTransform = _a.inlineTransform;\r\n        var cssMatrix = is3d\r\n            ? \"matrix3d(\".concat(targetMatrix.join(\",\"), \")\")\r\n            : \"matrix(\".concat(convertMatrixtoCSS(targetMatrix, true), \")\");\r\n        var startTransform = !inlineTransform || inlineTransform === \"none\" ? cssMatrix : inlineTransform;\r\n        e.datas.startTransforms = isIdentityMatrix(startTransform, is3d) ? [] : splitSpace(startTransform);\r\n    },\r\n    resetStyle: function (e) {\r\n        var datas = e.datas;\r\n        datas.nextStyle = {};\r\n        datas.nextTransforms = e.datas.startTransforms;\r\n        datas.nextTransformAppendedIndexes = [];\r\n    },\r\n    fillDragStartParams: function (moveable, e) {\r\n        return fillParams(moveable, e, {\r\n            setTransform: function (transform) {\r\n                e.datas.startTransforms = isArray(transform) ? transform : splitSpace(transform);\r\n            },\r\n            isPinch: !!e.isPinch,\r\n        });\r\n    },\r\n    fillDragParams: function (moveable, e) {\r\n        return fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        });\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        this.setTransform(moveable, e);\r\n        this.resetStyle(e);\r\n        triggerEvent(moveable, \"onBeforeRenderStart\", this.fillDragStartParams(moveable, e));\r\n    },\r\n    drag: function (moveable, e) {\r\n        if (!e.datas.startTransforms) {\r\n            this.setTransform(moveable, e);\r\n        }\r\n        this.resetStyle(e);\r\n        triggerEvent(moveable, \"onBeforeRender\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        }));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        if (!e.datas.startTransforms) {\r\n            this.setTransform(moveable, e);\r\n            this.resetStyle(e);\r\n        }\r\n        triggerEvent(moveable, \"onBeforeRenderEnd\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            isDrag: e.isDrag,\r\n        }));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        var _this = this;\r\n        this.dragStart(moveable, e);\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            _this.setTransform(childMoveable, childEvent);\r\n            _this.resetStyle(childEvent);\r\n            return _this.fillDragStartParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onBeforeRenderGroupStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n            setTransform: function () { },\r\n            events: params,\r\n        }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var _this = this;\r\n        this.drag(moveable, e);\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            _this.resetStyle(childEvent);\r\n            return _this.fillDragParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onBeforeRenderGroup\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n            events: params,\r\n        }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n        triggerEvent(moveable, \"onBeforeRenderGroupEnd\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            isDrag: e.isDrag,\r\n            targets: moveable.props.targets,\r\n        }));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragGroupStart(moveable, e);\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.dragGroup(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        return this.dragGroupEnd(moveable, e);\r\n    },\r\n};\n\nvar Renderable = {\r\n    name: \"renderable\",\r\n    props: [],\r\n    events: [\r\n        \"renderStart\",\r\n        \"render\",\r\n        \"renderEnd\",\r\n        \"renderGroupStart\",\r\n        \"renderGroup\",\r\n        \"renderGroupEnd\",\r\n    ],\r\n    dragRelation: \"weak\",\r\n    dragStart: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        }));\r\n    },\r\n    drag: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRender\", this.fillDragParams(moveable, e));\r\n    },\r\n    dragAfter: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderEnd\", this.fillDragEndParams(moveable, e));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderGroupStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n        }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var _this = this;\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            return _this.fillDragParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onRenderGroup\", fillParams(moveable, e, __assign(__assign({ isPinch: !!e.isPinch, targets: moveable.props.targets, transform: getNextTransformText(e), transformObject: {} }, fillCSSObject(getNextStyle(e))), { events: params })));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var _this = this;\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            return _this.fillDragEndParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onRenderGroupEnd\", fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, isDrag: e.isDrag, targets: moveable.props.targets, events: params, transformObject: {}, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e)))));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlAfter: function (moveable, e) {\r\n        return this.dragAfter(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragGroupStart(moveable, e);\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.dragGroup(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        return this.dragGroupEnd(moveable, e);\r\n    },\r\n    fillDragParams: function (moveable, e) {\r\n        var transformObject = {};\r\n        parse(getNextTransforms(e) || []).forEach(function (matrixInfo) {\r\n            transformObject[matrixInfo.name] = matrixInfo.functionValue;\r\n        });\r\n        return fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, transformObject: transformObject, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e))));\r\n    },\r\n    fillDragEndParams: function (moveable, e) {\r\n        var transformObject = {};\r\n        parse(getNextTransforms(e) || []).forEach(function (matrixInfo) {\r\n            transformObject[matrixInfo.name] = matrixInfo.functionValue;\r\n        });\r\n        return fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, isDrag: e.isDrag, transformObject: transformObject, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e))));\r\n    },\r\n};\n\nfunction triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType, e, requestInstant) {\r\n    // pre setting\r\n    e.clientDistX = e.distX;\r\n    e.clientDistY = e.distY;\r\n    var isStart = eventType === \"Start\";\r\n    var isEnd = eventType === \"End\";\r\n    var isAfter = eventType === \"After\";\r\n    var target = moveable.state.target;\r\n    var isRequest = e.isRequest;\r\n    var isControl = eventAffix.indexOf(\"Control\") > -1;\r\n    if (!target\r\n        || (isStart && isControl && !isRequest && moveable.areaElement === e.inputEvent.target)) {\r\n        return false;\r\n    }\r\n    var ables = __spreadArray([], __read(moveableAbles), false);\r\n    if (isRequest) {\r\n        var requestAble_1 = e.requestAble;\r\n        if (!ables.some(function (able) { return able.name === requestAble_1; })) {\r\n            ables.push.apply(ables, __spreadArray([], __read(moveable.props.ables.filter(function (able) { return able.name === requestAble_1; })), false));\r\n        }\r\n    }\r\n    if (!ables.length || ables.every(function (able) { return able.dragRelation; })) {\r\n        return false;\r\n    }\r\n    // \"drag\" \"Control\" \"After\"\r\n    var inputEvent = e.inputEvent;\r\n    var inputTarget;\r\n    if (isEnd && inputEvent) {\r\n        inputTarget = document.elementFromPoint(e.clientX, e.clientY) || inputEvent.target;\r\n    }\r\n    var isDragStop = false;\r\n    var stop = function () {\r\n        var _a;\r\n        isDragStop = true;\r\n        (_a = e.stop) === null || _a === void 0 ? void 0 : _a.call(e);\r\n    };\r\n    var isFirstStart = isStart && (!moveable.targetGesto || !moveable.controlGesto\r\n        || (!moveable.targetGesto.isFlag() || !moveable.controlGesto.isFlag()));\r\n    if (isFirstStart) {\r\n        moveable.updateRect(eventType, true, false);\r\n    }\r\n    // trigger ables\r\n    var datas = e.datas;\r\n    var gestoType = isControl ? \"controlGesto\" : \"targetGesto\";\r\n    var prevGesto = moveable[gestoType];\r\n    var trigger = function (able, eventName, conditionName) {\r\n        if (!(eventName in able) || prevGesto !== moveable[gestoType]) {\r\n            return false;\r\n        }\r\n        var ableName = able.name;\r\n        var nextDatas = datas[ableName] || (datas[ableName] = {});\r\n        if (isStart) {\r\n            nextDatas.isEventStart = !conditionName\r\n                || !able[conditionName] || able[conditionName](moveable, e);\r\n        }\r\n        if (!nextDatas.isEventStart) {\r\n            return false;\r\n        }\r\n        var result = able[eventName](moveable, __assign(__assign({}, e), { stop: stop, datas: nextDatas, originalDatas: datas, inputTarget: inputTarget }));\r\n        moveable._emitter.off();\r\n        if (isStart && result === false) {\r\n            nextDatas.isEventStart = false;\r\n        }\r\n        return result;\r\n    };\r\n    // unset ables for first drag start\r\n    if (isFirstStart) {\r\n        ables.forEach(function (able) {\r\n            able.unset && able.unset(moveable);\r\n        });\r\n    }\r\n    // BeforeRenderable\r\n    trigger(BeforeRenderable, \"drag\".concat(eventAffix).concat(eventType));\r\n    var forceEndedCount = 0;\r\n    var updatedCount = 0;\r\n    eventOperations.forEach(function (eventOperation) {\r\n        if (isDragStop) {\r\n            return false;\r\n        }\r\n        var eventName = \"\".concat(eventOperation).concat(eventAffix).concat(eventType);\r\n        var conditionName = \"\".concat(eventOperation).concat(eventAffix, \"Condition\");\r\n        if (eventType === \"\" && !isRequest) {\r\n            // Convert distX, distY\r\n            convertDragDist(moveable.state, e);\r\n        }\r\n        // const isGroup = eventAffix.indexOf(\"Group\") > -1;\r\n        var eventAbles = ables.filter(function (able) { return able[eventName]; });\r\n        eventAbles = eventAbles.filter(function (able, i) {\r\n            return able.name && eventAbles.indexOf(able) === i;\r\n        });\r\n        var results = eventAbles.filter(function (able) { return trigger(able, eventName, conditionName); });\r\n        var isUpdate = results.length;\r\n        // end ables\r\n        if (isDragStop) {\r\n            ++forceEndedCount;\r\n        }\r\n        if (isUpdate) {\r\n            ++updatedCount;\r\n        }\r\n        if (!isDragStop && isStart && eventAbles.length && !isUpdate) {\r\n            forceEndedCount += eventAbles.filter(function (able) {\r\n                var ableName = able.name;\r\n                var nextDatas = datas[ableName];\r\n                if (nextDatas.isEventStart) {\r\n                    if (able.dragRelation === \"strong\") {\r\n                        return false;\r\n                    }\r\n                    // stop drag\r\n                    return true;\r\n                }\r\n                // pre stop drag\r\n                return false;\r\n            }).length ? 1 : 0;\r\n        }\r\n    });\r\n    if (!isAfter || updatedCount) {\r\n        trigger(Renderable, \"drag\".concat(eventAffix).concat(eventType));\r\n    }\r\n    // stop gesto condition\r\n    var isForceEnd = prevGesto !== moveable[gestoType] || forceEndedCount === eventOperations.length;\r\n    if (isEnd || isDragStop || isForceEnd) {\r\n        moveable.state.gestos = {};\r\n        if (moveable.moveables) {\r\n            moveable.moveables.forEach(function (childMoveable) {\r\n                childMoveable.state.gestos = {};\r\n            });\r\n        }\r\n        ables.forEach(function (able) {\r\n            able.unset && able.unset(moveable);\r\n        });\r\n    }\r\n    if (isStart && !isForceEnd && !isRequest && updatedCount && moveable.props.preventDefault) {\r\n        e === null || e === void 0 ? void 0 : e.preventDefault();\r\n    }\r\n    if (moveable.isUnmounted || isForceEnd) {\r\n        return false;\r\n    }\r\n    if ((!isStart && updatedCount && !requestInstant) || isEnd) {\r\n        var flushSync = moveable.props.flushSync || defaultSync;\r\n        flushSync(function () {\r\n            moveable.updateRect(isEnd ? eventType : \"\", true, false);\r\n            moveable.forceUpdate();\r\n        });\r\n    }\r\n    if (!isStart && !isEnd && !isAfter && updatedCount && !requestInstant) {\r\n        triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType + \"After\", e);\r\n    }\r\n    return true;\r\n}\r\nfunction checkMoveableTarget(moveable, isControl) {\r\n    return function (e, target) {\r\n        var _a;\r\n        if (target === void 0) { target = e.inputEvent.target; }\r\n        var eventTarget = target;\r\n        var areaElement = moveable.areaElement;\r\n        var dragTargetElement = moveable._dragTarget;\r\n        if (!dragTargetElement || (!isControl && ((_a = moveable.controlGesto) === null || _a === void 0 ? void 0 : _a.isFlag()))) {\r\n            return false;\r\n        }\r\n        return eventTarget === dragTargetElement\r\n            || dragTargetElement.contains(eventTarget)\r\n            || eventTarget === areaElement\r\n            || (!moveable.isMoveableElement(eventTarget) && !moveable.controlBox.contains(eventTarget))\r\n            || hasClass(eventTarget, \"moveable-area\")\r\n            || hasClass(eventTarget, \"moveable-padding\")\r\n            || hasClass(eventTarget, \"moveable-edgeDraggable\");\r\n    };\r\n}\r\nfunction getTargetAbleGesto(moveable, moveableTarget, eventAffix) {\r\n    var controlBox = moveable.controlBox;\r\n    var targets = [];\r\n    var props = moveable.props;\r\n    var dragArea = props.dragArea;\r\n    var target = moveable.state.target;\r\n    var dragTarget = props.dragTarget;\r\n    targets.push(controlBox);\r\n    if (!dragArea || dragTarget) {\r\n        targets.push(moveableTarget);\r\n    }\r\n    if (!dragArea && dragTarget && target && moveableTarget !== target && props.dragTargetSelf) {\r\n        targets.push(target);\r\n    }\r\n    var checkTarget = checkMoveableTarget(moveable);\r\n    return getAbleGesto(moveable, targets, \"targetAbles\", eventAffix, {\r\n        dragStart: checkTarget,\r\n        pinchStart: checkTarget,\r\n    });\r\n}\r\nfunction getControlAbleGesto(moveable, eventAffix) {\r\n    var controlBox = moveable.controlBox;\r\n    var targets = [];\r\n    targets.push(controlBox);\r\n    var checkTarget = checkMoveableTarget(moveable, true);\r\n    var checkControlTarget = function (e, target) {\r\n        if (target === void 0) { target = e.inputEvent.target; }\r\n        if (target === controlBox) {\r\n            return true;\r\n        }\r\n        var result = checkTarget(e, target);\r\n        return !result;\r\n    };\r\n    return getAbleGesto(moveable, targets, \"controlAbles\", eventAffix, {\r\n        dragStart: checkControlTarget,\r\n        pinchStart: checkControlTarget,\r\n    });\r\n}\r\nfunction getAbleGesto(moveable, target, ableType, eventAffix, conditionFunctions) {\r\n    if (conditionFunctions === void 0) { conditionFunctions = {}; }\r\n    var isTargetAbles = ableType === \"targetAbles\";\r\n    var _a = moveable.props, pinchOutside = _a.pinchOutside, pinchThreshold = _a.pinchThreshold, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickDefault = _a.preventClickDefault, checkInput = _a.checkInput, dragFocusedInput = _a.dragFocusedInput, _b = _a.preventDefault, preventDefault = _b === void 0 ? true : _b, _c = _a.preventRightClick, preventRightClick = _c === void 0 ? true : _c, _d = _a.preventWheelClick, preventWheelClick = _d === void 0 ? true : _d, dragContaienrOption = _a.dragContainer;\r\n    var dragContainer = getRefTarget(dragContaienrOption, true);\r\n    var options = {\r\n        preventDefault: preventDefault,\r\n        preventRightClick: preventRightClick,\r\n        preventWheelClick: preventWheelClick,\r\n        container: dragContainer || getWindow(moveable.getControlBoxElement()),\r\n        pinchThreshold: pinchThreshold,\r\n        pinchOutside: pinchOutside,\r\n        preventClickEventOnDrag: isTargetAbles ? preventClickEventOnDrag : false,\r\n        preventClickEventOnDragStart: isTargetAbles ? preventClickDefault : false,\r\n        preventClickEventByCondition: isTargetAbles ? null : function (e) {\r\n            return moveable.controlBox.contains(e.target);\r\n        },\r\n        checkInput: isTargetAbles ? checkInput : false,\r\n        dragFocusedInput: dragFocusedInput,\r\n    };\r\n    var gesto = new Gesto(target, options);\r\n    var isControl = eventAffix === \"Control\";\r\n    [\"drag\", \"pinch\"].forEach(function (eventOperation) {\r\n        [\"Start\", \"\", \"End\"].forEach(function (eventType) {\r\n            gesto.on(\"\".concat(eventOperation).concat(eventType), function (e) {\r\n                var _a;\r\n                var eventName = e.eventType;\r\n                var isPinchScheduled = eventOperation === \"drag\" && e.isPinch;\r\n                if (conditionFunctions[eventName] && !conditionFunctions[eventName](e)) {\r\n                    e.stop();\r\n                    return;\r\n                }\r\n                if (isPinchScheduled) {\r\n                    return;\r\n                }\r\n                var eventOperations = eventOperation === \"drag\" ? [eventOperation] : [\"drag\", eventOperation];\r\n                var moveableAbles = __spreadArray([], __read(moveable[ableType]), false);\r\n                var result = triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType, e);\r\n                if (!result) {\r\n                    e.stop();\r\n                }\r\n                else if (moveable.props.stopPropagation || (eventType === \"Start\" && isControl)) {\r\n                    (_a = e === null || e === void 0 ? void 0 : e.inputEvent) === null || _a === void 0 ? void 0 : _a.stopPropagation();\r\n                }\r\n            });\r\n        });\r\n    });\r\n    return gesto;\r\n}\n\nvar EventManager = /*#__PURE__*/ (function () {\r\n    function EventManager(target, moveable, eventName) {\r\n        var _this = this;\r\n        this.target = target;\r\n        this.moveable = moveable;\r\n        this.eventName = eventName;\r\n        this.ables = [];\r\n        this._onEvent = function (e) {\r\n            var eventName = _this.eventName;\r\n            var moveable = _this.moveable;\r\n            if (moveable.state.disableNativeEvent) {\r\n                return;\r\n            }\r\n            _this.ables.forEach(function (able) {\r\n                able[eventName](moveable, {\r\n                    inputEvent: e,\r\n                });\r\n            });\r\n        };\r\n        target.addEventListener(eventName.toLowerCase(), this._onEvent);\r\n    }\r\n    EventManager.prototype.setAbles = function (ables) {\r\n        this.ables = ables;\r\n    };\r\n    EventManager.prototype.destroy = function () {\r\n        this.target.removeEventListener(this.eventName.toLowerCase(), this._onEvent);\r\n        this.target = null;\r\n        this.moveable = null;\r\n    };\r\n    return EventManager;\r\n}());\n\nfunction calculateMatrixStack(target, container, rootContainer, isAbsolute3d) {\r\n    var _a;\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    var _b = getMatrixStackInfo(target, container), matrixes = _b.matrixes, is3d = _b.is3d, prevTargetMatrix = _b.targetMatrix, transformOrigin = _b.transformOrigin, targetOrigin = _b.targetOrigin, offsetContainer = _b.offsetContainer, hasFixed = _b.hasFixed, containerZoom = _b.zoom; // prevMatrix\r\n    var _c = getCachedMatrixContainerInfo(offsetContainer, rootContainer), rootMatrixes = _c.matrixes, isRoot3d = _c.is3d, offsetRootContainer = _c.offsetContainer, rootZoom = _c.zoom; // prevRootMatrix\r\n    // if (rootContainer === document.body) {\r\n    //     console.log(offsetContainer, rootContainer, rootMatrixes);\r\n    // }\r\n    var isNext3d = isAbsolute3d || isRoot3d || is3d;\r\n    var n = isNext3d ? 4 : 3;\r\n    var isSVGGraphicElement = target.tagName.toLowerCase() !== \"svg\" && \"ownerSVGElement\" in target;\r\n    var targetMatrix = prevTargetMatrix;\r\n    // let allMatrix = prevMatrix ? convertDimension(prevMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    // let rootMatrix = prevRootMatrix ? convertDimension(prevRootMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    // let beforeMatrix = prevMatrix ? convertDimension(prevMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    var allMatrix = createIdentityMatrix(n);\r\n    var rootMatrix = createIdentityMatrix(n);\r\n    var beforeMatrix = createIdentityMatrix(n);\r\n    var offsetMatrix = createIdentityMatrix(n);\r\n    var length = matrixes.length;\r\n    var nextRootMatrixes = rootMatrixes.map(function (info) {\r\n        return __assign(__assign({}, info), { matrix: info.matrix ? __spreadArray([], __read(info.matrix), false) : undefined });\r\n    }).reverse();\r\n    matrixes.reverse();\r\n    if (!is3d && isNext3d) {\r\n        targetMatrix = convertDimension(targetMatrix, 3, 4);\r\n        convert3DMatrixes(matrixes);\r\n    }\r\n    if (!isRoot3d && isNext3d) {\r\n        convert3DMatrixes(nextRootMatrixes);\r\n    }\r\n    // rootMatrix = (...) -> container -> offset -> absolute -> offset -> absolute(targetMatrix)\r\n    // rootMatrixBeforeOffset = lastOffsetMatrix -> (...) -> container\r\n    // beforeMatrix = (... -> container -> offset -> absolute) -> offset -> absolute(targetMatrix)\r\n    // offsetMatrix = (... -> container -> offset -> absolute -> offset) -> absolute(targetMatrix)\r\n    nextRootMatrixes.forEach(function (info) {\r\n        rootMatrix = multiply(rootMatrix, info.matrix, n);\r\n    });\r\n    var originalRootContainer = rootContainer || getDocumentBody(target);\r\n    var endContainer = ((_a = nextRootMatrixes[0]) === null || _a === void 0 ? void 0 : _a.target)\r\n        || getOffsetInfo(originalRootContainer, originalRootContainer, true).offsetParent;\r\n    var rootMatrixBeforeOffset = nextRootMatrixes.slice(1).reduce(function (matrix, info) {\r\n        return multiply(matrix, info.matrix, n);\r\n    }, createIdentityMatrix(n));\r\n    matrixes.forEach(function (info, i) {\r\n        if (length - 2 === i) {\r\n            // length - 3\r\n            beforeMatrix = allMatrix.slice();\r\n        }\r\n        if (length - 1 === i) {\r\n            // length - 2\r\n            offsetMatrix = allMatrix.slice();\r\n        }\r\n        // calculate for SVGElement\r\n        if (!info.matrix) {\r\n            var nextInfo = matrixes[i + 1];\r\n            var offset = getSVGOffset(info, nextInfo, endContainer, n, multiply(rootMatrixBeforeOffset, allMatrix, n));\r\n            info.matrix = createOriginMatrix(offset, n);\r\n        }\r\n        allMatrix = multiply(allMatrix, info.matrix, n);\r\n    });\r\n    var isMatrix3d = !isSVGGraphicElement && is3d;\r\n    if (!targetMatrix) {\r\n        targetMatrix = createIdentityMatrix(isMatrix3d ? 4 : 3);\r\n    }\r\n    var targetTransform = makeMatrixCSS(isSVGGraphicElement && targetMatrix.length === 16\r\n        ? convertDimension(targetMatrix, 4, 3) : targetMatrix, isMatrix3d);\r\n    var originalRootMatrix = rootMatrix;\r\n    rootMatrix = ignoreDimension(rootMatrix, n, n);\r\n    return {\r\n        hasZoom: containerZoom !== 1 || rootZoom !== 1,\r\n        hasFixed: hasFixed,\r\n        matrixes: matrixes,\r\n        rootMatrix: rootMatrix,\r\n        originalRootMatrix: originalRootMatrix,\r\n        beforeMatrix: beforeMatrix,\r\n        offsetMatrix: offsetMatrix,\r\n        allMatrix: allMatrix,\r\n        targetMatrix: targetMatrix,\r\n        targetTransform: targetTransform,\r\n        inlineTransform: target.style.transform,\r\n        transformOrigin: transformOrigin,\r\n        targetOrigin: targetOrigin,\r\n        is3d: isNext3d,\r\n        offsetContainer: offsetContainer,\r\n        offsetRootContainer: offsetRootContainer,\r\n    };\r\n}\n\nfunction calculateElementInfo(target, container, rootContainer, isAbsolute3d) {\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    var width = 0;\r\n    var height = 0;\r\n    var rotation = 0;\r\n    var allResult = {};\r\n    var sizes = getSize(target);\r\n    if (target) {\r\n        width = sizes.offsetWidth;\r\n        height = sizes.offsetHeight;\r\n    }\r\n    if (target) {\r\n        var result = calculateMatrixStack(target, container, rootContainer, isAbsolute3d);\r\n        var position = calculateElementPosition(result.allMatrix, result.transformOrigin, width, height);\r\n        allResult = __assign(__assign({}, result), position);\r\n        var rotationPosition = calculateElementPosition(result.allMatrix, [50, 50], 100, 100);\r\n        rotation = getRotationRad([rotationPosition.pos1, rotationPosition.pos2], rotationPosition.direction);\r\n    }\r\n    var n = isAbsolute3d ? 4 : 3;\r\n    return __assign(__assign(__assign({ hasZoom: false, width: width, height: height, rotation: rotation }, sizes), { originalRootMatrix: createIdentityMatrix(n), rootMatrix: createIdentityMatrix(n), beforeMatrix: createIdentityMatrix(n), offsetMatrix: createIdentityMatrix(n), allMatrix: createIdentityMatrix(n), targetMatrix: createIdentityMatrix(n), targetTransform: \"\", inlineTransform: \"\", transformOrigin: [0, 0], targetOrigin: [0, 0], is3d: !!isAbsolute3d, left: 0, top: 0, right: 0, bottom: 0, origin: [0, 0], pos1: [0, 0], pos2: [0, 0], pos3: [0, 0], pos4: [0, 0], direction: 1, hasFixed: false, offsetContainer: null, offsetRootContainer: null, matrixes: [] }), allResult);\r\n}\r\nfunction getElementInfo(target, container, rootContainer) {\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    return calculateElementInfo(target, container, rootContainer, true);\r\n}\n\nfunction getMoveableTargetInfo(moveableElement, target, container, parentContainer, rootContainer, requestStyles) {\r\n    if (requestStyles === void 0) { requestStyles = []; }\r\n    var beforeDirection = 1;\r\n    var beforeOrigin = [0, 0];\r\n    var targetClientRect = resetClientRect();\r\n    var moveableClientRect = resetClientRect();\r\n    var containerClientRect = resetClientRect();\r\n    var rootContainerClientRect = resetClientRect();\r\n    var offsetDelta = [0, 0];\r\n    var style = {};\r\n    var result = calculateElementInfo(target, container, rootContainer, true);\r\n    if (target) {\r\n        var getStyle_1 = getCachedStyle(target);\r\n        requestStyles.forEach(function (name) {\r\n            style[name] = getStyle_1(name);\r\n        });\r\n        var n = result.is3d ? 4 : 3;\r\n        var beforePosition = calculateElementPosition(result.offsetMatrix, plus(result.transformOrigin, getOrigin(result.targetMatrix, n)), result.width, result.height);\r\n        beforeDirection = beforePosition.direction;\r\n        beforeOrigin = plus(beforePosition.origin, [beforePosition.left - result.left, beforePosition.top - result.top]);\r\n        rootContainerClientRect = getClientRect(result.offsetRootContainer);\r\n        var offsetContainer = getOffsetInfo(parentContainer, parentContainer, true).offsetParent\r\n            || result.offsetRootContainer;\r\n        if (result.hasZoom) {\r\n            var absoluteTargetPosition = calculateElementPosition(multiply(result.originalRootMatrix, result.allMatrix), result.transformOrigin, result.width, result.height);\r\n            var absoluteContainerPosition = calculateElementPosition(result.originalRootMatrix, getTransformOriginArray(getCachedStyle(offsetContainer)(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); }), offsetContainer.offsetWidth, offsetContainer.offsetHeight);\r\n            targetClientRect = getClientRectByPosition(absoluteTargetPosition, rootContainerClientRect);\r\n            containerClientRect = getClientRectByPosition(absoluteContainerPosition, rootContainerClientRect, offsetContainer, true);\r\n            if (moveableElement) {\r\n                var left = absoluteTargetPosition.left;\r\n                var top_1 = absoluteTargetPosition.top;\r\n                moveableClientRect = getClientRectByPosition({\r\n                    left: left,\r\n                    top: top_1,\r\n                    bottom: top_1,\r\n                    right: top_1,\r\n                }, rootContainerClientRect);\r\n            }\r\n        }\r\n        else {\r\n            targetClientRect = getClientRect(target);\r\n            containerClientRect = getCachedClientRect(offsetContainer);\r\n            if (moveableElement) {\r\n                moveableClientRect = getClientRect(moveableElement);\r\n            }\r\n            var containerClientRectLeft = containerClientRect.left, containerClientRectTop = containerClientRect.top, containterClientLeft = containerClientRect.clientLeft, containerClientTop = containerClientRect.clientTop;\r\n            var clientDelta = [\r\n                targetClientRect.left - containerClientRectLeft,\r\n                targetClientRect.top - containerClientRectTop,\r\n            ];\r\n            offsetDelta = minus(calculateInversePosition(result.rootMatrix, clientDelta, 4), [containterClientLeft + result.left, containerClientTop + result.top]);\r\n        }\r\n    }\r\n    return __assign({ targetClientRect: targetClientRect, containerClientRect: containerClientRect, moveableClientRect: moveableClientRect, rootContainerClientRect: rootContainerClientRect, beforeDirection: beforeDirection, beforeOrigin: beforeOrigin, originalBeforeOrigin: beforeOrigin, target: target, style: style, offsetDelta: offsetDelta }, result);\r\n}\n\nfunction getPersistState(rect) {\r\n    var pos1 = rect.pos1, pos2 = rect.pos2, pos3 = rect.pos3, pos4 = rect.pos4;\r\n    if (!pos1 || !pos2 || !pos3 || !pos4) {\r\n        return null;\r\n    }\r\n    var minPos = getMinMaxs([pos1, pos2, pos3, pos4]);\r\n    var posDelta = [minPos.minX, minPos.minY];\r\n    var origin = minus(rect.origin, posDelta);\r\n    pos1 = minus(pos1, posDelta);\r\n    pos2 = minus(pos2, posDelta);\r\n    pos3 = minus(pos3, posDelta);\r\n    pos4 = minus(pos4, posDelta);\r\n    return __assign(__assign({}, rect), { left: rect.left, top: rect.top, posDelta: posDelta, pos1: pos1, pos2: pos2, pos3: pos3, pos4: pos4, origin: origin, beforeOrigin: origin, \r\n        // originalBeforeOrigin: origin,\r\n        isPersisted: true });\r\n}\n\nvar MoveableManager = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableManager, _super);\r\n    function MoveableManager() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = __assign({ container: null, gestos: {}, renderLines: [\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n            ], renderPoses: [[0, 0], [0, 0], [0, 0], [0, 0]], disableNativeEvent: false, posDelta: [0, 0] }, getMoveableTargetInfo(null));\r\n        _this.renderState = {};\r\n        _this.enabledAbles = [];\r\n        _this.targetAbles = [];\r\n        _this.controlAbles = [];\r\n        _this.rotation = 0;\r\n        _this.scale = [1, 1];\r\n        _this.isMoveableMounted = false;\r\n        _this.isUnmounted = false;\r\n        _this.events = {\r\n            \"mouseEnter\": null,\r\n            \"mouseLeave\": null,\r\n        };\r\n        _this._emitter = new EventEmitter();\r\n        _this._prevOriginalDragTarget = null;\r\n        _this._originalDragTarget = null;\r\n        _this._prevDragTarget = null;\r\n        _this._dragTarget = null;\r\n        _this._prevPropTarget = null;\r\n        _this._propTarget = null;\r\n        _this._prevDragArea = false;\r\n        _this._isPropTargetChanged = false;\r\n        _this._hasFirstTarget = false;\r\n        _this._reiszeObserver = null;\r\n        _this._observerId = 0;\r\n        _this._mutationObserver = null;\r\n        _this._rootContainer = null;\r\n        _this._viewContainer = null;\r\n        _this._viewClassNames = [];\r\n        _this._store = {};\r\n        _this.checkUpdateRect = function () {\r\n            if (_this.isDragging()) {\r\n                return;\r\n            }\r\n            var parentMoveable = _this.props.parentMoveable;\r\n            if (parentMoveable) {\r\n                parentMoveable.checkUpdateRect();\r\n                return;\r\n            }\r\n            cancelAnimationFrame(_this._observerId);\r\n            _this._observerId = requestAnimationFrame(function () {\r\n                if (_this.isDragging()) {\r\n                    return;\r\n                }\r\n                _this.updateRect();\r\n            });\r\n        };\r\n        _this._onPreventClick = function (e) {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            // removeEvent(window, \"click\", this._onPreventClick, true);\r\n        };\r\n        return _this;\r\n    }\r\n    MoveableManager.prototype.render = function () {\r\n        var props = this.props;\r\n        var state = this.getState();\r\n        var parentPosition = props.parentPosition, className = props.className, propsTarget = props.target, zoom = props.zoom, cspNonce = props.cspNonce, translateZ = props.translateZ, ControlBoxElement = props.cssStyled, groupable = props.groupable, linePadding = props.linePadding, controlPadding = props.controlPadding;\r\n        this._checkUpdateRootContainer();\r\n        this.checkUpdate();\r\n        this.updateRenderPoses();\r\n        var _a = __read(parentPosition || [0, 0], 2), parentLeft = _a[0], parentTop = _a[1];\r\n        var left = state.left, top = state.top, stateTarget = state.target, direction = state.direction, hasFixed = state.hasFixed, offsetDelta = state.offsetDelta;\r\n        var groupTargets = props.targets;\r\n        var isDragging = this.isDragging();\r\n        var ableAttributes = {};\r\n        this.getEnabledAbles().forEach(function (able) {\r\n            ableAttributes[\"data-able-\".concat(able.name.toLowerCase())] = true;\r\n        });\r\n        var ableClassName = this._getAbleClassName();\r\n        var isDisplay = (groupTargets && groupTargets.length && (stateTarget || groupable))\r\n            || propsTarget\r\n            || (!this._hasFirstTarget && this.state.isPersisted);\r\n        var isVisible = this.controlBox || this.props.firstRenderState || this.props.persistData;\r\n        var translate = [left - parentLeft, top - parentTop];\r\n        if (!groupable && props.useAccuratePosition) {\r\n            translate[0] += offsetDelta[0];\r\n            translate[1] += offsetDelta[1];\r\n        }\r\n        var style = {\r\n            \"position\": hasFixed ? \"fixed\" : \"absolute\",\r\n            \"display\": isDisplay ? \"block\" : \"none\",\r\n            \"visibility\": isVisible ? \"visible\" : \"hidden\",\r\n            \"transform\": \"translate3d(\".concat(translate[0], \"px, \").concat(translate[1], \"px, \").concat(translateZ, \")\"),\r\n            \"--zoom\": zoom,\r\n            \"--zoompx\": \"\".concat(zoom, \"px\"),\r\n        };\r\n        if (linePadding) {\r\n            style[\"--moveable-line-padding\"] = linePadding;\r\n        }\r\n        if (controlPadding) {\r\n            style[\"--moveable-control-padding\"] = controlPadding;\r\n        }\r\n        return (React.createElement(ControlBoxElement, __assign({ cspNonce: cspNonce, ref: ref(this, \"controlBox\"), className: \"\".concat(prefix(\"control-box\", direction === -1 ? \"reverse\" : \"\", isDragging ? \"dragging\" : \"\"), \" \").concat(ableClassName, \" \").concat(className) }, ableAttributes, { onClick: this._onPreventClick, style: style }),\r\n            this.renderAbles(),\r\n            this._renderLines()));\r\n    };\r\n    MoveableManager.prototype.componentDidMount = function () {\r\n        this.isMoveableMounted = true;\r\n        this.isUnmounted = false;\r\n        var props = this.props;\r\n        var parentMoveable = props.parentMoveable, container = props.container;\r\n        this._checkUpdateRootContainer();\r\n        this._checkUpdateViewContainer();\r\n        this._updateTargets();\r\n        this._updateNativeEvents();\r\n        this._updateEvents();\r\n        this.updateCheckInput();\r\n        this._updateObserver(this.props);\r\n        if (!container && !parentMoveable && !this.state.isPersisted) {\r\n            this.updateRect(\"\", false, false);\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n    MoveableManager.prototype.componentDidUpdate = function (prevProps) {\r\n        this._checkUpdateRootContainer();\r\n        this._checkUpdateViewContainer();\r\n        this._updateNativeEvents();\r\n        this._updateTargets();\r\n        this._updateEvents();\r\n        this.updateCheckInput();\r\n        this._updateObserver(prevProps);\r\n    };\r\n    MoveableManager.prototype.componentWillUnmount = function () {\r\n        var _a, _b;\r\n        this.isMoveableMounted = false;\r\n        this.isUnmounted = true;\r\n        this._emitter.off();\r\n        (_a = this._reiszeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n        (_b = this._mutationObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\r\n        var viewContainer = this._viewContainer;\r\n        if (viewContainer) {\r\n            this._changeAbleViewClassNames([]);\r\n        }\r\n        unsetGesto(this, false);\r\n        unsetGesto(this, true);\r\n        var events = this.events;\r\n        for (var name_1 in events) {\r\n            var manager = events[name_1];\r\n            manager && manager.destroy();\r\n        }\r\n    };\r\n    MoveableManager.prototype.getTargets = function () {\r\n        var target = this.props.target;\r\n        return target ? [target] : [];\r\n    };\r\n    /**\r\n     * Get the able used in MoveableManager.\r\n     * @method Moveable#getAble\r\n     * @param - able name\r\n     */\r\n    MoveableManager.prototype.getAble = function (ableName) {\r\n        var ables = this.props.ables || [];\r\n        return find(ables, function (able) { return able.name === ableName; });\r\n    };\r\n    MoveableManager.prototype.getContainer = function () {\r\n        var _a = this.props, parentMoveable = _a.parentMoveable, wrapperMoveable = _a.wrapperMoveable, container = _a.container;\r\n        return container\r\n            || (wrapperMoveable && wrapperMoveable.getContainer())\r\n            || (parentMoveable && parentMoveable.getContainer())\r\n            || this.controlBox.parentElement;\r\n    };\r\n    /**\r\n     * Returns the element of the control box.\r\n     * @method Moveable#getControlBoxElement\r\n     */\r\n    MoveableManager.prototype.getControlBoxElement = function () {\r\n        return this.controlBox;\r\n    };\r\n    /**\r\n     * Target element to be dragged in moveable\r\n     * @method Moveable#getDragElement\r\n     */\r\n    MoveableManager.prototype.getDragElement = function () {\r\n        return this._dragTarget;\r\n    };\r\n    /**\r\n     * Check if the target is an element included in the moveable.\r\n     * @method Moveable#isMoveableElement\r\n     * @param - the target\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * window.addEventListener(\"click\", e => {\r\n     *     if (!moveable.isMoveableElement(e.target)) {\r\n     *         moveable.target = e.target;\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isMoveableElement = function (target) {\r\n        var _a;\r\n        return target && (((_a = target.getAttribute) === null || _a === void 0 ? void 0 : _a.call(target, \"class\")) || \"\").indexOf(PREFIX) > -1;\r\n    };\r\n    /**\r\n     * You can drag start the Moveable through the external `MouseEvent`or `TouchEvent`. (Angular: ngDragStart)\r\n     * @method Moveable#dragStart\r\n     * @param - external `MouseEvent`or `TouchEvent`\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (!moveable.isMoveableElement(e.target)) {\r\n     *          moveable.dragStart(e);\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.dragStart = function (e, target) {\r\n        if (target === void 0) { target = e.target; }\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        if (targetGesto && checkMoveableTarget(this)({ inputEvent: e }, target)) {\r\n            if (!targetGesto.isFlag()) {\r\n                targetGesto.triggerDragStart(e);\r\n            }\r\n        }\r\n        else if (controlGesto && this.isMoveableElement(target)) {\r\n            if (!controlGesto.isFlag()) {\r\n                controlGesto.triggerDragStart(e);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Hit test an element or rect on a moveable target.\r\n     * (100% = 100)\r\n     * @method Moveable#hitTest\r\n     * @param - element or rect to test\r\n     * @return - Get hit test rate (rate > 0 is hitted)\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (moveable.hitTest(e.target) > 0) {\r\n     *          console.log(\"hiited\");\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.hitTest = function (el) {\r\n        var _a = this.state, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4, targetClientRect = _a.targetClientRect;\r\n        if (!target) {\r\n            return 0;\r\n        }\r\n        var rect;\r\n        if (isNode(el)) {\r\n            var clientRect = el.getBoundingClientRect();\r\n            rect = {\r\n                left: clientRect.left,\r\n                top: clientRect.top,\r\n                width: clientRect.width,\r\n                height: clientRect.height,\r\n            };\r\n        }\r\n        else {\r\n            rect = __assign({ width: 0, height: 0 }, el);\r\n        }\r\n        var rectLeft = rect.left, rectTop = rect.top, rectWidth = rect.width, rectHeight = rect.height;\r\n        var points = fitPoints([pos1, pos2, pos4, pos3], targetClientRect);\r\n        var size = getOverlapSize(points, [\r\n            [rectLeft, rectTop],\r\n            [rectLeft + rectWidth, rectTop],\r\n            [rectLeft + rectWidth, rectTop + rectHeight],\r\n            [rectLeft, rectTop + rectHeight],\r\n        ]);\r\n        var totalSize = getAreaSize(points);\r\n        if (!size || !totalSize) {\r\n            return 0;\r\n        }\r\n        return Math.min(100, size / totalSize * 100);\r\n    };\r\n    /**\r\n     * Whether the coordinates are inside Moveable\r\n     * @method Moveable#isInside\r\n     * @param - x coordinate\r\n     * @param - y coordinate\r\n     * @return - True if the coordinate is in moveable or false\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (moveable.isInside(e.clientX, e.clientY)) {\r\n     *          console.log(\"inside\");\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isInside = function (clientX, clientY) {\r\n        var _a = this.state, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4, targetClientRect = _a.targetClientRect;\r\n        if (!target) {\r\n            return false;\r\n        }\r\n        return isInside([clientX, clientY], fitPoints([pos1, pos2, pos4, pos3], targetClientRect));\r\n    };\r\n    /**\r\n     * If the width, height, left, and top of all elements change, update the shape of the moveable.\r\n     * @method Moveable#updateRect\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * window.addEventListener(\"resize\", e => {\r\n     *     moveable.updateRect();\r\n     * });\r\n     */\r\n    MoveableManager.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        var props = this.props;\r\n        var isSingle = !props.parentPosition && !props.wrapperMoveable;\r\n        if (isSingle) {\r\n            setStoreCache(true);\r\n        }\r\n        var parentMoveable = props.parentMoveable;\r\n        var state = this.state;\r\n        var target = (state.target || props.target);\r\n        var container = this.getContainer();\r\n        var rootContainer = parentMoveable\r\n            ? parentMoveable._rootContainer\r\n            : this._rootContainer;\r\n        var nextState = getMoveableTargetInfo(this.controlBox, target, container, container, rootContainer || container, this._getRequestStyles());\r\n        if (!target && this._hasFirstTarget && props.persistData) {\r\n            var persistState = getPersistState(props.persistData);\r\n            for (var name_2 in persistState) {\r\n                nextState[name_2] = persistState[name_2];\r\n            }\r\n        }\r\n        if (isSingle) {\r\n            setStoreCache();\r\n        }\r\n        this.updateState(nextState, parentMoveable ? false : isSetState);\r\n    };\r\n    /**\r\n     * Check if the moveable state is being dragged.\r\n     * @method Moveable#isDragging\r\n     * @param - If you want to check if able is dragging, specify ableName.\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * // false\r\n     * console.log(moveable.isDragging());\r\n     *\r\n     * moveable.on(\"drag\", () => {\r\n     *   // true\r\n     *   console.log(moveable.isDragging());\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isDragging = function (ableName) {\r\n        var _a, _b;\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        if (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag()) {\r\n            if (!ableName) {\r\n                return true;\r\n            }\r\n            var data = targetGesto.getEventData();\r\n            return !!((_a = data[ableName]) === null || _a === void 0 ? void 0 : _a.isEventStart);\r\n        }\r\n        if (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag()) {\r\n            if (!ableName) {\r\n                return true;\r\n            }\r\n            var data = controlGesto.getEventData();\r\n            return !!((_b = data[ableName]) === null || _b === void 0 ? void 0 : _b.isEventStart);\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * If the width, height, left, and top of the only target change, update the shape of the moveable.\r\n     * Use `.updateRect()` method\r\n     * @method Moveable#updateTarget\r\n     * @deprecated\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.updateTarget();\r\n     */\r\n    MoveableManager.prototype.updateTarget = function (type) {\r\n        this.updateRect(type, true);\r\n    };\r\n    /**\r\n     * You can get the vertex information, position and offset size information of the target based on the container.\r\n     * @method Moveable#getRect\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * const rectInfo = moveable.getRect();\r\n     */\r\n    MoveableManager.prototype.getRect = function () {\r\n        var state = this.state;\r\n        var poses = getAbsolutePosesByState(this.state);\r\n        var _a = __read(poses, 4), pos1 = _a[0], pos2 = _a[1], pos3 = _a[2], pos4 = _a[3];\r\n        var rect = getRect(poses);\r\n        var offsetWidth = state.width, offsetHeight = state.height;\r\n        var width = rect.width, height = rect.height, left = rect.left, top = rect.top;\r\n        var statePos = [state.left, state.top];\r\n        var origin = plus(statePos, state.origin);\r\n        var beforeOrigin = plus(statePos, state.beforeOrigin);\r\n        var transformOrigin = state.transformOrigin;\r\n        return {\r\n            width: width,\r\n            height: height,\r\n            left: left,\r\n            top: top,\r\n            pos1: pos1,\r\n            pos2: pos2,\r\n            pos3: pos3,\r\n            pos4: pos4,\r\n            offsetWidth: offsetWidth,\r\n            offsetHeight: offsetHeight,\r\n            beforeOrigin: beforeOrigin,\r\n            origin: origin,\r\n            transformOrigin: transformOrigin,\r\n            rotation: this.getRotation(),\r\n        };\r\n    };\r\n    /**\r\n     * Get a manager that manages the moveable's state and props.\r\n     * @method Moveable#getManager\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * const manager = moveable.getManager(); // real moveable class instance\r\n     */\r\n    MoveableManager.prototype.getManager = function () {\r\n        return this;\r\n    };\r\n    /**\r\n     * You can stop the dragging currently in progress through a method from outside.\r\n     * @method Moveable#stopDrag\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.stopDrag();\r\n     */\r\n    MoveableManager.prototype.stopDrag = function (type) {\r\n        if (!type || type === \"target\") {\r\n            var gesto = this.targetGesto;\r\n            if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n                unsetAbles(this, false);\r\n            }\r\n            gesto === null || gesto === void 0 ? void 0 : gesto.stop();\r\n        }\r\n        if (!type || type === \"control\") {\r\n            var gesto = this.controlGesto;\r\n            if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n                unsetAbles(this, true);\r\n            }\r\n            gesto === null || gesto === void 0 ? void 0 : gesto.stop();\r\n        }\r\n    };\r\n    MoveableManager.prototype.getRotation = function () {\r\n        var _a = this.state, pos1 = _a.pos1, pos2 = _a.pos2, direction = _a.direction;\r\n        return getAbsoluteRotation(pos1, pos2, direction);\r\n    };\r\n    /**\r\n     * Request able through a method rather than an event.\r\n     * At the moment of execution, requestStart is executed,\r\n     * and then request and requestEnd can be executed through Requester.\r\n     * @method Moveable#request\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Draggable.html#request|Draggable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Resizable.html#request|Resizable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Scalable.html#request|Scalable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Rotatable.html#request|Rotatable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.OriginDraggable.html#request|OriginDraggable Requester}\r\n     * @param - ableName\r\n     * @param - request to be able params.\r\n     * @param - If isInstant is true, request and requestEnd are executed immediately.\r\n     * @return - Able Requester. If there is no request in able, nothing will work.\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"draggable\", { deltaX: 10, deltaY: 10 }, true);\r\n     *\r\n     * // Start move\r\n     * const requester = moveable.request(\"draggable\");\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.requestEnd();\r\n     */\r\n    MoveableManager.prototype.request = function (ableName, param, isInstant) {\r\n        if (param === void 0) { param = {}; }\r\n        var self = this;\r\n        var props = self.props;\r\n        var manager = props.parentMoveable || props.wrapperMoveable || self;\r\n        var allAbles = manager.props.ables;\r\n        var groupable = props.groupable;\r\n        var requsetAble = find(allAbles, function (able) { return able.name === ableName; });\r\n        if (this.isDragging() || !requsetAble || !requsetAble.request) {\r\n            return {\r\n                request: function () {\r\n                    return this;\r\n                },\r\n                requestEnd: function () {\r\n                    return this;\r\n                },\r\n            };\r\n        }\r\n        var ableRequester = requsetAble.request(self);\r\n        var requestInstant = isInstant || param.isInstant;\r\n        var ableType = ableRequester.isControl ? \"controlAbles\" : \"targetAbles\";\r\n        var eventAffix = \"\".concat((groupable ? \"Group\" : \"\")).concat(ableRequester.isControl ? \"Control\" : \"\");\r\n        var moveableAbles = __spreadArray([], __read(manager[ableType]), false);\r\n        var requester = {\r\n            request: function (ableParam) {\r\n                triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"\", __assign(__assign({}, ableRequester.request(ableParam)), { requestAble: ableName, isRequest: true }), requestInstant);\r\n                return requester;\r\n            },\r\n            requestEnd: function () {\r\n                triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"End\", __assign(__assign({}, ableRequester.requestEnd()), { requestAble: ableName, isRequest: true }), requestInstant);\r\n                return requester;\r\n            },\r\n        };\r\n        triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"Start\", __assign(__assign({}, ableRequester.requestStart(param)), { requestAble: ableName, isRequest: true }), requestInstant);\r\n        return requestInstant ? requester.request(param).requestEnd() : requester;\r\n    };\r\n    /**\r\n     * moveable is the top level that manages targets\r\n     * `Single`: MoveableManager instance\r\n     * `Group`: MoveableGroup instance\r\n     * `IndividualGroup`: MoveableIndividaulGroup instance\r\n     * Returns leaf target MoveableManagers.\r\n     */\r\n    MoveableManager.prototype.getMoveables = function () {\r\n        return [this];\r\n    };\r\n    /**\r\n     * Remove the Moveable object and the events.\r\n     * @method Moveable#destroy\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.destroy();\r\n     */\r\n    MoveableManager.prototype.destroy = function () {\r\n        this.componentWillUnmount();\r\n    };\r\n    MoveableManager.prototype.updateRenderPoses = function () {\r\n        var state = this.getState();\r\n        var props = this.props;\r\n        var padding = props.padding;\r\n        var originalBeforeOrigin = state.originalBeforeOrigin, transformOrigin = state.transformOrigin, allMatrix = state.allMatrix, is3d = state.is3d, pos1 = state.pos1, pos2 = state.pos2, pos3 = state.pos3, pos4 = state.pos4, stateLeft = state.left, stateTop = state.top, isPersisted = state.isPersisted;\r\n        var zoom = props.zoom || 1;\r\n        if (!padding && zoom <= 1) {\r\n            state.renderPoses = [\r\n                pos1,\r\n                pos2,\r\n                pos3,\r\n                pos4,\r\n            ];\r\n            state.renderLines = [\r\n                [pos1, pos2],\r\n                [pos2, pos4],\r\n                [pos4, pos3],\r\n                [pos3, pos1],\r\n            ];\r\n            return;\r\n        }\r\n        var _a = getPaddingBox(padding || {}), left = _a.left, top = _a.top, bottom = _a.bottom, right = _a.right;\r\n        var n = is3d ? 4 : 3;\r\n        // const clipPathInfo = getClipPath(\r\n        //     props.target,\r\n        //     offsetWidth,\r\n        //     offsetHeight,\r\n        // );\r\n        // if (clipPathInfo) {\r\n        //     left -= Math.max(0, clipPathInfo.left);\r\n        //     top -= Math.max(0, clipPathInfo.top);\r\n        //     bottom -= Math.max(0, offsetHeight - clipPathInfo.bottom);\r\n        //     right -= Math.max(0, offsetWidth - clipPathInfo.right);\r\n        // }\r\n        var absoluteOrigin = [];\r\n        if (isPersisted) {\r\n            absoluteOrigin = transformOrigin;\r\n        }\r\n        else if (this.controlBox && props.groupable) {\r\n            absoluteOrigin = originalBeforeOrigin;\r\n        }\r\n        else {\r\n            absoluteOrigin = plus(originalBeforeOrigin, [stateLeft, stateTop]);\r\n        }\r\n        var nextMatrix = multiplies(n, createOriginMatrix(absoluteOrigin.map(function (v) { return -v; }), n), allMatrix, createOriginMatrix(transformOrigin, n));\r\n        var renderPos1 = calculatePadding(nextMatrix, pos1, [-left, -top], n);\r\n        var renderPos2 = calculatePadding(nextMatrix, pos2, [right, -top], n);\r\n        var renderPos3 = calculatePadding(nextMatrix, pos3, [-left, bottom], n);\r\n        var renderPos4 = calculatePadding(nextMatrix, pos4, [right, bottom], n);\r\n        state.renderPoses = [\r\n            renderPos1,\r\n            renderPos2,\r\n            renderPos3,\r\n            renderPos4,\r\n        ];\r\n        state.renderLines = [\r\n            [renderPos1, renderPos2],\r\n            [renderPos2, renderPos4],\r\n            [renderPos4, renderPos3],\r\n            [renderPos3, renderPos1],\r\n        ];\r\n        if (zoom) {\r\n            var zoomOffset = zoom / 2;\r\n            state.renderLines = [\r\n                [\r\n                    calculatePadding(nextMatrix, pos1, [-left - zoomOffset, -top], n),\r\n                    calculatePadding(nextMatrix, pos2, [right + zoomOffset, -top], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos2, [right, -top - zoomOffset], n),\r\n                    calculatePadding(nextMatrix, pos4, [right, bottom + zoomOffset], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos4, [right + zoomOffset, bottom], n),\r\n                    calculatePadding(nextMatrix, pos3, [-left - zoomOffset, bottom], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos3, [-left, bottom + zoomOffset], n),\r\n                    calculatePadding(nextMatrix, pos1, [-left, -top - zoomOffset], n),\r\n                ],\r\n            ];\r\n        }\r\n    };\r\n    MoveableManager.prototype.checkUpdate = function () {\r\n        this._isPropTargetChanged = false;\r\n        var _a = this.props, target = _a.target, container = _a.container, parentMoveable = _a.parentMoveable;\r\n        var _b = this.state, stateTarget = _b.target, stateContainer = _b.container;\r\n        if (!stateTarget && !target) {\r\n            return;\r\n        }\r\n        this.updateAbles();\r\n        var isTargetChanged = !equals(stateTarget, target);\r\n        var isChanged = isTargetChanged || !equals(stateContainer, container);\r\n        if (!isChanged) {\r\n            return;\r\n        }\r\n        var moveableContainer = container || this.controlBox;\r\n        if (moveableContainer) {\r\n            this.unsetAbles();\r\n        }\r\n        this.updateState({ target: target, container: container });\r\n        if (!parentMoveable && moveableContainer) {\r\n            this.updateRect(\"End\", false, false);\r\n        }\r\n        this._isPropTargetChanged = isTargetChanged;\r\n    };\r\n    MoveableManager.prototype.waitToChangeTarget = function () {\r\n        return new Promise(function () { });\r\n    };\r\n    MoveableManager.prototype.triggerEvent = function (name, e) {\r\n        var props = this.props;\r\n        this._emitter.trigger(name, e);\r\n        if (props.parentMoveable && e.isRequest && !e.isRequestChild) {\r\n            return props.parentMoveable.triggerEvent(name, e, true);\r\n        }\r\n        var callback = props[name];\r\n        return callback && callback(e);\r\n    };\r\n    MoveableManager.prototype.useCSS = function (tag, css) {\r\n        var customStyleMap = this.props.customStyledMap;\r\n        var key = tag + css;\r\n        if (!customStyleMap[key]) {\r\n            customStyleMap[key] = styled(tag, css);\r\n        }\r\n        return customStyleMap[key];\r\n    };\r\n    MoveableManager.prototype.getState = function () {\r\n        var _a;\r\n        var props = this.props;\r\n        if (props.target || ((_a = props.targets) === null || _a === void 0 ? void 0 : _a.length)) {\r\n            this._hasFirstTarget = true;\r\n        }\r\n        var hasControlBox = this.controlBox;\r\n        var persistData = props.persistData;\r\n        var firstRenderState = props.firstRenderState;\r\n        if (firstRenderState && !hasControlBox) {\r\n            return firstRenderState;\r\n        }\r\n        if (!this._hasFirstTarget && persistData) {\r\n            var persistState = getPersistState(persistData);\r\n            if (persistState) {\r\n                this.updateState(persistState, false);\r\n                return this.state;\r\n            }\r\n        }\r\n        this.state.isPersisted = false;\r\n        return this.state;\r\n    };\r\n    MoveableManager.prototype.updateSelectors = function () { };\r\n    MoveableManager.prototype.unsetAbles = function () {\r\n        var _this = this;\r\n        this.targetAbles.forEach(function (able) {\r\n            if (able.unset) {\r\n                able.unset(_this);\r\n            }\r\n        });\r\n    };\r\n    MoveableManager.prototype.updateAbles = function (ables, eventAffix) {\r\n        if (ables === void 0) { ables = this.props.ables; }\r\n        if (eventAffix === void 0) { eventAffix = \"\"; }\r\n        var props = this.props;\r\n        var triggerAblesSimultaneously = props.triggerAblesSimultaneously;\r\n        var enabledAbles = this.getEnabledAbles(ables);\r\n        var dragStart = \"drag\".concat(eventAffix, \"Start\");\r\n        var pinchStart = \"pinch\".concat(eventAffix, \"Start\");\r\n        var dragControlStart = \"drag\".concat(eventAffix, \"ControlStart\");\r\n        var targetAbles = filterAbles(enabledAbles, [dragStart, pinchStart], triggerAblesSimultaneously);\r\n        var controlAbles = filterAbles(enabledAbles, [dragControlStart], triggerAblesSimultaneously);\r\n        this.enabledAbles = enabledAbles;\r\n        this.targetAbles = targetAbles;\r\n        this.controlAbles = controlAbles;\r\n    };\r\n    MoveableManager.prototype.updateState = function (nextState, isSetState) {\r\n        if (isSetState) {\r\n            if (this.isUnmounted) {\r\n                return;\r\n            }\r\n            this.setState(nextState);\r\n        }\r\n        else {\r\n            var state = this.state;\r\n            for (var name_3 in nextState) {\r\n                state[name_3] = nextState[name_3];\r\n            }\r\n        }\r\n    };\r\n    MoveableManager.prototype.getEnabledAbles = function (ables) {\r\n        if (ables === void 0) { ables = this.props.ables; }\r\n        var props = this.props;\r\n        return ables.filter(function (able) { return able && ((able.always && props[able.name] !== false)\r\n            || props[able.name]); });\r\n    };\r\n    MoveableManager.prototype.renderAbles = function () {\r\n        var _this = this;\r\n        var props = this.props;\r\n        var triggerAblesSimultaneously = props.triggerAblesSimultaneously;\r\n        var Renderer = {\r\n            createElement: createElement,\r\n        };\r\n        this.renderState = {};\r\n        return groupByMap(flat(filterAbles(this.getEnabledAbles(), [\"render\"], triggerAblesSimultaneously).map(function (_a) {\r\n            var render = _a.render;\r\n            return render(_this, Renderer) || [];\r\n        })).filter(function (el) { return el; }), function (_a) {\r\n            var key = _a.key;\r\n            return key;\r\n        }).map(function (group) { return group[0]; });\r\n    };\r\n    MoveableManager.prototype.updateCheckInput = function () {\r\n        this.targetGesto && (this.targetGesto.options.checkInput = this.props.checkInput);\r\n    };\r\n    MoveableManager.prototype._getRequestStyles = function () {\r\n        var styleNames = this.getEnabledAbles().reduce(function (names, able) {\r\n            var _a, _b;\r\n            var ableStyleNames = ((_b = (_a = able.requestStyle) === null || _a === void 0 ? void 0 : _a.call(able)) !== null && _b !== void 0 ? _b : []);\r\n            return __spreadArray(__spreadArray([], __read(names), false), __read(ableStyleNames), false);\r\n        }, __spreadArray([], __read((this.props.requestStyles || [])), false));\r\n        return styleNames;\r\n    };\r\n    MoveableManager.prototype._updateObserver = function (prevProps) {\r\n        this._updateResizeObserver(prevProps);\r\n        this._updateMutationObserver(prevProps);\r\n    };\r\n    MoveableManager.prototype._updateEvents = function () {\r\n        var hasTargetAble = this.targetAbles.length;\r\n        var hasControlAble = this.controlAbles.length;\r\n        var target = this._dragTarget;\r\n        var isUnset = (!hasTargetAble && this.targetGesto)\r\n            || this._isTargetChanged(true);\r\n        if (isUnset) {\r\n            unsetGesto(this, false);\r\n            this.updateState({ gestos: {} });\r\n        }\r\n        if (!hasControlAble) {\r\n            unsetGesto(this, true);\r\n        }\r\n        if (target && hasTargetAble && !this.targetGesto) {\r\n            this.targetGesto = getTargetAbleGesto(this, target, \"\");\r\n        }\r\n        if (!this.controlGesto && hasControlAble) {\r\n            this.controlGesto = getControlAbleGesto(this, \"Control\");\r\n        }\r\n    };\r\n    MoveableManager.prototype._updateTargets = function () {\r\n        var props = this.props;\r\n        this._prevPropTarget = this._propTarget;\r\n        this._prevDragTarget = this._dragTarget;\r\n        this._prevOriginalDragTarget = this._originalDragTarget;\r\n        this._prevDragArea = props.dragArea;\r\n        this._propTarget = props.target;\r\n        this._originalDragTarget = props.dragTarget || props.target;\r\n        this._dragTarget = getRefTarget(this._originalDragTarget, true);\r\n    };\r\n    MoveableManager.prototype._renderLines = function () {\r\n        var props = this.props;\r\n        var _a = props, zoom = _a.zoom, hideDefaultLines = _a.hideDefaultLines, hideChildMoveableDefaultLines = _a.hideChildMoveableDefaultLines, parentMoveable = _a.parentMoveable;\r\n        if (hideDefaultLines || (parentMoveable && hideChildMoveableDefaultLines)) {\r\n            return [];\r\n        }\r\n        var state = this.getState();\r\n        var Renderer = {\r\n            createElement: createElement,\r\n        };\r\n        return state.renderLines.map(function (line, i) {\r\n            return renderLine(Renderer, \"\", line[0], line[1], zoom, \"render-line-\".concat(i));\r\n        });\r\n    };\r\n    MoveableManager.prototype._isTargetChanged = function (useDragArea) {\r\n        var props = this.props;\r\n        var nextTarget = props.dragTarget || props.target;\r\n        var prevTarget = this._prevOriginalDragTarget;\r\n        var prevDragArea = this._prevDragArea;\r\n        var dragArea = props.dragArea;\r\n        // check target without dragArea\r\n        var isDragTargetChanged = !dragArea && prevTarget !== nextTarget;\r\n        var isDragAreaChanged = (useDragArea || dragArea) && prevDragArea !== dragArea;\r\n        return isDragTargetChanged || isDragAreaChanged || this._prevPropTarget != this._propTarget;\r\n    };\r\n    MoveableManager.prototype._updateNativeEvents = function () {\r\n        var _this = this;\r\n        var props = this.props;\r\n        var target = props.dragArea ? this.areaElement : this.state.target;\r\n        var events = this.events;\r\n        var eventKeys = getKeys(events);\r\n        if (this._isTargetChanged()) {\r\n            for (var eventName in events) {\r\n                var manager = events[eventName];\r\n                manager && manager.destroy();\r\n                events[eventName] = null;\r\n            }\r\n        }\r\n        if (!target) {\r\n            return;\r\n        }\r\n        var enabledAbles = this.enabledAbles;\r\n        eventKeys.forEach(function (eventName) {\r\n            var ables = filterAbles(enabledAbles, [eventName]);\r\n            var hasAbles = ables.length > 0;\r\n            var manager = events[eventName];\r\n            if (!hasAbles) {\r\n                if (manager) {\r\n                    manager.destroy();\r\n                    events[eventName] = null;\r\n                }\r\n                return;\r\n            }\r\n            if (!manager) {\r\n                manager = new EventManager(target, _this, eventName);\r\n                events[eventName] = manager;\r\n            }\r\n            manager.setAbles(ables);\r\n        });\r\n    };\r\n    MoveableManager.prototype._checkUpdateRootContainer = function () {\r\n        var rootContainer = this.props.rootContainer;\r\n        if (!this._rootContainer && rootContainer) {\r\n            this._rootContainer = getRefTarget(rootContainer, true);\r\n        }\r\n    };\r\n    MoveableManager.prototype._checkUpdateViewContainer = function () {\r\n        var viewContainerOption = this.props.viewContainer;\r\n        if (!this._viewContainer && viewContainerOption) {\r\n            this._viewContainer = getRefTarget(viewContainerOption, true);\r\n        }\r\n        var viewContainer = this._viewContainer;\r\n        if (viewContainer) {\r\n            this._changeAbleViewClassNames(__spreadArray(__spreadArray([], __read(this._getAbleViewClassNames()), false), [\r\n                this.isDragging() ? VIEW_DRAGGING : \"\",\r\n            ], false));\r\n        }\r\n    };\r\n    MoveableManager.prototype._changeAbleViewClassNames = function (classNames) {\r\n        var viewContainer = this._viewContainer;\r\n        var nextClassNames = groupBy(classNames.filter(Boolean), function (el) { return el; }).map(function (_a) {\r\n            var _b = __read(_a, 1), className = _b[0];\r\n            return className;\r\n        });\r\n        var prevClassNames = this._viewClassNames;\r\n        var _a = diff$1(prevClassNames, nextClassNames), removed = _a.removed, added = _a.added;\r\n        removed.forEach(function (index) {\r\n            removeClass(viewContainer, prevClassNames[index]);\r\n        });\r\n        added.forEach(function (index) {\r\n            addClass(viewContainer, nextClassNames[index]);\r\n        });\r\n        this._viewClassNames = nextClassNames;\r\n    };\r\n    MoveableManager.prototype._getAbleViewClassNames = function () {\r\n        var _this = this;\r\n        return (this.getEnabledAbles().map(function (able) {\r\n            var _a;\r\n            return (((_a = able.viewClassName) === null || _a === void 0 ? void 0 : _a.call(able, _this)) || \"\");\r\n        }).join(\" \") + \" \".concat(this._getAbleClassName(\"-view\"))).split(/\\s+/g);\r\n    };\r\n    MoveableManager.prototype._getAbleClassName = function (classPrefix) {\r\n        var _this = this;\r\n        if (classPrefix === void 0) { classPrefix = \"\"; }\r\n        var ables = this.getEnabledAbles();\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        var targetGestoData = (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag())\r\n            ? targetGesto.getEventData() : {};\r\n        var controlGestoData = (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag())\r\n            ? controlGesto.getEventData() : {};\r\n        return ables.map(function (able) {\r\n            var _a, _b, _c;\r\n            var name = able.name;\r\n            var className = ((_a = able.className) === null || _a === void 0 ? void 0 : _a.call(able, _this)) || \"\";\r\n            if (((_b = targetGestoData[name]) === null || _b === void 0 ? void 0 : _b.isEventStart)\r\n                || ((_c = controlGestoData[name]) === null || _c === void 0 ? void 0 : _c.isEventStart)) {\r\n                className += \" \".concat(prefix(\"\".concat(name).concat(classPrefix, \"-dragging\")));\r\n            }\r\n            return className.trim();\r\n        }).filter(Boolean).join(\" \");\r\n    };\r\n    MoveableManager.prototype._updateResizeObserver = function (prevProps) {\r\n        var _a;\r\n        var props = this.props;\r\n        var target = props.target;\r\n        var win = getWindow(this.getControlBoxElement());\r\n        if (!win.ResizeObserver || !target || !props.useResizeObserver) {\r\n            (_a = this._reiszeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n            return;\r\n        }\r\n        if (prevProps.target === target && this._reiszeObserver) {\r\n            return;\r\n        }\r\n        var observer = new win.ResizeObserver(this.checkUpdateRect);\r\n        observer.observe(target, {\r\n            box: \"border-box\",\r\n        });\r\n        this._reiszeObserver = observer;\r\n    };\r\n    MoveableManager.prototype._updateMutationObserver = function (prevProps) {\r\n        var _this = this;\r\n        var _a;\r\n        var props = this.props;\r\n        var target = props.target;\r\n        var win = getWindow(this.getControlBoxElement());\r\n        if (!win.MutationObserver || !target || !props.useMutationObserver) {\r\n            (_a = this._mutationObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n            return;\r\n        }\r\n        if (prevProps.target === target && this._mutationObserver) {\r\n            return;\r\n        }\r\n        var observer = new win.MutationObserver(function (records) {\r\n            var e_1, _a;\r\n            try {\r\n                for (var records_1 = __values(records), records_1_1 = records_1.next(); !records_1_1.done; records_1_1 = records_1.next()) {\r\n                    var mutation = records_1_1.value;\r\n                    if (mutation.type === \"attributes\" && mutation.attributeName === \"style\") {\r\n                        _this.checkUpdateRect();\r\n                    }\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (records_1_1 && !records_1_1.done && (_a = records_1.return)) _a.call(records_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        });\r\n        observer.observe(target, {\r\n            attributes: true,\r\n        });\r\n        this._mutationObserver = observer;\r\n    };\r\n    MoveableManager.defaultProps = {\r\n        dragTargetSelf: false,\r\n        target: null,\r\n        dragTarget: null,\r\n        container: null,\r\n        rootContainer: null,\r\n        origin: true,\r\n        parentMoveable: null,\r\n        wrapperMoveable: null,\r\n        isWrapperMounted: false,\r\n        parentPosition: null,\r\n        warpSelf: false,\r\n        svgOrigin: \"\",\r\n        dragContainer: null,\r\n        useResizeObserver: false,\r\n        useMutationObserver: false,\r\n        preventDefault: true,\r\n        preventRightClick: true,\r\n        preventWheelClick: true,\r\n        linePadding: 0,\r\n        controlPadding: 0,\r\n        ables: [],\r\n        pinchThreshold: 20,\r\n        dragArea: false,\r\n        passDragArea: false,\r\n        transformOrigin: \"\",\r\n        className: \"\",\r\n        zoom: 1,\r\n        triggerAblesSimultaneously: false,\r\n        padding: {},\r\n        pinchOutside: true,\r\n        checkInput: false,\r\n        dragFocusedInput: false,\r\n        groupable: false,\r\n        hideDefaultLines: false,\r\n        cspNonce: \"\",\r\n        translateZ: 0,\r\n        cssStyled: null,\r\n        customStyledMap: {},\r\n        props: {},\r\n        stopPropagation: false,\r\n        preventClickDefault: false,\r\n        preventClickEventOnDrag: true,\r\n        flushSync: defaultSync,\r\n        firstRenderState: null,\r\n        persistData: null,\r\n        viewContainer: null,\r\n        requestStyles: [],\r\n        useAccuratePosition: false,\r\n    };\r\n    return MoveableManager;\r\n}(React.PureComponent));\r\n/**\r\n * The target to indicate Moveable Control Box.\r\n * @name Moveable#target\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.target = document.querySelector(\".target\");\r\n */\r\n/**\r\n * Zooms in the elements of a moveable.\r\n * @name Moveable#zoom\r\n * @default 1\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.zoom = 2;\r\n */\r\n/**\r\n * Whether the target size is detected and updated whenever it changes.\r\n * @name Moveable#useResizeObserver\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.useResizeObserver = true;\r\n */\r\n/**\r\n * Resize, Scale Events at edges\r\n * @name Moveable#edge\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.edge = true;\r\n */\r\n/**\r\n * You can specify the className of the moveable controlbox.\r\n * @name Moveable#className\r\n * @default \"\"\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   className: \"\",\r\n * });\r\n *\r\n * moveable.className = \"moveable1\";\r\n */\r\n/**\r\n * The target(s) to drag Moveable target(s)\r\n * @name Moveable#dragTarget\r\n * @default target\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.target = document.querySelector(\".target\");\r\n * moveable.dragTarget = document.querySelector(\".dragTarget\");\r\n */\r\n/**\r\n * `renderStart` event occurs at the first start of all events.\r\n * @memberof Moveable\r\n * @event renderStart\r\n * @param {Moveable.OnRenderStart} - Parameters for the `renderStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"renderStart\", ({ target }) => {\r\n *     console.log(\"onRenderStart\", target);\r\n * });\r\n */\r\n/**\r\n * `render` event occurs before the target is drawn on the screen.\r\n * @memberof Moveable\r\n * @event render\r\n * @param {Moveable.OnRender} - Parameters for the `render` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"render\", ({ target }) => {\r\n *     console.log(\"onRender\", target);\r\n * });\r\n */\r\n/**\r\n * `renderEnd` event occurs at the end of all events.\r\n * @memberof Moveable\r\n * @event renderEnd\r\n * @param {Moveable.OnRenderEnd} - Parameters for the `renderEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"renderEnd\", ({ target }) => {\r\n *     console.log(\"onRenderEnd\", target);\r\n * });\r\n */\r\n/**\r\n * `renderGroupStart` event occurs at the first start of all events in group.\r\n * @memberof Moveable\r\n * @event renderGroupStart\r\n * @param {Moveable.OnRenderGroupStart} - Parameters for the `renderGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroupStart\", ({ targets }) => {\r\n *     console.log(\"onRenderGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n * `renderGroup` event occurs before the target is drawn on the screen in group.\r\n * @memberof Moveable\r\n * @event renderGroup\r\n * @param {Moveable.OnRenderGroup} - Parameters for the `renderGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroup\", ({ targets }) => {\r\n *     console.log(\"onRenderGroup\", targets);\r\n * });\r\n */\r\n/**\r\n * `renderGroupEnd` event occurs at the end of all events in group.\r\n * @memberof Moveable\r\n * @event renderGroupEnd\r\n * @param {Moveable.OnRenderGroupEnd} - Parameters for the `renderGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroupEnd\", ({ targets }) => {\r\n *     console.log(\"onRenderGroupEnd\", targets);\r\n * });\r\n */\n\nvar Groupable = {\r\n    name: \"groupable\",\r\n    props: [\r\n        \"defaultGroupRotate\",\r\n        \"useDefaultGroupRotate\",\r\n        \"defaultGroupOrigin\",\r\n        \"groupable\",\r\n        \"groupableProps\",\r\n        \"targetGroups\",\r\n        \"hideChildMoveableDefaultLines\",\r\n    ],\r\n    events: [],\r\n    render: function (moveable, React) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var targets = props.targets || [];\r\n        var _b = moveable.getState(), left = _b.left, top = _b.top, isPersisted = _b.isPersisted;\r\n        var zoom = props.zoom || 1;\r\n        var renderGroupRects = moveable.renderGroupRects;\r\n        var persistDatChildren = ((_a = props.persistData) === null || _a === void 0 ? void 0 : _a.children) || [];\r\n        if (isPersisted) {\r\n            targets = persistDatChildren.map(function () { return null; });\r\n        }\r\n        else {\r\n            persistDatChildren = [];\r\n        }\r\n        var parentPosition = watchValue(moveable, \"parentPosition\", [left, top], function (styles) { return styles.join(\",\"); });\r\n        var requestStyles = watchValue(moveable, \"requestStyles\", moveable.getRequestChildStyles(), function (styles) { return styles.join(\",\"); });\r\n        moveable.moveables = moveable.moveables.slice(0, targets.length);\r\n        return __spreadArray(__spreadArray([], __read(targets.map(function (target, i) {\r\n            return React.createElement(MoveableManager, { key: \"moveable\" + i, ref: refs(moveable, \"moveables\", i), target: target, origin: false, requestStyles: requestStyles, cssStyled: props.cssStyled, customStyledMap: props.customStyledMap, useResizeObserver: props.useResizeObserver, useMutationObserver: props.useMutationObserver, hideChildMoveableDefaultLines: props.hideChildMoveableDefaultLines, parentMoveable: moveable, parentPosition: [left, top], persistData: persistDatChildren[i], zoom: zoom });\r\n        })), false), __read(flat(renderGroupRects.map(function (_a, i) {\r\n            var pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n            var poses = [pos1, pos2, pos3, pos4];\r\n            return [\r\n                [0, 1],\r\n                [1, 3],\r\n                [3, 2],\r\n                [2, 0],\r\n            ].map(function (_a, j) {\r\n                var _b = __read(_a, 2), from = _b[0], to = _b[1];\r\n                return renderLine(React, \"\", minus(poses[from], parentPosition), minus(poses[to], parentPosition), zoom, \"group-rect-\".concat(i, \"-\").concat(j));\r\n            });\r\n        }))), false);\r\n    },\r\n};\n\nvar Clickable = makeAble(\"clickable\", {\r\n    props: [\r\n        \"clickable\",\r\n    ],\r\n    events: [\r\n        \"click\",\r\n        \"clickGroup\",\r\n    ],\r\n    always: true,\r\n    dragRelation: \"weak\",\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    dragStart: function () {\r\n        return;\r\n    },\r\n    dragControlStart: function () {\r\n        return;\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        e.datas.inputTarget = e.inputEvent && e.inputEvent.target;\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        var target = moveable.props.target;\r\n        var inputEvent = e.inputEvent;\r\n        var inputTarget = e.inputTarget;\r\n        var isMoveableElement = moveable.isMoveableElement(inputTarget);\r\n        var containsElement = !isMoveableElement && moveable.controlBox.contains(inputTarget);\r\n        if (!inputEvent || !inputTarget || e.isDrag\r\n            || moveable.isMoveableElement(inputTarget)\r\n            || containsElement\r\n        // External event duplicate target or dragAreaElement\r\n        ) {\r\n            return;\r\n        }\r\n        var containsTarget = target.contains(inputTarget);\r\n        triggerEvent(moveable, \"onClick\", fillParams(moveable, e, {\r\n            isDouble: e.isDouble,\r\n            inputTarget: inputTarget,\r\n            isTarget: target === inputTarget,\r\n            moveableTarget: moveable.props.target,\r\n            containsTarget: containsTarget,\r\n        }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var inputEvent = e.inputEvent;\r\n        var inputTarget = e.inputTarget;\r\n        if (!inputEvent || !inputTarget || e.isDrag\r\n            || moveable.isMoveableElement(inputTarget)\r\n            // External event duplicate target or dragAreaElement\r\n            || e.datas.inputTarget === inputTarget) {\r\n            return;\r\n        }\r\n        var targets = moveable.props.targets;\r\n        var targetIndex = targets.indexOf(inputTarget);\r\n        var isTarget = targetIndex > -1;\r\n        var containsTarget = false;\r\n        if (targetIndex === -1) {\r\n            targetIndex = findIndex(targets, function (parentTarget) { return parentTarget.contains(inputTarget); });\r\n            containsTarget = targetIndex > -1;\r\n        }\r\n        triggerEvent(moveable, \"onClickGroup\", fillParams(moveable, e, {\r\n            isDouble: e.isDouble,\r\n            targets: targets,\r\n            inputTarget: inputTarget,\r\n            targetIndex: targetIndex,\r\n            isTarget: isTarget,\r\n            containsTarget: containsTarget,\r\n            moveableTarget: targets[targetIndex],\r\n        }));\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n    },\r\n});\r\n/**\r\n * When you click on the element, the `click` event is called.\r\n * @memberof Moveable\r\n * @event click\r\n * @param {Moveable.OnClick} - Parameters for the `click` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"click\", ({ hasTarget, containsTarget, targetIndex }) => {\r\n *     // If you click on an element other than the target and not included in the target, index is -1.\r\n *     console.log(\"onClickGroup\", target, hasTarget, containsTarget, targetIndex);\r\n * });\r\n */\r\n/**\r\n * When you click on the element inside the group, the `clickGroup` event is called.\r\n * @memberof Moveable\r\n * @event clickGroup\r\n * @param {Moveable.OnClickGroup} - Parameters for the `clickGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"clickGroup\", ({ inputTarget, isTarget, containsTarget, targetIndex }) => {\r\n *     // If you click on an element other than the target and not included in the target, index is -1.\r\n *     console.log(\"onClickGroup\", inputTarget, isTarget, containsTarget, targetIndex);\r\n * });\r\n */\n\nfunction getDraggableEvent(e) {\r\n    var datas = e.originalDatas.draggable;\r\n    if (!datas) {\r\n        e.originalDatas.draggable = {};\r\n        datas = e.originalDatas.draggable;\r\n    }\r\n    return __assign(__assign({}, e), { datas: datas });\r\n}\r\nvar edgeDraggable = makeAble(\"edgeDraggable\", {\r\n    css: [\r\n        \".edge.edgeDraggable.line {\\ncursor: move;\\n}\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var props = moveable.props;\r\n        var edge = props.edgeDraggable;\r\n        if (!edge) {\r\n            return [];\r\n        }\r\n        return renderEdgeLines(React, \"edgeDraggable\", edge, moveable.getState().renderPoses, props.zoom);\r\n    },\r\n    dragCondition: function (moveable, e) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var target = (_a = e.inputEvent) === null || _a === void 0 ? void 0 : _a.target;\r\n        if (!props.edgeDraggable || !target) {\r\n            return false;\r\n        }\r\n        return !props.draggable\r\n            && hasClass(target, prefix(\"direction\"))\r\n            && hasClass(target, prefix(\"edge\"))\r\n            && hasClass(target, prefix(\"edgeDraggable\"));\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        return Draggable.dragStart(moveable, getDraggableEvent(e));\r\n    },\r\n    drag: function (moveable, e) {\r\n        return Draggable.drag(moveable, getDraggableEvent(e));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        return Draggable.dragEnd(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroupCondition: function (moveable, e) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var target = (_a = e.inputEvent) === null || _a === void 0 ? void 0 : _a.target;\r\n        if (!props.edgeDraggable || !target) {\r\n            return false;\r\n        }\r\n        return !props.draggable && hasClass(target, prefix(\"direction\")) && hasClass(target, prefix(\"line\"));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return Draggable.dragGroupStart(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return Draggable.dragGroup(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return Draggable.dragGroupEnd(moveable, getDraggableEvent(e));\r\n    },\r\n    unset: function (moveable) {\r\n        return Draggable.unset(moveable);\r\n    },\r\n});\r\n/**\r\n * Whether to move by dragging the edge line (default: false)\r\n * @name Moveable.Draggable#edgeDraggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  draggable: true,\r\n *  edgeDraggable: false,\r\n * });\r\n *\r\n * moveable.edgeDraggable = true;\r\n */\n\nvar IndividualGroupable = {\r\n    name: \"individualGroupable\",\r\n    props: [\r\n        \"individualGroupable\",\r\n        \"individualGroupableProps\",\r\n    ],\r\n    events: [],\r\n};\n\nvar MOVEABLE_ABLES =  [\r\n    BeforeRenderable,\r\n    Default, Snappable, Pinchable,\r\n    Draggable, edgeDraggable,\r\n    Resizable, Scalable, Warpable, Rotatable,\r\n    Scrollable, Padding, Origin,\r\n    OriginDraggable,\r\n    Clippable, Roundable, Groupable, IndividualGroupable,\r\n    Clickable,\r\n    DragArea,\r\n    Renderable,\r\n];\r\nvar MOVEABLE_EVENTS = /*#__PURE__*/ MOVEABLE_ABLES.reduce(function (current, able) {\r\n    (able.events || []).forEach(function (name) {\r\n        pushSet(current, name);\r\n    });\r\n    return current;\r\n}, []);\r\nvar MOVEABLE_PROPS = /*#__PURE__*/ MOVEABLE_ABLES.reduce(function (current, able) {\r\n    (able.props || []).forEach(function (name) {\r\n        pushSet(current, name);\r\n    });\r\n    return current;\r\n}, []);\n\nfunction solveConstantsDistance(_a, pos) {\r\n    var _b = __read(_a, 3), a = _b[0], b = _b[1], c = _b[2];\r\n    return (a * pos[0] + b * pos[1] + c) / Math.sqrt(a * a + b * b);\r\n}\r\nfunction solveC(_a, pos) {\r\n    var _b = __read(_a, 2), a = _b[0], b = _b[1];\r\n    // ax + by + c = 0\r\n    // -ax -by;\r\n    return -a * pos[0] - b * pos[1];\r\n}\n\nfunction getMaxPos(poses, index) {\r\n    return Math.max.apply(Math, __spreadArray([], __read(poses.map(function (_a) {\r\n        var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n        return Math.max(pos1[index], pos2[index], pos3[index], pos4[index]);\r\n    })), false));\r\n}\r\nfunction getMinPos(poses, index) {\r\n    return Math.min.apply(Math, __spreadArray([], __read(poses.map(function (_a) {\r\n        var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n        return Math.min(pos1[index], pos2[index], pos3[index], pos4[index]);\r\n    })), false));\r\n}\r\nfunction getGroupRect(parentPoses, rotation) {\r\n    var _a, _b, _c;\r\n    var pos1 = [0, 0];\r\n    var pos2 = [0, 0];\r\n    var pos3 = [0, 0];\r\n    var pos4 = [0, 0];\r\n    var width = 0;\r\n    var height = 0;\r\n    if (!parentPoses.length) {\r\n        return {\r\n            pos1: pos1,\r\n            pos2: pos2,\r\n            pos3: pos3,\r\n            pos4: pos4,\r\n            minX: 0,\r\n            minY: 0,\r\n            maxX: 0,\r\n            maxY: 0,\r\n            width: width,\r\n            height: height,\r\n            rotation: rotation,\r\n        };\r\n    }\r\n    var fixedRotation = throttle(rotation, TINY_NUM);\r\n    if (fixedRotation % 90) {\r\n        var rad = fixedRotation / 180 * Math.PI;\r\n        var a1_1 = Math.tan(rad);\r\n        var a2_1 = -1 / a1_1;\r\n        // ax = y  // -ax + y = 0 // 0 => 1\r\n        // -ax = y // ax + y = 0  // 0 => 3\r\n        var a1MinMax_1 = [MAX_NUM, MIN_NUM];\r\n        var a1MinMaxPos_1 = [[0, 0], [0, 0]];\r\n        var a2MinMax_1 = [MAX_NUM, MIN_NUM];\r\n        var a2MinMaxPos_1 = [[0, 0], [0, 0]];\r\n        parentPoses.forEach(function (poses) {\r\n            poses.forEach(function (pos) {\r\n                // const b1 = pos[1] - a1 * pos[0];\r\n                // const b2 = pos[1] - a2 * pos[0];\r\n                var a1Dist = solveConstantsDistance([-a1_1, 1, 0], pos);\r\n                var a2Dist = solveConstantsDistance([-a2_1, 1, 0], pos);\r\n                if (a1MinMax_1[0] > a1Dist) {\r\n                    a1MinMaxPos_1[0] = pos;\r\n                    a1MinMax_1[0] = a1Dist;\r\n                }\r\n                if (a1MinMax_1[1] < a1Dist) {\r\n                    a1MinMaxPos_1[1] = pos;\r\n                    a1MinMax_1[1] = a1Dist;\r\n                }\r\n                if (a2MinMax_1[0] > a2Dist) {\r\n                    a2MinMaxPos_1[0] = pos;\r\n                    a2MinMax_1[0] = a2Dist;\r\n                }\r\n                if (a2MinMax_1[1] < a2Dist) {\r\n                    a2MinMaxPos_1[1] = pos;\r\n                    a2MinMax_1[1] = a2Dist;\r\n                }\r\n            });\r\n        });\r\n        var _d = __read(a1MinMaxPos_1, 2), a1MinPos = _d[0], a1MaxPos = _d[1];\r\n        var _e = __read(a2MinMaxPos_1, 2), a2MinPos = _e[0], a2MaxPos = _e[1];\r\n        var minHorizontalLine = [-a1_1, 1, solveC([-a1_1, 1], a1MinPos)];\r\n        var maxHorizontalLine = [-a1_1, 1, solveC([-a1_1, 1], a1MaxPos)];\r\n        var minVerticalLine = [-a2_1, 1, solveC([-a2_1, 1], a2MinPos)];\r\n        var maxVerticalLine = [-a2_1, 1, solveC([-a2_1, 1], a2MaxPos)];\r\n        _a = __read([\r\n            [minHorizontalLine, minVerticalLine],\r\n            [minHorizontalLine, maxVerticalLine],\r\n            [maxHorizontalLine, minVerticalLine],\r\n            [maxHorizontalLine, maxVerticalLine],\r\n        ].map(function (_a) {\r\n            var _b = __read(_a, 2), line1 = _b[0], line2 = _b[1];\r\n            return getIntersectionPointsByConstants(line1, line2)[0];\r\n        }), 4), pos1 = _a[0], pos2 = _a[1], pos3 = _a[2], pos4 = _a[3];\r\n        width = a2MinMax_1[1] - a2MinMax_1[0];\r\n        height = a1MinMax_1[1] - a1MinMax_1[0];\r\n    }\r\n    else {\r\n        var minX_1 = getMinPos(parentPoses, 0);\r\n        var minY_1 = getMinPos(parentPoses, 1);\r\n        var maxX_1 = getMaxPos(parentPoses, 0);\r\n        var maxY_1 = getMaxPos(parentPoses, 1);\r\n        pos1 = [minX_1, minY_1];\r\n        pos2 = [maxX_1, minY_1];\r\n        pos3 = [minX_1, maxY_1];\r\n        pos4 = [maxX_1, maxY_1];\r\n        width = maxX_1 - minX_1;\r\n        height = maxY_1 - minY_1;\r\n        if (fixedRotation % 180) {\r\n            // 0\r\n            // 1 2\r\n            // 3 4\r\n            // 90\r\n            // 3 1\r\n            // 4 2\r\n            // 180\r\n            // 4 3\r\n            // 2 1\r\n            // 270\r\n            // 2 4\r\n            // 1 3\r\n            // 1, 2, 3,4 = 3 1 4 2\r\n            var changedX = [pos3, pos1, pos4, pos2];\r\n            _b = __read(changedX, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n            width = maxY_1 - minY_1;\r\n            height = maxX_1 - minX_1;\r\n        }\r\n    }\r\n    if (fixedRotation % 360 > 180) {\r\n        // 1 2   4 3\r\n        // 3 4   2 1\r\n        var changedX = [pos4, pos3, pos2, pos1];\r\n        _c = __read(changedX, 4), pos1 = _c[0], pos2 = _c[1], pos3 = _c[2], pos4 = _c[3];\r\n    }\r\n    var _f = getMinMaxs([pos1, pos2, pos3, pos4]), minX = _f.minX, minY = _f.minY, maxX = _f.maxX, maxY = _f.maxY;\r\n    return {\r\n        pos1: pos1,\r\n        pos2: pos2,\r\n        pos3: pos3,\r\n        pos4: pos4,\r\n        width: width,\r\n        height: height,\r\n        minX: minX,\r\n        minY: minY,\r\n        maxX: maxX,\r\n        maxY: maxY,\r\n        rotation: rotation,\r\n    };\r\n}\r\nfunction findMoveableGroups(moveables, childTargetGroups) {\r\n    var groups = childTargetGroups.map(function (targetGroup) {\r\n        if (isArray(targetGroup)) {\r\n            var childMoveableGroups = findMoveableGroups(moveables, targetGroup);\r\n            var length_1 = childMoveableGroups.length;\r\n            if (length_1 > 1) {\r\n                return childMoveableGroups;\r\n            }\r\n            else if (length_1 === 1) {\r\n                return childMoveableGroups[0];\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        }\r\n        else {\r\n            var checked = find(moveables, function (_a) {\r\n                var manager = _a.manager;\r\n                return manager.props.target === targetGroup;\r\n            });\r\n            if (checked) {\r\n                checked.finded = true;\r\n                return checked.manager;\r\n            }\r\n            return null;\r\n        }\r\n    }).filter(Boolean);\r\n    if (groups.length === 1 && isArray(groups[0])) {\r\n        return groups[0];\r\n    }\r\n    return groups;\r\n}\r\n/**\r\n * @namespace Moveable.Group\r\n * @description You can make targets moveable.\r\n */\r\nvar MoveableGroup = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableGroup, _super);\r\n    function MoveableGroup() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.differ = new ChildrenDiffer();\r\n        _this.moveables = [];\r\n        _this.transformOrigin = \"50% 50%\";\r\n        _this.renderGroupRects = [];\r\n        _this._targetGroups = [];\r\n        _this._hasFirstTargets = false;\r\n        return _this;\r\n    }\r\n    MoveableGroup.prototype.componentDidMount = function () {\r\n        _super.prototype.componentDidMount.call(this);\r\n    };\r\n    MoveableGroup.prototype.checkUpdate = function () {\r\n        this._isPropTargetChanged = false;\r\n        this.updateAbles();\r\n    };\r\n    MoveableGroup.prototype.getTargets = function () {\r\n        return this.props.targets;\r\n    };\r\n    MoveableGroup.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        var _a;\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        var state = this.state;\r\n        if (!this.controlBox || state.isPersisted) {\r\n            return;\r\n        }\r\n        setStoreCache(true);\r\n        this.moveables.forEach(function (moveable) {\r\n            moveable.updateRect(type, false, false);\r\n        });\r\n        var props = this.props;\r\n        var moveables = this.moveables;\r\n        var target = state.target || props.target;\r\n        var checkeds = moveables.map(function (moveable) { return ({ finded: false, manager: moveable }); });\r\n        var targetGroups = this.props.targetGroups || [];\r\n        var moveableGroups = findMoveableGroups(checkeds, targetGroups);\r\n        var useDefaultGroupRotate = props.useDefaultGroupRotate;\r\n        moveableGroups.push.apply(moveableGroups, __spreadArray([], __read(checkeds.filter(function (_a) {\r\n            var finded = _a.finded;\r\n            return !finded;\r\n        }).map(function (_a) {\r\n            var manager = _a.manager;\r\n            return manager;\r\n        })), false));\r\n        var renderGroupRects = [];\r\n        var isReset = !isTarget || (type !== \"\" && props.updateGroup);\r\n        var defaultGroupRotate = props.defaultGroupRotate || 0;\r\n        if (!this._hasFirstTargets) {\r\n            var persistedRoatation = (_a = props.persistData) === null || _a === void 0 ? void 0 : _a.rotation;\r\n            if (persistedRoatation != null) {\r\n                defaultGroupRotate = persistedRoatation;\r\n            }\r\n        }\r\n        function getMoveableGroupRect(group, parentRotation, isRoot) {\r\n            var posesRotations = group.map(function (moveable) {\r\n                if (isArray(moveable)) {\r\n                    var rect = getMoveableGroupRect(moveable, parentRotation);\r\n                    var poses = [rect.pos1, rect.pos2, rect.pos3, rect.pos4];\r\n                    renderGroupRects.push(rect);\r\n                    return { poses: poses, rotation: rect.rotation };\r\n                }\r\n                else {\r\n                    return {\r\n                        poses: getAbsolutePosesByState(moveable.state),\r\n                        rotation: moveable.getRotation(),\r\n                    };\r\n                }\r\n            });\r\n            var rotations = posesRotations.map(function (_a) {\r\n                var rotation = _a.rotation;\r\n                return rotation;\r\n            });\r\n            var groupRotation = 0;\r\n            var firstRotation = rotations[0];\r\n            var isSameRotation = rotations.every(function (nextRotation) {\r\n                return Math.abs(firstRotation - nextRotation) < 0.1;\r\n            });\r\n            if (isReset) {\r\n                groupRotation = !useDefaultGroupRotate && isSameRotation ? firstRotation : defaultGroupRotate;\r\n            }\r\n            else {\r\n                groupRotation = !useDefaultGroupRotate && !isRoot && isSameRotation ? firstRotation : parentRotation;\r\n            }\r\n            var groupPoses = posesRotations.map(function (_a) {\r\n                var poses = _a.poses;\r\n                return poses;\r\n            });\r\n            var groupRect = getGroupRect(groupPoses, groupRotation);\r\n            return groupRect;\r\n        }\r\n        var rootGroupRect = getMoveableGroupRect(moveableGroups, this.rotation, true);\r\n        if (isReset) {\r\n            // reset rotataion\r\n            this.rotation = rootGroupRect.rotation;\r\n            this.transformOrigin = props.defaultGroupOrigin || \"50% 50%\";\r\n            this.scale = [1, 1];\r\n        }\r\n        this._targetGroups = targetGroups;\r\n        this.renderGroupRects = renderGroupRects;\r\n        var transformOrigin = this.transformOrigin;\r\n        var rotation = this.rotation;\r\n        var scale = this.scale;\r\n        var width = rootGroupRect.width, height = rootGroupRect.height, minX = rootGroupRect.minX, minY = rootGroupRect.minY;\r\n        var posesInfo = rotatePosesInfo([\r\n            [0, 0],\r\n            [width, 0],\r\n            [0, height],\r\n            [width, height],\r\n        ], convertTransformOriginArray(transformOrigin, width, height), this.rotation / 180 * Math.PI);\r\n        var _b = getMinMaxs(posesInfo.result), deltaX = _b.minX, deltaY = _b.minY;\r\n        var rotateScale = \" rotate(\".concat(rotation, \"deg)\")\r\n            + \" scale(\".concat(sign(scale[0]), \", \").concat(sign(scale[1]), \")\");\r\n        var transform = \"translate(\".concat(-deltaX, \"px, \").concat(-deltaY, \"px)\").concat(rotateScale);\r\n        this.controlBox.style.transform\r\n            = \"translate3d(\".concat(minX, \"px, \").concat(minY, \"px, \").concat(this.props.translateZ || 0, \")\");\r\n        target.style.cssText += \"left:0px;top:0px;\"\r\n            + \"transform-origin:\".concat(transformOrigin, \";\")\r\n            + \"width:\".concat(width, \"px;height:\").concat(height, \"px;\")\r\n            + \"transform: \".concat(transform);\r\n        state.width = width;\r\n        state.height = height;\r\n        var container = this.getContainer();\r\n        var info = getMoveableTargetInfo(this.controlBox, target, this.controlBox, this.getContainer(), this._rootContainer || container, []);\r\n        var pos = [info.left, info.top];\r\n        var _c = __read(getAbsolutePosesByState(info), 4), pos1 = _c[0], pos2 = _c[1], pos3 = _c[2], pos4 = _c[3]; // info.left + info.pos(1 ~ 4)\r\n        var minPos = getMinMaxs([pos1, pos2, pos3, pos4]);\r\n        var delta = [minPos.minX, minPos.minY];\r\n        var direction = sign(scale[0] * scale[1]);\r\n        info.pos1 = minus(pos1, delta);\r\n        info.pos2 = minus(pos2, delta);\r\n        info.pos3 = minus(pos3, delta);\r\n        info.pos4 = minus(pos4, delta);\r\n        // info.left = info.left + delta[0];\r\n        // info.top = info.top + delta[1];\r\n        info.left = minX - info.left + delta[0];\r\n        info.top = minY - info.top + delta[1];\r\n        info.origin = minus(plus(pos, info.origin), delta);\r\n        info.beforeOrigin = minus(plus(pos, info.beforeOrigin), delta);\r\n        info.originalBeforeOrigin = plus(pos, info.originalBeforeOrigin);\r\n        info.transformOrigin = minus(plus(pos, info.transformOrigin), delta);\r\n        target.style.transform\r\n            = \"translate(\".concat(-deltaX - delta[0], \"px, \").concat(-deltaY - delta[1], \"px)\")\r\n                + rotateScale;\r\n        setStoreCache();\r\n        this.updateState(__assign(__assign({}, info), { posDelta: delta, direction: direction, beforeDirection: direction }), isSetState);\r\n    };\r\n    MoveableGroup.prototype.getRect = function () {\r\n        return __assign(__assign({}, _super.prototype.getRect.call(this)), { children: this.moveables.map(function (child) { return child.getRect(); }) });\r\n    };\r\n    MoveableGroup.prototype.triggerEvent = function (name, e, isManager) {\r\n        if (isManager || name.indexOf(\"Group\") > -1) {\r\n            return _super.prototype.triggerEvent.call(this, name, e);\r\n        }\r\n        else {\r\n            this._emitter.trigger(name, e);\r\n        }\r\n    };\r\n    MoveableGroup.prototype.getRequestChildStyles = function () {\r\n        var styleNames = this.getEnabledAbles().reduce(function (names, able) {\r\n            var _a, _b;\r\n            var ableStyleNames = ((_b = (_a = able.requestChildStyle) === null || _a === void 0 ? void 0 : _a.call(able)) !== null && _b !== void 0 ? _b : []);\r\n            return __spreadArray(__spreadArray([], __read(names), false), __read(ableStyleNames), false);\r\n        }, []);\r\n        return styleNames;\r\n    };\r\n    MoveableGroup.prototype.getMoveables = function () {\r\n        return __spreadArray([], __read(this.moveables), false);\r\n    };\r\n    MoveableGroup.prototype.updateAbles = function () {\r\n        _super.prototype.updateAbles.call(this, __spreadArray(__spreadArray([], __read(this.props.ables), false), [Groupable], false), \"Group\");\r\n    };\r\n    MoveableGroup.prototype._updateTargets = function () {\r\n        _super.prototype._updateTargets.call(this);\r\n        this._originalDragTarget = this.props.dragTarget || this.areaElement;\r\n        this._dragTarget = getRefTarget(this._originalDragTarget, true);\r\n    };\r\n    MoveableGroup.prototype._updateEvents = function () {\r\n        var state = this.state;\r\n        var props = this.props;\r\n        var prevTarget = this._prevDragTarget;\r\n        var nextTarget = props.dragTarget || this.areaElement;\r\n        var targets = props.targets;\r\n        var _a = this.differ.update(targets), added = _a.added, changed = _a.changed, removed = _a.removed;\r\n        var isTargetChanged = added.length || removed.length;\r\n        if (isTargetChanged || this._prevOriginalDragTarget !== this._originalDragTarget) {\r\n            unsetGesto(this, false);\r\n            unsetGesto(this, true);\r\n            this.updateState({ gestos: {} });\r\n        }\r\n        if (prevTarget !== nextTarget) {\r\n            state.target = null;\r\n        }\r\n        if (!state.target) {\r\n            state.target = this.areaElement;\r\n            this.controlBox.style.display = \"block\";\r\n        }\r\n        if (state.target) {\r\n            if (!this.targetGesto) {\r\n                this.targetGesto = getTargetAbleGesto(this, this._dragTarget, \"Group\");\r\n            }\r\n            if (!this.controlGesto) {\r\n                this.controlGesto = getControlAbleGesto(this, \"GroupControl\");\r\n            }\r\n        }\r\n        var isContainerChanged = !equals(state.container, props.container);\r\n        if (isContainerChanged) {\r\n            state.container = props.container;\r\n        }\r\n        if (isContainerChanged\r\n            || isTargetChanged\r\n            || this.transformOrigin !== (props.defaultGroupOrigin || \"50% 50%\")\r\n            || changed.length\r\n            || targets.length && !isDeepArrayEquals(this._targetGroups, props.targetGroups || [])) {\r\n            this.updateRect();\r\n            this._hasFirstTargets = true;\r\n        }\r\n        this._isPropTargetChanged = !!isTargetChanged;\r\n    };\r\n    MoveableGroup.prototype._updateObserver = function () { };\r\n    MoveableGroup.defaultProps = __assign(__assign({}, MoveableManager.defaultProps), { transformOrigin: [\"50%\", \"50%\"], groupable: true, dragArea: true, keepRatio: true, targets: [], defaultGroupRotate: 0, defaultGroupOrigin: \"50% 50%\" });\r\n    return MoveableGroup;\r\n}(MoveableManager));\n\n/**\r\n * @namespace Moveable.IndividualGroup\r\n * @description Create targets individually, not as a group.Create targets individually, not as a group.\r\n */\r\nvar MoveableIndividualGroup = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableIndividualGroup, _super);\r\n    function MoveableIndividualGroup() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.moveables = [];\r\n        return _this;\r\n    }\r\n    MoveableIndividualGroup.prototype.render = function () {\r\n        var _this = this;\r\n        var _a;\r\n        var props = this.props;\r\n        var cspNonce = props.cspNonce, ControlBoxElement = props.cssStyled, persistData = props.persistData;\r\n        var targets = props.targets || [];\r\n        var length = targets.length;\r\n        var canPersist = this.isUnmounted || !length;\r\n        var persistDatChildren = (_a = persistData === null || persistData === void 0 ? void 0 : persistData.children) !== null && _a !== void 0 ? _a : [];\r\n        if (canPersist && !length && persistDatChildren.length) {\r\n            targets = persistDatChildren.map(function () { return null; });\r\n        }\r\n        else if (!canPersist) {\r\n            persistDatChildren = [];\r\n        }\r\n        return React.createElement(ControlBoxElement, { cspNonce: cspNonce, ref: ref(this, \"controlBox\"), className: prefix(\"control-box\") }, targets.map(function (target, i) {\r\n            var _a, _b;\r\n            var individualProps = (_b = (_a = props.individualGroupableProps) === null || _a === void 0 ? void 0 : _a.call(props, target, i)) !== null && _b !== void 0 ? _b : {};\r\n            return React.createElement(MoveableManager, __assign({ key: \"moveable\" + i, ref: refs(_this, \"moveables\", i) }, props, individualProps, { target: target, wrapperMoveable: _this, isWrapperMounted: _this.isMoveableMounted, persistData: persistDatChildren[i] }));\r\n        }));\r\n    };\r\n    MoveableIndividualGroup.prototype.componentDidMount = function () { };\r\n    MoveableIndividualGroup.prototype.componentDidUpdate = function () { };\r\n    MoveableIndividualGroup.prototype.getTargets = function () {\r\n        return this.props.targets;\r\n    };\r\n    MoveableIndividualGroup.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        setStoreCache(true);\r\n        this.moveables.forEach(function (moveable) {\r\n            moveable.updateRect(type, isTarget, isSetState);\r\n        });\r\n        setStoreCache();\r\n    };\r\n    MoveableIndividualGroup.prototype.getRect = function () {\r\n        return __assign(__assign({}, _super.prototype.getRect.call(this)), { children: this.moveables.map(function (child) { return child.getRect(); }) });\r\n    };\r\n    MoveableIndividualGroup.prototype.request = function (ableName, param, isInstant) {\r\n        if (param === void 0) { param = {}; }\r\n        var results = this.moveables.map(function (m) { return m.request(ableName, __assign(__assign({}, param), { isInstant: false }), false); });\r\n        var requestInstant = isInstant || param.isInstant;\r\n        var requester = {\r\n            request: function (ableParam) {\r\n                results.forEach(function (r) { return r.request(ableParam); });\r\n                return this;\r\n            },\r\n            requestEnd: function () {\r\n                results.forEach(function (r) { return r.requestEnd(); });\r\n                return this;\r\n            },\r\n        };\r\n        return requestInstant ? requester.request(param).requestEnd() : requester;\r\n    };\r\n    MoveableIndividualGroup.prototype.dragStart = function (e, target) {\r\n        if (target === void 0) { target = e.target; }\r\n        var inputTarget = target;\r\n        var childMoveable = find(this.moveables, function (child) {\r\n            var target = child.getTargets()[0];\r\n            var controlBoxElement = child.getControlBoxElement();\r\n            var dragElement = child.getDragElement();\r\n            if (!target || !dragElement) {\r\n                return false;\r\n            }\r\n            return dragElement === inputTarget || dragElement.contains(inputTarget)\r\n                || (dragElement !== target && target === inputTarget || target.contains(inputTarget))\r\n                || controlBoxElement === inputTarget || controlBoxElement.contains(inputTarget);\r\n        });\r\n        if (childMoveable) {\r\n            childMoveable.dragStart(e, target);\r\n        }\r\n        return this;\r\n    };\r\n    MoveableIndividualGroup.prototype.hitTest = function () {\r\n        return 0;\r\n    };\r\n    MoveableIndividualGroup.prototype.isInside = function () {\r\n        return false;\r\n    };\r\n    MoveableIndividualGroup.prototype.isDragging = function () {\r\n        return false;\r\n    };\r\n    MoveableIndividualGroup.prototype.getDragElement = function () {\r\n        return null;\r\n    };\r\n    MoveableIndividualGroup.prototype.getMoveables = function () {\r\n        return __spreadArray([], __read(this.moveables), false);\r\n    };\r\n    MoveableIndividualGroup.prototype.updateRenderPoses = function () { };\r\n    MoveableIndividualGroup.prototype.checkUpdate = function () { };\r\n    MoveableIndividualGroup.prototype.triggerEvent = function () { };\r\n    MoveableIndividualGroup.prototype.updateAbles = function () { };\r\n    MoveableIndividualGroup.prototype._updateEvents = function () { };\r\n    MoveableIndividualGroup.prototype._updateObserver = function () { };\r\n    return MoveableIndividualGroup;\r\n}(MoveableManager));\n\nfunction getElementTargets(refTargets, selectorMap) {\r\n    var elementTargets = [];\r\n    refTargets.forEach(function (target) {\r\n        if (!target) {\r\n            return;\r\n        }\r\n        if (isString(target)) {\r\n            if (selectorMap[target]) {\r\n                elementTargets.push.apply(elementTargets, __spreadArray([], __read(selectorMap[target]), false));\r\n            }\r\n            return;\r\n        }\r\n        if (isArray(target)) {\r\n            elementTargets.push.apply(elementTargets, __spreadArray([], __read(getElementTargets(target, selectorMap)), false));\r\n        }\r\n        else {\r\n            elementTargets.push(target);\r\n        }\r\n    });\r\n    return elementTargets;\r\n}\r\nfunction getTargetGroups(refTargets, selectorMap) {\r\n    var targetGroups = [];\r\n    refTargets.forEach(function (target) {\r\n        if (!target) {\r\n            return;\r\n        }\r\n        if (isString(target)) {\r\n            if (selectorMap[target]) {\r\n                targetGroups.push.apply(targetGroups, __spreadArray([], __read(selectorMap[target]), false));\r\n            }\r\n            return;\r\n        }\r\n        if (isArray(target)) {\r\n            targetGroups.push(getTargetGroups(target, selectorMap));\r\n        }\r\n        else {\r\n            targetGroups.push(target);\r\n        }\r\n    });\r\n    return targetGroups;\r\n}\r\nfunction compareRefTargets(prevRefTargets, nextRefTargets) {\r\n    return (prevRefTargets.length !== nextRefTargets.length) || prevRefTargets.some(function (target, i) {\r\n        var nextTarget = nextRefTargets[i];\r\n        if (!target && !nextTarget) {\r\n            return false;\r\n        }\r\n        else if (target != nextTarget) {\r\n            if (isArray(target) && isArray(nextTarget)) {\r\n                return compareRefTargets(target, nextTarget);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n}\r\nvar InitialMoveable = /*#__PURE__*/ (function (_super) {\r\n    __extends(InitialMoveable, _super);\r\n    function InitialMoveable() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.refTargets = [];\r\n        _this.selectorMap = {};\r\n        _this._differ = new ChildrenDiffer();\r\n        _this._elementTargets = [];\r\n        _this._tmpRefTargets = [];\r\n        _this._tmpSelectorMap = {};\r\n        _this._onChangeTargets = null;\r\n        return _this;\r\n    }\r\n    InitialMoveable.makeStyled = function () {\r\n        var cssMap = {};\r\n        var ables = this.getTotalAbles();\r\n        ables.forEach(function (_a) {\r\n            var css = _a.css;\r\n            if (!css) {\r\n                return;\r\n            }\r\n            css.forEach(function (text) {\r\n                cssMap[text] = true;\r\n            });\r\n        });\r\n        var style = getKeys(cssMap).join(\"\\n\");\r\n        this.defaultStyled = styled(\"div\", prefixCSS(PREFIX, MOVEABLE_CSS + style));\r\n    };\r\n    InitialMoveable.getTotalAbles = function () {\r\n        return __spreadArray([Default, Groupable, IndividualGroupable, DragArea], __read(this.defaultAbles), false);\r\n    };\r\n    InitialMoveable.prototype.render = function () {\r\n        var _a;\r\n        var moveableContructor = this.constructor;\r\n        if (!moveableContructor.defaultStyled) {\r\n            moveableContructor.makeStyled();\r\n        }\r\n        var _b = this.props, userAbles = _b.ables, userProps = _b.props, props = __rest(_b, [\"ables\", \"props\"]);\r\n        var _c = __read(this._updateRefs(true), 2), refTargets = _c[0], nextSelectorMap = _c[1];\r\n        var elementTargets = getElementTargets(refTargets, nextSelectorMap);\r\n        var isGroup = elementTargets.length > 1;\r\n        var totalAbles = moveableContructor.getTotalAbles();\r\n        var ables = __spreadArray(__spreadArray([], __read(totalAbles), false), __read((userAbles || [])), false);\r\n        var nextProps = __assign(__assign(__assign({}, props), (userProps || {})), { ables: ables, cssStyled: moveableContructor.defaultStyled, customStyledMap: moveableContructor.customStyledMap });\r\n        this._elementTargets = elementTargets;\r\n        var firstRenderState = null;\r\n        var prevMoveable = this.moveable;\r\n        var persistData = props.persistData;\r\n        if (persistData === null || persistData === void 0 ? void 0 : persistData.children) {\r\n            isGroup = true;\r\n        }\r\n        // Even one child is treated as a group if individualGroupable is enabled. #867\r\n        if (props.individualGroupable) {\r\n            return React.createElement(MoveableIndividualGroup, __assign({ key: \"individual-group\", ref: ref(this, \"moveable\") }, nextProps, { target: null, targets: elementTargets }));\r\n        }\r\n        if (isGroup) {\r\n            var targetGroups = getTargetGroups(refTargets, nextSelectorMap);\r\n            // manager\r\n            if (prevMoveable && !prevMoveable.props.groupable && !prevMoveable.props.individualGroupable) {\r\n                var target = prevMoveable.props.target;\r\n                if (target && elementTargets.indexOf(target) > -1) {\r\n                    firstRenderState = __assign({}, prevMoveable.state);\r\n                }\r\n            }\r\n            return React.createElement(MoveableGroup, __assign({ key: \"group\", ref: ref(this, \"moveable\") }, nextProps, (_a = props.groupableProps) !== null && _a !== void 0 ? _a : {}, { target: null, targets: elementTargets, targetGroups: targetGroups, firstRenderState: firstRenderState }));\r\n        }\r\n        else {\r\n            var target_1 = elementTargets[0];\r\n            // manager\r\n            if (prevMoveable && (prevMoveable.props.groupable || prevMoveable.props.individualGroupable)) {\r\n                var moveables = prevMoveable.moveables || [];\r\n                var prevTargetMoveable = find(moveables, function (mv) { return mv.props.target === target_1; });\r\n                if (prevTargetMoveable) {\r\n                    firstRenderState = __assign({}, prevTargetMoveable.state);\r\n                }\r\n            }\r\n            return React.createElement(MoveableManager, __assign({ key: \"single\", ref: ref(this, \"moveable\") }, nextProps, { target: target_1, firstRenderState: firstRenderState }));\r\n        }\r\n    };\r\n    InitialMoveable.prototype.componentDidMount = function () {\r\n        this._checkChangeTargets();\r\n    };\r\n    InitialMoveable.prototype.componentDidUpdate = function () {\r\n        this._checkChangeTargets();\r\n    };\r\n    InitialMoveable.prototype.componentWillUnmount = function () {\r\n        this.selectorMap = {};\r\n        this.refTargets = [];\r\n    };\r\n    /**\r\n     * Get targets set in moveable through target or targets of props.\r\n     * @method Moveable#getTargets\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body, {\r\n     *    target: [targetRef, \".target\", document.querySelectorAll(\".target\")],\r\n     * });\r\n     *\r\n     * console.log(moveable.getTargets());\r\n     */\r\n    InitialMoveable.prototype.getTargets = function () {\r\n        var _a, _b;\r\n        return (_b = (_a = this.moveable) === null || _a === void 0 ? void 0 : _a.getTargets()) !== null && _b !== void 0 ? _b : [];\r\n    };\r\n    /**\r\n     * If the element list corresponding to the selector among the targets is changed, it is updated.\r\n     * @method Moveable#updateSelectors\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body, {\r\n     *    target: \".target\",\r\n     * });\r\n     *\r\n     * moveable.updateSelectors();\r\n     */\r\n    InitialMoveable.prototype.updateSelectors = function () {\r\n        this.selectorMap = {};\r\n        this._updateRefs();\r\n        this.forceUpdate();\r\n    };\r\n    /**\r\n     * User changes target and waits for target to change.\r\n     * @method Moveable#waitToChangeTarget\r\n     * @story combination-with-other-components--components-selecto\r\n     * @example\r\n     * document.querySelector(\".target\").addEventListener(\"mousedown\", e => {\r\n     *   moveable.waitToChangeTarget().then(() => {\r\n     *      moveable.dragStart(e, e.currentTarget);\r\n     *   });\r\n     *   moveable.target = e.currentTarget;\r\n     * });\r\n     */\r\n    InitialMoveable.prototype.waitToChangeTarget = function () {\r\n        // let resolvePromise: (e: OnChangeTarget) => void;\r\n        var _this = this;\r\n        // this._onChangeTargets = () => {\r\n        //     this._onChangeTargets = null;\r\n        //     resolvePromise({\r\n        //         moveable: this.getManager(),\r\n        //         targets: this._elementTargets,\r\n        //     });\r\n        // };\r\n        // return new Promise<OnChangeTarget>(resolve => {\r\n        //     resolvePromise = resolve;\r\n        // });\r\n        var resolvePromise;\r\n        this._onChangeTargets = function () {\r\n            _this._onChangeTargets = null;\r\n            resolvePromise();\r\n        };\r\n        return new Promise(function (resolve) {\r\n            resolvePromise = resolve;\r\n        });\r\n    };\r\n    InitialMoveable.prototype.waitToChangeTargets = function () {\r\n        return this.waitToChangeTarget();\r\n    };\r\n    InitialMoveable.prototype.getManager = function () {\r\n        return this.moveable;\r\n    };\r\n    InitialMoveable.prototype.getMoveables = function () {\r\n        return this.moveable.getMoveables();\r\n    };\r\n    InitialMoveable.prototype.getDragElement = function () {\r\n        return this.moveable.getDragElement();\r\n    };\r\n    InitialMoveable.prototype._updateRefs = function (isRender) {\r\n        var prevRefTargets = this.refTargets;\r\n        var nextRefTargets = getRefTargets((this.props.target || this.props.targets));\r\n        var isBrowser = typeof document !== \"undefined\";\r\n        var isUpdate = compareRefTargets(prevRefTargets, nextRefTargets);\r\n        var selectorMap = this.selectorMap;\r\n        var nextSelectorMap = {};\r\n        this.refTargets.forEach(function updateSelectorMap(target) {\r\n            if (isString(target)) {\r\n                var selectorTarget = selectorMap[target];\r\n                if (selectorTarget) {\r\n                    nextSelectorMap[target] = selectorMap[target];\r\n                }\r\n                else if (isBrowser) {\r\n                    isUpdate = true;\r\n                    nextSelectorMap[target] = [].slice.call(document.querySelectorAll(target));\r\n                }\r\n            }\r\n            else if (isArray(target)) {\r\n                target.forEach(updateSelectorMap);\r\n            }\r\n        });\r\n        this._tmpRefTargets = nextRefTargets;\r\n        this._tmpSelectorMap = nextSelectorMap;\r\n        return [\r\n            nextRefTargets,\r\n            nextSelectorMap,\r\n            !isRender && isUpdate,\r\n        ];\r\n    };\r\n    InitialMoveable.prototype._checkChangeTargets = function () {\r\n        var _a, _b, _c;\r\n        this.refTargets = this._tmpRefTargets;\r\n        this.selectorMap = this._tmpSelectorMap;\r\n        var _d = this._differ.update(this._elementTargets), added = _d.added, removed = _d.removed;\r\n        var isTargetChanged = added.length || removed.length;\r\n        if (isTargetChanged) {\r\n            (_b = (_a = this.props).onChangeTargets) === null || _b === void 0 ? void 0 : _b.call(_a, {\r\n                moveable: this.moveable,\r\n                targets: this._elementTargets,\r\n            });\r\n            (_c = this._onChangeTargets) === null || _c === void 0 ? void 0 : _c.call(this);\r\n        }\r\n        var _e = __read(this._updateRefs(), 3), refTargets = _e[0], selectorMap = _e[1], isUpdate = _e[2];\r\n        this.refTargets = refTargets;\r\n        this.selectorMap = selectorMap;\r\n        if (isUpdate) {\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n    InitialMoveable.defaultAbles = [];\r\n    InitialMoveable.customStyledMap = {};\r\n    InitialMoveable.defaultStyled = null;\r\n    __decorate([\r\n        withMethods(MOVEABLE_METHODS)\r\n    ], InitialMoveable.prototype, \"moveable\", void 0);\r\n    return InitialMoveable;\r\n}(React.PureComponent));\n\nvar Moveable = /*#__PURE__*/ (function (_super) {\r\n    __extends(Moveable, _super);\r\n    function Moveable() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Moveable.defaultAbles = MOVEABLE_ABLES;\r\n    return Moveable;\r\n}(InitialMoveable));\n\nfunction makeMoveable(ables) {\r\n    var _a;\r\n    return _a = /*#__PURE__*/ (function (_super) {\r\n            __extends(Moveable, _super);\r\n            function Moveable() {\r\n                return _super !== null && _super.apply(this, arguments) || this;\r\n            }\r\n            return Moveable;\r\n        }(InitialMoveable)),\r\n        _a.defaultAbles = ables,\r\n        _a;\r\n}\n\nexport { Clippable, DIRECTIONS, Draggable, edgeDraggable as EdgeDraggable, InitialMoveable, MOVEABLE_ABLES, MOVEABLE_EVENTS, MOVEABLE_METHODS, MOVEABLE_PROPS, Pinchable, Resizable, Rotatable, Roundable, Scalable, Snappable, Warpable, calculateElementPosition, Moveable as default, getElementInfo, makeAble, makeMoveable };\n","/*\nCopyright (c) 2019 Daybrush\nname: moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/moveable\nversion: 0.53.0\n*/\nimport { ref, Properties } from 'framework-utils';\nimport * as React from 'croact';\nimport { renderSelf } from 'croact';\nimport Moveable$1, { MOVEABLE_PROPS, MOVEABLE_METHODS, MOVEABLE_EVENTS, getElementInfo as getElementInfo$1, makeAble as makeAble$1 } from 'croact-moveable';\nimport { camelize, getDocument, isArray } from '@daybrush/utils';\nimport EventEmitter from '@scena/event-emitter';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nvar InnerMoveable = /*#__PURE__*/function (_super) {\n  __extends(InnerMoveable, _super);\n\n  function InnerMoveable(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {};\n    _this.state = _this.props;\n    return _this;\n  }\n\n  var __proto = InnerMoveable.prototype;\n\n  __proto.render = function () {\n    return React.createElement(Moveable$1, __assign({\n      ref: ref(this, \"moveable\")\n    }, this.state));\n  };\n\n  return InnerMoveable;\n}(React.Component);\n\nvar PROPERTIES = MOVEABLE_PROPS;\nvar METHODS = MOVEABLE_METHODS;\nvar EVENTS = MOVEABLE_EVENTS;\n\n/**\r\n * Moveable is Draggable! Resizable! Scalable! Rotatable!\r\n * @sort 1\r\n * @alias Moveable\r\n * @extends EventEmitter\r\n */\n\nvar MoveableManager = /*#__PURE__*/function (_super) {\n  __extends(MoveableManager, _super);\n  /**\r\n   *\r\n   */\n\n\n  function MoveableManager(parentElement, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.containerProvider = null;\n    _this.selfElement = null;\n    _this._warp = false;\n\n    var nextOptions = __assign({}, options);\n\n    var events = {};\n    EVENTS.forEach(function (name) {\n      events[camelize(\"on \".concat(name))] = function (e) {\n        return _this.trigger(name, e);\n      };\n    });\n    var selfElement;\n\n    if (options.warpSelf) {\n      delete options.warpSelf;\n      _this._warp = true;\n      selfElement = parentElement;\n    } else {\n      selfElement = getDocument(parentElement).createElement(\"div\");\n      parentElement.appendChild(selfElement);\n    }\n\n    _this.containerProvider = renderSelf(React.createElement(InnerMoveable, __assign({\n      ref: ref(_this, \"innerMoveable\")\n    }, nextOptions, events)), selfElement);\n    _this.selfElement = selfElement;\n    var target = nextOptions.target;\n\n    if (isArray(target) && target.length > 1) {\n      _this.updateRect();\n    }\n\n    return _this;\n  }\n\n  var __proto = MoveableManager.prototype;\n\n  __proto.setState = function (state, callback) {\n    this.innerMoveable.setState(state, callback);\n  };\n\n  __proto.forceUpdate = function (callback) {\n    this.innerMoveable.forceUpdate(callback);\n  };\n\n  __proto.dragStart = function (e, target) {\n    if (target === void 0) {\n      target = e.target;\n    }\n\n    var innerMoveable = this.innerMoveable;\n\n    if (innerMoveable.$_timer) {\n      this.forceUpdate();\n    }\n\n    this.getMoveable().dragStart(e, target);\n  };\n\n  __proto.destroy = function () {\n    var _a;\n\n    var selfElement = this.selfElement;\n    renderSelf(null, selfElement, this.containerProvider);\n\n    if (!this._warp) {\n      (_a = selfElement === null || selfElement === void 0 ? void 0 : selfElement.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(selfElement);\n    }\n\n    this.containerProvider = null;\n    this.off();\n    this.selfElement = null;\n    this.innerMoveable = null;\n  };\n\n  __proto.getMoveable = function () {\n    return this.innerMoveable.moveable;\n  };\n\n  MoveableManager = __decorate([Properties(METHODS, function (prototype, property) {\n    if (prototype[property]) {\n      return;\n    }\n\n    prototype[property] = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var self = this.getMoveable();\n\n      if (!self || !self[property]) {\n        return;\n      }\n\n      return self[property].apply(self, args);\n    };\n  }), Properties(PROPERTIES, function (prototype, property) {\n    Object.defineProperty(prototype, property, {\n      get: function () {\n        return this.getMoveable().props[property];\n      },\n      set: function (value) {\n        var _a;\n\n        this.setState((_a = {}, _a[property] = value, _a));\n      },\n      enumerable: true,\n      configurable: true\n    });\n  })], MoveableManager);\n  return MoveableManager;\n}(EventEmitter);\n\nvar Moveable = /*#__PURE__*/function (_super) {\n  __extends(Moveable, _super);\n\n  function Moveable() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Moveable;\n}(MoveableManager);\n\nfunction getElementInfo(target, container, rootContainer) {\n  return getElementInfo$1(target, container, rootContainer);\n}\nfunction makeAble(name, able) {\n  return makeAble$1(name, able);\n}\n\nexport { EVENTS, METHODS, PROPERTIES, Moveable as default, getElementInfo, makeAble };\n//# sourceMappingURL=moveable.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: keycon\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/keycon.git\nversion: 1.2.2\n*/\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\n/*\nCopyright (c) 2018 Daybrush\n@name: @daybrush/utils\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/utils\n@version 1.7.1\n*/\n/**\n* get string \"object\"\n* @memberof Consts\n* @example\nimport {OBJECT} from \"@daybrush/utils\";\n\nconsole.log(OBJECT); // \"object\"\n*/\n\nvar OBJECT = \"object\";\n/**\n* get string \"string\"\n* @memberof Consts\n* @example\nimport {STRING} from \"@daybrush/utils\";\n\nconsole.log(STRING); // \"string\"\n*/\n\nvar STRING = \"string\";\n/**\n* Check the type that the value is object.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isObject} from \"@daybrush/utils\";\n\nconsole.log(isObject({})); // true\nconsole.log(isObject(undefined)); // false\nconsole.log(isObject(\"\")); // false\nconsole.log(isObject(null)); // false\n*/\n\nfunction isObject(value) {\n  return value && typeof value === OBJECT;\n}\n/**\n* Check the type that the value is isArray.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isArray} from \"@daybrush/utils\";\n\nconsole.log(isArray([])); // true\nconsole.log(isArray({})); // false\nconsole.log(isArray(undefined)); // false\nconsole.log(isArray(null)); // false\n*/\n\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n/**\n* Check the type that the value is string.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isString} from \"@daybrush/utils\";\n\nconsole.log(isString(\"1234\")); // true\nconsole.log(isString(undefined)); // false\nconsole.log(isString(1)); // false\nconsole.log(isString(null)); // false\n*/\n\nfunction isString(value) {\n  return typeof value === STRING;\n}\n/**\n* Returns the index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findIndex } from \"@daybrush/utils\";\n\nfindIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\n\nfunction findIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n\n  return defaultIndex;\n}\n/**\n* Sets up a function that will be called whenever the specified event is delivered to the target\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The object which receives a notification (an object that implements the Event interface) when an event of the specified type occurs\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent} from \"@daybrush/utils\";\n\naddEvent(el, \"click\", e => {\n  console.log(e);\n});\n*/\n\nfunction addEvent(el, type, listener, options) {\n  el.addEventListener(type, listener, options);\n}\n/**\n* removes from the EventTarget an event listener previously registered with EventTarget.addEventListener()\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The EventListener function of the event handler to remove from the event target.\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent, removeEvent} from \"@daybrush/utils\";\nconst listener = e => {\n  console.log(e);\n};\naddEvent(el, \"click\", listener);\nremoveEvent(el, \"click\", listener);\n*/\n\nfunction removeEvent(el, type, listener, options) {\n  el.removeEventListener(type, listener, options);\n}\n\n/*\nCopyright (c) 2019 Daybrush\nname: @scena/event-emitter\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesture.git\nversion: 1.0.5\n*/\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\n/**\n * Implement EventEmitter on object or component.\n */\n\nvar EventEmitter =\n/*#__PURE__*/\nfunction () {\n  function EventEmitter() {\n    this._events = {};\n  }\n  /**\n   * Add a listener to the registered event.\n   * @param - Name of the event to be added\n   * @param - listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add listener in \"a\" event\n   * emitter.on(\"a\", () => {\n   * });\n   * // Add listeners\n   * emitter.on({\n   *  a: () => {},\n   *  b: () => {},\n   * });\n   */\n\n\n  var __proto = EventEmitter.prototype;\n\n  __proto.on = function (eventName, listener) {\n    if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.on(name, eventName[name]);\n      }\n    } else {\n      this._addEvent(eventName, listener, {});\n    }\n\n    return this;\n  };\n  /**\n   * Remove listeners registered in the event target.\n   * @param - Name of the event to be removed\n   * @param - listener function of the event to be removed\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Remove all listeners.\n   * emitter.off();\n   *\n   * // Remove all listeners in \"A\" event.\n   * emitter.off(\"a\");\n   *\n   *\n   * // Remove \"listener\" listener in \"a\" event.\n   * emitter.off(\"a\", listener);\n   */\n\n\n  __proto.off = function (eventName, listener) {\n    if (!eventName) {\n      this._events = {};\n    } else if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.off(name);\n      }\n    } else if (!listener) {\n      this._events[eventName] = [];\n    } else {\n      var events = this._events[eventName];\n\n      if (events) {\n        var index = findIndex(events, function (e) {\n          return e.listener === listener;\n        });\n\n        if (index > -1) {\n          events.splice(index, 1);\n        }\n      }\n    }\n\n    return this;\n  };\n  /**\n   * Add a disposable listener and Use promise to the registered event.\n   * @param - Name of the event to be added\n   * @param - disposable listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add a disposable listener in \"a\" event\n   * emitter.once(\"a\", () => {\n   * });\n   *\n   * // Use Promise\n   * emitter.once(\"a\").then(e => {\n   * });\n   */\n\n\n  __proto.once = function (eventName, listener) {\n    var _this = this;\n\n    if (listener) {\n      this._addEvent(eventName, listener, {\n        once: true\n      });\n    }\n\n    return new Promise(function (resolve) {\n      _this._addEvent(eventName, resolve, {\n        once: true\n      });\n    });\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n\n  __proto.emit = function (eventName, param) {\n    var _this = this;\n\n    if (param === void 0) {\n      param = {};\n    }\n\n    var events = this._events[eventName];\n\n    if (!eventName || !events) {\n      return true;\n    }\n\n    var isStop = false;\n    param.eventType = eventName;\n\n    param.stop = function () {\n      isStop = true;\n    };\n\n    param.currentTarget = this;\n\n    __spreadArrays(events).forEach(function (info) {\n      info.listener(param);\n\n      if (info.once) {\n        _this.off(eventName, info.listener);\n      }\n    });\n\n    return !isStop;\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n  /**\n  * Fires an event to call listeners.\n  * @param - Event name\n  * @param - Event parameter\n  * @return If false, stop the event.\n  * @example\n  *\n  * import EventEmitter from \"@scena/event-emitter\";\n  *\n  *\n  * const emitter = new EventEmitter();\n  *\n  * emitter.on(\"a\", e => {\n  * });\n  *\n  * // emit\n  * emitter.trigger(\"a\", {\n  *   a: 1,\n  * });\n  */\n\n\n  __proto.trigger = function (eventName, param) {\n    if (param === void 0) {\n      param = {};\n    }\n\n    return this.emit(eventName, param);\n  };\n\n  __proto._addEvent = function (eventName, listener, options) {\n    var events = this._events;\n    events[eventName] = events[eventName] || [];\n    var listeners = events[eventName];\n    listeners.push(__assign({\n      listener: listener\n    }, options));\n  };\n\n  return EventEmitter;\n}();\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar keycode = createCommonjsModule(function (module, exports) {\n// Source: http://jsfiddle.net/vWx8V/\n// http://stackoverflow.com/questions/5603195/full-list-of-javascript-keycodes\n\n/**\n * Conenience method returns corresponding value for given keyName or keyCode.\n *\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Mixed}\n * @api public\n */\n\nfunction keyCode(searchInput) {\n  // Keyboard Events\n  if (searchInput && 'object' === typeof searchInput) {\n    var hasKeyCode = searchInput.which || searchInput.keyCode || searchInput.charCode;\n    if (hasKeyCode) searchInput = hasKeyCode;\n  }\n\n  // Numbers\n  if ('number' === typeof searchInput) return names[searchInput]\n\n  // Everything else (cast to string)\n  var search = String(searchInput);\n\n  // check codes\n  var foundNamedKey = codes[search.toLowerCase()];\n  if (foundNamedKey) return foundNamedKey\n\n  // check aliases\n  var foundNamedKey = aliases[search.toLowerCase()];\n  if (foundNamedKey) return foundNamedKey\n\n  // weird character?\n  if (search.length === 1) return search.charCodeAt(0)\n\n  return undefined\n}\n\n/**\n * Compares a keyboard event with a given keyCode or keyName.\n *\n * @param {Event} event Keyboard event that should be tested\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Boolean}\n * @api public\n */\nkeyCode.isEventKey = function isEventKey(event, nameOrCode) {\n  if (event && 'object' === typeof event) {\n    var keyCode = event.which || event.keyCode || event.charCode;\n    if (keyCode === null || keyCode === undefined) { return false; }\n    if (typeof nameOrCode === 'string') {\n      // check codes\n      var foundNamedKey = codes[nameOrCode.toLowerCase()];\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    \n      // check aliases\n      var foundNamedKey = aliases[nameOrCode.toLowerCase()];\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    } else if (typeof nameOrCode === 'number') {\n      return nameOrCode === keyCode;\n    }\n    return false;\n  }\n};\n\nexports = module.exports = keyCode;\n\n/**\n * Get by name\n *\n *   exports.code['enter'] // => 13\n */\n\nvar codes = exports.code = exports.codes = {\n  'backspace': 8,\n  'tab': 9,\n  'enter': 13,\n  'shift': 16,\n  'ctrl': 17,\n  'alt': 18,\n  'pause/break': 19,\n  'caps lock': 20,\n  'esc': 27,\n  'space': 32,\n  'page up': 33,\n  'page down': 34,\n  'end': 35,\n  'home': 36,\n  'left': 37,\n  'up': 38,\n  'right': 39,\n  'down': 40,\n  'insert': 45,\n  'delete': 46,\n  'command': 91,\n  'left command': 91,\n  'right command': 93,\n  'numpad *': 106,\n  'numpad +': 107,\n  'numpad -': 109,\n  'numpad .': 110,\n  'numpad /': 111,\n  'num lock': 144,\n  'scroll lock': 145,\n  'my computer': 182,\n  'my calculator': 183,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  \"'\": 222\n};\n\n// Helper aliases\n\nvar aliases = exports.aliases = {\n  'windows': 91,\n  '': 16,\n  '': 18,\n  '': 17,\n  '': 91,\n  'ctl': 17,\n  'control': 17,\n  'option': 18,\n  'pause': 19,\n  'break': 19,\n  'caps': 20,\n  'return': 13,\n  'escape': 27,\n  'spc': 32,\n  'spacebar': 32,\n  'pgup': 33,\n  'pgdn': 34,\n  'ins': 45,\n  'del': 46,\n  'cmd': 91\n};\n\n/*!\n * Programatically add the following\n */\n\n// lower case chars\nfor (i = 97; i < 123; i++) codes[String.fromCharCode(i)] = i - 32;\n\n// numbers\nfor (var i = 48; i < 58; i++) codes[i - 48] = i;\n\n// function keys\nfor (i = 1; i < 13; i++) codes['f'+i] = i + 111;\n\n// numpad keys\nfor (i = 0; i < 10; i++) codes['numpad '+i] = i + 96;\n\n/**\n * Get by code\n *\n *   exports.name[13] // => 'Enter'\n */\n\nvar names = exports.names = exports.title = {}; // title for backward compat\n\n// Create reverse mapping\nfor (i in codes) names[codes[i]] = i;\n\n// Add aliases\nfor (var alias in aliases) {\n  codes[alias] = aliases[alias];\n}\n});\nvar keycode_1 = keycode.code;\nvar keycode_2 = keycode.codes;\nvar keycode_3 = keycode.aliases;\nvar keycode_4 = keycode.names;\nvar keycode_5 = keycode.title;\n\nvar codeData = {\n  \"+\": \"plus\",\n  \"left command\": \"meta\",\n  \"right command\": \"meta\"\n};\nvar keysSort = {\n  shift: 1,\n  ctrl: 2,\n  alt: 3,\n  meta: 4\n};\n/**\n * @memberof KeyController\n */\n\nfunction getKey(keyCode, keyName) {\n  var key = (keycode_4[keyCode] || keyName || \"\").toLowerCase();\n\n  for (var name in codeData) {\n    key = key.replace(name, codeData[name]);\n  }\n\n  return key.replace(/\\s/g, \"\");\n}\n/**\n * @memberof KeyController\n */\n\nfunction getCombi(e, key) {\n  if (key === void 0) {\n    key = getKey(e.keyCode, e.key);\n  }\n\n  var keys = getModifierCombi(e);\n  keys.indexOf(key) === -1 && keys.push(key);\n  return keys.filter(Boolean);\n}\n/**\n * @memberof KeyController\n */\n\nfunction getModifierCombi(e) {\n  var keys = [e.shiftKey && \"shift\", e.ctrlKey && \"ctrl\", e.altKey && \"alt\", e.metaKey && \"meta\"];\n  return keys.filter(Boolean);\n}\n\nfunction getArrangeCombi(keys) {\n  var arrangeKeys = keys.slice();\n  arrangeKeys.sort(function (prev, next) {\n    var prevScore = keysSort[prev] || 5;\n    var nextScore = keysSort[next] || 5;\n    return prevScore - nextScore;\n  });\n  return arrangeKeys;\n}\n\nvar globalKeyController;\n/**\n */\n\nvar KeyController =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(KeyController, _super);\n  /**\n   *\n   */\n\n\n  function KeyController(container) {\n    if (container === void 0) {\n      container = window;\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.container = container;\n    /**\n     */\n\n    _this.ctrlKey = false;\n    /**\n     */\n\n    _this.altKey = false;\n    /**\n     *\n     */\n\n    _this.shiftKey = false;\n    /**\n     *\n     */\n\n    _this.metaKey = false;\n\n    _this.clear = function () {\n      _this.ctrlKey = false;\n      _this.altKey = false;\n      _this.shiftKey = false;\n      _this.metaKey = false;\n      return _this;\n    };\n\n    _this.keydownEvent = function (e) {\n      _this.triggerEvent(\"keydown\", e);\n    };\n\n    _this.keyupEvent = function (e) {\n      _this.triggerEvent(\"keyup\", e);\n    };\n\n    _this.blur = function () {\n      _this.clear();\n\n      _this.trigger(\"blur\");\n    };\n\n    addEvent(container, \"blur\", _this.blur);\n    addEvent(container, \"keydown\", _this.keydownEvent);\n    addEvent(container, \"keyup\", _this.keyupEvent);\n    return _this;\n  }\n\n  var __proto = KeyController.prototype;\n  Object.defineProperty(KeyController, \"global\", {\n    /**\n     */\n    get: function () {\n      return globalKeyController || (globalKeyController = new KeyController());\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  KeyController.setGlobal = function () {\n    return this.global;\n  };\n  /**\n   *\n   */\n\n\n  __proto.destroy = function () {\n    var container = this.container;\n    this.clear();\n    this.off();\n    removeEvent(container, \"blur\", this.blur);\n    removeEvent(container, \"keydown\", this.keydownEvent);\n    removeEvent(container, \"keyup\", this.keyupEvent);\n  };\n  /**\n   *\n   */\n\n\n  __proto.keydown = function (comb, callback) {\n    return this.addEvent(\"keydown\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.offKeydown = function (comb, callback) {\n    return this.removeEvent(\"keydown\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.offKeyup = function (comb, callback) {\n    return this.removeEvent(\"keyup\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.keyup = function (comb, callback) {\n    return this.addEvent(\"keyup\", comb, callback);\n  };\n\n  __proto.addEvent = function (type, comb, callback) {\n    if (isArray(comb)) {\n      this.on(type + \".\" + getArrangeCombi(comb).join(\".\"), callback);\n    } else if (isString(comb)) {\n      this.on(type + \".\" + comb, callback);\n    } else {\n      this.on(type, comb);\n    }\n\n    return this;\n  };\n\n  __proto.removeEvent = function (type, comb, callback) {\n    if (isArray(comb)) {\n      this.off(type + \".\" + getArrangeCombi(comb).join(\".\"), callback);\n    } else if (isString(comb)) {\n      this.off(type + \".\" + comb, callback);\n    } else {\n      this.off(type, comb);\n    }\n\n    return this;\n  };\n\n  __proto.triggerEvent = function (type, e) {\n    this.ctrlKey = e.ctrlKey;\n    this.shiftKey = e.shiftKey;\n    this.altKey = e.altKey;\n    this.metaKey = e.metaKey;\n    var key = getKey(e.keyCode, e.key);\n    var isToggle = key === \"ctrl\" || key === \"shift\" || key === \"meta\" || key === \"alt\";\n    var param = {\n      key: key,\n      isToggle: isToggle,\n      inputEvent: e,\n      keyCode: e.keyCode,\n      ctrlKey: e.ctrlKey,\n      altKey: e.altKey,\n      shiftKey: e.shiftKey,\n      metaKey: e.metaKey\n    };\n    this.trigger(type, param);\n    this.trigger(type + \".\" + key, param);\n    var combi = getCombi(e, key);\n    combi.length > 1 && this.trigger(type + \".\" + combi.join(\".\"), param);\n  };\n\n  return KeyController;\n}(EventEmitter);\n\nexport default KeyController;\nexport { getCombi, getKey, getModifierCombi };\n//# sourceMappingURL=keycon.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: selecto\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/selecto.git\nversion: 1.26.3\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport Gesto from 'gesto';\nimport { Properties } from 'framework-utils';\nimport { getDocument, hasClass, addClass, calculateBoundSize, getDist, getWindow, isObject, isString, isNode, removeEvent, isFunction, addEvent, isArray, camelize, splitUnit, between } from '@daybrush/utils';\nimport { diff } from '@egjs/children-differ';\nimport DragScroll from '@scena/dragscroll';\nimport KeyController, { getCombi } from 'keycon';\nimport { fitPoints, getOverlapPoints, isInside, getAreaSize } from 'overlap-area';\nimport { createMatrix, getDistElementMatrix, calculateMatrixDist } from 'css-to-mat';\nimport styled from 'css-styled';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nfunction getClient(e) {\n  if (\"touches\" in e) {\n    var touch = e.touches[0] || e.changedTouches[0];\n    return {\n      clientX: touch.clientX,\n      clientY: touch.clientY\n    };\n  } else {\n    return {\n      clientX: e.clientX,\n      clientY: e.clientY\n    };\n  }\n}\nfunction filterDuplicated(arr) {\n  if (typeof Map === \"undefined\") {\n    return arr.filter(function (value, index) {\n      return arr.indexOf(value) === index;\n    });\n  }\n\n  var map = new Map();\n  return arr.filter(function (value) {\n    if (map.has(value)) {\n      return false;\n    }\n\n    map.set(value, true);\n    return true;\n  });\n}\nfunction elementFromPoint(baseNode, clientX, clientY) {\n  var doc = getDocument(baseNode);\n  return doc.elementFromPoint && doc.elementFromPoint(clientX, clientY) || null;\n}\nfunction createElement(jsx, prevTarget, container) {\n  var tag = jsx.tag,\n      children = jsx.children,\n      attributes = jsx.attributes,\n      className = jsx.className,\n      style = jsx.style;\n  var el = prevTarget || getDocument(container).createElement(tag);\n\n  for (var name in attributes) {\n    el.setAttribute(name, attributes[name]);\n  }\n\n  var elChildren = el.children;\n  children.forEach(function (child, i) {\n    createElement(child, elChildren[i], el);\n  });\n\n  if (className) {\n    className.split(/\\s+/g).forEach(function (name) {\n      if (name && !hasClass(el, name)) {\n        addClass(el, name);\n      }\n    });\n  }\n\n  if (style) {\n    var elStyle = el.style;\n\n    for (var name in style) {\n      elStyle[name] = style[name];\n    }\n  }\n\n  if (!prevTarget && container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\nfunction h(tag, attrs) {\n  var children = [];\n\n  for (var _i = 2; _i < arguments.length; _i++) {\n    children[_i - 2] = arguments[_i];\n  }\n\n  var _a = attrs || {},\n      _b = _a.className,\n      className = _b === void 0 ? \"\" : _b,\n      _c = _a.style,\n      style = _c === void 0 ? {} : _c,\n      attributes = __rest(_a, [\"className\", \"style\"]);\n\n  return {\n    tag: tag,\n    className: className,\n    style: style,\n    attributes: attributes,\n    children: children\n  };\n}\nfunction diffValue(prev, cur, func) {\n  if (prev !== cur) {\n    func(prev, cur);\n  }\n}\nfunction getRect(e, ratio, boundArea) {\n  var _a;\n\n  if (boundArea === void 0) {\n    boundArea = e.data.boundArea;\n  }\n\n  var _b = e.distX,\n      distX = _b === void 0 ? 0 : _b,\n      _c = e.distY,\n      distY = _c === void 0 ? 0 : _c;\n  var _d = e.data,\n      startX = _d.startX,\n      startY = _d.startY;\n\n  if (ratio > 0) {\n    var nextHeight = Math.sqrt((distX * distX + distY * distY) / (1 + ratio * ratio));\n    var nextWidth = ratio * nextHeight;\n    distX = (distX >= 0 ? 1 : -1) * nextWidth;\n    distY = (distY >= 0 ? 1 : -1) * nextHeight;\n  }\n\n  var width = Math.abs(distX);\n  var height = Math.abs(distY);\n  var maxWidth = distX < 0 ? startX - boundArea.left : boundArea.right - startX;\n  var maxHeight = distY < 0 ? startY - boundArea.top : boundArea.bottom - startY;\n  _a = calculateBoundSize([width, height], [0, 0], [maxWidth, maxHeight], !!ratio), width = _a[0], height = _a[1];\n  distX = (distX >= 0 ? 1 : -1) * width;\n  distY = (distY >= 0 ? 1 : -1) * height;\n  var tx = Math.min(0, distX);\n  var ty = Math.min(0, distY);\n  var left = startX + tx;\n  var top = startY + ty;\n  return {\n    left: left,\n    top: top,\n    right: left + width,\n    bottom: top + height,\n    width: width,\n    height: height\n  };\n}\nfunction getDefaultElementRect(el) {\n  var rect = el.getBoundingClientRect();\n  var left = rect.left,\n      top = rect.top,\n      width = rect.width,\n      height = rect.height;\n  return {\n    pos1: [left, top],\n    pos2: [left + width, top],\n    pos3: [left, top + height],\n    pos4: [left + width, top + height]\n  };\n}\nfunction passTargets(beforeTargets, afterTargets, continueSelectWithoutDeselect) {\n  var _a = diff(beforeTargets, afterTargets),\n      list = _a.list,\n      prevList = _a.prevList,\n      added = _a.added,\n      removed = _a.removed,\n      maintained = _a.maintained;\n\n  return __spreadArray(__spreadArray(__spreadArray([], added.map(function (index) {\n    return list[index];\n  }), true), removed.map(function (index) {\n    return prevList[index];\n  }), true), continueSelectWithoutDeselect ? maintained.map(function (_a) {\n    var nextIndex = _a[1];\n    return list[nextIndex];\n  }) : [], true);\n}\nfunction getLineSize(points) {\n  var size = 0;\n  var length = points.length;\n\n  for (var i = 1; i < length; ++i) {\n    size = Math.max(getDist(points[i], points[i - 1]), size);\n  }\n\n  return size;\n}\n\nvar injector = styled(\"\\n:host {\\n    position: fixed;\\n    display: none;\\n    border: 1px solid #4af;\\n    background: rgba(68, 170, 255, 0.5);\\n    pointer-events: none;\\n    will-change: transform;\\n    z-index: 100;\\n}\\n\");\n/**\n * @memberof Selecto\n */\n\nvar CLASS_NAME = \"selecto-selection \".concat(injector.className);\nvar PROPERTIES = [\"className\", \"boundContainer\", \"selectableTargets\", \"selectByClick\", \"selectFromInside\", \"continueSelect\", \"continueSelectWithoutDeselect\", \"toggleContinueSelect\", \"toggleContinueSelectWithoutDeselect\", \"keyContainer\", \"hitRate\", \"scrollOptions\", \"checkInput\", \"preventDefault\", \"ratio\", \"getElementRect\", \"preventDragFromInside\", \"rootContainer\", \"dragCondition\", \"clickBySelectEnd\", \"checkOverflow\", \"innerScrollOptions\"];\n/**\n * @memberof Selecto\n */\n\nvar OPTIONS = __spreadArray([// ignore target, container,\n\"dragContainer\", \"cspNonce\", \"preventClickEventOnDrag\", \"preventClickEventOnDragStart\", \"preventRightClick\"], PROPERTIES, true);\nvar OPTION_TYPES = {\n  className: String,\n  boundContainer: null,\n  portalContainer: null,\n  container: null,\n  dragContainer: null,\n  selectableTargets: Array,\n  selectByClick: Boolean,\n  selectFromInside: Boolean,\n  continueSelect: Boolean,\n  toggleContinueSelect: Array,\n  toggleContinueSelectWithoutDeselect: Array,\n  keyContainer: null,\n  hitRate: Number,\n  scrollOptions: Object,\n  checkInput: Boolean,\n  preventDefault: Boolean,\n  cspNonce: String,\n  ratio: Number,\n  getElementRect: Function,\n  preventDragFromInside: Boolean,\n  rootContainer: Object,\n  dragCondition: Function,\n  clickBySelectEnd: Boolean,\n  continueSelectWithoutDeselect: Boolean,\n  preventClickEventOnDragStart: Boolean,\n  preventClickEventOnDrag: Boolean,\n  checkOverflow: Boolean,\n  innerScrollOptions: Object\n};\n/**\n * @memberof Selecto\n */\n\nvar EVENTS = [\"dragStart\", \"drag\", \"dragEnd\", \"selectStart\", \"select\", \"selectEnd\", \"keydown\", \"keyup\", \"scroll\", \"innerScroll\"];\n/**\n * @memberof Selecto\n */\n\nvar METHODS = [\"clickTarget\", \"getSelectableElements\", \"setSelectedTargets\", \"getElementPoints\", \"getSelectedTargets\", \"findSelectableTargets\", \"triggerDragStart\", \"checkScroll\", \"selectTargetsByPoints\", \"setSelectedTargetsByPoints\"];\n\n/**\n * Selecto.js is a component that allows you to select elements in the drag area using the mouse or touch.\n * @sort 1\n * @extends EventEmitter\n */\n\nvar Selecto =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Selecto, _super);\n  /**\n   *\n   */\n\n\n  function Selecto(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.selectedTargets = [];\n    _this.dragScroll = new DragScroll();\n\n    _this._onDragStart = function (e, clickedTarget) {\n      var data = e.data,\n          clientX = e.clientX,\n          clientY = e.clientY,\n          inputEvent = e.inputEvent;\n      var _a = _this.options,\n          selectFromInside = _a.selectFromInside,\n          selectByClick = _a.selectByClick,\n          rootContainer = _a.rootContainer,\n          boundContainer = _a.boundContainer,\n          _b = _a.preventDragFromInside,\n          preventDragFromInside = _b === void 0 ? true : _b,\n          clickBySelectEnd = _a.clickBySelectEnd,\n          dragCondition = _a.dragCondition;\n\n      if (dragCondition && !dragCondition(e)) {\n        e.stop();\n        return;\n      }\n\n      data.data = {};\n      var win = getWindow(_this.container);\n      data.innerWidth = win.innerWidth;\n      data.innerHeight = win.innerHeight;\n\n      _this.findSelectableTargets(data);\n\n      data.startSelectedTargets = _this.selectedTargets;\n      data.scaleMatrix = createMatrix();\n      data.containerX = 0;\n      data.containerY = 0;\n      var container = _this.container;\n      var boundArea = {\n        left: -Infinity,\n        top: -Infinity,\n        right: Infinity,\n        bottom: Infinity\n      };\n\n      if (rootContainer) {\n        var containerRect = _this.container.getBoundingClientRect();\n\n        data.containerX = containerRect.left;\n        data.containerY = containerRect.top;\n        data.scaleMatrix = getDistElementMatrix(_this.container, rootContainer);\n      }\n\n      if (boundContainer) {\n        var boundInfo = isObject(boundContainer) && \"element\" in boundContainer ? __assign({\n          left: true,\n          top: true,\n          bottom: true,\n          right: true\n        }, boundContainer) : {\n          element: boundContainer,\n          left: true,\n          top: true,\n          bottom: true,\n          right: true\n        };\n        var boundElement = boundInfo.element;\n        var rectElement = void 0;\n\n        if (boundElement) {\n          if (isString(boundElement)) {\n            rectElement = getDocument(container).querySelector(boundElement);\n          } else if (boundElement === true) {\n            rectElement = _this.container;\n          } else {\n            rectElement = boundElement;\n          }\n\n          var rect = rectElement.getBoundingClientRect();\n\n          if (boundInfo.left) {\n            boundArea.left = rect.left;\n          }\n\n          if (boundInfo.top) {\n            boundArea.top = rect.top;\n          }\n\n          if (boundInfo.right) {\n            boundArea.right = rect.right;\n          }\n\n          if (boundInfo.bottom) {\n            boundArea.bottom = rect.bottom;\n          }\n        }\n      }\n\n      data.boundArea = boundArea;\n      var hitRect = {\n        left: clientX,\n        top: clientY,\n        right: clientX,\n        bottom: clientY,\n        width: 0,\n        height: 0\n      };\n      var firstPassedTargets = []; // allow click on select\n\n      var allowClickBySelectEnd = selectByClick && !clickBySelectEnd;\n      var hasInsideTargets = false;\n\n      if (!selectFromInside || allowClickBySelectEnd) {\n        var pointTarget = _this._findElement(clickedTarget || inputEvent.target, // elementFromPoint(clientX, clientY),\n        data.selectableTargets);\n\n        hasInsideTargets = !!pointTarget;\n\n        if (allowClickBySelectEnd) {\n          firstPassedTargets = pointTarget ? [pointTarget] : [];\n        }\n      }\n\n      var isPreventSelect = !selectFromInside && hasInsideTargets; // prevent drag from inside when selectByClick is false\n\n      if (isPreventSelect && !selectByClick) {\n        e.stop();\n        return false;\n      }\n\n      var type = inputEvent.type;\n      var isTrusted = type === \"mousedown\" || type === \"touchstart\";\n      /**\n       * When the drag starts (triggers on mousedown or touchstart), the dragStart event is called.\n       * Call the stop () function if you have a specific element or don't want to raise a select\n       * @memberof Selecto\n       * @event dragStart\n       * @param {OnDragStart} - Parameters for the dragStart event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"dragStart\", e => {\n       *   if (e.inputEvent.target.tagName === \"SPAN\") {\n       *     e.stop();\n       *   }\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n      var result = !e.isClick && isTrusted ? _this.emit(\"dragStart\", __assign(__assign({}, e), {\n        data: data.data\n      })) : true;\n\n      if (!result) {\n        e.stop();\n        return false;\n      }\n\n      if (_this.continueSelect) {\n        firstPassedTargets = passTargets(_this.selectedTargets, firstPassedTargets, _this.continueSelectWithoutDeselect);\n        data.startPassedTargets = _this.selectedTargets;\n      } else {\n        data.startPassedTargets = [];\n      }\n\n      _this._select(firstPassedTargets, hitRect, e, true, isPreventSelect && selectByClick && !clickBySelectEnd && preventDragFromInside);\n\n      data.startX = clientX;\n      data.startY = clientY;\n      data.selectFlag = false;\n      data.preventDragFromInside = false;\n\n      if (inputEvent.target) {\n        var offsetPos = calculateMatrixDist(data.scaleMatrix, [clientX - data.containerX, clientY - data.containerY]);\n        _this.target.style.cssText += \"position: \".concat(rootContainer ? \"absolute\" : \"fixed\", \";\") + \"left:0px;top:0px;\" + \"transform: translate(\".concat(offsetPos[0], \"px, \").concat(offsetPos[1], \"px)\");\n      }\n\n      if (isPreventSelect && selectByClick && !clickBySelectEnd) {\n        inputEvent.preventDefault(); // prevent drag from inside when selectByClick is true and force call `selectEnd`\n\n        if (preventDragFromInside) {\n          _this._selectEnd(data.startSelectedTargets, data.startPassedTargets, hitRect, e, true);\n\n          data.preventDragFromInside = true;\n        }\n      } else {\n        data.selectFlag = true; // why?\n        // if (type === \"touchstart\") {\n        //     inputEvent.preventDefault();\n        // }\n\n        var _c = _this.options,\n            scrollOptions = _c.scrollOptions,\n            innerScrollOptions = _c.innerScrollOptions;\n        var isInnerScroll = false;\n\n        if (innerScrollOptions) {\n          var inputEvent_1 = e.inputEvent;\n          var target = inputEvent_1.target;\n          var innerScrollElement = null;\n          var parentElement = target;\n\n          while (parentElement && parentElement !== getDocument(container).body) {\n            var overflow = getComputedStyle(parentElement).overflow !== \"visible\";\n\n            if (overflow) {\n              innerScrollElement = parentElement;\n              break;\n            }\n\n            parentElement = parentElement.parentElement;\n          }\n\n          if (innerScrollElement) {\n            data.innerScrollOptions = __assign({\n              container: innerScrollElement,\n              checkScrollEvent: true\n            }, innerScrollOptions === true ? {} : innerScrollOptions);\n\n            _this.dragScroll.dragStart(e, data.innerScrollOptions);\n\n            isInnerScroll = true;\n          }\n        }\n\n        if (!isInnerScroll && scrollOptions && scrollOptions.container) {\n          _this.dragScroll.dragStart(e, scrollOptions);\n        }\n\n        if (isPreventSelect && selectByClick && clickBySelectEnd) {\n          data.selectFlag = false;\n          e.preventDrag();\n        }\n      }\n\n      return true;\n    };\n\n    _this._onDrag = function (e) {\n      if (e.data.selectFlag) {\n        var scrollOptions = _this.scrollOptions;\n        var innerScrollOptions = e.data.innerScrollOptions;\n        var hasScrollOptions = innerScrollOptions || (scrollOptions === null || scrollOptions === void 0 ? void 0 : scrollOptions.container); // If it is a scrolling position, pass drag\n\n        if (hasScrollOptions && !e.isScroll && _this.dragScroll.drag(e, innerScrollOptions || scrollOptions)) {\n          return;\n        }\n      }\n\n      _this._checkSelected(e);\n    };\n\n    _this._onDragEnd = function (e) {\n      var data = e.data,\n          inputEvent = e.inputEvent;\n      var rect = getRect(e, _this.options.ratio);\n      var selectFlag = data.selectFlag;\n      var container = _this.container;\n      /**\n       * When the drag ends (triggers on mouseup or touchend after drag), the dragEnd event is called.\n       * @memberof Selecto\n       * @event dragEnd\n       * @param {OnDragEnd} - Parameters for the dragEnd event\n       */\n\n      if (inputEvent) {\n        _this.emit(\"dragEnd\", __assign(__assign({\n          isDouble: !!e.isDouble,\n          isClick: !!e.isClick,\n          isDrag: false,\n          isSelect: selectFlag\n        }, e), {\n          data: data.data,\n          rect: rect\n        }));\n      }\n\n      _this.target.style.cssText += \"display: none;\";\n\n      if (selectFlag) {\n        data.selectFlag = false;\n\n        _this.dragScroll.dragEnd();\n      } else if (_this.selectByClick && _this.clickBySelectEnd) {\n        // only clickBySelectEnd\n        var pointTarget = _this._findElement((inputEvent === null || inputEvent === void 0 ? void 0 : inputEvent.target) || elementFromPoint(container, e.clientX, e.clientY), data.selectableTargets);\n\n        _this._select(pointTarget ? [pointTarget] : [], rect, e);\n      }\n\n      if (!data.preventDragFromInside) {\n        _this._selectEnd(data.startSelectedTargets, data.startPassedTargets, rect, e);\n      }\n    };\n\n    _this._onKeyDown = function (e) {\n      var options = _this.options;\n      var isKeyDown = false;\n\n      if (!_this._keydownContinueSelect) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelect);\n\n        _this._keydownContinueSelect = result;\n        isKeyDown || (isKeyDown = result);\n      }\n\n      if (!_this._keydownContinueSelectWithoutDeselection) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelectWithoutDeselect);\n\n        _this._keydownContinueSelectWithoutDeselection = result;\n        isKeyDown || (isKeyDown = result);\n      }\n\n      if (!isKeyDown) {\n        return;\n      }\n      /**\n       * When you keydown the key you specified in toggleContinueSelect, the keydown event is called.\n       * @memberof Selecto\n       * @event keydown\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   toggleContinueSelect: \"shift\";\n       *   keyContainer: window,\n       * });\n       *\n       * selecto.on(\"keydown\", () => {\n       *   document.querySelector(\".button\").classList.add(\"selected\");\n       * }).on(\"keyup\", () => {\n       *   document.querySelector(\".button\").classList.remove(\"selected\");\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n\n      _this.emit(\"keydown\", {\n        keydownContinueSelect: _this._keydownContinueSelect,\n        keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n      });\n    };\n\n    _this._onKeyUp = function (e) {\n      var options = _this.options;\n      var isKeyUp = false;\n\n      if (_this._keydownContinueSelect) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelect, true);\n\n        _this._keydownContinueSelect = !result;\n        isKeyUp || (isKeyUp = result);\n      }\n\n      if (_this._keydownContinueSelectWithoutDeselection) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelectWithoutDeselect, true);\n\n        _this._keydownContinueSelectWithoutDeselection = !result;\n        isKeyUp || (isKeyUp = result);\n      }\n\n      if (!isKeyUp) {\n        return;\n      }\n      /**\n       * When you keyup the key you specified in toggleContinueSelect, the keyup event is called.\n       * @memberof Selecto\n       * @event keyup\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   toggleContinueSelect: \"shift\";\n       *   keyContainer: window,\n       * });\n       *\n       * selecto.on(\"keydown\", () => {\n       *   document.querySelector(\".button\").classList.add(\"selected\");\n       * }).on(\"keyup\", () => {\n       *   document.querySelector(\".button\").classList.remove(\"selected\");\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n\n      _this.emit(\"keyup\", {\n        keydownContinueSelect: _this._keydownContinueSelect,\n        keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n      });\n    };\n\n    _this._onBlur = function () {\n      if (_this._keydownContinueSelect || _this._keydownContinueSelectWithoutDeselection) {\n        _this._keydownContinueSelect = false;\n        _this._keydownContinueSelectWithoutDeselection = false;\n\n        _this.emit(\"keyup\", {\n          keydownContinueSelect: _this._keydownContinueSelect,\n          keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n        });\n      }\n    };\n\n    _this._onDocumentSelectStart = function (e) {\n      var doc = getDocument(_this.container);\n\n      if (!_this.gesto.isFlag()) {\n        return;\n      }\n\n      var dragContainer = _this.dragContainer;\n\n      if (dragContainer === getWindow(_this.container)) {\n        dragContainer = doc.documentElement;\n      }\n\n      var containers = isNode(dragContainer) ? [dragContainer] : [].slice.call(dragContainer);\n      var target = e.target;\n      containers.some(function (container) {\n        if (container === target || container.contains(target)) {\n          e.preventDefault();\n          return true;\n        }\n      });\n    };\n\n    _this.target = options.portalContainer;\n    var container = options.container;\n    _this.options = __assign({\n      className: \"\",\n      portalContainer: null,\n      container: null,\n      dragContainer: null,\n      selectableTargets: [],\n      selectByClick: true,\n      selectFromInside: true,\n      clickBySelectEnd: false,\n      hitRate: 100,\n      continueSelect: false,\n      continueSelectWithoutDeselect: false,\n      toggleContinueSelect: null,\n      toggleContinueSelectWithoutDeselect: null,\n      keyContainer: null,\n      scrollOptions: null,\n      checkInput: false,\n      preventDefault: false,\n      boundContainer: false,\n      preventDragFromInside: true,\n      dragCondition: null,\n      rootContainer: null,\n      checkOverflow: false,\n      innerScrollOptions: false,\n      getElementRect: getDefaultElementRect,\n      cspNonce: \"\",\n      ratio: 0\n    }, options);\n    var portalContainer = _this.options.portalContainer;\n\n    if (portalContainer) {\n      container = portalContainer.parentElement;\n    }\n\n    _this.container = container || document.body;\n\n    _this.initElement();\n\n    _this.initDragScroll();\n\n    _this.setKeyController();\n\n    return _this;\n  }\n  /**\n   * You can set the currently selected targets.\n   * selectByClick, continueSelect, and continueSelectWithoutDeselect are not applied.\n   */\n\n\n  var __proto = Selecto.prototype;\n\n  __proto.setSelectedTargets = function (selectedTargets) {\n    var beforeSelected = this.selectedTargets;\n\n    var _a = diff(beforeSelected, selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    this.selectedTargets = selectedTargets;\n    return {\n      added: added.map(function (index) {\n        return list[index];\n      }),\n      removed: removed.map(function (index) {\n        return prevList[index];\n      }),\n      beforeSelected: beforeSelected,\n      selected: selectedTargets\n    };\n  };\n  /**\n   * You can set the currently selected targets by points\n   * selectByClick, continueSelect, and continueSelectWithoutDeselect are not applied.\n   */\n\n\n  __proto.setSelectedTargetsByPoints = function (point1, point2) {\n    var left = Math.min(point1[0], point2[0]);\n    var top = Math.min(point1[1], point2[1]);\n    var right = Math.max(point1[0], point2[0]);\n    var bottom = Math.max(point1[1], point2[1]);\n    var rect = {\n      left: left,\n      top: top,\n      right: right,\n      bottom: bottom,\n      width: right - left,\n      height: bottom - top\n    };\n    var data = {\n      ignoreClick: true\n    };\n    this.findSelectableTargets(data);\n    var selectedElements = this.hitTest(rect, data, true, null);\n    var result = this.setSelectedTargets(selectedElements);\n    return __assign(__assign({}, result), {\n      rect: rect\n    });\n  };\n  /**\n   * Select target by virtual drag from startPoint to endPoint.\n   * The target of inputEvent is null.\n   */\n\n\n  __proto.selectTargetsByPoints = function (startPoint, endPoint) {\n    var mousedown = new MouseEvent(\"mousedown\", {\n      clientX: startPoint[0],\n      clientY: startPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var mousemove = new MouseEvent(\"mousemove\", {\n      clientX: endPoint[0],\n      clientY: endPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var mouseup = new MouseEvent(\"mousemove\", {\n      clientX: endPoint[0],\n      clientY: endPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var gesto = this.gesto;\n    var result = gesto.onDragStart(mousedown);\n\n    if (result !== false) {\n      gesto.onDrag(mousemove);\n      gesto.onDragEnd(mouseup);\n    }\n  };\n  /**\n   * You can get the currently selected targets.\n   */\n\n\n  __proto.getSelectedTargets = function () {\n    return this.selectedTargets;\n  };\n  /**\n   * `OnDragStart` is triggered by an external event.\n   * @param - external event\n   * @example\n   * import Selecto from \"selecto\";\n   *\n   * const selecto = new Selecto();\n   *\n   * window.addEventListener(\"mousedown\", e => {\n   *   selecto.triggerDragStart(e);\n   * });\n   */\n\n\n  __proto.triggerDragStart = function (e) {\n    this.gesto.triggerDragStart(e);\n    return this;\n  };\n  /**\n   * Destroy elements, properties, and events.\n   */\n\n\n  __proto.destroy = function () {\n    var _a;\n\n    this.off();\n    this.keycon && this.keycon.destroy();\n    this.gesto.unset();\n    this.injectResult.destroy();\n    this.dragScroll.dragEnd();\n    removeEvent(document, \"selectstart\", this._onDocumentSelectStart);\n\n    if (!this.options.portalContainer) {\n      (_a = this.target.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.target);\n    }\n\n    this.keycon = null;\n    this.gesto = null;\n    this.injectResult = null;\n    this.target = null;\n    this.container = null;\n    this.options = null;\n  };\n\n  __proto.getElementPoints = function (target) {\n    var getElementRect = this.getElementRect || getDefaultElementRect;\n    var info = getElementRect(target);\n    var points = [info.pos1, info.pos2, info.pos4, info.pos3];\n\n    if (getElementRect !== getDefaultElementRect) {\n      var rect = target.getBoundingClientRect();\n      return fitPoints(points, rect);\n    }\n\n    return points;\n  };\n  /**\n   * Get all elements set in `selectableTargets`.\n   */\n\n\n  __proto.getSelectableElements = function () {\n    var container = this.container;\n    var selectableElements = [];\n    this.options.selectableTargets.forEach(function (target) {\n      if (isFunction(target)) {\n        var result = target();\n\n        if (result) {\n          selectableElements.push.apply(selectableElements, [].slice.call(result));\n        }\n      } else if (isNode(target)) {\n        selectableElements.push(target);\n      } else if (isObject(target)) {\n        selectableElements.push(target.value || target.current);\n      } else {\n        var elements = [].slice.call(getDocument(container).querySelectorAll(target));\n        selectableElements.push.apply(selectableElements, elements);\n      }\n    });\n    return selectableElements;\n  };\n  /**\n   * If scroll occurs during dragging, you can manually call this method to check the position again.\n   */\n\n\n  __proto.checkScroll = function () {\n    if (!this.gesto.isFlag()) {\n      return;\n    }\n\n    var scrollOptions = this.scrollOptions;\n    var innerScrollOptions = this.gesto.getEventData().innerScrollOptions;\n    var hasScrollOptions = innerScrollOptions || (scrollOptions === null || scrollOptions === void 0 ? void 0 : scrollOptions.container); // If it is a scrolling position, pass drag\n\n    if (hasScrollOptions) {\n      this.dragScroll.checkScroll(__assign({\n        inputEvent: this.gesto.getCurrentEvent()\n      }, innerScrollOptions || scrollOptions));\n    }\n  };\n  /**\n   * Find for selectableTargets again during drag event\n   * You can update selectable targets during an event.\n   */\n\n\n  __proto.findSelectableTargets = function (data) {\n    var _this = this;\n\n    if (data === void 0) {\n      data = this.gesto.getEventData();\n    }\n\n    var selectableTargets = this.getSelectableElements();\n    var selectablePoints = selectableTargets.map(function (target) {\n      return _this.getElementPoints(target);\n    });\n    data.selectableTargets = selectableTargets;\n    data.selectablePoints = selectablePoints;\n    data.selectableParentMap = null;\n    var options = this.options;\n    var hasIndexesMap = options.checkOverflow || options.innerScrollOptions;\n    var doc = getDocument(this.container);\n\n    if (hasIndexesMap) {\n      var parentMap_1 = new Map();\n      data.selectableInnerScrollParentMap = parentMap_1;\n      data.selectableInnerScrollPathsList = selectableTargets.map(function (target, index) {\n        var parentElement = target.parentElement;\n        var parents = [];\n        var paths = [];\n\n        var _loop_1 = function () {\n          var info = parentMap_1.get(parentElement);\n\n          if (!info) {\n            var overflow = getComputedStyle(parentElement).overflow !== \"visible\";\n\n            if (overflow) {\n              var rect = getDefaultElementRect(parentElement);\n              info = {\n                parentElement: parentElement,\n                indexes: [],\n                points: [rect.pos1, rect.pos2, rect.pos4, rect.pos3],\n                paths: __spreadArray([], paths, true)\n              };\n              parents.push(parentElement);\n              parents.forEach(function (prevParentElement) {\n                parentMap_1.set(prevParentElement, info);\n              });\n              parents = [];\n            }\n          }\n\n          if (info) {\n            parentElement = info.parentElement;\n            parentMap_1.get(parentElement).indexes.push(index);\n            paths.push(parentElement);\n          } else {\n            parents.push(parentElement);\n          }\n\n          parentElement = parentElement.parentElement;\n        };\n\n        while (parentElement && parentElement !== doc.body) {\n          _loop_1();\n        }\n\n        return paths;\n      });\n    }\n\n    if (!options.checkOverflow) {\n      data.selectableInners = selectableTargets.map(function () {\n        return true;\n      });\n    }\n\n    this._refreshGroups(data);\n\n    return selectableTargets;\n  };\n  /**\n   * External click or mouse events can be applied to the selecto.\n   * @params - Extenal click or mouse event\n   * @params - Specify the clicked target directly.\n   */\n\n\n  __proto.clickTarget = function (e, clickedTarget) {\n    var _a = getClient(e),\n        clientX = _a.clientX,\n        clientY = _a.clientY;\n\n    var dragEvent = {\n      data: {\n        selectFlag: false\n      },\n      clientX: clientX,\n      clientY: clientY,\n      inputEvent: e,\n      isClick: true,\n      isTrusted: false,\n      stop: function () {\n        return false;\n      }\n    };\n\n    if (this._onDragStart(dragEvent, clickedTarget)) {\n      this._onDragEnd(dragEvent);\n    }\n\n    return this;\n  };\n\n  __proto.setKeyController = function () {\n    var _a = this.options,\n        keyContainer = _a.keyContainer,\n        toggleContinueSelect = _a.toggleContinueSelect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (this.keycon) {\n      this.keycon.destroy();\n      this.keycon = null;\n    }\n\n    if (toggleContinueSelect || toggleContinueSelectWithoutDeselect) {\n      this.keycon = new KeyController(keyContainer || getWindow(this.container));\n      this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on(\"blur\", this._onBlur);\n    }\n  };\n\n  __proto.setClassName = function (nextClassName) {\n    this.options.className = nextClassName;\n    this.target.setAttribute(\"class\", \"\".concat(CLASS_NAME, \" \").concat(nextClassName || \"\"));\n  };\n\n  __proto.setKeyEvent = function () {\n    var _a = this.options,\n        toggleContinueSelect = _a.toggleContinueSelect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (!toggleContinueSelect && !toggleContinueSelectWithoutDeselect || this.keycon) {\n      return;\n    }\n\n    this.setKeyController();\n  }; // with getter, setter property\n\n\n  __proto.setKeyContainer = function (keyContainer) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.keyContainer, keyContainer, function () {\n      options.keyContainer = keyContainer;\n\n      _this.setKeyController();\n    });\n  };\n\n  __proto.getContinueSelect = function () {\n    var _a = this.options,\n        continueSelect = _a.continueSelect,\n        toggleContinueSelect = _a.toggleContinueSelect;\n\n    if (!toggleContinueSelect || !this._keydownContinueSelect) {\n      return continueSelect;\n    }\n\n    return !continueSelect;\n  };\n\n  __proto.getContinueSelectWithoutDeselect = function () {\n    var _a = this.options,\n        continueSelectWithoutDeselect = _a.continueSelectWithoutDeselect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (!toggleContinueSelectWithoutDeselect || !this._keydownContinueSelectWithoutDeselection) {\n      return continueSelectWithoutDeselect;\n    }\n\n    return !continueSelectWithoutDeselect;\n  };\n\n  __proto.setToggleContinueSelect = function (toggleContinueSelect) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.toggleContinueSelect, toggleContinueSelect, function () {\n      options.toggleContinueSelect = toggleContinueSelect;\n\n      _this.setKeyEvent();\n    });\n  };\n\n  __proto.setToggleContinueSelectWithoutDeselect = function (toggleContinueSelectWithoutDeselect) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.toggleContinueSelectWithoutDeselect, toggleContinueSelectWithoutDeselect, function () {\n      options.toggleContinueSelectWithoutDeselect = toggleContinueSelectWithoutDeselect;\n\n      _this.setKeyEvent();\n    });\n  };\n\n  __proto.setPreventDefault = function (value) {\n    this.gesto.options.preventDefault = value;\n  };\n\n  __proto.setCheckInput = function (value) {\n    this.gesto.options.checkInput = value;\n  };\n\n  __proto.initElement = function () {\n    var _a = this.options,\n        dragContainer = _a.dragContainer,\n        checkInput = _a.checkInput,\n        preventDefault = _a.preventDefault,\n        preventClickEventOnDragStart = _a.preventClickEventOnDragStart,\n        preventClickEventOnDrag = _a.preventClickEventOnDrag,\n        preventClickEventByCondition = _a.preventClickEventByCondition,\n        _b = _a.preventRightClick,\n        preventRightClick = _b === void 0 ? true : _b,\n        className = _a.className;\n    var container = this.container;\n    this.target = createElement(h(\"div\", {\n      className: \"\".concat(CLASS_NAME, \" \").concat(className || \"\")\n    }), this.target, container);\n    var target = this.target;\n    this.dragContainer = typeof dragContainer === \"string\" ? [].slice.call(getDocument(container).querySelectorAll(dragContainer)) : dragContainer || this.target.parentNode;\n    this.gesto = new Gesto(this.dragContainer, {\n      checkWindowBlur: true,\n      container: getWindow(container),\n      checkInput: checkInput,\n      preventDefault: preventDefault,\n      preventClickEventOnDragStart: preventClickEventOnDragStart,\n      preventClickEventOnDrag: preventClickEventOnDrag,\n      preventClickEventByCondition: preventClickEventByCondition,\n      preventRightClick: preventRightClick\n    }).on({\n      dragStart: this._onDragStart,\n      drag: this._onDrag,\n      dragEnd: this._onDragEnd\n    });\n    addEvent(document, \"selectstart\", this._onDocumentSelectStart);\n    this.injectResult = injector.inject(target, {\n      nonce: this.options.cspNonce\n    });\n  };\n\n  __proto.hitTest = function (selectRect, data, isDrag, gestoEvent) {\n    var _a = this.options,\n        hitRate = _a.hitRate,\n        selectByClick = _a.selectByClick;\n    var left = selectRect.left,\n        top = selectRect.top,\n        right = selectRect.right,\n        bottom = selectRect.bottom;\n    var innerGroups = data.innerGroups;\n    var innerWidth = data.innerWidth;\n    var innerHeight = data.innerHeight;\n    var clientX = gestoEvent === null || gestoEvent === void 0 ? void 0 : gestoEvent.clientX;\n    var clientY = gestoEvent === null || gestoEvent === void 0 ? void 0 : gestoEvent.clientY;\n    var ignoreClick = data.ignoreClick;\n    var rectPoints = [[left, top], [right, top], [right, bottom], [left, bottom]];\n\n    var isHit = function (points, el) {\n      var hitRateValue = typeof hitRate === \"function\" ? splitUnit(\"\".concat(hitRate(el))) : splitUnit(\"\".concat(hitRate));\n      var inArea = ignoreClick ? false : isInside([clientX, clientY], points);\n\n      if (!isDrag && selectByClick && inArea) {\n        return true;\n      }\n\n      var overlapPoints = getOverlapPoints(rectPoints, points);\n\n      if (!overlapPoints.length) {\n        return false;\n      }\n\n      var overlapSize = getAreaSize(overlapPoints); // Line\n\n      var targetSize = 0;\n\n      if (overlapSize === 0 && getAreaSize(points) === 0) {\n        targetSize = getLineSize(points);\n        overlapSize = getLineSize(overlapPoints);\n      } else {\n        targetSize = getAreaSize(points);\n      }\n\n      if (hitRateValue.unit === \"px\") {\n        return overlapSize >= hitRateValue.value;\n      } else {\n        var rate = between(Math.round(overlapSize / targetSize * 100), 0, 100);\n        return rate >= Math.min(100, hitRateValue.value);\n      }\n    };\n\n    var selectableTargets = data.selectableTargets;\n    var selectablePoints = data.selectablePoints;\n    var selectableInners = data.selectableInners;\n\n    if (!innerGroups) {\n      return selectableTargets.filter(function (_, i) {\n        if (!selectableInners[i]) {\n          return false;\n        }\n\n        return isHit(selectablePoints[i], selectableTargets[i]);\n      });\n    }\n\n    var selectedTargets = [];\n    var minX = Math.floor(left / innerWidth);\n    var maxX = Math.floor(right / innerWidth);\n    var minY = Math.floor(top / innerHeight);\n    var maxY = Math.floor(bottom / innerHeight);\n\n    for (var x = minX; x <= maxX; ++x) {\n      var yGroups = innerGroups[x];\n\n      if (!yGroups) {\n        continue;\n      }\n\n      for (var y = minY; y <= maxY; ++y) {\n        var group = yGroups[y];\n\n        if (!group) {\n          continue;\n        }\n\n        group.forEach(function (index) {\n          var points = selectablePoints[index];\n          var inner = selectableInners[index];\n          var target = selectableTargets[index];\n\n          if (inner && isHit(points, target)) {\n            selectedTargets.push(target);\n          }\n        });\n      }\n    }\n\n    return filterDuplicated(selectedTargets);\n  };\n\n  __proto.initDragScroll = function () {\n    var _this = this;\n\n    this.dragScroll.on(\"scrollDrag\", function (_a) {\n      var next = _a.next;\n      next(_this.gesto.getCurrentEvent());\n    }).on(\"scroll\", function (_a) {\n      var container = _a.container,\n          direction = _a.direction;\n\n      var innerScrollOptions = _this.gesto.getEventData().innerScrollOptions;\n\n      if (innerScrollOptions) {\n        _this.emit(\"innerScroll\", {\n          container: container,\n          direction: direction\n        });\n      } else {\n        _this.emit(\"scroll\", {\n          container: container,\n          direction: direction\n        });\n      }\n    }).on(\"move\", function (_a) {\n      var offsetX = _a.offsetX,\n          offsetY = _a.offsetY,\n          inputEvent = _a.inputEvent;\n      var gesto = _this.gesto;\n\n      if (!gesto || !gesto.isFlag()) {\n        return;\n      }\n\n      var data = _this.gesto.getEventData();\n\n      var boundArea = data.boundArea;\n      data.startX -= offsetX;\n      data.startY -= offsetY;\n\n      var innerScrollOptions = _this.gesto.getEventData().innerScrollOptions;\n\n      var container = innerScrollOptions === null || innerScrollOptions === void 0 ? void 0 : innerScrollOptions.container;\n      var isMoveInnerScroll = false;\n\n      if (container) {\n        var parentMap_2 = data.selectableInnerScrollParentMap;\n        var parentInfo = parentMap_2.get(container);\n\n        if (parentInfo) {\n          parentInfo.paths.forEach(function (scrollContainer) {\n            var containerInfo = parentMap_2.get(scrollContainer);\n            containerInfo.points.forEach(function (pos) {\n              pos[0] -= offsetX;\n              pos[1] -= offsetY;\n            });\n          });\n          parentInfo.indexes.forEach(function (index) {\n            data.selectablePoints[index].forEach(function (pos) {\n              pos[0] -= offsetX;\n              pos[1] -= offsetY;\n            });\n          });\n          isMoveInnerScroll = true;\n        }\n      }\n\n      if (!isMoveInnerScroll) {\n        data.selectablePoints.forEach(function (points) {\n          points.forEach(function (pos) {\n            pos[0] -= offsetX;\n            pos[1] -= offsetY;\n          });\n        });\n      }\n\n      _this._refreshGroups(data);\n\n      boundArea.left -= offsetX;\n      boundArea.right -= offsetX;\n      boundArea.top -= offsetY;\n      boundArea.bottom -= offsetY;\n\n      _this.gesto.scrollBy(offsetX, offsetY, inputEvent.inputEvent);\n\n      _this._checkSelected(_this.gesto.getCurrentEvent());\n    });\n  };\n\n  __proto._select = function (selectedTargets, rect, e, isStart, isDragStartEnd) {\n    if (isDragStartEnd === void 0) {\n      isDragStartEnd = false;\n    }\n\n    var inputEvent = e.inputEvent;\n    var data = e.data;\n    var result = this.setSelectedTargets(selectedTargets);\n\n    var _a = diff(data.startSelectedTargets, selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    var startResult = {\n      startSelected: prevList,\n      startAdded: added.map(function (i) {\n        return list[i];\n      }),\n      startRemoved: removed.map(function (i) {\n        return prevList[i];\n      })\n    };\n\n    if (isStart) {\n      /**\n       * When the select(drag) starts, the selectStart event is called.\n       * @memberof Selecto\n       * @event selectStart\n       * @param {Selecto.OnSelect} - Parameters for the selectStart event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"selectStart\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * }).on(\"selectEnd\", e => {\n       *   e.afterAdded.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.afterRemoved.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n      this.emit(\"selectStart\", __assign(__assign(__assign({}, result), startResult), {\n        rect: rect,\n        inputEvent: inputEvent,\n        data: data.data,\n        isTrusted: e.isTrusted,\n        isDragStartEnd: isDragStartEnd\n      }));\n    }\n\n    if (result.added.length || result.removed.length) {\n      /**\n       * When the select in real time, the select event is called.\n       * @memberof Selecto\n       * @event select\n       * @param {Selecto.OnSelect} - Parameters for the select event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n      this.emit(\"select\", __assign(__assign(__assign({}, result), startResult), {\n        rect: rect,\n        inputEvent: inputEvent,\n        data: data.data,\n        isTrusted: e.isTrusted,\n        isDragStartEnd: isDragStartEnd\n      }));\n    }\n  };\n\n  __proto._selectEnd = function (startSelectedTargets, startPassedTargets, rect, e, isDragStartEnd) {\n    if (isDragStartEnd === void 0) {\n      isDragStartEnd = false;\n    }\n\n    var inputEvent = e.inputEvent,\n        isDouble = e.isDouble,\n        data = e.data;\n    var type = inputEvent && inputEvent.type;\n    var isDragStart = type === \"mousedown\" || type === \"touchstart\";\n\n    var _a = diff(startSelectedTargets, this.selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    var _b = diff(startPassedTargets, this.selectedTargets),\n        afterAdded = _b.added,\n        afterRemoved = _b.removed,\n        afterPrevList = _b.prevList,\n        afterList = _b.list;\n    /**\n     * When the select(dragEnd or click) ends, the selectEnd event is called.\n     * @memberof Selecto\n     * @event selectEnd\n     * @param {Selecto.OnSelectEnd} - Parameters for the selectEnd event\n     * @example\n     * import Selecto from \"selecto\";\n     *\n     * const selecto = new Selecto({\n     *   container: document.body,\n     *   selectByClick: true,\n     *   selectFromInside: false,\n     * });\n     *\n     * selecto.on(\"selectStart\", e => {\n     *   e.added.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.removed.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * }).on(\"selectEnd\", e => {\n     *   e.afterAdded.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.afterRemoved.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * });\n     */\n\n\n    this.emit(\"selectEnd\", {\n      startSelected: startSelectedTargets,\n      beforeSelected: startPassedTargets,\n      selected: this.selectedTargets,\n      added: added.map(function (index) {\n        return list[index];\n      }),\n      removed: removed.map(function (index) {\n        return prevList[index];\n      }),\n      afterAdded: afterAdded.map(function (index) {\n        return afterList[index];\n      }),\n      afterRemoved: afterRemoved.map(function (index) {\n        return afterPrevList[index];\n      }),\n      isDragStart: isDragStart && isDragStartEnd,\n      isDragStartEnd: isDragStart && isDragStartEnd,\n      isClick: !!e.isClick,\n      isDouble: !!isDouble,\n      rect: rect,\n      inputEvent: inputEvent,\n      data: data.data,\n      isTrusted: e.isTrusted\n    });\n  };\n\n  __proto._checkSelected = function (e, rect) {\n    if (rect === void 0) {\n      rect = getRect(e, this.options.ratio);\n    }\n\n    var data = e.data;\n    var top = rect.top,\n        left = rect.left,\n        width = rect.width,\n        height = rect.height;\n    var selectFlag = data.selectFlag;\n    var containerX = data.containerX,\n        containerY = data.containerY,\n        scaleMatrix = data.scaleMatrix;\n    var offsetPos = calculateMatrixDist(scaleMatrix, [left - containerX, top - containerY]);\n    var offsetSize = calculateMatrixDist(scaleMatrix, [width, height]);\n    var selectedTargets = [];\n\n    if (selectFlag) {\n      this.target.style.cssText += \"display: block;\" + \"left:0px;top:0px;\" + \"transform: translate(\".concat(offsetPos[0], \"px, \").concat(offsetPos[1], \"px);\") + \"width:\".concat(offsetSize[0], \"px;height:\").concat(offsetSize[1], \"px;\");\n      var passedTargets = this.hitTest(rect, data, true, e);\n      selectedTargets = passTargets(data.startPassedTargets, passedTargets, this.continueSelect && this.continueSelectWithoutDeselect);\n    }\n    /**\n     * When the drag, the drag event is called.\n     * Call the stop () function if you have a specific element or don't want to raise a select\n     * @memberof Selecto\n     * @event drag\n     * @param {OnDrag} - Parameters for the drag event\n     * @example\n     * import Selecto from \"selecto\";\n     *\n     * const selecto = new Selecto({\n     *   container: document.body,\n     *   selectByClick: true,\n     *   selectFromInside: false,\n     * });\n     *\n     * selecto.on(\"drag\", e => {\n     *   e.stop();\n     * }).on(\"select\", e => {\n     *   e.added.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.removed.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * });\n     */\n\n\n    var result = this.emit(\"drag\", __assign(__assign({}, e), {\n      data: data.data,\n      isSelect: selectFlag,\n      rect: rect\n    }));\n\n    if (result === false) {\n      this.target.style.cssText += \"display: none;\";\n      e.stop();\n      return;\n    }\n\n    if (selectFlag) {\n      this._select(selectedTargets, rect, e);\n    }\n  };\n\n  __proto._sameCombiKey = function (e, keys, isKeyup) {\n    if (!keys) {\n      return false;\n    }\n\n    var combi = getCombi(e.inputEvent, e.key);\n    var nextKeys = [].concat(keys);\n    var toggleKeys = isArray(nextKeys[0]) ? nextKeys : [nextKeys];\n\n    if (isKeyup) {\n      var singleKey_1 = e.key;\n      return toggleKeys.some(function (keys) {\n        return keys.some(function (key) {\n          return key === singleKey_1;\n        });\n      });\n    }\n\n    return toggleKeys.some(function (keys) {\n      return keys.every(function (key) {\n        return combi.indexOf(key) > -1;\n      });\n    });\n  };\n\n  __proto._findElement = function (clickedTarget, selectableTargets) {\n    var pointTarget = clickedTarget;\n\n    while (pointTarget) {\n      if (selectableTargets.indexOf(pointTarget) > -1) {\n        break;\n      }\n\n      pointTarget = pointTarget.parentElement;\n    }\n\n    return pointTarget;\n  };\n\n  __proto._refreshGroups = function (data) {\n    var _a;\n\n    var innerWidth = data.innerWidth;\n    var innerHeight = data.innerHeight;\n    var selectablePoints = data.selectablePoints;\n\n    if (this.options.checkOverflow) {\n      var innerScrollContainer_1 = (_a = this.gesto.getEventData().innerScrollOptions) === null || _a === void 0 ? void 0 : _a.container;\n      var parentMap_3 = data.selectableInnerScrollParentMap;\n      var innerScrollPathsList = data.selectableInnerScrollPathsList;\n      data.selectableInners = innerScrollPathsList.map(function (innerScrollPaths, i) {\n        var isAlwaysTrue = false;\n        return innerScrollPaths.every(function (target) {\n          if (isAlwaysTrue) {\n            return true;\n          }\n\n          if (target === innerScrollContainer_1) {\n            isAlwaysTrue = true;\n            return true;\n          }\n\n          var rect = parentMap_3.get(target);\n\n          if (rect) {\n            var points1 = selectablePoints[i];\n            var points2 = rect.points;\n            var overlapPoints = getOverlapPoints(points1, points2);\n\n            if (!overlapPoints.length) {\n              return false;\n            }\n          }\n\n          return true;\n        });\n      });\n    }\n\n    if (!innerWidth || !innerHeight) {\n      data.innerGroups = null;\n    } else {\n      var selectablePoints_1 = data.selectablePoints;\n      var groups_1 = {};\n      selectablePoints_1.forEach(function (points, i) {\n        var minX = Infinity;\n        var maxX = -Infinity;\n        var minY = Infinity;\n        var maxY = -Infinity;\n        points.forEach(function (pos) {\n          var x = Math.floor(pos[0] / innerWidth);\n          var y = Math.floor(pos[1] / innerHeight);\n          minX = Math.min(x, minX);\n          maxX = Math.max(x, maxX);\n          minY = Math.min(y, minY);\n          maxY = Math.max(y, maxY);\n        });\n\n        for (var x = minX; x <= maxX; ++x) {\n          for (var y = minY; y <= maxY; ++y) {\n            groups_1[x] = groups_1[x] || {};\n            groups_1[x][y] = groups_1[x][y] || [];\n            groups_1[x][y].push(i);\n          }\n        }\n      });\n      data.innerGroups = groups_1;\n    }\n  };\n\n  Selecto = __decorate([Properties(PROPERTIES, function (prototype, property) {\n    var attributes = {\n      enumerable: true,\n      configurable: true,\n      get: function () {\n        return this.options[property];\n      }\n    };\n    var getter = camelize(\"get \".concat(property));\n\n    if (prototype[getter]) {\n      attributes.get = function () {\n        return this[getter]();\n      };\n    } else {\n      attributes.get = function () {\n        return this.options[property];\n      };\n    }\n\n    var setter = camelize(\"set \".concat(property));\n\n    if (prototype[setter]) {\n      attributes.set = function (value) {\n        this[setter](value);\n      };\n    } else {\n      attributes.set = function (value) {\n        this.options[property] = value;\n      };\n    }\n\n    Object.defineProperty(prototype, property, attributes);\n  })], Selecto);\n  return Selecto;\n}(EventEmitter);\n\nvar Selecto$1 =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Selecto, _super);\n\n  function Selecto() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Selecto;\n}(Selecto);\n\nexport default Selecto$1;\nexport { CLASS_NAME, EVENTS, METHODS, OPTIONS, OPTION_TYPES, PROPERTIES };\n//# sourceMappingURL=selecto.esm.js.map\n","import { css } from '@emotion/css';\nimport { useRef } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\nimport { ConnectionCoordinates } from 'app/features/canvas/element';\n\ntype Props = {\n  setRef: (anchorElement: HTMLDivElement) => void;\n  setAnchorsRef: (anchorsElement: HTMLDivElement) => void;\n  handleMouseLeave: (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => boolean;\n};\n\nexport const CONNECTION_ANCHOR_DIV_ID = 'connectionControl';\nexport const CONNECTION_ANCHOR_ALT = 'connection anchor';\nexport const CONNECTION_ANCHOR_HIGHLIGHT_OFFSET = 8;\n// Unit is percentage from the middle of the element\n// 0, 0 middle; -1, -1 bottom left; 1, 1 top right\nexport const ANCHORS = [\n  { x: -1, y: 1 },\n  { x: -0.5, y: 1 },\n  { x: 0, y: 1 },\n  { x: 0.5, y: 1 },\n  { x: 1, y: 1 },\n  { x: 1, y: 0.5 },\n  { x: 1, y: 0 },\n  { x: 1, y: -0.5 },\n  { x: 1, y: -1 },\n  { x: 0.5, y: -1 },\n  { x: 0, y: -1 },\n  { x: -0.5, y: -1 },\n  { x: -1, y: -1 },\n  { x: -1, y: -0.5 },\n  { x: -1, y: 0 },\n  { x: -1, y: 0.5 },\n];\n\nexport const ANCHOR_PADDING = 3;\nexport const HALF_SIZE = 2.5;\n\nexport const ConnectionAnchors = ({ setRef, setAnchorsRef, handleMouseLeave }: Props) => {\n  const highlightEllipseRef = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const halfSizeHighlightEllipse = 5.5;\n  const anchorImage =\n    'data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1cHgiIGhlaWdodD0iNXB4IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2Utd2lkdGg9IjIiIHN0eWxlPSJzdHJva2Utb3BhY2l0eTowLjQiIHN0cm9rZT0iI2ZmZmZmZiIvPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2U9IiMyOWI2ZjIiLz48L3N2Zz4=';\n\n  const onMouseEnterAnchor = (event: React.MouseEvent) => {\n    if (!(event.target instanceof HTMLImageElement)) {\n      return;\n    }\n\n    if (highlightEllipseRef.current && event.target.style) {\n      highlightEllipseRef.current.style.display = 'block';\n      highlightEllipseRef.current.style.top = `calc(${event.target.style.top} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n      highlightEllipseRef.current.style.left = `calc(${event.target.style.left} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n    }\n  };\n\n  const onMouseLeaveHighlightElement = () => {\n    if (highlightEllipseRef.current) {\n      highlightEllipseRef.current.style.display = 'none';\n    }\n  };\n\n  const handleMouseLeaveAnchors = (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => {\n    const didHideAnchors = handleMouseLeave(event);\n\n    if (didHideAnchors) {\n      onMouseLeaveHighlightElement();\n    }\n  };\n\n  const generateAnchors = (anchors: ConnectionCoordinates[] = ANCHORS) => {\n    return anchors.map((anchor) => {\n      const id = `${anchor.x},${anchor.y}`;\n\n      // Convert anchor coords to relative percentage\n      const style = {\n        top: `calc(${-anchor.y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n        left: `calc(${anchor.x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n      };\n\n      return (\n        <img\n          id={id}\n          ref={(element) => {\n            if (element) {\n              // After React 15+, inline styles no longer support !important\n              element.style.setProperty('pointer-events', 'auto', 'important');\n            }\n          }}\n          key={id}\n          alt={CONNECTION_ANCHOR_ALT}\n          className={styles.anchor}\n          style={style}\n          src={anchorImage}\n          onMouseEnter={onMouseEnterAnchor}\n        />\n      );\n    });\n  };\n\n  return (\n    <div className={styles.root} ref={setRef}>\n      <div className={styles.mouseoutDiv} onMouseOut={handleMouseLeaveAnchors} onBlur={handleMouseLeaveAnchors} />\n      <div\n        id={CONNECTION_ANCHOR_DIV_ID}\n        ref={highlightEllipseRef}\n        className={styles.highlightElement}\n        onMouseLeave={onMouseLeaveHighlightElement}\n      />\n      <div ref={setAnchorsRef}>{generateAnchors()}</div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  root: css({\n    position: 'absolute',\n    display: 'none',\n  }),\n  mouseoutDiv: css({\n    position: 'absolute',\n    margin: '-30px',\n    width: 'calc(100% + 60px)',\n    height: 'calc(100% + 60px)',\n  }),\n  anchor: css({\n    padding: `${ANCHOR_PADDING}px`,\n    position: 'absolute',\n    cursor: 'cursor',\n    width: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    height: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    zIndex: 100,\n  }),\n  highlightElement: css({\n    backgroundColor: '#00ff00',\n    opacity: 0.3,\n    position: 'absolute',\n    cursor: 'cursor',\n    pointerEvents: 'auto',\n    width: '16px',\n    height: '16px',\n    borderRadius: theme.shape.radius.circle,\n    display: 'none',\n    zIndex: 110,\n  }),\n});\n","import { first } from 'rxjs/operators';\n\nimport { Placement } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { LayerActionID } from 'app/plugins/panel/canvas/types';\n\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\n\n// TODO: Consider whether or not reorderElements + updateElements should be moved to TreeNavigationEditor\n// Reorder elements in the DOM when rearranging them in the tree navigation editor\nexport const reorderElements = (src: ElementState, dest: ElementState, dragToGap: boolean, destPosition: number) => {\n  switch (dragToGap) {\n    case true:\n      switch (destPosition) {\n        case -1:\n          // top of the tree\n          if (src.parent instanceof FrameState) {\n            // move outside the frame\n            if (dest.parent) {\n              updateElements(src, dest.parent, dest.parent.elements.length);\n              src.updateData(dest.parent.scene.context);\n            }\n          } else {\n            dest.parent?.reorderTree(src, dest, true);\n          }\n          break;\n        default:\n          if (dest.parent) {\n            updateElements(src, dest.parent, dest.parent.elements.indexOf(dest));\n            src.updateData(dest.parent.scene.context);\n          }\n          break;\n      }\n      break;\n    case false:\n      if (dest instanceof FrameState) {\n        if (src.parent === dest) {\n          // same frame parent\n          src.parent?.reorderTree(src, dest, true);\n        } else {\n          updateElements(src, dest);\n          src.updateData(dest.scene.context);\n        }\n      } else if (src.parent === dest.parent) {\n        src.parent?.reorderTree(src, dest);\n      } else {\n        if (dest.parent) {\n          updateElements(src, dest.parent);\n          src.updateData(dest.parent.scene.context);\n        }\n      }\n      break;\n  }\n};\n\n// Reorders canvas elements\nconst updateElements = (src: ElementState, dest: FrameState | RootElement, idx: number | null = null) => {\n  src.parent?.doAction(LayerActionID.Delete, src);\n  src.parent = dest;\n\n  const elementContainer = src.div?.getBoundingClientRect();\n  src.setPlacementFromConstraint(elementContainer, dest.div?.getBoundingClientRect());\n\n  const destIndex = idx ?? dest.elements.length - 1;\n  dest.elements.splice(destIndex, 0, src);\n  dest.scene.save();\n\n  dest.reinitializeMoveable();\n};\n\n// Finds the element state if it exists for a given DOM element\nexport const findElementByTarget = (target: Element, sceneElements: ElementState[]): ElementState | undefined => {\n  // We will probably want to add memoization to this as we are calling on drag / resize\n\n  const stack = [...sceneElements];\n  while (stack.length > 0) {\n    const currentElement = stack.shift();\n\n    if (currentElement && currentElement.div && currentElement.div === target) {\n      return currentElement;\n    }\n\n    const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n    for (const nestedElement of nestedElements) {\n      stack.unshift(nestedElement);\n    }\n  }\n\n  return undefined;\n};\n\n// Nest selected elements into a frame object\nexport const frameSelection = (scene: Scene) => {\n  scene.selection.pipe(first()).subscribe((currentSelectedElements) => {\n    const currentLayer = currentSelectedElements[0].parent!;\n\n    const newLayer = new FrameState(\n      {\n        type: 'frame',\n        name: scene.getNextElementName(true),\n        elements: [],\n      },\n      scene,\n      currentSelectedElements[0].parent\n    );\n\n    const framePlacement = generateFrameContainer(currentSelectedElements);\n\n    newLayer.options.placement = framePlacement;\n\n    currentSelectedElements.forEach((element: ElementState) => {\n      const elementContainer = element.div?.getBoundingClientRect();\n\n      // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n      element.setPlacementFromConstraint(elementContainer, framePlacement as DOMRect);\n      currentLayer.doAction(LayerActionID.Delete, element);\n      newLayer.doAction(LayerActionID.Duplicate, element, false, false);\n    });\n\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    newLayer.setPlacementFromConstraint(framePlacement as DOMRect, currentLayer.div?.getBoundingClientRect());\n\n    currentLayer.elements.push(newLayer);\n\n    scene.byName.set(newLayer.getName(), newLayer);\n\n    scene.save();\n  });\n};\n\n// Helper function to generate the a frame object based on the selected elements' dimensions\nconst generateFrameContainer = (elements: ElementState[]): Placement => {\n  let minTop = Infinity;\n  let minLeft = Infinity;\n  let maxRight = 0;\n  let maxBottom = 0;\n\n  elements.forEach((element: ElementState) => {\n    const elementContainer = element.div?.getBoundingClientRect();\n\n    if (!elementContainer) {\n      return;\n    }\n\n    if (minTop > elementContainer.top) {\n      minTop = elementContainer.top;\n    }\n\n    if (minLeft > elementContainer.left) {\n      minLeft = elementContainer.left;\n    }\n\n    if (maxRight < elementContainer.right) {\n      maxRight = elementContainer.right;\n    }\n\n    if (maxBottom < elementContainer.bottom) {\n      maxBottom = elementContainer.bottom;\n    }\n  });\n\n  return {\n    top: minTop,\n    left: minLeft,\n    width: maxRight - minLeft,\n    height: maxBottom - minTop,\n  };\n};\n","import { css } from '@emotion/css';\nimport { useEffect, useMemo, useRef, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { DirectionDimensionConfig, DirectionDimensionMode, ConnectionDirection } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { ConnectionCoordinates } from '../../panelcfg.gen';\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates,\n  calculateDistance,\n  calculateMidpoint,\n  getConnectionStyles,\n  getParentBoundingClientRect,\n} from '../../utils';\n\nimport { CONNECTION_VERTEX_ADD_ID, CONNECTION_VERTEX_ID } from './Connections';\n\ntype Props = {\n  setSVGRef: (anchorElement: SVGSVGElement) => void;\n  setLineRef: (anchorElement: SVGLineElement) => void;\n  setSVGVertexRef: (anchorElement: SVGSVGElement) => void;\n  setVertexPathRef: (anchorElement: SVGPathElement) => void;\n  setVertexRef: (anchorElement: SVGCircleElement) => void;\n  scene: Scene;\n};\n\nlet idCounter = 0;\nconst htmlElementTypes = ['input', 'textarea'];\n\nexport const ConnectionSVG = ({\n  setSVGRef,\n  setLineRef,\n  setSVGVertexRef,\n  setVertexPathRef,\n  setVertexRef,\n  scene,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const headId = Date.now() + '_' + idCounter++;\n  const CONNECTION_LINE_ID = useMemo(() => `connectionLineId-${headId}`, [headId]);\n  const EDITOR_HEAD_ID = useMemo(() => `editorHead-${headId}`, [headId]);\n  const defaultArrowColor = config.theme2.colors.text.primary;\n  const defaultArrowSize = 2;\n  const defaultArrowDirection: DirectionDimensionConfig = {\n    mode: DirectionDimensionMode.Fixed,\n    fixed: ConnectionDirection.Forward,\n  };\n  const maximumVertices = 10;\n\n  const [selectedConnection, setSelectedConnection] = useState<ConnectionState | undefined>(undefined);\n\n  // Need to use ref to ensure state is not stale in event handler\n  const selectedConnectionRef = useRef(selectedConnection);\n  useEffect(() => {\n    selectedConnectionRef.current = selectedConnection;\n  });\n\n  useEffect(() => {\n    if (scene.panel.context.instanceState?.selectedConnection) {\n      setSelectedConnection(scene.panel.context.instanceState?.selectedConnection);\n    }\n  }, [scene.panel.context.instanceState?.selectedConnection]);\n\n  const onKeyUp = (e: KeyboardEvent) => {\n    const target = e.target;\n\n    if (!(target instanceof HTMLElement)) {\n      return;\n    }\n\n    if (htmlElementTypes.indexOf(target.nodeName.toLowerCase()) > -1) {\n      return;\n    }\n\n    // Backspace (8) or delete (46)\n    if (e.keyCode === 8 || e.keyCode === 46) {\n      if (selectedConnectionRef.current && selectedConnectionRef.current.source) {\n        selectedConnectionRef.current.source.options.connections =\n          selectedConnectionRef.current.source.options.connections?.filter(\n            (connection) => connection !== selectedConnectionRef.current?.info\n          );\n        selectedConnectionRef.current.source.onChange(selectedConnectionRef.current.source.options);\n\n        setSelectedConnection(undefined);\n        scene.connections.select(undefined);\n        scene.connections.updateState();\n        scene.save();\n      }\n    } else {\n      // Prevent removing event listener if key is not delete\n      return;\n    }\n\n    document.removeEventListener('keyup', onKeyUp);\n    scene.selecto!.rootContainer!.removeEventListener('click', clearSelectedConnection);\n  };\n\n  const clearSelectedConnection = (event: MouseEvent) => {\n    const eventTarget = event.target;\n\n    const shouldResetSelectedConnection = !(\n      eventTarget instanceof SVGLineElement && eventTarget.id === CONNECTION_LINE_ID\n    );\n\n    if (shouldResetSelectedConnection) {\n      setSelectedConnection(undefined);\n      scene.connections.select(undefined);\n    }\n  };\n\n  const selectConnection = (connection: ConnectionState) => {\n    if (scene.isEditingEnabled) {\n      setSelectedConnection(connection);\n      scene.connections.select(connection);\n\n      document.addEventListener('keyup', onKeyUp);\n      scene.selecto!.rootContainer!.addEventListener('click', clearSelectedConnection);\n    }\n  };\n\n  // Figure out target and then target's relative coordinates drawing (if no target do parent)\n  const renderConnections = () => {\n    return (\n      scene.connections.state\n        // Render selected connection last, ensuring it is above other connections\n        .sort((_a, b) => (selectedConnection === b && scene.panel.context.instanceState.selectedConnection ? -1 : 0))\n        .map((v, idx) => {\n          const { source, target, info, vertices, index } = v;\n          const sourceRect = source.div?.getBoundingClientRect();\n          const parent = source.div?.parentElement;\n          const transformScale = scene.scale;\n          const parentRect = getParentBoundingClientRect(scene);\n\n          if (!sourceRect || !parent || !parentRect) {\n            return;\n          }\n\n          const { x1, y1, x2, y2 } = calculateCoordinates(sourceRect, parentRect, info, target, transformScale);\n\n          let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n          if (v.sourceOriginal && v.targetOriginal) {\n            xStart = v.sourceOriginal.x;\n            yStart = v.sourceOriginal.y;\n            xEnd = v.targetOriginal.x;\n            yEnd = v.targetOriginal.y;\n          } else if (source.options.connections) {\n            // If original source or target coordinates are not set for the current connection, set them\n            if (\n              !source.options.connections[index].sourceOriginal ||\n              !source.options.connections[index].targetOriginal\n            ) {\n              source.options.connections[index].sourceOriginal = { x: x1, y: y1 };\n              source.options.connections[index].targetOriginal = { x: x2, y: y2 };\n            }\n          }\n\n          const midpoint = calculateMidpoint(x1, y1, x2, y2);\n          const xDist = xEnd - xStart;\n          const yDist = yEnd - yStart;\n\n          const { strokeColor, strokeWidth, strokeRadius, arrowDirection, lineStyle, shouldAnimate } =\n            getConnectionStyles(\n              info,\n              scene,\n              defaultArrowSize,\n              defaultArrowDirection.fixed ?? ConnectionDirection.Forward\n            );\n\n          const isSelected = selectedConnection === v && scene.panel.context.instanceState.selectedConnection;\n\n          const connectionCursorStyle = scene.isEditingEnabled ? 'grab' : '';\n          const selectedStyles = { stroke: '#44aaff', strokeOpacity: 0.6, strokeWidth: strokeWidth + 5 };\n\n          const CONNECTION_HEAD_ID_START = `connectionHeadStart-${headId + Math.random()}`;\n          const CONNECTION_HEAD_ID_END = `connectionHeadEnd-${headId + Math.random()}`;\n\n          const radius = strokeRadius;\n          // Create vertex path and populate array of add vertex controls\n          const addVertices: ConnectionCoordinates[] = [];\n          let pathString = `M${x1} ${y1} `;\n          if (vertices?.length) {\n            vertices.map((vertex, index) => {\n              const x = vertex.x;\n              const y = vertex.y;\n\n              // Convert vertex relative coordinates to scene coordinates\n              const X = x * xDist + xStart;\n              const Y = y * yDist + yStart;\n\n              // Initialize coordinates for first arc control point\n              let xa = X;\n              let ya = Y;\n\n              // Initialize coordinates for second arc control point\n              let xb = X;\n              let yb = Y;\n\n              // Initialize half arc distance and segment angles\n              let lHalfArc = 0;\n              let angle1 = 0;\n              let angle2 = 0;\n\n              // Only calculate arcs if there is a radius\n              if (radius) {\n                if (index < vertices.length - 1) {\n                  const Xn = vertices[index + 1].x * xDist + xStart;\n                  const Yn = vertices[index + 1].y * yDist + yStart;\n                  if (index === 0) {\n                    // First vertex\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  } else {\n                    // All vertices\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  }\n                } else {\n                  // Last vertex\n                  if (index > 0) {\n                    // Not also the first vertex\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                  } else {\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                  }\n                  angle2 = calculateAngle(X, Y, x2, y2);\n                }\n\n                // Calculate angle between two segments where arc will be placed\n                const theta = angle2 - angle1; //radians\n                // Attempt to determine if arc is counter clockwise (ccw)\n                const ccw = theta < 0;\n                // Half arc is used for arc control points\n                lHalfArc = radius * Math.tan(theta / 2);\n                if (ccw) {\n                  lHalfArc *= -1;\n                }\n              }\n\n              if (index === 0) {\n                // For first vertex\n                addVertices.push(\n                  calculateMidpoint((x1 - xStart) / (xEnd - xStart), (y1 - yStart) / (yEnd - yStart), x, y)\n                );\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, x1, y1);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + x1);\n                  ya = Math.round(lDelta * Math.sin(angle1) + y1);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > x1) || (xa < X && xa < x1)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + x1;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + y1;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              } else {\n                // For all other vertices\n                const previousVertex = vertices[index - 1];\n                addVertices.push(calculateMidpoint(previousVertex.x, previousVertex.y, x, y));\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Convert previous vertex relative coorindates to scene coordinates\n                  const Xp = previousVertex.x * xDist + xStart;\n                  const Yp = previousVertex.y * yDist + yStart;\n\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, Xp, Yp);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + Xp);\n                  ya = Math.round(lDelta * Math.sin(angle1) + Yp);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > Xp) || (xa < X && xa < Xp)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + Xp;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + Yp;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              }\n              if (index === vertices.length - 1) {\n                // For last vertex only\n                addVertices.push(\n                  calculateMidpoint((x2 - xStart) / (xEnd - xStart), (y2 - yStart) / (yEnd - yStart), x, y)\n                );\n              }\n              // Add segment to path\n              pathString += `L${xa} ${ya} `;\n\n              if (lHalfArc !== 0) {\n                // Add arc if applicable\n                pathString += `Q ${X} ${Y} ${xb} ${yb} `;\n              }\n            });\n            // Add last segment\n            pathString += `L${x2} ${y2}`;\n          }\n\n          const markerStart =\n            arrowDirection === ConnectionDirection.Reverse || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_START})`\n              : undefined;\n\n          const markerEnd =\n            arrowDirection === ConnectionDirection.Forward || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_END})`\n              : undefined;\n\n          const getAnimationDirection = () => {\n            let values = '100;0';\n\n            if (arrowDirection === ConnectionDirection.Reverse) {\n              values = '0;100';\n            }\n\n            return values;\n          };\n\n          return (\n            <svg className={styles.connection} key={idx}>\n              <g onClick={() => selectConnection(v)}>\n                <defs>\n                  <marker\n                    id={CONNECTION_HEAD_ID_START}\n                    markerWidth=\"10\"\n                    markerHeight=\"7\"\n                    refX=\"0\"\n                    refY=\"3.5\"\n                    orient=\"auto\"\n                    stroke={strokeColor}\n                  >\n                    <polygon points=\"10 0, 0 3.5, 10 7\" fill={strokeColor} />\n                  </marker>\n                  <marker\n                    id={CONNECTION_HEAD_ID_END}\n                    markerWidth=\"10\"\n                    markerHeight=\"7\"\n                    refX=\"10\"\n                    refY=\"3.5\"\n                    orient=\"auto\"\n                    stroke={strokeColor}\n                  >\n                    <polygon points=\"0 0, 10 3.5, 0 7\" fill={strokeColor} />\n                  </marker>\n                </defs>\n                {vertices?.length ? (\n                  <g>\n                    <path\n                      id={`${CONNECTION_LINE_ID}_transparent`}\n                      d={pathString}\n                      cursor={connectionCursorStyle}\n                      pointerEvents=\"auto\"\n                      stroke=\"transparent\"\n                      strokeWidth={15}\n                      fill={'none'}\n                      style={isSelected ? selectedStyles : {}}\n                    />\n                    <path\n                      d={pathString}\n                      stroke={strokeColor}\n                      strokeWidth={strokeWidth}\n                      strokeDasharray={lineStyle}\n                      strokeDashoffset={1}\n                      fill={'none'}\n                      markerEnd={markerEnd}\n                      markerStart={markerStart}\n                    >\n                      {shouldAnimate && (\n                        <animate\n                          attributeName=\"stroke-dashoffset\"\n                          values={getAnimationDirection()}\n                          dur=\"5s\"\n                          calcMode=\"linear\"\n                          repeatCount=\"indefinite\"\n                          fill={'freeze'}\n                        />\n                      )}\n                    </path>\n                    {isSelected && (\n                      <g>\n                        {vertices.map((value, index) => {\n                          return (\n                            <circle\n                              id={CONNECTION_VERTEX_ID}\n                              data-index={index}\n                              key={`${CONNECTION_VERTEX_ID}${index}_${idx}`}\n                              cx={value.x * xDist + xStart}\n                              cy={value.y * yDist + yStart}\n                              r={5}\n                              stroke={strokeColor}\n                              className={styles.vertex}\n                              cursor={'crosshair'}\n                              pointerEvents=\"auto\"\n                            />\n                          );\n                        })}\n                        {vertices.length < maximumVertices &&\n                          addVertices.map((value, index) => {\n                            return (\n                              <circle\n                                id={CONNECTION_VERTEX_ADD_ID}\n                                data-index={index}\n                                key={`${CONNECTION_VERTEX_ADD_ID}${index}_${idx}`}\n                                cx={value.x * xDist + xStart}\n                                cy={value.y * yDist + yStart}\n                                r={4}\n                                stroke={strokeColor}\n                                className={styles.addVertex}\n                                cursor={'crosshair'}\n                                pointerEvents=\"auto\"\n                              />\n                            );\n                          })}\n                      </g>\n                    )}\n                  </g>\n                ) : (\n                  <g>\n                    <line\n                      id={`${CONNECTION_LINE_ID}_transparent`}\n                      cursor={connectionCursorStyle}\n                      pointerEvents=\"auto\"\n                      stroke=\"transparent\"\n                      strokeWidth={15}\n                      style={isSelected ? selectedStyles : {}}\n                      x1={x1}\n                      y1={y1}\n                      x2={x2}\n                      y2={y2}\n                    />\n                    <line\n                      id={CONNECTION_LINE_ID}\n                      stroke={strokeColor}\n                      pointerEvents=\"auto\"\n                      strokeWidth={strokeWidth}\n                      markerEnd={markerEnd}\n                      markerStart={markerStart}\n                      strokeDasharray={lineStyle}\n                      strokeDashoffset={1}\n                      x1={x1}\n                      y1={y1}\n                      x2={x2}\n                      y2={y2}\n                      cursor={connectionCursorStyle}\n                    >\n                      {shouldAnimate && (\n                        <animate\n                          attributeName=\"stroke-dashoffset\"\n                          values={getAnimationDirection()}\n                          dur=\"5s\"\n                          calcMode=\"linear\"\n                          repeatCount=\"indefinite\"\n                          fill={'freeze'}\n                        />\n                      )}\n                    </line>\n                    {isSelected && (\n                      <circle\n                        id={CONNECTION_VERTEX_ADD_ID}\n                        data-index={0}\n                        cx={midpoint.x}\n                        cy={midpoint.y}\n                        r={4}\n                        stroke={strokeColor}\n                        className={styles.addVertex}\n                        cursor={'crosshair'}\n                        pointerEvents=\"auto\"\n                      />\n                    )}\n                  </g>\n                )}\n              </g>\n            </svg>\n          );\n        })\n    );\n  };\n\n  return (\n    <>\n      <svg ref={setSVGRef} className={styles.editorSVG}>\n        <defs>\n          <marker\n            id={EDITOR_HEAD_ID}\n            markerWidth=\"10\"\n            markerHeight=\"7\"\n            refX=\"10\"\n            refY=\"3.5\"\n            orient=\"auto\"\n            stroke={defaultArrowColor}\n          >\n            <polygon points=\"0 0, 10 3.5, 0 7\" fill={defaultArrowColor} />\n          </marker>\n        </defs>\n        <line ref={setLineRef} stroke={defaultArrowColor} strokeWidth={2} markerEnd={`url(#${EDITOR_HEAD_ID})`} />\n      </svg>\n      <svg ref={setSVGVertexRef} className={styles.editorSVG}>\n        <path\n          ref={setVertexPathRef}\n          stroke={defaultArrowColor}\n          strokeWidth={2}\n          strokeDasharray={'5, 5'}\n          fill={'none'}\n        />\n        <circle ref={setVertexRef} stroke={defaultArrowColor} r={4} className={styles.vertex} />\n      </svg>\n      {renderConnections()}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  editorSVG: css({\n    position: 'absolute',\n    pointerEvents: 'none',\n    width: '100%',\n    height: '100%',\n    zIndex: 1000,\n    display: 'none',\n  }),\n  connection: css({\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    zIndex: 1000,\n    pointerEvents: 'none',\n  }),\n  vertex: css({\n    fill: '#44aaff',\n    strokeWidth: 2,\n  }),\n  addVertex: css({\n    fill: '#44aaff',\n    opacity: 0.5,\n    strokeWidth: 1,\n  }),\n});\n","import * as React from 'react';\nimport { BehaviorSubject } from 'rxjs';\n\nimport { config } from '@grafana/runtime';\nimport { CanvasConnection, ConnectionCoordinates, ConnectionPath } from 'app/features/canvas/element';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { findElementByTarget } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates,\n  getConnections,\n  getParentBoundingClientRect,\n  isConnectionSource,\n  isConnectionTarget,\n} from '../../utils';\n\nimport {\n  CONNECTION_ANCHOR_ALT,\n  ConnectionAnchors,\n  CONNECTION_ANCHOR_HIGHLIGHT_OFFSET,\n  ANCHORS,\n  ANCHOR_PADDING,\n  HALF_SIZE,\n} from './ConnectionAnchors';\nimport { ConnectionSVG } from './ConnectionSVG';\n\nexport const CONNECTION_VERTEX_ID = 'vertex';\nexport const CONNECTION_VERTEX_ADD_ID = 'vertexAdd';\nconst CONNECTION_VERTEX_ORTHO_TOLERANCE = 0.05; // Cartesian ratio against vertical or horizontal tolerance\nconst CONNECTION_VERTEX_SNAP_TOLERANCE = (5 / 180) * Math.PI; // Multi-segment snapping angle in radians to trigger vertex removal\n\nexport class Connections {\n  scene: Scene;\n  connectionAnchorDiv?: HTMLDivElement;\n  anchorsDiv?: HTMLDivElement;\n  connectionSVG?: SVGElement;\n  connectionLine?: SVGLineElement;\n  connectionSVGVertex?: SVGElement;\n  connectionVertexPath?: SVGPathElement;\n  connectionVertex?: SVGCircleElement;\n  connectionSource?: ElementState;\n  connectionTarget?: ElementState;\n  // for back compatibility with Connections2\n  connectionsSVG?: SVGElement;\n  isDrawingConnection?: boolean;\n  selectedVertexIndex?: number;\n  didConnectionLeaveHighlight?: boolean;\n  state: ConnectionState[] = [];\n  readonly selection = new BehaviorSubject<ConnectionState | undefined>(undefined);\n\n  constructor(scene: Scene) {\n    this.scene = scene;\n    this.updateState();\n  }\n\n  select = (connection: ConnectionState | undefined) => {\n    if (connection === this.selection.value) {\n      return;\n    }\n    this.selection.next(connection);\n  };\n\n  updateState = () => {\n    const s = this.selection.value;\n    this.state = getConnections(this.scene.byName);\n\n    if (s) {\n      for (let c of this.state) {\n        if (c.source === s.source && c.index === s.index) {\n          this.selection.next(c);\n          break;\n        }\n      }\n    }\n  };\n\n  setConnectionAnchorRef = (anchorElement: HTMLDivElement) => {\n    this.connectionAnchorDiv = anchorElement;\n  };\n\n  setAnchorsRef = (anchorsElement: HTMLDivElement) => {\n    this.anchorsDiv = anchorsElement;\n  };\n\n  setConnectionSVGRef = (connectionSVG: SVGSVGElement) => {\n    this.connectionSVG = connectionSVG;\n  };\n\n  setConnectionLineRef = (connectionLine: SVGLineElement) => {\n    this.connectionLine = connectionLine;\n  };\n\n  setConnectionSVGVertexRef = (connectionSVG: SVGSVGElement) => {\n    this.connectionSVGVertex = connectionSVG;\n  };\n\n  setConnectionVertexRef = (connectionVertex: SVGCircleElement) => {\n    this.connectionVertex = connectionVertex;\n  };\n\n  setConnectionVertexPathRef = (connectionVertexPath: SVGPathElement) => {\n    this.connectionVertexPath = connectionVertexPath;\n  };\n\n  // Recursively find the first parent that is a canvas element\n  findElementTarget = (element: Element): ElementState | undefined => {\n    let elementTarget = undefined;\n\n    // Cap recursion at the scene level\n    if (element === this.scene.div) {\n      return undefined;\n    }\n\n    elementTarget = findElementByTarget(element, this.scene.root.elements);\n\n    if (!elementTarget && element.parentElement) {\n      elementTarget = this.findElementTarget(element.parentElement);\n    }\n\n    return elementTarget;\n  };\n\n  handleMouseEnter = (event: React.MouseEvent) => {\n    if (!(event.target instanceof Element) || !this.scene.isEditingEnabled) {\n      return;\n    }\n\n    let element: ElementState | undefined = this.findElementTarget(event.target);\n\n    if (!element) {\n      console.log('no element');\n      return;\n    }\n\n    if (this.isDrawingConnection) {\n      this.connectionTarget = element;\n    } else {\n      this.connectionSource = element;\n      if (!this.connectionSource) {\n        console.log('no connection source');\n        return;\n      }\n    }\n\n    const customElementAnchors = element?.item.customConnectionAnchors || ANCHORS;\n    // This type cast is necessary as TS doesn't understand that `Element` is an `HTMLElement`\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const anchors = Array.from(this.anchorsDiv?.children as HTMLCollectionOf<HTMLElement>);\n    const anchorsAmount = customElementAnchors.length;\n\n    // re-calculate the position of the existing anchors on hover\n    // and hide the rest of the anchors if there are more than the custom ones\n    anchors.forEach((anchor, index) => {\n      if (index >= anchorsAmount) {\n        anchor.style.display = 'none';\n      } else {\n        const { x, y } = customElementAnchors[index];\n        anchor.style.top = `calc(${-y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.left = `calc(${x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.display = 'block';\n      }\n    });\n\n    const elementBoundingRect = element.div!.getBoundingClientRect();\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    const relativeTop = elementBoundingRect.top - (parentBoundingRect?.top ?? 0);\n    const relativeLeft = elementBoundingRect.left - (parentBoundingRect?.left ?? 0);\n\n    if (this.connectionAnchorDiv) {\n      this.connectionAnchorDiv.style.display = 'none';\n      this.connectionAnchorDiv.style.display = 'block';\n      this.connectionAnchorDiv.style.top = `${relativeTop / transformScale}px`;\n      this.connectionAnchorDiv.style.left = `${relativeLeft / transformScale}px`;\n      this.connectionAnchorDiv.style.height = `${elementBoundingRect.height / transformScale}px`;\n      this.connectionAnchorDiv.style.width = `${elementBoundingRect.width / transformScale}px`;\n    }\n  };\n\n  // Return boolean indicates if connection anchors were hidden or not\n  handleMouseLeave = (event: React.MouseEvent | React.FocusEvent): boolean => {\n    // If mouse is leaving INTO the anchor image, don't remove div\n    if (\n      event.relatedTarget instanceof HTMLImageElement &&\n      event.relatedTarget.getAttribute('alt') === CONNECTION_ANCHOR_ALT\n    ) {\n      return false;\n    }\n\n    this.connectionTarget = undefined;\n    this.connectionAnchorDiv!.style.display = 'none';\n    return true;\n  };\n\n  connectionListener = (event: MouseEvent) => {\n    event.preventDefault();\n\n    if (!(this.connectionLine && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = event.pageX - (parentBoundingRect.x ?? 0);\n    const y = event.pageY - (parentBoundingRect.y ?? 0);\n\n    this.connectionLine.setAttribute('x2', `${x / transformScale}`);\n    this.connectionLine.setAttribute('y2', `${y / transformScale}`);\n\n    const connectionLineX1 = this.connectionLine.x1.baseVal.value;\n    const connectionLineY1 = this.connectionLine.y1.baseVal.value;\n    if (!this.didConnectionLeaveHighlight) {\n      const connectionLength = Math.hypot(x - connectionLineX1, y - connectionLineY1);\n      if (connectionLength > CONNECTION_ANCHOR_HIGHLIGHT_OFFSET && this.connectionSVG) {\n        this.didConnectionLeaveHighlight = true;\n        this.connectionSVG.style.display = 'block';\n        this.isDrawingConnection = true;\n      }\n    }\n\n    if (!event.buttons) {\n      if (this.connectionSource && this.connectionSource.div && this.connectionSource.div.parentElement) {\n        const sourceRect = this.connectionSource.div.getBoundingClientRect();\n\n        const transformScale = this.scene.scale;\n        const parentRect = getParentBoundingClientRect(this.scene);\n\n        if (!parentRect) {\n          return;\n        }\n\n        const sourceVerticalCenter = (sourceRect.top - parentRect.top + sourceRect.height / 2) / transformScale;\n        const sourceHorizontalCenter = (sourceRect.left - parentRect.left + sourceRect.width / 2) / transformScale;\n\n        // Convert from DOM coords to connection coords\n        // TODO: Break this out into util function and add tests\n        const sourceX = (connectionLineX1 - sourceHorizontalCenter) / (sourceRect.width / 2 / transformScale);\n        const sourceY = (sourceVerticalCenter - connectionLineY1) / (sourceRect.height / 2 / transformScale);\n\n        let targetX;\n        let targetY;\n        let targetName;\n\n        if (this.connectionTarget && this.connectionTarget.div) {\n          const targetRect = this.connectionTarget.div.getBoundingClientRect();\n\n          const targetVerticalCenter = targetRect.top - parentRect.top + targetRect.height / 2;\n          const targetHorizontalCenter = targetRect.left - parentRect.left + targetRect.width / 2;\n\n          targetX = (x - targetHorizontalCenter) / (targetRect.width / 2);\n          targetY = (targetVerticalCenter - y) / (targetRect.height / 2);\n          targetName = this.connectionTarget.options.name;\n        } else {\n          const parentVerticalCenter = parentRect.height / 2;\n          const parentHorizontalCenter = parentRect.width / 2;\n\n          targetX = (x - parentHorizontalCenter) / (parentRect.width / 2);\n          targetY = (parentVerticalCenter - y) / (parentRect.height / 2);\n        }\n\n        const connection = {\n          source: {\n            x: sourceX,\n            y: sourceY,\n          },\n          target: {\n            x: targetX,\n            y: targetY,\n          },\n          targetName: targetName,\n          color: {\n            fixed: config.theme2.colors.text.primary,\n          },\n          size: {\n            fixed: 2,\n            min: 1,\n            max: 10,\n          },\n          path: ConnectionPath.Straight,\n        };\n\n        const { options } = this.connectionSource;\n        if (!options.connections) {\n          options.connections = [];\n        }\n        if (this.didConnectionLeaveHighlight) {\n          this.connectionSource.options.connections = [...options.connections, connection];\n          this.connectionSource.onChange(this.connectionSource.options);\n        }\n      }\n\n      if (this.connectionSVG) {\n        this.connectionSVG.style.display = 'none';\n      }\n\n      if (this.scene.selecto && this.scene.selecto.rootContainer) {\n        this.scene.selecto.rootContainer.style.cursor = 'default';\n        this.scene.selecto.rootContainer.removeEventListener('mousemove', this.connectionListener);\n      }\n\n      this.isDrawingConnection = false;\n      this.updateState();\n      this.scene.save();\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging an existing vertex\n  vertexListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = (event.pageX - parentBoundingRect.x) / transformScale;\n    const y = (event.pageY - parentBoundingRect.y) / transformScale;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n    const sourceRect = selectedValue!.source.div!.getBoundingClientRect();\n\n    // calculate relative coordinates based on source and target coorindates of connection\n    const { x1, y1, x2, y2 } = calculateCoordinates(\n      sourceRect,\n      parentBoundingRect,\n      selectedValue?.info!,\n      selectedValue!.target,\n      transformScale\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length - 1) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex + 1].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex + 1].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    let deleteVertex = false;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((x - vx1) / (y - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((x - vx2) / (y - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((y - vy1) / (x - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((y - vy2) / (x - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n\n      const angleOverall = calculateAngle(vx1, vy1, vx2, vy2);\n      const angleBefore = calculateAngle(vx1, vy1, x, y);\n      deleteVertex = Math.abs(angleBefore - angleOverall) < CONNECTION_VERTEX_SNAP_TOLERANCE;\n    }\n\n    if (deleteVertex) {\n      // Display temporary vertex removal\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${vx2} ${vy2}`);\n      this.connectionSVGVertex!.style.display = 'block';\n      this.connectionVertex.style.display = 'none';\n    } else {\n      // Display temporary vertex during drag\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n      this.connectionSVGVertex!.style.display = 'block';\n      this.connectionVertex.style.display = 'block';\n    }\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionSVGVertex!.style.display = 'none';\n\n      // call onChange here and update appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n\n            // TODO for vertex removal, clear out originals?\n            if (deleteVertex) {\n              currentVertices.splice(vertexIndex, 1);\n            } else {\n              const currentVertex = { ...currentVertices[vertexIndex] };\n\n              currentVertex.x = (xSnap - xStart) / xDist;\n              currentVertex.y = (ySnap - yStart) / yDist;\n\n              currentVertices[vertexIndex] = currentVertex;\n            }\n\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n\n            // Update save model\n            currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n            this.updateState();\n            this.scene.save();\n          }\n        }\n      }\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging a new vertex\n  vertexAddListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = (event.pageX - parentBoundingRect.x) / transformScale;\n    const y = (event.pageY - parentBoundingRect.y) / transformScale;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n    const sourceRect = selectedValue!.source.div!.getBoundingClientRect();\n\n    // calculate relative coordinates based on source and target coorindates of connection\n    const { x1, y1, x2, y2 } = calculateCoordinates(\n      sourceRect,\n      parentBoundingRect,\n      selectedValue?.info!,\n      selectedValue!.target,\n      transformScale\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((x - vx1) / (y - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((x - vx2) / (y - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((y - vy1) / (x - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((y - vy2) / (x - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n    }\n\n    this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n    this.connectionSVGVertex!.style.display = 'block';\n    this.connectionVertex.style.display = 'block';\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexAddListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexAddListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionSVGVertex!.style.display = 'none';\n\n      // call onChange here and insert new vertex at appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          const newVertex = { x: (x - xStart) / xDist, y: (y - yStart) / yDist };\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n            currentVertices.splice(vertexIndex, 0, newVertex);\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          } else {\n            // For first vertex creation\n            const currentVertices: ConnectionCoordinates[] = [newVertex];\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          }\n\n          // Check for original state\n          if (\n            !currentConnections[connectionIndex].sourceOriginal ||\n            !currentConnections[connectionIndex].targetOriginal\n          ) {\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              sourceOriginal: { x: x1, y: y1 },\n              targetOriginal: { x: x2, y: y2 },\n            };\n          }\n          // Update save model\n          currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n          this.updateState();\n          this.scene.save();\n        }\n      }\n    }\n  };\n\n  handleConnectionDragStart = (selectedTarget: HTMLElement, clientX: number, clientY: number) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n    if (this.connectionSVG && this.connectionLine && this.scene.div && this.scene.div.parentElement) {\n      const connectionStartTargetBox = selectedTarget.getBoundingClientRect();\n\n      const transformScale = this.scene.scale;\n      const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n      if (!parentBoundingRect) {\n        return;\n      }\n\n      // Multiply by transform scale to calculate the correct scaled offset\n      const connectionAnchorOffsetX = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * transformScale;\n      const connectionAnchorOffsetY = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * transformScale;\n\n      const x = (connectionStartTargetBox.x - parentBoundingRect.x + connectionAnchorOffsetX) / transformScale;\n      const y = (connectionStartTargetBox.y - parentBoundingRect.y + connectionAnchorOffsetY) / transformScale;\n\n      const mouseX = clientX - parentBoundingRect.x;\n      const mouseY = clientY - parentBoundingRect.y;\n\n      this.connectionLine.setAttribute('x1', `${x}`);\n      this.connectionLine.setAttribute('y1', `${y}`);\n      this.connectionLine.setAttribute('x2', `${mouseX}`);\n      this.connectionLine.setAttribute('y2', `${mouseY}`);\n      this.didConnectionLeaveHighlight = false;\n    }\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.connectionListener);\n  };\n\n  // Add event listener at root container during existing vertex drag\n  handleVertexDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexListener);\n  };\n\n  // Add event listener at root container during creation of new vertex\n  handleVertexAddDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexAddListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexAddListener);\n  };\n\n  onChange = (current: ConnectionState, update: CanvasConnection) => {\n    const connections = current.source.options.connections?.splice(0) ?? [];\n    connections[current.index] = update;\n    current.source.onChange({ ...current.source.options, connections });\n    this.updateState();\n  };\n\n  // used for moveable actions\n  connectionsNeedUpdate = (element: ElementState): boolean => {\n    return isConnectionSource(element) || isConnectionTarget(element, this.scene.byName);\n  };\n\n  render() {\n    return (\n      <>\n        <ConnectionAnchors\n          setRef={this.setConnectionAnchorRef}\n          setAnchorsRef={this.setAnchorsRef}\n          handleMouseLeave={this.handleMouseLeave}\n        />\n        <ConnectionSVG\n          setSVGRef={this.setConnectionSVGRef}\n          setLineRef={this.setConnectionLineRef}\n          setSVGVertexRef={this.setConnectionSVGVertexRef}\n          setVertexPathRef={this.setConnectionVertexPathRef}\n          setVertexRef={this.setConnectionVertexRef}\n          scene={this.scene}\n        />\n      </>\n    );\n  }\n}\n","import { MoveableManagerInterface, Renderer } from 'moveable';\n\nimport { VerticalConstraint, HorizontalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { Scene } from './scene';\nimport { findElementByTarget } from './sceneElementManagement';\n\nexport const settingsViewable = (scene: Scene) => ({\n  name: 'settingsViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    // If selection is more than 1 element don't display settings button\n    if (scene.selecto?.getSelectedTargets() && scene.selecto?.getSelectedTargets().length > 1) {\n      return;\n    }\n\n    const openSettings = (x: number, y: number) => {\n      const container = moveable.getContainer();\n      const evt = new PointerEvent('contextmenu', { clientX: x, clientY: y });\n      container.dispatchEvent(evt);\n    };\n\n    const onClick = (event: React.MouseEvent) => {\n      openSettings(event.clientX, event.clientY);\n    };\n\n    const onKeyPress = (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        const rect = event.currentTarget.getBoundingClientRect();\n        openSettings(rect.x, rect.y);\n      }\n    };\n\n    const rect = moveable.getRect();\n    return (\n      <div\n        key={'settings-viewable'}\n        className={'moveable-settings'}\n        style={{\n          position: 'absolute',\n          left: `${rect.width + 18}px`,\n          top: '0px',\n          color: 'white',\n          fontSize: '18px',\n          cursor: 'pointer',\n          userSelect: 'none',\n          willChange: 'transform',\n          transform: 'translate(-50%, 0px)',\n          zIndex: 100,\n        }}\n        onClick={onClick}\n        onKeyDown={onKeyPress}\n        role=\"button\"\n        tabIndex={0}\n      >\n        {``}\n        \n        {``}\n      </div>\n    );\n  },\n});\n\nexport const dimensionViewable = {\n  name: 'dimensionViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    const rect = moveable.getRect();\n    return (\n      // eslint-disable-next-line @grafana/i18n/no-untranslated-strings\n      <div\n        key={'dimension-viewable'}\n        className={'moveable-dimension'}\n        style={{\n          position: 'absolute',\n          left: `${rect.width / 2}px`,\n          top: `${rect.height + 20}px`,\n          background: '#4af',\n          borderRadius: '2px',\n          padding: '2px 4px',\n          color: 'white',\n          fontSize: '13px',\n          whiteSpace: 'nowrap',\n          fontWeight: 'bold',\n          willChange: 'transform',\n          transform: 'translate(-50%, 0px)',\n          zIndex: 100,\n        }}\n      >\n        {Math.round(rect.offsetWidth)} x {Math.round(rect.offsetHeight)}\n      </div>\n    );\n  },\n};\n\nexport const constraintViewable = (scene: Scene) => ({\n  name: 'constraintViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    const rect = moveable.getRect();\n    const targetElement = findElementByTarget(moveable.state.target!, scene.root.elements);\n\n    // If selection is more than 1 element don't display constraint visualizations\n    if (scene.selecto?.getSelectedTargets() && scene.selecto?.getSelectedTargets().length > 1) {\n      return;\n    }\n\n    let verticalConstraintVisualization = null;\n    let horizontalConstraintVisualization = null;\n\n    const constraint = targetElement?.tempConstraint ?? targetElement?.options.constraint ?? {};\n\n    const borderStyle = '1px dashed #4af';\n\n    const centerIndicatorLineOne = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 2 - rect.height / 16}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 8}px`,\n        transform: 'rotate(45deg)',\n      },\n    });\n\n    const centerIndicatorLineTwo = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 2 - rect.height / 16}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 8}px`,\n        transform: 'rotate(-45deg)',\n      },\n    });\n\n    const centerIndicator = React.createElement('div', {}, [centerIndicatorLineOne, centerIndicatorLineTwo]);\n\n    const verticalConstraintTop = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        bottom: '0px',\n        borderLeft: borderStyle,\n        height: '100vh',\n      },\n    });\n\n    const verticalConstraintBottom = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height}px`,\n        borderLeft: borderStyle,\n        height: '100vh',\n      },\n    });\n\n    const verticalConstraintTopBottom = React.createElement('div', {}, [\n      verticalConstraintTop,\n      verticalConstraintBottom,\n    ]);\n\n    const verticalConstraintCenterLine = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 4}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 2}px`,\n      },\n    });\n\n    const verticalConstraintCenter = React.createElement('div', {}, [verticalConstraintCenterLine, centerIndicator]);\n\n    switch (constraint.vertical) {\n      case VerticalConstraint.Top:\n        verticalConstraintVisualization = verticalConstraintTop;\n        break;\n      case VerticalConstraint.Bottom:\n        verticalConstraintVisualization = verticalConstraintBottom;\n        break;\n      case VerticalConstraint.TopBottom:\n        verticalConstraintVisualization = verticalConstraintTopBottom;\n        break;\n      case VerticalConstraint.Center:\n        verticalConstraintVisualization = verticalConstraintCenter;\n        break;\n    }\n\n    const horizontalConstraintLeft = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        right: '0px',\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: '100vw',\n      },\n    });\n\n    const horizontalConstraintRight = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width}px`,\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: '100vw',\n      },\n    });\n\n    const horizontalConstraintLeftRight = React.createElement('div', {}, [\n      horizontalConstraintLeft,\n      horizontalConstraintRight,\n    ]);\n\n    const horizontalConstraintCenterLine = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 4}px`,\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: `${rect.width / 2}px`,\n      },\n    });\n\n    const horizontalConstraintCenter = React.createElement('div', {}, [\n      horizontalConstraintCenterLine,\n      centerIndicator,\n    ]);\n\n    switch (constraint.horizontal) {\n      case HorizontalConstraint.Left:\n        horizontalConstraintVisualization = horizontalConstraintLeft;\n        break;\n      case HorizontalConstraint.Right:\n        horizontalConstraintVisualization = horizontalConstraintRight;\n        break;\n      case HorizontalConstraint.LeftRight:\n        horizontalConstraintVisualization = horizontalConstraintLeftRight;\n        break;\n      case HorizontalConstraint.Center:\n        horizontalConstraintVisualization = horizontalConstraintCenter;\n        break;\n    }\n\n    const constraintVisualization = React.createElement('div', {}, [\n      verticalConstraintVisualization,\n      horizontalConstraintVisualization,\n    ]);\n\n    return constraintVisualization;\n  },\n});\n","import InfiniteViewer from 'infinite-viewer';\nimport Moveable from 'moveable';\nimport Selecto from 'selecto';\n\nimport { config } from 'app/core/config';\nimport { CONNECTION_ANCHOR_DIV_ID } from 'app/plugins/panel/canvas/components/connections/ConnectionAnchors';\nimport {\n  CONNECTION_VERTEX_ID,\n  CONNECTION_VERTEX_ADD_ID,\n} from 'app/plugins/panel/canvas/components/connections/Connections';\nimport { VerticalConstraint, HorizontalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { dimensionViewable, constraintViewable, settingsViewable } from './ables';\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { Scene } from './scene';\nimport { findElementByTarget } from './sceneElementManagement';\n\nconst ZOOM_RANGE = [0.1, 4]; // Minimum zoom 0.1x (10%), maximum zoom 4x (400%)\n\n// Helper function that disables custom able functionality\nconst disableCustomables = (moveable: Moveable) => {\n  moveable!.props = {\n    dimensionViewable: false,\n    constraintViewable: false,\n    settingsViewable: false,\n  };\n};\n\n// Helper function that enables custom able functionality\nconst enableCustomables = (moveable: Moveable) => {\n  moveable!.props = {\n    dimensionViewable: true,\n    constraintViewable: true,\n    settingsViewable: true,\n  };\n};\n\n/* \n  Helper function that determines if the selected DOM target is currently selected in selecto state.\n\n  For context canvas elements each have a different level of nesting.\n  Given this, we need to traverse up the DOM tree from the selected target to find\n  the element's registered selecto div to determine if the selected target is already selected in selecto state.\n  See `initMoveable` and `generateTargetElements` for more context.\n*/\nconst isTargetAlreadySelected = (selectedTarget: HTMLElement, scene: Scene) => {\n  let selectedTargetParent = selectedTarget.parentElement;\n  let isTargetAlreadySelected = false;\n\n  // Traverse up the DOM tree to check if the selected target is already selected\n  while (selectedTargetParent) {\n    // If the selected target is the scene's root element div, break the loop\n    if (selectedTargetParent === scene.root.div) {\n      break;\n    }\n\n    // Check if the selected target is already selected\n    isTargetAlreadySelected = scene.selecto?.getSelectedTargets().includes(selectedTargetParent) ?? false;\n    if (isTargetAlreadySelected) {\n      break;\n    }\n\n    // Move up the DOM tree to the next parent element to check\n    selectedTargetParent = selectedTargetParent.parentElement;\n  }\n\n  return isTargetAlreadySelected;\n};\n\n// Generate HTML element divs for every canvas element to configure selecto / moveable\nconst generateTargetElements = (rootElements: ElementState[]): HTMLDivElement[] => {\n  let targetElements: HTMLDivElement[] = [];\n\n  const stack = [...rootElements];\n  while (stack.length > 0) {\n    const currentElement = stack.shift();\n\n    if (currentElement && currentElement.div) {\n      targetElements.push(currentElement.div);\n    }\n\n    const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n    for (const nestedElement of nestedElements) {\n      stack.unshift(nestedElement);\n    }\n  }\n\n  return targetElements;\n};\n\n// Main entry point for initializing / updating moveable and selecto configuration\nexport const initMoveable = (destroySelecto = false, allowChanges = true, scene: Scene) => {\n  const targetElements = generateTargetElements(scene.root.elements);\n\n  if (destroySelecto && scene.selecto) {\n    scene.selecto.destroy();\n  }\n\n  scene.selecto = new Selecto({\n    rootContainer: config.featureToggles.canvasPanelPanZoom ? scene.viewerDiv : scene.div,\n    dragContainer: config.featureToggles.canvasPanelPanZoom ? scene.viewerDiv : scene.div,\n    selectableTargets: targetElements,\n    toggleContinueSelect: 'shift',\n    selectFromInside: false,\n    hitRate: 0,\n  });\n\n  const snapDirections = { top: true, left: true, bottom: true, right: true, center: true, middle: true };\n  const elementSnapDirections = { top: true, left: true, bottom: true, right: true, center: true, middle: true };\n\n  scene.moveable = new Moveable(config.featureToggles.canvasPanelPanZoom ? scene.viewerDiv! : scene.div!, {\n    draggable: allowChanges && !scene.editModeEnabled.getValue(),\n    resizable: allowChanges,\n\n    // Setup rotatable\n    rotatable: allowChanges,\n    throttleRotate: 5,\n    rotationPosition: ['top', 'right'],\n\n    // Setup snappable\n    snappable: allowChanges,\n    snapDirections: snapDirections,\n    elementSnapDirections: elementSnapDirections,\n    elementGuidelines: targetElements,\n\n    ables: [dimensionViewable, constraintViewable(scene), settingsViewable(scene)],\n    props: {\n      dimensionViewable: allowChanges,\n      constraintViewable: allowChanges,\n      settingsViewable: allowChanges,\n    },\n    origin: false,\n  })\n    .on('rotateStart', () => {\n      disableCustomables(scene.moveable!);\n    })\n    .on('rotate', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        targetedElement.applyRotate(event);\n\n        if (config.featureToggles.canvasPanelPanZoom) {\n          if (scene.connections.connectionsNeedUpdate(targetedElement) && scene.moveableActionCallback) {\n            scene.moveableActionCallback(true);\n          }\n        }\n      }\n    })\n    .on('rotateGroup', (e) => {\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyRotate(event);\n        }\n      }\n    })\n    .on('rotateEnd', () => {\n      enableCustomables(scene.moveable!);\n      // Update the editor with the new rotation\n      scene.moved.next(Date.now());\n    })\n    .on('click', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      let elementSupportsEditing = false;\n      if (targetedElement) {\n        elementSupportsEditing = targetedElement.item.hasEditMode ?? false;\n      }\n\n      if (event.isDouble && allowChanges && !scene.editModeEnabled.getValue() && elementSupportsEditing) {\n        scene.editModeEnabled.next(true);\n      }\n    })\n    .on('clickGroup', (event) => {\n      scene.selecto!.clickTarget(event.inputEvent, event.inputTarget);\n    })\n    .on('dragStart', (event) => {\n      scene.ignoreDataUpdate = true;\n      scene.setNonTargetPointerEvents(event.target, true);\n\n      // Remove the selected element from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n        if (targetIndex > -1) {\n          scene.moveable.elementGuidelines.splice(targetIndex, 1);\n        }\n      }\n    })\n    .on('dragGroupStart', (e) => {\n      scene.ignoreDataUpdate = true;\n\n      // Remove the selected elements from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n      }\n    })\n    .on('drag', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.applyDrag(event);\n\n        if (scene.connections.connectionsNeedUpdate(targetedElement) && scene.moveableActionCallback) {\n          scene.moveableActionCallback(true);\n        }\n      }\n    })\n    .on('dragGroup', (e) => {\n      let needsUpdate = false;\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyDrag(event);\n          if (!needsUpdate) {\n            needsUpdate = scene.connections.connectionsNeedUpdate(targetedElement);\n          }\n        }\n      }\n\n      if (needsUpdate && scene.moveableActionCallback) {\n        scene.moveableActionCallback(true);\n      }\n    })\n    .on('dragGroupEnd', (e) => {\n      e.events.forEach((event) => {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n\n          // re-add the selected elements to the snappable guidelines\n          if (scene.moveable && scene.moveable.elementGuidelines) {\n            scene.moveable.elementGuidelines.push(event.target);\n          }\n        }\n      });\n\n      scene.moved.next(Date.now());\n      scene.ignoreDataUpdate = false;\n    })\n    .on('dragEnd', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n      }\n\n      scene.moved.next(Date.now());\n      scene.ignoreDataUpdate = false;\n      scene.setNonTargetPointerEvents(event.target, false);\n\n      // re-add the selected element to the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        scene.moveable.elementGuidelines.push(event.target);\n      }\n    })\n    .on('resizeStart', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        // Remove the selected element from the snappable guidelines\n        if (scene.moveable && scene.moveable.elementGuidelines) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n\n        targetedElement.tempConstraint = { ...targetedElement.options.constraint };\n        targetedElement.options.constraint = {\n          vertical: VerticalConstraint.Top,\n          horizontal: HorizontalConstraint.Left,\n        };\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n      }\n    })\n    .on('resizeGroupStart', (e) => {\n      // Remove the selected elements from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n      }\n      // Temporarily set Top-Left constraints on each group element for predictable resizing; restore originals on end.\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.tempConstraint = { ...targetedElement.options.constraint };\n          targetedElement.options.constraint = {\n            vertical: VerticalConstraint.Top,\n            horizontal: HorizontalConstraint.Left,\n          };\n          targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n        }\n      }\n    })\n    .on('resize', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.applyResize(event);\n\n        if (scene.connections.connectionsNeedUpdate(targetedElement) && scene.moveableActionCallback) {\n          scene.moveableActionCallback(true);\n        }\n      }\n      scene.moved.next(Date.now()); // TODO only on end\n    })\n    .on('resizeGroup', (e) => {\n      let needsUpdate = false;\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyResize(event);\n\n          if (!needsUpdate) {\n            needsUpdate = scene.connections.connectionsNeedUpdate(targetedElement);\n          }\n        }\n      }\n\n      if (needsUpdate && scene.moveableActionCallback) {\n        scene.moveableActionCallback(true);\n      }\n\n      scene.moved.next(Date.now()); // TODO only on end\n    })\n    .on('resizeEnd', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        if (targetedElement.tempConstraint) {\n          targetedElement.options.constraint = targetedElement.tempConstraint;\n          targetedElement.tempConstraint = undefined;\n        }\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n\n        // re-add the selected element to the snappable guidelines\n        if (scene.moveable && scene.moveable.elementGuidelines) {\n          scene.moveable.elementGuidelines.push(event.target);\n        }\n      }\n    })\n    .on('resizeGroupEnd', (e) => {\n      // re-add the selected elements to the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          scene.moveable.elementGuidelines.push(event.target);\n        }\n      }\n    });\n\n  let targets: Array<HTMLElement | SVGElement> = [];\n  scene\n    .selecto!.on('dragStart', (event) => {\n      const selectedTarget = event.inputEvent.target;\n\n      // If selected target is a connection control, eject to handle connection event\n      if (selectedTarget.id === CONNECTION_ANCHOR_DIV_ID) {\n        scene.connections.handleConnectionDragStart(selectedTarget, event.inputEvent.clientX, event.inputEvent.clientY);\n        event.stop();\n        return;\n      }\n\n      // If selected target is a vertex, eject to handle vertex event\n      if (selectedTarget.id === CONNECTION_VERTEX_ID) {\n        scene.connections.handleVertexDragStart(selectedTarget);\n        event.stop();\n        return;\n      }\n\n      // If selected target is an add vertex point, eject to handle add vertex event\n      if (selectedTarget.id === CONNECTION_VERTEX_ADD_ID) {\n        scene.connections.handleVertexAddDragStart(selectedTarget);\n        event.stop();\n        return;\n      }\n\n      const isTargetMoveableElement =\n        scene.moveable!.isMoveableElement(selectedTarget) ||\n        targets.some((target) => target === selectedTarget || target.contains(selectedTarget));\n\n      const isElementSelected = isTargetAlreadySelected(selectedTarget, scene);\n\n      // Apply grabbing cursor while dragging, applyLayoutStylesToDiv() resets it to grab when done\n      if (\n        scene.isEditingEnabled &&\n        !scene.editModeEnabled.getValue() &&\n        isTargetMoveableElement &&\n        scene.selecto?.getSelectedTargets().length\n      ) {\n        scene.selecto.getSelectedTargets()[0].style.cursor = 'grabbing';\n      }\n\n      if (isTargetMoveableElement || isElementSelected || !scene.isEditingEnabled) {\n        // Prevent drawing selection box when selected target is a moveable element or already selected\n        event.stop();\n      }\n    })\n    .on('select', () => {\n      scene.editModeEnabled.next(false);\n\n      // Hide connection anchors on select\n      if (scene.connections.connectionAnchorDiv) {\n        scene.connections.connectionAnchorDiv.style.display = 'none';\n      }\n    })\n    .on('selectEnd', (event) => {\n      targets = event.selected;\n      scene.updateSelection({ targets });\n\n      if (event.isDragStart) {\n        if (scene.isEditingEnabled && !scene.editModeEnabled.getValue() && scene.selecto?.getSelectedTargets().length) {\n          scene.selecto.getSelectedTargets()[0].style.cursor = 'grabbing';\n        }\n        event.inputEvent.preventDefault();\n        event.data.timer = setTimeout(() => {\n          scene.moveable!.dragStart(event.inputEvent);\n        });\n      }\n    })\n    .on('dragEnd', (event) => {\n      clearTimeout(event.data.timer);\n    });\n\n  if (config.featureToggles.canvasPanelPanZoom) {\n    /******************/\n    /* infiniteViewer */\n    /******************/\n    scene.infiniteViewer = new InfiniteViewer(scene.viewerDiv!, scene.viewportDiv!, {\n      preventWheelClick: false,\n      useAutoZoom: true,\n      useMouseDrag: false, // `true` blocks metricValue dropdown\n      useWheelScroll: scene.shouldPanZoom,\n      displayHorizontalScroll: false,\n      displayVerticalScroll: false,\n      zoomRange: ZOOM_RANGE,\n    });\n    scene.infiniteViewer.setZoom(scene.scale);\n    scene.infiniteViewer.scrollTo(scene.scrollLeft, scene.scrollTop);\n\n    // Handles context menu activation\n    // Uses openContextMenu with coordinates when available (after CanvasContextMenu mounts), but\n    // uses the basic visibility toggle when openContextMenu isn't ready (as a fallback)\n    const triggerContextMenu = (x: number, y: number) => {\n      if (scene.openContextMenu) {\n        scene.openContextMenu({ x, y });\n      } else {\n        scene.contextMenuOnVisibilityChange(true);\n      }\n    };\n\n    /* ----------------------------- EVENT HANDLERS ----------------------------- */\n    // Helper for panning with mouse drag (middle mouse or Ctrl+right-click)\n    // TODO: It was implemented as a workaround to unblock left click metricsValue dropdown,\n    // but it should be replaced with a more robust solution that doesn't interfere with left click interactions.\n    function startPanning(e: MouseEvent) {\n      e.preventDefault();\n\n      const startX = e.clientX;\n      const startY = e.clientY;\n      const startScrollLeft = scene.infiniteViewer!.getScrollLeft();\n      const startScrollTop = scene.infiniteViewer!.getScrollTop();\n\n      const handleMouseMove = (moveEvent: MouseEvent) => {\n        const deltaX = startX - moveEvent.clientX;\n        const deltaY = startY - moveEvent.clientY;\n        const scaleAdjustedDeltaX = deltaX / scene.scale;\n        const scaleAdjustedDeltaY = deltaY / scene.scale;\n        scene.infiniteViewer!.scrollTo(startScrollLeft + scaleAdjustedDeltaX, startScrollTop + scaleAdjustedDeltaY);\n        moveEvent.preventDefault();\n      };\n\n      const handleMouseUp = () => {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      };\n\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n    }\n\n    // Right click\n    scene.viewerDiv!.addEventListener('contextmenu', (e) => {\n      if (e.ctrlKey && e.button === 2 && scene.shouldPanZoom) {\n        // Enable panning with Ctrl+right-click\n        startPanning(e);\n      } else {\n        // Prevent default browser context menu\n        e.preventDefault();\n        triggerContextMenu(e.pageX, e.pageY);\n      }\n    });\n\n    // Enable panning with middle mouse button (wheel button)\n    scene.viewerDiv!.addEventListener('mousedown', (e: MouseEvent) => {\n      if (e.button === 1 && scene.shouldPanZoom) {\n        // Middle mouse button\n        startPanning(e);\n      }\n    });\n\n    // Prevent wheel scrolling when pan/zoom is disabled\n    scene.viewportDiv!.addEventListener(\n      'wheel',\n      (e) => {\n        if (!scene.shouldPanZoom) {\n          e.stopImmediatePropagation();\n          e.preventDefault();\n        }\n      },\n      { passive: false }\n    );\n\n    // Reset zoom and scroll position on double click\n    scene.viewerDiv!.addEventListener('dblclick', (e: MouseEvent) => {\n      // Only reset if not in edit mode and pan/zoom is enabled\n      if (!scene.editModeEnabled.getValue() && scene.shouldPanZoom && scene.infiniteViewer) {\n        scene.infiniteViewer.setZoom(1);\n        scene.infiniteViewer.scrollTo(0, 0);\n      }\n    });\n\n    // Mouse scroll click\n    // Only allow panning with middle mouse button (button 1)\n    // Left click is reserved for selection/manipulation, right click for context menu\n    scene.infiniteViewer!.on('dragStart', (e) => {\n      if (e.inputEvent.button !== 1) {\n        e.preventDefault();\n        e.preventDrag();\n      }\n    });\n\n    // Scroll\n    scene.infiniteViewer!.on('scroll', () => {\n      // TODO: clear current selection is default behaviour on zoom-in or zoom-out,\n      // but looks like we prevented this event to trigger at some point\n      scene.clearCurrentSelection(true);\n\n      scene.updateConnectionsSize();\n      scene.scale = scene.infiniteViewer!.getZoom();\n\n      scene.scrollLeft = scene.infiniteViewer!.getScrollLeft();\n      scene.scrollTop = scene.infiniteViewer!.getScrollTop();\n    });\n  }\n};\n\n// Zoom to content helper functions\nexport function calculateZoomToFitScale(elements: Element[], container: HTMLDivElement, paddingRatio = 0.05) {\n  const bounds = calculateGroupBoundingBox(elements);\n  const containerRect = container.getBoundingClientRect();\n  const containerWidth = containerRect.width;\n  const containerHeight = containerRect.height;\n\n  const paddedWidth = containerWidth * (1 - 2 * paddingRatio);\n  const paddedHeight = containerHeight * (1 - 2 * paddingRatio);\n\n  const scaleX = paddedWidth / bounds.width;\n  const scaleY = paddedHeight / bounds.height;\n\n  // Use the smaller one to fit both horizontally and vertically\n  const scale = Math.min(scaleX, scaleY);\n\n  // calculate value to move to center\n  const centerX = (bounds.centerX * scale - containerWidth / 2) / scale;\n  const centerY = (bounds.centerY * scale - containerHeight / 2) / scale;\n\n  return {\n    scale,\n    centerX,\n    centerY,\n  };\n}\n\nexport function extractTranslateFromTransform(transform: string) {\n  const matrix = new DOMMatrix(transform);\n  return { x: matrix.m41, y: matrix.m42 }; // m41 = translateX, m42 = translateY\n}\n\nexport function calculateGroupBoundingBox(elements: Element[]) {\n  let minX = Infinity,\n    minY = Infinity;\n  let maxX = -Infinity,\n    maxY = -Infinity;\n\n  for (const el of elements) {\n    const style = window.getComputedStyle(el);\n    const { x: tx, y: ty } = extractTranslateFromTransform(style.transform || '');\n\n    const width = parseFloat(style.width);\n    const height = parseFloat(style.height);\n\n    const left = tx;\n    const top = ty;\n    const right = tx + width;\n    const bottom = ty + height;\n\n    minX = Math.min(minX, left);\n    minY = Math.min(minY, top);\n    maxX = Math.max(maxX, right);\n    maxY = Math.max(maxY, bottom);\n  }\n\n  return {\n    left: minX,\n    top: minY,\n    right: maxX,\n    bottom: maxY,\n    width: maxX - minX,\n    height: maxY - minY,\n    centerX: (minX + maxX) / 2,\n    centerY: (minY + maxY) / 2,\n  };\n}\n","import { cloneDeep } from 'lodash';\n\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { HorizontalConstraint, Placement, VerticalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { LayerActionID } from 'app/plugins/panel/canvas/types';\n\nimport { updateConnectionsForSource } from '../../../plugins/panel/canvas/utils';\nimport { CanvasElementItem } from '../element';\nimport { CanvasFrameOptions } from '../frame';\nimport { canvasElementRegistry } from '../registry';\n\nimport { ElementState } from './element';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\nimport { initMoveable } from './sceneAbleManagement';\n\nconst DEFAULT_OFFSET = 10;\nconst HORIZONTAL_OFFSET = 50;\n\nexport const frameItemDummy: CanvasElementItem = {\n  id: 'frame',\n  name: 'Frame',\n  description: 'Frame',\n\n  getNewOptions: () => ({\n    config: {},\n  }),\n\n  display: () => {\n    // never shown to end user\n    // eslint-disable-next-line @grafana/i18n/no-untranslated-strings\n    return <div>FRAME!</div>;\n  },\n};\n\nexport class FrameState extends ElementState {\n  elements: ElementState[] = [];\n  scene: Scene;\n\n  constructor(\n    public options: CanvasFrameOptions,\n    scene: Scene,\n    public parent?: FrameState\n  ) {\n    super(frameItemDummy, options, parent);\n\n    this.scene = scene;\n\n    // mutate options object\n    let { elements } = this.options;\n    if (!elements) {\n      this.options.elements = elements = [];\n    }\n\n    for (const element of elements) {\n      if (element.type === 'frame') {\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        this.elements.push(new FrameState(element as CanvasFrameOptions, scene, this));\n      } else {\n        const item = canvasElementRegistry.getIfExists(element.type) ?? notFoundItem;\n        this.elements.push(new ElementState(item, element, this));\n      }\n    }\n  }\n\n  isRoot(): this is RootElement {\n    return false;\n  }\n\n  updateData(ctx: DimensionContext) {\n    super.updateData(ctx);\n    for (const elem of this.elements) {\n      elem.updateData(ctx);\n    }\n  }\n\n  // used in the layer editor\n  reorder(startIndex: number, endIndex: number) {\n    const result = Array.from(this.elements);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    this.elements = result;\n\n    this.reinitializeMoveable();\n  }\n\n  // used for tree view\n  reorderTree(src: ElementState, dest: ElementState, firstPosition = false) {\n    const result = Array.from(this.elements);\n    const srcIndex = this.elements.indexOf(src);\n    const destIndex = firstPosition ? this.elements.length - 1 : this.elements.indexOf(dest);\n\n    const [removed] = result.splice(srcIndex, 1);\n    result.splice(destIndex, 0, removed);\n    this.elements = result;\n\n    this.reinitializeMoveable();\n  }\n\n  doMove(child: ElementState, action: LayerActionID) {\n    const vals = this.elements.filter((v) => v !== child);\n    if (action === LayerActionID.MoveBottom) {\n      vals.unshift(child);\n    } else {\n      vals.push(child);\n    }\n    this.elements = vals;\n    this.scene.save();\n    this.reinitializeMoveable();\n  }\n\n  reinitializeMoveable() {\n    // Need to first clear current selection and then re-init moveable with slight delay\n    this.scene.clearCurrentSelection();\n    setTimeout(() => initMoveable(true, this.scene.isEditingEnabled, this.scene));\n  }\n\n  // ??? or should this be on the element directly?\n  // are actions scoped to layers?\n  doAction = (action: LayerActionID, element: ElementState, updateName = true, shiftItemsOnDuplicate = true) => {\n    switch (action) {\n      case LayerActionID.Delete:\n        this.elements = this.elements.filter((e) => e !== element);\n        updateConnectionsForSource(element, this.scene);\n        this.scene.byName.delete(element.options.name);\n        this.scene.save();\n        this.reinitializeMoveable();\n        break;\n      case LayerActionID.Duplicate:\n        if (element.item.id === 'frame') {\n          console.log('Can not duplicate frames (yet)', action, element);\n          return;\n        }\n        const opts = cloneDeep(element.options);\n\n        if (shiftItemsOnDuplicate) {\n          const { constraint, placement: oldPlacement } = element.options;\n          const { vertical, horizontal } = constraint ?? {};\n          const placement: Placement = { ...oldPlacement };\n\n          switch (vertical) {\n            case VerticalConstraint.Top:\n              if (placement.top == null) {\n                placement.top = 25;\n              } else {\n                placement.top += DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.Bottom:\n              if (placement.bottom == null) {\n                placement.bottom = 100;\n              } else {\n                placement.bottom -= DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.TopBottom:\n              if (placement.top == null) {\n                placement.top = 25;\n              } else {\n                placement.top += DEFAULT_OFFSET;\n              }\n\n              if (placement.bottom == null) {\n                placement.bottom = 100;\n              } else {\n                placement.bottom -= DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.Center:\n              if (placement.top != null) {\n                placement.top -= DEFAULT_OFFSET;\n              }\n              break;\n          }\n\n          switch (horizontal) {\n            case HorizontalConstraint.Left:\n              if (placement.left == null) {\n                placement.left = HORIZONTAL_OFFSET;\n              } else {\n                placement.left += DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.Right:\n              if (placement.right == null) {\n                placement.right = HORIZONTAL_OFFSET;\n              } else {\n                placement.right -= DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.LeftRight:\n              if (placement.left == null) {\n                placement.left = HORIZONTAL_OFFSET;\n              } else {\n                placement.left += DEFAULT_OFFSET;\n              }\n\n              if (placement.right == null) {\n                placement.right = HORIZONTAL_OFFSET;\n              } else {\n                placement.right -= DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.Center:\n              if (placement.left != null) {\n                placement.left -= DEFAULT_OFFSET;\n              }\n              break;\n          }\n\n          opts.placement = placement;\n        }\n\n        // Clear connections on duplicate\n        opts.connections = undefined;\n\n        const copy = new ElementState(element.item, opts, this);\n        copy.updateData(this.scene.context);\n        if (updateName) {\n          copy.options.name = this.scene.getNextElementName();\n        }\n        this.elements.push(copy);\n        this.scene.byName.set(copy.options.name, copy);\n\n        // Update scene byName map for original element (to avoid stale references (e.g. for connections))\n        this.scene.byName.set(element.options.name, element);\n\n        this.scene.save();\n        this.reinitializeMoveable();\n\n        setTimeout(() => {\n          this.scene.targetsToSelect.add(copy.div!);\n        });\n        break;\n      case LayerActionID.MoveTop:\n      case LayerActionID.MoveBottom:\n        element.parent?.doMove(element, action);\n        break;\n\n      default:\n        console.log('DO action', action, element);\n        return;\n    }\n  };\n\n  render() {\n    return (\n      <div key={this.UID} ref={this.initElement}>\n        {this.elements.map((v) => v.render())}\n      </div>\n    );\n  }\n\n  /** Recursively visit all nodes */\n  visit(visitor: (v: ElementState) => void) {\n    super.visit(visitor);\n    for (const e of this.elements) {\n      visitor(e);\n    }\n  }\n\n  getSaveModel() {\n    return {\n      ...this.options,\n      elements: this.elements.map((v) => v.getSaveModel()),\n    };\n  }\n}\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useState } from 'react';\nimport * as React from 'react';\nimport { first } from 'rxjs/operators';\n\nimport { SelectableValue } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { ContextMenu, MenuItem, MenuItemProps } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { findElementByTarget } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { CanvasPanel } from '../CanvasPanel';\nimport { AnchorPoint, LayerActionID } from '../types';\nimport { getElementTypes, onAddItem } from '../utils';\n\ntype Props = {\n  scene: Scene;\n  panel: CanvasPanel;\n  onVisibilityChange: (v: boolean) => void;\n};\n\nexport const CanvasContextMenu = ({ scene, panel, onVisibilityChange }: Props) => {\n  const inlineEditorOpen = panel.state.openInlineEdit;\n  const [isMenuVisible, setIsMenuVisible] = useState<boolean>(false);\n  const [anchorPoint, setAnchorPoint] = useState<AnchorPoint>({ x: 0, y: 0 });\n\n  const styles = getStyles();\n\n  const selectedElements = scene.selecto?.getSelectedTargets();\n  const rootLayer: FrameState | undefined = panel.context?.instanceState?.layer;\n\n  useEffect(() => {\n    if (config.featureToggles.canvasPanelPanZoom) {\n      scene.openContextMenu = (position: AnchorPoint) => {\n        setAnchorPoint(position);\n        setIsMenuVisible(true);\n        onVisibilityChange(true);\n      };\n\n      // Clean up the openContextMenu on unmount\n      return () => (scene.openContextMenu = undefined);\n    }\n    return undefined;\n  }, [scene, onVisibilityChange]);\n\n  const handleContextMenu = useCallback(\n    (event: Event) => {\n      if (!(event instanceof MouseEvent) || event.ctrlKey) {\n        return;\n      }\n\n      event.preventDefault();\n      panel.setActivePanel();\n\n      const shouldSelectElement = config.featureToggles.canvasPanelPanZoom\n        ? event.currentTarget !== scene.viewportDiv\n        : event.currentTarget !== scene.div;\n      if (\n        shouldSelectElement &&\n        (event.currentTarget instanceof HTMLElement || event.currentTarget instanceof SVGElement)\n      ) {\n        scene.select({ targets: [event.currentTarget] });\n      }\n      setAnchorPoint({ x: event.pageX, y: event.pageY });\n      setIsMenuVisible(true);\n      onVisibilityChange(true);\n    },\n    [scene, panel, onVisibilityChange]\n  );\n\n  useEffect(() => {\n    if (scene.selecto) {\n      scene.selecto.getSelectableElements().forEach((element) => {\n        element.addEventListener('contextmenu', handleContextMenu);\n      });\n    }\n  }, [handleContextMenu, scene.selecto]);\n\n  useEffect(() => {\n    if (scene.div) {\n      scene.div.addEventListener('contextmenu', handleContextMenu);\n    }\n  }, [handleContextMenu, scene.div]);\n\n  const closeContextMenu = () => {\n    setIsMenuVisible(false);\n    onVisibilityChange(false);\n  };\n\n  const renderMenuItems = () => {\n    // This is disabled when panel is in edit mode because opening inline editor over panel editor is not ideal UX\n    const openCloseEditorMenuItem = !scene.isPanelEditing && (\n      <MenuItem\n        label={\n          inlineEditorOpen\n            ? t('canvas.canvas-context-menu.close-editor', 'Close Editor')\n            : t('canvas.canvas-context-menu.open-editor', 'Open Editor')\n        }\n        onClick={() => {\n          if (scene.inlineEditingCallback) {\n            if (inlineEditorOpen) {\n              panel.closeInlineEdit();\n            } else {\n              scene.inlineEditingCallback();\n            }\n          }\n          closeContextMenu();\n        }}\n        className={styles.menuItem}\n      />\n    );\n\n    const editElementMenuItem = () => {\n      if (selectedElements?.length === 1) {\n        const onClickEditElementMenuItem = () => {\n          scene.editModeEnabled.next(true);\n          closeContextMenu();\n        };\n\n        const element = findElementByTarget(selectedElements[0], scene.root.elements);\n        return (\n          element &&\n          element.item.hasEditMode && (\n            <MenuItem\n              label={t('canvas.canvas-context-menu.render-menu-items.edit-element-menu-item.label-edit', 'Edit')}\n              onClick={onClickEditElementMenuItem}\n              className={styles.menuItem}\n            />\n          )\n        );\n      }\n      return null;\n    };\n\n    const typeOptions = getElementTypes(scene.shouldShowAdvancedTypes).options;\n\n    const getTypeOptionsSubmenu = () => {\n      const submenuItems: Array<\n        React.ReactElement<MenuItemProps<unknown>, string | React.JSXElementConstructor<unknown>>\n      > = [];\n\n      const onClickItem = (option: SelectableValue<string>) => {\n        let offsetY = anchorPoint.y;\n        let offsetX = anchorPoint.x;\n        if (scene.div) {\n          const transformScale = scene.scale;\n          const sceneContainerDimensions = scene.div.getBoundingClientRect();\n          offsetY = (offsetY - sceneContainerDimensions.top) / transformScale;\n          offsetX = (offsetX - sceneContainerDimensions.left) / transformScale;\n        } else if (scene.viewportDiv) {\n          const sceneContainerDimensions = scene.viewportDiv.getBoundingClientRect();\n          offsetY -= sceneContainerDimensions.top;\n          offsetX -= sceneContainerDimensions.left;\n        }\n\n        onAddItem(option, rootLayer, {\n          ...anchorPoint,\n          y: offsetY,\n          x: offsetX,\n        });\n      };\n\n      typeOptions.map((option) => {\n        submenuItems.push(\n          <MenuItem key={option.value} label={option.label ?? 'Canvas item'} onClick={() => onClickItem(option)} />\n        );\n      });\n\n      return submenuItems;\n    };\n\n    const addItemMenuItem = (\n      <MenuItem\n        label={t('canvas.canvas-context-menu.render-menu-items.add-item-menu-item.label-add-item', 'Add item')}\n        className={styles.menuItem}\n        childItems={getTypeOptionsSubmenu()}\n        customSubMenuContainerStyles={{ maxHeight: '150px', overflowY: 'auto' }}\n      />\n    );\n\n    const setBackgroundMenuItem = (\n      <MenuItem\n        label={t(\n          'canvas.canvas-context-menu.render-menu-items.set-background-menu-item.label-set-background',\n          'Set background'\n        )}\n        onClick={() => {\n          if (scene.setBackgroundCallback) {\n            scene.setBackgroundCallback(anchorPoint);\n          }\n          closeContextMenu();\n        }}\n        className={styles.menuItem}\n      />\n    );\n\n    if (selectedElements && selectedElements.length >= 1) {\n      return (\n        <>\n          {editElementMenuItem()}\n          <MenuItem\n            label={t('canvas.canvas-context-menu.render-menu-items.label-delete', 'Delete')}\n            onClick={() => {\n              contextMenuAction(LayerActionID.Delete);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label={t('canvas.canvas-context-menu.render-menu-items.label-duplicate', 'Duplicate')}\n            onClick={() => {\n              contextMenuAction(LayerActionID.Duplicate);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label={t('canvas.canvas-context-menu.render-menu-items.label-bring-to-front', 'Bring to front')}\n            onClick={() => {\n              contextMenuAction(LayerActionID.MoveTop);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label={t('canvas.canvas-context-menu.render-menu-items.label-send-to-back', 'Send to back')}\n            onClick={() => {\n              contextMenuAction(LayerActionID.MoveBottom);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          {openCloseEditorMenuItem}\n        </>\n      );\n    } else {\n      return (\n        <>\n          {openCloseEditorMenuItem}\n          {setBackgroundMenuItem}\n          {addItemMenuItem}\n        </>\n      );\n    }\n  };\n\n  const contextMenuAction = (actionType: LayerActionID) => {\n    scene.selection.pipe(first()).subscribe((currentSelectedElements) => {\n      const currentLayer = currentSelectedElements[0].parent!;\n      currentSelectedElements.forEach((currentSelectedElement: ElementState) => {\n        currentLayer.doAction(actionType, currentSelectedElement);\n      });\n    });\n\n    setTimeout(() => {\n      scene.addToSelection();\n      scene.targetsToSelect.clear();\n    });\n  };\n\n  if (isMenuVisible) {\n    return (\n      <div\n        onContextMenu={(event) => {\n          event.preventDefault();\n          closeContextMenu();\n        }}\n      >\n        <ContextMenu\n          x={anchorPoint.x}\n          y={anchorPoint.y}\n          onClose={closeContextMenu}\n          renderMenuItems={renderMenuItems}\n          focusOnOpen={false}\n        />\n      </div>\n    );\n  }\n\n  return <></>;\n};\n\nconst getStyles = () => ({\n  menuItem: css({\n    maxWidth: '200px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { useDialog } from '@react-aria/dialog';\nimport { useOverlay } from '@react-aria/overlays';\nimport { createRef, useMemo } from 'react';\n\nimport {\n  Field,\n  LinkModel,\n  FieldType,\n  GrafanaTheme2,\n  formattedValueToString,\n  getFieldDisplayName,\n  ScopedVars,\n  ValueLinkConfig,\n  ActionModel,\n} from '@grafana/data';\nimport { Portal, useStyles2, useTheme2, VizTooltipContainer, usePanelContext } from '@grafana/ui';\nimport {\n  VizTooltipContent,\n  VizTooltipFooter,\n  VizTooltipHeader,\n  VizTooltipItem,\n  CloseButton,\n} from '@grafana/ui/internal';\nimport { getActions, getActionsDefaultField } from 'app/features/actions/utils';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { getDataLinks } from '../../status-history/utils';\nimport { getElementFields, getRowIndex } from '../utils';\n\ninterface Props {\n  scene: Scene;\n}\n\nexport const CanvasTooltip = ({ scene }: Props) => {\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const { canExecuteActions } = usePanelContext();\n  const userCanExecuteActions = useMemo(() => canExecuteActions?.() ?? false, [canExecuteActions]);\n\n  const onClose = () => {\n    if (scene?.tooltipCallback && scene.tooltipPayload) {\n      scene.tooltipCallback(undefined);\n    }\n  };\n\n  const ref = createRef<HTMLElement>();\n  const { overlayProps } = useOverlay({ onClose: onClose, isDismissable: true }, ref);\n  const { dialogProps } = useDialog({}, ref);\n\n  const element = scene.tooltipPayload?.element;\n  if (!element) {\n    return <></>;\n  }\n\n  // Retrieve timestamp of the last data point if available\n  const timeField = scene.data?.series[0]?.fields?.find((field) => field.type === FieldType.time);\n  const lastTimeValue = timeField?.values[timeField.values.length - 1];\n  const shouldDisplayTimeContentItem =\n    timeField && lastTimeValue && element.data.field && getFieldDisplayName(timeField) !== element.data.field;\n\n  const headerItem: VizTooltipItem = {\n    label: element.getName(),\n    value: '',\n  };\n\n  const contentItems: VizTooltipItem[] = [\n    {\n      label: element.data.field ?? 'Fixed',\n      value: element.data.text,\n    },\n    ...(shouldDisplayTimeContentItem\n      ? [\n          {\n            label: 'Time',\n            value: formattedValueToString(timeField?.display!(lastTimeValue)),\n          },\n        ]\n      : []),\n  ];\n\n  // NOTE: almost identical to getDataLinks() helper\n  const links: Array<LinkModel<Field>> = [];\n\n  if ((element.options.links?.length ?? 0) > 0 && element.getLinks) {\n    const linkLookup = new Set<string>();\n\n    element.getLinks({ valueRowIndex: getRowIndex(element.data.field, scene) }).forEach((link) => {\n      const key = `${link.title}/${link.href}`;\n      if (!linkLookup.has(key)) {\n        links.push(link);\n        linkLookup.add(key);\n      }\n    });\n  }\n\n  if (scene.data?.series) {\n    getElementFields(scene.data?.series, element.options).forEach((field) => {\n      links.push(...getDataLinks(field, getRowIndex(element.data.field, scene)));\n    });\n  }\n\n  const actions: Array<ActionModel<Field>> = [];\n  const actionLookup = new Set<string>();\n\n  const elementHasActions = (element.options.actions?.length ?? 0) > 0;\n  const frames = scene.data?.series;\n\n  if (elementHasActions && frames && userCanExecuteActions) {\n    const defaultField = getActionsDefaultField(element.options.links ?? [], element.options.actions ?? []);\n    const scopedVars: ScopedVars = {\n      __dataContext: {\n        value: {\n          data: frames,\n          field: defaultField,\n          frame: frames[0],\n          frameIndex: 0,\n        },\n      },\n    };\n\n    const config: ValueLinkConfig = { valueRowIndex: getRowIndex(element.data.field, scene) };\n\n    const actionsModel = getActions(\n      frames[0],\n      defaultField,\n      scopedVars,\n      scene.panel.props.replaceVariables!,\n      element.options.actions ?? [],\n      config\n    );\n\n    actionsModel.forEach((action) => {\n      const key = `${action.title}/${Math.random()}`;\n      if (!actionLookup.has(key)) {\n        actions.push(action);\n        actionLookup.add(key);\n      }\n    });\n  }\n\n  return (\n    <>\n      {scene.tooltipPayload?.element && scene.tooltipPayload.anchorPoint && (\n        <Portal zIndex={theme.zIndex.tooltip}>\n          <VizTooltipContainer\n            className={cx(styles.tooltipWrapper, scene.tooltipPayload.isOpen && styles.pinned)}\n            position={{ x: scene.tooltipPayload.anchorPoint.x, y: scene.tooltipPayload.anchorPoint.y }}\n            offset={{ x: 5, y: 0 }}\n            allowPointerEvents={scene.tooltipPayload.isOpen}\n          >\n            <section ref={ref} {...overlayProps} {...dialogProps}>\n              {scene.tooltipPayload.isOpen && <CloseButton style={{ zIndex: 1 }} onClick={onClose} />}\n              <VizTooltipHeader item={headerItem} isPinned={scene.tooltipPayload.isOpen!} />\n              {element.data.text && <VizTooltipContent items={contentItems} isPinned={scene.tooltipPayload.isOpen!} />}\n              {(links.length > 0 || actions.length > 0) && <VizTooltipFooter dataLinks={links} actions={actions} />}\n            </section>\n          </VizTooltipContainer>\n        </Portal>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    marginTop: '20px',\n    background: theme.colors.background.primary,\n  }),\n  tooltipWrapper: css({\n    top: 0,\n    left: 0,\n    whiteSpace: 'pre',\n    borderRadius: theme.shape.radius.default,\n    position: 'fixed',\n    background: theme.colors.background.primary,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z2,\n    userSelect: 'text',\n    padding: 0,\n    fontSize: theme.typography.bodySmall.fontSize,\n  }),\n  pinned: css({\n    boxShadow: theme.shadows.z3,\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useRef } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\nimport { ConnectionCoordinates } from 'app/features/canvas/element';\n\ntype Props = {\n  setRef: (anchorElement: HTMLDivElement) => void;\n  setAnchorsRef: (anchorsElement: HTMLDivElement) => void;\n  handleMouseLeave: (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => boolean;\n};\n\nexport const CONNECTION_ANCHOR_DIV_ID = 'connectionControl';\nexport const CONNECTION_ANCHOR_ALT = 'connection anchor';\nexport const CONNECTION_ANCHOR_HIGHLIGHT_OFFSET = 8;\n// Unit is percentage from the middle of the element\n// 0, 0 middle; -1, -1 bottom left; 1, 1 top right\nexport const ANCHORS = [\n  { x: -1, y: 1 },\n  { x: -0.5, y: 1 },\n  { x: 0, y: 1 },\n  { x: 0.5, y: 1 },\n  { x: 1, y: 1 },\n  { x: 1, y: 0.5 },\n  { x: 1, y: 0 },\n  { x: 1, y: -0.5 },\n  { x: 1, y: -1 },\n  { x: 0.5, y: -1 },\n  { x: 0, y: -1 },\n  { x: -0.5, y: -1 },\n  { x: -1, y: -1 },\n  { x: -1, y: -0.5 },\n  { x: -1, y: 0 },\n  { x: -1, y: 0.5 },\n];\nexport const ANCHOR_PADDING = 3;\nexport const HALF_SIZE = 2.5;\n\nconst zIndex = {\n  ROOT: 1000,\n  ANCHOR: 1001,\n  HIGHLIGHT: 1002,\n};\n\nenum PointerEvents {\n  ROOT = 'none',\n  MOUSEOUT_DIV = 'none',\n  ANCHOR = 'auto',\n  HIGHLIGHT = 'auto',\n}\n\nexport const ConnectionAnchors = ({ setRef, setAnchorsRef, handleMouseLeave }: Props) => {\n  const highlightEllipseRef = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const halfSizeHighlightEllipse = 5.5;\n  const anchorImage =\n    'data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1cHgiIGhlaWdodD0iNXB4IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2Utd2lkdGg9IjIiIHN0eWxlPSJzdHJva2Utb3BhY2l0eTowLjQiIHN0cm9rZT0iI2ZmZmZmZiIvPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2U9IiMyOWI2ZjIiLz48L3N2Zz4=';\n\n  const onMouseEnterAnchor = (event: React.MouseEvent) => {\n    if (!(event.target instanceof HTMLImageElement)) {\n      return;\n    }\n\n    if (highlightEllipseRef.current && event.target.style) {\n      highlightEllipseRef.current.style.display = 'block';\n      highlightEllipseRef.current.style.top = `calc(${event.target.style.top} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n      highlightEllipseRef.current.style.left = `calc(${event.target.style.left} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n    }\n  };\n\n  const onMouseLeaveHighlightElement = () => {\n    if (highlightEllipseRef.current) {\n      highlightEllipseRef.current.style.display = 'none';\n    }\n  };\n\n  const handleMouseLeaveAnchors = (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => {\n    const didHideAnchors = handleMouseLeave(event);\n\n    if (didHideAnchors) {\n      onMouseLeaveHighlightElement();\n    }\n  };\n\n  const generateAnchors = (anchors: ConnectionCoordinates[] = ANCHORS) => {\n    return anchors.map((anchor) => {\n      const id = `${anchor.x},${anchor.y}`;\n\n      // Convert anchor coords to relative percentage\n      const style = {\n        top: `calc(${-anchor.y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n        left: `calc(${anchor.x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n      };\n\n      return (\n        <img\n          id={id}\n          ref={(element) => {\n            if (element) {\n              // After React 15+, inline styles no longer support !important\n              element.style.setProperty('pointer-events', PointerEvents.ANCHOR, 'important');\n            }\n          }}\n          key={id}\n          alt={CONNECTION_ANCHOR_ALT}\n          className={styles.anchor}\n          style={style}\n          src={anchorImage}\n          onMouseEnter={onMouseEnterAnchor}\n        />\n      );\n    });\n  };\n\n  return (\n    <div className={styles.root} ref={setRef}>\n      <div className={styles.mouseoutDiv} onMouseOut={handleMouseLeaveAnchors} onBlur={handleMouseLeaveAnchors} />\n      <div\n        id={CONNECTION_ANCHOR_DIV_ID}\n        ref={highlightEllipseRef}\n        className={styles.highlightElement}\n        onMouseLeave={onMouseLeaveHighlightElement}\n      />\n      <div ref={setAnchorsRef}>{generateAnchors()}</div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  root: css({\n    position: 'absolute',\n    display: 'none',\n    zIndex: `${zIndex.ROOT} !important`,\n    pointerEvents: PointerEvents.ROOT,\n  }),\n  mouseoutDiv: css({\n    position: 'absolute',\n    margin: '-30px',\n    width: 'calc(100% + 60px)',\n    height: 'calc(100% + 60px)',\n    pointerEvents: PointerEvents.MOUSEOUT_DIV,\n  }),\n  anchor: css({\n    padding: `${ANCHOR_PADDING}px`,\n    position: 'absolute',\n    cursor: 'cursor',\n    width: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    height: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    zIndex: `${zIndex.ANCHOR} !important`,\n    pointerEvents: PointerEvents.ANCHOR,\n    userSelect: 'none',\n  }),\n  highlightElement: css({\n    backgroundColor: '#00ff00',\n    opacity: 0.3,\n    position: 'absolute',\n    cursor: 'cursor',\n    pointerEvents: PointerEvents.HIGHLIGHT,\n    width: '16px',\n    height: '16px',\n    borderRadius: theme.shape.radius.circle,\n    display: 'none',\n    zIndex: `${zIndex.HIGHLIGHT} !important`,\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useEffect, useMemo, useRef, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { DirectionDimensionConfig, DirectionDimensionMode, ConnectionDirection } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { ConnectionCoordinates } from '../../panelcfg.gen';\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates2,\n  calculateDistance,\n  calculateMidpoint,\n  getConnectionStyles,\n} from '../../utils';\n\nimport { CONNECTION_VERTEX_ADD_ID, CONNECTION_VERTEX_ID } from './Connections';\n\ntype Props = {\n  setLineRef: (anchorElement: SVGLineElement) => void;\n  setVertexPathRef: (anchorElement: SVGPathElement) => void;\n  setVertexRef: (anchorElement: SVGCircleElement) => void;\n  setConnectionsSVGRef: (anchorElement: SVGSVGElement) => void;\n  scene: Scene;\n};\n\nlet idCounter = 0;\nconst htmlElementTypes = ['input', 'textarea'];\n\nexport const ConnectionSVG = ({ setLineRef, setVertexPathRef, setVertexRef, setConnectionsSVGRef, scene }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const headId = Date.now() + '_' + idCounter++;\n  const CONNECTION_LINE_ID = useMemo(() => `connectionLineId-${headId}`, [headId]);\n  const EDITOR_HEAD_ID = useMemo(() => `editorHead-${headId}`, [headId]);\n  const defaultArrowColor = config.theme2.colors.text.primary;\n  const defaultArrowSize = 2;\n  const defaultArrowDirection: DirectionDimensionConfig = {\n    mode: DirectionDimensionMode.Fixed,\n    fixed: ConnectionDirection.Forward,\n  };\n  const maximumVertices = 10;\n\n  const [selectedConnection, setSelectedConnection] = useState<ConnectionState | undefined>(undefined);\n\n  // Need to use ref to ensure state is not stale in event handler\n  const selectedConnectionRef = useRef(selectedConnection);\n  useEffect(() => {\n    selectedConnectionRef.current = selectedConnection;\n  });\n\n  useEffect(() => {\n    if (scene.panel.context.instanceState?.selectedConnection) {\n      setSelectedConnection(scene.panel.context.instanceState?.selectedConnection);\n    }\n  }, [scene.panel.context.instanceState?.selectedConnection]);\n\n  const onKeyUp = (e: KeyboardEvent) => {\n    const target = e.target;\n\n    if (!(target instanceof HTMLElement)) {\n      return;\n    }\n\n    if (htmlElementTypes.indexOf(target.nodeName.toLowerCase()) > -1) {\n      return;\n    }\n\n    // Backspace (8) or delete (46)\n    if (e.keyCode === 8 || e.keyCode === 46) {\n      if (selectedConnectionRef.current && selectedConnectionRef.current.source) {\n        selectedConnectionRef.current.source.options.connections =\n          selectedConnectionRef.current.source.options.connections?.filter(\n            (connection) => connection !== selectedConnectionRef.current?.info\n          );\n        selectedConnectionRef.current.source.onChange(selectedConnectionRef.current.source.options);\n\n        setSelectedConnection(undefined);\n        scene.connections.select(undefined);\n        scene.connections.updateState();\n        scene.save();\n      }\n    } else {\n      // Prevent removing event listener if key is not delete\n      return;\n    }\n\n    document.removeEventListener('keyup', onKeyUp);\n    scene.selecto!.rootContainer!.removeEventListener('click', clearSelectedConnection);\n  };\n\n  const clearSelectedConnection = (event: MouseEvent) => {\n    const eventTarget = event.target;\n\n    const shouldResetSelectedConnection = !(\n      eventTarget instanceof SVGLineElement && eventTarget.id === CONNECTION_LINE_ID\n    );\n\n    if (shouldResetSelectedConnection) {\n      setSelectedConnection(undefined);\n      scene.connections.select(undefined);\n    }\n  };\n\n  const selectConnection = (connection: ConnectionState) => {\n    if (scene.isEditingEnabled) {\n      setSelectedConnection(connection);\n      scene.connections.select(connection);\n\n      document.addEventListener('keyup', onKeyUp);\n      scene.selecto!.rootContainer!.addEventListener('click', clearSelectedConnection);\n    }\n  };\n\n  // Figure out target and then target's relative coordinates drawing (if no target do parent)\n  const renderConnections = () => {\n    return (\n      scene.connections.state\n        // Render selected connection last, ensuring it is above other connections\n        .sort((_a, b) => (selectedConnection === b && scene.panel.context.instanceState.selectedConnection ? -1 : 0))\n        .map((v, idx) => {\n          const { source, target, info, vertices, index } = v;\n          const sourceRect = source.div;\n          const parent = source.div?.parentElement;\n          const parentRect = scene.viewportDiv;\n\n          if (!sourceRect || !parent || !parentRect) {\n            return;\n          }\n\n          let { x1, y1, x2, y2 } = calculateCoordinates2(source, target, info);\n\n          let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n          if (v.sourceOriginal && v.targetOriginal) {\n            xStart = v.sourceOriginal.x;\n            yStart = v.sourceOriginal.y;\n            xEnd = v.targetOriginal.x;\n            yEnd = v.targetOriginal.y;\n          } else if (source.options.connections) {\n            // If original source or target coordinates are not set for the current connection, set them\n            if (\n              !source.options.connections[index].sourceOriginal ||\n              !source.options.connections[index].targetOriginal\n            ) {\n              source.options.connections[index].sourceOriginal = { x: x1, y: y1 };\n              source.options.connections[index].targetOriginal = { x: x2, y: y2 };\n            }\n          }\n\n          const midpoint = calculateMidpoint(x1, y1, x2, y2);\n          const xDist = xEnd - xStart;\n          const yDist = yEnd - yStart;\n\n          const { strokeColor, strokeWidth, strokeRadius, arrowDirection, lineStyle, shouldAnimate } =\n            getConnectionStyles(\n              info,\n              scene,\n              defaultArrowSize,\n              defaultArrowDirection.fixed ?? ConnectionDirection.Forward\n            );\n\n          const isSelected = selectedConnection === v && scene.panel.context.instanceState.selectedConnection;\n\n          const connectionCursorStyle = scene.isEditingEnabled ? 'grab' : '';\n          const selectedStyles = { stroke: '#44aaff', strokeOpacity: 0.6, strokeWidth: strokeWidth + 5 };\n\n          const CONNECTION_HEAD_ID_START = `connectionHeadStart-${headId + Math.random()}`;\n          const CONNECTION_HEAD_ID_END = `connectionHeadEnd-${headId + Math.random()}`;\n\n          const radius = strokeRadius;\n          // Create vertex path and populate array of add vertex controls\n          const addVertices: ConnectionCoordinates[] = [];\n          let pathString = `M${x1} ${y1} `;\n          if (vertices?.length) {\n            vertices.map((vertex, index) => {\n              const { x, y } = vertex;\n\n              // Convert vertex relative coordinates to scene coordinates\n              const X = x * xDist + xStart;\n              const Y = y * yDist + yStart;\n\n              // Initialize coordinates for first arc control point\n              let xa = X;\n              let ya = Y;\n\n              // Initialize coordinates for second arc control point\n              let xb = X;\n              let yb = Y;\n\n              // Initialize half arc distance and segment angles\n              let lHalfArc = 0;\n              let angle1 = 0;\n              let angle2 = 0;\n\n              // Only calculate arcs if there is a radius\n              if (radius) {\n                if (index < vertices.length - 1) {\n                  const Xn = vertices[index + 1].x * xDist + xStart;\n                  const Yn = vertices[index + 1].y * yDist + yStart;\n                  if (index === 0) {\n                    // First vertex\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  } else {\n                    // All vertices\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  }\n                } else {\n                  // Last vertex\n                  if (index > 0) {\n                    // Not also the first vertex\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                  } else {\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                  }\n                  angle2 = calculateAngle(X, Y, x2, y2);\n                }\n\n                // Calculate angle between two segments where arc will be placed\n                const theta = angle2 - angle1; //radians\n                // Attempt to determine if arc is counter clockwise (ccw)\n                const ccw = theta < 0;\n                // Half arc is used for arc control points\n                lHalfArc = radius * Math.tan(theta / 2);\n                if (ccw) {\n                  lHalfArc *= -1;\n                }\n              }\n\n              if (index === 0) {\n                // For first vertex\n                addVertices.push(\n                  calculateMidpoint((x1 - xStart) / (xEnd - xStart), (y1 - yStart) / (yEnd - yStart), x, y)\n                );\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, x1, y1);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + x1);\n                  ya = Math.round(lDelta * Math.sin(angle1) + y1);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > x1) || (xa < X && xa < x1)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + x1;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + y1;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              } else {\n                // For all other vertices\n                const previousVertex = vertices[index - 1];\n                addVertices.push(calculateMidpoint(previousVertex.x, previousVertex.y, x, y));\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Convert previous vertex relative coorindates to scene coordinates\n                  const Xp = previousVertex.x * xDist + xStart;\n                  const Yp = previousVertex.y * yDist + yStart;\n\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, Xp, Yp);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + Xp);\n                  ya = Math.round(lDelta * Math.sin(angle1) + Yp);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > Xp) || (xa < X && xa < Xp)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + Xp;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + Yp;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              }\n              if (index === vertices.length - 1) {\n                // For last vertex only\n                addVertices.push(\n                  calculateMidpoint((x2 - xStart) / (xEnd - xStart), (y2 - yStart) / (yEnd - yStart), x, y)\n                );\n              }\n              // Add segment to path\n              pathString += `L${xa} ${ya} `;\n\n              if (lHalfArc !== 0) {\n                // Add arc if applicable\n                pathString += `Q ${X} ${Y} ${xb} ${yb} `;\n              }\n            });\n            // Add last segment\n            pathString += `L${x2} ${y2}`;\n          }\n\n          const markerStart =\n            arrowDirection === ConnectionDirection.Reverse || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_START})`\n              : undefined;\n\n          const markerEnd =\n            arrowDirection === ConnectionDirection.Forward || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_END})`\n              : undefined;\n\n          const getAnimationDirection = () => {\n            let values = '100;0';\n\n            if (arrowDirection === ConnectionDirection.Reverse) {\n              values = '0;100';\n            }\n\n            return values;\n          };\n\n          return (\n            <g key={idx} onClick={() => selectConnection(v)}>\n              <defs>\n                <marker\n                  id={CONNECTION_HEAD_ID_START}\n                  markerWidth=\"10\"\n                  markerHeight=\"7\"\n                  refX=\"0\"\n                  refY=\"3.5\"\n                  orient=\"auto\"\n                  stroke={strokeColor}\n                >\n                  <polygon points=\"10 0, 0 3.5, 10 7\" fill={strokeColor} />\n                </marker>\n                <marker\n                  id={CONNECTION_HEAD_ID_END}\n                  markerWidth=\"10\"\n                  markerHeight=\"7\"\n                  refX=\"10\"\n                  refY=\"3.5\"\n                  orient=\"auto\"\n                  stroke={strokeColor}\n                >\n                  <polygon points=\"0 0, 10 3.5, 0 7\" fill={strokeColor} />\n                </marker>\n              </defs>\n              {vertices?.length ? (\n                // Render path with vertices\n                <g>\n                  {/* heighlight line */}\n                  <path\n                    id={`${CONNECTION_LINE_ID}_transparent`}\n                    d={pathString}\n                    cursor={connectionCursorStyle}\n                    pointerEvents=\"auto\"\n                    stroke=\"transparent\"\n                    strokeWidth={15}\n                    fill={'none'}\n                    style={isSelected ? selectedStyles : {}}\n                  />\n                  {/* real line */}\n                  <path\n                    d={pathString}\n                    stroke={strokeColor}\n                    strokeWidth={strokeWidth}\n                    strokeDasharray={lineStyle}\n                    strokeDashoffset={1}\n                    fill={'none'}\n                    markerEnd={markerEnd}\n                    markerStart={markerStart}\n                  >\n                    {shouldAnimate && (\n                      <animate\n                        attributeName=\"stroke-dashoffset\"\n                        values={getAnimationDirection()}\n                        dur=\"5s\"\n                        calcMode=\"linear\"\n                        repeatCount=\"indefinite\"\n                        fill={'freeze'}\n                      />\n                    )}\n                  </path>\n                  {isSelected && (\n                    <g>\n                      {/* vertices */}\n                      {vertices.map((value, index) => {\n                        return (\n                          <circle\n                            id={CONNECTION_VERTEX_ID}\n                            data-index={index}\n                            key={`${CONNECTION_VERTEX_ID}${index}_${idx}`}\n                            cx={value.x * xDist + xStart}\n                            cy={value.y * yDist + yStart}\n                            r={5}\n                            stroke={strokeColor}\n                            className={styles.vertex}\n                            cursor={'crosshair'}\n                            pointerEvents=\"auto\"\n                          />\n                        );\n                      })}\n                      {/* midpoints */}\n                      {vertices.length < maximumVertices &&\n                        addVertices.map((value, index) => {\n                          return (\n                            <circle\n                              id={CONNECTION_VERTEX_ADD_ID}\n                              data-index={index}\n                              key={`${CONNECTION_VERTEX_ADD_ID}${index}_${idx}`}\n                              cx={value.x * xDist + xStart}\n                              cy={value.y * yDist + yStart}\n                              r={4}\n                              stroke={strokeColor}\n                              className={styles.addVertex}\n                              cursor={'crosshair'}\n                              pointerEvents=\"auto\"\n                            />\n                          );\n                        })}\n                    </g>\n                  )}\n                </g>\n              ) : (\n                // Render line without vertices\n                <g>\n                  {/* heighlight line */}\n                  <line\n                    id={`${CONNECTION_LINE_ID}_transparent`}\n                    cursor={connectionCursorStyle}\n                    pointerEvents=\"auto\"\n                    stroke=\"transparent\"\n                    strokeWidth={15}\n                    style={isSelected ? selectedStyles : {}}\n                    x1={x1}\n                    y1={y1}\n                    x2={x2}\n                    y2={y2}\n                  />\n                  {/* real line */}\n                  <line\n                    id={CONNECTION_LINE_ID}\n                    stroke={strokeColor}\n                    pointerEvents=\"auto\"\n                    strokeWidth={strokeWidth}\n                    markerEnd={markerEnd}\n                    markerStart={markerStart}\n                    strokeDasharray={lineStyle}\n                    strokeDashoffset={1}\n                    x1={x1}\n                    y1={y1}\n                    x2={x2}\n                    y2={y2}\n                    cursor={connectionCursorStyle}\n                  >\n                    {shouldAnimate && (\n                      <animate\n                        attributeName=\"stroke-dashoffset\"\n                        values={getAnimationDirection()}\n                        dur=\"5s\"\n                        calcMode=\"linear\"\n                        repeatCount=\"indefinite\"\n                        fill={'freeze'}\n                      />\n                    )}\n                  </line>\n                  {/* initial midpoint */}\n                  {isSelected && (\n                    <circle\n                      id={CONNECTION_VERTEX_ADD_ID}\n                      data-index={0}\n                      cx={midpoint.x}\n                      cy={midpoint.y}\n                      r={4}\n                      stroke={strokeColor}\n                      className={styles.addVertex}\n                      cursor={'crosshair'}\n                      pointerEvents=\"auto\"\n                    />\n                  )}\n                </g>\n              )}\n            </g>\n          );\n        })\n    );\n  };\n\n  return (\n    <>\n      <svg ref={setConnectionsSVGRef} className={styles.connection}>\n        <defs>\n          <marker\n            id={EDITOR_HEAD_ID}\n            markerWidth=\"10\"\n            markerHeight=\"7\"\n            refX=\"10\"\n            refY=\"3.5\"\n            orient=\"auto\"\n            stroke={defaultArrowColor}\n          >\n            <polygon points=\"0 0, 10 3.5, 0 7\" fill={defaultArrowColor} />\n          </marker>\n        </defs>\n        {/* svg line for connection creation */}\n        <line\n          ref={setLineRef}\n          stroke={defaultArrowColor}\n          strokeWidth={2}\n          markerEnd={`url(#${EDITOR_HEAD_ID})`}\n          style={{ display: 'none' }}\n        />\n\n        {/* svg circle for initial vertex?\n          path? is it for the line drag handling? */}\n        <path\n          ref={setVertexPathRef}\n          stroke={defaultArrowColor}\n          strokeWidth={2}\n          strokeDasharray={'5, 5'}\n          fill={'none'}\n          style={{ display: 'none' }}\n        />\n        <circle\n          ref={setVertexRef}\n          stroke={defaultArrowColor}\n          r={4}\n          className={styles.vertex}\n          style={{ display: 'none' }}\n        />\n\n        {renderConnections()}\n      </svg>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  connection: css({\n    position: 'absolute',\n    zIndex: 1000,\n    pointerEvents: 'none',\n  }),\n  vertex: css({\n    fill: '#44aaff',\n    strokeWidth: 2,\n  }),\n  addVertex: css({\n    fill: '#44aaff',\n    opacity: 0.5,\n    strokeWidth: 1,\n  }),\n});\n","import * as React from 'react';\nimport { BehaviorSubject } from 'rxjs';\n\nimport { config } from '@grafana/runtime';\nimport { CanvasConnection, ConnectionCoordinates, ConnectionPath } from 'app/features/canvas/element';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { findElementByTarget } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates2,\n  getConnections,\n  getElementTransformAndDimensions,\n  getNormalizedRotatedOffset,\n  getParentBoundingClientRect,\n  isConnectionSource,\n  isConnectionTarget,\n} from '../../utils';\n\nimport {\n  CONNECTION_ANCHOR_ALT,\n  CONNECTION_ANCHOR_HIGHLIGHT_OFFSET,\n  ANCHORS,\n  ANCHOR_PADDING,\n  HALF_SIZE,\n} from './ConnectionAnchors';\nimport { ConnectionAnchors } from './ConnectionAnchors2';\nimport { ConnectionSVG } from './ConnectionSVG2';\n\nexport const CONNECTION_VERTEX_ID = 'vertex';\nexport const CONNECTION_VERTEX_ADD_ID = 'vertexAdd';\nconst CONNECTION_VERTEX_ORTHO_TOLERANCE = 0.05; // Cartesian ratio against vertical or horizontal tolerance\nconst CONNECTION_VERTEX_SNAP_TOLERANCE = (5 / 180) * Math.PI; // Multi-segment snapping angle in radians to trigger vertex removal\n\nexport class Connections2 {\n  scene: Scene;\n  connectionAnchorDiv?: HTMLDivElement;\n  anchorsDiv?: HTMLDivElement;\n  connectionLine?: SVGLineElement;\n  connectionVertexPath?: SVGPathElement;\n  connectionVertex?: SVGCircleElement;\n  connectionsSVG?: SVGElement;\n  connectionSource?: ElementState;\n  connectionTarget?: ElementState;\n  isDrawingConnection?: boolean;\n  selectedVertexIndex?: number;\n  didConnectionLeaveHighlight?: boolean;\n  state: ConnectionState[] = [];\n  readonly selection = new BehaviorSubject<ConnectionState | undefined>(undefined);\n\n  constructor(scene: Scene) {\n    this.scene = scene;\n    this.updateState();\n  }\n\n  select = (connection: ConnectionState | undefined) => {\n    if (connection === this.selection.value) {\n      return;\n    }\n    this.selection.next(connection);\n  };\n\n  updateState = () => {\n    this.state = getConnections(this.scene.byName);\n\n    const s = this.selection.value;\n    if (s) {\n      for (let c of this.state) {\n        if (c.source === s.source && c.index === s.index) {\n          this.selection.next(c);\n          break;\n        }\n      }\n    }\n  };\n\n  setConnectionAnchorRef = (anchorElement: HTMLDivElement) => {\n    this.connectionAnchorDiv = anchorElement;\n  };\n\n  setAnchorsRef = (anchorsElement: HTMLDivElement) => {\n    this.anchorsDiv = anchorsElement;\n  };\n\n  setConnectionsSVGRef = (connectionsSVG: SVGElement) => {\n    this.connectionsSVG = connectionsSVG;\n  };\n\n  setConnectionLineRef = (connectionLine: SVGLineElement) => {\n    this.connectionLine = connectionLine;\n  };\n\n  setConnectionVertexRef = (connectionVertex: SVGCircleElement) => {\n    this.connectionVertex = connectionVertex;\n  };\n\n  setConnectionVertexPathRef = (connectionVertexPath: SVGPathElement) => {\n    this.connectionVertexPath = connectionVertexPath;\n  };\n\n  // Recursively find the first parent that is a canvas element\n  findElementTarget = (element: Element): ElementState | undefined => {\n    let elementTarget = undefined;\n\n    // Cap recursion at the scene level\n    if (element === this.scene.viewportDiv) {\n      return undefined;\n    }\n\n    elementTarget = findElementByTarget(element, this.scene.root.elements);\n\n    if (!elementTarget && element.parentElement) {\n      elementTarget = this.findElementTarget(element.parentElement);\n    }\n\n    return elementTarget;\n  };\n\n  handleMouseEnter = (event: React.MouseEvent) => {\n    if (!(event.target instanceof Element) || !this.scene.isEditingEnabled) {\n      return;\n    }\n\n    let element: ElementState | undefined = this.findElementTarget(event.target);\n\n    if (!element) {\n      console.log('no element');\n      return;\n    }\n\n    if (this.isDrawingConnection) {\n      this.connectionTarget = element;\n    } else {\n      this.connectionSource = element;\n      if (!this.connectionSource) {\n        console.log('no connection source');\n        return;\n      }\n    }\n\n    const customElementAnchors = element?.item.customConnectionAnchors || ANCHORS;\n    // This type cast is necessary as TS doesn't understand that `Element` is an `HTMLElement`\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const anchors = Array.from(this.anchorsDiv?.children as HTMLCollectionOf<HTMLElement>);\n    const anchorsAmount = customElementAnchors.length;\n\n    // re-calculate the position of the existing anchors on hover\n    // and hide the rest of the anchors if there are more than the custom ones\n    anchors.forEach((anchor, index) => {\n      if (index >= anchorsAmount) {\n        anchor.style.display = 'none';\n      } else {\n        const { x, y } = customElementAnchors[index];\n        anchor.style.top = `calc(${-y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.left = `calc(${x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.display = 'block';\n      }\n    });\n\n    const { top, left, width, height, rotation } = getElementTransformAndDimensions(element.div!);\n\n    if (this.connectionAnchorDiv) {\n      this.connectionAnchorDiv.style.display = 'none';\n      this.connectionAnchorDiv.style.display = 'block';\n      this.connectionAnchorDiv.style.transform = `translate(${left}px, ${top}px) rotate(${rotation}deg)`;\n      this.connectionAnchorDiv.style.height = `${height}px`;\n      this.connectionAnchorDiv.style.width = `${width}px`;\n    }\n  };\n\n  // Return boolean indicates if connection anchors were hidden or not\n  handleMouseLeave = (event: React.MouseEvent | React.FocusEvent): boolean => {\n    // If mouse is leaving INTO the anchor image, don't remove div\n    if (\n      event.relatedTarget instanceof HTMLImageElement &&\n      event.relatedTarget.getAttribute('alt') === CONNECTION_ANCHOR_ALT\n    ) {\n      return false;\n    }\n\n    this.connectionTarget = undefined;\n    this.connectionAnchorDiv!.style.display = 'none';\n    return true;\n  };\n\n  connectionListener = (event: MouseEvent) => {\n    event.preventDefault();\n\n    if (!(this.connectionLine && this.scene.viewportDiv && this.scene.viewportDiv.parentElement)) {\n      return;\n    }\n    const { scale } = this.scene;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = (event.pageX - parentBoundingRect.x) / scale;\n    const y = (event.pageY - parentBoundingRect.y) / scale;\n\n    this.connectionLine.setAttribute('x2', `${x}`);\n    this.connectionLine.setAttribute('y2', `${y}`);\n\n    const connectionLineX1 = this.connectionLine.x1.baseVal.value;\n    const connectionLineY1 = this.connectionLine.y1.baseVal.value;\n\n    if (!this.didConnectionLeaveHighlight) {\n      const connectionLength = Math.hypot(x - connectionLineX1, y - connectionLineY1);\n      if (connectionLength > CONNECTION_ANCHOR_HIGHLIGHT_OFFSET) {\n        this.didConnectionLeaveHighlight = true;\n        this.connectionLine.style.display = 'block';\n        this.isDrawingConnection = true;\n      }\n    }\n\n    //\n    // SAVING CONNECTION\n    //\n    if (!event.buttons) {\n      if (this.connectionSource && this.connectionSource.div && this.connectionSource.div.parentElement) {\n        const { x: sourceX, y: sourceY } = getNormalizedRotatedOffset(\n          this.connectionSource.div,\n          connectionLineX1,\n          connectionLineY1\n        );\n\n        let targetX;\n        let targetY;\n        let targetName;\n\n        if (this.connectionTarget && this.connectionTarget.div) {\n          ({ x: targetX, y: targetY } = getNormalizedRotatedOffset(this.connectionTarget.div, x, y));\n          targetName = this.connectionTarget.options.name;\n        } else {\n          // if there is no target (open connection)\n          targetX = x;\n          targetY = y;\n        }\n\n        const connection = {\n          source: {\n            x: sourceX,\n            y: sourceY,\n          },\n          target: {\n            x: targetX,\n            y: targetY,\n          },\n          targetName: targetName,\n          color: {\n            fixed: config.theme2.colors.text.primary,\n          },\n          size: {\n            fixed: 2,\n            min: 1,\n            max: 10,\n          },\n          path: ConnectionPath.Straight,\n        };\n\n        const { options } = this.connectionSource;\n        if (!options.connections) {\n          options.connections = [];\n        }\n        if (this.didConnectionLeaveHighlight) {\n          this.connectionSource.options.connections = [...options.connections, connection];\n          this.connectionSource.onChange(this.connectionSource.options);\n        }\n      }\n\n      if (this.connectionLine) {\n        this.connectionLine.style.display = 'none';\n      }\n\n      if (this.scene.selecto && this.scene.selecto.rootContainer) {\n        this.scene.selecto.rootContainer.style.cursor = 'default';\n        this.scene.selecto.rootContainer.removeEventListener('mousemove', this.connectionListener);\n      }\n\n      this.isDrawingConnection = false;\n      this.updateState();\n      this.scene.save();\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging an existing vertex\n  vertexListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.viewportDiv && this.scene.viewportDiv.parentElement)) {\n      return;\n    }\n\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const { scale } = this.scene;\n    const x = (event.pageX - parentBoundingRect.x) / scale;\n    const y = (event.pageY - parentBoundingRect.y) / scale;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n\n    const { x1, y1, x2, y2 } = calculateCoordinates2(\n      selectedValue!.source,\n      selectedValue!.target,\n      selectedValue?.info!\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length - 1) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex + 1].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex + 1].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    let deleteVertex = false;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((xSnap - vx1) / (ySnap - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((xSnap - vx2) / (ySnap - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((ySnap - vy1) / (xSnap - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((ySnap - vy2) / (xSnap - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n\n      const angleOverall = calculateAngle(vx1, vy1, vx2, vy2);\n      const angleBefore = calculateAngle(vx1, vy1, x, y);\n      deleteVertex = Math.abs(angleBefore - angleOverall) < CONNECTION_VERTEX_SNAP_TOLERANCE;\n    }\n\n    if (deleteVertex) {\n      // Display temporary vertex removal\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${vx2} ${vy2}`);\n      this.connectionVertexPath!.style.display = 'block';\n      this.connectionVertex.style.display = 'none';\n    } else {\n      // Display temporary vertex during drag\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n      this.connectionVertexPath!.style.display = 'block';\n      this.connectionVertex.style.display = 'block';\n    }\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionVertexPath!.style.display = 'none';\n      this.connectionVertex.style.display = 'none';\n\n      // call onChange here and update appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n\n            // TODO for vertex removal, clear out originals?\n            if (deleteVertex) {\n              currentVertices.splice(vertexIndex, 1);\n            } else {\n              const currentVertex = { ...currentVertices[vertexIndex] };\n\n              currentVertex.x = (xSnap - xStart) / xDist;\n              currentVertex.y = (ySnap - yStart) / yDist;\n\n              currentVertices[vertexIndex] = currentVertex;\n            }\n\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n\n            // Update save model\n            currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n            this.updateState();\n            this.scene.save();\n          }\n        }\n      }\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging a new vertex\n  vertexAddListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.viewportDiv && this.scene.viewportDiv.parentElement)) {\n      return;\n    }\n\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const { scale } = this.scene;\n    const x = (event.pageX - parentBoundingRect.x) / scale;\n    const y = (event.pageY - parentBoundingRect.y) / scale;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n\n    const { x1, y1, x2, y2 } = calculateCoordinates2(\n      selectedValue!.source,\n      selectedValue!.target,\n      selectedValue?.info!\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((xSnap - vx1) / (ySnap - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((xSnap - vx2) / (ySnap - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((ySnap - vy1) / (xSnap - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((ySnap - vy2) / (xSnap - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n    }\n\n    this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n    this.connectionVertexPath!.style.display = 'block';\n    this.connectionVertex.style.display = 'block';\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexAddListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexAddListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionVertexPath!.style.display = 'none';\n      this.connectionVertex.style.display = 'none';\n\n      // call onChange here and insert new vertex at appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          // Calculate normalized coordinates for the new vertex, using rotatedX/Y\n          const newVertex = { x: (xSnap - xStart) / xDist, y: (ySnap - yStart) / yDist };\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n            currentVertices.splice(vertexIndex, 0, newVertex);\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          } else {\n            // For first vertex creation\n            const currentVertices: ConnectionCoordinates[] = [newVertex];\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          }\n\n          // Check for original state\n          if (\n            !currentConnections[connectionIndex].sourceOriginal ||\n            !currentConnections[connectionIndex].targetOriginal\n          ) {\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              sourceOriginal: { x: x1, y: y1 },\n              targetOriginal: { x: x2, y: y2 },\n            };\n          }\n          // Update save model\n          currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n          this.updateState();\n          this.scene.save();\n        }\n      }\n    }\n  };\n\n  handleConnectionDragStart = (selectedTarget: HTMLElement, clientX: number, clientY: number) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    if (this.connectionLine && this.scene.viewportDiv && this.scene.viewportDiv.parentElement) {\n      const connectionStartTargetBox = selectedTarget.getBoundingClientRect();\n\n      const { scale } = this.scene;\n      const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n      if (!parentBoundingRect) {\n        return;\n      }\n\n      // Multiply by transform scale to calculate the correct scaled offset\n      const connectionAnchorOffsetX = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * scale;\n      const connectionAnchorOffsetY = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * scale;\n\n      const x = (connectionStartTargetBox.x - parentBoundingRect.x + connectionAnchorOffsetX) / scale;\n      const y = (connectionStartTargetBox.y - parentBoundingRect.y + connectionAnchorOffsetY) / scale;\n\n      const mouseX = clientX - parentBoundingRect.x;\n      const mouseY = clientY - parentBoundingRect.y;\n\n      this.connectionLine.setAttribute('x1', `${x}`);\n      this.connectionLine.setAttribute('y1', `${y}`);\n      this.connectionLine.setAttribute('x2', `${mouseX}`);\n      this.connectionLine.setAttribute('y2', `${mouseY}`);\n      this.didConnectionLeaveHighlight = false;\n    }\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.connectionListener);\n  };\n\n  // Add event listener at root container during existing vertex drag\n  handleVertexDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexListener);\n  };\n\n  // Add event listener at root container during creation of new vertex\n  handleVertexAddDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexAddListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexAddListener);\n  };\n\n  onChange = (current: ConnectionState, update: CanvasConnection) => {\n    const connections = current.source.options.connections?.splice(0) ?? [];\n    connections[current.index] = update;\n    current.source.onChange({ ...current.source.options, connections });\n    this.updateState();\n  };\n\n  // used for moveable actions\n  connectionsNeedUpdate = (element: ElementState): boolean => {\n    return isConnectionSource(element) || isConnectionTarget(element, this.scene.byName);\n  };\n\n  render() {\n    return (\n      <>\n        <ConnectionAnchors\n          setRef={this.setConnectionAnchorRef}\n          setAnchorsRef={this.setAnchorsRef}\n          handleMouseLeave={this.handleMouseLeave}\n        />\n        <ConnectionSVG\n          setLineRef={this.setConnectionLineRef}\n          setVertexPathRef={this.setConnectionVertexPathRef}\n          setVertexRef={this.setConnectionVertexRef}\n          setConnectionsSVGRef={this.setConnectionsSVGRef}\n          scene={this.scene}\n        />\n      </>\n    );\n  }\n}\n","import { Fragment } from 'react';\n\nimport { CanvasFrameOptions } from '../frame';\n\nimport { FrameState } from './frame';\nimport { Scene } from './scene';\n\nexport class RootElement extends FrameState {\n  constructor(\n    public options: CanvasFrameOptions,\n    public scene: Scene,\n    private changeCallback: () => void\n  ) {\n    super(options, scene);\n\n    this.sizeStyle = {\n      height: '100%',\n      width: '100%',\n    };\n  }\n\n  isRoot(): this is RootElement {\n    return true;\n  }\n\n  // root type can not change\n  onChange(options: CanvasFrameOptions) {\n    this.revId++;\n    this.options = { ...options };\n    this.changeCallback();\n  }\n\n  getSaveModel(): CanvasFrameOptions {\n    const { placement, constraint, ...rest } = this.options;\n\n    return {\n      ...rest, // everything except placement & constraint\n      elements: this.elements.map((v) => v.getSaveModel()),\n    };\n  }\n\n  setRootRef = (target: HTMLDivElement) => {\n    this.div = target;\n  };\n\n  render() {\n    return (\n      <div\n        onContextMenu={(event) => event.preventDefault()}\n        key={this.UID}\n        ref={this.setRootRef}\n        style={{ ...this.sizeStyle, ...this.dataStyle }}\n      >\n        {this.elements.map((v) => (\n          <Fragment key={v.UID}>{v.render()}</Fragment>\n        ))}\n      </div>\n    );\n  }\n}\n","import { css } from '@emotion/css';\nimport InfiniteViewer from 'infinite-viewer';\nimport Moveable from 'moveable';\nimport { CSSProperties } from 'react';\nimport { BehaviorSubject, ReplaySubject, Subject, Subscription } from 'rxjs';\nimport Selecto from 'selecto';\n\nimport { AppEvents, PanelData, OneClickMode, ActionType } from '@grafana/data';\nimport { locationService } from '@grafana/runtime';\nimport {\n  ColorDimensionConfig,\n  ResourceDimensionConfig,\n  ScalarDimensionConfig,\n  ScaleDimensionConfig,\n  TextDimensionConfig,\n  TooltipDisplayMode,\n  DirectionDimensionConfig,\n} from '@grafana/schema';\nimport { Portal } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport {\n  getColorDimensionFromData,\n  getResourceDimensionFromData,\n  getScalarDimensionFromData,\n  getScaleDimensionFromData,\n  getTextDimensionFromData,\n  getDirectionDimensionFromData,\n} from 'app/features/dimensions/utils';\nimport { CanvasContextMenu } from 'app/plugins/panel/canvas/components/CanvasContextMenu';\nimport { CanvasTooltip } from 'app/plugins/panel/canvas/components/CanvasTooltip';\nimport { Connections } from 'app/plugins/panel/canvas/components/connections/Connections';\nimport { Connections2 } from 'app/plugins/panel/canvas/components/connections/Connections2';\nimport { Options } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { AnchorPoint, CanvasTooltipPayload } from 'app/plugins/panel/canvas/types';\n\nimport appEvents from '../../../core/app_events';\nimport { CanvasPanel } from '../../../plugins/panel/canvas/CanvasPanel';\nimport { isInfinityActionWithAuth } from '../../actions/utils';\nimport { getDashboardSrv } from '../../dashboard/services/DashboardSrv';\nimport { CanvasFrameOptions } from '../frame';\nimport { DEFAULT_CANVAS_ELEMENT_CONFIG } from '../registry';\n\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { initMoveable, calculateZoomToFitScale } from './sceneAbleManagement';\nimport { findElementByTarget } from './sceneElementManagement';\n\nexport interface SelectionParams {\n  targets: Array<HTMLElement | SVGElement>;\n  frame?: FrameState;\n}\n\nexport class Scene {\n  styles = getStyles();\n  readonly selection = new ReplaySubject<ElementState[]>(1);\n  readonly moved = new Subject<number>(); // called after resize/drag for editor updates\n  readonly byName = new Map<string, ElementState>();\n\n  root: RootElement;\n\n  revId = 0;\n\n  width = 0;\n  height = 0;\n  scale = 1;\n  scrollLeft = 0;\n  scrollTop = 0;\n  style: CSSProperties = {};\n  data?: PanelData;\n  selecto?: Selecto;\n  moveable?: Moveable;\n  infiniteViewer?: InfiniteViewer;\n  div?: HTMLDivElement;\n  viewerDiv?: HTMLDivElement;\n  viewportDiv?: HTMLDivElement;\n  connections: Connections | Connections2;\n  currentLayer?: FrameState;\n  isEditingEnabled?: boolean;\n  shouldShowAdvancedTypes?: boolean;\n  shouldPanZoom?: boolean;\n  zoomToContent?: boolean;\n  tooltipMode?: TooltipDisplayMode;\n  tooltipDisableForOneClick?: boolean;\n  skipNextSelectionBroadcast = false;\n  ignoreDataUpdate = false;\n  panel: CanvasPanel;\n  contextMenuVisible?: boolean;\n  openContextMenu?: (position: AnchorPoint) => void;\n  contextMenuOnVisibilityChange = (visible: boolean) => {\n    this.contextMenuVisible = visible;\n  };\n\n  isPanelEditing = locationService.getSearchObject().editPanel !== undefined;\n\n  inlineEditingCallback?: () => void;\n  setBackgroundCallback?: (anchorPoint: AnchorPoint) => void;\n\n  tooltipCallback?: (tooltip: CanvasTooltipPayload | undefined) => void;\n  tooltipPayload?: CanvasTooltipPayload;\n\n  moveableActionCallback?: (moved: boolean) => void;\n\n  actionConfirmationCallback?: () => void;\n\n  readonly editModeEnabled = new BehaviorSubject<boolean>(false);\n  subscription: Subscription;\n\n  targetsToSelect = new Set<HTMLDivElement>();\n\n  constructor(\n    options: Options,\n    public onSave: (cfg: CanvasFrameOptions) => void,\n    panel: CanvasPanel\n  ) {\n    // TODO: Will need to update this approach for dashboard scenes\n    // migration (new dashboard edit experience)\n    const dashboard = getDashboardSrv().getCurrent();\n    const enableEditing = options.inlineEditing && dashboard?.editable;\n\n    this.root = this.load(options, enableEditing);\n\n    this.subscription = this.editModeEnabled.subscribe((open) => {\n      if (!this.moveable || !this.isEditingEnabled) {\n        return;\n      }\n      this.moveable.draggable = !open;\n    });\n\n    this.panel = panel;\n    this.connections = config.featureToggles.canvasPanelPanZoom ? new Connections2(this) : new Connections(this);\n  }\n\n  getNextElementName = (isFrame = false) => {\n    const label = isFrame ? 'Frame' : 'Element';\n    let idx = this.byName.size + 1;\n\n    const max = idx + 100;\n    while (true && idx < max) {\n      const name = `${label} ${idx++}`;\n      if (!this.byName.has(name)) {\n        return name;\n      }\n    }\n\n    return `${label} ${Date.now()}`;\n  };\n\n  canRename = (v: string) => {\n    return !this.byName.has(v);\n  };\n\n  load(options: Options, enableEditing: boolean) {\n    const { root, showAdvancedTypes, panZoom, zoomToContent, tooltip } = options;\n    const tooltipMode = tooltip?.mode ?? TooltipDisplayMode.Single;\n    const tooltipDisableForOneClick = tooltip?.disableForOneClick ?? false;\n\n    this.root = new RootElement(\n      root ?? {\n        type: 'frame',\n        elements: [DEFAULT_CANVAS_ELEMENT_CONFIG],\n      },\n      this,\n      this.save // callback when changes are made\n    );\n\n    this.isEditingEnabled = enableEditing;\n    this.shouldShowAdvancedTypes = showAdvancedTypes;\n    this.shouldPanZoom = panZoom;\n    this.zoomToContent = zoomToContent;\n    this.tooltipMode = tooltipMode;\n    this.tooltipDisableForOneClick = tooltipDisableForOneClick;\n\n    setTimeout(() => {\n      if (config.featureToggles.canvasPanelPanZoom) {\n        if (this.viewportDiv && this.viewerDiv) {\n          if (!this.shouldPanZoom) {\n            this.scale = 1;\n            this.scrollLeft = 0;\n            this.scrollTop = 0;\n          }\n\n          // If editing is enabled, clear selecto instance\n          const destroySelecto = enableEditing;\n          initMoveable(destroySelecto, enableEditing, this);\n          this.currentLayer = this.root;\n          this.selection.next([]);\n          this.connections.select(undefined);\n          this.connections.updateState();\n          // update initial connections svg size\n          this.updateConnectionsSize();\n          this.fitContent(this, zoomToContent);\n        }\n      } else {\n        if (this.div) {\n          // If editing is enabled, clear selecto instance\n          const destroySelecto = enableEditing;\n          initMoveable(destroySelecto, enableEditing, this);\n          this.currentLayer = this.root;\n          this.selection.next([]);\n          this.connections.select(undefined);\n          this.connections.updateState();\n        }\n      }\n    });\n    return this.root;\n  }\n\n  context: DimensionContext = {\n    getColor: (color: ColorDimensionConfig) => getColorDimensionFromData(this.data, color),\n    getScale: (scale: ScaleDimensionConfig) => getScaleDimensionFromData(this.data, scale),\n    getScalar: (scalar: ScalarDimensionConfig) => getScalarDimensionFromData(this.data, scalar),\n    getText: (text: TextDimensionConfig) => getTextDimensionFromData(this.data, text),\n    getResource: (res: ResourceDimensionConfig) => getResourceDimensionFromData(this.data, res),\n    getDirection: (direction: DirectionDimensionConfig) => getDirectionDimensionFromData(this.data, direction),\n    getPanelData: () => this.data,\n  };\n\n  updateData(data: PanelData) {\n    this.data = data;\n    this.root.updateData(this.context);\n  }\n\n  updateSize(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n    this.style = { width, height };\n\n    if (config.featureToggles.canvasPanelPanZoom) {\n      this.updateConnectionsSize();\n      this.fitContent(this, this.zoomToContent!);\n\n      // TODO: This is a workaround to apply styles to the elements after the size update.\n      // It's a good to go approach used by movable creator, but maybe we can find a better way.\n      this.root.elements.forEach((el) => {\n        el.applyLayoutStylesToDiv(false);\n      });\n      // TODO: This is a workaround to apply styles to the elements after the size update.\n      // Remove this after dealing with the connection anchors stacking context issue.\n      if (this.connections.connectionAnchorDiv) {\n        this.connections.connectionAnchorDiv.style.display = 'none';\n      }\n    }\n  }\n\n  updateConnectionsSize() {\n    const svgConnections = this.connections.connectionsSVG;\n\n    if (svgConnections) {\n      const scale = this.infiniteViewer!.getZoom();\n      // NOTE: sometimes getScrollLeft and getScrollTop return NaN,\n      // so we use || 0 to ensure we have a valid number\n      const left = this.infiniteViewer!.getScrollLeft() || 0;\n      const top = this.infiniteViewer!.getScrollTop() || 0;\n      const width = this.width;\n      const height = this.height;\n\n      svgConnections.style.left = `${left}px`;\n      svgConnections.style.top = `${top}px`;\n      svgConnections.style.width = `${width / scale}px`;\n      svgConnections.style.height = `${height / scale}px`;\n\n      svgConnections.setAttribute('viewBox', `${left} ${top} ${width / scale} ${height / scale}`);\n    }\n  }\n\n  clearCurrentSelection(skipNextSelectionBroadcast = false) {\n    this.skipNextSelectionBroadcast = skipNextSelectionBroadcast;\n    let event: MouseEvent = new MouseEvent('click');\n    if (config.featureToggles.canvasPanelPanZoom) {\n      this.selecto?.clickTarget(event, this.viewportDiv);\n    } else {\n      this.selecto?.clickTarget(event, this.div);\n    }\n  }\n\n  save = (updateMoveable = false) => {\n    this.onSave(this.root.getSaveModel());\n\n    if (updateMoveable) {\n      setTimeout(() => {\n        if (config.featureToggles.canvasPanelPanZoom) {\n          if (this.viewportDiv && this.viewerDiv) {\n            initMoveable(true, this.isEditingEnabled, this);\n            this.updateConnectionsSize();\n          }\n        } else {\n          if (this.div) {\n            initMoveable(true, this.isEditingEnabled, this);\n          }\n        }\n      });\n    }\n  };\n\n  setNonTargetPointerEvents = (target: Element, disablePointerEvents: boolean) => {\n    const stack = [...this.root.elements];\n    while (stack.length > 0) {\n      const currentElement = stack.shift();\n\n      if (currentElement && currentElement.div && currentElement.div !== target) {\n        currentElement.applyLayoutStylesToDiv(disablePointerEvents);\n      }\n\n      const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n      for (const nestedElement of nestedElements) {\n        stack.unshift(nestedElement);\n      }\n    }\n  };\n\n  setRef = (sceneContainer: HTMLDivElement) => {\n    this.div = sceneContainer;\n  };\n\n  setViewerRef = (viewerContainer: HTMLDivElement) => {\n    this.viewerDiv = viewerContainer;\n  };\n\n  setViewportRef = (viewportContainer: HTMLDivElement) => {\n    this.viewportDiv = viewportContainer;\n  };\n\n  select = (selection: SelectionParams) => {\n    if (this.selecto) {\n      this.selecto.setSelectedTargets(selection.targets);\n      this.updateSelection(selection);\n      this.editModeEnabled.next(false);\n\n      // Hide connection anchors on programmatic select\n      if (this.connections.connectionAnchorDiv) {\n        this.connections.connectionAnchorDiv.style.display = 'none';\n      }\n    }\n  };\n\n  updateSelection = (selection: SelectionParams) => {\n    this.moveable!.target = selection.targets;\n    if (this.skipNextSelectionBroadcast) {\n      this.skipNextSelectionBroadcast = false;\n      return;\n    }\n\n    if (selection.frame) {\n      this.selection.next([selection.frame]);\n    } else {\n      const s = selection.targets.map((t) => findElementByTarget(t, this.root.elements)!);\n      this.selection.next(s);\n    }\n  };\n\n  addToSelection = () => {\n    try {\n      let selection: SelectionParams = { targets: [] };\n      selection.targets = [...this.targetsToSelect];\n      this.select(selection);\n    } catch (error) {\n      appEvents.emit(AppEvents.alertError, ['Unable to add to selection']);\n    }\n  };\n\n  fitContent = (scene: Scene, zoomToContent: boolean) => {\n    const { root, viewerDiv, infiniteViewer } = scene;\n    if (zoomToContent && root.div && infiniteViewer && viewerDiv) {\n      const dimentions = calculateZoomToFitScale(Array.from(root.div.children), viewerDiv);\n      const { scale, centerX, centerY } = dimentions;\n      infiniteViewer.setZoom(scale);\n      infiniteViewer.scrollTo(centerX, centerY);\n    }\n  };\n\n  render() {\n    const hasDataLinks = this.tooltipPayload?.element?.getLinks && this.tooltipPayload.element.getLinks({}).length > 0;\n    const hasActions =\n      this.tooltipPayload?.element?.options.actions &&\n      this.tooltipPayload.element.options.actions.filter(\n        (action) => action.type === ActionType.Fetch || isInfinityActionWithAuth(action)\n      ).length > 0;\n\n    const isTooltipValid = hasDataLinks || hasActions || this.tooltipPayload?.element?.data?.field;\n    const isCanvasTooltipEnabled = this.tooltipMode !== TooltipDisplayMode.None;\n\n    const isTooltipDisabledForOneClick =\n      this.tooltipDisableForOneClick && this.tooltipPayload?.element?.oneClickMode !== OneClickMode.Off;\n    const shouldShowElementTooltip =\n      !this.isEditingEnabled && isTooltipValid && isCanvasTooltipEnabled && !isTooltipDisabledForOneClick;\n\n    const sceneDiv = (\n      <>\n        {this.connections.render()}\n        {this.root.render()}\n        {this.isEditingEnabled && (\n          <Portal>\n            <CanvasContextMenu\n              scene={this}\n              panel={this.panel}\n              onVisibilityChange={this.contextMenuOnVisibilityChange}\n            />\n          </Portal>\n        )}\n        {shouldShowElementTooltip && (\n          <Portal>\n            <CanvasTooltip scene={this} />\n          </Portal>\n        )}\n      </>\n    );\n\n    return config.featureToggles.canvasPanelPanZoom ? (\n      <div className={this.styles.viewer} ref={this.setViewerRef} key={this.revId} data-testid=\"canvas-scene-wrapper\">\n        <div\n          className={this.styles.viewport}\n          ref={this.setViewportRef}\n          key={this.revId}\n          data-testid=\"canvas-scene-pan-zoom\"\n        >\n          {sceneDiv}\n        </div>\n      </div>\n    ) : (\n      <div\n        key={this.revId}\n        className={this.styles.wrap}\n        style={this.style}\n        ref={this.setRef}\n        data-testid=\"canvas-scene\"\n      >\n        {sceneDiv}\n      </div>\n    );\n  }\n}\n\nconst getStyles = () => ({\n  wrap: css({\n    overflow: 'hidden',\n    position: 'relative',\n  }),\n  selected: css({\n    zIndex: '999 !important',\n  }),\n  viewer: css({\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n  }),\n  viewport: css({\n    width: '100%',\n    height: '100%',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { ResourceDimensionMode } from '@grafana/schema';\nimport { Portal, useTheme2 } from '@grafana/ui';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { ResourcePickerPopover } from 'app/features/dimensions/editors/ResourcePickerPopover';\nimport { MediaType, ResourceFolderName } from 'app/features/dimensions/types';\n\nimport { AnchorPoint } from '../types';\n\ntype Props = {\n  onClose: () => void;\n  scene: Scene;\n  anchorPoint: AnchorPoint;\n};\n\nexport function SetBackground({ onClose, scene, anchorPoint }: Props) {\n  const defaultValue = scene.root.options.background?.image?.fixed ?? '';\n\n  const [bgImage, setBgImage] = useState(defaultValue);\n  const theme = useTheme2();\n  const styles = getStyles(theme, anchorPoint);\n\n  const onChange = (value: string | undefined) => {\n    if (value) {\n      setBgImage(value);\n      if (scene.root) {\n        scene.root.options.background = {\n          ...scene.root.options.background,\n          image: { mode: ResourceDimensionMode.Fixed, fixed: value },\n        };\n        scene.revId++;\n        scene.save();\n\n        scene.root.reinitializeMoveable();\n      }\n\n      // Force a re-render (update scene data after config update)\n      if (scene) {\n        scene.updateData(scene.data!);\n      }\n    }\n\n    onClose();\n  };\n\n  return (\n    <Portal className={styles.portalWrapper}>\n      <ResourcePickerPopover\n        onChange={onChange}\n        value={bgImage}\n        mediaType={MediaType.Image}\n        folderName={ResourceFolderName.IOT}\n      />\n    </Portal>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2, anchorPoint: AnchorPoint) => ({\n  portalWrapper: css({\n    width: '315px',\n    height: '445px',\n    transform: `translate(${anchorPoint.x}px, ${anchorPoint.y - 200}px)`,\n  }),\n});\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { InlineField, InlineFieldRow, RadioButtonGroup } from '@grafana/ui';\nimport { BackgroundImageSize } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nexport const BackgroundSizeEditor = ({ value, onChange }: StandardEditorProps<string, undefined, undefined>) => {\n  const options: Array<SelectableValue<BackgroundImageSize>> = [\n    {\n      value: BackgroundImageSize.Original,\n      label: t('dimensions.background-size-editor.options.label-original', 'Original'),\n    },\n    {\n      value: BackgroundImageSize.Contain,\n      label: t('dimensions.background-size-editor.options.label-contain', 'Contain'),\n    },\n    { value: BackgroundImageSize.Cover, label: t('dimensions.background-size-editor.options.label-cover', 'Cover') },\n    { value: BackgroundImageSize.Fill, label: t('dimensions.background-size-editor.options.label-fill', 'Fill') },\n    { value: BackgroundImageSize.Tile, label: t('dimensions.background-size-editor.options.label-tile', 'Tile') },\n  ];\n  const imageSize = value ?? BackgroundImageSize.Cover;\n\n  const onImageSizeChange = useCallback(\n    (size: string) => {\n      onChange(size);\n    },\n    [onChange]\n  );\n\n  return (\n    <InlineFieldRow>\n      <InlineField grow={true}>\n        <RadioButtonGroup value={imageSize} options={options} onChange={onImageSizeChange} fullWidth />\n      </InlineField>\n    </InlineFieldRow>\n  );\n};\n","import { useCallback } from 'react';\n\nimport {\n  FieldNamePickerConfigSettings,\n  SelectableValue,\n  StandardEditorProps,\n  StandardEditorsRegistryItem,\n} from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { DirectionDimensionMode, DirectionDimensionConfig, ConnectionDirection } from '@grafana/schema';\nimport { InlineField, InlineFieldRow, RadioButtonGroup, Select } from '@grafana/ui';\nimport { FieldNamePicker } from '@grafana/ui/internal';\n\nimport { DirectionDimensionOptions } from '../types';\n\n// eslint-disable-next-line @typescript-eslint/consistent-type-assertions\nconst dummyFieldSettings = {\n  settings: {},\n} as StandardEditorsRegistryItem<string, FieldNamePickerConfigSettings>;\n\ntype Props = StandardEditorProps<DirectionDimensionConfig, DirectionDimensionOptions>;\n\nexport const DirectionDimensionEditor = ({ value, context, onChange }: Props) => {\n  const directionOptions = [\n    {\n      label: t('dimensions.direction-dimension-editor.label-fixed', 'Fixed'),\n      value: DirectionDimensionMode.Fixed,\n      description: t('dimensions.direction-dimension-editor.description-fixed', 'Fixed direction value'),\n    },\n    {\n      label: t('dimensions.direction-dimension-editor.label-field', 'Field'),\n      value: DirectionDimensionMode.Field,\n      description: t('dimensions.direction-dimension-editor.description-field', 'Direction based on field value'),\n    },\n  ];\n\n  const fixedDirectionOptions: Array<SelectableValue<ConnectionDirection>> = [\n    { value: ConnectionDirection.Forward, label: t('canvas.connection.direction-options.label-forward', 'Forward') },\n    { value: ConnectionDirection.Reverse, label: t('canvas.connection.direction-options.label-reverse', 'Reverse') },\n    { value: ConnectionDirection.Both, label: t('canvas.connection.direction-options.label-both', 'Both') },\n    { value: ConnectionDirection.None, label: t('canvas.connection.direction-options.label-none', 'None') },\n  ];\n\n  const labelWidth = 9;\n\n  const onModeChange = useCallback(\n    (mode: DirectionDimensionMode) => {\n      onChange({\n        ...value,\n        mode,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onFieldChange = useCallback(\n    (field?: string) => {\n      onChange({\n        ...value,\n        field,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onFixedChange = useCallback(\n    (selection: SelectableValue<ConnectionDirection>) => {\n      onChange({\n        ...value,\n        field: undefined,\n        fixed: selection.value ?? ConnectionDirection.Forward,\n      });\n    },\n    [onChange, value]\n  );\n\n  const mode = value?.mode ?? DirectionDimensionMode.Fixed;\n  const selectedDirection = fixedDirectionOptions.find((opt) => opt.value === value?.fixed) || fixedDirectionOptions[0];\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField\n          label={t('dimensions.direction-dimension-editor.label-source', 'Source')}\n          labelWidth={labelWidth}\n          grow={true}\n        >\n          <RadioButtonGroup value={mode} options={directionOptions} onChange={onModeChange} fullWidth />\n        </InlineField>\n      </InlineFieldRow>\n\n      {mode === DirectionDimensionMode.Field && (\n        <InlineFieldRow>\n          <InlineField\n            label={t('dimensions.direction-dimension-editor.label-field', 'Field')}\n            labelWidth={labelWidth}\n            grow={true}\n          >\n            <FieldNamePicker\n              context={context}\n              value={value?.field ?? ''}\n              onChange={onFieldChange}\n              item={dummyFieldSettings}\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n\n      {mode === DirectionDimensionMode.Fixed && (\n        <InlineFieldRow>\n          <InlineField\n            label={t('dimensions.direction-dimension-editor.label-direction', 'Direction')}\n            labelWidth={labelWidth}\n            grow={true}\n          >\n            <Select value={selectedDirection} options={fixedDirectionOptions} onChange={onFixedChange} />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n    </>\n  );\n};\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { Field, RadioButtonGroup, Switch } from '@grafana/ui';\n\nimport { LineStyle } from '../types';\n\nconst options: Array<SelectableValue<LineStyle>> = [\n  { value: LineStyle.Solid, label: 'Solid' },\n  { value: LineStyle.Dashed, label: 'Dashed' },\n  { value: LineStyle.Dotted, label: 'Dotted' },\n];\n\nexport interface LineStyleConfig {\n  style: LineStyle;\n  animate?: boolean;\n}\n\ntype Props = StandardEditorProps<LineStyleConfig>;\n\nexport const defaultLineStyleConfig: LineStyleConfig = {\n  style: LineStyle.Solid,\n  animate: false,\n};\n\nexport const LineStyleEditor = ({ value, onChange }: Props) => {\n  if (!value) {\n    value = defaultLineStyleConfig;\n  } else if (typeof value !== 'object') {\n    value = {\n      style: value,\n      animate: false,\n    };\n  }\n\n  const onLineStyleChange = useCallback(\n    (lineStyle: LineStyle) => {\n      onChange({ ...value, style: lineStyle });\n    },\n    [onChange, value]\n  );\n\n  const onAnimateChange = useCallback(\n    (animate: boolean) => {\n      onChange({ ...value, animate });\n    },\n    [onChange, value]\n  );\n\n  return (\n    <>\n      <RadioButtonGroup value={value.style} options={options} onChange={onLineStyleChange} fullWidth />\n      {value.style !== LineStyle.Solid && (\n        <>\n          <br />\n          <Field label={t('canvas.line-style-editor.label-animate', 'Animate')}>\n            <Switch value={value.animate} onChange={(e) => onAnimateChange(e.currentTarget.checked)} />\n          </Field>\n        </>\n      )}\n    </>\n  );\n};\n","import { StandardEditorProps, Action, VariableSuggestionsScope } from '@grafana/data';\nimport { ActionsInlineEditor } from 'app/features/actions/ActionsInlineEditor';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\n\ntype Props = StandardEditorProps<Action[], CanvasElementOptions>;\n\nexport function ActionsEditor({ value, onChange, item, context }: Props) {\n  const dataLinks = item.settings?.links || [];\n\n  return (\n    <ActionsInlineEditor\n      actions={value}\n      onChange={(actions) => {\n        if (actions.some(({ oneClick }) => oneClick === true)) {\n          dataLinks.forEach((link) => {\n            link.oneClick = false;\n          });\n        }\n        onChange(actions);\n      }}\n      getSuggestions={() => (context.getSuggestions ? context.getSuggestions(VariableSuggestionsScope.Values) : [])}\n      data={[]}\n      showOneClick={true}\n    />\n  );\n}\n","import { StandardEditorProps, DataLink, VariableSuggestionsScope } from '@grafana/data';\nimport { DataLinksInlineEditor } from '@grafana/ui';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\n\ntype Props = StandardEditorProps<DataLink[], CanvasElementOptions>;\n\nexport function DataLinksEditor({ value, onChange, item, context }: Props) {\n  const actions = item.settings?.actions || [];\n\n  return (\n    <DataLinksInlineEditor\n      links={value}\n      onChange={(links) => {\n        if (links.some(({ oneClick }) => oneClick === true)) {\n          actions.forEach((action) => {\n            action.oneClick = false;\n          });\n        }\n        onChange(links);\n      }}\n      getSuggestions={() => (context.getSuggestions ? context.getSuggestions(VariableSuggestionsScope.Values) : [])}\n      data={[]}\n      showOneClick={true}\n    />\n  );\n}\n","import { FieldType } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/internal';\nimport { t } from '@grafana/i18n';\nimport { ConnectionDirection, DirectionDimensionMode } from '@grafana/schema';\nimport { SVGElements } from 'app/features/canvas/runtime/element';\nimport { BackgroundSizeEditor } from 'app/features/dimensions/editors/BackgroundSizeEditor';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { DirectionDimensionEditor } from 'app/features/dimensions/editors/DirectionDimensionEditor';\nimport { ResourceDimensionEditor } from 'app/features/dimensions/editors/ResourceDimensionEditor';\nimport { ScaleDimensionEditor } from 'app/features/dimensions/editors/ScaleDimensionEditor';\n\nimport { CanvasConnection, CanvasElementOptions } from '../panelcfg.gen';\nimport { LineStyle } from '../types';\n\nimport { LineStyleEditor } from './LineStyleEditor';\nimport { ActionsEditor } from './element/ActionsEditor';\nimport { DataLinksEditor } from './element/DataLinksEditor';\n\ninterface OptionSuppliers {\n  addBackground: PanelOptionsSupplier<CanvasElementOptions>;\n  addBorder: PanelOptionsSupplier<CanvasElementOptions>;\n  addDataLinks: PanelOptionsSupplier<CanvasElementOptions>;\n  addActions: PanelOptionsSupplier<CanvasElementOptions>;\n  addColor: PanelOptionsSupplier<CanvasConnection>;\n  addSize: PanelOptionsSupplier<CanvasConnection>;\n  addRadius: PanelOptionsSupplier<CanvasConnection>;\n  addDirection: PanelOptionsSupplier<CanvasConnection>;\n  addLineStyle: PanelOptionsSupplier<CanvasConnection>;\n}\n\nconst getCategoryName = (str: string, type: string | undefined) => {\n  if (type !== 'frame' && type !== undefined) {\n    return [str + ` (${type})`];\n  }\n  return [str];\n};\n\nexport const optionBuilder: OptionSuppliers = {\n  addBackground: (builder, context) => {\n    const category = getCategoryName(t('canvas.category-background', 'Background'), context.options?.type);\n    builder\n      .addCustomEditor({\n        category,\n        id: 'background.color',\n        path: 'background.color',\n        name: t('canvas.label-color', 'Color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: '',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'background.image',\n        path: 'background.image',\n        name: t('canvas.label-image', 'Image'),\n        editor: ResourceDimensionEditor,\n        settings: {\n          resourceType: 'image',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'background.size',\n        path: 'background.size',\n        name: t('canvas.label-image-size', 'Image size'),\n        editor: BackgroundSizeEditor,\n        settings: {\n          resourceType: 'image',\n        },\n        showIf: () => {\n          // Do not show image size editor for SVG based elements\n          // See https://github.com/grafana/grafana/issues/84843#issuecomment-2010921066 for additional context\n          if (context.options?.type) {\n            return !SVGElements.has(context.options.type);\n          }\n\n          return true;\n        },\n      });\n  },\n\n  addBorder: (builder, context) => {\n    const category = getCategoryName(t('canvas.category-border', 'Border'), context.options?.type);\n    builder.addSliderInput({\n      category,\n      path: 'border.width',\n      name: t('canvas.label-width', 'Width'),\n      defaultValue: 2,\n      settings: {\n        min: 0,\n        max: 20,\n      },\n    });\n\n    if (context.options?.border?.width) {\n      builder.addCustomEditor({\n        category,\n        id: 'border.color',\n        path: 'border.color',\n        name: t('canvas.label-color', 'Color'),\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: '',\n        },\n      });\n    }\n\n    builder.addSliderInput({\n      category,\n      path: 'border.radius',\n      name: t('canvas.label-radius', 'Radius'),\n      defaultValue: 0,\n      settings: {\n        min: 0,\n        max: 60,\n      },\n    });\n  },\n\n  addColor: (builder, context) => {\n    const category = [t('canvas.category-color', 'Color')];\n    builder.addCustomEditor({\n      category,\n      id: 'color',\n      path: 'color',\n      name: t('canvas.label-color', 'Color'),\n      editor: ColorDimensionEditor,\n      settings: {},\n      defaultValue: {\n        // Configured values\n        fixed: '',\n      },\n    });\n  },\n\n  addSize: (builder, context) => {\n    const category = [t('canvas.category-size', 'Size')];\n    builder.addCustomEditor({\n      category,\n      id: 'size',\n      path: 'size',\n      name: t('canvas.label-size', 'Size'),\n      editor: ScaleDimensionEditor,\n      settings: {\n        min: 1,\n        max: 10,\n      },\n      defaultValue: {\n        // Configured values\n        fixed: 2,\n        min: 1,\n        max: 10,\n      },\n    });\n  },\n\n  addRadius: (builder, context) => {\n    const category = [t('canvas.category-radius', 'Radius')];\n    builder.addCustomEditor({\n      category,\n      id: 'radius',\n      path: 'radius',\n      name: t('canvas.label-radius', 'Radius'),\n      editor: ScaleDimensionEditor,\n      settings: {\n        min: 0,\n        max: 200,\n        filteredFieldType: FieldType.number,\n      },\n      defaultValue: {\n        // Configured values\n        fixed: 0,\n        min: 0,\n        max: 100,\n      },\n    });\n  },\n\n  addDirection: (builder, context) => {\n    const category = [t('canvas.category-arrow-direction', 'Direction')];\n    builder.addCustomEditor({\n      category,\n      id: 'direction',\n      path: 'direction',\n      name: t('canvas.label-direction', 'Direction'),\n      editor: DirectionDimensionEditor,\n      settings: {},\n      defaultValue: {\n        mode: DirectionDimensionMode.Fixed,\n        fixed: ConnectionDirection.Forward,\n      },\n    });\n  },\n\n  addLineStyle: (builder, context) => {\n    const category = [t('canvas.category-line-style', 'Line style')];\n    builder.addCustomEditor({\n      category,\n      id: 'lineStyle',\n      path: 'lineStyle',\n      name: t('canvas.label-line-style', 'Line style'),\n      editor: LineStyleEditor,\n      settings: {},\n      defaultValue: { value: LineStyle.Solid, label: t('canvas.line-style-options.label-solid', 'Solid') },\n    });\n  },\n\n  addDataLinks: (builder, context) => {\n    builder.addCustomEditor({\n      category: [t('canvas.category-data-links', 'Data links and actions')],\n      id: 'dataLinks',\n      path: 'links',\n      name: t('canvas.label-links', 'Links'),\n      editor: DataLinksEditor,\n      settings: context.options,\n    });\n  },\n\n  addActions: (builder, context) => {\n    builder.addCustomEditor({\n      category: [t('canvas.category-data-links', 'Data links and actions')],\n      id: 'actions',\n      path: 'actions',\n      name: t('canvas.label-actions', 'Actions'),\n      editor: ActionsEditor,\n      settings: context.options,\n    });\n  },\n};\n","import { get as lodashGet } from 'lodash';\n\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/internal';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { CanvasConnection } from '../panelcfg.gen';\nimport { ConnectionState } from '../types';\n\nimport { optionBuilder } from './options';\n\nexport interface CanvasConnectionEditorOptions {\n  connection: ConnectionState;\n  scene: Scene;\n  category?: string[];\n}\n\nexport function getConnectionEditor(opts: CanvasConnectionEditorOptions): NestedPanelOptions<CanvasConnection> {\n  return {\n    category: opts.category,\n    path: '--', // not used!\n\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path: string) => {\n        return lodashGet(opts.connection.info, path);\n      },\n      // TODO: Fix this unknown (maybe a dimension supplier?)\n      onChange: (path: string, value: unknown) => {\n        let options = opts.connection.info;\n        options = setOptionImmutably(options, path, value);\n        opts.scene.connections.onChange(opts.connection, options);\n      },\n    }),\n\n    build: (builder, context) => {\n      const ctx = { ...context, options: opts.connection.info };\n      optionBuilder.addColor(builder, ctx);\n      optionBuilder.addSize(builder, ctx);\n      optionBuilder.addRadius(builder, ctx);\n      optionBuilder.addDirection(builder, ctx);\n      optionBuilder.addLineStyle(builder, ctx);\n    },\n  };\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { VerticalConstraint, HorizontalConstraint, Constraint } from '../../panelcfg.gen';\n\ninterface Props {\n  onVerticalConstraintChange: (v: VerticalConstraint) => void;\n  onHorizontalConstraintChange: (h: HorizontalConstraint) => void;\n  currentConstraints: Constraint;\n}\n\nexport const ConstraintSelectionBox = ({\n  onVerticalConstraintChange,\n  onHorizontalConstraintChange,\n  currentConstraints,\n}: Props) => {\n  const styles = useStyles2(getStyles(currentConstraints));\n\n  const onClickTopConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Top);\n  };\n\n  const onClickBottomConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Bottom);\n  };\n\n  const onClickVerticalCenterConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Center);\n  };\n\n  const onClickLeftConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Left);\n  };\n\n  const onClickRightConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Right);\n  };\n\n  const onClickHorizontalCenterConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Center);\n  };\n\n  return (\n    <svg\n      version=\"1.0\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"75.000000pt\"\n      height=\"75.000000pt\"\n      viewBox=\"0 0 228.000000 228.000000\"\n      preserveAspectRatio=\"xMidYMid meet\"\n      style={{ marginBottom: '4.8px' }}\n    >\n      <g transform=\"translate(0.000000,228.000000) scale(0.100000,-0.100000)\" fill=\"#000000\" stroke=\"none\">\n        <path\n          fill=\"#e5e5e5\"\n          d=\"M198 2028 l-28 -32 0 -912 0 -912 31 -31 31 -31 915 0 915 0 29 29\n29 29 0 917 0 917 -27 29 -28 29 -920 0 -920 0 -27 -32z m1876 -17 c15 -16 16\n-98 16 -927 0 -860 -1 -909 -18 -926 -17 -17 -66 -18 -927 -18 -862 0 -910 1\n-927 18 -17 17 -18 65 -18 926 0 832 1 911 16 927 16 18 45 19 468 21 248 2\n659 2 912 0 431 -2 462 -4 478 -21z\"\n        />\n        <rect className={styles.topConstraint} height=\"228\" width=\"46\" y=\"1735\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickTopConstraint}\n          height=\"350\"\n          width=\"300\"\n          y=\"1680\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.bottomConstraint} height=\"228\" width=\"46\" y=\"210\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickBottomConstraint}\n          height=\"350\"\n          width=\"300\"\n          y=\"135\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.leftConstraint} height=\"46\" width=\"228\" y=\"1060\" x=\"265\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickLeftConstraint}\n          height=\"300\"\n          width=\"350\"\n          y=\"925\"\n          x=\"200\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.rightConstraint} height=\"46\" width=\"228\" y=\"1060\" x=\"1795\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickRightConstraint}\n          height=\"300\"\n          width=\"350\"\n          y=\"925\"\n          x=\"1730\"\n          fill=\"transparent\"\n        />\n        <path\n          className={styles.box}\n          d=\"M568 1669 c-17 -9 -18 -48 -18 -584 0 -558 1 -575 19 -585 27 -14\n1125 -14 1152 0 18 10 19 27 19 580 0 504 -2 570 -16 584 -14 14 -80 16 -577\n16 -363 -1 -568 -4 -579 -11z m1119 -42 c4 -5 4 -1079 0 -1084 -5 -4 -1079 -4\n-1084 0 -5 6 -4 1077 1 1085 4 7 1076 6 1083 -1z\"\n        />\n        <rect className={styles.verticalCenterConstraint} height=\"456\" width=\"46\" y=\"855\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickVerticalCenterConstraint}\n          height=\"660\"\n          width=\"300\"\n          y=\"750\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.horizontalCenterConstraint} height=\"46\" width=\"456\" y=\"1060\" x=\"918\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickHorizontalCenterConstraint}\n          height=\"300\"\n          width=\"660\"\n          y=\"925\"\n          x=\"815\"\n          fill=\"transparent\"\n        />\n      </g>\n    </svg>\n  );\n};\n\nconst getStyles = (currentConstraints: Constraint) => (theme: GrafanaTheme2) => {\n  const HOVER_COLOR = '#daebf7';\n  const HOVER_OPACITY = '0.6';\n  const SELECTED_COLOR = '#0d99ff';\n\n  const selectionBoxColor = theme.isDark ? '#ffffff' : '#000000';\n\n  return {\n    constraintHover: css({\n      '&:hover': {\n        fill: HOVER_COLOR,\n        fillOpacity: HOVER_OPACITY,\n      },\n    }),\n    topConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Top ||\n      currentConstraints.vertical === VerticalConstraint.TopBottom\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    bottomConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Bottom ||\n      currentConstraints.vertical === VerticalConstraint.TopBottom\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    leftConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Left ||\n      currentConstraints.horizontal === HorizontalConstraint.LeftRight\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    rightConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Right ||\n      currentConstraints.horizontal === HorizontalConstraint.LeftRight\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    horizontalCenterConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Center\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    verticalCenterConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Center\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    box: css({\n      fill: selectionBoxColor,\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { IconButton, useStyles2 } from '@grafana/ui';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { QuickPlacement } from 'app/features/canvas/types';\n\nimport { HorizontalConstraint, VerticalConstraint, Placement } from '../../panelcfg.gen';\n\nimport { CanvasEditorOptions } from './elementEditor';\n\ntype Props = {\n  onPositionChange: (value: number | undefined, placement: keyof Placement) => void;\n  element: ElementState;\n  settings: CanvasEditorOptions;\n};\n\nexport const QuickPositioning = ({ onPositionChange, element, settings }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const onQuickPositioningChange = (position: QuickPlacement) => {\n    const defaultConstraint = { vertical: VerticalConstraint.Top, horizontal: HorizontalConstraint.Left };\n    const originalConstraint = { ...element.options.constraint };\n\n    element.options.constraint = defaultConstraint;\n    element.setPlacementFromConstraint();\n\n    switch (position) {\n      case QuickPlacement.Top:\n        onPositionChange(0, 'top');\n        break;\n      case QuickPlacement.Bottom:\n        onPositionChange(getRightBottomPosition(element.options.placement?.height ?? 0, 'bottom'), 'top');\n        break;\n      case QuickPlacement.VerticalCenter:\n        onPositionChange(getCenterPosition(element.options.placement?.height ?? 0, 'v'), 'top');\n        break;\n      case QuickPlacement.Left:\n        onPositionChange(0, 'left');\n        break;\n      case QuickPlacement.Right:\n        onPositionChange(getRightBottomPosition(element.options.placement?.width ?? 0, 'right'), 'left');\n        break;\n      case QuickPlacement.HorizontalCenter:\n        onPositionChange(getCenterPosition(element.options.placement?.width ?? 0, 'h'), 'left');\n        break;\n    }\n\n    element.options.constraint = originalConstraint;\n    element.setPlacementFromConstraint();\n  };\n\n  // Basing this on scene will mean that center is based on root for the time being\n  const getCenterPosition = (elementSize: number, align: 'h' | 'v') => {\n    const sceneSize = align === 'h' ? settings.scene.width : settings.scene.height;\n\n    return (sceneSize - elementSize) / 2;\n  };\n\n  const getRightBottomPosition = (elementSize: number, align: 'right' | 'bottom') => {\n    const sceneSize = align === 'right' ? settings.scene.width : settings.scene.height;\n\n    return sceneSize - elementSize;\n  };\n\n  return (\n    <div className={styles.buttonGroup}>\n      <IconButton\n        name=\"horizontal-align-left\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Left)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip={t('canvas.quick-positioning.tooltip-align-left', 'Align left')}\n      />\n      <IconButton\n        name=\"horizontal-align-center\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.HorizontalCenter)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip={t('canvas.quick-positioning.tooltip-align-horizontal-centers', 'Align horizontal centers')}\n      />\n      <IconButton\n        name=\"horizontal-align-right\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Right)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip={t('canvas.quick-positioning.tooltip-align-right', 'Align right')}\n      />\n      <IconButton\n        name=\"vertical-align-top\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Top)}\n        size=\"lg\"\n        tooltip={t('canvas.quick-positioning.tooltip-align-top', 'Align top')}\n      />\n      <IconButton\n        name=\"vertical-align-center\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.VerticalCenter)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip={t('canvas.quick-positioning.tooltip-align-vertical-centers', 'Align vertical centers')}\n      />\n      <IconButton\n        name=\"vertical-align-bottom\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Bottom)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip={t('canvas.quick-positioning.tooltip-align-bottom', 'Align bottom')}\n      />\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  buttonGroup: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n    padding: '12px 0 12px 0',\n  }),\n  button: css({\n    marginLeft: '5px',\n    marginRight: '5px',\n  }),\n});\n","import { useObservable } from 'react-use';\nimport { Subject } from 'rxjs';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { Field, Icon, InlineField, InlineFieldRow, Select, Stack } from '@grafana/ui';\nimport { NumberInput } from 'app/core/components/OptionsUI/NumberInput';\n\nimport { HorizontalConstraint, Options, Placement, VerticalConstraint } from '../../panelcfg.gen';\n\nimport { ConstraintSelectionBox } from './ConstraintSelectionBox';\nimport { QuickPositioning } from './QuickPositioning';\nimport { CanvasEditorOptions } from './elementEditor';\n\nconst places: Array<keyof Placement> = ['top', 'left', 'bottom', 'right', 'width', 'height', 'rotation'];\n\ntype Props = StandardEditorProps<unknown, CanvasEditorOptions, Options>;\n\nexport function PlacementEditor({ item }: Props) {\n  const settings = item.settings;\n  const horizontalOptions: Array<SelectableValue<HorizontalConstraint>> = [\n    { label: t('canvas.placement-editor.horizontal-options.label-left', 'Left'), value: HorizontalConstraint.Left },\n    { label: t('canvas.placement-editor.horizontal-options.label-right', 'Right'), value: HorizontalConstraint.Right },\n    {\n      label: t('canvas.placement-editor.horizontal-options.label-left-and-right', 'Left & right'),\n      value: HorizontalConstraint.LeftRight,\n    },\n    {\n      label: t('canvas.placement-editor.horizontal-options.label-center', 'Center'),\n      value: HorizontalConstraint.Center,\n    },\n    { label: t('canvas.placement-editor.horizontal-options.label-scale', 'Scale'), value: HorizontalConstraint.Scale },\n  ];\n\n  const verticalOptions: Array<SelectableValue<VerticalConstraint>> = [\n    { label: t('canvas.placement-editor.vertical-options.label-top', 'Top'), value: VerticalConstraint.Top },\n    { label: t('canvas.placement-editor.vertical-options.label-bottom', 'Bottom'), value: VerticalConstraint.Bottom },\n    {\n      label: t('canvas.placement-editor.vertical-options.label-top-and-bottom', 'Top & bottom'),\n      value: VerticalConstraint.TopBottom,\n    },\n    { label: t('canvas.placement-editor.vertical-options.label-center', 'Center'), value: VerticalConstraint.Center },\n    { label: t('canvas.placement-editor.vertical-options.label-scale', 'Scale'), value: VerticalConstraint.Scale },\n  ];\n\n  // Will force a rerender whenever the subject changes\n  useObservable(settings?.scene ? settings.scene.moved : new Subject());\n\n  if (!settings) {\n    return (\n      <div>\n        <Trans i18nKey=\"canvas.placement-editor.loading\">Loading...</Trans>\n      </div>\n    );\n  }\n\n  const element = settings.element;\n  if (!element) {\n    return <div>???</div>;\n  }\n  const { options } = element;\n  const { placement, constraint: layout } = options;\n\n  if (placement) {\n    placement.rotation = placement?.rotation ?? 0;\n  }\n\n  const reselectElementAfterChange = () => {\n    setTimeout(() => {\n      settings.scene.select({ targets: [element.div!] });\n    });\n  };\n\n  const onHorizontalConstraintSelect = (h: SelectableValue<HorizontalConstraint>) => {\n    onHorizontalConstraintChange(h.value!);\n  };\n\n  const onHorizontalConstraintChange = (h: HorizontalConstraint) => {\n    element.options.constraint!.horizontal = h;\n    element.setPlacementFromConstraint(undefined, undefined, settings.scene.scale);\n    settings.scene.revId++;\n    settings.scene.save(true);\n    reselectElementAfterChange();\n  };\n\n  const onVerticalConstraintSelect = (v: SelectableValue<VerticalConstraint>) => {\n    onVerticalConstraintChange(v.value!);\n  };\n\n  const onVerticalConstraintChange = (v: VerticalConstraint) => {\n    element.options.constraint!.vertical = v;\n    element.setPlacementFromConstraint(undefined, undefined, settings.scene.scale);\n    settings.scene.revId++;\n    settings.scene.save(true);\n    reselectElementAfterChange();\n  };\n\n  const onPositionChange = (value: number | undefined, placement: keyof Placement) => {\n    element.options.placement![placement] = value ?? element.options.placement![placement];\n    element.applyLayoutStylesToDiv();\n    settings.scene.clearCurrentSelection(true);\n    reselectElementAfterChange();\n  };\n\n  const constraint = element.tempConstraint ?? layout ?? {};\n\n  return (\n    <div>\n      <QuickPositioning onPositionChange={onPositionChange} settings={settings} element={element} />\n      <br />\n      <Field label={t('canvas.placement-editor.label-constraints', 'Constraints')}>\n        <Stack direction=\"row\">\n          <ConstraintSelectionBox\n            onVerticalConstraintChange={onVerticalConstraintChange}\n            onHorizontalConstraintChange={onHorizontalConstraintChange}\n            currentConstraints={constraint}\n          />\n          <Stack direction=\"column\">\n            <Stack direction=\"row\">\n              <Icon name=\"arrows-h\" />\n              <Select\n                options={horizontalOptions}\n                onChange={onHorizontalConstraintSelect}\n                value={constraint.horizontal}\n              />\n            </Stack>\n            <Stack direction=\"row\">\n              <Icon name=\"arrows-v\" />\n              <Select options={verticalOptions} onChange={onVerticalConstraintSelect} value={constraint.vertical} />\n            </Stack>\n          </Stack>\n        </Stack>\n      </Field>\n\n      <br />\n\n      <Field label={t('canvas.placement-editor.label-position', 'Position')}>\n        <>\n          {places.map((p) => {\n            const v = placement![p];\n            if (v == null) {\n              return null;\n            }\n\n            // Need to set explicit min/max for rotation as logic only can handle 0-360\n            const min = p === 'rotation' ? 0 : undefined;\n            const max = p === 'rotation' ? 360 : undefined;\n\n            return (\n              <InlineFieldRow key={p}>\n                <InlineField label={p} labelWidth={8} grow={true}>\n                  <NumberInput min={min} max={max} value={v} onChange={(v) => onPositionChange(v, p)} />\n                </InlineField>\n              </InlineFieldRow>\n            );\n          })}\n        </>\n      </Field>\n    </div>\n  );\n}\n","import { get as lodashGet } from 'lodash';\n\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/internal';\nimport { t } from '@grafana/i18n';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\nimport {\n  canvasElementRegistry,\n  DEFAULT_CANVAS_ELEMENT_CONFIG,\n  defaultElementItems,\n} from 'app/features/canvas/registry';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { getElementTypes } from '../../utils';\nimport { optionBuilder } from '../options';\n\nimport { PlacementEditor } from './PlacementEditor';\n\nexport interface CanvasEditorOptions {\n  element: ElementState;\n  scene: Scene;\n  category?: string[];\n}\n\nexport interface TreeViewEditorProps {\n  scene: Scene;\n  layer: FrameState;\n  selected: ElementState[];\n}\n\nexport function getElementEditor(opts: CanvasEditorOptions): NestedPanelOptions<CanvasElementOptions> {\n  return {\n    category: opts.category,\n    path: '--', // not used!\n\n    // Note that canvas editor writes things to the scene!\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path) => {\n        return lodashGet(opts.element.options, path);\n      },\n      onChange: (path, value) => {\n        let options = opts.element.options;\n        if (path === 'type' && value) {\n          const layer = canvasElementRegistry.getIfExists(value);\n          if (!layer) {\n            console.warn('layer does not exist', value);\n            return;\n          }\n          options = {\n            ...options,\n            ...layer.getNewOptions(options),\n            type: layer.id,\n          };\n        } else {\n          options = setOptionImmutably(options, path, value);\n        }\n        opts.element.onChange(options);\n        opts.element.updateData(opts.scene.context);\n      },\n    }),\n\n    // Dynamically fill the selected element\n    build: (builder, context) => {\n      const { options } = opts.element;\n      const current = options?.type ? options.type : DEFAULT_CANVAS_ELEMENT_CONFIG.type;\n      const layerTypes = getElementTypes(opts.scene.shouldShowAdvancedTypes, current).options;\n\n      const isUnsupported =\n        !opts.scene.shouldShowAdvancedTypes && !defaultElementItems.filter((item) => item.id === options?.type).length;\n\n      builder.addSelect({\n        path: 'type',\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n        name: undefined as any, // required, but hide space\n        settings: {\n          options: layerTypes,\n        },\n        description: isUnsupported\n          ? t(\n              'canvas.element-editor.description-unsupported',\n              'Selected element type is not supported by current settings. Please enable advanced element types.'\n            )\n          : '',\n      });\n\n      // force clean layer configuration\n      const layer = canvasElementRegistry.getIfExists(options?.type ?? DEFAULT_CANVAS_ELEMENT_CONFIG.type)!;\n      let currentOptions = options;\n      if (!currentOptions) {\n        currentOptions = {\n          ...layer.getNewOptions(options),\n          type: layer.id,\n          name: `Element ${Date.now()}.${Math.floor(Math.random() * 100)}`,\n        };\n      }\n      const ctx = { ...context, options: currentOptions };\n\n      if (layer?.registerOptionsUI) {\n        layer.registerOptionsUI(builder, ctx);\n      }\n\n      const shouldAddLayoutEditor = opts.element.item.standardEditorConfig?.layout ?? true;\n      if (shouldAddLayoutEditor) {\n        builder.addCustomEditor({\n          category: [t('canvas.element-editor.category-layout', 'Layout')],\n          id: 'content',\n          path: '__', // not used\n          name: t('canvas.element-editor.name-quick-placement', 'Quick placement'),\n          editor: PlacementEditor,\n          settings: opts,\n        });\n      }\n\n      const shouldAddBackgroundEditor = opts.element.item.standardEditorConfig?.background ?? true;\n      if (shouldAddBackgroundEditor) {\n        optionBuilder.addBackground(builder, ctx);\n      }\n\n      const shouldAddBorderEditor = opts.element.item.standardEditorConfig?.border ?? true;\n      if (shouldAddBorderEditor) {\n        optionBuilder.addBorder(builder, ctx);\n      }\n\n      optionBuilder.addDataLinks(builder, ctx);\n      optionBuilder.addActions(builder, ctx);\n    },\n  };\n}\n","/**\n * Webpack has bug for import loop, which is not the same behavior as ES module.\n * When util.js imports the TreeNode for tree generate will cause treeContextTypes be empty.\n */\nimport * as React from 'react';\nexport var TreeContext = /*#__PURE__*/React.createContext(null);\n\n/** Internal usage, safe to remove. Do not use in prod */\nexport var UnstableContext = /*#__PURE__*/React.createContext({});","import React from 'react';\nvar DropIndicator = function DropIndicator(props) {\n  var dropPosition = props.dropPosition,\n    dropLevelOffset = props.dropLevelOffset,\n    indent = props.indent;\n  var style = {\n    pointerEvents: 'none',\n    position: 'absolute',\n    right: 0,\n    backgroundColor: 'red',\n    height: 2\n  };\n  switch (dropPosition) {\n    case -1:\n      style.top = 0;\n      style.left = -dropLevelOffset * indent;\n      break;\n    case 1:\n      style.bottom = 0;\n      style.left = -dropLevelOffset * indent;\n      break;\n    case 0:\n      style.bottom = 0;\n      style.left = indent;\n      break;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: style\n  });\n};\nif (process.env.NODE_ENV !== 'production') {\n  DropIndicator.displayName = 'DropIndicator';\n}\nexport default DropIndicator;","function _objectDestructuringEmpty(t) {\n  if (null == t) throw new TypeError(\"Cannot destructure \" + t);\n}\nexport { _objectDestructuringEmpty as default };","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport classNames from 'classnames';\nimport * as React from 'react';\nvar Indent = function Indent(_ref) {\n  var prefixCls = _ref.prefixCls,\n    level = _ref.level,\n    isStart = _ref.isStart,\n    isEnd = _ref.isEnd;\n  var baseClassName = \"\".concat(prefixCls, \"-indent-unit\");\n  var list = [];\n  for (var i = 0; i < level; i += 1) {\n    list.push( /*#__PURE__*/React.createElement(\"span\", {\n      key: i,\n      className: classNames(baseClassName, _defineProperty(_defineProperty({}, \"\".concat(baseClassName, \"-start\"), isStart[i]), \"\".concat(baseClassName, \"-end\"), isEnd[i]))\n    }));\n  }\n  return /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    className: \"\".concat(prefixCls, \"-indent\")\n  }, list);\n};\nexport default /*#__PURE__*/React.memo(Indent);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"eventKey\", \"className\", \"style\", \"dragOver\", \"dragOverGapTop\", \"dragOverGapBottom\", \"isLeaf\", \"isStart\", \"isEnd\", \"expanded\", \"selected\", \"checked\", \"halfChecked\", \"loading\", \"domRef\", \"active\", \"data\", \"onMouseMove\", \"selectable\"];\nimport React from 'react';\nimport classNames from 'classnames';\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport { TreeContext, UnstableContext } from \"./contextTypes\";\nimport Indent from \"./Indent\";\nimport getEntity from \"./utils/keyUtil\";\nimport { convertNodePropsToEventData } from \"./utils/treeUtil\";\nvar ICON_OPEN = 'open';\nvar ICON_CLOSE = 'close';\nvar defaultTitle = '---';\nvar TreeNode = function TreeNode(props) {\n  var _unstableContext$node, _context$filterTreeNo, _classNames4;\n  var eventKey = props.eventKey,\n    className = props.className,\n    style = props.style,\n    dragOver = props.dragOver,\n    dragOverGapTop = props.dragOverGapTop,\n    dragOverGapBottom = props.dragOverGapBottom,\n    isLeaf = props.isLeaf,\n    isStart = props.isStart,\n    isEnd = props.isEnd,\n    expanded = props.expanded,\n    selected = props.selected,\n    checked = props.checked,\n    halfChecked = props.halfChecked,\n    loading = props.loading,\n    domRef = props.domRef,\n    active = props.active,\n    data = props.data,\n    onMouseMove = props.onMouseMove,\n    selectable = props.selectable,\n    otherProps = _objectWithoutProperties(props, _excluded);\n  var context = React.useContext(TreeContext);\n  var unstableContext = React.useContext(UnstableContext);\n  var selectHandleRef = React.useRef(null);\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    dragNodeHighlight = _React$useState2[0],\n    setDragNodeHighlight = _React$useState2[1];\n\n  // ======= State: Disabled State =======\n  var isDisabled = !!(context.disabled || props.disabled || (_unstableContext$node = unstableContext.nodeDisabled) !== null && _unstableContext$node !== void 0 && _unstableContext$node.call(unstableContext, data));\n  var isCheckable = React.useMemo(function () {\n    // Return false if tree or treeNode is not checkable\n    if (!context.checkable || props.checkable === false) {\n      return false;\n    }\n    return context.checkable;\n  }, [context.checkable, props.checkable]);\n\n  // ======= Event Handlers: Selection and Check =======\n  var onSelect = function onSelect(e) {\n    if (isDisabled) {\n      return;\n    }\n    context.onNodeSelect(e, convertNodePropsToEventData(props));\n  };\n  var onCheck = function onCheck(e) {\n    if (isDisabled) {\n      return;\n    }\n    if (!isCheckable || props.disableCheckbox) {\n      return;\n    }\n    context.onNodeCheck(e, convertNodePropsToEventData(props), !checked);\n  };\n\n  // ======= State: Selectable Check =======\n  var isSelectable = React.useMemo(function () {\n    // Ignore when selectable is undefined or null\n    if (typeof selectable === 'boolean') {\n      return selectable;\n    }\n    return context.selectable;\n  }, [selectable, context.selectable]);\n  var onSelectorClick = function onSelectorClick(e) {\n    // Click trigger before select/check operation\n    context.onNodeClick(e, convertNodePropsToEventData(props));\n    if (isSelectable) {\n      onSelect(e);\n    } else {\n      onCheck(e);\n    }\n  };\n  var onSelectorDoubleClick = function onSelectorDoubleClick(e) {\n    context.onNodeDoubleClick(e, convertNodePropsToEventData(props));\n  };\n  var onMouseEnter = function onMouseEnter(e) {\n    context.onNodeMouseEnter(e, convertNodePropsToEventData(props));\n  };\n  var onMouseLeave = function onMouseLeave(e) {\n    context.onNodeMouseLeave(e, convertNodePropsToEventData(props));\n  };\n  var onContextMenu = function onContextMenu(e) {\n    context.onNodeContextMenu(e, convertNodePropsToEventData(props));\n  };\n\n  // ======= Drag: Drag Enabled =======\n  var isDraggable = React.useMemo(function () {\n    return !!(context.draggable && (!context.draggable.nodeDraggable || context.draggable.nodeDraggable(data)));\n  }, [context.draggable, data]);\n\n  // ======= Drag: Drag Event Handlers =======\n  var onDragStart = function onDragStart(e) {\n    e.stopPropagation();\n    setDragNodeHighlight(true);\n    context.onNodeDragStart(e, props);\n    try {\n      // ie throw error\n      // firefox-need-it\n      e.dataTransfer.setData('text/plain', '');\n    } catch (_unused) {\n      // empty\n    }\n  };\n  var onDragEnter = function onDragEnter(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    context.onNodeDragEnter(e, props);\n  };\n  var onDragOver = function onDragOver(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    context.onNodeDragOver(e, props);\n  };\n  var onDragLeave = function onDragLeave(e) {\n    e.stopPropagation();\n    context.onNodeDragLeave(e, props);\n  };\n  var onDragEnd = function onDragEnd(e) {\n    e.stopPropagation();\n    setDragNodeHighlight(false);\n    context.onNodeDragEnd(e, props);\n  };\n  var onDrop = function onDrop(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragNodeHighlight(false);\n    context.onNodeDrop(e, props);\n  };\n\n  // ======= Expand: Node Expansion =======\n  var onExpand = function onExpand(e) {\n    if (loading) {\n      return;\n    }\n    context.onNodeExpand(e, convertNodePropsToEventData(props));\n  };\n\n  // ======= State: Has Children =======\n  var hasChildren = React.useMemo(function () {\n    var _ref = getEntity(context.keyEntities, eventKey) || {},\n      children = _ref.children;\n    return Boolean((children || []).length);\n  }, [context.keyEntities, eventKey]);\n\n  // ======= State: Leaf Check =======\n  var memoizedIsLeaf = React.useMemo(function () {\n    if (isLeaf === false) {\n      return false;\n    }\n    return isLeaf || !context.loadData && !hasChildren || context.loadData && props.loaded && !hasChildren;\n  }, [isLeaf, context.loadData, hasChildren, props.loaded]);\n\n  // ============== Effect ==============\n  React.useEffect(function () {\n    // Load data to avoid default expanded tree without data\n    if (loading) {\n      return;\n    }\n    // read from state to avoid loadData at same time\n    if (typeof context.loadData === 'function' && expanded && !memoizedIsLeaf && !props.loaded) {\n      // We needn't reload data when has children in sync logic\n      // It's only needed in node expanded\n      context.onNodeLoad(convertNodePropsToEventData(props));\n    }\n  }, [loading, context.loadData, context.onNodeLoad, expanded, memoizedIsLeaf, props]);\n\n  // ==================== Render: Drag Handler ====================\n  var dragHandlerNode = React.useMemo(function () {\n    var _context$draggable;\n    if (!((_context$draggable = context.draggable) !== null && _context$draggable !== void 0 && _context$draggable.icon)) {\n      return null;\n    }\n    return /*#__PURE__*/React.createElement(\"span\", {\n      className: \"\".concat(context.prefixCls, \"-draggable-icon\")\n    }, context.draggable.icon);\n  }, [context.draggable]);\n\n  // ====================== Render: Switcher ======================\n  var renderSwitcherIconDom = function renderSwitcherIconDom(isInternalLeaf) {\n    var switcherIcon = props.switcherIcon || context.switcherIcon;\n    // if switcherIconDom is null, no render switcher span\n    if (typeof switcherIcon === 'function') {\n      return switcherIcon(_objectSpread(_objectSpread({}, props), {}, {\n        isLeaf: isInternalLeaf\n      }));\n    }\n    return switcherIcon;\n  };\n\n  // Switcher\n  var renderSwitcher = function renderSwitcher() {\n    if (memoizedIsLeaf) {\n      // if switcherIconDom is null, no render switcher span\n      var _switcherIconDom = renderSwitcherIconDom(true);\n      return _switcherIconDom !== false ? /*#__PURE__*/React.createElement(\"span\", {\n        className: classNames(\"\".concat(context.prefixCls, \"-switcher\"), \"\".concat(context.prefixCls, \"-switcher-noop\"))\n      }, _switcherIconDom) : null;\n    }\n    var switcherIconDom = renderSwitcherIconDom(false);\n    return switcherIconDom !== false ? /*#__PURE__*/React.createElement(\"span\", {\n      onClick: onExpand,\n      className: classNames(\"\".concat(context.prefixCls, \"-switcher\"), \"\".concat(context.prefixCls, \"-switcher_\").concat(expanded ? ICON_OPEN : ICON_CLOSE))\n    }, switcherIconDom) : null;\n  };\n\n  // ====================== Checkbox ======================\n  var checkboxNode = React.useMemo(function () {\n    if (!isCheckable) {\n      return null;\n    }\n\n    // [Legacy] Custom element should be separate with `checkable` in future\n    var $custom = typeof isCheckable !== 'boolean' ? isCheckable : null;\n    return /*#__PURE__*/React.createElement(\"span\", {\n      className: classNames(\"\".concat(context.prefixCls, \"-checkbox\"), _defineProperty(_defineProperty(_defineProperty({}, \"\".concat(context.prefixCls, \"-checkbox-checked\"), checked), \"\".concat(context.prefixCls, \"-checkbox-indeterminate\"), !checked && halfChecked), \"\".concat(context.prefixCls, \"-checkbox-disabled\"), isDisabled || props.disableCheckbox)),\n      onClick: onCheck,\n      role: \"checkbox\",\n      \"aria-checked\": halfChecked ? 'mixed' : checked,\n      \"aria-disabled\": isDisabled || props.disableCheckbox,\n      \"aria-label\": \"Select \".concat(typeof props.title === 'string' ? props.title : 'tree node')\n    }, $custom);\n  }, [isCheckable, checked, halfChecked, isDisabled, props.disableCheckbox, props.title]);\n\n  // ============== State: Node State (Open/Close) ==============\n  var nodeState = React.useMemo(function () {\n    if (memoizedIsLeaf) {\n      return null;\n    }\n    return expanded ? ICON_OPEN : ICON_CLOSE;\n  }, [memoizedIsLeaf, expanded]);\n\n  // ==================== Render: Title + Icon ====================\n  var iconNode = React.useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"span\", {\n      className: classNames(\"\".concat(context.prefixCls, \"-iconEle\"), \"\".concat(context.prefixCls, \"-icon__\").concat(nodeState || 'docu'), _defineProperty({}, \"\".concat(context.prefixCls, \"-icon_loading\"), loading))\n    });\n  }, [context.prefixCls, nodeState, loading]);\n\n  // =================== Drop Indicator ===================\n  var dropIndicatorNode = React.useMemo(function () {\n    var rootDraggable = Boolean(context.draggable);\n    // allowDrop is calculated in Tree.tsx, there is no need for calc it here\n    var showIndicator = !props.disabled && rootDraggable && context.dragOverNodeKey === eventKey;\n    if (!showIndicator) {\n      return null;\n    }\n    return context.dropIndicatorRender({\n      dropPosition: context.dropPosition,\n      dropLevelOffset: context.dropLevelOffset,\n      indent: context.indent,\n      prefixCls: context.prefixCls,\n      direction: context.direction\n    });\n  }, [context.dropPosition, context.dropLevelOffset, context.indent, context.prefixCls, context.direction, context.draggable, context.dragOverNodeKey, context.dropIndicatorRender]);\n\n  // Icon + Title\n  var selectorNode = React.useMemo(function () {\n    var _props$title = props.title,\n      title = _props$title === void 0 ? defaultTitle : _props$title;\n    var wrapClass = \"\".concat(context.prefixCls, \"-node-content-wrapper\");\n\n    // Icon - Still show loading icon when loading without showIcon\n    var $icon;\n    if (context.showIcon) {\n      var currentIcon = props.icon || context.icon;\n      $icon = currentIcon ? /*#__PURE__*/React.createElement(\"span\", {\n        className: classNames(\"\".concat(context.prefixCls, \"-iconEle\"), \"\".concat(context.prefixCls, \"-icon__customize\"))\n      }, typeof currentIcon === 'function' ? currentIcon(props) : currentIcon) : iconNode;\n    } else if (context.loadData && loading) {\n      $icon = iconNode;\n    }\n\n    // Title\n    var titleNode;\n    if (typeof title === 'function') {\n      titleNode = title(data);\n    } else if (context.titleRender) {\n      titleNode = context.titleRender(data);\n    } else {\n      titleNode = title;\n    }\n    return /*#__PURE__*/React.createElement(\"span\", {\n      ref: selectHandleRef,\n      title: typeof title === 'string' ? title : '',\n      className: classNames(wrapClass, \"\".concat(wrapClass, \"-\").concat(nodeState || 'normal'), _defineProperty({}, \"\".concat(context.prefixCls, \"-node-selected\"), !isDisabled && (selected || dragNodeHighlight))),\n      onMouseEnter: onMouseEnter,\n      onMouseLeave: onMouseLeave,\n      onContextMenu: onContextMenu,\n      onClick: onSelectorClick,\n      onDoubleClick: onSelectorDoubleClick\n    }, $icon, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"\".concat(context.prefixCls, \"-title\")\n    }, titleNode), dropIndicatorNode);\n  }, [context.prefixCls, context.showIcon, props, context.icon, iconNode, context.titleRender, data, nodeState, onMouseEnter, onMouseLeave, onContextMenu, onSelectorClick, onSelectorDoubleClick]);\n  var dataOrAriaAttributeProps = pickAttrs(otherProps, {\n    aria: true,\n    data: true\n  });\n  var _ref2 = getEntity(context.keyEntities, eventKey) || {},\n    level = _ref2.level;\n  var isEndNode = isEnd[isEnd.length - 1];\n  var draggableWithoutDisabled = !isDisabled && isDraggable;\n  var dragging = context.draggingNodeKey === eventKey;\n  var ariaSelected = selectable !== undefined ? {\n    'aria-selected': !!selectable\n  } : undefined;\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    ref: domRef,\n    role: \"treeitem\",\n    \"aria-expanded\": isLeaf ? undefined : expanded,\n    className: classNames(className, \"\".concat(context.prefixCls, \"-treenode\"), (_classNames4 = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_classNames4, \"\".concat(context.prefixCls, \"-treenode-disabled\"), isDisabled), \"\".concat(context.prefixCls, \"-treenode-switcher-\").concat(expanded ? 'open' : 'close'), !isLeaf), \"\".concat(context.prefixCls, \"-treenode-checkbox-checked\"), checked), \"\".concat(context.prefixCls, \"-treenode-checkbox-indeterminate\"), halfChecked), \"\".concat(context.prefixCls, \"-treenode-selected\"), selected), \"\".concat(context.prefixCls, \"-treenode-loading\"), loading), \"\".concat(context.prefixCls, \"-treenode-active\"), active), \"\".concat(context.prefixCls, \"-treenode-leaf-last\"), isEndNode), \"\".concat(context.prefixCls, \"-treenode-draggable\"), isDraggable), \"dragging\", dragging), _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_classNames4, 'drop-target', context.dropTargetKey === eventKey), 'drop-container', context.dropContainerKey === eventKey), 'drag-over', !isDisabled && dragOver), 'drag-over-gap-top', !isDisabled && dragOverGapTop), 'drag-over-gap-bottom', !isDisabled && dragOverGapBottom), 'filter-node', (_context$filterTreeNo = context.filterTreeNode) === null || _context$filterTreeNo === void 0 ? void 0 : _context$filterTreeNo.call(context, convertNodePropsToEventData(props))), \"\".concat(context.prefixCls, \"-treenode-leaf\"), memoizedIsLeaf))),\n    style: style\n    // Draggable config\n    ,\n    draggable: draggableWithoutDisabled,\n    onDragStart: draggableWithoutDisabled ? onDragStart : undefined\n    // Drop config\n    ,\n    onDragEnter: isDraggable ? onDragEnter : undefined,\n    onDragOver: isDraggable ? onDragOver : undefined,\n    onDragLeave: isDraggable ? onDragLeave : undefined,\n    onDrop: isDraggable ? onDrop : undefined,\n    onDragEnd: isDraggable ? onDragEnd : undefined,\n    onMouseMove: onMouseMove\n  }, ariaSelected, dataOrAriaAttributeProps), /*#__PURE__*/React.createElement(Indent, {\n    prefixCls: context.prefixCls,\n    level: level,\n    isStart: isStart,\n    isEnd: isEnd\n  }), dragHandlerNode, renderSwitcher(), checkboxNode, selectorNode);\n};\nTreeNode.isTreeNode = 1;\nif (process.env.NODE_ENV !== 'production') {\n  TreeNode.displayName = 'TreeNode';\n}\nexport default TreeNode;","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport * as React from 'react';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\n\n/**\n * Trigger only when component unmount\n */\nfunction useUnmount(triggerStart, triggerEnd) {\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    firstMount = _React$useState2[0],\n    setFirstMount = _React$useState2[1];\n  useLayoutEffect(function () {\n    if (firstMount) {\n      triggerStart();\n      return function () {\n        triggerEnd();\n      };\n    }\n  }, [firstMount]);\n  useLayoutEffect(function () {\n    setFirstMount(true);\n    return function () {\n      setFirstMount(false);\n    };\n  }, []);\n}\nexport default useUnmount;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"className\", \"style\", \"motion\", \"motionNodes\", \"motionType\", \"onMotionStart\", \"onMotionEnd\", \"active\", \"treeNodeRequiredProps\"];\nimport classNames from 'classnames';\nimport CSSMotion from 'rc-motion';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport * as React from 'react';\nimport { TreeContext } from \"./contextTypes\";\nimport TreeNode from \"./TreeNode\";\nimport useUnmount from \"./useUnmount\";\nimport { getTreeNodeProps } from \"./utils/treeUtil\";\nvar MotionTreeNode = /*#__PURE__*/React.forwardRef(function (oriProps, ref) {\n  var className = oriProps.className,\n    style = oriProps.style,\n    motion = oriProps.motion,\n    motionNodes = oriProps.motionNodes,\n    motionType = oriProps.motionType,\n    onOriginMotionStart = oriProps.onMotionStart,\n    onOriginMotionEnd = oriProps.onMotionEnd,\n    active = oriProps.active,\n    treeNodeRequiredProps = oriProps.treeNodeRequiredProps,\n    props = _objectWithoutProperties(oriProps, _excluded);\n  var _React$useState = React.useState(true),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    visible = _React$useState2[0],\n    setVisible = _React$useState2[1];\n  var _React$useContext = React.useContext(TreeContext),\n    prefixCls = _React$useContext.prefixCls;\n\n  // Calculate target visible here.\n  // And apply in effect to make `leave` motion work.\n  var targetVisible = motionNodes && motionType !== 'hide';\n  useLayoutEffect(function () {\n    if (motionNodes) {\n      if (targetVisible !== visible) {\n        setVisible(targetVisible);\n      }\n    }\n  }, [motionNodes]);\n  var triggerMotionStart = function triggerMotionStart() {\n    if (motionNodes) {\n      onOriginMotionStart();\n    }\n  };\n\n  // Should only trigger once\n  var triggerMotionEndRef = React.useRef(false);\n  var triggerMotionEnd = function triggerMotionEnd() {\n    if (motionNodes && !triggerMotionEndRef.current) {\n      triggerMotionEndRef.current = true;\n      onOriginMotionEnd();\n    }\n  };\n\n  // Effect if unmount\n  useUnmount(triggerMotionStart, triggerMotionEnd);\n\n  // Motion end event\n  var onVisibleChanged = function onVisibleChanged(nextVisible) {\n    if (targetVisible === nextVisible) {\n      triggerMotionEnd();\n    }\n  };\n  if (motionNodes) {\n    return /*#__PURE__*/React.createElement(CSSMotion, _extends({\n      ref: ref,\n      visible: visible\n    }, motion, {\n      motionAppear: motionType === 'show',\n      onVisibleChanged: onVisibleChanged\n    }), function (_ref, motionRef) {\n      var motionClassName = _ref.className,\n        motionStyle = _ref.style;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        ref: motionRef,\n        className: classNames(\"\".concat(prefixCls, \"-treenode-motion\"), motionClassName),\n        style: motionStyle\n      }, motionNodes.map(function (treeNode) {\n        var restProps = Object.assign({}, (_objectDestructuringEmpty(treeNode.data), treeNode.data)),\n          title = treeNode.title,\n          key = treeNode.key,\n          isStart = treeNode.isStart,\n          isEnd = treeNode.isEnd;\n        delete restProps.children;\n        var treeNodeProps = getTreeNodeProps(key, treeNodeRequiredProps);\n        return /*#__PURE__*/React.createElement(TreeNode, _extends({}, restProps, treeNodeProps, {\n          title: title,\n          active: active,\n          data: treeNode.data,\n          key: key,\n          isStart: isStart,\n          isEnd: isEnd\n        }));\n      }));\n    });\n  }\n  return /*#__PURE__*/React.createElement(TreeNode, _extends({\n    domRef: ref,\n    className: className,\n    style: style\n  }, props, {\n    active: active\n  }));\n});\nif (process.env.NODE_ENV !== 'production') {\n  MotionTreeNode.displayName = 'MotionTreeNode';\n}\nexport default MotionTreeNode;","export function findExpandedKeys() {\n  var prev = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var next = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var prevLen = prev.length;\n  var nextLen = next.length;\n  if (Math.abs(prevLen - nextLen) !== 1) {\n    return {\n      add: false,\n      key: null\n    };\n  }\n  function find(shorter, longer) {\n    var cache = new Map();\n    shorter.forEach(function (key) {\n      cache.set(key, true);\n    });\n    var keys = longer.filter(function (key) {\n      return !cache.has(key);\n    });\n    return keys.length === 1 ? keys[0] : null;\n  }\n  if (prevLen < nextLen) {\n    return {\n      add: true,\n      key: find(prev, next)\n    };\n  }\n  return {\n    add: false,\n    key: find(next, prev)\n  };\n}\nexport function getExpandRange(shorter, longer, key) {\n  var shorterStartIndex = shorter.findIndex(function (data) {\n    return data.key === key;\n  });\n  var shorterEndNode = shorter[shorterStartIndex + 1];\n  var longerStartIndex = longer.findIndex(function (data) {\n    return data.key === key;\n  });\n  if (shorterEndNode) {\n    var longerEndIndex = longer.findIndex(function (data) {\n      return data.key === shorterEndNode.key;\n    });\n    return longer.slice(longerStartIndex + 1, longerEndIndex);\n  }\n  return longer.slice(longerStartIndex + 1);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"prefixCls\", \"data\", \"selectable\", \"checkable\", \"expandedKeys\", \"selectedKeys\", \"checkedKeys\", \"loadedKeys\", \"loadingKeys\", \"halfCheckedKeys\", \"keyEntities\", \"disabled\", \"dragging\", \"dragOverNodeKey\", \"dropPosition\", \"motion\", \"height\", \"itemHeight\", \"virtual\", \"scrollWidth\", \"focusable\", \"activeItem\", \"focused\", \"tabIndex\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"onActiveChange\", \"onListChangeStart\", \"onListChangeEnd\"];\n/**\n * Handle virtual list of the TreeNodes.\n */\n\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport VirtualList from 'rc-virtual-list';\nimport * as React from 'react';\nimport MotionTreeNode from \"./MotionTreeNode\";\nimport { findExpandedKeys, getExpandRange } from \"./utils/diffUtil\";\nimport { getKey, getTreeNodeProps } from \"./utils/treeUtil\";\nvar HIDDEN_STYLE = {\n  width: 0,\n  height: 0,\n  display: 'flex',\n  overflow: 'hidden',\n  opacity: 0,\n  border: 0,\n  padding: 0,\n  margin: 0\n};\nvar noop = function noop() {};\nexport var MOTION_KEY = \"RC_TREE_MOTION_\".concat(Math.random());\nvar MotionNode = {\n  key: MOTION_KEY\n};\nexport var MotionEntity = {\n  key: MOTION_KEY,\n  level: 0,\n  index: 0,\n  pos: '0',\n  node: MotionNode,\n  nodes: [MotionNode]\n};\nvar MotionFlattenData = {\n  parent: null,\n  children: [],\n  pos: MotionEntity.pos,\n  data: MotionNode,\n  title: null,\n  key: MOTION_KEY,\n  /** Hold empty list here since we do not use it */\n  isStart: [],\n  isEnd: []\n};\n/**\n * We only need get visible content items to play the animation.\n */\nexport function getMinimumRangeTransitionRange(list, virtual, height, itemHeight) {\n  if (virtual === false || !height) {\n    return list;\n  }\n  return list.slice(0, Math.ceil(height / itemHeight) + 1);\n}\nfunction itemKey(item) {\n  var key = item.key,\n    pos = item.pos;\n  return getKey(key, pos);\n}\nfunction getAccessibilityPath(item) {\n  var path = String(item.data.key);\n  var current = item;\n  while (current.parent) {\n    current = current.parent;\n    path = \"\".concat(current.data.key, \" > \").concat(path);\n  }\n  return path;\n}\nvar NodeList = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var prefixCls = props.prefixCls,\n    data = props.data,\n    selectable = props.selectable,\n    checkable = props.checkable,\n    expandedKeys = props.expandedKeys,\n    selectedKeys = props.selectedKeys,\n    checkedKeys = props.checkedKeys,\n    loadedKeys = props.loadedKeys,\n    loadingKeys = props.loadingKeys,\n    halfCheckedKeys = props.halfCheckedKeys,\n    keyEntities = props.keyEntities,\n    disabled = props.disabled,\n    dragging = props.dragging,\n    dragOverNodeKey = props.dragOverNodeKey,\n    dropPosition = props.dropPosition,\n    motion = props.motion,\n    height = props.height,\n    itemHeight = props.itemHeight,\n    virtual = props.virtual,\n    scrollWidth = props.scrollWidth,\n    focusable = props.focusable,\n    activeItem = props.activeItem,\n    focused = props.focused,\n    tabIndex = props.tabIndex,\n    onKeyDown = props.onKeyDown,\n    onFocus = props.onFocus,\n    onBlur = props.onBlur,\n    onActiveChange = props.onActiveChange,\n    onListChangeStart = props.onListChangeStart,\n    onListChangeEnd = props.onListChangeEnd,\n    domProps = _objectWithoutProperties(props, _excluded);\n\n  // =============================== Ref ================================\n  var listRef = React.useRef(null);\n  var indentMeasurerRef = React.useRef(null);\n  React.useImperativeHandle(ref, function () {\n    return {\n      scrollTo: function scrollTo(scroll) {\n        listRef.current.scrollTo(scroll);\n      },\n      getIndentWidth: function getIndentWidth() {\n        return indentMeasurerRef.current.offsetWidth;\n      }\n    };\n  });\n\n  // ============================== Motion ==============================\n  var _React$useState = React.useState(expandedKeys),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    prevExpandedKeys = _React$useState2[0],\n    setPrevExpandedKeys = _React$useState2[1];\n  var _React$useState3 = React.useState(data),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    prevData = _React$useState4[0],\n    setPrevData = _React$useState4[1];\n  var _React$useState5 = React.useState(data),\n    _React$useState6 = _slicedToArray(_React$useState5, 2),\n    transitionData = _React$useState6[0],\n    setTransitionData = _React$useState6[1];\n  var _React$useState7 = React.useState([]),\n    _React$useState8 = _slicedToArray(_React$useState7, 2),\n    transitionRange = _React$useState8[0],\n    setTransitionRange = _React$useState8[1];\n  var _React$useState9 = React.useState(null),\n    _React$useState10 = _slicedToArray(_React$useState9, 2),\n    motionType = _React$useState10[0],\n    setMotionType = _React$useState10[1];\n\n  // When motion end but data change, this will makes data back to previous one\n  var dataRef = React.useRef(data);\n  dataRef.current = data;\n  function onMotionEnd() {\n    var latestData = dataRef.current;\n    setPrevData(latestData);\n    setTransitionData(latestData);\n    setTransitionRange([]);\n    setMotionType(null);\n    onListChangeEnd();\n  }\n\n  // Do animation if expanded keys changed\n  // layoutEffect here to avoid blink of node removing\n  useLayoutEffect(function () {\n    setPrevExpandedKeys(expandedKeys);\n    var diffExpanded = findExpandedKeys(prevExpandedKeys, expandedKeys);\n    if (diffExpanded.key !== null) {\n      if (diffExpanded.add) {\n        var keyIndex = prevData.findIndex(function (_ref) {\n          var key = _ref.key;\n          return key === diffExpanded.key;\n        });\n        var rangeNodes = getMinimumRangeTransitionRange(getExpandRange(prevData, data, diffExpanded.key), virtual, height, itemHeight);\n        var newTransitionData = prevData.slice();\n        newTransitionData.splice(keyIndex + 1, 0, MotionFlattenData);\n        setTransitionData(newTransitionData);\n        setTransitionRange(rangeNodes);\n        setMotionType('show');\n      } else {\n        var _keyIndex = data.findIndex(function (_ref2) {\n          var key = _ref2.key;\n          return key === diffExpanded.key;\n        });\n        var _rangeNodes = getMinimumRangeTransitionRange(getExpandRange(data, prevData, diffExpanded.key), virtual, height, itemHeight);\n        var _newTransitionData = data.slice();\n        _newTransitionData.splice(_keyIndex + 1, 0, MotionFlattenData);\n        setTransitionData(_newTransitionData);\n        setTransitionRange(_rangeNodes);\n        setMotionType('hide');\n      }\n    } else if (prevData !== data) {\n      // If whole data changed, we just refresh the list\n      setPrevData(data);\n      setTransitionData(data);\n    }\n  }, [expandedKeys, data]);\n\n  // We should clean up motion if is changed by dragging\n  React.useEffect(function () {\n    if (!dragging) {\n      onMotionEnd();\n    }\n  }, [dragging]);\n  var mergedData = motion ? transitionData : data;\n  var treeNodeRequiredProps = {\n    expandedKeys: expandedKeys,\n    selectedKeys: selectedKeys,\n    loadedKeys: loadedKeys,\n    loadingKeys: loadingKeys,\n    checkedKeys: checkedKeys,\n    halfCheckedKeys: halfCheckedKeys,\n    dragOverNodeKey: dragOverNodeKey,\n    dropPosition: dropPosition,\n    keyEntities: keyEntities\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, focused && activeItem && /*#__PURE__*/React.createElement(\"span\", {\n    style: HIDDEN_STYLE,\n    \"aria-live\": \"assertive\"\n  }, getAccessibilityPath(activeItem)), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"input\", {\n    style: HIDDEN_STYLE,\n    disabled: focusable === false || disabled,\n    tabIndex: focusable !== false ? tabIndex : null,\n    onKeyDown: onKeyDown,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    value: \"\",\n    onChange: noop,\n    \"aria-label\": \"for screen reader\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-treenode\"),\n    \"aria-hidden\": true,\n    style: {\n      position: 'absolute',\n      pointerEvents: 'none',\n      visibility: 'hidden',\n      height: 0,\n      overflow: 'hidden',\n      border: 0,\n      padding: 0\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-indent\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: indentMeasurerRef,\n    className: \"\".concat(prefixCls, \"-indent-unit\")\n  }))), /*#__PURE__*/React.createElement(VirtualList, _extends({}, domProps, {\n    data: mergedData,\n    itemKey: itemKey,\n    height: height,\n    fullHeight: false,\n    virtual: virtual,\n    itemHeight: itemHeight,\n    scrollWidth: scrollWidth,\n    prefixCls: \"\".concat(prefixCls, \"-list\"),\n    ref: listRef,\n    role: \"tree\",\n    onVisibleChange: function onVisibleChange(originList) {\n      // The best match is using `fullList` - `originList` = `restList`\n      // and check the `restList` to see if has the MOTION_KEY node\n      // but this will cause performance issue for long list compare\n      // we just check `originList` and repeat trigger `onMotionEnd`\n      if (originList.every(function (item) {\n        return itemKey(item) !== MOTION_KEY;\n      })) {\n        onMotionEnd();\n      }\n    }\n  }), function (treeNode) {\n    var pos = treeNode.pos,\n      restProps = Object.assign({}, (_objectDestructuringEmpty(treeNode.data), treeNode.data)),\n      title = treeNode.title,\n      key = treeNode.key,\n      isStart = treeNode.isStart,\n      isEnd = treeNode.isEnd;\n    var mergedKey = getKey(key, pos);\n    delete restProps.key;\n    delete restProps.children;\n    var treeNodeProps = getTreeNodeProps(mergedKey, treeNodeRequiredProps);\n    return /*#__PURE__*/React.createElement(MotionTreeNode, _extends({}, restProps, treeNodeProps, {\n      title: title,\n      active: !!activeItem && key === activeItem.key,\n      pos: pos,\n      data: treeNode.data,\n      isStart: isStart,\n      isEnd: isEnd,\n      motion: motion,\n      motionNodes: key === MOTION_KEY ? transitionRange : null,\n      motionType: motionType,\n      onMotionStart: onListChangeStart,\n      onMotionEnd: onMotionEnd,\n      treeNodeRequiredProps: treeNodeRequiredProps,\n      onMouseMove: function onMouseMove() {\n        onActiveChange(null);\n      }\n    }));\n  }));\n});\nif (process.env.NODE_ENV !== 'production') {\n  NodeList.displayName = 'NodeList';\n}\nexport default NodeList;","import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"children\"];\n/* eslint-disable no-lonely-if */\n/**\n * Legacy code. Should avoid to use if you are new to import these code.\n */\n\nimport warning from \"rc-util/es/warning\";\nimport React from 'react';\nimport TreeNode from \"./TreeNode\";\nimport getEntity from \"./utils/keyUtil\";\nexport { getPosition, isTreeNode } from \"./utils/treeUtil\";\nexport function arrDel(list, value) {\n  if (!list) return [];\n  var clone = list.slice();\n  var index = clone.indexOf(value);\n  if (index >= 0) {\n    clone.splice(index, 1);\n  }\n  return clone;\n}\nexport function arrAdd(list, value) {\n  var clone = (list || []).slice();\n  if (clone.indexOf(value) === -1) {\n    clone.push(value);\n  }\n  return clone;\n}\nexport function posToArr(pos) {\n  return pos.split('-');\n}\nexport function getDragChildrenKeys(dragNodeKey, keyEntities) {\n  // not contains self\n  // self for left or right drag\n  var dragChildrenKeys = [];\n  var entity = getEntity(keyEntities, dragNodeKey);\n  function dig() {\n    var list = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    list.forEach(function (_ref) {\n      var key = _ref.key,\n        children = _ref.children;\n      dragChildrenKeys.push(key);\n      dig(children);\n    });\n  }\n  dig(entity.children);\n  return dragChildrenKeys;\n}\nexport function isLastChild(treeNodeEntity) {\n  if (treeNodeEntity.parent) {\n    var posArr = posToArr(treeNodeEntity.pos);\n    return Number(posArr[posArr.length - 1]) === treeNodeEntity.parent.children.length - 1;\n  }\n  return false;\n}\nexport function isFirstChild(treeNodeEntity) {\n  var posArr = posToArr(treeNodeEntity.pos);\n  return Number(posArr[posArr.length - 1]) === 0;\n}\n\n// Only used when drag, not affect SSR.\nexport function calcDropPosition(event, dragNodeProps, targetNodeProps, indent, startMousePosition, allowDrop, flattenedNodes, keyEntities, expandKeys, direction) {\n  var _abstractDropNodeEnti;\n  var clientX = event.clientX,\n    clientY = event.clientY;\n  var _getBoundingClientRec = event.target.getBoundingClientRect(),\n    top = _getBoundingClientRec.top,\n    height = _getBoundingClientRec.height;\n  // optional chain for testing\n  var horizontalMouseOffset = (direction === 'rtl' ? -1 : 1) * (((startMousePosition === null || startMousePosition === void 0 ? void 0 : startMousePosition.x) || 0) - clientX);\n  var rawDropLevelOffset = (horizontalMouseOffset - 12) / indent;\n\n  // Filter the expanded keys to exclude the node that not has children currently (like async nodes).\n  var filteredExpandKeys = expandKeys.filter(function (key) {\n    var _keyEntities$key;\n    return (_keyEntities$key = keyEntities[key]) === null || _keyEntities$key === void 0 || (_keyEntities$key = _keyEntities$key.children) === null || _keyEntities$key === void 0 ? void 0 : _keyEntities$key.length;\n  });\n\n  // find abstract drop node by horizontal offset\n  var abstractDropNodeEntity = getEntity(keyEntities, targetNodeProps.eventKey);\n  if (clientY < top + height / 2) {\n    // first half, set abstract drop node to previous node\n    var nodeIndex = flattenedNodes.findIndex(function (flattenedNode) {\n      return flattenedNode.key === abstractDropNodeEntity.key;\n    });\n    var prevNodeIndex = nodeIndex <= 0 ? 0 : nodeIndex - 1;\n    var prevNodeKey = flattenedNodes[prevNodeIndex].key;\n    abstractDropNodeEntity = getEntity(keyEntities, prevNodeKey);\n  }\n  var initialAbstractDropNodeKey = abstractDropNodeEntity.key;\n  var abstractDragOverEntity = abstractDropNodeEntity;\n  var dragOverNodeKey = abstractDropNodeEntity.key;\n  var dropPosition = 0;\n  var dropLevelOffset = 0;\n\n  // Only allow cross level drop when dragging on a non-expanded node\n  if (!filteredExpandKeys.includes(initialAbstractDropNodeKey)) {\n    for (var i = 0; i < rawDropLevelOffset; i += 1) {\n      if (isLastChild(abstractDropNodeEntity)) {\n        abstractDropNodeEntity = abstractDropNodeEntity.parent;\n        dropLevelOffset += 1;\n      } else {\n        break;\n      }\n    }\n  }\n  var abstractDragDataNode = dragNodeProps.data;\n  var abstractDropDataNode = abstractDropNodeEntity.node;\n  var dropAllowed = true;\n  if (isFirstChild(abstractDropNodeEntity) && abstractDropNodeEntity.level === 0 && clientY < top + height / 2 && allowDrop({\n    dragNode: abstractDragDataNode,\n    dropNode: abstractDropDataNode,\n    dropPosition: -1\n  }) && abstractDropNodeEntity.key === targetNodeProps.eventKey) {\n    // first half of first node in first level\n    dropPosition = -1;\n  } else if ((abstractDragOverEntity.children || []).length && filteredExpandKeys.includes(dragOverNodeKey)) {\n    // drop on expanded node\n    // only allow drop inside\n    if (allowDrop({\n      dragNode: abstractDragDataNode,\n      dropNode: abstractDropDataNode,\n      dropPosition: 0\n    })) {\n      dropPosition = 0;\n    } else {\n      dropAllowed = false;\n    }\n  } else if (dropLevelOffset === 0) {\n    if (rawDropLevelOffset > -1.5) {\n      // | Node     | <- abstractDropNode\n      // | -^-===== | <- mousePosition\n      // 1. try drop after\n      // 2. do not allow drop\n      if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 1\n      })) {\n        dropPosition = 1;\n      } else {\n        dropAllowed = false;\n      }\n    } else {\n      // | Node     | <- abstractDropNode\n      // | ---==^== | <- mousePosition\n      // whether it has children or doesn't has children\n      // always\n      // 1. try drop inside\n      // 2. try drop after\n      // 3. do not allow drop\n      if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 0\n      })) {\n        dropPosition = 0;\n      } else if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 1\n      })) {\n        dropPosition = 1;\n      } else {\n        dropAllowed = false;\n      }\n    }\n  } else {\n    // | Node1 | <- abstractDropNode\n    //      |  Node2  |\n    // --^--|----=====| <- mousePosition\n    // 1. try insert after Node1\n    // 2. do not allow drop\n    if (allowDrop({\n      dragNode: abstractDragDataNode,\n      dropNode: abstractDropDataNode,\n      dropPosition: 1\n    })) {\n      dropPosition = 1;\n    } else {\n      dropAllowed = false;\n    }\n  }\n  return {\n    dropPosition: dropPosition,\n    dropLevelOffset: dropLevelOffset,\n    dropTargetKey: abstractDropNodeEntity.key,\n    dropTargetPos: abstractDropNodeEntity.pos,\n    dragOverNodeKey: dragOverNodeKey,\n    dropContainerKey: dropPosition === 0 ? null : ((_abstractDropNodeEnti = abstractDropNodeEntity.parent) === null || _abstractDropNodeEnti === void 0 ? void 0 : _abstractDropNodeEnti.key) || null,\n    dropAllowed: dropAllowed\n  };\n}\n\n/**\n * Return selectedKeys according with multiple prop\n * @param selectedKeys\n * @param props\n * @returns [string]\n */\nexport function calcSelectedKeys(selectedKeys, props) {\n  if (!selectedKeys) return undefined;\n  var multiple = props.multiple;\n  if (multiple) {\n    return selectedKeys.slice();\n  }\n  if (selectedKeys.length) {\n    return [selectedKeys[0]];\n  }\n  return selectedKeys;\n}\nvar internalProcessProps = function internalProcessProps(props) {\n  return props;\n};\nexport function convertDataToTree(treeData, processor) {\n  if (!treeData) return [];\n  var _ref2 = processor || {},\n    _ref2$processProps = _ref2.processProps,\n    processProps = _ref2$processProps === void 0 ? internalProcessProps : _ref2$processProps;\n  var list = Array.isArray(treeData) ? treeData : [treeData];\n  return list.map(function (_ref3) {\n    var children = _ref3.children,\n      props = _objectWithoutProperties(_ref3, _excluded);\n    var childrenNodes = convertDataToTree(children, processor);\n    return /*#__PURE__*/React.createElement(TreeNode, _extends({\n      key: props.key\n    }, processProps(props)), childrenNodes);\n  });\n}\n\n/**\n * Parse `checkedKeys` to { checkedKeys, halfCheckedKeys } style\n */\nexport function parseCheckedKeys(keys) {\n  if (!keys) {\n    return null;\n  }\n\n  // Convert keys to object format\n  var keyProps;\n  if (Array.isArray(keys)) {\n    // [Legacy] Follow the api doc\n    keyProps = {\n      checkedKeys: keys,\n      halfCheckedKeys: undefined\n    };\n  } else if (_typeof(keys) === 'object') {\n    keyProps = {\n      checkedKeys: keys.checked || undefined,\n      halfCheckedKeys: keys.halfChecked || undefined\n    };\n  } else {\n    warning(false, '`checkedKeys` is not an array or an object');\n    return null;\n  }\n  return keyProps;\n}\n\n/**\n * If user use `autoExpandParent` we should get the list of parent node\n * @param keyList\n * @param keyEntities\n */\nexport function conductExpandParent(keyList, keyEntities) {\n  var expandedKeys = new Set();\n  function conductUp(key) {\n    if (expandedKeys.has(key)) return;\n    var entity = getEntity(keyEntities, key);\n    if (!entity) return;\n    expandedKeys.add(key);\n    var parent = entity.parent,\n      node = entity.node;\n    if (node.disabled) return;\n    if (parent) {\n      conductUp(parent.key);\n    }\n  }\n  (keyList || []).forEach(function (key) {\n    conductUp(key);\n  });\n  return _toConsumableArray(expandedKeys);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/esm/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n// TODO: https://www.w3.org/TR/2017/NOTE-wai-aria-practices-1.1-20171214/examples/treeview/treeview-2/treeview-2a.html\n// Fully accessibility support\n\nimport classNames from 'classnames';\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport warning from \"rc-util/es/warning\";\nimport * as React from 'react';\nimport { TreeContext } from \"./contextTypes\";\nimport DropIndicator from \"./DropIndicator\";\nimport NodeList, { MOTION_KEY, MotionEntity } from \"./NodeList\";\nimport TreeNode from \"./TreeNode\";\nimport { arrAdd, arrDel, calcDropPosition, calcSelectedKeys, conductExpandParent, getDragChildrenKeys, parseCheckedKeys, posToArr } from \"./util\";\nimport { conductCheck } from \"./utils/conductUtil\";\nimport getEntity from \"./utils/keyUtil\";\nimport { convertDataToEntities, convertNodePropsToEventData, convertTreeToData, fillFieldNames, flattenTreeData, getTreeNodeProps, warningWithoutKey } from \"./utils/treeUtil\";\nvar MAX_RETRY_TIMES = 10;\nvar Tree = /*#__PURE__*/function (_React$Component) {\n  _inherits(Tree, _React$Component);\n  var _super = _createSuper(Tree);\n  function Tree() {\n    var _this;\n    _classCallCheck(this, Tree);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(_args));\n    _defineProperty(_assertThisInitialized(_this), \"destroyed\", false);\n    _defineProperty(_assertThisInitialized(_this), \"delayedDragEnterLogic\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"loadingRetryTimes\", {});\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      keyEntities: {},\n      indent: null,\n      selectedKeys: [],\n      checkedKeys: [],\n      halfCheckedKeys: [],\n      loadedKeys: [],\n      loadingKeys: [],\n      expandedKeys: [],\n      draggingNodeKey: null,\n      dragChildrenKeys: [],\n      // dropTargetKey is the key of abstract-drop-node\n      // the abstract-drop-node is the real drop node when drag and drop\n      // not the DOM drag over node\n      dropTargetKey: null,\n      dropPosition: null,\n      // the drop position of abstract-drop-node, inside 0, top -1, bottom 1\n      dropContainerKey: null,\n      // the container key of abstract-drop-node if dropPosition is -1 or 1\n      dropLevelOffset: null,\n      // the drop level offset of abstract-drag-over-node\n      dropTargetPos: null,\n      // the pos of abstract-drop-node\n      dropAllowed: true,\n      // if drop to abstract-drop-node is allowed\n      // the abstract-drag-over-node\n      // if mouse is on the bottom of top dom node or no the top of the bottom dom node\n      // abstract-drag-over-node is the top node\n      dragOverNodeKey: null,\n      treeData: [],\n      flattenNodes: [],\n      focused: false,\n      activeKey: null,\n      listChanging: false,\n      prevProps: null,\n      fieldNames: fillFieldNames()\n    });\n    _defineProperty(_assertThisInitialized(_this), \"dragStartMousePosition\", null);\n    _defineProperty(_assertThisInitialized(_this), \"dragNodeProps\", null);\n    _defineProperty(_assertThisInitialized(_this), \"currentMouseOverDroppableNodeKey\", null);\n    _defineProperty(_assertThisInitialized(_this), \"listRef\", /*#__PURE__*/React.createRef());\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragStart\", function (event, nodeProps) {\n      var _this$state = _this.state,\n        expandedKeys = _this$state.expandedKeys,\n        keyEntities = _this$state.keyEntities;\n      var onDragStart = _this.props.onDragStart;\n      var eventKey = nodeProps.eventKey;\n      _this.dragNodeProps = nodeProps;\n      _this.dragStartMousePosition = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      var newExpandedKeys = arrDel(expandedKeys, eventKey);\n      _this.setState({\n        draggingNodeKey: eventKey,\n        dragChildrenKeys: getDragChildrenKeys(eventKey, keyEntities),\n        indent: _this.listRef.current.getIndentWidth()\n      });\n      _this.setExpandedKeys(newExpandedKeys);\n      window.addEventListener('dragend', _this.onWindowDragEnd);\n      onDragStart === null || onDragStart === void 0 || onDragStart({\n        event: event,\n        node: convertNodePropsToEventData(nodeProps)\n      });\n    });\n    /**\n     * [Legacy] Select handler is smaller than node,\n     * so that this will trigger when drag enter node or select handler.\n     * This is a little tricky if customize css without padding.\n     * Better for use mouse move event to refresh drag state.\n     * But let's just keep it to avoid event trigger logic change.\n     */\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragEnter\", function (event, nodeProps) {\n      var _this$state2 = _this.state,\n        expandedKeys = _this$state2.expandedKeys,\n        keyEntities = _this$state2.keyEntities,\n        dragChildrenKeys = _this$state2.dragChildrenKeys,\n        flattenNodes = _this$state2.flattenNodes,\n        indent = _this$state2.indent;\n      var _this$props = _this.props,\n        onDragEnter = _this$props.onDragEnter,\n        onExpand = _this$props.onExpand,\n        allowDrop = _this$props.allowDrop,\n        direction = _this$props.direction;\n      var pos = nodeProps.pos,\n        eventKey = nodeProps.eventKey;\n\n      // record the key of node which is latest entered, used in dragleave event.\n      if (_this.currentMouseOverDroppableNodeKey !== eventKey) {\n        _this.currentMouseOverDroppableNodeKey = eventKey;\n      }\n      if (!_this.dragNodeProps) {\n        _this.resetDragState();\n        return;\n      }\n      var _calcDropPosition = calcDropPosition(event, _this.dragNodeProps, nodeProps, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),\n        dropPosition = _calcDropPosition.dropPosition,\n        dropLevelOffset = _calcDropPosition.dropLevelOffset,\n        dropTargetKey = _calcDropPosition.dropTargetKey,\n        dropContainerKey = _calcDropPosition.dropContainerKey,\n        dropTargetPos = _calcDropPosition.dropTargetPos,\n        dropAllowed = _calcDropPosition.dropAllowed,\n        dragOverNodeKey = _calcDropPosition.dragOverNodeKey;\n      if (\n      // don't allow drop inside its children\n      dragChildrenKeys.includes(dropTargetKey) ||\n      // don't allow drop when drop is not allowed caculated by calcDropPosition\n      !dropAllowed) {\n        _this.resetDragState();\n        return;\n      }\n\n      // Side effect for delay drag\n      if (!_this.delayedDragEnterLogic) {\n        _this.delayedDragEnterLogic = {};\n      }\n      Object.keys(_this.delayedDragEnterLogic).forEach(function (key) {\n        clearTimeout(_this.delayedDragEnterLogic[key]);\n      });\n      if (_this.dragNodeProps.eventKey !== nodeProps.eventKey) {\n        // hoist expand logic here\n        // since if logic is on the bottom\n        // it will be blocked by abstract dragover node check\n        //   => if you dragenter from top, you mouse will still be consider as in the top node\n        event.persist();\n        _this.delayedDragEnterLogic[pos] = window.setTimeout(function () {\n          if (_this.state.draggingNodeKey === null) {\n            return;\n          }\n          var newExpandedKeys = _toConsumableArray(expandedKeys);\n          var entity = getEntity(keyEntities, nodeProps.eventKey);\n          if (entity && (entity.children || []).length) {\n            newExpandedKeys = arrAdd(expandedKeys, nodeProps.eventKey);\n          }\n          if (!_this.props.hasOwnProperty('expandedKeys')) {\n            _this.setExpandedKeys(newExpandedKeys);\n          }\n          onExpand === null || onExpand === void 0 || onExpand(newExpandedKeys, {\n            node: convertNodePropsToEventData(nodeProps),\n            expanded: true,\n            nativeEvent: event.nativeEvent\n          });\n        }, 800);\n      }\n\n      // Skip if drag node is self\n      if (_this.dragNodeProps.eventKey === dropTargetKey && dropLevelOffset === 0) {\n        _this.resetDragState();\n        return;\n      }\n\n      // Update drag over node and drag state\n      _this.setState({\n        dragOverNodeKey: dragOverNodeKey,\n        dropPosition: dropPosition,\n        dropLevelOffset: dropLevelOffset,\n        dropTargetKey: dropTargetKey,\n        dropContainerKey: dropContainerKey,\n        dropTargetPos: dropTargetPos,\n        dropAllowed: dropAllowed\n      });\n      onDragEnter === null || onDragEnter === void 0 || onDragEnter({\n        event: event,\n        node: convertNodePropsToEventData(nodeProps),\n        expandedKeys: expandedKeys\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragOver\", function (event, nodeProps) {\n      var _this$state3 = _this.state,\n        dragChildrenKeys = _this$state3.dragChildrenKeys,\n        flattenNodes = _this$state3.flattenNodes,\n        keyEntities = _this$state3.keyEntities,\n        expandedKeys = _this$state3.expandedKeys,\n        indent = _this$state3.indent;\n      var _this$props2 = _this.props,\n        onDragOver = _this$props2.onDragOver,\n        allowDrop = _this$props2.allowDrop,\n        direction = _this$props2.direction;\n      if (!_this.dragNodeProps) {\n        return;\n      }\n      var _calcDropPosition2 = calcDropPosition(event, _this.dragNodeProps, nodeProps, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),\n        dropPosition = _calcDropPosition2.dropPosition,\n        dropLevelOffset = _calcDropPosition2.dropLevelOffset,\n        dropTargetKey = _calcDropPosition2.dropTargetKey,\n        dropContainerKey = _calcDropPosition2.dropContainerKey,\n        dropTargetPos = _calcDropPosition2.dropTargetPos,\n        dropAllowed = _calcDropPosition2.dropAllowed,\n        dragOverNodeKey = _calcDropPosition2.dragOverNodeKey;\n      if (dragChildrenKeys.includes(dropTargetKey) || !dropAllowed) {\n        // don't allow drop inside its children\n        // don't allow drop when drop is not allowed calculated by calcDropPosition\n        return;\n      }\n\n      // Update drag position\n\n      if (_this.dragNodeProps.eventKey === dropTargetKey && dropLevelOffset === 0) {\n        if (!(_this.state.dropPosition === null && _this.state.dropLevelOffset === null && _this.state.dropTargetKey === null && _this.state.dropContainerKey === null && _this.state.dropTargetPos === null && _this.state.dropAllowed === false && _this.state.dragOverNodeKey === null)) {\n          _this.resetDragState();\n        }\n      } else if (!(dropPosition === _this.state.dropPosition && dropLevelOffset === _this.state.dropLevelOffset && dropTargetKey === _this.state.dropTargetKey && dropContainerKey === _this.state.dropContainerKey && dropTargetPos === _this.state.dropTargetPos && dropAllowed === _this.state.dropAllowed && dragOverNodeKey === _this.state.dragOverNodeKey)) {\n        _this.setState({\n          dropPosition: dropPosition,\n          dropLevelOffset: dropLevelOffset,\n          dropTargetKey: dropTargetKey,\n          dropContainerKey: dropContainerKey,\n          dropTargetPos: dropTargetPos,\n          dropAllowed: dropAllowed,\n          dragOverNodeKey: dragOverNodeKey\n        });\n      }\n      onDragOver === null || onDragOver === void 0 || onDragOver({\n        event: event,\n        node: convertNodePropsToEventData(nodeProps)\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragLeave\", function (event, nodeProps) {\n      // if it is outside the droppable area\n      // currentMouseOverDroppableNodeKey will be updated in dragenter event when into another droppable receiver.\n      if (_this.currentMouseOverDroppableNodeKey === nodeProps.eventKey && !event.currentTarget.contains(event.relatedTarget)) {\n        _this.resetDragState();\n        _this.currentMouseOverDroppableNodeKey = null;\n      }\n      var onDragLeave = _this.props.onDragLeave;\n      onDragLeave === null || onDragLeave === void 0 || onDragLeave({\n        event: event,\n        node: convertNodePropsToEventData(nodeProps)\n      });\n    });\n    // since stopPropagation() is called in treeNode\n    // if onWindowDrag is called, whice means state is keeped, drag state should be cleared\n    _defineProperty(_assertThisInitialized(_this), \"onWindowDragEnd\", function (event) {\n      _this.onNodeDragEnd(event, null, true);\n      window.removeEventListener('dragend', _this.onWindowDragEnd);\n    });\n    // if onNodeDragEnd is called, onWindowDragEnd won't be called since stopPropagation() is called\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragEnd\", function (event, nodeProps) {\n      var onDragEnd = _this.props.onDragEnd;\n      _this.setState({\n        dragOverNodeKey: null\n      });\n      _this.cleanDragState();\n      onDragEnd === null || onDragEnd === void 0 || onDragEnd({\n        event: event,\n        node: convertNodePropsToEventData(nodeProps)\n      });\n      _this.dragNodeProps = null;\n      window.removeEventListener('dragend', _this.onWindowDragEnd);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDrop\", function (event, _) {\n      var _this$getActiveItem;\n      var outsideTree = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var _this$state4 = _this.state,\n        dragChildrenKeys = _this$state4.dragChildrenKeys,\n        dropPosition = _this$state4.dropPosition,\n        dropTargetKey = _this$state4.dropTargetKey,\n        dropTargetPos = _this$state4.dropTargetPos,\n        dropAllowed = _this$state4.dropAllowed;\n      if (!dropAllowed) {\n        return;\n      }\n      var onDrop = _this.props.onDrop;\n      _this.setState({\n        dragOverNodeKey: null\n      });\n      _this.cleanDragState();\n      if (dropTargetKey === null) return;\n      var abstractDropNodeProps = _objectSpread(_objectSpread({}, getTreeNodeProps(dropTargetKey, _this.getTreeNodeRequiredProps())), {}, {\n        active: ((_this$getActiveItem = _this.getActiveItem()) === null || _this$getActiveItem === void 0 ? void 0 : _this$getActiveItem.key) === dropTargetKey,\n        data: getEntity(_this.state.keyEntities, dropTargetKey).node\n      });\n      var dropToChild = dragChildrenKeys.includes(dropTargetKey);\n      warning(!dropToChild, \"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.\");\n      var posArr = posToArr(dropTargetPos);\n      var dropResult = {\n        event: event,\n        node: convertNodePropsToEventData(abstractDropNodeProps),\n        dragNode: _this.dragNodeProps ? convertNodePropsToEventData(_this.dragNodeProps) : null,\n        dragNodesKeys: [_this.dragNodeProps.eventKey].concat(dragChildrenKeys),\n        dropToGap: dropPosition !== 0,\n        dropPosition: dropPosition + Number(posArr[posArr.length - 1])\n      };\n      if (!outsideTree) {\n        onDrop === null || onDrop === void 0 || onDrop(dropResult);\n      }\n      _this.dragNodeProps = null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"cleanDragState\", function () {\n      var draggingNodeKey = _this.state.draggingNodeKey;\n      if (draggingNodeKey !== null) {\n        _this.setState({\n          draggingNodeKey: null,\n          dropPosition: null,\n          dropContainerKey: null,\n          dropTargetKey: null,\n          dropLevelOffset: null,\n          dropAllowed: true,\n          dragOverNodeKey: null\n        });\n      }\n      _this.dragStartMousePosition = null;\n      _this.currentMouseOverDroppableNodeKey = null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"triggerExpandActionExpand\", function (e, treeNode) {\n      var _this$state5 = _this.state,\n        expandedKeys = _this$state5.expandedKeys,\n        flattenNodes = _this$state5.flattenNodes;\n      var expanded = treeNode.expanded,\n        key = treeNode.key,\n        isLeaf = treeNode.isLeaf;\n      if (isLeaf || e.shiftKey || e.metaKey || e.ctrlKey) {\n        return;\n      }\n      var node = flattenNodes.filter(function (nodeItem) {\n        return nodeItem.key === key;\n      })[0];\n      var eventNode = convertNodePropsToEventData(_objectSpread(_objectSpread({}, getTreeNodeProps(key, _this.getTreeNodeRequiredProps())), {}, {\n        data: node.data\n      }));\n      _this.setExpandedKeys(expanded ? arrDel(expandedKeys, key) : arrAdd(expandedKeys, key));\n      _this.onNodeExpand(e, eventNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeClick\", function (e, treeNode) {\n      var _this$props3 = _this.props,\n        onClick = _this$props3.onClick,\n        expandAction = _this$props3.expandAction;\n      if (expandAction === 'click') {\n        _this.triggerExpandActionExpand(e, treeNode);\n      }\n      onClick === null || onClick === void 0 || onClick(e, treeNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDoubleClick\", function (e, treeNode) {\n      var _this$props4 = _this.props,\n        onDoubleClick = _this$props4.onDoubleClick,\n        expandAction = _this$props4.expandAction;\n      if (expandAction === 'doubleClick') {\n        _this.triggerExpandActionExpand(e, treeNode);\n      }\n      onDoubleClick === null || onDoubleClick === void 0 || onDoubleClick(e, treeNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeSelect\", function (e, treeNode) {\n      var selectedKeys = _this.state.selectedKeys;\n      var _this$state6 = _this.state,\n        keyEntities = _this$state6.keyEntities,\n        fieldNames = _this$state6.fieldNames;\n      var _this$props5 = _this.props,\n        onSelect = _this$props5.onSelect,\n        multiple = _this$props5.multiple;\n      var selected = treeNode.selected;\n      var key = treeNode[fieldNames.key];\n      var targetSelected = !selected;\n\n      // Update selected keys\n      if (!targetSelected) {\n        selectedKeys = arrDel(selectedKeys, key);\n      } else if (!multiple) {\n        selectedKeys = [key];\n      } else {\n        selectedKeys = arrAdd(selectedKeys, key);\n      }\n\n      // [Legacy] Not found related usage in doc or upper libs\n      var selectedNodes = selectedKeys.map(function (selectedKey) {\n        var entity = getEntity(keyEntities, selectedKey);\n        return entity ? entity.node : null;\n      }).filter(Boolean);\n      _this.setUncontrolledState({\n        selectedKeys: selectedKeys\n      });\n      onSelect === null || onSelect === void 0 || onSelect(selectedKeys, {\n        event: 'select',\n        selected: targetSelected,\n        node: treeNode,\n        selectedNodes: selectedNodes,\n        nativeEvent: e.nativeEvent\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeCheck\", function (e, treeNode, checked) {\n      var _this$state7 = _this.state,\n        keyEntities = _this$state7.keyEntities,\n        oriCheckedKeys = _this$state7.checkedKeys,\n        oriHalfCheckedKeys = _this$state7.halfCheckedKeys;\n      var _this$props6 = _this.props,\n        checkStrictly = _this$props6.checkStrictly,\n        onCheck = _this$props6.onCheck;\n      var key = treeNode.key;\n\n      // Prepare trigger arguments\n      var checkedObj;\n      var eventObj = {\n        event: 'check',\n        node: treeNode,\n        checked: checked,\n        nativeEvent: e.nativeEvent\n      };\n      if (checkStrictly) {\n        var checkedKeys = checked ? arrAdd(oriCheckedKeys, key) : arrDel(oriCheckedKeys, key);\n        var halfCheckedKeys = arrDel(oriHalfCheckedKeys, key);\n        checkedObj = {\n          checked: checkedKeys,\n          halfChecked: halfCheckedKeys\n        };\n        eventObj.checkedNodes = checkedKeys.map(function (checkedKey) {\n          return getEntity(keyEntities, checkedKey);\n        }).filter(Boolean).map(function (entity) {\n          return entity.node;\n        });\n        _this.setUncontrolledState({\n          checkedKeys: checkedKeys\n        });\n      } else {\n        // Always fill first\n        var _conductCheck = conductCheck([].concat(_toConsumableArray(oriCheckedKeys), [key]), true, keyEntities),\n          _checkedKeys = _conductCheck.checkedKeys,\n          _halfCheckedKeys = _conductCheck.halfCheckedKeys;\n\n        // If remove, we do it again to correction\n        if (!checked) {\n          var keySet = new Set(_checkedKeys);\n          keySet.delete(key);\n          var _conductCheck2 = conductCheck(Array.from(keySet), {\n            checked: false,\n            halfCheckedKeys: _halfCheckedKeys\n          }, keyEntities);\n          _checkedKeys = _conductCheck2.checkedKeys;\n          _halfCheckedKeys = _conductCheck2.halfCheckedKeys;\n        }\n        checkedObj = _checkedKeys;\n\n        // [Legacy] This is used for `rc-tree-select`\n        eventObj.checkedNodes = [];\n        eventObj.checkedNodesPositions = [];\n        eventObj.halfCheckedKeys = _halfCheckedKeys;\n        _checkedKeys.forEach(function (checkedKey) {\n          var entity = getEntity(keyEntities, checkedKey);\n          if (!entity) return;\n          var node = entity.node,\n            pos = entity.pos;\n          eventObj.checkedNodes.push(node);\n          eventObj.checkedNodesPositions.push({\n            node: node,\n            pos: pos\n          });\n        });\n        _this.setUncontrolledState({\n          checkedKeys: _checkedKeys\n        }, false, {\n          halfCheckedKeys: _halfCheckedKeys\n        });\n      }\n      onCheck === null || onCheck === void 0 || onCheck(checkedObj, eventObj);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeLoad\", function (treeNode) {\n      var _entity$children;\n      var key = treeNode.key;\n      var keyEntities = _this.state.keyEntities;\n\n      // Skip if has children already\n      var entity = getEntity(keyEntities, key);\n      if (entity !== null && entity !== void 0 && (_entity$children = entity.children) !== null && _entity$children !== void 0 && _entity$children.length) {\n        return;\n      }\n      var loadPromise = new Promise(function (resolve, reject) {\n        // We need to get the latest state of loading/loaded keys\n        _this.setState(function (_ref) {\n          var _ref$loadedKeys = _ref.loadedKeys,\n            loadedKeys = _ref$loadedKeys === void 0 ? [] : _ref$loadedKeys,\n            _ref$loadingKeys = _ref.loadingKeys,\n            loadingKeys = _ref$loadingKeys === void 0 ? [] : _ref$loadingKeys;\n          var _this$props7 = _this.props,\n            loadData = _this$props7.loadData,\n            onLoad = _this$props7.onLoad;\n          if (!loadData || loadedKeys.includes(key) || loadingKeys.includes(key)) {\n            return null;\n          }\n\n          // Process load data\n          var promise = loadData(treeNode);\n          promise.then(function () {\n            var currentLoadedKeys = _this.state.loadedKeys;\n            var newLoadedKeys = arrAdd(currentLoadedKeys, key);\n\n            // onLoad should trigger before internal setState to avoid `loadData` trigger twice.\n            // https://github.com/ant-design/ant-design/issues/12464\n            onLoad === null || onLoad === void 0 || onLoad(newLoadedKeys, {\n              event: 'load',\n              node: treeNode\n            });\n            _this.setUncontrolledState({\n              loadedKeys: newLoadedKeys\n            });\n            _this.setState(function (prevState) {\n              return {\n                loadingKeys: arrDel(prevState.loadingKeys, key)\n              };\n            });\n            resolve();\n          }).catch(function (e) {\n            _this.setState(function (prevState) {\n              return {\n                loadingKeys: arrDel(prevState.loadingKeys, key)\n              };\n            });\n\n            // If exceed max retry times, we give up retry\n            _this.loadingRetryTimes[key] = (_this.loadingRetryTimes[key] || 0) + 1;\n            if (_this.loadingRetryTimes[key] >= MAX_RETRY_TIMES) {\n              var currentLoadedKeys = _this.state.loadedKeys;\n              warning(false, 'Retry for `loadData` many times but still failed. No more retry.');\n              _this.setUncontrolledState({\n                loadedKeys: arrAdd(currentLoadedKeys, key)\n              });\n              resolve();\n            }\n            reject(e);\n          });\n          return {\n            loadingKeys: arrAdd(loadingKeys, key)\n          };\n        });\n      });\n\n      // Not care warning if we ignore this\n      loadPromise.catch(function () {});\n      return loadPromise;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeMouseEnter\", function (event, node) {\n      var onMouseEnter = _this.props.onMouseEnter;\n      onMouseEnter === null || onMouseEnter === void 0 || onMouseEnter({\n        event: event,\n        node: node\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeMouseLeave\", function (event, node) {\n      var onMouseLeave = _this.props.onMouseLeave;\n      onMouseLeave === null || onMouseLeave === void 0 || onMouseLeave({\n        event: event,\n        node: node\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeContextMenu\", function (event, node) {\n      var onRightClick = _this.props.onRightClick;\n      if (onRightClick) {\n        event.preventDefault();\n        onRightClick({\n          event: event,\n          node: node\n        });\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onFocus\", function () {\n      var onFocus = _this.props.onFocus;\n      _this.setState({\n        focused: true\n      });\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      onFocus === null || onFocus === void 0 || onFocus.apply(void 0, args);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onBlur\", function () {\n      var onBlur = _this.props.onBlur;\n      _this.setState({\n        focused: false\n      });\n      _this.onActiveChange(null);\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      onBlur === null || onBlur === void 0 || onBlur.apply(void 0, args);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getTreeNodeRequiredProps\", function () {\n      var _this$state8 = _this.state,\n        expandedKeys = _this$state8.expandedKeys,\n        selectedKeys = _this$state8.selectedKeys,\n        loadedKeys = _this$state8.loadedKeys,\n        loadingKeys = _this$state8.loadingKeys,\n        checkedKeys = _this$state8.checkedKeys,\n        halfCheckedKeys = _this$state8.halfCheckedKeys,\n        dragOverNodeKey = _this$state8.dragOverNodeKey,\n        dropPosition = _this$state8.dropPosition,\n        keyEntities = _this$state8.keyEntities;\n      return {\n        expandedKeys: expandedKeys || [],\n        selectedKeys: selectedKeys || [],\n        loadedKeys: loadedKeys || [],\n        loadingKeys: loadingKeys || [],\n        checkedKeys: checkedKeys || [],\n        halfCheckedKeys: halfCheckedKeys || [],\n        dragOverNodeKey: dragOverNodeKey,\n        dropPosition: dropPosition,\n        keyEntities: keyEntities\n      };\n    });\n    // =========================== Expanded ===========================\n    /** Set uncontrolled `expandedKeys`. This will also auto update `flattenNodes`. */\n    _defineProperty(_assertThisInitialized(_this), \"setExpandedKeys\", function (expandedKeys) {\n      var _this$state9 = _this.state,\n        treeData = _this$state9.treeData,\n        fieldNames = _this$state9.fieldNames;\n      var flattenNodes = flattenTreeData(treeData, expandedKeys, fieldNames);\n      _this.setUncontrolledState({\n        expandedKeys: expandedKeys,\n        flattenNodes: flattenNodes\n      }, true);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeExpand\", function (e, treeNode) {\n      var expandedKeys = _this.state.expandedKeys;\n      var _this$state10 = _this.state,\n        listChanging = _this$state10.listChanging,\n        fieldNames = _this$state10.fieldNames;\n      var _this$props8 = _this.props,\n        onExpand = _this$props8.onExpand,\n        loadData = _this$props8.loadData;\n      var expanded = treeNode.expanded;\n      var key = treeNode[fieldNames.key];\n\n      // Do nothing when motion is in progress\n      if (listChanging) {\n        return;\n      }\n\n      // Update selected keys\n      var certain = expandedKeys.includes(key);\n      var targetExpanded = !expanded;\n      warning(expanded && certain || !expanded && !certain, 'Expand state not sync with index check');\n      expandedKeys = targetExpanded ? arrAdd(expandedKeys, key) : arrDel(expandedKeys, key);\n      _this.setExpandedKeys(expandedKeys);\n      onExpand === null || onExpand === void 0 || onExpand(expandedKeys, {\n        node: treeNode,\n        expanded: targetExpanded,\n        nativeEvent: e.nativeEvent\n      });\n\n      // Async Load data\n      if (targetExpanded && loadData) {\n        var loadPromise = _this.onNodeLoad(treeNode);\n        if (loadPromise) {\n          loadPromise.then(function () {\n            // [Legacy] Refresh logic\n            var newFlattenTreeData = flattenTreeData(_this.state.treeData, expandedKeys, fieldNames);\n            _this.setUncontrolledState({\n              flattenNodes: newFlattenTreeData\n            });\n          }).catch(function () {\n            var currentExpandedKeys = _this.state.expandedKeys;\n            var expandedKeysToRestore = arrDel(currentExpandedKeys, key);\n            _this.setExpandedKeys(expandedKeysToRestore);\n          });\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onListChangeStart\", function () {\n      _this.setUncontrolledState({\n        listChanging: true\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onListChangeEnd\", function () {\n      setTimeout(function () {\n        _this.setUncontrolledState({\n          listChanging: false\n        });\n      });\n    });\n    // =========================== Keyboard ===========================\n    _defineProperty(_assertThisInitialized(_this), \"onActiveChange\", function (newActiveKey) {\n      var activeKey = _this.state.activeKey;\n      var _this$props9 = _this.props,\n        onActiveChange = _this$props9.onActiveChange,\n        _this$props9$itemScro = _this$props9.itemScrollOffset,\n        itemScrollOffset = _this$props9$itemScro === void 0 ? 0 : _this$props9$itemScro;\n      if (activeKey === newActiveKey) {\n        return;\n      }\n      _this.setState({\n        activeKey: newActiveKey\n      });\n      if (newActiveKey !== null) {\n        _this.scrollTo({\n          key: newActiveKey,\n          offset: itemScrollOffset\n        });\n      }\n      onActiveChange === null || onActiveChange === void 0 || onActiveChange(newActiveKey);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getActiveItem\", function () {\n      var _this$state11 = _this.state,\n        activeKey = _this$state11.activeKey,\n        flattenNodes = _this$state11.flattenNodes;\n      if (activeKey === null) {\n        return null;\n      }\n      return flattenNodes.find(function (_ref2) {\n        var key = _ref2.key;\n        return key === activeKey;\n      }) || null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"offsetActiveKey\", function (offset) {\n      var _this$state12 = _this.state,\n        flattenNodes = _this$state12.flattenNodes,\n        activeKey = _this$state12.activeKey;\n      var index = flattenNodes.findIndex(function (_ref3) {\n        var key = _ref3.key;\n        return key === activeKey;\n      });\n\n      // Align with index\n      if (index === -1 && offset < 0) {\n        index = flattenNodes.length;\n      }\n      index = (index + offset + flattenNodes.length) % flattenNodes.length;\n      var item = flattenNodes[index];\n      if (item) {\n        var _key4 = item.key;\n        _this.onActiveChange(_key4);\n      } else {\n        _this.onActiveChange(null);\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onKeyDown\", function (event) {\n      var _this$state13 = _this.state,\n        activeKey = _this$state13.activeKey,\n        expandedKeys = _this$state13.expandedKeys,\n        checkedKeys = _this$state13.checkedKeys,\n        fieldNames = _this$state13.fieldNames;\n      var _this$props10 = _this.props,\n        onKeyDown = _this$props10.onKeyDown,\n        checkable = _this$props10.checkable,\n        selectable = _this$props10.selectable;\n\n      // >>>>>>>>>> Direction\n      switch (event.which) {\n        case KeyCode.UP:\n          {\n            _this.offsetActiveKey(-1);\n            event.preventDefault();\n            break;\n          }\n        case KeyCode.DOWN:\n          {\n            _this.offsetActiveKey(1);\n            event.preventDefault();\n            break;\n          }\n      }\n\n      // >>>>>>>>>> Expand & Selection\n      var activeItem = _this.getActiveItem();\n      if (activeItem && activeItem.data) {\n        var treeNodeRequiredProps = _this.getTreeNodeRequiredProps();\n        var expandable = activeItem.data.isLeaf === false || !!(activeItem.data[fieldNames.children] || []).length;\n        var eventNode = convertNodePropsToEventData(_objectSpread(_objectSpread({}, getTreeNodeProps(activeKey, treeNodeRequiredProps)), {}, {\n          data: activeItem.data,\n          active: true\n        }));\n        switch (event.which) {\n          // >>> Expand\n          case KeyCode.LEFT:\n            {\n              // Collapse if possible\n              if (expandable && expandedKeys.includes(activeKey)) {\n                _this.onNodeExpand({}, eventNode);\n              } else if (activeItem.parent) {\n                _this.onActiveChange(activeItem.parent.key);\n              }\n              event.preventDefault();\n              break;\n            }\n          case KeyCode.RIGHT:\n            {\n              // Expand if possible\n              if (expandable && !expandedKeys.includes(activeKey)) {\n                _this.onNodeExpand({}, eventNode);\n              } else if (activeItem.children && activeItem.children.length) {\n                _this.onActiveChange(activeItem.children[0].key);\n              }\n              event.preventDefault();\n              break;\n            }\n\n          // Selection\n          case KeyCode.ENTER:\n          case KeyCode.SPACE:\n            {\n              if (checkable && !eventNode.disabled && eventNode.checkable !== false && !eventNode.disableCheckbox) {\n                _this.onNodeCheck({}, eventNode, !checkedKeys.includes(activeKey));\n              } else if (!checkable && selectable && !eventNode.disabled && eventNode.selectable !== false) {\n                _this.onNodeSelect({}, eventNode);\n              }\n              break;\n            }\n        }\n      }\n      onKeyDown === null || onKeyDown === void 0 || onKeyDown(event);\n    });\n    /**\n     * Only update the value which is not in props\n     */\n    _defineProperty(_assertThisInitialized(_this), \"setUncontrolledState\", function (state) {\n      var atomic = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var forceState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      if (!_this.destroyed) {\n        var needSync = false;\n        var allPassed = true;\n        var newState = {};\n        Object.keys(state).forEach(function (name) {\n          if (_this.props.hasOwnProperty(name)) {\n            allPassed = false;\n            return;\n          }\n          needSync = true;\n          newState[name] = state[name];\n        });\n        if (needSync && (!atomic || allPassed)) {\n          _this.setState(_objectSpread(_objectSpread({}, newState), forceState));\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"scrollTo\", function (scroll) {\n      _this.listRef.current.scrollTo(scroll);\n    });\n    return _this;\n  }\n  _createClass(Tree, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.destroyed = false;\n      this.onUpdated();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.onUpdated();\n    }\n  }, {\n    key: \"onUpdated\",\n    value: function onUpdated() {\n      var _this$props11 = this.props,\n        activeKey = _this$props11.activeKey,\n        _this$props11$itemScr = _this$props11.itemScrollOffset,\n        itemScrollOffset = _this$props11$itemScr === void 0 ? 0 : _this$props11$itemScr;\n      if (activeKey !== undefined && activeKey !== this.state.activeKey) {\n        this.setState({\n          activeKey: activeKey\n        });\n        if (activeKey !== null) {\n          this.scrollTo({\n            key: activeKey,\n            offset: itemScrollOffset\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('dragend', this.onWindowDragEnd);\n      this.destroyed = true;\n    }\n  }, {\n    key: \"resetDragState\",\n    value: function resetDragState() {\n      this.setState({\n        dragOverNodeKey: null,\n        dropPosition: null,\n        dropLevelOffset: null,\n        dropTargetKey: null,\n        dropContainerKey: null,\n        dropTargetPos: null,\n        dropAllowed: false\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state14 = this.state,\n        focused = _this$state14.focused,\n        flattenNodes = _this$state14.flattenNodes,\n        keyEntities = _this$state14.keyEntities,\n        draggingNodeKey = _this$state14.draggingNodeKey,\n        activeKey = _this$state14.activeKey,\n        dropLevelOffset = _this$state14.dropLevelOffset,\n        dropContainerKey = _this$state14.dropContainerKey,\n        dropTargetKey = _this$state14.dropTargetKey,\n        dropPosition = _this$state14.dropPosition,\n        dragOverNodeKey = _this$state14.dragOverNodeKey,\n        indent = _this$state14.indent;\n      var _this$props12 = this.props,\n        prefixCls = _this$props12.prefixCls,\n        className = _this$props12.className,\n        style = _this$props12.style,\n        showLine = _this$props12.showLine,\n        focusable = _this$props12.focusable,\n        _this$props12$tabInde = _this$props12.tabIndex,\n        tabIndex = _this$props12$tabInde === void 0 ? 0 : _this$props12$tabInde,\n        selectable = _this$props12.selectable,\n        showIcon = _this$props12.showIcon,\n        icon = _this$props12.icon,\n        switcherIcon = _this$props12.switcherIcon,\n        draggable = _this$props12.draggable,\n        checkable = _this$props12.checkable,\n        checkStrictly = _this$props12.checkStrictly,\n        disabled = _this$props12.disabled,\n        motion = _this$props12.motion,\n        loadData = _this$props12.loadData,\n        filterTreeNode = _this$props12.filterTreeNode,\n        height = _this$props12.height,\n        itemHeight = _this$props12.itemHeight,\n        scrollWidth = _this$props12.scrollWidth,\n        virtual = _this$props12.virtual,\n        titleRender = _this$props12.titleRender,\n        dropIndicatorRender = _this$props12.dropIndicatorRender,\n        onContextMenu = _this$props12.onContextMenu,\n        onScroll = _this$props12.onScroll,\n        direction = _this$props12.direction,\n        rootClassName = _this$props12.rootClassName,\n        rootStyle = _this$props12.rootStyle;\n      var domProps = pickAttrs(this.props, {\n        aria: true,\n        data: true\n      });\n\n      // It's better move to hooks but we just simply keep here\n      var draggableConfig;\n      if (draggable) {\n        if (_typeof(draggable) === 'object') {\n          draggableConfig = draggable;\n        } else if (typeof draggable === 'function') {\n          draggableConfig = {\n            nodeDraggable: draggable\n          };\n        } else {\n          draggableConfig = {};\n        }\n      }\n      var contextValue = {\n        prefixCls: prefixCls,\n        selectable: selectable,\n        showIcon: showIcon,\n        icon: icon,\n        switcherIcon: switcherIcon,\n        draggable: draggableConfig,\n        draggingNodeKey: draggingNodeKey,\n        checkable: checkable,\n        checkStrictly: checkStrictly,\n        disabled: disabled,\n        keyEntities: keyEntities,\n        dropLevelOffset: dropLevelOffset,\n        dropContainerKey: dropContainerKey,\n        dropTargetKey: dropTargetKey,\n        dropPosition: dropPosition,\n        dragOverNodeKey: dragOverNodeKey,\n        indent: indent,\n        direction: direction,\n        dropIndicatorRender: dropIndicatorRender,\n        loadData: loadData,\n        filterTreeNode: filterTreeNode,\n        titleRender: titleRender,\n        onNodeClick: this.onNodeClick,\n        onNodeDoubleClick: this.onNodeDoubleClick,\n        onNodeExpand: this.onNodeExpand,\n        onNodeSelect: this.onNodeSelect,\n        onNodeCheck: this.onNodeCheck,\n        onNodeLoad: this.onNodeLoad,\n        onNodeMouseEnter: this.onNodeMouseEnter,\n        onNodeMouseLeave: this.onNodeMouseLeave,\n        onNodeContextMenu: this.onNodeContextMenu,\n        onNodeDragStart: this.onNodeDragStart,\n        onNodeDragEnter: this.onNodeDragEnter,\n        onNodeDragOver: this.onNodeDragOver,\n        onNodeDragLeave: this.onNodeDragLeave,\n        onNodeDragEnd: this.onNodeDragEnd,\n        onNodeDrop: this.onNodeDrop\n      };\n      return /*#__PURE__*/React.createElement(TreeContext.Provider, {\n        value: contextValue\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames(prefixCls, className, rootClassName, _defineProperty(_defineProperty(_defineProperty({}, \"\".concat(prefixCls, \"-show-line\"), showLine), \"\".concat(prefixCls, \"-focused\"), focused), \"\".concat(prefixCls, \"-active-focused\"), activeKey !== null)),\n        style: rootStyle\n      }, /*#__PURE__*/React.createElement(NodeList, _extends({\n        ref: this.listRef,\n        prefixCls: prefixCls,\n        style: style,\n        data: flattenNodes,\n        disabled: disabled,\n        selectable: selectable,\n        checkable: !!checkable,\n        motion: motion,\n        dragging: draggingNodeKey !== null,\n        height: height,\n        itemHeight: itemHeight,\n        virtual: virtual,\n        focusable: focusable,\n        focused: focused,\n        tabIndex: tabIndex,\n        activeItem: this.getActiveItem(),\n        onFocus: this.onFocus,\n        onBlur: this.onBlur,\n        onKeyDown: this.onKeyDown,\n        onActiveChange: this.onActiveChange,\n        onListChangeStart: this.onListChangeStart,\n        onListChangeEnd: this.onListChangeEnd,\n        onContextMenu: onContextMenu,\n        onScroll: onScroll,\n        scrollWidth: scrollWidth\n      }, this.getTreeNodeRequiredProps(), domProps))));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, prevState) {\n      var prevProps = prevState.prevProps;\n      var newState = {\n        prevProps: props\n      };\n      function needSync(name) {\n        return !prevProps && props.hasOwnProperty(name) || prevProps && prevProps[name] !== props[name];\n      }\n\n      // ================== Tree Node ==================\n      var treeData;\n\n      // fieldNames\n      var fieldNames = prevState.fieldNames;\n      if (needSync('fieldNames')) {\n        fieldNames = fillFieldNames(props.fieldNames);\n        newState.fieldNames = fieldNames;\n      }\n\n      // Check if `treeData` or `children` changed and save into the state.\n      if (needSync('treeData')) {\n        treeData = props.treeData;\n      } else if (needSync('children')) {\n        warning(false, '`children` of Tree is deprecated. Please use `treeData` instead.');\n        treeData = convertTreeToData(props.children);\n      }\n\n      // Save flatten nodes info and convert `treeData` into keyEntities\n      if (treeData) {\n        newState.treeData = treeData;\n        var entitiesMap = convertDataToEntities(treeData, {\n          fieldNames: fieldNames\n        });\n        newState.keyEntities = _objectSpread(_defineProperty({}, MOTION_KEY, MotionEntity), entitiesMap.keyEntities);\n\n        // Warning if treeNode not provide key\n        if (process.env.NODE_ENV !== 'production') {\n          warningWithoutKey(treeData, fieldNames);\n        }\n      }\n      var keyEntities = newState.keyEntities || prevState.keyEntities;\n\n      // ================ expandedKeys =================\n      if (needSync('expandedKeys') || prevProps && needSync('autoExpandParent')) {\n        newState.expandedKeys = props.autoExpandParent || !prevProps && props.defaultExpandParent ? conductExpandParent(props.expandedKeys, keyEntities) : props.expandedKeys;\n      } else if (!prevProps && props.defaultExpandAll) {\n        var cloneKeyEntities = _objectSpread({}, keyEntities);\n        delete cloneKeyEntities[MOTION_KEY];\n\n        // Only take the key who has the children to enhance the performance\n        var nextExpandedKeys = [];\n        Object.keys(cloneKeyEntities).forEach(function (key) {\n          var entity = cloneKeyEntities[key];\n          if (entity.children && entity.children.length) {\n            nextExpandedKeys.push(entity.key);\n          }\n        });\n        newState.expandedKeys = nextExpandedKeys;\n      } else if (!prevProps && props.defaultExpandedKeys) {\n        newState.expandedKeys = props.autoExpandParent || props.defaultExpandParent ? conductExpandParent(props.defaultExpandedKeys, keyEntities) : props.defaultExpandedKeys;\n      }\n      if (!newState.expandedKeys) {\n        delete newState.expandedKeys;\n      }\n\n      // ================ flattenNodes =================\n      if (treeData || newState.expandedKeys) {\n        var flattenNodes = flattenTreeData(treeData || prevState.treeData, newState.expandedKeys || prevState.expandedKeys, fieldNames);\n        newState.flattenNodes = flattenNodes;\n      }\n\n      // ================ selectedKeys =================\n      if (props.selectable) {\n        if (needSync('selectedKeys')) {\n          newState.selectedKeys = calcSelectedKeys(props.selectedKeys, props);\n        } else if (!prevProps && props.defaultSelectedKeys) {\n          newState.selectedKeys = calcSelectedKeys(props.defaultSelectedKeys, props);\n        }\n      }\n\n      // ================= checkedKeys =================\n      if (props.checkable) {\n        var checkedKeyEntity;\n        if (needSync('checkedKeys')) {\n          checkedKeyEntity = parseCheckedKeys(props.checkedKeys) || {};\n        } else if (!prevProps && props.defaultCheckedKeys) {\n          checkedKeyEntity = parseCheckedKeys(props.defaultCheckedKeys) || {};\n        } else if (treeData) {\n          // If `treeData` changed, we also need check it\n          checkedKeyEntity = parseCheckedKeys(props.checkedKeys) || {\n            checkedKeys: prevState.checkedKeys,\n            halfCheckedKeys: prevState.halfCheckedKeys\n          };\n        }\n        if (checkedKeyEntity) {\n          var _checkedKeyEntity = checkedKeyEntity,\n            _checkedKeyEntity$che = _checkedKeyEntity.checkedKeys,\n            checkedKeys = _checkedKeyEntity$che === void 0 ? [] : _checkedKeyEntity$che,\n            _checkedKeyEntity$hal = _checkedKeyEntity.halfCheckedKeys,\n            halfCheckedKeys = _checkedKeyEntity$hal === void 0 ? [] : _checkedKeyEntity$hal;\n          if (!props.checkStrictly) {\n            var conductKeys = conductCheck(checkedKeys, true, keyEntities);\n            checkedKeys = conductKeys.checkedKeys;\n            halfCheckedKeys = conductKeys.halfCheckedKeys;\n          }\n          newState.checkedKeys = checkedKeys;\n          newState.halfCheckedKeys = halfCheckedKeys;\n        }\n      }\n\n      // ================= loadedKeys ==================\n      if (needSync('loadedKeys')) {\n        newState.loadedKeys = props.loadedKeys;\n      }\n      return newState;\n    }\n  }]);\n  return Tree;\n}(React.Component);\n_defineProperty(Tree, \"defaultProps\", {\n  prefixCls: 'rc-tree',\n  showLine: false,\n  showIcon: true,\n  selectable: true,\n  multiple: false,\n  checkable: false,\n  disabled: false,\n  checkStrictly: false,\n  draggable: false,\n  defaultExpandParent: true,\n  autoExpandParent: false,\n  defaultExpandAll: false,\n  defaultExpandedKeys: [],\n  defaultCheckedKeys: [],\n  defaultSelectedKeys: [],\n  dropIndicatorRender: DropIndicator,\n  allowDrop: function allowDrop() {\n    return true;\n  },\n  expandAction: false\n});\n_defineProperty(Tree, \"TreeNode\", TreeNode);\nexport default Tree;","import Tree from \"./Tree\";\nimport TreeNode from \"./TreeNode\";\nimport { UnstableContext } from \"./contextTypes\";\nexport { TreeNode, UnstableContext };\nexport default Tree;","import { css } from '@emotion/react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport function getGlobalStyles(theme: GrafanaTheme2) {\n  return css({\n    '.moveable-control-box': {\n      zIndex: 999,\n    },\n    '.rc-tree': {\n      margin: 0,\n      marginBottom: '15px',\n      border: '1px solid transparent',\n      '&-focused:not(&-active-focused)': {\n        borderColor: 'cyan',\n      },\n      '.rc-tree-title': {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        width: '100%',\n      },\n      '.rc-tree-treenode': {\n        margin: 0,\n        padding: '1px',\n        lineHeight: '24px',\n        whiteSpace: 'nowrap',\n        listStyle: 'none',\n        outline: 0,\n        display: 'flex',\n        marginBottom: '3px',\n        cursor: 'pointer',\n        '.draggable': {\n          color: '#333',\n          MozUserSelect: 'none',\n          KhtmlUserSelect: 'none',\n          WebkitUserSelect: 'none',\n          userSelect: 'none',\n        },\n        '&.drop-container': {\n          '> .draggable::after': {\n            position: 'absolute',\n            top: 0,\n            right: 0,\n            bottom: 0,\n            left: 0,\n            boxShadow: 'inset 0 0 0 2px blue',\n            content: '\"\"',\n          },\n          '& ~ .rc-tree-treenode': {\n            borderLeft: `2px solid ${theme.components.input.borderColor}`,\n          },\n        },\n        '&.drop-target': {\n          '& ~ .rc-tree-treenode': {\n            borderLeft: 'none',\n          },\n        },\n        '&.filter-node': {\n          '> .rc-tree-node-content-wrapper': {\n            color: '#a60000 !important',\n            fontWeight: 'bold !important',\n          },\n        },\n        ul: {\n          margin: 0,\n          padding: '0 0 0 18px',\n        },\n        '.rc-tree-node-content-wrapper': {\n          position: 'relative',\n          display: 'inline-block',\n          height: '24px',\n          margin: 0,\n          padding: 0,\n          textDecoration: 'none',\n          verticalAlign: 'top',\n          cursor: 'grab',\n          flexGrow: 1,\n          border: `1px solid ${theme.components.input.borderColor}`,\n          borderRadius: `${theme.shape.radius.default}`,\n          background: `${theme.colors.background.secondary}`,\n          minHeight: `${theme.spacing.gridSize * 4}px`,\n          '&:hover': {\n            border: `1px solid ${theme.components.input.borderHover}`,\n          },\n          '&.rc-tree-node-selected': {\n            border: `1px solid ${theme.colors.primary.border}`,\n            opacity: 1,\n          },\n        },\n        span: {\n          height: '100%',\n          '&.rc-tree-checkbox, &.rc-tree-iconEle': {\n            display: 'inline-block',\n            width: '16px',\n            height: '16px',\n            marginRight: '2px',\n            lineHeight: '16px',\n            verticalAlign: '-0.125em',\n            backgroundColor: 'transparent',\n            backgroundRepeat: 'no-repeat',\n            backgroundAttachment: 'scroll',\n            border: '0 none',\n            outline: 'none',\n            cursor: 'pointer',\n            '&.rc-tree-icon__customize': {\n              backgroundImage: 'none',\n            },\n          },\n          '&.rc-tree-switcher': {\n            display: 'flex',\n            alignItems: 'center',\n            width: '16px',\n            height: 'auto',\n            backgroundColor: 'transparent',\n            backgroundRepeat: 'no-repeat',\n            backgroundAttachment: 'scroll',\n            border: '0 none',\n            outline: 'none',\n            cursor: 'pointer',\n            '&.rc-tree-icon__customize': {\n              backgroundImage: 'none',\n            },\n            '&.rc-tree-switcher-noop': {\n              cursor: 'auto',\n            },\n            '&.rc-tree-switcher_open': {\n              backgroundPosition: '-93px -56px',\n            },\n            '&.rc-tree-switcher_close': {\n              backgroundPosition: '-75px -56px',\n            },\n          },\n          '&.rc-tree-icon_loading': {\n            marginRight: '2px',\n            verticalAlign: 'top',\n            background:\n              \"url('data:image/gif;base64,R0lGODlhEAAQAKIGAMLY8YSx5HOm4Mjc88/g9Ofw+v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAGACwAAAAAEAAQAAADMGi6RbUwGjKIXCAA016PgRBElAVlG/RdLOO0X9nK61W39qvqiwz5Ls/rRqrggsdkAgAh+QQFCgAGACwCAAAABwAFAAADD2hqELAmiFBIYY4MAutdCQAh+QQFCgAGACwGAAAABwAFAAADD1hU1kaDOKMYCGAGEeYFCQAh+QQFCgAGACwKAAIABQAHAAADEFhUZjSkKdZqBQG0IELDQAIAIfkEBQoABgAsCgAGAAUABwAAAxBoVlRKgyjmlAIBqCDCzUoCACH5BAUKAAYALAYACgAHAAUAAAMPaGpFtYYMAgJgLogA610JACH5BAUKAAYALAIACgAHAAUAAAMPCAHWFiI4o1ghZZJB5i0JACH5BAUKAAYALAAABgAFAAcAAAMQCAFmIaEp1motpDQySMNFAgA7') no-repeat scroll 0 0 transparent\",\n          },\n          '&.rc-tree-checkbox': {\n            width: '13px',\n            height: '13px',\n            margin: '0 3px',\n            backgroundPosition: '0 0',\n            '&-checked': {\n              backgroundPosition: '-14px 0',\n            },\n            '&-indeterminate': {\n              backgroundPosition: '-14px -28px',\n            },\n            '&-disabled': {\n              backgroundPosition: '0 -56px',\n            },\n            '&.rc-tree-checkbox-checked.rc-tree-checkbox-disabled': {\n              backgroundPosition: '-14px -56px',\n            },\n            '&.rc-tree-checkbox-indeterminate.rc-tree-checkbox-disabled': {\n              position: 'relative',\n              background: '#ccc',\n              borderRadius: theme.shape.radius.default,\n              '&::after': {\n                position: 'absolute',\n                top: '5px',\n                left: '3px',\n                width: '5px',\n                height: 0,\n                border: '2px solid #fff',\n                borderTop: 0,\n                borderLeft: 0,\n                WebkitTransform: 'scale(1)',\n                transform: 'scale(1)',\n                content: '\" \"',\n              },\n            },\n          },\n        },\n      },\n      '&:not(.rc-tree-show-line)': {\n        '.rc-tree-treenode': {\n          '.rc-tree-switcher-noop': {\n            background: 'none',\n          },\n        },\n      },\n      '&.rc-tree-show-line': {\n        '.rc-tree-treenode:not(:last-child)': {\n          '> ul': {\n            background:\n              \"url('data:image/gif;base64,R0lGODlhCQACAIAAAMzMzP///yH5BAEAAAEALAAAAAAJAAIAAAIEjI9pUAA7') 0 0 repeat-y\",\n          },\n          '> .rc-tree-switcher-noop': {\n            backgroundPosition: '-56px -18px',\n          },\n        },\n        '.rc-tree-treenode:last-child': {\n          '> .rc-tree-switcher-noop': {\n            backgroundPosition: '-56px -36px',\n          },\n        },\n      },\n      '&-child-tree': {\n        display: 'none',\n        '&-open': {\n          display: 'block',\n        },\n      },\n      '&-treenode-disabled': {\n        '> span:not(.rc-tree-switcher), > a, > a span': {\n          color: '#767676',\n          cursor: 'not-allowed',\n        },\n      },\n      '&-treenode-active': {\n        background: 'rgba(0, 0, 0, 0.1)',\n      },\n      '&-node-selected': {\n        opacity: 0.8,\n      },\n      '&-icon__open': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px -16px',\n      },\n      '&-icon__close': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px 0',\n      },\n      '&-icon__docu': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px -32px',\n      },\n      '&-icon__customize': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n      },\n      '&-title': {\n        display: 'inline-block',\n      },\n      '&-indent': {\n        display: 'inline-block',\n        height: 0,\n        verticalAlign: 'bottom',\n      },\n      '&-indent-unit': {\n        display: 'inline-block',\n        width: '16px',\n      },\n      '&-draggable-icon': {\n        display: 'inline-flex',\n        justifyContent: 'center',\n        width: '16px',\n      },\n    },\n  });\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { IconButton, useStyles2 } from '@grafana/ui';\nimport { LayerName } from 'app/core/components/Layers/LayerName';\nimport { ElementState } from 'app/features/canvas/runtime/element';\n\nimport { LayerActionID } from '../../types';\nimport { TreeViewEditorProps } from '../element/elementEditor';\n\nimport { TreeElement } from './tree';\n\ninterface Props {\n  settings: TreeViewEditorProps;\n  nodeData: TreeElement;\n  setAllowSelection: (allow: boolean) => void;\n}\n\nexport const TreeNodeTitle = ({ settings, nodeData, setAllowSelection }: Props) => {\n  const element = nodeData.dataRef;\n  const name = nodeData.dataRef.getName();\n\n  const styles = useStyles2(getStyles);\n\n  const layer = settings.layer;\n\n  const getScene = () => {\n    if (!settings?.layer) {\n      return;\n    }\n\n    return settings.layer.scene;\n  };\n\n  const onDelete = (element: ElementState) => {\n    const elLayer = element.parent ?? layer;\n    elLayer.doAction(LayerActionID.Delete, element);\n    setAllowSelection(false);\n  };\n\n  const onDuplicate = (element: ElementState) => {\n    const elLayer = element.parent ?? layer;\n    elLayer.doAction(LayerActionID.Duplicate, element);\n    setAllowSelection(false);\n  };\n\n  const onNameChange = (element: ElementState, name: string) => {\n    element.onChange({ ...element.options, name });\n  };\n\n  const verifyLayerNameUniqueness = (nameToVerify: string) => {\n    const scene = getScene();\n\n    return Boolean(scene?.canRename(nameToVerify));\n  };\n\n  const getLayerInfo = (element: ElementState) => {\n    return element.options.type;\n  };\n\n  return (\n    <>\n      <LayerName\n        name={name}\n        onChange={(v) => onNameChange(element, v)}\n        verifyLayerNameUniqueness={verifyLayerNameUniqueness ?? undefined}\n      />\n\n      <div className={styles.textWrapper}>&nbsp; {getLayerInfo(element)}</div>\n\n      {!nodeData.children && (\n        <div className={styles.actionButtonsWrapper}>\n          <IconButton\n            name=\"copy\"\n            title={t('canvas.tree-node-title.title-duplicate', 'Duplicate')}\n            className={styles.actionIcon}\n            onClick={() => onDuplicate(element)}\n            tooltip={t('canvas.tree-node-title.tooltip-duplicate', 'Duplicate')}\n          />\n          <IconButton\n            name=\"trash-alt\"\n            title={t('canvas.tree-node-title.title-remove', 'Remove')}\n            className={styles.actionIcon}\n            onClick={() => onDelete(element)}\n            tooltip={t('canvas.tree-node-title.tooltip-remove', 'Remove')}\n          />\n        </div>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  actionButtonsWrapper: css({\n    display: 'flex',\n    alignItems: 'flex-end',\n  }),\n  actionIcon: css({\n    color: theme.colors.text.secondary,\n    cursor: 'pointer',\n    '&:hover': {\n      color: theme.colors.text.primary,\n    },\n  }),\n  textWrapper: css({\n    display: 'flex',\n    alignItems: 'center',\n    flexGrow: 1,\n    overflow: 'hidden',\n    marginRight: theme.spacing(1),\n  }),\n  layerName: css({\n    fontWeight: theme.typography.fontWeightMedium,\n    color: theme.colors.primary.text,\n    cursor: 'pointer',\n    overflow: 'hidden',\n    marginLeft: theme.spacing(0.5),\n  }),\n});\n","import { CSSProperties } from 'react';\n\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { RootElement } from 'app/features/canvas/runtime/root';\n\nimport { DragNode, DropNode } from '../../types';\n\nexport interface TreeElement {\n  key: number;\n  title: string;\n  selectable?: boolean;\n  children?: TreeElement[];\n  dataRef: ElementState | FrameState;\n  style?: CSSProperties;\n}\n\nexport function getTreeData(root?: RootElement | FrameState, selection?: string[], selectedColor?: string) {\n  let elements: TreeElement[] = [];\n  if (root) {\n    for (let i = root.elements.length; i--; i >= 0) {\n      const item = root.elements[i];\n      const element: TreeElement = {\n        key: item.UID,\n        title: item.getName(),\n        selectable: true,\n        dataRef: item,\n      };\n\n      if (item instanceof FrameState) {\n        element.children = getTreeData(item, selection, selectedColor);\n      }\n      elements.push(element);\n    }\n  }\n\n  return elements;\n}\n\nexport function onNodeDrop(\n  info: { node: DropNode; dragNode: DragNode; dropPosition: number; dropToGap: boolean },\n  treeData: TreeElement[]\n) {\n  const destKey = info.node.key;\n  const srcKey = info.dragNode.key;\n  const destPos = info.node.pos.split('-');\n  const destPosition = info.dropPosition - Number(destPos[destPos.length - 1]);\n\n  const loop = (\n    data: TreeElement[],\n    key: number,\n    callback: { (item: TreeElement, index: number, arr: TreeElement[]): void }\n  ) => {\n    data.forEach((item, index, arr) => {\n      if (item.key === key) {\n        callback(item, index, arr);\n        return;\n      }\n      if (item.children) {\n        loop(item.children, key, callback);\n      }\n    });\n  };\n  const data = [...treeData];\n\n  // Find dragObject\n  let srcElement: TreeElement | undefined = undefined;\n  loop(data, srcKey, (item: TreeElement, index: number, arr: TreeElement[]) => {\n    arr.splice(index, 1);\n    srcElement = item;\n  });\n\n  if (destPosition === 0) {\n    // Drop on the content\n    loop(data, destKey, (item: TreeElement) => {\n      item.children = item.children || [];\n      item.children.unshift(srcElement!);\n    });\n  } else {\n    // Drop on the gap (insert before or insert after)\n    let ar: TreeElement[] = [];\n    let i = 0;\n    loop(data, destKey, (item: TreeElement, index: number, arr: TreeElement[]) => {\n      ar = arr;\n      i = index;\n    });\n\n    if (destPosition === -1) {\n      ar.splice(i, 0, srcElement!);\n    } else {\n      ar.splice(i + 1, 0, srcElement!);\n    }\n  }\n\n  return data;\n}\n","import { css } from '@emotion/css';\nimport { Global } from '@emotion/react';\nimport Tree, { TreeNodeProps } from 'rc-tree';\nimport { Key, useEffect, useMemo, useState } from 'react';\n\nimport { GrafanaTheme2, StandardEditorProps } from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { config } from '@grafana/runtime';\nimport { Button, Icon, Stack, useStyles2, useTheme2 } from '@grafana/ui';\nimport { AddLayerButton } from 'app/core/components/Layers/AddLayerButton';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { frameSelection, reorderElements } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { getGlobalStyles } from '../../globalStyles';\nimport { Options } from '../../panelcfg.gen';\nimport { DragNode, DropNode } from '../../types';\nimport { doSelect, getElementTypes, onAddItem } from '../../utils';\nimport { TreeViewEditorProps } from '../element/elementEditor';\n\nimport { TreeNodeTitle } from './TreeNodeTitle';\nimport { getTreeData, onNodeDrop, TreeElement } from './tree';\n\nlet allowSelection = true;\n\nexport const TreeNavigationEditor = ({ item }: StandardEditorProps<unknown, TreeViewEditorProps, Options>) => {\n  const [treeData, setTreeData] = useState(getTreeData(item?.settings?.scene.root));\n  const [autoExpandParent, setAutoExpandParent] = useState(true);\n  const [expandedKeys, setExpandedKeys] = useState<Key[]>([]);\n  const [selectedKeys, setSelectedKeys] = useState<Key[]>([]);\n\n  const theme = useTheme2();\n  const globalCSS = getGlobalStyles(theme);\n  const styles = useStyles2(getStyles);\n\n  const selectedBgColor = theme.colors.primary.border;\n  const { settings } = item;\n  const selection = useMemo(\n    () => (settings?.selected ? settings.selected.map((v) => v?.getName()) : []),\n    [settings?.selected]\n  );\n\n  const selectionByUID = useMemo(\n    () => (settings?.selected ? settings.selected.map((v) => v?.UID) : []),\n    [settings?.selected]\n  );\n\n  useEffect(() => {\n    setTreeData(getTreeData(item?.settings?.scene.root, selection, selectedBgColor));\n    setSelectedKeys(selectionByUID);\n    setAllowSelection();\n  }, [item?.settings?.scene.root, selectedBgColor, selection, selectionByUID]);\n\n  if (!settings) {\n    return (\n      <div>\n        <Trans i18nKey=\"canvas.tree-navigation-editor.no-settings\">No settings</Trans>\n      </div>\n    );\n  }\n\n  const layer = settings.layer;\n  if (!layer) {\n    return (\n      <div>\n        <Trans i18nKey=\"canvas.tree-navigation-editor.missing-layer\">Missing layer?</Trans>\n      </div>\n    );\n  }\n\n  const onSelect = (selectedKeys: Key[], info: { node: { dataRef: ElementState } }) => {\n    if (allowSelection && item.settings?.scene) {\n      doSelect(item.settings.scene, info.node.dataRef);\n    }\n  };\n\n  const allowDrop = () => {\n    return true;\n  };\n\n  const onDrop = (info: { node: DropNode; dragNode: DragNode; dropPosition: number; dropToGap: boolean }) => {\n    const destPos = info.node.pos.split('-');\n    const destPosition = info.dropPosition - Number(destPos[destPos.length - 1]);\n\n    const srcEl = info.dragNode.dataRef;\n    const destEl = info.node.dataRef;\n\n    const data = onNodeDrop(info, treeData);\n\n    setTreeData(data);\n    reorderElements(srcEl, destEl, info.dropToGap, destPosition);\n  };\n\n  const onExpand = (expandedKeys: Key[]) => {\n    setExpandedKeys(expandedKeys);\n    setAutoExpandParent(false);\n  };\n\n  const switcherIcon = (obj: TreeNodeProps) => {\n    if (obj.isLeaf) {\n      // TODO: Implement element specific icons\n      return <></>;\n    }\n\n    return (\n      <Icon\n        name=\"angle-right\"\n        title={t('canvas.tree-navigation-editor.switcher-icon.title-node-icon', 'Node Icon')}\n        style={{\n          transform: `rotate(${obj.expanded ? 90 : 0}deg)`,\n          fill: theme.colors.text.primary,\n        }}\n      />\n    );\n  };\n\n  const setAllowSelection = (allow = true) => {\n    allowSelection = allow;\n  };\n\n  const onClearSelection = () => {\n    layer.scene.clearCurrentSelection();\n  };\n\n  const onTitleRender = (nodeData: TreeElement) => {\n    return <TreeNodeTitle nodeData={nodeData} setAllowSelection={setAllowSelection} settings={settings} />;\n  };\n\n  // TODO: This functionality is currently kinda broken / no way to decouple / delete created frames at this time\n  const onFrameSelection = () => {\n    if (layer.scene) {\n      frameSelection(layer.scene);\n    } else {\n      console.warn('no scene!');\n    }\n  };\n\n  const typeOptions = getElementTypes(settings.scene.shouldShowAdvancedTypes).options;\n\n  return (\n    <>\n      <Global styles={globalCSS} />\n      <Tree\n        selectable={true}\n        onSelect={onSelect}\n        draggable={true}\n        defaultExpandAll={true}\n        autoExpandParent={autoExpandParent}\n        showIcon={false}\n        allowDrop={allowDrop}\n        onDrop={onDrop}\n        expandedKeys={expandedKeys}\n        onExpand={onExpand}\n        treeData={treeData}\n        titleRender={onTitleRender}\n        switcherIcon={switcherIcon}\n        selectedKeys={selectedKeys}\n        multiple={true}\n      />\n\n      <Stack justifyContent=\"space-between\" direction=\"row\">\n        <div className={styles.addLayerButton}>\n          <AddLayerButton\n            onChange={(sel) => onAddItem(sel, layer)}\n            options={typeOptions}\n            label={t('canvas.tree-navigation-editor.label-add-item', 'Add item')}\n          />\n        </div>\n        {selection.length > 0 && (\n          <Button size=\"sm\" variant=\"secondary\" onClick={onClearSelection}>\n            <Trans i18nKey=\"canvas.tree-navigation-editor.clear-selection\">Clear selection</Trans>\n          </Button>\n        )}\n        {selection.length > 1 && config.featureToggles.canvasPanelNesting && (\n          <Button size=\"sm\" variant=\"secondary\" onClick={onFrameSelection}>\n            <Trans i18nKey=\"canvas.tree-navigation-editor.frame-selection\">Frame selection</Trans>\n          </Button>\n        )}\n      </Stack>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  addLayerButton: css({\n    marginLeft: '18px',\n    minWidth: '150px',\n  }),\n});\n","import { get as lodashGet } from 'lodash';\n\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/internal';\nimport { t } from '@grafana/i18n';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { InstanceState } from '../../CanvasPanel';\nimport { PlacementEditor } from '../element/PlacementEditor';\nimport { optionBuilder } from '../options';\n\nimport { TreeNavigationEditor } from './TreeNavigationEditor';\n\nexport interface LayerEditorProps {\n  scene: Scene;\n  layer: FrameState;\n  selected: ElementState[];\n}\n\nexport function getLayerEditor(opts: InstanceState): NestedPanelOptions<LayerEditorProps> {\n  const { selected, scene } = opts;\n\n  if (!scene.currentLayer) {\n    scene.currentLayer = scene.root;\n  }\n\n  if (selected) {\n    for (const element of selected) {\n      if (element instanceof FrameState) {\n        scene.currentLayer = element;\n        break;\n      }\n\n      if (element && element.parent) {\n        scene.currentLayer = element.parent;\n        break;\n      }\n    }\n  }\n\n  const options = scene.currentLayer.options || { elements: [] };\n\n  return {\n    category: [t('canvas.layer-editor.category-layer', 'Layer')],\n    path: '--', // not used!\n\n    // Note that canvas editor writes things to the scene!\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path) => {\n        return lodashGet(options, path);\n      },\n      onChange: (path, value) => {\n        if (path === 'type' && value) {\n          console.warn('unable to change layer type');\n          return;\n        }\n        const c = setOptionImmutably(options, path, value);\n        scene.currentLayer?.onChange(c);\n        scene.currentLayer?.updateData(scene.context);\n      },\n    }),\n\n    // Dynamically fill the selected element\n    build: (builder, context) => {\n      const currentLayer = scene.currentLayer;\n      if (currentLayer && !currentLayer.isRoot()) {\n        // TODO: the non-root nav option\n      }\n\n      builder.addCustomEditor({\n        id: 'content',\n        path: 'root',\n        name: t('canvas.layer-editor.name-elements', 'Elements'),\n        editor: TreeNavigationEditor,\n        settings: { scene, layer: scene.currentLayer, selected },\n      });\n\n      const ctx = { ...context, options };\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n      optionBuilder.addBackground(builder as any, ctx);\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n      optionBuilder.addBorder(builder as any, ctx);\n\n      if (currentLayer && !currentLayer.isRoot()) {\n        builder.addCustomEditor({\n          category: [t('canvas.layer-editor.category-layout', 'Layout')],\n          id: 'content',\n          path: '__', // not used\n          name: t('canvas.layer-editor.name-constraints', 'Constraints'),\n          editor: PlacementEditor,\n          settings: {\n            scene: opts.scene,\n            element: currentLayer,\n          },\n        });\n      }\n    },\n  };\n}\n","import { useState } from 'react';\n\nimport { Tab, TabsBar } from '@grafana/ui';\n\nimport { InlineEditTabs } from '../../types';\n\ntype Props = {\n  onTabChange: (v: string) => void;\n};\n\nexport const TabsEditor = ({ onTabChange }: Props) => {\n  const [activeTab, setActiveTab] = useState<string>(InlineEditTabs.SelectedElement);\n\n  const tabs = [\n    { label: 'Selected Element', value: InlineEditTabs.SelectedElement },\n    { label: 'Element Management', value: InlineEditTabs.ElementManagement },\n  ];\n\n  const onCurrentTabChange = (value: string) => {\n    onTabChange(value);\n    setActiveTab(value);\n  };\n\n  return (\n    <>\n      <TabsBar>\n        {tabs.map((t, index) => (\n          <Tab\n            key={`${t.value}-${index}`}\n            label={t.label}\n            active={t.value === activeTab}\n            onChangeTab={() => onCurrentTabChange(t.value!)}\n          />\n        ))}\n      </TabsBar>\n    </>\n  );\n};\n","import { css } from '@emotion/css';\nimport { get as lodashGet } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { useObservable } from 'react-use';\n\nimport { DataFrame, GrafanaTheme2, PanelOptionsEditorBuilder, StandardEditorContext } from '@grafana/data';\nimport { NestedValueAccess, PanelOptionsSupplier } from '@grafana/data/internal';\nimport { Trans, t } from '@grafana/i18n';\nimport { useStyles2 } from '@grafana/ui';\nimport { AddLayerButton } from 'app/core/components/Layers/AddLayerButton';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { OptionsPaneCategory } from 'app/features/dashboard/components/PanelEditor/OptionsPaneCategory';\nimport { OptionsPaneCategoryDescriptor } from 'app/features/dashboard/components/PanelEditor/OptionsPaneCategoryDescriptor';\nimport { fillOptionsPaneItems } from 'app/features/dashboard/components/PanelEditor/getVisualizationOptions';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { activePanelSubject, InstanceState } from '../../CanvasPanel';\nimport { addStandardCanvasEditorOptions } from '../../module';\nimport { Options } from '../../panelcfg.gen';\nimport { InlineEditTabs } from '../../types';\nimport { getElementTypes, onAddItem } from '../../utils';\nimport { getConnectionEditor } from '../connectionEditor';\nimport { getElementEditor } from '../element/elementEditor';\nimport { getLayerEditor } from '../layer/layerEditor';\n\nimport { TabsEditor } from './TabsEditor';\n\nexport function InlineEditBody() {\n  const activePanel = useObservable(activePanelSubject);\n  const instanceState = activePanel?.panel.context?.instanceState;\n  const styles = useStyles2(getStyles);\n\n  const [activeTab, setActiveTab] = useState<string>(InlineEditTabs.SelectedElement);\n\n  const pane = useMemo(() => {\n    const p = activePanel?.panel;\n    const state: InstanceState = instanceState;\n    if (!(state && state.scene) || !p) {\n      return new OptionsPaneCategoryDescriptor({ id: 'root', title: 'root' });\n    }\n\n    const supplier = (builder: PanelOptionsEditorBuilder<Options>) => {\n      if (activeTab === InlineEditTabs.ElementManagement) {\n        builder.addNestedOptions(getLayerEditor(instanceState));\n      }\n\n      const selectedConnection = state.selectedConnection;\n      if (selectedConnection && activeTab === InlineEditTabs.SelectedElement) {\n        builder.addNestedOptions(\n          getConnectionEditor({\n            category: [`Selected connection`],\n            connection: selectedConnection,\n            scene: state.scene,\n          })\n        );\n      }\n\n      const selection = state.selected;\n      if (selection?.length === 1 && activeTab === InlineEditTabs.SelectedElement) {\n        const element = selection[0];\n        if (element && !(element instanceof FrameState)) {\n          builder.addNestedOptions(\n            getElementEditor({\n              category: [\n                t('canvas.inline-edit-body.category-selected-element', 'Selected element ({{element}})', {\n                  element: element.options.name,\n                }),\n              ],\n              element,\n              scene: state.scene,\n            })\n          );\n        }\n      }\n\n      addStandardCanvasEditorOptions(builder);\n    };\n\n    return getOptionsPaneCategoryDescriptor(\n      {\n        options: p.props.options,\n        onChange: p.props.onOptionsChange,\n        data: p.props.data?.series,\n      },\n      supplier\n    );\n  }, [instanceState, activePanel, activeTab]);\n\n  const topLevelItemsContainerStyle = {\n    marginLeft: 15,\n    marginTop: 10,\n  };\n\n  const onTabChange = (tab: string) => {\n    setActiveTab(tab);\n  };\n\n  const typeOptions = getElementTypes(instanceState?.scene.shouldShowAdvancedTypes).options;\n  const rootLayer: FrameState | undefined = instanceState?.layer;\n\n  const noElementSelected =\n    instanceState &&\n    activeTab === InlineEditTabs.SelectedElement &&\n    instanceState.selected.length === 0 &&\n    instanceState.selectedConnection === undefined;\n\n  return (\n    <>\n      <div style={topLevelItemsContainerStyle}>{pane.items.map((item) => item.render())}</div>\n      <div style={topLevelItemsContainerStyle}>\n        <AddLayerButton\n          onChange={(sel) => onAddItem(sel, rootLayer)}\n          options={typeOptions}\n          label={t('canvas.inline-edit-body.label-add-item', 'Add item')}\n        />\n      </div>\n      <div style={topLevelItemsContainerStyle}>\n        <TabsEditor onTabChange={onTabChange} />\n        {pane.categories.map((p) => renderOptionsPaneCategoryDescriptor(p))}\n        {noElementSelected && (\n          <div className={styles.selectElement}>\n            <Trans i18nKey=\"canvas.inline-edit-body.please-select-an-element\">Please select an element</Trans>\n          </div>\n        )}\n      </div>\n    </>\n  );\n}\n\n// Recursively render options\nfunction renderOptionsPaneCategoryDescriptor(pane: OptionsPaneCategoryDescriptor) {\n  return (\n    <OptionsPaneCategory {...pane.props} key={pane.props.id}>\n      <div>{pane.items.map((v) => v.render())}</div>\n      {pane.categories.map((c) => renderOptionsPaneCategoryDescriptor(c))}\n    </OptionsPaneCategory>\n  );\n}\n\ninterface EditorProps<T> {\n  onChange: (v: T) => void;\n  options: T;\n  data?: DataFrame[];\n}\n\nfunction getOptionsPaneCategoryDescriptor<T extends object>(\n  props: EditorProps<T>,\n  supplier: PanelOptionsSupplier<T>\n): OptionsPaneCategoryDescriptor {\n  const context: StandardEditorContext<unknown, unknown> = {\n    data: props.data ?? [],\n    options: props.options,\n  };\n\n  const root = new OptionsPaneCategoryDescriptor({ id: 'root', title: 'root' });\n  const getOptionsPaneCategory = (categoryNames?: string[]): OptionsPaneCategoryDescriptor => {\n    if (categoryNames?.length) {\n      const key = categoryNames[0];\n      let sub = root.categories.find((v) => v.props.id === key);\n      if (!sub) {\n        sub = new OptionsPaneCategoryDescriptor({ id: key, title: key });\n        root.categories.push(sub);\n      }\n      return sub;\n    }\n    return root;\n  };\n\n  const access: NestedValueAccess = {\n    getValue: (path) => lodashGet(props.options, path),\n    onChange: (path, value) => {\n      props.onChange(setOptionImmutably<T>(props.options, path, value));\n    },\n  };\n\n  // Use the panel options loader\n  fillOptionsPaneItems('canvas-inline', supplier, access, getOptionsPaneCategory, context);\n  return root;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  selectElement: css({\n    color: theme.colors.text.secondary,\n    padding: theme.spacing(2),\n  }),\n});\n","import { css } from '@emotion/css';\nimport { SyntheticEvent, useEffect, useRef, useState } from 'react';\nimport Draggable, { DraggableEventHandler } from 'react-draggable';\nimport { Resizable, ResizeCallbackData } from 'react-resizable';\n\nimport { Dimensions2D, GrafanaTheme2 } from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { IconButton, Portal, useStyles2 } from '@grafana/ui';\nimport store from 'app/core/store';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { InlineEditBody } from './InlineEditBody';\n\ntype Props = {\n  onClose?: () => void;\n  id: number;\n  scene: Scene;\n};\n\nconst OFFSET_X = 10;\nconst OFFSET_Y = 32;\n\nexport function InlineEdit({ onClose, id, scene }: Props) {\n  const root = scene.root.div?.getBoundingClientRect();\n  const windowHeight = window.innerHeight;\n  const windowWidth = window.innerWidth;\n  const ref = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const inlineEditKey = 'inlineEditPanel' + id.toString();\n\n  const defaultMeasurements = { width: 400, height: 400 };\n  const widthOffset = root?.width ?? defaultMeasurements.width + OFFSET_X * 2;\n  const defaultX = root?.x ?? 0 + widthOffset - defaultMeasurements.width - OFFSET_X;\n  const defaultY = root?.y ?? 0 + OFFSET_Y;\n\n  const savedPlacement = store.getObject(inlineEditKey, {\n    x: defaultX,\n    y: defaultY,\n    w: defaultMeasurements.width,\n    h: defaultMeasurements.height,\n  });\n  const [measurements, setMeasurements] = useState<Dimensions2D>({ width: savedPlacement.w, height: savedPlacement.h });\n  const [placement, setPlacement] = useState({ x: savedPlacement.x, y: savedPlacement.y });\n\n  // Checks that placement is within browser window\n  useEffect(() => {\n    const minX = windowWidth - measurements.width - OFFSET_X;\n    const minY = windowHeight - measurements.height - OFFSET_Y;\n    if (minX < placement.x && minX > 0) {\n      setPlacement({ ...placement, x: minX });\n    }\n    if (minY < placement.y && minY > 0) {\n      setPlacement({ ...placement, y: minY });\n    }\n  }, [windowHeight, windowWidth, placement, measurements]);\n\n  const onDragStop: DraggableEventHandler = (event, dragElement) => {\n    let x = dragElement.x < 0 ? 0 : dragElement.x;\n    let y = dragElement.y < 0 ? 0 : dragElement.y;\n\n    setPlacement({ x: x, y: y });\n    saveToStore(x, y, measurements.width, measurements.height);\n  };\n\n  const onResizeStop = (event: SyntheticEvent<Element, Event>, data: ResizeCallbackData) => {\n    const { size } = data;\n    setMeasurements({ width: size.width, height: size.height });\n    saveToStore(placement.x, placement.y, size.width, size.height);\n  };\n\n  const saveToStore = (x: number, y: number, width: number, height: number) => {\n    store.setObject(inlineEditKey, { x: x, y: y, w: width, h: height });\n  };\n\n  return (\n    <Portal>\n      <div className={styles.draggableWrapper}>\n        <Draggable handle=\"strong\" onStop={onDragStop} position={{ x: placement.x, y: placement.y }}>\n          <Resizable height={measurements.height} width={measurements.width} onResize={onResizeStop}>\n            <div\n              className={styles.inlineEditorContainer}\n              style={{ height: `${measurements.height}px`, width: `${measurements.width}px` }}\n              ref={ref}\n            >\n              <strong className={styles.inlineEditorHeader}>\n                <div className={styles.placeholder} />\n                <div>\n                  <Trans i18nKey=\"canvas.inline-edit.canvas-inline-editor\">Canvas Inline Editor</Trans>\n                </div>\n                <IconButton\n                  name=\"times\"\n                  size=\"xl\"\n                  className={styles.inlineEditorClose}\n                  onClick={onClose}\n                  tooltip={t('canvas.inline-edit.tooltip-close-inline-editor', 'Close inline editor')}\n                />\n              </strong>\n              <div className={styles.inlineEditorContentWrapper}>\n                <div className={styles.inlineEditorContent}>\n                  <InlineEditBody />\n                </div>\n              </div>\n            </div>\n          </Resizable>\n        </Draggable>\n      </div>\n    </Portal>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  inlineEditorContainer: css({\n    display: 'flex',\n    flexDirection: 'column',\n    background: theme.components.panel.background,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z3,\n    zIndex: 1000,\n    opacity: 1,\n    minWidth: '400px',\n  }),\n  draggableWrapper: css({\n    width: 0,\n    height: 0,\n  }),\n  inlineEditorHeader: css({\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: theme.colors.background.canvas,\n    borderBottom: `1px solid ${theme.colors.border.weak}`,\n    height: '40px',\n    cursor: 'move',\n  }),\n  inlineEditorContent: css({\n    whiteSpace: 'pre-wrap',\n    padding: '10px',\n  }),\n  inlineEditorClose: css({\n    marginLeft: 'auto',\n  }),\n  placeholder: css({\n    width: '24px',\n    height: '24px',\n    visibility: 'hidden',\n    marginRight: 'auto',\n  }),\n  inlineEditorContentWrapper: css({\n    overflow: 'scroll',\n  }),\n});\n","import * as React from 'react';\nimport { Component } from 'react';\nimport { ReplaySubject, Subscription } from 'rxjs';\n\nimport { PanelProps } from '@grafana/data';\nimport { locationService } from '@grafana/runtime';\nimport { PanelContext, PanelContextRoot } from '@grafana/ui';\nimport { CanvasFrameOptions } from 'app/features/canvas/frame';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { PanelEditEnteredEvent, PanelEditExitedEvent } from 'app/types/events';\n\nimport { SetBackground } from './components/SetBackground';\nimport { InlineEdit } from './editor/inline/InlineEdit';\nimport { Options } from './panelcfg.gen';\nimport { AnchorPoint, CanvasTooltipPayload, ConnectionState } from './types';\n\ninterface Props extends PanelProps<Options> {}\n\ninterface State {\n  refresh: number;\n  openInlineEdit: boolean;\n  openSetBackground: boolean;\n  contextMenuAnchorPoint: AnchorPoint;\n  moveableAction: boolean;\n}\n\nexport interface InstanceState {\n  scene: Scene;\n  selected: ElementState[];\n  selectedConnection?: ConnectionState;\n}\n\nexport interface SelectionAction {\n  panel: CanvasPanel;\n}\n\nlet canvasInstances: CanvasPanel[] = [];\nlet activeCanvasPanel: CanvasPanel | undefined = undefined;\nlet isInlineEditOpen = false;\nlet isSetBackgroundOpen = false;\n\nexport const activePanelSubject = new ReplaySubject<SelectionAction>(1);\n\nexport class CanvasPanel extends Component<Props, State> {\n  declare context: React.ContextType<typeof PanelContextRoot>;\n  static contextType = PanelContextRoot;\n  panelContext: PanelContext | undefined;\n\n  readonly scene: Scene;\n  private subs = new Subscription();\n  private queryEditorLoaded = false;\n  needsReload = false;\n  isEditing = locationService.getSearchObject().editPanel !== undefined;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      refresh: 0,\n      openInlineEdit: false,\n      openSetBackground: false,\n      contextMenuAnchorPoint: { x: 0, y: 0 },\n      moveableAction: false,\n    };\n\n    // Only the initial options are ever used.\n    // later changes are all controlled by the scene\n    this.scene = new Scene(this.props.options, this.onUpdateScene, this);\n    this.scene.updateSize(props.width, props.height);\n    this.scene.updateData(props.data);\n    this.scene.inlineEditingCallback = this.openInlineEdit;\n    this.scene.setBackgroundCallback = this.openSetBackground;\n    this.scene.tooltipCallback = this.tooltipCallback;\n    this.scene.moveableActionCallback = this.moveableActionCallback;\n    this.scene.actionConfirmationCallback = this.actionConfirmationCallback;\n\n    this.subs.add(\n      this.props.eventBus.subscribe(PanelEditEnteredEvent, (evt: PanelEditEnteredEvent) => {\n        // Remove current selection when entering edit mode for any panel in dashboard\n        this.scene.clearCurrentSelection();\n        this.closeInlineEdit();\n      })\n    );\n\n    this.subs.add(\n      this.props.eventBus.subscribe(PanelEditExitedEvent, (evt: PanelEditExitedEvent) => {\n        if (this.props.id === evt.payload) {\n          this.needsReload = true;\n          this.scene.clearCurrentSelection();\n        }\n      })\n    );\n  }\n\n  componentDidMount() {\n    activeCanvasPanel = this;\n    activePanelSubject.next({ panel: this });\n\n    this.panelContext = this.context;\n\n    if (this.scene.data) {\n      this.scene.updateData(this.scene.data);\n    }\n\n    if (this.panelContext.onInstanceStateChange) {\n      this.panelContext.onInstanceStateChange({ scene: this.scene, layer: this.scene.root });\n\n      this.subs.add(\n        this.scene.selection.subscribe({\n          next: (v) => {\n            if (v.length) {\n              activeCanvasPanel = this;\n              activePanelSubject.next({ panel: this });\n            }\n\n            canvasInstances.forEach((canvasInstance) => {\n              if (canvasInstance !== activeCanvasPanel) {\n                canvasInstance.scene.clearCurrentSelection(true);\n                canvasInstance.scene.connections.select(undefined);\n              }\n            });\n\n            this.panelContext?.onInstanceStateChange!({ scene: this.scene, selected: v, layer: this.scene.root });\n          },\n        })\n      );\n\n      this.subs.add(\n        this.scene.connections.selection.subscribe({\n          next: (v) => {\n            if (!this.context.instanceState) {\n              return;\n            }\n\n            this.panelContext?.onInstanceStateChange!({\n              scene: this.scene,\n              selected: this.context.instanceState.selected,\n              selectedConnection: v,\n              layer: this.scene.root,\n            });\n\n            if (v) {\n              activeCanvasPanel = this;\n              activePanelSubject.next({ panel: this });\n            }\n\n            canvasInstances.forEach((canvasInstance) => {\n              if (canvasInstance !== activeCanvasPanel) {\n                canvasInstance.scene.clearCurrentSelection(true);\n                canvasInstance.scene.connections.select(undefined);\n              }\n            });\n\n            setTimeout(() => {\n              this.forceUpdate();\n            });\n          },\n        })\n      );\n    }\n\n    // Reset the size update flag when entering edit mode\n    if (this.isEditing) {\n      this.queryEditorLoaded = false;\n    }\n\n    canvasInstances.push(this);\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    // Check if we're in edit mode and dimensions have changed (indicating query editor loaded)\n    if (this.isEditing && !this.queryEditorLoaded) {\n      const dimensionsChanged = prevProps.width !== this.props.width || prevProps.height !== this.props.height;\n\n      if (dimensionsChanged) {\n        this.queryEditorLoaded = true;\n        // Small delay to ensure layout is completely settled\n        requestAnimationFrame(() => {\n          this.scene.updateSize(this.props.width, this.props.height);\n        });\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.scene.subscription.unsubscribe();\n    this.subs.unsubscribe();\n    isInlineEditOpen = false;\n    isSetBackgroundOpen = false;\n    canvasInstances = canvasInstances.filter((ci) => ci.props.id !== activeCanvasPanel?.props.id);\n  }\n\n  // NOTE, all changes to the scene flow through this function\n  // even the editor gets current state from the same scene instance!\n  onUpdateScene = (root: CanvasFrameOptions) => {\n    const { onOptionsChange, options } = this.props;\n    onOptionsChange({ ...options, root });\n\n    this.setState({ refresh: this.state.refresh + 1 });\n    activePanelSubject.next({ panel: this });\n  };\n\n  shouldComponentUpdate(nextProps: Props, nextState: State) {\n    const { width, height, data, options } = this.props;\n    let changed = false;\n\n    if (width !== nextProps.width || height !== nextProps.height) {\n      this.scene.updateSize(nextProps.width, nextProps.height);\n      changed = true;\n    }\n\n    if (data !== nextProps.data && !this.scene.ignoreDataUpdate) {\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    if (options !== nextProps.options && !this.scene.ignoreDataUpdate) {\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    if (this.state.refresh !== nextState.refresh) {\n      changed = true;\n    }\n\n    if (this.state.openInlineEdit !== nextState.openInlineEdit) {\n      changed = true;\n    }\n\n    if (this.state.openSetBackground !== nextState.openSetBackground) {\n      changed = true;\n    }\n\n    if (this.state.moveableAction !== nextState.moveableAction) {\n      changed = true;\n    }\n\n    // After editing, the options are valid, but the scene was in a different panel or inline editing mode has changed\n    const inlineEditingSwitched = this.props.options.inlineEditing !== nextProps.options.inlineEditing;\n    const shouldShowAdvancedTypesSwitched =\n      this.props.options.showAdvancedTypes !== nextProps.options.showAdvancedTypes;\n    const panZoomSwitched = this.props.options.panZoom !== nextProps.options.panZoom;\n    const zoomToContentSwitched = this.props.options.zoomToContent !== nextProps.options.zoomToContent;\n    const tooltipModeSwitched = this.props.options.tooltip?.mode !== nextProps.options.tooltip?.mode;\n    const tooltipDisableForOneClickSwitched =\n      this.props.options.tooltip?.disableForOneClick !== nextProps.options.tooltip?.disableForOneClick;\n    if (\n      this.needsReload ||\n      inlineEditingSwitched ||\n      shouldShowAdvancedTypesSwitched ||\n      panZoomSwitched ||\n      zoomToContentSwitched ||\n      tooltipModeSwitched ||\n      tooltipDisableForOneClickSwitched\n    ) {\n      if (inlineEditingSwitched) {\n        // Replace scene div to prevent selecto instance leaks\n        this.scene.revId++;\n      }\n\n      this.needsReload = false;\n      this.scene.load(nextProps.options, nextProps.options.inlineEditing);\n      this.scene.updateSize(nextProps.width, nextProps.height);\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    return changed;\n  }\n\n  openInlineEdit = () => {\n    if (isInlineEditOpen) {\n      this.forceUpdate();\n      this.setActivePanel();\n      return;\n    }\n\n    this.setActivePanel();\n    this.setState({ openInlineEdit: true });\n    isInlineEditOpen = true;\n  };\n\n  openSetBackground = (anchorPoint: AnchorPoint) => {\n    if (isSetBackgroundOpen) {\n      this.forceUpdate();\n      this.setActivePanel();\n      return;\n    }\n\n    this.setActivePanel();\n    this.setState({ openSetBackground: true });\n    this.setState({ contextMenuAnchorPoint: anchorPoint });\n\n    isSetBackgroundOpen = true;\n  };\n\n  tooltipCallback = (tooltip: CanvasTooltipPayload | undefined) => {\n    this.scene.tooltipPayload = tooltip;\n    this.forceUpdate();\n  };\n\n  moveableActionCallback = (updated: boolean) => {\n    this.setState({ moveableAction: updated });\n    this.forceUpdate();\n  };\n\n  actionConfirmationCallback = () => {\n    this.forceUpdate();\n  };\n\n  closeInlineEdit = () => {\n    this.setState({ openInlineEdit: false });\n    isInlineEditOpen = false;\n  };\n\n  closeSetBackground = () => {\n    this.setState({ openSetBackground: false });\n    isSetBackgroundOpen = false;\n  };\n\n  setActivePanel = () => {\n    activeCanvasPanel = this;\n    activePanelSubject.next({ panel: this });\n  };\n\n  renderInlineEdit = () => {\n    return <InlineEdit onClose={() => this.closeInlineEdit()} id={this.props.id} scene={this.scene} />;\n  };\n\n  renderSetBackground = () => {\n    return (\n      <SetBackground\n        onClose={() => this.closeSetBackground()}\n        scene={this.scene}\n        anchorPoint={this.state.contextMenuAnchorPoint}\n      />\n    );\n  };\n\n  render() {\n    return (\n      <>\n        {this.scene.render()}\n        {this.state.openInlineEdit && this.renderInlineEdit()}\n        {this.state.openSetBackground && this.renderSetBackground()}\n      </>\n    );\n  }\n}\n","import { css } from '@emotion/css';\n\nimport { StandardEditorProps, GrafanaTheme2 } from '@grafana/data';\nimport { Trans, t } from '@grafana/i18n';\nimport { Alert, Icon, Stack, useStyles2 } from '@grafana/ui';\n\nconst helpUrl = 'https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/canvas/';\n\nexport const PanZoomHelp = ({}: StandardEditorProps<string, unknown, unknown, unknown>) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <>\n      <Stack direction=\"row\">\n        <Alert\n          title={t('canvas.pan-zoom-help.title-pan-and-zoom-controls', 'Pan and zoom controls')}\n          severity=\"info\"\n          buttonContent={<Icon name=\"question-circle\" size=\"xl\" />}\n          className={styles.alert}\n          onRemove={() => {\n            const newWindow = window.open(helpUrl, '_blank', 'noopener,noreferrer');\n            if (newWindow) {\n              newWindow.opener = null;\n            }\n          }}\n        >\n          <Stack direction=\"column\">\n            <ul>\n              <li>\n                <Trans i18nKey=\"canvas.pan-zoom-help.pan-title\">Pan:</Trans>\n                <ul>\n                  <li>\n                    <Trans i18nKey=\"canvas.pan-zoom-help.middle-mouse\">Middle mouse</Trans>\n                  </li>\n                  <li>\n                    <Trans i18nKey=\"canvas.pan-zoom-help.ctrl-right-mouse\">CTRL + right mouse</Trans>\n                  </li>\n                </ul>\n              </li>\n              <li>\n                <Trans i18nKey=\"canvas.pan-zoom-help.zoom-scroll-wheel\">Zoom: Scroll wheel</Trans>\n              </li>\n              <li>\n                <Trans i18nKey=\"canvas.pan-zoom-help.reset-double-click\">Reset: Double click</Trans>\n              </li>\n            </ul>\n          </Stack>\n        </Alert>\n      </Stack>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  alert: css({\n    '& div': { padding: '4px', alignItems: 'start' },\n    marginBottom: '0px',\n    marginTop: '5px',\n    padding: '2px',\n    'ul > li': { marginLeft: '10px' },\n  }),\n});\n","import { PanelModel, OneClickMode } from '@grafana/data';\n\nimport { Options } from './panelcfg.gen';\n\nexport const canvasMigrationHandler = (panel: PanelModel): Partial<Options> => {\n  const pluginVersion = panel?.pluginVersion ?? '';\n\n  // Rename text-box to rectangle\n  // Initial plugin version is empty string for first migration\n  if (pluginVersion === '') {\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if (element.type === 'text-box') {\n          element.type = 'rectangle';\n        }\n      }\n    }\n  }\n\n  if (pluginVersion.startsWith('11.0')) {\n    // Migration for v11.0 for ellipse element refactor: https://github.com/grafana/grafana/pull/84205\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if (element.type === 'ellipse') {\n          // Take existing ellipse specific background and border config and apply it to the element's general background and border config\n          if (element.config.backgroundColor) {\n            element.background = element.config.backgroundColor;\n            delete element.config.backgroundColor;\n          }\n          if (element.config.borderColor) {\n            element.border.color = element.config.borderColor;\n            delete element.config.borderColor;\n          }\n          if (element.config.width) {\n            element.border.width = element.config.width;\n            delete element.config.width;\n          }\n        }\n      }\n    }\n  }\n\n  if (parseFloat(pluginVersion) <= 11.3) {\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        // migrate action options to new format (fetch)\n        if (element.actions) {\n          for (const action of element.actions) {\n            if (action.options) {\n              action.fetch = { ...action.options };\n              delete action.options;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // migrate oneClickMode to first link/action oneClick\n  if (parseFloat(pluginVersion) <= 11.6) {\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if ((element.oneClickMode === OneClickMode.Link || element.oneClickLinks) && element.links?.length) {\n          element.links[0].oneClick = true;\n        } else if (element.oneClickMode === OneClickMode.Action && element.actions?.length) {\n          element.actions[0].oneClick = true;\n        }\n\n        delete element.oneClickMode;\n        delete element.oneClickLinks;\n      }\n    }\n  }\n\n  // migrate connection direction\n  if (parseFloat(pluginVersion) <= 12.2) {\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        for (const connection of element.connections || []) {\n          if (connection.direction && typeof connection.direction === 'string') {\n            // convert old direction to new format\n            connection.direction = {\n              mode: 'fixed',\n              fixed: connection.direction,\n            };\n          } else if (!connection.direction) {\n            connection.direction = {\n              mode: 'fixed',\n              fixed: 'forward',\n            };\n          }\n        }\n      }\n    }\n  }\n\n  return panel.options;\n};\n","import { FieldConfigProperty, PanelOptionsEditorBuilder, PanelPlugin } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { config } from '@grafana/runtime';\nimport { TooltipDisplayMode } from '@grafana/schema/dist/esm/common/common.gen';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\n\nimport { CanvasPanel, InstanceState } from './CanvasPanel';\nimport { getConnectionEditor } from './editor/connectionEditor';\nimport { getElementEditor } from './editor/element/elementEditor';\nimport { getLayerEditor } from './editor/layer/layerEditor';\nimport { PanZoomHelp } from './editor/panZoomHelp';\nimport { canvasMigrationHandler } from './migrations';\nimport { Options } from './panelcfg.gen';\n\nexport const addStandardCanvasEditorOptions = (builder: PanelOptionsEditorBuilder<Options>) => {\n  let category = [t('canvas.category-canvas', 'Canvas')];\n  builder.addBooleanSwitch({\n    path: 'inlineEditing',\n    name: t('canvas.name-inline-editing', 'Inline editing'),\n    category,\n    description: t('canvas.description-inline-editing', 'Enable editing the panel directly'),\n    defaultValue: true,\n  });\n\n  builder.addBooleanSwitch({\n    path: 'showAdvancedTypes',\n    name: t('canvas.name-experimental-types', 'Experimental element types'),\n    category,\n    description: t('canvas.description-experimental-types', 'Enable selection of experimental element types'),\n    defaultValue: true,\n  });\n\n  builder.addBooleanSwitch({\n    path: 'panZoom',\n    name: t('canvas.name-pan-zoom', 'Pan and zoom'),\n    category,\n    description: t('canvas.description-pan-zoom', 'Enable pan and zoom'),\n    defaultValue: false,\n    showIf: () => config.featureToggles.canvasPanelPanZoom,\n  });\n  builder.addCustomEditor({\n    id: 'panZoomHelp',\n    path: 'panZoomHelp',\n    name: '',\n    category,\n    editor: PanZoomHelp,\n    showIf: (opts) => config.featureToggles.canvasPanelPanZoom && opts.panZoom,\n  });\n  builder.addBooleanSwitch({\n    path: 'zoomToContent',\n    name: 'Zoom to content',\n    description: 'Automatically zoom to fit content',\n    defaultValue: false,\n    showIf: () => config.featureToggles.canvasPanelPanZoom,\n  });\n\n  category = [t('canvas.category-tooltip', 'Tooltip')];\n\n  builder.addRadio({\n    path: 'tooltip.mode',\n    name: t('canvas.tooltip-options.name-tooltip-mode', 'Tooltip mode'),\n    category,\n    defaultValue: TooltipDisplayMode.Single,\n    settings: {\n      options: [\n        {\n          value: TooltipDisplayMode.Single,\n          label: t('canvas.tooltip-options.tooltip-mode-options.label-enabled', 'Enabled'),\n        },\n        {\n          value: TooltipDisplayMode.None,\n          label: t('canvas.tooltip-options.tooltip-mode-options.label-disabled', 'Disabled'),\n        },\n      ],\n    },\n  });\n\n  builder.addBooleanSwitch({\n    path: 'tooltip.disableForOneClick',\n    name: t('canvas.tooltip-options.label-disable-one-click', 'Disable for one-click elements'),\n    category,\n    defaultValue: false,\n    showIf: (options) => options.tooltip?.mode !== TooltipDisplayMode.None,\n  });\n};\n\nexport const plugin = new PanelPlugin<Options>(CanvasPanel)\n  .setNoPadding() // extend to panel edges\n  .useFieldConfig({\n    standardOptions: {\n      [FieldConfigProperty.Mappings]: {\n        settings: {\n          icon: true,\n        },\n      },\n      [FieldConfigProperty.Links]: {\n        settings: {\n          showOneClick: false,\n        },\n      },\n      [FieldConfigProperty.Actions]: {\n        settings: {\n          showOneClick: false,\n        },\n      },\n    },\n  })\n  .setMigrationHandler(canvasMigrationHandler, (panel) => {\n    const pluginVersion = panel?.pluginVersion ?? '';\n    return parseFloat(pluginVersion) <= 12.2;\n  })\n  .setPanelOptions((builder, context) => {\n    const state: InstanceState = context.instanceState;\n\n    addStandardCanvasEditorOptions(builder);\n\n    if (state && state.scene) {\n      builder.addNestedOptions(getLayerEditor(state));\n\n      const selection = state.selected;\n      const connectionSelection = state.selectedConnection;\n\n      if (selection?.length === 1) {\n        const element = selection[0];\n        if (!(element instanceof FrameState)) {\n          builder.addNestedOptions(\n            getElementEditor({\n              category: [\n                t('canvas.category-selected-element', 'Selected element ({{element}})', {\n                  element: element.options.name,\n                }),\n              ],\n              element,\n              scene: state.scene,\n            })\n          );\n        }\n      }\n\n      if (connectionSelection) {\n        builder.addNestedOptions(\n          getConnectionEditor({\n            category: [t('canvas.category-selected-connection', 'Selected connection')],\n            connection: connectionSelection,\n            scene: state.scene,\n          })\n        );\n      }\n    }\n  });\n","import { css, cx } from '@emotion/css';\n\nimport { FALLBACK_COLOR, GrafanaTheme2 } from '@grafana/data';\nimport { LineStyle } from '@grafana/schema';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { SeriesIcon } from '../VizLegend/SeriesIcon';\n\nimport { ColorIndicator, DEFAULT_COLOR_INDICATOR } from './types';\nimport { getColorIndicatorClass } from './utils';\n\nexport enum ColorIndicatorPosition {\n  Leading,\n  Trailing,\n}\n\ninterface Props {\n  color?: string;\n  colorIndicator?: ColorIndicator;\n  position?: ColorIndicatorPosition;\n  lineStyle?: LineStyle;\n  isHollow?: boolean;\n}\n\nexport type ColorIndicatorStyles = ReturnType<typeof getStyles>;\n\nexport const VizTooltipColorIndicator = ({\n  color = FALLBACK_COLOR,\n  colorIndicator = DEFAULT_COLOR_INDICATOR,\n  position = ColorIndicatorPosition.Leading,\n  lineStyle,\n  isHollow,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n\n  if (isHollow) {\n    return (\n      <div\n        style={{ border: `1px solid ${color}` }}\n        className={cx(\n          position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing,\n          getColorIndicatorClass(colorIndicator, styles)\n        )}\n      />\n    );\n  }\n\n  if (colorIndicator === ColorIndicator.series) {\n    return (\n      <SeriesIcon\n        color={color}\n        lineStyle={lineStyle}\n        className={position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing}\n      />\n    );\n  }\n\n  return (\n    <span\n      style={{ backgroundColor: color }}\n      className={cx(\n        position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing,\n        getColorIndicatorClass(colorIndicator, styles)\n      )}\n    />\n  );\n};\n\n// @TODO Update classes/add svgs\nconst getStyles = (theme: GrafanaTheme2) => ({\n  leading: css({\n    marginRight: theme.spacing(0.5),\n  }),\n  trailing: css({\n    marginLeft: theme.spacing(0.5),\n  }),\n  series: css({\n    width: '14px',\n    height: '4px',\n    borderRadius: theme.shape.radius.pill,\n    minWidth: '14px',\n  }),\n  value: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.default,\n    fontWeight: 500,\n    minWidth: '12px',\n  }),\n  hexagon: css({}),\n  pie_1_4: css({}),\n  pie_2_4: css({}),\n  pie_3_4: css({}),\n  marker_sm: css({\n    width: '4px',\n    height: '4px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '4px',\n  }),\n  marker_md: css({\n    width: '8px',\n    height: '8px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '8px',\n  }),\n  marker_lg: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '12px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { CSSProperties, ReactNode, useEffect, useRef, useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { InlineToast } from '../InlineToast/InlineToast';\nimport { Tooltip } from '../Tooltip/Tooltip';\n\nimport { ColorIndicatorPosition, VizTooltipColorIndicator } from './VizTooltipColorIndicator';\nimport { ColorPlacement, VizTooltipItem } from './types';\n\ninterface VizTooltipRowProps extends Omit<VizTooltipItem, 'value'> {\n  value: string | number | null | ReactNode;\n  justify?: string;\n  isActive?: boolean; // for series list\n  marginRight?: string;\n  isPinned: boolean;\n  showValueScroll?: boolean;\n  isHiddenFromViz?: boolean;\n}\n\nenum LabelValueTypes {\n  label = 'label',\n  value = 'value',\n}\n\nconst SUCCESSFULLY_COPIED_TEXT = 'Copied to clipboard';\nconst SHOW_SUCCESS_DURATION = 2 * 1000;\nconst HORIZONTAL_PX_PER_CHAR = 7;\n\nexport const VizTooltipRow = ({\n  label,\n  value,\n  color,\n  colorIndicator,\n  colorPlacement = ColorPlacement.first,\n  justify = 'flex-start',\n  isActive = false,\n  marginRight = '0px',\n  isPinned,\n  lineStyle,\n  showValueScroll,\n  isHiddenFromViz,\n}: VizTooltipRowProps) => {\n  const styles = useStyles2(getStyles, justify, marginRight);\n\n  const innerValueScrollStyle: CSSProperties = showValueScroll\n    ? {\n        maxHeight: 55,\n        whiteSpace: 'wrap',\n        wordBreak: 'break-word',\n        overflowY: 'auto',\n      }\n    : {\n        whiteSpace: 'pre-line',\n        wordBreak: 'break-word',\n        lineHeight: 1.2,\n      };\n\n  const [showLabelTooltip, setShowLabelTooltip] = useState(false);\n\n  const [copiedText, setCopiedText] = useState<Record<string, string> | null>(null);\n  const [showCopySuccess, setShowCopySuccess] = useState(false);\n\n  const labelRef = useRef<null | HTMLDivElement>(null);\n  const valueRef = useRef<null | HTMLDivElement>(null);\n\n  useEffect(() => {\n    let timeoutId: ReturnType<typeof setTimeout>;\n\n    if (showCopySuccess) {\n      timeoutId = setTimeout(() => {\n        setShowCopySuccess(false);\n      }, SHOW_SUCCESS_DURATION);\n    }\n\n    return () => {\n      window.clearTimeout(timeoutId);\n    };\n  }, [showCopySuccess]);\n\n  const copyToClipboard = async (text: string, type: LabelValueTypes) => {\n    if (!(navigator?.clipboard && window.isSecureContext)) {\n      fallbackCopyToClipboard(text, type);\n      return;\n    }\n\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopiedText({ [`${type}`]: text });\n      setShowCopySuccess(true);\n    } catch (error) {\n      setCopiedText(null);\n    }\n  };\n\n  const fallbackCopyToClipboard = (text: string, type: LabelValueTypes) => {\n    // Use a fallback method for browsers/contexts that don't support the Clipboard API.\n    const textarea = document.createElement('textarea');\n    labelRef.current?.appendChild(textarea);\n    textarea.value = text;\n    textarea.focus();\n    textarea.select();\n    try {\n      const successful = document.execCommand('copy');\n      if (successful) {\n        setCopiedText({ [`${type}`]: text });\n        setShowCopySuccess(true);\n      }\n    } catch (err) {\n      console.error('Unable to copy to clipboard', err);\n    }\n\n    textarea.remove();\n  };\n\n  const onMouseEnterLabel = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (event.currentTarget.offsetWidth < event.currentTarget.scrollWidth) {\n      setShowLabelTooltip(true);\n    }\n  };\n\n  const onMouseLeaveLabel = () => setShowLabelTooltip(false);\n\n  // if label is > 50% window width, try to put label/value pairs on new lines\n  if (label.length * HORIZONTAL_PX_PER_CHAR > window.innerWidth / 2) {\n    label = label.replaceAll('{', '{\\n  ').replaceAll('}', '\\n}').replaceAll(', ', ',\\n  ');\n  }\n\n  return (\n    <div className={styles.contentWrapper}>\n      {(color || label) && (\n        <div className={styles.valueWrapper}>\n          {color && colorPlacement === ColorPlacement.first && (\n            <VizTooltipColorIndicator\n              color={color}\n              colorIndicator={colorIndicator}\n              lineStyle={lineStyle}\n              isHollow={isHiddenFromViz}\n            />\n          )}\n          {!isPinned ? (\n            <div className={cx(styles.label, isActive && styles.activeSeries)}>{label}</div>\n          ) : (\n            <>\n              <Tooltip content={label} interactive={false} show={showLabelTooltip}>\n                <>\n                  {showCopySuccess && copiedText?.label && (\n                    <InlineToast placement=\"top\" referenceElement={labelRef.current}>\n                      {SUCCESSFULLY_COPIED_TEXT}\n                    </InlineToast>\n                  )}\n                  {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n                  <div\n                    className={cx(styles.label, isActive && styles.activeSeries, navigator?.clipboard && styles.copy)}\n                    onMouseEnter={onMouseEnterLabel}\n                    onMouseLeave={onMouseLeaveLabel}\n                    onClick={() => copyToClipboard(label, LabelValueTypes.label)}\n                    ref={labelRef}\n                  >\n                    {label}\n                  </div>\n                </>\n              </Tooltip>\n            </>\n          )}\n        </div>\n      )}\n\n      <div className={styles.valueWrapper}>\n        {color && colorPlacement === ColorPlacement.leading && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Leading}\n            lineStyle={lineStyle}\n          />\n        )}\n\n        {!isPinned ? (\n          <div className={cx(styles.value, isActive)} style={innerValueScrollStyle}>\n            {value}\n          </div>\n        ) : (\n          <>\n            {showCopySuccess && copiedText?.value && (\n              <InlineToast placement=\"top\" referenceElement={valueRef.current}>\n                {SUCCESSFULLY_COPIED_TEXT}\n              </InlineToast>\n            )}\n            {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n            <div\n              className={cx(styles.value, isActive, navigator?.clipboard && styles.copy)}\n              style={innerValueScrollStyle}\n              onClick={() => copyToClipboard(value ? value.toString() : '', LabelValueTypes.value)}\n              ref={valueRef}\n            >\n              {value}\n            </div>\n          </>\n        )}\n\n        {color && colorPlacement === ColorPlacement.trailing && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Trailing}\n            lineStyle={lineStyle}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2, justify: string, marginRight: string) => ({\n  contentWrapper: css({\n    display: 'flex',\n    alignItems: 'start',\n    justifyContent: justify,\n    marginRight: marginRight,\n  }),\n  label: css({\n    color: theme.colors.text.secondary,\n    fontWeight: 400,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    marginRight: theme.spacing(2),\n  }),\n  value: css({\n    fontWeight: 500,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n  }),\n  valueWrapper: css({\n    display: 'flex',\n    alignItems: 'center',\n  }),\n  activeSeries: css({\n    fontWeight: theme.typography.fontWeightBold,\n    color: theme.colors.text.maxContrast,\n  }),\n  copy: css({\n    cursor: 'pointer',\n  }),\n});\n"],"names":["getDataLinks","field","rowIdx","links","v","disp","linkLookup","link","key","getAllFrameActions","dataFrame","getFieldActions","replaceVars","rowIndex","actions","actionLookup","action","VizTooltipHeader","item","isPinned","styles","getStyles","label","value","color","colorIndicator","theme","VizTooltipContent","items","children","scrollable","maxHeight","scrollableStyle","colorPlacement","isActive","lineStyle","isHiddenFromViz","i","NotFoundDisplay","config","notFoundItem","LayerActionID","InlineEditTabs","LineStyle","StrokeDasharray","ParamsEditor","onChange","paramName","setParamName","paramValue","setParamValue","changeParamValue","currentTarget","changeParamName","removeParam","updatedParams","param","addParam","newParams","e","a","b","isAddParamsDisabled","Stack","Input","IconButton","entry","callApi","api","updateLoadingStateCallback","request","getRequest","error","interpolateVariables","text","panel","endpoint","getEndpoint","url","requestHeaders","getData","name","data","sanitizedRelativeURL","dummyStringSettings","httpMethodOptions","contentTypeOptions","APIEditor","context","defaultApiConfig","onEndpointChange","onDataChange","onMethodChange","method","onContentTypeChange","contentType","formatCreateLabel","input","onQueryParamsChange","queryParams","onHeaderParamsChange","headerParams","renderJSON","json","JSONFormatter","renderTestAPIButton","Button","InlineFieldRow","InlineField","RadioButtonGroup","Select","Field","variantOptions","ButtonStyleEditor","defaultStyleConfig","onVariantChange","variant","ConnectionPath","ConnectionDirection","defaultBgColor","defaultTextColor","defaultLightTextColor","defaultThemeTextColor","QuickPlacement","Align","VAlign","ButtonDisplay","isLoading","setIsLoading","loading","onClick","Spinner","buttonItem","options","dimensionContext","elementOptions","buttonConfig","getAPIConfig","builder","category","TextDimensionEditor","ColorDimensionEditor","cloudItem","props","uniqueId","textConfig","background","border","textTop","textLeft","textTransform","droneFrontItem","droneFrontTransformStyle","droneFrontConfig","ScalarDimensionEditor","droneSideItem","droneSidePitchTransformStyle","droneSideConfig","droneTopItem","fRightRotorAnimation","fLeftRotorAnimation","bRightRotorAnimation","bLeftRotorAnimation","droneTopTransformStyle","droneTopConfig","ellipseItem","svgStrokePathClass","IconDisplay","svgStyle","SanitizedSVG","iconItem","iconConfig","path","ResourceDimensionEditor","dummyFieldSettings","MetricValueDisplay","isSelected","scene","panelData","isEditMode","useObservable","of","getDisplayValue","fieldNotFound","fieldNames","MetricValueEdit","onFieldChange","selectedElement","FieldNamePicker","metricValueItem","parallelogramItem","RectangleDisplay","stylesFactory","rectangleItem","ServerDatabase","getServerStyles","ServerSingle","ServerStack","ServerTerminal","ServerType","outlineColor","serverItem","serverConfig","TextDisplay","TextEdit","textRef","saveText","onKeyDown","event","onKeyUp","textValue","textItem","triangleItem","windTurbineItem","windTurbineAnimation","windTurbineConfig","DEFAULT_CANVAS_ELEMENT_CONFIG","defaultElementItems","advancedElementItems","canvasElementRegistry","Registry","counter","SVGElements","ElementState","parent","vars","target","hasHorizontalCenterConstraint","hasVerticalCenterConstraint","height","yOffset","rotationDelta","placement","calculatedRotation","style","deltaX","deltaY","dirLR","dirTB","rotationInRadians","originalDirLR","originalDirTB","primaryDataLink","primaryAction","getRowIndex","canExecuteActions","actionsDefaultFieldConfig","frames","defaultField","scopedVars","shouldDisableForOneClick","rect","ConfirmModal","onModalContinue","VariablesInputModal","fallbackName","newName","trav","disablePointerEvents","constraint","vertical","horizontal","translate","applyStyles","elementType","removeStyles","sceneWidth","sceneHeight","transformY","transformX","element","matrix","elementContainer","parentContainer","transformScale","parentBorderWidth","rotationTopOffset","rotationLeftOffset","rotationDegrees","rotationRadians","rotationOffset","calculateDelta","dimension1","dimension2","relativeTop","relativeBottom","relativeLeft","relativeRight","width","elementCenter","distanceFromCenter","elementRect","ctx","userCanExecuteActions","css","image","visitor","oldName","isConnectionTarget","getConnectionsByTarget","connection","div","doSelect","selection","FrameState","targetElements","getElementTypes","shouldShowAdvancedTypes","current","getElementTypesOptions","selectables","alpha","option","onAddItem","sel","rootLayer","anchorPoint","newItem","newElementOptions","newElement","isConnectionSource","sceneByName","getConnections","connections","c","index","updateConnectionsForSource","con","calculateCoordinates","sourceRect","parentRect","info","sourceHorizontalCenter","sourceVerticalCenter","x1","y1","x2","y2","targetRect","targetHorizontalCenter","targetVerticalCenter","parentHorizontalCenter","parentVerticalCenter","calculateCoordinates2","source","getRotatedConnectionPoint","targetDiv","getElementTransformAndDimensions","transform","x","y","rotation","getNormalizedRotatedOffset","left","top","centerX","centerY","dx","dy","rad","cos","sin","rotatedDx","rotatedDy","normalizedX","normalizedY","offsetX","offsetY","rotatedOffsetX","rotatedOffsetY","calculateMidpoint","calculateAbsoluteCoords","valueX","valueY","calculateAngle","calculateDistance","fieldName","getConnectionStyles","defaultArrowSize","defaultArrowDirection","defaultArrowColor","lastRowIndex","strokeColor","strokeWidth","strokeRadius","arrowDirection","getLineStyle","shouldAnimate","getParentBoundingClientRect","getElementFields","opts","fields","cfg","frame","RGB","RGBA","HSL","HSLA","COLOR_MODELS","FUNCTION","PROPERTY","ARRAY","OBJECT","STRING","NUMBER","UNDEFINED","IS_WINDOW","doc","prefixes","getCrossBrowserProperty","property","length","TRANSFORM","FILTER","ANIMATION","KEYFRAMES","OPEN_CLOSED_CHARACTERS","TINY_NUM","REVERSE_TINY_NUM","DEFAULT_UNIT_PRESETS","pos","size","__spreadArrays","s","il","k","j","jl","dot","a1","a2","b1","b2","isUndefined","isObject","isArray","isEqualSeparator","character","separator","isCharacterSpace","isSeparatorSpace","findOpen","openCharacter","texts","openCloseCharacters","isIgnore","findIgnore","findClose","otherText","closeCharacter","_loop_1","nextIndex","_a","open","out_i_1","state_1","splitText","splitOptions","_b","isSeparateFirst","isSeparateOnlyOpenClose","_c","isSeparateOpenClose","_d","openClosedText","close","regexText","regex","chr","values","tempValues","resetTemp","_loop_2","out_i_2","nextOpenCloseCharacters","state_2","splitSpace","splitComma","splitBracket","matches","splitUnit","prefix","unit","camelize","str","all","letter","letter2","toArray","now","findIndex","arr","callback","defaultIndex","findLastIndex","findLast","defalutValue","firstTime","raf","currTime","id","caf","handle","getKeys","obj","getValues","keys","sortOrders","orders","index1","index2","convertUnitSize","sizeFunction","between","min","max","checkBoundSize","targetSize","compareSize","isMax","ratio","throttle","defaultSize","throttledSize","calculateBoundSize","minSize","maxSize","keepRatio","minWidth","minHeight","maxWidth","sum","nums","total","getRad","pos1","pos2","distX","distY","getCenterPoint","points","getShapeDirection","center","pos1Rad","pos2Rad","num","reverseUnit","throttleArray","_","replaceOnce","fromText","toText","isOnce","args","_i","flat","prev","cur","deepFlat","elements","cutHex","hex","hexToRGBA","h","r","g","toFullHex","hslToRGBA","hsl","l","m","rgb","stringToRGBA","colorArr","$","selectors","multi","hasClass","className","addClass","removeClass","reg","fromCSS","properties","cssObject","getWindow","addEvent","el","type","listener","removeEvent","getDocument","getDocumentElement","getDocumentBody","isWindow","val","isNode","__assign","t","n","p","EventEmitter","__proto","eventName","events","_this","resolve","isStop","listeners","extendStatics","d","__extends","__","getRotatiion","touches","isMultiTouch","getEventClients","getClients","getClient","isMouseEvent","getPosition","clients","prevClients","startClients","getAverageClient","clientX","clientY","originalClientX","originalClientY","prevX","prevY","startX","startY","sumClient","minLength","client","ClientStore","isAdd","position","positions","movement","currentClient","prevClient","INPUT_TAGNAMES","Gesto","_super","targets","isTrusted","isDragAPI","container","pinchOutside","preventWheelClick","preventRightClick","preventDefault","checkInput","dragFocusedInput","preventClickEventOnDragStart","preventClickEventOnDrag","preventClickEventByCondition","useTouch","isDragStart","activeElement","tagName","hasInput","hasContentEditable","activeTagName","result","timer","isScroll","dragResult","isDrag","clientsLength","currentTime","isDouble","firstTarget","checkWindowBlur","passive_1","isCallDrag","inputEvent","store","nextClients","currentData","name_1","pinchThreshold","isPinch","isPrevDrag","isFirstDrag","storePosition","win","passive","prefixNames","classNames","prefixCSS","selector","refs","Properties","component","prototype","withMethods","methods","duplicate","propertyName","methodName","hash","stringHash","getHash","getShadowRoot","parentElement","rootNode","replaceStyle","trimmedSelector","subSelector","trimmedSubSelector","injectStyle","shadowRoot","styled","injectClassName","styleElement","count","injectCount","some","getUserAgent","agent","userAgent","execRegExp","pattern","hasUserAgentData","userAgentData","brands","findVersion","versionTest","convertVersion","findPreset","presets","userPreset","version","preset","findPresetBrand","brandInfo","findBrand","brand","BROWSER_PRESETS","CHROMIUM_PRESETS","WEBKIT_PRESETS","WEBVIEW_PRESETS","OS_PRESETS","parseUserAgentData","osData","isMobile","firstBrand","browser","os","chromiumBrand","webkitBrand","platform_1","browserBrand","parseUserAgent","nextAgent","browserPreset","browserVersion","osPreset","osVersion","chromiumPreset","webkitPreset","getAccurateAgent","agentInfo","__decorate","decorators","desc","__spreadArray","to","from","pack","ar","IS_SAFARI","PREFIX","WRAPPER_CLASS_NAME","SCROLL_AREA_CLASS_NAME","SCROLL_BAR_CLASS_NAME","HORIZONTAL_SCROLL_BAR_CLASS_NAME","VERTICAL_SCROLL_BAR_CLASS_NAME","SCROLL_THUMB_CLASS_NAME","injector","DEFAULT_OPTIONS","DEFAULT_EASING","NAMES","CLASS_NAME","PROPERTIES","OPTIONS","EVENTS","METHODS","measureSpeed","datas","time","prevSpeed","dt","getDuration","speed","normalSpeed","getDestPos","duration","abs","getRange","margin","range","threshold","isReal","checkDefault","defaultValue","startAnimation","timerCallback","easing","startTime","prevTime","next","prevRatio","ScrollBar","containerElement","isHorizontal","isThumb","thumbRect","thumbSize","clientPos","delta","thumbElement","barElement","isAbsolute","isDisplay","scrollSize","opacity","dirName1","sizeName","sizeP","posP","InfiniteViewer","_containerElement","viewportElement","containerWidth","containerHeight","viewportWidth","viewportHeight","viewportScrollWidth","viewportScrollHeight","scrollLeft","scrollTop","zoom","viewerScrollLeft","viewerScrollTop","pinchDirection","maxPinchWheel","isKeydown","sign","distance","scale","zoomX","zoomY","absolute","isZoom","prevZoomX","prevZoomY","zoomRange","_e","_f","zoomOffsetX","_g","zoomOffsetY","_h","zoomRangeX","zoomRangeY","nextZoomX","nextZoomY","zoomXPos","zoomYPos","deltaZoom","wrapperElement","scrollAreaElement","horizontalScrollElement","verticalScrollElement","horizontalBar","verticalBar","wheelContainerOption","wheelContainerElement","stop","observer_1","translateZ","rangeX","rangeY","useTransform","nextOffsetX","nextOffsetY","viewportStyle","scrollWidth","scrollHeight","scrollRangeX","scrollRangeY","displayVerticalScroll","displayHorizontalScroll","dest","distRatio","destPos","ratioX","ratioY","originalZoomOffsetX","originalZoomOffsetY","zoomOptions","zoomBase","nextScrollLeft","nextScrollTop","nextCenterX","nextCenterY","prevScrollLeft","prevScrollTop","nextScrollAbsoluteLeft","nextScrollAbsoluteTop","requestScrollLeft","requestScrollTop","coord","names","prevScrollPos","minCoord","maxCoord","scrollPos","scrollAreaSize","zoomCoord","minThreshold","maxThreshold","rangeCoord","rangeOffsetCoord","startRange","endRange","startMargin","endMargin","viewportSize","startSizeOffset","attributes","setter","InfiniteViewer$1","PolyMap","prevIndex","HashMap","SUPPORT_MAP","Link","prevLink","nextLink","orderChanged","changed","fixed","fromLinks","toLinks","fromLink","toLink","fromIndex","toIndex","Result","prevList","list","added","removed","maintained","changedBeforeAdded","ordered","pureChanged","fromBefore","toBefore","diff","findKeyCallback","mapClass","prevKeys","prevKeyMap","keyMap","removedMap","addedCount","removedCount","prevListIndex","listIndex","ListDiffer","newData","__rest","fillKeys","arr2","fillProps","defaultProps","isDiff","getAttributes","otherProps","splitProps","name_2","findContainerNode","provider","base","removeNode","node","parentNode","executeHooks","hooks","hook","renderFunctionComponent","hooksIndex","Provider","ref","ps","contexts","nextElement","nextState","isForceUpdate","self","currentDepth","scheduledContexts","scheduledSubs","isContextUpdate","nextChildSubs","childs","sub","depth","child","renderProviders","prevProps","setCurrentInstance","fr","getCurrentInstance","getHooksIndex","setHooksInex","nextHooksIndex","Component","state","prevState","isUpdate","PureComponent","createRef","refCallback","forwardRef","func","createComponent","contextValue","ComponentProvider","nextProps","isMount","contextType","template","nextContexts","ef","def","diffAttributes","attrs1","attrs2","diffObject","name_3","diffEvents","events1","events2","provier","name_4","name_5","keys1","keys2","diffStyle","style1","style2","beforeName","name_6","name_7","name_8","getNativeEventName","ElementProvider","isRemove","contextValues","containerNode","isSVG","prevAttributes","prevEvents","nextAttributes","nextEvents","name_9","findDOMNode","comp","providers","findNodeProvider","ContainerProvider","TextProvider","diffProviders","containerProvider","childrenKeys","childrenProvider","createProvider","childProvider","getNextSibiling","childProviders","providerClass","updatedHooks","hyd","updated","nodeProvider","renderProvider","isProvider","render","renderSelf","createContext","$_subs","Consumer","getContext","mainComponent","subs","Portal","createPortal","_renderToString","parentContexts","stringProps_1","styleName","styleValue","strings","renderToString","renderSelfToString","checkHookInfo","inst","prevHt","useMemo","defaultFunction","deps","useRef","useContext","contextId","providerComponent","useEffect","useState","st","nextValue","effect","unshift","effects","useImperativeHandle","add","inverseMatrix","startIndex","fromX","swap","iv","divide","ignoreDimension","newMatrix","invert","createIdentityMatrix","identityIndex","targetStartIndex","targetIndex","transpose","getOrigin","originMatrix","w","fromTranslation","convertPositionMatrix","convertDimension","multiplies","matrixes","multiply","matrix2","plus","nextPos","minus","convertCSStoMatrix","is2d","convertMatrixtoCSS","calculate","rotateX3d","rotateY3d","rotateZ3d","createRotateMatrix","scale3d","sx","sy","sz","rotate","translate3d","tx","ty","tz","matrix3d","matrix1","createScaleMatrix","createOriginMatrix","origin","createWarpMatrix","pos0","pos3","nextPos0","nextPos1","nextPos2","nextPos3","x0","y0","x3","y3","u0","v0","u1","v1","u2","v2","u3","v3","getCenter","createMatrix","parseMat","toMat","parse","getElementMatrix","calculateMatrixDist","res","getDistElementMatrix","matrixInfos","matrixFunction","functionValue","transforms","functionName","nextSize_1","posX","posY","posZ","nextSize","unitValue","childrenCount","ChildrenDiffer","getDefaultScrollPosition","checkDefaultScrollEvent","getContainerElement","DragScroll","_startRect","_startPos","direction","throttleTime","nextScrollPos","nextDirection","getScrollPosition","useScroll","nowTime","distTime","checkScrollEvent","tinyThrottle","isSameConstants","linearConstants1","linearConstants2","isSamePoint","point1","point2","getAreaSize","point","nextPoint","fitPoints","getMinMaxs","minX","minY","maxX","maxY","xs","ys","isInside","excludeLine","xLine","xLinearConstants","getLinearConstants","lines","convertLines","intersectionPosInfos","line","linearConstants","standardPoint","xPoints","getPointsOnLines","getIntersectionPointsByConstants","linePoint","intersectionCount","xMap","prevValue","getDistanceFromPointToConstants","c1","c2","isZeroA","isZeroB","results","getIntersectionPoints","line1","line2","isLimit","isPointOnLine","minMaxs","order","minMax","right","bottom","pointX","pointY","getOverlapPointInfos","points1","points2","targetPoints1","targetPoints2","lines1","lines2","linearConstantsList1","linearConstantsList2","overlapInfos","linePointInfos","intersectionPoints","isNext","pointMap","getOverlapPoints","infos","isConnectedLine","prevIndex1","prevIndex2","nextIndex1","nextIndex2","getOverlapAreas","areas","area","findReversedAreas","isFirst","nextPoints1","nextArea","areaPoint","nextPoint2","point2Index","findConnectedAreas","getUnoverlapAreas","overlapAreas","unoverlapAreas","overlapArea","nextOverlapArea","connectedAreas","firstConnectedArea","lastPoint_1","firstPoint","firstIndex","getOverlapSize","StyledElement","defaultStyled","tag","Styled","Tag","cssId","cspNonce","targetRef","injectResult","__values","o","__read","makeAble","able","DIRECTIONS4","DIRECTIONS","getSVGCursor","degree","getCursorCSS","degree45","defaultCursor","IS_WEBKIT","IS_WEBKIT605","navi","browserName","IS_CHROME","IS_CHROMIUM","chromiumVersion","IS_CHROMIUM109","IS_FIREFOX","IS_SAFARI_ABOVE15","directionCSS","dir","originX","originY","offset","MOVEABLE_CSS","NEARBY_POS","FLOAT_POINT_NUM","MIN_SCALE","MAX_NUM","MIN_NUM","DIRECTION_REGION_TO_DIRECTION","DIRECTION_INDEXES","DIRECTION_ROTATIONS","MOVEABLE_METHODS","setCustomDrag","isConvert","ableName","ableDatas","convertDragDist","CustomGesto","originalDatas","calculateElementPosition","is3d","poses","calculatePoses","x4","y4","calculatePosition","calculatePointerDist","moveable","moveableClientRect","rootMatrix","calculateInversePosition","getDragDist","setDragStart","allMatrix","beforeMatrix","offsetMatrix","targetMatrix","transformOrigin","getTransformDirection","resolveTransformEvent","nextTransforms","nextTransformAppendedIndexes","convertTransformInfo","targetFunction","matFunctionName","convertTransformFormat","dist","getTransformDist","getBeforeDragDist","bx","by","getTransfromMatrix","isAfter","beforeTransform","afterTransform","beforeTransform2","afterTransform2","targetAllTransform","nextTargetMatrix","res1","afterTargetMatrix","inverseBeforeMatrix","startDragBeforeDist","absoluteOrigin","isBefore","startDragDist","getInverseDragDist","calculateTransformOrigin","prevWidth","prevHeight","prevOrigin","prevSize","measureRatio","getPosIndexesByDirection","indexes","getPosesByDirection","getPosBySingleDirection","getPosByDirection","startPos","fixedDirection","fixedPos","getNextMatrix","getAbsoluteMatrix","getNextTransformMatrix","isAllTransform","targetTransform","scaleMatrix","fillTransformStartEvent","getBeforeRenderableDatas","setTransformIndex","setDefaultTransformIndex","startTransforms","fillOriginalTransform","getNextTransforms","getNextTransformText","getNextStyle","fillTransformEvent","nextTransform","drag","Draggable","fillCSSObject","getTranslateFixedPosition","fixedOffset","nextMatrix","nextFixedPosition","getDirectionOffset","getTranslateDist","fixedPosition","groupable","groupLeft","groupTop","getScaleDist","getDirectionByPos","fixedOffsetPosition","getRotateDist","rotateDist","getResizeDist","nextOrigin","getAbsolutePosition","getAbsolutePosesByState","getGestoData","targetGesto","controlGesto","getIndividualTransforms","getStyle","individualTransforms","getMatrixStackInfo","checkContainer","documentElement","requestEnd","isEnd","targetTransformOrigin","hasFixed","offsetContainer","getOffsetInfo","getCachedStyle","getElementTransform","isFixed","getTransformMatrix","offsetParent","isOffsetEnd","isStatic","parentClientLeft","parentClientTop","fixedClientLeft","fixedClientTop","fixedInfo","getPositionFixedInfo","length_1","convert3DMatrixes","getOffsetPosInfo","hasOffset","origin_1","targetOrigin","offsetPos","offsetLeft","offsetTop","getSVGMatrix","targetZoom","offsetInfo","offsetZoom","parentSlotElement","customOffsetParent","customOffsetLeft","customOffsetTop","getBodyOffset","isElementTarget","cacheStyleMap","clientRectStyleMap","matrixContainerInfos","setStoreCache","useCache","getCachedClientRect","clientRect","nextClientRect","getClientRect","getCachedMatrixContainerInfo","result_1","cache","nextStyle_1","cached","fillChildEvents","groupableDatas","childDatas","triggerChildGesto","isStart","moveables","childEvents","eventParams","ev","childMoveable","gestos","childEvent","triggerChildAbles","eachEvent","startChildDist","parentDatas","startPositions","originalX","originalY","renderDirectionControlsByInfos","renderDirections","React","renderPoses","rotationRad","getProps","degRotation","absDegree","directionMap","renderState","renderDirectionMap","directionSign","directionRotation","dataAttrs","getControlTransform","renderDirectionControls","defaultDirections","directions","displayAroundControls","renderAroundControls","renderLine","renderEdgeLines","edge","getRenderDirections","renderDiagonalDirections","renderAllDirections","checkBoundPoses","bounds","verticalPoses","horizontalPoses","nextBounds","checkBounds","getBounds","externalBounds","clientLeft","clientTop","snapOffsetLeft","snapOffsetTop","snapOffsetRight","snapOffsetBottom","isCSS","checkBoundKeepRatio","endPos","endX","endY","isBottom","isRight","verticalInfo","horizontalInfo","isBound","isVertical","startBoundPos","endBoundPos","minPos","maxPos","boundInfos","isBoundRotate$1","relativePoses","boundRect","nextPoses","boundRotate","vec","boundPos","getDistSize","checkRotateBounds","prevPoses","relativeRad1","relativeRad2","nextRad","VERTICAL_NAMES","HORIZONTAL_NAMES","SNAP_SKIP_NAMES_MAP","VERTICAL_NAMES_MAP","HORIZONTAL_NAMES_MAP","getInitialBounds","hasGuidelines","snappable","innerBounds","verticalGuidelines","horizontalGuidelines","snapGridWidth","snapGridHeight","guidelines","enableSnap","getSnapDirections","snapDirections","mapSnapDirectionPoses","snapPoses","nextSnapDirections","nextSnapPoses","splitSnapDirectionPoses","horizontalNames","verticalNames","calculateContainerPos","containerRect","solveLineConstants","NAME_snapRotationThreshold","NAME_snapRotationDegrees","NAME_snapHorizontalThreshold","NAME_snapVerticalThreshold","checkMoveableSnapPoses","posesX","posesY","dirXs","dirYs","customSnapVerticalThreshold","customSnapHorizontalThreshold","snapThresholdMultiples","snapHorizontalThreshold","selectValue","snapVerticalThreshold","checkSnapPoses","multiples","checkSnap","checkSnapKeepRatio","getTinyDist","verticalSnapInfo","horizontalSnapInfo","getNearestSnapGuidelineInfo","isVerticalSnap","verticalGuideline","isHorizontalSnap","horizontalGuideline","horizontalPos","verticalPos","isSnap","getStringDirection","stringDirection","checkSnaps","horizontalDirection","verticalDirection","snapInfo","posInfo","guidelineInfo","guideline","targetType","targetPoses","snapThreshold","dirs","posType","snapPosInfos","targetPos","guidelineInfos","snapPosInfo","getSnapInfosByDirection","snapDirection","nextDir","checkSnapBoundPriority","aDist","bDist","getNearOffsetInfo","offsets","aSign","bSign","aOffset","bOffset","getCheckSnapDirections","endDirection_1","signX","signY","signs","isStartLine","cx","cy","hitTestLine","test1","test2","isSameStartLine","dots","centerSign","checkInnerBoundDot","start","end","checkInnerBound","verticalSign","horizontalSign","lineConstants","leftLine","topLine","rightLine","bottomLine","topBoundInfo","checkLineBoundCollision","bottomBoundInfo","leftBoundInfo","rightBoundInfo","isAllVerticalBound","isVerticalBound","isAllHorizontalBound","isHorizontalBound","verticalOffset","maxOffset","horizontalOffset","isAllBound","boundLine","isRender","dot1","boundDot1","boundDot2","dy2","dx2","hasDx","hasDy","slope","getInnerBoundInfo","lineInfos","multiple","sizeOffset","getInnerBoundDragInfo","getCheckInnerBoundLineInfos","innerBoundInfo","widthOffsetInfo","heightOffsetInfo","getCheckSnapLineDirections","lineDirections","virtualPoses","dir1","dir2","virtualLine","isBoundRotate","boundDots","getDistPointLine","solveReverseLine","checkRotateInnerBounds","dotInfos","lineRad","lineDist","dotDist","dotRad","distRad","nextRad1","nextRad2","checkInnerBoundPoses","boundMap","pos4","lineInfo","isHorizontalStart","isVerticalStart","solveEquation","snapOffset","solveNextOffset","dist1","dist2","isOutside","widthOffset","heightOffset","getSnapBound","boundInfo","checkThrottleDragRotate","throttleDragRotate","adjustPoses","adjustPos","prevDistY","checkSnapBoundsDrag","ignoreSnap","getAbsolutePoses","getRect","boundPoses","checkMoveableSnapBounds","verticalSnapBoundInfo","horizontalSnapBoundInfo","verticalInnerBoundInfo","horizontalInnerBoundInfo","horizontalBoundInfos","verticalBoundInfos","horizontalDist","verticalDist","checkSnapBounds","guideines","checkSnapRightLine","snapBoundInfo","rad180","isHorizontalLine","isVerticalLine","getSnapBoundInfo","isRequest","startDirection","endDirection","otherStartPos","otherEndPos","checkSnapBoundsKeepRatio","otherHorizontalOffset","isOtherHorizontalBound","isOtherHorizontalSnap","otherVerticalOffset","isOtherVerticalBound","isOtherVerticalSnap","snapLine","getSnapBoundOffset","horizontalBoundInfo","verticalBoundInfo","checkMaxBounds","left_1","top_1","right_1","bottom_1","otherDirection","isCheckVertical","isCheckHorizontal","otherPos","deg","nextOtherPos","isHeightOutside","isWidthOutside","hideThrottleDragRotateLine","dragInfo","beforeOrigin","parentEvent","parentGesto","startCheckSnapDrag","params","fillParams","triggerEvent","parentFlag","deltaOffset","useSnap","isGroup","parentThrottleDrag","prevDist","prevBeforeDist","startValue","parentMoveable","throttleDrag","dragRotateRad","startDragRotate","ry","rx","beforeTranslate","beforeDist","beforeDelta","fillEndParams","nextParams","passDelta","getFixedDirectionInfo","getOffsetFixedDirectionInfo","nextFixedOffset","getOffsetFixedPositionInfo","offsetFixedPosition","directionCondition$2","getDirectionCondition","Resizable","getDirectionViewClassName","parentDirection","parentFixedDirection","getTotalDirection","setRatio","setFixedDirection","setFixedPosition","setMin","setMax","nextMaxSize","startWidth","startHeight","parentKeepRatio","dragClient","parentDist","resolveMatrix","isResize","startOffsetWidth","startOffsetHeight","isWidth","startOffsetMatrix","startTransformOrigin","targetN","nextAllMatrix","resizeFormat","throttleResize","keepRatioFinally","sizeDirection","distWidth","distHeight","getNextBoundingSize","getOffsetSizeDist","nextWidth","nextHeight","boundingWidth","boundingHeight","nextFixedDirection","snapDist","checkSnapResize","computeSize","isNoSnap","inverseDelta","fillAfterTransform","errorWidth","errorHeight","isErrorWidth","isErrorHeight","originalEvents","parentStartOffsetWidth","parentStartOffsetHeight","updateGroupMin","originalMinSize","childMinSize","childStartOffsetWidth","childStartOffsetHeight","parentMinWidth","parentMinHeight","updateGroupMax","originalMaxSize","childMaxSize","parentMaxWidth","parentMaxHeight","catchEvent","parentScale","setRotateStartInfo","startAbsoluteOrigin","getAbsoluteDist","defaultDeg","prevDeg","normalizedPrevDeg","loop","getAbsoluteDistByClient","getRotateInfo","moveableRect","throttleRotate","prevSnapDeg","snapRotation","checkSnapRotate","snapDeg","getRotationPositions","rotationPosition","radPoses","getRotationRad","isReverse","dragControlCondition","rotationTarget","getRefTargets","Rotatable","rotatable","rotateAroundControls","resolveAblesWithRotatable","jsxs","ables","resolveMap_1","directionControlInfos","parentRotate","beforeDirection","resizeStart","startClientX","startClientY","externalRotate","inputTarget","regionDirection","controlDirection","clientPoses","calculateMoveableClientPositions","originalFixedPosition_1","fixedBeforeOrigin","fixedAfterOrigin","posDelta","dragStart","resolveAble","getTotalOrigin","rotatation","clientDistX","clientDistY","groupDelta","beforeInfo","afterInfo","absoluteInfo","isRotate","targetDirection","beforeRotation","absoluteDelta","absoluteDist","absoluteRotation","startRotation","absoluteStartRotation","nextClientX","nextClientY","nextRotation","inverseDist","dragEvent","transformEvent","parentDistance","resize","resizeEvent","parentLeft","parentTop","parentBeforeOrigin","childClient","startGroupClient","prevClientX","prevClientY","distRotate","renderGuideline","scaleType","renderInnerGuideline","renderSnapPoses","renderPos","renderGuidelines","isDisplayInnerSnapDigit","mainNames","targetStart","targetEnd","hide","renderDigitLine","lineType","gap","snapDigit","isDisplaySnapDigit","snapDistFormat","absGap","snapSize","groupByElementGuidelines","otherIndex","groupBy","nextGuidelines","inner","elementRect1","elementRect2","renderDashedGuidelines","rendered","groups","sideNames","sidePos","prevRect","nextRect","size1","size2","renderPos1","renderPos2","renderGapGuidelines","targetSideStart","targetSideEnd","gapRects","sideStartPos","sideEndPos","sideCenterPos","getTotalGuidelines","containerClientRect","overflow","containerClientHeight","containerClientWidth","snapGap","maxSnapElementGuidelineDistance","isDisplayGridGuidelines","elementGuidelines","getElementGuidelines","totalGuidelines","getGapGuidelines","getGridGuidelines","getDefaultGuidelines","checkBetweenRects","snapThresholds","maxSnapElementGapDistance","elementRects","gapGuidelines","targetCenter","targetStart2","targetEnd2","snapThresholdMap","getDist","nextElementRects","snapRect1","snapRect2","rect1","rect2","rect1Start","rect1End","rect2Start","rect2End","isCenter","startGridGroupGuidelines","snapGridAll","snapRenderInfo","hasDirection","rect_1","children_1","posName","clientOffset","rectSize","rectPos","childSizes","firstChildSize","childSnapSizes","rectRatio","childSize","startOffset","snapThresholdInfo","defaultSnapGridWidth","defaultSnapGridHeight","pushGuideline","prevValues","snapRect","nextElementGuidelines","getRefTarget","nextValues","getSnapElementRects","elementSnapDirections","topValue","leftValue","rightValue","bottomValue","centerValue","middleValue","rectTop","rectLeft","sizes","getObjectGuidelines","containerSize","posGuideline","snapWidth","snapHeight","offsetDelta","containerLeft","containerTop","elementLeft","elementTop","elementRight","elementBottom","checkSnapInfo","snapContainer","snapContainerTarget","snapContainerRect","offset1","getDragDistByState","offset2","getNextFixedPoses","nextFixedPos","normalized","getSizeOffsetInfo","innerBoundLineInfos","recheckSizeByTwoDirection","snapPos","nextWidthOffset","nextHeightOffset","checkSizeDist","getNextPoses","isWidthBound","isHeightBound","widthDist","heightDist","isGetWidthOffset","bumpDegree","baseDeg","deg1","deg2","getMinDegreeDistance","deg3","snapRotationThreshold","snapRotationDegrees","origin2_1","rad_1","sorted","firstDegree","checkSnapScale","sizeDist","getSnapGuidelines","posInfos","addBoundGuidelines","verticalSnapPoses","horizontalSnapPoses","innerBoundMap","verticalInnerBoundPoses","horizontalInnerBoundPoses","innerPos","directionCondition$1","Snappable","targetTop","targetLeft","snapRenderThreshold","watchValue","minLeft","minTop","externalPoses","snapInfos","hasExternalPoses","externalRect","verticalPosInfos","horizontalPosInfos","allGuidelines","nextBoundMap","nextInnerBoundMap","multiply2","defaultSync","fn","measureSVGSize","viewBox","getSVGViewBox","getBeforeTransformOrigin","relativeOrigin","getTransformOrigin","getTransformOriginArray","computedTransform","baseVal","lastParent","isParent","checkZoom","getTargetStyle","hasSlot","assignedSlotParentElement","isCustomElement","targetPosition","willChange","slotParentNode","targetParentNode","getSVGGraphicsOffset","getBodyStyle","bodyPosition","marginLeft","marginTop","fixedContainer","hasTransform","body","makeMatrixCSS","clientWidth","clientHeight","viewBoxWidth","viewBoxHeight","scaleX","scaleY","preserveAspectRatio","align","meetOrSlice","svgOrigin","xAlign","yAlign","scaleDimension","isGTarget","isFillBox","bbox","rectWidth","rectHeight","calculateRect","getSVGOffset","targetInfo","getSize","mat","prevLeft","prevTop","posOrigin","rectOrigin","mat2","nextLeft","nextTop","distLeft","distTop","rootClientRect","rootPoses","getDiagonalSize","offsetWidth","offsetHeight","cssWidth","cssHeight","contentWidth","contentHeight","minOffsetWidth","minOffsetHeight","maxOffsetWidth","maxOffsetHeight","inlineCSSWidth","inlineCSSHeight","svg","targetStyle","boxSizing","borderLeft","borderRight","borderTop","borderBottom","paddingLeft","paddingRight","paddingTop","paddingBottom","horizontalPadding","verticalPadding","horizontalBorder","verticalBorder","getParentStyle","resetClientRect","getExtendsRect","isRoot","extendsRect","getClientRectByPosition","isExtends","baseTop","baseLeft","convertTransformOriginArray","getDirection","direciton","unsetAbles","isControl","unsetGesto","gestoName","gesto","resolvedEvent","prevEvent","nextEvent","isBeforeEvent","isManager","pseudoElt","filterAbles","triggerAblesSimultaneously","enabledAbles","ableGroups","equals","groupKeys","groupKey","keyIndex","group","groupByMap","calculatePadding","xAdded","yAdded","nextAdded","convertCSSSize","isRelative","checkAbles","beforeFunctionTexts","beforeFunctionTexts2","targetFunctionText","afterFunctionTexts","afterFunctionTexts2","beforeFunctions","beforeFunctions2","afterFunctions","afterFunctions2","targetFunctions","beforeFunctionMatrix","beforeFunctionMatrix2","afterFunctionMatrix","afterFunctionMatrix2","allFunctionMatrix","isArrayFormat","isSelector","userTargets","getAbsoluteRotation","getSizeDistByDist","startSize","standardRad","signSize","startWidthSize","startHeightSize","secondRad","firstRad","distSize","pinchScale","startFixedDirection","directionsDists","directionRatios","ratioDistance","dist_1","convertTransformUnit","xy","leftOrigin","rightOrigin","originObject","nextOriginObject","rotatePosesInfo","isDeepArrayEquals","arr1","value1","value2","isArray1","isArray2","valueKey","countEach","getPaddingBox","padding","Pinchable","angle","pinchable","controlEventName","pinchAbles","ableEvent","directionCondition","Scalable","setMinScaleSize","setMaxScaleSize","isScale","throttleScale","tempScaleValue","getNextScale","stateDirection","nextScale","distSign","isSelfPinch","startOffsetSize","scaleSize","distText","scaleText","isZeroScale","scaleEndParam","moveableScale","getMiddleLinePos","getTriangleRad","rad1","rad2","isValidPos","poses1","poses2","pi","Warpable","resizable","scalable","warpable","linePosFrom1","linePosFrom2","linePosFrom3","linePosFrom4","linePosTo1","linePosTo2","linePosTo3","linePosTo4","targetInverseMatrix","prevMatrix","isWarp","posIndexes","absolutePoses","selectedPoses","nearByPoses","afterMatrix","totalMatrix","AREA_PIECES","AREA_PIECE","AVOID","VIEW_DRAGGING","restoreStyle","renderPieces","DragArea","dragArea","passDragArea","areaElement","rects","Origin","originStyle","scrollContainer","Scrollable","scrollOptions","dragScroll","scrollContainerElement","scrollThreshold","scrollThrottleTime","Default","Padding","paddingDirections","paddingPos1","paddingPos2","paddingPos3","paddingPos4","RADIUS_DIRECTIONS","calculateRatio","sumSize","sumRatio","HORIZONTAL_RADIUS_ORDER","VERTICAL_RADIUS_ORDER","HORIZONTAL_RADIUS_DIRECTIONS","VERTICAL_RADIUS_DIRECTIONS","getRadiusStyles","clipStyles","radiusPoses","raws","rawPos","getRadiusRange","controlPoses","horizontalRange","verticalRange","clipPose","getRadiusValues","minCounts","full","splitIndex","splitLength","horizontalValues","verticalValues","horizontalValuesLength","verticalValuesLength","hasVerticalValues","nwValue","neValue","seValue","_j","swValue","_k","_l","wnValue","_m","enValue","_o","esValue","_p","wsValue","horizontalRawPoses","verticalRawPoses","nextHorizontalPoses","nextVerticalPoses","removeRadiusPos","radiuslIndex","deleteCount","addRadiusPos","horizontalIndex","verticalIndex","radiusX","radiusY","startVerticalIndex","splitRadiusPoses","horizontals","verticals","CLIP_DIRECTIONS","CLIP_RECT_DIRECTIONS","getClipStyles","clipPath","clipRelative","clipType","clipPoses","isRect","isCircle","subWidth","subHeight","getRectPoses","dirx","diry","getControlSize","xRange","yRange","getClipPath","defaultClip","customClip","clipText","clipPrefix","splitter","xPos","yPos","radiusX_1","radiusY_1","radius","xRadius","yRadius","centerPos_1","roundIndex","rectLength","radiusValues","_q","_r","_s","top_2","_t","nextRight","nextBottom","_u","posValue","top_3","moveControlPos","dists","verticalDirections","horizontalDirections","verticalDirection_1","horizontalDirection_1","fixedIndex","nextDist","nextControlPoses_1","controlPose","controlDir","dirDir","dirHorizontal","dirVertical","addClipPath","clipIndex","clipStyle","removeClipPath","Clippable","customClipPath","defaultClipPath","clipArea","clipPathState","snapBoundInfos","calculatedPos","controls","isInset","isPolygon","linePoses_1","clipLeft","clipTop","ellipseClipPath","piece","areaPoses","allWidth","allHeight","allLeft_1","allTop_1","directionType","snapPos1","snapPos2","dragWithClip","isDragTarget","isLine","isArea","originalDraggable","originalDist","firstDist","isDragWithTarget","isAll","guidePoses","isEllipse","guideRect","guideXPoses","guideYPoses","rectPoses","rectDists_1","boundDelta","snapOffsetY","snapOffsetX","distSnapX","distSnapY","width_1","height_1","nextControlPoses_2","nextClipStyles","dragDist","isClipStart","OriginDraggable","originRelative","distOrigin","dragDelta","addBorderRadiusByLine","lineIndex","horizontalsLength","virtual","verticalsLength","controlIndex","controlPoseInfo","addBorderRadius","removeBorderRadius","getBorderRadius","borderRadius","triggerRoundEvent","getStyleBorderRadius","firstMoveable","Roundable","roundClickable","borderRadiusState","minRoundControls","maxRoundControls","roundPadding","isDisplayShadowRoundControls","verticalCount","horizontalCount","basePos","originalPos","isDisplayVerticalShadow","indexAttr","roundRelative","selectedControlPose","selectedVertical","selectedHorizontal","pose","poseDist","isIdentityMatrix","identityMatrix","BeforeRenderable","inlineTransform","cssMatrix","startTransform","Renderable","transformObject","matrixInfo","triggerAble","moveableAbles","eventOperations","eventAffix","eventType","requestInstant","requestAble_1","isDragStop","isFirstStart","gestoType","prevGesto","trigger","conditionName","nextDatas","forceEndedCount","updatedCount","eventOperation","eventAbles","isForceEnd","flushSync","checkMoveableTarget","eventTarget","dragTargetElement","getTargetAbleGesto","moveableTarget","controlBox","dragTarget","checkTarget","getAbleGesto","getControlAbleGesto","checkControlTarget","ableType","conditionFunctions","isTargetAbles","preventClickDefault","dragContaienrOption","dragContainer","isPinchScheduled","EventManager","calculateMatrixStack","rootContainer","isAbsolute3d","prevTargetMatrix","containerZoom","rootMatrixes","isRoot3d","offsetRootContainer","rootZoom","isNext3d","isSVGGraphicElement","nextRootMatrixes","originalRootContainer","endContainer","rootMatrixBeforeOffset","nextInfo","isMatrix3d","originalRootMatrix","calculateElementInfo","allResult","getElementInfo","getMoveableTargetInfo","moveableElement","requestStyles","targetClientRect","rootContainerClientRect","getStyle_1","beforePosition","absoluteTargetPosition","absoluteContainerPosition","containerClientRectLeft","containerClientRectTop","containterClientLeft","containerClientTop","clientDelta","getPersistState","MoveableManager","parentPosition","propsTarget","ControlBoxElement","linePadding","controlPadding","stateTarget","groupTargets","isDragging","ableAttributes","ableClassName","isVisible","viewContainer","manager","wrapperMoveable","totalSize","isTarget","isSetState","isSingle","persistState","statePos","isInstant","allAbles","requsetAble","ableRequester","requester","ableParam","originalBeforeOrigin","stateLeft","stateTop","isPersisted","renderPos3","renderPos4","zoomOffset","stateContainer","isTargetChanged","isChanged","moveableContainer","customStyleMap","hasControlBox","persistData","firstRenderState","pinchStart","dragControlStart","targetAbles","controlAbles","Renderer","styleNames","ableStyleNames","hasTargetAble","hasControlAble","isUnset","hideDefaultLines","hideChildMoveableDefaultLines","useDragArea","nextTarget","prevTarget","prevDragArea","isDragTargetChanged","isDragAreaChanged","eventKeys","hasAbles","viewContainerOption","nextClassNames","prevClassNames","classPrefix","targetGestoData","controlGestoData","observer","records","e_1","records_1","records_1_1","mutation","e_1_1","Groupable","renderGroupRects","persistDatChildren","Clickable","isMoveableElement","containsElement","containsTarget","parentTarget","getDraggableEvent","edgeDraggable","IndividualGroupable","MOVEABLE_ABLES","MOVEABLE_EVENTS","MOVEABLE_PROPS","solveConstantsDistance","solveC","getMaxPos","getMinPos","getGroupRect","parentPoses","fixedRotation","a1_1","a2_1","a1MinMax_1","a1MinMaxPos_1","a2MinMax_1","a2MinMaxPos_1","a1Dist","a2Dist","a1MinPos","a1MaxPos","a2MinPos","a2MaxPos","minHorizontalLine","maxHorizontalLine","minVerticalLine","maxVerticalLine","minX_1","minY_1","maxX_1","maxY_1","changedX","findMoveableGroups","childTargetGroups","targetGroup","childMoveableGroups","checked","MoveableGroup","checkeds","targetGroups","moveableGroups","useDefaultGroupRotate","finded","isReset","defaultGroupRotate","persistedRoatation","getMoveableGroupRect","parentRotation","posesRotations","rotations","groupRotation","firstRotation","isSameRotation","groupPoses","groupRect","rootGroupRect","posesInfo","rotateScale","isContainerChanged","MoveableIndividualGroup","canPersist","individualProps","controlBoxElement","dragElement","getElementTargets","refTargets","selectorMap","elementTargets","getTargetGroups","compareRefTargets","prevRefTargets","nextRefTargets","InitialMoveable","cssMap","moveableContructor","userAbles","userProps","nextSelectorMap","totalAbles","prevMoveable","target_1","prevTargetMoveable","mv","resolvePromise","isBrowser","updateSelectorMap","selectorTarget","Moveable","makeMoveable","InnerMoveable","nextOptions","selfElement","innerMoveable","createCommonjsModule","module","keycode","exports","keyCode","searchInput","hasKeyCode","search","foundNamedKey","codes","aliases","nameOrCode","alias","keycode_1","keycode_2","keycode_3","keycode_4","keycode_5","codeData","keysSort","getKey","keyName","getCombi","getModifierCombi","getArrangeCombi","arrangeKeys","prevScore","nextScore","globalKeyController","KeyController","comb","isToggle","combi","touch","filterDuplicated","map","elementFromPoint","baseNode","jsx","elChildren","elStyle","attrs","diffValue","boundArea","getDefaultElementRect","passTargets","beforeTargets","afterTargets","continueSelectWithoutDeselect","getLineSize","OPTION_TYPES","Selecto","clickedTarget","selectFromInside","selectByClick","boundContainer","preventDragFromInside","clickBySelectEnd","dragCondition","boundElement","rectElement","hitRect","firstPassedTargets","allowClickBySelectEnd","hasInsideTargets","pointTarget","isPreventSelect","innerScrollOptions","isInnerScroll","inputEvent_1","innerScrollElement","hasScrollOptions","selectFlag","isKeyDown","isKeyUp","containers","portalContainer","selectedTargets","beforeSelected","selectedElements","startPoint","endPoint","mousedown","mousemove","mouseup","getElementRect","selectableElements","selectableTargets","selectablePoints","hasIndexesMap","parentMap_1","parents","paths","prevParentElement","keyContainer","toggleContinueSelect","toggleContinueSelectWithoutDeselect","nextClassName","continueSelect","selectRect","gestoEvent","hitRate","innerGroups","innerWidth","innerHeight","ignoreClick","rectPoints","isHit","hitRateValue","inArea","overlapPoints","overlapSize","rate","selectableInners","yGroups","isMoveInnerScroll","parentMap_2","parentInfo","containerInfo","isDragStartEnd","startResult","startSelectedTargets","startPassedTargets","afterAdded","afterRemoved","afterPrevList","afterList","containerX","containerY","offsetSize","passedTargets","isKeyup","nextKeys","toggleKeys","singleKey_1","innerScrollContainer_1","parentMap_3","innerScrollPathsList","innerScrollPaths","isAlwaysTrue","selectablePoints_1","groups_1","getter","Selecto$1","CONNECTION_ANCHOR_DIV_ID","CONNECTION_ANCHOR_ALT","CONNECTION_ANCHOR_HIGHLIGHT_OFFSET","ANCHORS","ANCHOR_PADDING","HALF_SIZE","ConnectionAnchors","setRef","setAnchorsRef","handleMouseLeave","highlightEllipseRef","halfSizeHighlightEllipse","anchorImage","onMouseEnterAnchor","onMouseLeaveHighlightElement","handleMouseLeaveAnchors","generateAnchors","anchors","anchor","reorderElements","src","dragToGap","destPosition","updateElements","idx","destIndex","findElementByTarget","sceneElements","stack","currentElement","nestedElements","nestedElement","frameSelection","first","currentSelectedElements","currentLayer","newLayer","framePlacement","generateFrameContainer","maxRight","maxBottom","idCounter","htmlElementTypes","ConnectionSVG","setSVGRef","setLineRef","setSVGVertexRef","setVertexPathRef","setVertexRef","headId","CONNECTION_LINE_ID","EDITOR_HEAD_ID","maximumVertices","selectedConnection","setSelectedConnection","selectedConnectionRef","clearSelectedConnection","selectConnection","renderConnections","vertices","xStart","yStart","xEnd","yEnd","midpoint","xDist","yDist","connectionCursorStyle","selectedStyles","CONNECTION_HEAD_ID_START","CONNECTION_HEAD_ID_END","addVertices","pathString","vertex","X","Y","xa","ya","xb","yb","lHalfArc","angle1","angle2","Xn","Yn","previousVertex","Xp","Yp","theta","ccw","lSegment","nextVertex","lSegmentNext","lDelta","markerStart","markerEnd","getAnimationDirection","CONNECTION_VERTEX_ID","CONNECTION_VERTEX_ADD_ID","CONNECTION_VERTEX_ORTHO_TOLERANCE","CONNECTION_VERTEX_SNAP_TOLERANCE","Connections","BehaviorSubject","anchorElement","anchorsElement","connectionSVG","connectionLine","connectionVertex","connectionVertexPath","elementTarget","customElementAnchors","anchorsAmount","elementBoundingRect","parentBoundingRect","connectionLineX1","connectionLineY1","sourceX","sourceY","targetX","targetY","targetName","selectedValue","vx1","vy1","vx2","vy2","xSnap","ySnap","deleteVertex","verticalBefore","verticalAfter","horizontalBefore","horizontalAfter","angleOverall","angleBefore","connectionIndex","vertexIndex","currentSource","currentConnections","currentVertices","currentVertex","newVertex","selectedTarget","connectionStartTargetBox","connectionAnchorOffsetX","connectionAnchorOffsetY","mouseX","mouseY","update","settingsViewable","openSettings","evt","onKeyPress","dimensionViewable","constraintViewable","targetElement","verticalConstraintVisualization","horizontalConstraintVisualization","borderStyle","centerIndicatorLineOne","centerIndicatorLineTwo","centerIndicator","verticalConstraintTop","verticalConstraintBottom","verticalConstraintTopBottom","verticalConstraintCenterLine","verticalConstraintCenter","horizontalConstraintLeft","horizontalConstraintRight","horizontalConstraintLeftRight","horizontalConstraintCenterLine","horizontalConstraintCenter","ZOOM_RANGE","disableCustomables","enableCustomables","isTargetAlreadySelected","selectedTargetParent","generateTargetElements","rootElements","initMoveable","destroySelecto","allowChanges","targetedElement","elementSupportsEditing","needsUpdate","isTargetMoveableElement","isElementSelected","startPanning","startScrollLeft","startScrollTop","handleMouseMove","moveEvent","scaleAdjustedDeltaX","scaleAdjustedDeltaY","handleMouseUp","triggerContextMenu","calculateZoomToFitScale","paddingRatio","calculateGroupBoundingBox","paddedWidth","paddedHeight","extractTranslateFromTransform","DEFAULT_OFFSET","HORIZONTAL_OFFSET","frameItemDummy","updateName","shiftItemsOnDuplicate","oldPlacement","copy","elem","endIndex","firstPosition","srcIndex","vals","CanvasContextMenu","onVisibilityChange","inlineEditorOpen","isMenuVisible","setIsMenuVisible","setAnchorPoint","handleContextMenu","closeContextMenu","renderMenuItems","openCloseEditorMenuItem","MenuItem","editElementMenuItem","onClickEditElementMenuItem","typeOptions","getTypeOptionsSubmenu","submenuItems","onClickItem","sceneContainerDimensions","addItemMenuItem","setBackgroundMenuItem","contextMenuAction","actionType","currentSelectedElement","ContextMenu","CanvasTooltip","onClose","overlayProps","useOverlay","dialogProps","useDialog","timeField","lastTimeValue","shouldDisplayTimeContentItem","headerItem","contentItems","elementHasActions","VizTooltipContainer","CloseButton","VizTooltipFooter","zIndex","PointerEvents","setConnectionsSVGRef","Connections2","connectionsSVG","RootElement","changeCallback","rest","Scene","onSave","ReplaySubject","Subject","visible","isFrame","scalar","updateMoveable","sceneContainer","viewerContainer","viewportContainer","zoomToContent","root","viewerDiv","infiniteViewer","dimentions","dashboard","enableEditing","showAdvancedTypes","panZoom","tooltip","tooltipMode","tooltipDisableForOneClick","svgConnections","skipNextSelectionBroadcast","hasDataLinks","hasActions","isTooltipValid","isCanvasTooltipEnabled","isTooltipDisabledForOneClick","shouldShowElementTooltip","sceneDiv","SetBackground","bgImage","setBgImage","ResourcePickerPopover","BackgroundSizeEditor","imageSize","onImageSizeChange","DirectionDimensionEditor","directionOptions","fixedDirectionOptions","labelWidth","onModeChange","mode","onFixedChange","selectedDirection","opt","defaultLineStyleConfig","LineStyleEditor","onLineStyleChange","onAnimateChange","animate","Switch","ActionsEditor","dataLinks","ActionsInlineEditor","oneClick","DataLinksEditor","DataLinksInlineEditor","getCategoryName","optionBuilder","ScaleDimensionEditor","getConnectionEditor","lodash","ConstraintSelectionBox","onVerticalConstraintChange","onHorizontalConstraintChange","currentConstraints","onClickTopConstraint","onClickBottomConstraint","onClickVerticalCenterConstraint","onClickLeftConstraint","onClickRightConstraint","onClickHorizontalCenterConstraint","HOVER_COLOR","SELECTED_COLOR","selectionBoxColor","QuickPositioning","onPositionChange","settings","onQuickPositioningChange","defaultConstraint","originalConstraint","getRightBottomPosition","getCenterPosition","elementSize","places","PlacementEditor","horizontalOptions","verticalOptions","layout","reselectElementAfterChange","onHorizontalConstraintSelect","onVerticalConstraintSelect","Icon","NumberInput","getElementEditor","layer","layerTypes","isUnsupported","currentOptions","TreeContext","UnstableContext","DropIndicator","dropPosition","dropLevelOffset","indent","_objectDestructuringEmpty","Indent","_ref","prefixCls","level","baseClassName","_excluded","ICON_OPEN","ICON_CLOSE","defaultTitle","_unstableContext$node","_context$filterTreeNo","_classNames4","eventKey","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","expanded","selected","halfChecked","domRef","active","onMouseMove","selectable","unstableContext","selectHandleRef","_React$useState","_React$useState2","dragNodeHighlight","setDragNodeHighlight","isDisabled","isCheckable","onSelect","onCheck","isSelectable","onSelectorClick","onSelectorDoubleClick","onMouseEnter","onMouseLeave","onContextMenu","isDraggable","onDragStart","onDragEnter","onDragOver","onDragLeave","onDragEnd","onDrop","onExpand","hasChildren","memoizedIsLeaf","dragHandlerNode","_context$draggable","renderSwitcherIconDom","isInternalLeaf","switcherIcon","renderSwitcher","_switcherIconDom","switcherIconDom","checkboxNode","$custom","nodeState","iconNode","dropIndicatorNode","rootDraggable","showIndicator","selectorNode","_props$title","title","wrapClass","$icon","currentIcon","titleNode","dataOrAriaAttributeProps","pickAttrs","_ref2","isEndNode","draggableWithoutDisabled","dragging","ariaSelected","useUnmount","triggerStart","triggerEnd","firstMount","setFirstMount","useLayoutEffect","MotionTreeNode","oriProps","motion","motionNodes","motionType","onOriginMotionStart","onOriginMotionEnd","treeNodeRequiredProps","setVisible","_React$useContext","targetVisible","triggerMotionStart","triggerMotionEndRef","triggerMotionEnd","onVisibleChanged","nextVisible","motionRef","motionClassName","motionStyle","treeNode","restProps","treeNodeProps","findExpandedKeys","prevLen","nextLen","find","shorter","longer","getExpandRange","shorterStartIndex","shorterEndNode","longerStartIndex","longerEndIndex","HIDDEN_STYLE","noop","MOTION_KEY","MotionNode","MotionEntity","MotionFlattenData","getMinimumRangeTransitionRange","itemHeight","itemKey","getAccessibilityPath","NodeList","checkable","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","keyEntities","disabled","dragOverNodeKey","focusable","activeItem","focused","tabIndex","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd","domProps","listRef","indentMeasurerRef","scroll","prevExpandedKeys","setPrevExpandedKeys","_React$useState3","_React$useState4","prevData","setPrevData","_React$useState5","_React$useState6","transitionData","setTransitionData","_React$useState7","_React$useState8","transitionRange","setTransitionRange","_React$useState9","_React$useState10","setMotionType","dataRef","onMotionEnd","latestData","diffExpanded","rangeNodes","newTransitionData","_keyIndex","_rangeNodes","_newTransitionData","mergedData","originList","mergedKey","arrDel","clone","arrAdd","posToArr","getDragChildrenKeys","dragNodeKey","dragChildrenKeys","entity","dig","isLastChild","treeNodeEntity","posArr","isFirstChild","calcDropPosition","dragNodeProps","targetNodeProps","startMousePosition","allowDrop","flattenedNodes","expandKeys","_abstractDropNodeEnti","_getBoundingClientRec","horizontalMouseOffset","rawDropLevelOffset","filteredExpandKeys","_keyEntities$key","abstractDropNodeEntity","nodeIndex","flattenedNode","prevNodeIndex","prevNodeKey","initialAbstractDropNodeKey","abstractDragOverEntity","abstractDragDataNode","abstractDropDataNode","dropAllowed","calcSelectedKeys","internalProcessProps","convertDataToTree","treeData","processor","_ref2$processProps","processProps","_ref3","childrenNodes","parseCheckedKeys","keyProps","warning","conductExpandParent","keyList","conductUp","MAX_RETRY_TIMES","Tree","_React$Component","_len","_args","_key","nodeProps","_this$state","newExpandedKeys","_this$state2","flattenNodes","_this$props","_calcDropPosition","dropTargetKey","dropContainerKey","dropTargetPos","_this$state3","_this$props2","_calcDropPosition2","_this$getActiveItem","outsideTree","_this$state4","abstractDropNodeProps","dropToChild","dropResult","draggingNodeKey","_this$state5","nodeItem","eventNode","_this$props3","expandAction","_this$props4","onDoubleClick","_this$state6","_this$props5","targetSelected","selectedNodes","selectedKey","_this$state7","oriCheckedKeys","oriHalfCheckedKeys","_this$props6","checkStrictly","checkedObj","eventObj","checkedKey","_conductCheck","_checkedKeys","_halfCheckedKeys","keySet","_conductCheck2","_entity$children","loadPromise","reject","_ref$loadedKeys","_ref$loadingKeys","_this$props7","loadData","onLoad","promise","currentLoadedKeys","newLoadedKeys","onRightClick","_len2","_key2","_len3","_key3","_this$state8","_this$state9","_this$state10","listChanging","_this$props8","certain","targetExpanded","newFlattenTreeData","currentExpandedKeys","expandedKeysToRestore","newActiveKey","activeKey","_this$props9","_this$props9$itemScro","itemScrollOffset","_this$state11","_this$state12","_key4","_this$state13","_this$props10","KeyCode","expandable","atomic","forceState","needSync","allPassed","newState","_this$props11","_this$props11$itemScr","_this$state14","_this$props12","showLine","_this$props12$tabInde","showIcon","icon","draggable","filterTreeNode","titleRender","dropIndicatorRender","onScroll","rootClassName","rootStyle","draggableConfig","entitiesMap","cloneKeyEntities","nextExpandedKeys","checkedKeyEntity","_checkedKeyEntity","_checkedKeyEntity$che","_checkedKeyEntity$hal","conductKeys","getGlobalStyles","TreeNodeTitle","nodeData","setAllowSelection","getScene","onDelete","onDuplicate","onNameChange","verifyLayerNameUniqueness","nameToVerify","getLayerInfo","LayerName","getTreeData","selectedColor","onNodeDrop","destKey","srcKey","srcElement","allowSelection","TreeNavigationEditor","setTreeData","autoExpandParent","setAutoExpandParent","setExpandedKeys","setSelectedKeys","globalCSS","selectedBgColor","selectionByUID","srcEl","destEl","allow","onClearSelection","onTitleRender","onFrameSelection","AddLayerButton","getLayerEditor","TabsEditor","onTabChange","activeTab","setActiveTab","tabs","onCurrentTabChange","TabsBar","Tab","InlineEditBody","activePanel","activePanelSubject","instanceState","pane","OptionsPaneCategoryDescriptor","supplier","addStandardCanvasEditorOptions","getOptionsPaneCategoryDescriptor","topLevelItemsContainerStyle","tab","noElementSelected","renderOptionsPaneCategoryDescriptor","OptionsPaneCategory","getOptionsPaneCategory","categoryNames","access","OFFSET_X","OFFSET_Y","InlineEdit","windowHeight","windowWidth","inlineEditKey","defaultMeasurements","defaultX","defaultY","savedPlacement","measurements","setMeasurements","setPlacement","onDragStop","saveToStore","onResizeStop","canvasInstances","activeCanvasPanel","isInlineEditOpen","isSetBackgroundOpen","CanvasPanel","Subscription","onOptionsChange","PanelContext","canvasInstance","ci","inlineEditingSwitched","shouldShowAdvancedTypesSwitched","panZoomSwitched","zoomToContentSwitched","tooltipModeSwitched","tooltipDisableForOneClickSwitched","helpUrl","PanZoomHelp","Alert","newWindow","canvasMigrationHandler","pluginVersion","PanelPlugin","connectionSelection","ColorIndicatorPosition","VizTooltipColorIndicator","isHollow","SeriesIcon","LabelValueTypes","SUCCESSFULLY_COPIED_TEXT","SHOW_SUCCESS_DURATION","HORIZONTAL_PX_PER_CHAR","VizTooltipRow","justify","marginRight","showValueScroll","innerValueScrollStyle","showLabelTooltip","setShowLabelTooltip","copiedText","setCopiedText","showCopySuccess","setShowCopySuccess","labelRef","valueRef","timeoutId","copyToClipboard","fallbackCopyToClipboard","textarea","err","onMouseEnterLabel","onMouseLeaveLabel","Tooltip","InlineToast"],"sourceRoot":""}