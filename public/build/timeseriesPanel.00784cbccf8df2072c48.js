"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[563],{50784:(Pe,ie,t)=>{t.d(ie,{z:()=>R,e:()=>U});var g=t(74848),T=t(96540),ne=t(95004),le=t(62748),ce=t(7515),F=t(22803),v=t(34743),I=t(83505),ae=t(46885),K=t(55386),J=t(51898),Q=t(63142),q=t(15245),s=t(15840),he=t(73125),M=t(16913);const W=({timeZone:a,dataFrame:d,frameIndex:b,rowIndex:r,config:C,exemplarColor:S,clickedRowIndex:l,setClickedRowIndex:x,maxHeight:E,maxWidth:Y})=>{const z=(0,Q.of)(O,Y),[A,j]=(0,T.useState)(!1),[G,H]=(0,T.useState)(!1),Z=[(0,v.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,v.BN)()],{context:re,refs:_,floatingStyles:k}=(0,I.we)({open:A,placement:"bottom",onOpenChange:j,middleware:Z,whileElementsMounted:ae.ll,strategy:"fixed"}),L=(0,I.s9)(re),ee=(0,I.Mk)(re,{handleClose:(0,I.iB)(),enabled:l===void 0}),{getReferenceProps:Oe,getFloatingProps:Se}=(0,I.bv)([L,ee]);(0,T.useEffect)(()=>{l!==r&&H(!1)},[l,r]);const xe=()=>(0,g.jsx)("rect",{fill:S,x:"3.38672",width:"4.78985",height:"4.78985",transform:"rotate(45 3.38672 0)"},"diamond"),Ee=()=>{H(!0)},Le=(0,T.useCallback)(()=>{const fe=()=>{H(!1),j(!1),x(void 0)};let Me=[],pe=[];return d.fields.forEach(me=>{const ye=me.values[r];pe.push(...(0,M.u6)(me,r));const Ce=me.display?.(ye)??{text:`${ye}`,numeric:+ye};Me.push({label:me.state?.displayName??me.name,value:(0,K.cN)(Ce)})}),(0,g.jsxs)("div",{className:(0,F.cx)(z.tooltipWrapper,G&&z.pinned),ref:_.setFloating,style:k,...Se(),children:[G&&(0,g.jsx)(s.J,{onClick:fe}),(0,g.jsx)(he.A,{items:Me,links:pe,isPinned:G,maxHeight:E})]})},[d.fields,r,z,G,x,k,Se,_.setFloating,E]),Ne=C.getSeries().find(fe=>fe.props.dataFrameFieldIndex?.frameIndex===b)?.props.lineColor,Te=()=>{x(r),Ee()};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{ref:_.setReference,className:z.markerWrapper,"data-testid":J.Tp.components.DataSource.Prometheus.exemplarMarker,role:"button",tabIndex:0,...Oe(),onClick:Te,onKeyDown:fe=>{fe.key==="Enter"&&Te()},children:(0,g.jsx)("svg",{viewBox:"0 0 7 7",width:"7",height:"7",style:{fill:Ne},className:(0,F.cx)(z.marble,(A||G)&&z.activeMarble),children:xe()})}),(A||G)&&(0,g.jsx)(q.ZL,{children:Le()})]})},O=(a,d)=>({markerWrapper:(0,F.css)({padding:"0 4px 4px 4px",width:"8px",height:"8px",boxSizing:"content-box",transform:"translate3d(-50%, 0, 0)","&:hover":{"> svg":{transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"}}}),marker:(0,F.css)({width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:`4px solid ${a.v1.palette.red}`,pointerEvents:"none"}),marble:(0,F.css)({display:"block",opacity:.5,[a.transitions.handleMotion("no-preference")]:{transition:"transform 0.15s ease-out"}}),activeMarble:(0,F.css)({transform:"scale(1.3)",opacity:1,filter:"drop-shadow(0 0 8px rgba(0, 0, 0, 0.5))"}),tooltipWrapper:(0,F.css)({background:a.colors.background.elevated,maxWidth:d??"none",whiteSpace:"pre",borderRadius:a.shape.radius.default,position:"fixed",border:`1px solid ${a.colors.border.weak}`,boxShadow:a.shadows.z2,userSelect:"text"}),pinned:(0,F.css)({boxShadow:a.shadows.z3})}),R=({exemplars:a,timeZone:d,config:b,visibleSeries:r,maxHeight:C,maxWidth:S})=>{const l=(0,T.useRef)(),[x,E]=(0,T.useState)();(0,T.useLayoutEffect)(()=>{b.addHook("init",A=>{l.current=A})},[b]);const Y=(0,T.useCallback)((A,j)=>{const G=A.fields.find(L=>L.name===ne.LE),H=A.fields.find(L=>L.name===ne.Bc);if(!G||!H||!l.current)return;const Z=Object.keys(l.current.scales).find(L=>!["x","y"].some(ee=>ee===L))??le.s,re=l.current.scales[Z].min,_=l.current.scales[Z].max;let k=H.values[j];return re!=null&&k<re&&(k=re),_!=null&&k>_&&(k=_),{x:l.current.valToPos(G.values[j],"x"),y:l.current.valToPos(k,Z)}},[]),z=(0,T.useCallback)((A,j)=>{const G=r!==void 0?V(r,A,j):!0,H=r!==void 0?w(A,j,r):void 0;return G?(0,g.jsx)(W,{setClickedRowIndex:E,clickedRowIndex:x,timeZone:d,dataFrame:A,frameIndex:0,rowIndex:j,config:b,exemplarColor:H,maxHeight:C,maxWidth:S}):(0,g.jsx)(g.Fragment,{})},[r,x,d,b,C,S]);return(0,g.jsx)(ce.a,{config:b,id:"exemplars",events:a,renderEventMarker:z,mapEventToXYCoords:Y})},U=(a,d)=>{const b=a.series.filter(C=>C.props.show),r=[];return d?.length&&b.forEach(C=>{const S=C.props?.dataFrameFieldIndex?.frameIndex,l=C.props?.dataFrameFieldIndex?.fieldIndex;if(S!==void 0&&l!==void 0){const x=d[S]?.fields[l];x?.labels&&r.push({labels:x.labels,color:C.props?.lineColor??""})}}),{labels:r,totalSeriesCount:a.series.length}},w=(a,d,b)=>{let r;return b.labels.some(C=>{const S=Object.keys(C.labels),l=a.fields.filter(x=>S.find(E=>E===x.name));return l.length&&l.every((E,Y,z)=>{const A=E.values[d];return C.labels[E.name]===A})?(r=C.color,!0):!1}),r},V=(a,d,b)=>{let r=!1;return a.labels.length===a.totalSeriesCount?r=!0:a.labels.some(C=>{const S=Object.keys(C.labels);if(Object.keys(C.labels).length===0)r=!0;else{const l=d.fields.filter(x=>S.find(E=>E===x.name));l.length&&(r=a.labels.some(x=>Object.keys(x.labels).every(E=>{const Y=x.labels[E];return l.find(z=>z.values[b]===Y)})))}return r}),r}},55569:(Pe,ie,t)=>{t.r(ie),t.d(ie,{plugin:()=>Ke});var g=t(16207),T=t(92745),ne=t(43173),le=t(79277),ce=t(41069),F=t(13148),v=t(74848),I=t(96540),ae=t(95004),K=t(17503),J=t(39443),Q=t(84229),q=t(14477),s=t(739),he=t(64400),M=t(93630),W=t(18667),O=t(69234),R=t(25422),U=t(65642),w=t(78308),V=t(36327),a=t(50784),d=t(13507),b=t(66881),r=t(64394),C=t(64761),S=t(22429),l=t(73495);class x{getSuggestionsForData(i){const{dataSummary:o}=i;if(!o.hasTimeField||!o.hasNumberField||o.rowCountTotal<2)return;const u=i.getListAppender({name:l.m.LineChart,pluginId:"timeseries",options:{legend:{calcs:[],displayMode:s.lm.Hidden,placement:"right",showLegend:!1}},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:n=>{n.fieldConfig?.defaults.custom?.drawStyle!==s.GR.Bars&&(n.fieldConfig.defaults.custom.lineWidth=Math.max(n.fieldConfig.defaults.custom.lineWidth??1,2))}}}),h=100;if(u.append({name:l.m.LineChart}),o.rowCountMax<200&&u.append({name:l.m.LineChartSmooth,fieldConfig:{defaults:{custom:{lineInterpolation:s.dx.Smooth}},overrides:[]}}),o.numberFieldCount===1){u.append({name:l.m.AreaChart,fieldConfig:{defaults:{custom:{fillOpacity:25}},overrides:[]}}),u.append({name:l.m.LineChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:r.Y.ContinuousGrYlRd},custom:{gradientMode:s.on.Scheme,lineInterpolation:s.dx.Smooth,lineWidth:3,fillOpacity:20}},overrides:[]}}),o.rowCountMax<h&&(u.append({name:l.m.BarChart,fieldConfig:{defaults:{custom:{drawStyle:s.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:s.on.Hue}},overrides:[]}}),u.append({name:l.m.BarChartGradientColorScheme,fieldConfig:{defaults:{color:{mode:r.Y.ContinuousGrYlRd},custom:{drawStyle:s.GR.Bars,fillOpacity:90,lineWidth:1,gradientMode:s.on.Scheme}},overrides:[]}}));return}u.append({name:l.m.AreaChartStacked,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:s.gs.Normal,group:"A"}}},overrides:[]}}),u.append({name:l.m.AreaChartStackedPercent,fieldConfig:{defaults:{custom:{fillOpacity:25,stacking:{mode:s.gs.Percent,group:"A"}}},overrides:[]}}),o.rowCountTotal/o.numberFieldCount<h&&(u.append({name:l.m.BarChartStacked,fieldConfig:{defaults:{custom:{drawStyle:s.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:s.on.Hue,stacking:{mode:s.gs.Normal,group:"A"}}},overrides:[]}}),u.append({name:l.m.BarChartStackedPercent,fieldConfig:{defaults:{custom:{drawStyle:s.GR.Bars,fillOpacity:100,lineWidth:1,gradientMode:s.on.Hue,stacking:{mode:s.gs.Percent,group:"A"}}},overrides:[]}}))}}function E(e){const i=(0,S.UA)().getCurrent()?.getPanelById(e);if(i){const o=i.transformations?[...i.transformations]:[];return o.push({id:C.F.prepareTimeSeries,options:{format:"wide"}}),{name:"Transform to wide time series format",pluginId:"timeseries",transformations:o}}}var Y=t(76234);const z=({data:e,timeRange:i,timeZone:o,width:u,height:h,options:n,fieldConfig:P,onChangeTimeRange:c,replaceVariables:N,id:X})=>{const{sync:de,eventsScope:y,canAddAnnotations:f,onThresholdsChange:m,canEditThresholds:D,showThresholds:te,dataLinkPostProcessor:p,eventBus:$,canExecuteActions:se}=(0,he.d2)(),we=(0,I.useMemo)(()=>se?.()??!1,[se]),Ye=n.orientation===s.wV.Vertical,{frames:ge,compareDiffMs:Ze}=(0,I.useMemo)(()=>{let B=(0,Y.B_)(e.series,U.$W.theme2,i);if(B!=null){let ve=[0];return B.forEach(oe=>{const ue=oe.meta?.timeCompare?.diffMs??0;oe.fields.forEach(be=>{be.type!==ae.PU.time&&ve.push(ue)}),ue!==0&&(0,K.dK)(oe,B,i)&&(0,K.Vh)(oe,ue,U.$W.theme2.colors.text.disabled)}),{frames:B,compareDiffMs:ve}}return{frames:B}},[e.series,i]),Xe=(0,I.useMemo)(()=>(0,Y.Fg)(n.timezone,o),[n.timezone,o]),Ae=(0,I.useMemo)(()=>{if(ge?.length&&ge.every(B=>B.meta?.type===J.m.TimeSeriesLong)){const B=E(X);return{message:"Long data must be converted to wide",suggestions:B?[B]:void 0}}},[ge,X]),We=!!(f&&f()),[Je,je]=(0,I.useState)(null),De=de?.()??Q.y.Off;return!ge||Ae?(0,v.jsx)(q.a,{panelId:X,message:Ae?.message,fieldConfig:P,data:e,needsTimeField:!0,needsNumberField:!0,suggestions:Ae?.suggestions}):(0,v.jsx)(R.Z,{frames:ge,structureRev:e.structureRev,timeRange:i,timeZone:Xe,width:u,height:h,legend:n.legend,options:n,replaceVariables:N,dataLinkPostProcessor:p,cursorSync:De,children:(B,ve)=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(M.Z,{config:B}),De!==Q.y.Off&&(0,v.jsx)(W.K,{config:B,eventBus:$,frame:ve}),n.tooltip.mode!==s.$N.None&&(0,v.jsx)(O.xl,{config:B,hoverMode:n.tooltip.mode===s.$N.Single?O.b3.xOne:O.b3.xAll,queryZoom:c,clientZoom:!0,syncMode:De,syncScope:y,getDataLinks:(oe,ue)=>ve.fields[oe].getLinks?.({valueRowIndex:ue})??[],render:(oe,ue,be,Qe=!1,$e,Ie,qe,_e)=>{if(We&&Ie!=null){je(Ie),$e();return}const et=()=>{let ze=oe.posToVal(oe.cursor.left,"x");je({from:ze,to:ze}),$e()};return(0,v.jsx)(w.k,{series:ve,dataIdxs:ue,seriesIdx:be,mode:qe?s.$N.Multi:n.tooltip.mode,sortOrder:n.tooltip.sort,hideZeros:n.tooltip.hideZeros,isPinned:Qe,annotate:We?et:void 0,maxHeight:n.tooltip.maxHeight,replaceVariables:N,dataLinks:_e,canExecuteActions:we,compareDiffMs:Ze})},maxWidth:n.tooltip.maxWidth}),!Ye&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(V.W,{annotations:e.annotations??[],config:B,timeZone:o,newRange:Je,setNewRange:je}),(0,v.jsx)(d.U,{config:B,onChangeTimeRange:c}),e.annotations&&(0,v.jsx)(a.z,{visibleSeries:(0,a.e)(B,ge),config:B,exemplars:e.annotations,timeZone:o,maxHeight:n.tooltip.maxHeight,maxWidth:n.tooltip.maxWidth}),(D&&m||te)&&(0,v.jsx)(b.p,{config:B,fieldConfig:P,onThresholdsChange:D?m:void 0})]})]})})};var A=t(22803),j=t(62717),G=t(63142),H=t(59310),Z=t(76319);const re=({value:e,onChange:i})=>{const o=(0,G.of)(_);(!e||e.length<1)&&(e=[""]);const u=()=>{i([...e,j.g$.default])},h=P=>{const c=e.slice();c.splice(P,1),i(c)},n=(P,c)=>{const N=e.slice();N[P]=c??j.g$.default,N.length===0||N.length===1&&N[0]===""?i(void 0):i(N)};return(0,v.jsx)("ul",{className:o.list,children:e.map((P,c)=>(0,v.jsxs)("li",{className:o.listItem,children:[(0,v.jsx)(H.U,{onChange:N=>n(c,N),includeInternal:!0,value:P??j.g$.default}),c===e.length-1?(0,v.jsx)(Z.K,{name:"plus",onClick:u,tooltip:(0,T.t)("timeseries.timezones-editor.tooltip-add-timezone","Add timezone")}):(0,v.jsx)(Z.K,{name:"times",onClick:()=>h(c),tooltip:(0,T.t)("timeseries.timezones-editor.tooltip-remove-timezone","Remove timezone")})]},`${c}.${P}`))})},_=e=>({list:(0,A.css)({listStyle:"none",display:"flex",flexDirection:"column",gap:e.spacing(.5)}),listItem:(0,A.css)({display:"flex",gap:e.spacing(1)})});var k=t(12241),L=t(2543),ee=t(57866),Oe=t(83340),Se=t(28105),xe=t(46644),Ee=t(33553),Le=t(75421),Ne=t(49e3),Te=t(11534),fe=t(1682),Me=t(8095);let pe=null;const me=(e,i,o,u)=>{if(i==="graph"&&o.angular){const{fieldConfig:h,options:n,annotations:P}=ye({...o.angular,fieldConfig:u,panel:e});return P?.length>0&&Ve(P),e.fieldConfig=h,e.alert=o.angular.alert,n}return He(e),{}};function ye(e){let i=[];const o=e.fieldConfig?.overrides??[],u=e.yaxes??[];let h=Be(u[0]);e.fieldConfig?.defaults&&(h={...e.fieldConfig?.defaults,...h});const n={fill:e.dashes?"dash":"solid",dash:[e.dashLength??10,e.spaceLength??10]};if(e.aliasColors)for(const y of Object.keys(e.aliasColors)){const f=e.aliasColors[y];f&&o.push({matcher:{id:ee.Ct.byName,options:y},properties:[{id:Oe.uo.Color,value:{mode:r.Y.Fixed,fixedColor:f}}]})}let P=!1;if(e.seriesOverrides?.length)for(const y of e.seriesOverrides){if(!y.alias)continue;const m={matcher:{id:/^([/~@;%#'])(.*?)\1([gimsuy]*)$/.test(y.alias)?ee.Ct.byRegexp:ee.Ct.byName,options:y.alias},properties:[]};let D;for(const te of Object.keys(y)){const p=y[te];switch(te){case"alias":case"$$hashKey":break;case"yaxis":if(p===2){const $=Be(u[1]);Ge(h,$,m.properties)}break;case"fill":m.properties.push({id:"custom.fillOpacity",value:p*10});break;case"fillBelowTo":P=!0,m.properties.push({id:"custom.fillBelowTo",value:p});break;case"fillGradient":p&&(m.properties.push({id:"custom.fillGradient",value:"opacity"}),m.properties.push({id:"custom.fillOpacity",value:p*10}));break;case"points":m.properties.push({id:"custom.showPoints",value:p?s.yL.Always:s.yL.Never});break;case"bars":p?(m.properties.push({id:"custom.drawStyle",value:s.GR.Bars}),m.properties.push({id:"custom.fillOpacity",value:100})):m.properties.push({id:"custom.drawStyle",value:s.GR.Line});break;case"lines":p?m.properties.push({id:"custom.drawStyle",value:"line"}):m.properties.push({id:"custom.lineWidth",value:0});break;case"linewidth":m.properties.push({id:"custom.lineWidth",value:p});break;case"pointradius":m.properties.push({id:"custom.pointSize",value:2+p*2});break;case"dashLength":case"spaceLength":case"dashes":switch(D||(D={fill:n.fill,dash:[...n.dash]}),te){case"dashLength":D.dash[0]=p;break;case"spaceLength":D.dash[1]=p;break;case"dashes":D.fill=p?"dash":"solid";break}break;case"stack":m.properties.push({id:"custom.stacking",value:Ue(p)});break;case"color":m.properties.push({id:"color",value:{fixedColor:p,mode:r.Y.Fixed}});break;case"transform":m.properties.push({id:"custom.transform",value:p==="negative-Y"?s.NU.NegativeY:s.NU.Constant});break;default:console.log("Ignore override migration:",y.alias,te,p)}}D&&m.properties.push({id:"custom.lineStyle",value:D}),m.properties.length&&o.push(m)}const c=h.custom??{};c.drawStyle=e.bars?s.GR.Bars:e.lines?s.GR.Line:s.GR.Points,e.points?(c.showPoints=s.yL.Always,(0,L.isNumber)(e.pointradius)&&(c.pointSize=2+e.pointradius*2)):c.drawStyle!==s.GR.Points&&(c.showPoints=s.yL.Never),c.lineWidth=e.linewidth,n.fill!=="solid"&&(c.lineStyle=n),P?c.fillOpacity=35:(0,L.isNumber)(e.fill)&&(c.fillOpacity=e.fill*10),(0,L.isNumber)(e.fillGradient)&&e.fillGradient>0&&(c.gradientMode=s.on.Opacity,c.fillOpacity=e.fillGradient*10),c.spanNulls=e.nullPointMode===Se.UW.Ignore,e.steppedLine&&(c.lineInterpolation=s.dx.StepAfter),c.drawStyle===s.GR.Bars&&(c.fillOpacity=100),e.stack&&(c.stacking={mode:e.percentage?s.gs.Percent:s.gs.Normal,group:k.S.stacking.group},e.percentage&&e.yaxis&&(delete h.min,delete h.max,h.decimals===0&&delete h.decimals)),h.custom=(0,L.omitBy)(c,L.isNil),h.nullValueMode=e.nullPointMode;const N={legend:{displayMode:s.lm.List,showLegend:!0,placement:"bottom",calcs:[]},tooltip:{mode:s.$N.Single,sort:s.xB.None}},X=e.legend;if(X){if(X.show?N.legend.displayMode=X.alignAsTable?s.lm.Table:s.lm.List:N.legend.showLegend=!1,X.rightSide&&(N.legend.placement="right"),e.legend.values){const y=(0,L.pickBy)(e.legend);N.legend.calcs=ke(y)}e.legend.sideWidth&&(N.legend.width=e.legend.sideWidth),X.hideZero&&o.push(Fe(xe.gy.allIsZero)),X.hideEmpty&&o.push(Fe(xe.gy.allIsNull))}e.timeRegions?.length&&e.timeRegions.map((f,m)=>({name:`T${m}`,color:f.colorMode!=="custom"?f.colorMode:f.fillColor,line:f.line,fill:f.fill,fromDayOfWeek:f.fromDayOfWeek,toDayOfWeek:f.toDayOfWeek,from:f.from,to:f.to})).forEach((f,m)=>{const D={datasource:{type:"datasource",uid:"grafana"},enable:!0,hide:!0,filter:{exclude:!1,ids:[e.panel.id]},iconColor:f.fillColor??f.color,name:`Time region for panel ${e.panel.title}${m>0?` ${m}`:""}`,target:{queryType:Me.nj.TimeRegions,refId:"Anno",timeRegion:{fromDayOfWeek:f.fromDayOfWeek,toDayOfWeek:f.toDayOfWeek,from:f.from,to:f.to,timezone:"utc"}}};f.fill?i.push(D):f.line&&(D.iconColor=f.lineColor??"white",i.push(D))});const de=e.tooltip;if(de&&(de.shared!==void 0&&(N.tooltip.mode=de.shared?s.$N.Multi:s.$N.Single),de.sort!==void 0&&de.shared))switch(de.sort){case 1:N.tooltip.sort=s.xB.Ascending;break;case 2:N.tooltip.sort=s.xB.Descending;break;default:N.tooltip.sort=s.xB.None}if(e.thresholds&&e.thresholds.length>0){let y=[],f=!1,m=!1;const D=e.thresholds.sort((p,$)=>p.value>$.value?1:-1);for(let p=0;p<D.length;p++){const $=D[p],se=D.length>p+1?D[p+1]:null;$.fill&&(f=!0),$.line&&(m=!0),$.op==="gt"&&y.push({value:$.value,color:Ce($)}),$.op==="lt"&&(y.length===0&&y.push({value:-1/0,color:Ce($)}),se&&se.op==="gt"&&se.value>$.value?y.push({value:$.value,color:"transparent"}):se&&se.op==="lt"?y.push({value:$.value,color:Ce(se)}):y.push({value:$.value,color:"transparent"}))}y.length>0&&y[0].value!==-1/0&&y.unshift({color:"transparent",value:-1/0});let te=f?s.Ly.Area:s.Ly.Line;m&&f&&(te=s.Ly.LineAndArea),h.custom.thresholdsStyle={mode:te},h.thresholds={mode:Ee.O.Absolute,steps:y}}return e.xaxis&&e.xaxis.show===!1&&e.xaxis.mode==="time"&&o.push({matcher:{id:ee.Ct.byType,options:ae.PU.time},properties:[{id:"custom.axisPlacement",value:s.vM.Hidden}]}),{fieldConfig:{defaults:(0,L.omitBy)(h,L.isNil),overrides:o},options:N,annotations:i}}function Ce(e){return e.colorMode==="critical"?"red":e.colorMode==="warning"?"orange":e.colorMode==="custom"?e.fillColor||e.lineColor:"red"}function Be(e){if(!e)return{};const i={axisPlacement:e.show?s.vM.Auto:s.vM.Hidden};if(e.label&&(i.axisLabel=e.label),e.logBase){const o=e.logBase;(o===2||o===10)&&(i.scaleDistribution={type:s.L4.Log,log:o})}return(0,L.omitBy)({unit:e.format,decimals:Re(e.decimals),min:Re(e.min),max:Re(e.max),custom:i},L.isNil)}function Ge(e,i,o){for(const[n,P]of Object.entries(i))n!=="custom"&&P!==e[n]&&o.push({id:n,value:P});o.push({id:"custom.axisPlacement",value:s.vM.Right});const u=e.custom??{},h=i.custom??{};for(const[n,P]of Object.entries(h))P!==u[n]&&o.push({id:`custom.${n}`,value:P})}function Re(e){if((0,L.isNumber)(e))return e;if((0,L.isString)(e)){const i=Number(e);if(!isNaN(i))return i}}function ke(e){const i=[];for(const o in e){const u=xe.AS.getIfExists(o);u&&i.push(u.id)}return i}function He(e){e.fieldConfig?.defaults?.custom?.hideFrom?.graph!==void 0&&(e.fieldConfig.defaults.custom.hideFrom.viz=e.fieldConfig.defaults.custom.hideFrom.graph,delete e.fieldConfig.defaults.custom.hideFrom.graph),e.fieldConfig?.overrides&&(e.fieldConfig.overrides=e.fieldConfig.overrides.map(i=>(i.properties=i.properties.map(o=>(o.id==="custom.hideFrom"&&o.value.graph&&(o.value.viz=o.value.graph,delete o.value.graph),o)),i)))}function Fe(e){return{matcher:{id:ee.Ct.byValue,options:{reducer:e,op:s.zT.GTE,value:0}},properties:[{id:"custom.hideFrom",value:{tooltip:!0,viz:!1,legend:!0}}]}}function Ue(e){const i=k.S.stacking?.group;return{mode:e?s.gs.Normal:s.gs.None,group:(0,L.isString)(e)?e:i}}function Ve(e){const i=window.__grafanaSceneContext;if(i instanceof Te.H$){const u=fe.b4.getDataLayers(i),h=[...u.state.annotationLayers];for(let n of e){const P=new Ne.g({key:`annotations-${n.name}`,query:n,name:n.name,isEnabled:n.enable,isHidden:n.hide});h.push(P)}u.setState({annotationLayers:h});return}const o=(0,S.UA)().getCurrent();o&&(o.annotations.list=[...o.annotations.list,...e],pe==null&&(pe=setTimeout(()=>{pe=null,(0,Le.jG)().refreshTimeModel()})))}const Ke=new g.m(z).setPanelChangeHandler(me).useFieldConfig((0,k.V)(k.S)).setPanelOptions(e=>{le.D(e,!1,!0,le.U),ce.H(e),ne.$.featureToggles.timeComparison&&F.H(e),e.addCustomEditor({id:"timezone",name:(0,T.t)("timeseries.name-time-zone","Time zone"),path:"timezone",category:[(0,T.t)("timeseries.category-axis","Axis")],editor:re,defaultValue:void 0})}).setSuggestionsSupplier(new x).setDataSupport({annotations:!0,alertStates:!0})},66881:(Pe,ie,t)=>{t.d(ie,{p:()=>he});var g=t(74848),T=t(96540),ne=t(95004),le=t(55386),ce=t(70332),F=t(22803),v=t(2543),I=t(55794),ae=t.n(I),K=t(63142);const J=({step:M,y:W,dragBounds:O,mapPositionToValue:R,formatValue:U,onChange:w})=>{const V=(0,K.$j)();let a=W,d="none";W<(O.top??0)&&(d="top"),W>(O.bottom??0)+22&&(d="bottom"),d==="bottom"&&(a=O.bottom??W),d==="top"&&(a=O.top??W);const b=typeof w!="function",r=(0,K.of)(Q,M,d,b),[C,S]=(0,T.useState)(M.value),l=(0,T.useMemo)(()=>V.colors.getContrastText(V.visualization.getColorByName(M.color)),[M.color,V]);return(0,g.jsx)(ae(),{axis:"y",grid:[1,1],disabled:b,onStop:b?v.noop:(x,E)=>(w(R(E.lastY)),!1),onDrag:(x,E)=>S(R(E.lastY)),position:{x:0,y:a},bounds:O,children:(0,g.jsx)("div",{className:r.handle,style:{color:l},children:(0,g.jsx)("span",{className:r.handleText,children:U(C)})})})};J.displayName="ThresholdDragHandle";const Q=(M,W,O,R)=>{const U=M.visualization.getColorByName(W.color),w=q(O),V=O!=="none";return{handle:(0,F.css)({display:"flex",alignItems:"center",position:"absolute",left:0,width:"calc(100% - 9px)",height:"18px",marginTop:"-9px",borderColor:U,cursor:R?"initial":"grab",borderTopRightRadius:M.shape.radius.default,borderBottomRightRadius:M.shape.radius.default,background:U,fontSize:M.typography.bodySmall.fontSize,"&:before":w},V&&{marginTop:0,borderRadius:M.shape.radius.default}),handleText:(0,F.css)({textAlign:"center",width:"100%",display:"block",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"})}};function q(M){const W=M==="none",O=R=>({content:"''",position:"absolute",bottom:0,top:0,width:0,height:0,left:0,borderRightStyle:"solid",borderRightWidth:`${R}px`,borderRightColor:"inherit",borderTop:`${R}px solid transparent`,borderBottom:`${R}px solid transparent`});return W?(0,F.css)({...O(9),left:"-9px"}):M==="top"?(0,F.css)({...O(5),left:"calc(50% - 2.5px)",top:"-7px",transform:"rotate(90deg)"}):M==="bottom"?(0,F.css)({...O(5),left:"calc(50% - 2.5px)",top:"calc(100% - 2.5px)",transform:"rotate(-90deg)"}):""}const s=60,he=({config:M,fieldConfig:W,onThresholdsChange:O})=>{const R=(0,T.useRef)(),[U,w]=(0,T.useState)(0);(0,T.useLayoutEffect)(()=>{M.setPadding([0,s,0,0]),M.addHook("init",a=>{R.current=a}),M.addHook("draw",()=>{w(a=>a+1)})},[M]);const V=(0,T.useMemo)(()=>{const a=R.current;if(!a)return null;const d=W.defaults.thresholds;if(!d)return null;const b=(0,ce.M)(W.defaults,ne.PU.number),r=W.defaults.decimals,C=[];for(let S=0;S<d.steps.length;S++){const l=d.steps[S],x=a.valToPos(l.value,b);if(Number.isNaN(x)||!Number.isFinite(x))continue;const E=a.bbox.height/window.devicePixelRatio,z=typeof O=="function"?j=>{const G=[...d.steps.slice(0,S),...d.steps.slice(S+1),{...d.steps[S],value:j}].sort((H,Z)=>H.value-Z.value);O({...d,steps:G})}:void 0,A=(0,g.jsx)(J,{step:l,y:x,dragBounds:{top:0,bottom:E},mapPositionToValue:j=>a.posToVal(j,b),formatValue:j=>(0,le.j_)(b)(j,r).text,onChange:z},`${l.value}-${S}`);C.push(A)}return C},[U,W,O]);return R.current?(0,g.jsx)("div",{style:{position:"absolute",overflow:"visible",left:`${(R.current.bbox.left+R.current.bbox.width)/window.devicePixelRatio}px`,top:`${R.current.bbox.top/window.devicePixelRatio}px`,width:`${s}px`,height:`${R.current.bbox.height/window.devicePixelRatio}px`},children:V}):null};he.displayName="ThresholdControlsPlugin"},73125:(Pe,ie,t)=>{t.d(ie,{A:()=>v});var g=t(74848),T=t(92745),ne=t(47466),le=t(39064),ce=t(41530),F=t(61048);const v=({items:I,links:ae,isPinned:K,maxHeight:J})=>{const Q=I.find(q=>q.label==="Time");return(0,g.jsxs)(F.i,{children:[(0,g.jsx)(ce.A,{item:{label:(0,T.t)("exemplar-tooltip-header","Exemplar"),value:Q?.value??""},isPinned:K}),(0,g.jsx)(ne.o,{items:I.filter(q=>q!==Q),isPinned:K,maxHeight:J,scrollable:J!=null}),(0,g.jsx)(le.S,{dataLinks:ae??[]})]})}}}]);

//# sourceMappingURL=timeseriesPanel.00784cbccf8df2072c48.js.map