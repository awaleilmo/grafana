"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6436],{75044:(se,B,l)=>{l.d(B,{A:()=>s});function s(T){T.getRowProps.push(I=>[I,w()]),T.getHeaderGroupProps.push(I=>[I,w()]),T.getFooterGroupProps.push(I=>[I,w()]),T.getHeaderProps.push((I,{column:M})=>[I,c(M)]),T.getCellProps.push((I,{cell:M})=>[I,c(M.column)]),T.getFooterProps.push((I,{column:M})=>[I,c(M)])}s.pluginName="useCustomFlexLayout";function c(T){return{style:{flex:T.totalWidth===0?"0 0 auto":`${T.totalWidth} 0 0`}}}function w(){return{style:{display:"flex",flex:"1 0 auto"}}}},86436:(se,B,l)=>{l.d(B,{P:()=>q});var s=l(74848),c=l(22803),w=l(96540),T=l(32885),I=l(91793),M=l(10022),N=l(92745),te=l(739),G=l(63142),le=l(59692),ae=l(28533),ne=l(75044),oe=l(5478),re=l(60365),E=l(70255),ie=l(95004),ce=l(11576),de=l(16515),ue=l(55386),K=l(43173),me=l(78282),V=l(32635),Y=l(30703),he=l(66404),fe=l(45967),Q=l(37658),xe=l(45229),X=l(12810),ve=l(13660),ge=l(87745),pe=l(93854),ye=l(52792),Ce=l(22787),je=l(13941),Z=l(50992),we=l(13326);const U=[{label:"Score",value:"score"},{label:"Fields",value:"fields"},{label:"Allowed actions",value:"allowed_actions"}];function Se({name:e,explain:t,frame:d,row:r}){const[i,n]=(0,w.useState)(!0),[h,p]=(0,w.useState)("score"),v=(0,s.jsx)(ye.J,{title:e,icon:"info",tabs:U,activeTab:h,onChangeTab:o=>{p(o.value)}});return(0,s.jsx)(Ce.a,{title:v,isOpen:i,onDismiss:()=>n(!1),closeOnBackdropClick:!0,closeOnEscape:!0,children:(0,s.jsxs)(je.J,{children:[h===U[0].value&&(0,s.jsx)(Z.B,{width:"100%",height:"70vh",language:"json",showLineNumbers:!1,showMiniMap:!0,value:JSON.stringify(t,null,2),readOnly:!1}),h===U[1].value&&(0,s.jsx)("div",{children:(0,s.jsx)(we.e,{data:d,rowIndex:r})}),h===U[2].value&&(0,s.jsx)(Z.B,{width:"100%",height:"70vh",language:"json",showLineNumbers:!1,showMiniMap:!1,value:(()=>{const o=d.fields.find(j=>j.name==="allowed_actions")?.values?.[r],a=d.fields.find(j=>j.name==="ds_uid")?.values?.[r];return JSON.stringify({dsUids:a??[],allowedActions:o??[]},null,2)})(),readOnly:!1})]})})}const Pe=175,De=200,Ie=200,Ne=(e,t,d,r,i,n,h,p,v)=>{const o=[],a=e.view.fields,j=a.uid,S=a.kind;let y=0;const P=a[e.view.dataFrame.meta?.custom?.sortBy];P&&(y=175,P.type===ie.PU.time&&(y+=25),t-=y),a.explain&&a.score&&(t-=100);let f=50;d&&r&&(f=0,o.push({id:"column-checkbox",width:f,Header:()=>{const{view:u}=e,g=d("*","*"),m=u.every(D=>d(D.kind,D.uid));return(0,s.jsx)(V.S,{indeterminate:!m&&g,checked:m,disabled:!e,onChange:D=>{if(g)i();else for(let x=0;x<u.length;x++){const C=u.get(x);r(C.kind,C.uid)}}})},Cell:u=>{const g=j.values[u.row.index],m=S?S.values[u.row.index]:"dashboard",D=d(m,g),x=g!=null,{key:C,...F}=u.cellProps;return(0,s.jsx)("div",{...F,className:n.cell,children:(0,s.jsx)(V.S,{disabled:!x,value:D&&x,onChange:_=>{r(m,g)}})},C)},field:j}),t-=f),f=Math.max(t*.2,300),o.push({Cell:u=>{let g=(0,c.cx)(n.nameCellStyle),m=a.name.values[u.row.index];const D=a.isDeleted?.values[u.row.index];m?.length||(m=u.row.index>=e.view.dataFrame.length?"Loading...":"Missing title",g+=" "+n.missingTitleText);const{key:x,...C}=u.cellProps;return(0,s.jsx)("div",{className:n.cell,...C,children:e.isItemLoaded(u.row.index)?D?(0,s.jsx)("span",{className:g,children:m}):(0,s.jsx)("a",{href:u.userProps.href,onClick:u.userProps.onClick,className:g,title:m,children:m}):(0,s.jsx)(E.A,{width:200})},x)},id:"column-name",field:a.name,Header:()=>(0,s.jsx)("div",{children:(0,N.t)("search.results-table.name-header","Name")}),width:f}),t-=f,e.view.fields.permanentlyDeleteDate&&W(e.view.fields.permanentlyDeleteDate)&&a.permanentlyDeleteDate?(f=De,o.push(He(e,a.permanentlyDeleteDate,f,n)),t-=f):(f=Pe,o.push(Le(e,a.kind,a.panel_type,f,n)),t-=f),a.ds_uid&&p&&(f=Math.min(t/2.5,Ie),o.push(Te(a.ds_uid,f,n.typeIcon,n.datasourceItem,n.invalidDatasourceItem,p)),t-=f);const A=!v||W(e.view.fields.tags),O=e.view.dataFrame.meta?.custom;if(O?.locationInfo&&t>0&&(f=A?Math.max(t/1.75,300):t,t-=f,o.push({Cell:u=>{const g=(a.location?.values[u.row.index]??"").split("/"),{key:m,...D}=u.cellProps;return(0,s.jsx)("div",{...D,className:n.cell,children:e.isItemLoaded(u.row.index)?(0,s.jsx)("div",{className:n.locationContainer,children:g.map(x=>{let C=O.locationInfo[x];if(!C&&x==="general"&&(C={kind:"folder",url:"/dashboards",name:"Dashboards"}),C){const F=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y.I,{name:(0,pe.TM)(C.kind)}),(0,s.jsx)(he.E,{variant:"body",truncate:!0,children:C.name})]});return C.url?(0,s.jsx)("a",{href:C.url,className:n.locationItem,children:F},x):(0,s.jsx)("div",{className:n.locationItem,children:F},x)}return(0,s.jsx)("span",{children:x},x)})}):(0,s.jsx)(E.A,{width:150})},m)},id:"column-location",field:a.location??a.url,Header:(0,N.t)("search.results-table.location-header","Location"),width:f})),t>0&&A&&o.push(be(e,a.tags,t,n,h)),P&&y){const u=P.display??(0,ce.J)({field:P,theme:K.$.theme2});o.push({Header:(0,de.Ct)(P),Cell:g=>{const{key:m,...D}=g.cellProps;return(0,s.jsx)("div",{...D,className:n.cell,children:Re({sortField:P,getDisplay:u,index:g.row.index,kind:a.kind})},m)},id:"column-sort-field",field:P,width:y})}if(a.explain&&a.score){const u=a.score.values,g=m=>{xe.A.publish(new ge.S8({component:Se,props:{name:a.name.values[m],explain:a.explain.values[m],frame:e.view.dataFrame,row:m}}))};o.push({Header:()=>(0,s.jsx)("div",{className:n.sortedHeader,children:(0,s.jsx)(N.x6,{i18nKey:"search.generate-columns.score",children:"Score"})}),Cell:m=>{const{key:D,...x}=m.cellProps;return(0,s.jsx)("div",{...x,className:(0,c.cx)(n.cell,n.explainItem),onClick:()=>g(m.row.index),children:u[m.row.index]},D)},id:"column-score-field",field:a.score,width:100})}return o};function W(e){for(let t=0;t<e.values.length;t++)if(e.values[t]!=null)return!0;return!1}function Te(e,t,d,r,i,n){const h=(0,me.l)();return{id:"column-datasource",field:e,Header:(0,N.t)("search.results-table.datasource-header","Data source"),Cell:p=>{const v=e.values[p.row.index];if(!v?.length)return null;const{key:o,...a}=p.cellProps;return(0,s.jsx)("div",{...a,className:(0,c.cx)(r),children:v.map((j,S)=>{const y=h.getInstanceSettings(j),P=y?.meta?.info?.logos?.small;return P?(0,s.jsxs)("span",{onClick:f=>{f.stopPropagation(),f.preventDefault(),n(y.uid)},children:[(0,s.jsx)("img",{src:P,alt:"",width:14,height:14,title:y.type,className:d}),y.name]},S):(0,s.jsx)("span",{className:i,children:j},S)})},o)},width:t}}function He(e,t,d,r){return{id:"column-delete-age",field:t,width:d,Header:(0,N.t)("search.results-table.deleted-remaining-header","Time remaining"),Cell:i=>{const n=i.row.index,h=t.values[n],{key:p,...v}=i.cellProps;if(!h||!e.isItemLoaded(i.row.index))return(0,s.jsx)("div",{...v,className:(0,c.cx)(r.cell,r.typeCell),children:(0,s.jsx)(E.A,{width:100})},p);const o=Me(new Date,h),j=!Object.values(o).some(S=>S>0)?(0,N.t)("search.results-table.deleted-less-than-1-min","< 1 min"):(0,X.a)(o,{style:"long"});return(0,s.jsx)("div",{...v,className:(0,c.cx)(r.cell,r.typeCell),children:(0,s.jsx)(fe.m,{content:(0,X.Y)(h,{dateStyle:"medium",timeStyle:"short"}),children:(0,s.jsx)("span",{children:j})})},p)}}}function Le(e,t,d,r,i){return{id:"column-type",field:t??d,Header:(0,N.t)("search.results-table.type-header","Type"),Cell:n=>{const h=n.row.index,p=t?.values[h]??"dashboard";let v="apps",o="Dashboard";if(p)switch(o=p,o){case"dashboard":o=(0,N.t)("search.results-table.type-dashboard","Dashboard");break;case"folder":v="folder",o=(0,N.t)("search.results-table.type-folder","Folder");break;case"panel":v=`${ve.Ip.panel}`;const S=d.values[h];if(S){o=S;const y=K.$.panels[o];if(y?.name)o=y.name;else switch(S){case"row":o="Row",v="bars";break;case"singlestat":o="Singlestat";break;default:v="question-circle"}}break}const{key:a,...j}=n.cellProps;return(0,s.jsx)("div",{...j,className:(0,c.cx)(i.cell,i.typeCell),children:e.isItemLoaded(n.row.index)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y.I,{name:v,size:"sm",title:o,className:i.typeIcon}),o]}):(0,s.jsx)(E.A,{width:100})},a)},width:r}}function be(e,t,d,r,i){return{Cell:n=>{const h=t.values[n.row.index],{key:p,...v}=n.cellProps;return(0,s.jsx)("div",{...v,className:r.cell,children:e.isItemLoaded(n.row.index)?(0,s.jsx)(s.Fragment,{children:h?(0,s.jsx)(Q.L,{className:r.tagList,tags:h,onClick:i}):null}):(0,s.jsx)(Q.L.Skeleton,{})},p)},id:"column-tags",field:t,Header:(0,N.t)("search.results-table.tags-header","Tags"),width:d}}function Re({kind:e,sortField:t,index:d,getDisplay:r}){const i=t.values[d];return["folder","panel"].includes(e.values[d])&&i===0?"-":(0,ue.cN)(r(i))}function Me(e,t){let{years:d=0,months:r=0,days:i=0,hours:n=0,minutes:h=0}=(0,re.F)({start:e,end:t});return d>0?{years:d}:r>0?{months:r}:i>0?{days:i}:n>0?{hours:n}:{minutes:h}}const J=36,q=w.memo(({response:e,width:t,height:d,selection:r,selectionToggle:i,clearSelection:n,onTagSelected:h,onDatasourceChange:p,onClickItem:v,keyboardEvents:o})=>{const a=(0,G.of)(Fe),j=(0,G.of)(ke),S=(0,le.k)((0,G.$j)(),te.qM.Sm),y=(0,w.useRef)(null),[P,f]=(0,w.useState)(null),z=(0,oe.n)(o,0,e),A=(0,w.useMemo)(()=>e?.view?.dataFrame.fields.length?Array(e.totalRows).fill(0):[],[e]);(0,w.useEffect)(()=>{y.current&&y.current.resetloadMoreItemsCache(),P&&P.scrollTo(0)},[A,P]);const O=(0,w.useMemo)(()=>Ne(e,t,r,i,n,j,h,p,e.view?.length>=e.totalRows),[e,t,j,r,i,n,h,p]),u=(0,w.useMemo)(()=>({columns:O,data:A}),[O,A]),{getTableProps:g,getTableBodyProps:m,headerGroups:D,rows:x,prepareRow:C}=(0,T.useTable)(u,ne.A),F=(0,w.useCallback)(async(H,k)=>{await e.loadMoreItems(H,k);const L=r?.("*","*");if(!(!i||!r||!L))for(let R=H;R<e.view.length;R++){const b=e.view.get(R);r(b.kind,b.uid)||i(b.kind,b.uid)}},[e,r,i]),_=(0,w.useCallback)(({index:H,style:k})=>{const L=x[H];C(L);const R=e.view.fields.url?.values[H];let b=a.rowContainer;H===z.y&&(b+=" "+a.selectedRow);const{key:$,...Ae}=L.getRowProps({style:k});return(0,s.jsx)("div",{...Ae,className:b,children:L.cells.map((Oe,ee)=>(0,s.jsx)(ae.n,{tableStyles:S,cell:Oe,columnIndex:ee,columnCount:L.cells.length,userProps:{href:R,onClick:v},frame:e.view.dataFrame},ee))},$)},[x,C,e.view.fields.url?.values,z,a,S,v,e.view.dataFrame]);return x.length?(0,s.jsxs)("div",{...g(),"aria-label":(0,N.t)("search.search-results-table.aria-label-search-results-table","Search results table"),role:"table",children:[D.map(H=>{const{key:k,...L}=H.getHeaderGroupProps({style:{width:t}});return(0,s.jsx)("div",{...L,className:a.headerRow,children:H.headers.map(R=>{const{key:b,...$}=R.getHeaderProps();return(0,s.jsx)("div",{...$,role:"columnheader",className:a.headerCell,children:R.render("Header")},b)})},k)}),(0,s.jsx)("div",{...m(),children:(0,s.jsx)(M.A,{ref:y,isItemLoaded:e.isItemLoaded,itemCount:x.length,loadMoreItems:F,children:({onItemsRendered:H,ref:k})=>(0,s.jsx)(I.Y1,{ref:L=>{k(L),f(L)},onItemsRendered:H,height:d-J,itemCount:x.length,itemSize:S.rowHeight,width:t,style:{overflow:"hidden auto"},children:_})})})]}):(0,s.jsx)("div",{className:a.noData,children:(0,s.jsx)(N.x6,{i18nKey:"search.search-results-table.no-data",children:"No values"})})});q.displayName="SearchResultsTable";const Fe=e=>{const t=e.colors.action.hover;return{noData:(0,c.css)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"}),headerCell:(0,c.css)({alignItems:"center",display:"flex",overflo:"hidden",padding:e.spacing(1)}),headerRow:(0,c.css)({backgroundColor:e.colors.background.secondary,display:"flex",gap:e.spacing(1),height:`${J}px`}),selectedRow:(0,c.css)({backgroundColor:t,boxShadow:`inset 3px 0px ${e.colors.primary.border}`}),rowContainer:(0,c.css)({display:"flex",gap:e.spacing(1),height:`${J}px`,label:"row","&:hover":{backgroundColor:t},"&:not(:hover) div[role='cell']":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})}},ke=e=>({cell:(0,c.css)({padding:e.spacing(1),overflow:"hidden",display:"flex",alignItems:"center"}),nameCellStyle:(0,c.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),typeCell:(0,c.css)({gap:e.spacing(.5)}),typeIcon:(0,c.css)({fill:e.colors.text.secondary}),datasourceItem:(0,c.css)({span:{"&:hover":{color:e.colors.text.link}}}),missingTitleText:(0,c.css)({color:e.colors.text.disabled,fontStyle:"italic"}),invalidDatasourceItem:(0,c.css)({color:e.colors.error.main,textDecoration:"line-through"}),locationContainer:(0,c.css)({display:"flex",flexWrap:"nowrap",gap:e.spacing(1),overflow:"hidden"}),locationItem:(0,c.css)({alignItems:"center",color:e.colors.text.secondary,display:"flex",flexWrap:"nowrap",gap:"4px",overflow:"hidden"}),explainItem:(0,c.css)({cursor:"pointer"}),tagList:(0,c.css)({justifyContent:"flex-start",flexWrap:"nowrap"})})}}]);

//# sourceMappingURL=6436.2cba2dd66e0889ecb5f5.js.map