{"version":3,"file":"SoloPanelPage.b9bf96f95c17c7ae21c1.js","mappings":"yUAwBO,SAASA,EAAc,CAAE,YAAAC,CAAY,EAAU,CACpD,MAAMC,KAAe,MAAkC,EACjD,CAAE,UAAAC,EAAW,UAAAC,CAAU,EAAIF,EAAa,SAAS,EACjD,CAAE,IAAAG,EAAM,GAAI,KAAAC,EAAM,KAAAC,CAAK,KAAI,KAAU,EAO3C,SALA,aAAU,KACRL,EAAa,cAAc,CAAE,IAAAG,EAAK,KAAAC,EAAM,KAAAC,EAAM,MAAO,KAAgB,QAAS,CAAC,EACxE,IAAML,EAAa,WAAW,GACpC,CAACA,EAAcD,EAAaI,EAAKC,EAAMC,CAAI,CAAC,EAE1CN,EAAY,QAIbG,KAEA,OAAC,IAAG,CAAC,eAAgB,SAAU,WAAY,SAAU,QAAS,OAAQ,OAAQ,OAC5E,mBAAC,IAAK,CAAC,SAAS,QAAQ,SAAO,KAAE,kCAAmC,0BAA0B,EAC3F,SAAAA,EAAU,QACb,EACF,EAICD,KAKH,OAAC,KAAsB,CAAC,MAAOA,EAC7B,mBAACK,EAAA,CAAkB,UAAAL,EAAsB,QAASF,EAAY,QAAS,EACzE,KANO,OAAC,IAAU,EAAC,KAdZ,OAAC,IAAc,CAAC,OAAO,OAAQ,EAsB1C,CAEA,QAAeD,EAER,SAASQ,EAAkB,CAAE,UAAAL,EAAW,QAAAM,CAAQ,EAAmD,CACxG,KAAM,CAAE,SAAAC,EAAU,KAAAC,CAAK,EAAIR,EAAU,SAAS,EACxCS,EAAgBF,GAAU,SAAS,GAAG,cACtCG,KAAS,MAAWC,CAAS,EAC7BC,KAAmB,MAA0BN,CAAO,EAE1D,sBAAU,IAAM,CACd,MAAMO,EAAiBb,EAAU,SAAS,EACpCc,EAAoBL,GAAe,SAAS,EAElD,MAAO,IAAM,CACXI,EAAe,EACfC,IAAoB,CACtB,CACF,EAAG,CAACd,EAAWS,CAAa,CAAC,KAG3B,OAAC,OAAI,UAAWC,EAAO,UACrB,mBAAC,KAAwB,CAAC,MAAOE,EAAkB,UAAAZ,EAAsB,YAAa,GACpF,mBAACQ,EAAK,UAAL,CAAe,MAAOA,CAAA,CAAM,EAC/B,EACF,CAEJ,CAEA,MAAMG,EAAaI,IAA0B,CAC3C,aAAW,OAAI,CACb,SAAU,QACV,OAAQ,EACR,MAAO,EACP,OAAQ,EACR,KAAM,EACN,IAAK,EACL,MAAO,OACP,OAAQ,MACV,CAAC,CACH,E","sources":["webpack://grafana/./public/app/features/dashboard-scene/solo/SoloPanelPage.tsx"],"sourcesContent":["// Libraries\nimport { css } from '@emotion/css';\nimport { useEffect } from 'react';\nimport { useParams } from 'react-router-dom-v5-compat';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { UrlSyncContextProvider } from '@grafana/scenes';\nimport { Alert, Box, useStyles2 } from '@grafana/ui';\nimport PageLoader from 'app/core/components/PageLoader/PageLoader';\nimport { EntityNotFound } from 'app/core/components/PageNotFound/EntityNotFound';\nimport { GrafanaRouteComponentProps } from 'app/core/navigation/types';\nimport { DashboardPageRouteParams } from 'app/features/dashboard/containers/types';\nimport { DashboardRoutes } from 'app/types/dashboard';\n\nimport { getDashboardScenePageStateManager } from '../pages/DashboardScenePageStateManager';\nimport { DashboardScene } from '../scene/DashboardScene';\nimport { SoloPanelContextProvider, useDefineSoloPanelContext } from '../scene/SoloPanelContext';\n\nexport interface Props extends GrafanaRouteComponentProps<DashboardPageRouteParams, { panelId: string }> {}\n\n/**\n * Used for iframe embedding and image rendering of single panels\n */\nexport function SoloPanelPage({ queryParams }: Props) {\n  const stateManager = getDashboardScenePageStateManager();\n  const { dashboard, loadError } = stateManager.useState();\n  const { uid = '', type, slug } = useParams();\n\n  useEffect(() => {\n    stateManager.loadDashboard({ uid, type, slug, route: DashboardRoutes.Embedded });\n    return () => stateManager.clearState();\n  }, [stateManager, queryParams, uid, type, slug]);\n\n  if (!queryParams.panelId) {\n    return <EntityNotFound entity=\"Panel\" />;\n  }\n\n  if (loadError) {\n    return (\n      <Box justifyContent={'center'} alignItems={'center'} display={'flex'} height={'100%'}>\n        <Alert severity=\"error\" title={t('dashboard.errors.failed-to-load', 'Failed to load dashboard')}>\n          {loadError.message}\n        </Alert>\n      </Box>\n    );\n  }\n\n  if (!dashboard) {\n    return <PageLoader />;\n  }\n\n  return (\n    <UrlSyncContextProvider scene={dashboard}>\n      <SoloPanelRenderer dashboard={dashboard} panelId={queryParams.panelId} />\n    </UrlSyncContextProvider>\n  );\n}\n\nexport default SoloPanelPage;\n\nexport function SoloPanelRenderer({ dashboard, panelId }: { dashboard: DashboardScene; panelId: string }) {\n  const { controls, body } = dashboard.useState();\n  const refreshPicker = controls?.useState()?.refreshPicker;\n  const styles = useStyles2(getStyles);\n  const soloPanelContext = useDefineSoloPanelContext(panelId)!;\n\n  useEffect(() => {\n    const dashDeactivate = dashboard.activate();\n    const refreshDeactivate = refreshPicker?.activate();\n\n    return () => {\n      dashDeactivate();\n      refreshDeactivate?.();\n    };\n  }, [dashboard, refreshPicker]);\n\n  return (\n    <div className={styles.container}>\n      <SoloPanelContextProvider value={soloPanelContext} dashboard={dashboard} singleMatch={true}>\n        <body.Component model={body} />\n      </SoloPanelContextProvider>\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  container: css({\n    position: 'fixed',\n    bottom: 0,\n    right: 0,\n    margin: 0,\n    left: 0,\n    top: 0,\n    width: '100%',\n    height: '100%',\n  }),\n});\n"],"names":["SoloPanelPage","queryParams","stateManager","dashboard","loadError","uid","type","slug","SoloPanelRenderer","panelId","controls","body","refreshPicker","styles","getStyles","soloPanelContext","dashDeactivate","refreshDeactivate","theme"],"sourceRoot":""}