"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[265],{17411:(ye,Q,f)=>{f.d(Q,{A$:()=>S,WV:()=>s,cG:()=>o});const s=M=>M.delegatable!==void 0&&!M.delegatable,o=M=>{const K="fixed:";if(!M.displayName&&M.name.startsWith(K)){let t="";t=M.name.replace(K,"").replace(/[:\\.]/g," "),M.displayName=t}return M},S=M=>(M.group&&M.displayName&&(M.filteredDisplayName=M.group+":"+M.displayName),M)},34418:(ye,Q,f)=>{f.d(Q,{G3:()=>L,RL:()=>S,Xh:()=>M,eA:()=>K,xN:()=>t});var s=f(68143),o=f(17411);const S=async T=>{let O="/api/access-control/roles?delegatable=true";T&&(O+=`&targetOrgId=${T}`);const v=await(0,s.AI)().get(O);return!v||!v.length?[]:v.map(o.cG).map(o.A$)},M=async(T,O)=>{let v=`/api/access-control/users/${T}/roles?includeMapped=true`;O&&(v+=`&targetOrgId=${O}`);try{const N=await(0,s.AI)().get(v);return!N||!N.length?[]:N.map(o.cG).map(o.A$)}catch(N){return(0,s.NF)(N)&&(N.isHandled=!0),[]}},K=(T,O,v)=>{let N=`/api/access-control/users/${O}/roles`;v&&(N+=`?targetOrgId=${v}`);const q=T.filter(H=>!H.mapped).flatMap(H=>H.uid);return(0,s.AI)().put(N,{orgId:v,roleUids:q})},t=async(T,O)=>{let v=`/api/access-control/teams/${T}/roles`;O&&(v+=`?targetOrgId=${O}`);try{const N=await(0,s.AI)().get(v);return!N||!N.length?[]:N.map(o.cG).map(o.A$)}catch(N){return(0,s.NF)(N)&&(N.isHandled=!0),[]}},L=(T,O,v)=>{let N=`/api/access-control/teams/${O}/roles`;v&&(N+=`?targetOrgId=${v}`);const Z=T.flatMap(q=>q.uid);return(0,s.AI)().put(N,{orgId:v,roleUids:Z})}},59812:(ye,Q,f)=>{f.d(Q,{n:()=>es});var s=f(74848),o=f(96540),S=f(63142),M=f(8135),K=f(15245),t=f(22803),L=f(92745),T=f(68079),O=f(30703),v=f(45967),N=f(63527),Z=f(3343),q=f(35484),H=f(69665);const X=(0,o.forwardRef)(({children:e,iconName:n},p)=>{const c=(0,S.of)(ke);return(0,s.jsxs)("div",{className:c.container,ref:p,children:[n&&(0,s.jsx)(O.I,{name:n,size:"xs"}),e]})});X.displayName="ValueContainer";const ke=e=>{const{prefix:n}=(0,N.n)({theme:e}),{multiValueContainer:p}=(0,H.J)(e);return{container:(0,t.cx)(n,p,(0,t.css)({position:"relative",padding:e.spacing(.5,1,.5,1),svg:{marginRight:e.spacing(.5)}}))}},ve=360,_=300,Ge=320,V=360,Ee=320,je=360,we=V+je,De=e=>e.stopPropagation(),Ne=({appliedRoles:e,basicRole:n,disabled:p,isFocused:c,query:i,showBasicRole:h,width:I,isLoading:P,onOpen:j,onClose:R,onQueryChange:x,...$})=>{const m=(0,S.of)(Be,!1,!!c,!!p,!1,I),k=(0,o.useRef)(null);(0,o.useEffect)(()=>{c&&k.current?.focus()});const W=C=>{const G=C.target?.value;x(G)},a=h&&n!=="None";return c?(0,s.jsxs)("div",{className:m.wrapper,children:[a&&(0,s.jsx)(X,{children:n}),e.map(C=>(0,s.jsx)(X,{children:C.group+":"+(C.displayName||C.name)},C.uid)),!p&&(0,s.jsx)("input",{...$,className:m.input,ref:k,onMouseDown:De,onChange:W,"data-testid":"role-picker-input",placeholder:c?(0,L.t)("role-picker.input.placeholder-select-role","Select role"):void 0,value:i}),(0,s.jsx)("div",{className:m.suffix,children:(0,s.jsx)(O.I,{name:"angle-up",className:m.dropdownIndicator,onMouseDown:R})})]}):(0,s.jsxs)("div",{className:(0,t.cx)(m.wrapper,m.selectedRoles),onMouseDown:j,children:[a&&(0,s.jsx)(X,{children:n}),(0,s.jsx)(Le,{appliedRoles:e,numberOfRoles:e.length,showBuiltInRole:a}),P&&(0,s.jsx)("div",{className:m.spinner,children:(0,s.jsx)(T.y,{size:16,inline:!0})})]})};Ne.displayName="RolePickerInput";const Le=({showBuiltInRole:e,numberOfRoles:n,appliedRoles:p})=>{const c=(0,S.of)(i=>Te(i));return(0,s.jsx)(s.Fragment,{children:n?(0,s.jsx)(v.m,{content:(0,s.jsx)("div",{className:c.tooltip,children:p?.map(i=>(0,s.jsx)("p",{children:i.group+":"+(i.displayName||i.name)},i.uid))}),children:(0,s.jsx)(X,{children:`${e?"+":""}${n} role${n>1?"s":""}`})}):!e&&(0,s.jsx)(X,{children:(0,s.jsx)(L.x6,{i18nKey:"role-picker.input.no-roles",children:"No roles assigned"})})})},Be=(e,n,p,c,i,h)=>{const I=(0,N.n)({theme:e,invalid:n});return{wrapper:(0,t.cx)(I.wrapper,(0,Z.Xb)(e,n),p&&(0,t.css)((0,q.getFocusStyles)(e)),c&&I.inputDisabled,(0,t.css)({minWidth:h||ve+"px",width:h,minHeight:"32px",maxHeight:"200px",overflow:"scroll",overflowX:"hidden",overflowY:"auto",height:"auto",flexDirection:"row",paddingRight:e.spacing(1),maxWidth:"100%",alignItems:"center",display:"flex",flexWrap:"wrap",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",cursor:"default"}),i&&(0,t.css)({paddingLeft:0})),input:(0,t.cx)((0,Z.Xb)(e,n),(0,t.css)({maxWidth:"120px",border:"none",cursor:p?"default":"pointer"})),suffix:I.suffix,dropdownIndicator:(0,t.css)({cursor:"pointer"}),selectedRoles:(0,t.css)({display:"flex",alignItems:"center",cursor:c?"not-allowed":"pointer"}),tooltip:(0,t.css)({p:{marginBottom:e.spacing(.5)}}),spinner:(0,t.css)({display:"flex",flexGrow:1,justifyContent:"flex-end"})}},Te=e=>({tooltip:(0,t.css)({p:{marginBottom:e.spacing(.5)}})});var Ae=f(89640),Ce=f(92807),Re=f(41654),ae=f(45861),le=f(90382),Ue=f(16203),He=f(73427);const J=e=>({hideScrollBar:(0,t.css)({".scrollbar-view":{"&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none"}}),menuWrapper:(0,t.css)({display:"flex",maxHeight:"650px",position:"absolute",zIndex:e.zIndex.dropdown,overflow:"hidden",minWidth:"auto"}),menu:(0,t.css)({minWidth:`${Ge}px`,maxWidth:`${V}px`,"& > div":{paddingTop:e.spacing(1)}}),menuLeft:(0,t.css)({flexDirection:"row-reverse"}),subMenu:(0,t.css)({height:"100%",minWidth:`${Ee}px`,maxWidth:`${je}px`,display:"flex",flexDirection:"column",borderLeft:`1px solid ${e.components.input.borderColor}`,"& > div":{paddingTop:e.spacing(1)}}),subMenuLeft:(0,t.css)({borderRight:`1px solid ${e.components.input.borderColor}`,borderLeft:"unset"}),groupHeader:(0,t.css)({padding:e.spacing(0,4.5),display:"flex",alignItems:"center",color:e.colors.text.primary,fontWeight:e.typography.fontWeightBold}),container:(0,t.css)({padding:e.spacing(1),border:`1px ${e.colors.border.weak} solid`,borderRadius:e.shape.radius.default,backgroundColor:e.colors.background.primary,zIndex:e.zIndex.modal}),menuSection:(0,t.css)({marginBottom:e.spacing(2)}),menuOptionCheckbox:(0,t.css)({display:"flex",margin:e.spacing(0,1,0,.25)}),menuButtonRow:(0,t.css)({backgroundColor:e.colors.background.primary,padding:e.spacing(1)}),menuOptionBody:(0,t.css)({fontWeight:e.typography.fontWeightRegular,padding:e.spacing(0,1.5,0,0)}),menuOptionDisabled:(0,t.css)({color:e.colors.text.disabled,cursor:"not-allowed"}),menuOptionExpand:(0,t.css)({position:"absolute",right:e.spacing(2.5),color:e.colors.text.disabled,"&:after":{content:'">"'}}),menuOptionInfoSign:(0,t.css)({color:e.colors.text.disabled}),basicRoleSelector:(0,t.css)({margin:e.spacing(1,1.25,1,1.5)}),subMenuPortal:(0,t.css)({height:"100%","> div":{height:"100%"}}),subMenuButtonRow:(0,t.css)({backgroundColor:e.colors.background.primary,padding:e.spacing(1)}),checkboxPartiallyChecked:(0,t.css)({input:{"&:checked + span":{"&:after":{borderWidth:"0 3px 0px 0",transform:"rotate(90deg)"}}}}),loadingSpinner:(0,t.css)({marginLeft:e.spacing(1)})}),ze=({value:e,onChange:n,disabled:p,disabledMesssage:c,tooltipMessage:i})=>{const h=(0,S.of)(J),I=(0,S.$j)(),P=Object.values(le.X).filter(j=>!(j===le.X.None&&!He.TP.licensedAccessControlEnabled())).map(j=>({label:j===le.X.None?"No basic role":j,value:j}));return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:h.groupHeader,children:[(0,s.jsx)("span",{style:{marginRight:I.spacing(1)},children:(0,s.jsx)(L.x6,{i18nKey:"role-picker.built-in.basic-roles",children:"Basic roles"})}),p&&c&&(0,s.jsx)(v.m,{placement:"right-end",interactive:!0,content:(0,s.jsx)("div",{children:c}),children:(0,s.jsx)(O.I,{name:"question-circle"})}),!p&&i&&(0,s.jsx)(v.m,{placement:"right-end",interactive:!0,content:i,children:(0,s.jsx)(O.I,{name:"info-circle",size:"xs"})})]}),(0,s.jsx)(Ue.a,{name:"Basic Role Selector",className:h.basicRoleSelector,options:P,value:e,onChange:n,disabled:p})]})};var be=f(32635);const Se=(0,o.memo)(o.forwardRef(({name:e,value:n,isFocused:p,isSelected:c,partiallySelected:i,disabled:h,onChange:I,onClick:P,onOpenSubMenu:j,onCloseSubMenu:R,children:x,root:$},m)=>{const k=(0,S.$j)(),W=(0,H.J)(k),a=(0,S.of)(J),C=(0,t.cx)(W.option,p&&W.optionFocused,h&&a.menuOptionDisabled),G=A=>{h||n&&I(n)},z=A=>{P&&P(n)},B=()=>{j&&j(n)},D=()=>{R&&R()};return(0,s.jsx)("div",{onMouseEnter:B,onMouseLeave:D,children:(0,s.jsxs)("div",{ref:m,className:C,"aria-label":(0,L.t)("role-picker.menu-group-option-aria-label","Role picker option"),onClick:z,children:[(0,s.jsx)(be.S,{value:c,className:(0,t.cx)(a.menuOptionCheckbox,{[a.checkboxPartiallyChecked]:i}),onChange:G,disabled:h}),(0,s.jsxs)("div",{className:(0,t.cx)(W.optionBody,a.menuOptionBody),children:[(0,s.jsx)("span",{children:e}),(0,s.jsx)("span",{className:a.menuOptionExpand})]}),$&&x&&(0,s.jsx)(K.ZL,{className:a.subMenuPortal,root:$,children:x})]})})}));Se.displayName="RoleMenuGroupOption";const ce=(0,o.forwardRef)(({data:e,isFocused:n,isSelected:p,useFilteredDisplayName:c,disabled:i,mapped:h,onChange:I,hideDescription:P},j)=>{const R=(0,S.$j)(),x=(0,H.J)(R),$=(0,S.of)(J);i=i||h;let m="";i&&(m="You do not have permissions to assign this role.",h&&(m="Role assignment cannot be removed because the role is mapped through group sync."));const k=(0,t.cx)(x.option,n&&x.optionFocused,i&&$.menuOptionDisabled),W=a=>{i||(a.preventDefault(),a.stopPropagation(),I(e))};return(0,s.jsxs)("div",{ref:j,className:k,"aria-label":(0,L.t)("role-picker.menu-option-aria-label","Role picker option"),onClick:W,children:[(0,s.jsx)(be.S,{value:p,className:$.menuOptionCheckbox,onChange:W,disabled:i}),(0,s.jsxs)("div",{className:(0,t.cx)(x.optionBody,$.menuOptionBody),children:[(0,s.jsx)("span",{children:c&&e.filteredDisplayName||e.displayName||e.name}),!P&&e.description&&(0,s.jsx)("div",{className:x.optionDescription,children:e.description})]}),m&&(0,s.jsx)(v.m,{content:m,children:(0,s.jsx)(O.I,{name:"lock"})}),e.description&&(0,s.jsx)(v.m,{content:e.description,children:(0,s.jsx)(O.I,{name:"info-circle",className:$.menuOptionInfoSign})})]})});ce.displayName="RoleMenuOption";var ue=f(17411);const Fe=({options:e,selectedOptions:n,disabledOptions:p,onSelect:c,onClear:i,showOnLeft:h})=>{const I=(0,S.$j)(),P=(0,H.J)(I),j=(0,S.of)(J),R=async()=>{i&&i()};return(0,s.jsxs)("div",{className:(0,t.cx)(j.subMenu,{[j.subMenuLeft]:h}),"aria-label":(0,L.t)("role-picker.sub-menu-aria-label","Role picker submenu"),children:[(0,s.jsx)(Ce.P,{maxHeight:`${_}px`,children:(0,s.jsx)("div",{className:P.optionBody,children:e.map((x,$)=>(0,s.jsx)(ce,{data:x,useFilteredDisplayName:!1,isSelected:!!(x.uid&&(n.find(m=>m.uid===x.uid)||p?.find(m=>m.uid===x.uid))),disabled:!!(x.uid&&p?.find(m=>m.uid===x.uid))||(0,ue.WV)(x),mapped:!!(x.uid&&n.find(m=>m.uid===x.uid&&m.mapped)),onChange:c,hideDescription:!0},$))})}),(0,s.jsx)("div",{className:j.subMenuButtonRow,children:(0,s.jsx)(Re.B,{justifyContent:"flex-end",children:(0,s.jsx)(ae.$n,{size:"sm",fill:"text",onClick:R,children:(0,s.jsx)(L.x6,{i18nKey:"role-picker.sub-menu.clear-button",children:"Clear"})})})})]})},Me=(0,o.forwardRef)(({roles:e,isFiltered:n,renderedName:p,showGroups:c,optionGroups:i,onGroupChange:h,groupSelected:I,groupPartiallySelected:P,subMenuNode:j,selectedOptions:R,onRoleChange:x,onClearSubMenu:$,showOnLeftSubMenu:m},k)=>{const[W,a]=(0,o.useState)(!1),[C,G]=(0,o.useState)(""),z=(0,S.$j)(),B=(0,H.J)(z),D=(0,S.of)(J),A=(0,o.useCallback)(y=>{G(y),a(!0)},[]),ee=(0,o.useCallback)(()=>{a(!1),G("")},[]);return(0,s.jsx)("div",{children:e.length>0&&(0,s.jsxs)("div",{className:D.menuSection,children:[(0,s.jsx)("div",{className:D.groupHeader,children:p}),(0,s.jsx)("div",{className:B.optionBody}),c&&i?.length?i.map(y=>(0,s.jsx)(Se,{name:y.name,value:y.value,isSelected:I(y.value)||P(y.value),partiallySelected:P(y.value),disabled:y.options?.every(E=>(0,ue.WV)(E)||R.find(F=>F.uid===E.uid&&F.mapped)),onChange:h,onOpenSubMenu:A,onCloseSubMenu:ee,root:j,isFocused:W&&C===y.value,children:W&&C===y.value&&(0,s.jsx)(Fe,{options:y.options,selectedOptions:R,onSelect:x,onClear:()=>$(C),showOnLeft:m})},y.value)):e.map(y=>(0,s.jsx)(ce,{useFilteredDisplayName:n,data:y,isSelected:!!(y.uid&&R.find(E=>E.uid===y.uid)),disabled:(0,ue.WV)(y),mapped:!!(y.uid&&R.find(E=>E.uid===y.uid&&E.mapped)),onChange:x,hideDescription:!0},y.uid))]})})});Me.displayName="RoleMenuGroupsSection";var Ke=(e=>(e.fixed="fixed",e.custom="custom",e.plugin="plugin",e))(Ke||{});const Xe={ldap:"LDAP",current:"Current org"},Ve=(0,s.jsxs)(L.x6,{i18nKey:"role-picker.menu.tooltip",children:['You can now select the "No basic role" option and add permissions to your custom needs. You can find more information in\xA0',(0,s.jsx)(Ae.Y,{href:"https://grafana.com/docs/grafana/latest/administration/roles-and-permissions/#organization-roles",variant:"bodySmall",external:!0,children:"our documentation"}),"."]}),Je=({basicRole:e,options:n,isFiltered:p,appliedRoles:c,showGroups:i,basicRoleDisabled:h,disabledMessage:I,showBasicRole:P,onSelect:j,onBasicRoleSelect:R,onUpdate:x,updateDisabled:$,offset:m,menuLeft:k,apply:W})=>{const[a,C]=(0,o.useState)(c),[G,z]=(0,o.useState)(e),[B,D]=(0,o.useState)({}),A=(0,o.useRef)(null),ee=(0,S.$j)(),y=(0,H.J)(ee),E=(0,S.of)(J);(0,o.useEffect)(()=>{j(a)},[a,j]),(0,o.useEffect)(()=>{R&&G&&R(G)},[G,R]),(0,o.useEffect)(()=>{const g=n.filter(Ye).sort(ie),l=n.filter(Qe).sort(ie),u=n.filter(Ze).sort(ie),b={fixed:de(l).sort((r,d)=>r.name.localeCompare(d.name)),custom:de(g).sort((r,d)=>r.name.localeCompare(d.name)),plugin:de(u).sort((r,d)=>r.name.localeCompare(d.name))};D({fixed:{groupType:"fixed",optionGroup:b.fixed,renderedName:"Fixed roles",roles:l},custom:{groupType:"custom",optionGroup:b.custom,renderedName:"Custom roles",roles:g},plugin:{groupType:"plugin",optionGroup:b.plugin,renderedName:"Plugin roles",roles:u}})},[n]);const F=g=>{const l=[];for(const u of a)pe(u)===g&&l.push(u);return l},se=(g,l)=>{const u=F(l),b=B[g]?.optionGroup.find(r=>r.value===l);return u.length>0&&u.length>=b.options.length},me=(g,l)=>{const u=F(l),b=B[g]?.optionGroup.find(r=>r.value===l);return u.length>0&&u.length<b.options.length},ne=(g,l)=>{const b=F(l).filter(d=>d.delegatable&&!d.mapped),r=B[g]?.optionGroup.find(d=>d.value===l);return b.length>0&&b.length<r.options.length},Y=g=>{a.find(l=>l.uid===g.uid&&!l.mapped)?C(a.filter(l=>l.uid!==g.uid)):C([...a,g])},fe=(g,l)=>{const u=B[g]?.optionGroup.find(b=>b.value===l);if(u)if(se(g,l)||ne(g,l)){const b=a.filter(d=>u.options.find(w=>w.uid===d.uid&&d.mapped)),r=a.filter(d=>!u.options.find(w=>d.uid===w.uid));C([...r,...b])}else{const b=a.filter(w=>u.options.find(U=>U.uid===w.uid&&U.delegatable)),r=u.options.filter(w=>w.delegatable&&!a.find(U=>w.uid===U.uid&&U.mapped)),d=a.filter(w=>!u.options.find(U=>w.uid===U.uid));C([...d,...r,...b])}},xe=g=>{z(g)},re=async()=>{const g=a.filter(u=>u.mapped),l=n.filter(u=>a.find(b=>u.uid===b.uid&&!u.delegatable));C([...g,...l])},ge=g=>{const l=a.filter(u=>pe(u)!==g||u.mapped);C(l)},he=()=>{x(a,G)};return(0,s.jsxs)("div",{className:(0,t.cx)(y.menu,E.menuWrapper,{[E.menuLeft]:k},(0,t.css)({top:`${m.vertical}px`,left:k?"unset":`${m.horizontal}px`,right:k?`${m.horizontal}px`:"unset"})),children:[(0,s.jsxs)("div",{className:E.menu,"aria-label":(0,L.t)("role-picker.menu-aria-label","Role picker menu"),children:[(0,s.jsxs)(Ce.P,{maxHeight:`${_}px`,scrollbarWidth:"none",children:[P&&(0,s.jsx)("div",{className:E.menuSection,children:(0,s.jsx)(ze,{value:G,onChange:xe,disabled:h,disabledMesssage:I,tooltipMessage:Ve})}),Object.entries(B).map(([g,l])=>(0,s.jsx)(Me,{roles:l.roles,isFiltered:p,renderedName:l.renderedName,showGroups:i,optionGroups:l.optionGroup,groupSelected:u=>se(l.groupType,u),groupPartiallySelected:u=>me(l.groupType,u),onGroupChange:u=>fe(l.groupType,u),subMenuNode:A?.current,selectedOptions:a,onRoleChange:Y,onClearSubMenu:ge,showOnLeftSubMenu:k},g))]}),(0,s.jsx)("div",{className:E.menuButtonRow,children:(0,s.jsxs)(Re.B,{justifyContent:"flex-end",children:[(0,s.jsx)(ae.$n,{size:"sm",fill:"text",onClick:re,disabled:$,children:(0,s.jsx)(L.x6,{i18nKey:"role-picker.menu.clear-button",children:"Clear all"})}),(0,s.jsx)(ae.$n,{size:"sm",onClick:he,disabled:$,children:W?"Apply":"Update"})]})})]}),(0,s.jsx)("div",{ref:A})]})},Ye=e=>!e.name?.startsWith("fixed:")&&!e.name.startsWith("plugins:"),Qe=e=>e.name?.startsWith("fixed:"),Ze=e=>e.name?.startsWith("plugins:"),de=e=>{const n={};return e.forEach(c=>{const i=pe(c),h=Oe(c);n[i]||(n[i]={name:h,roles:[]}),n[i].roles.push(c)}),Object.entries(n).map(([c,i])=>({name:Xe[c]||_e(i.name),value:c,options:i.roles.sort(ie)}))},pe=e=>{const n=qe(e),p=Oe(e);return`${n}:${p}`},Oe=e=>e.group||"Other",qe=e=>{const n=e.name.indexOf(":");return n<0?"unknown":e.name.substring(0,n)},ie=(e,n)=>e.name.localeCompare(n.name),_e=e=>e.slice(0,1).toUpperCase()+e.slice(1),es=({basicRole:e,appliedRoles:n,roleOptions:p,disabled:c,isLoading:i,basicRoleDisabled:h,basicRoleDisabledMessage:I,showBasicRole:P,onRolesChange:j,onBasicRoleChange:R,canUpdateRoles:x=!0,apply:$=!1,maxWidth:m=ve,width:k})=>{const[W,a]=(0,o.useState)(!1),[C,G]=(0,o.useState)(n),[z,B]=(0,o.useState)(e),[D,A]=(0,o.useState)(""),[ee,y]=(0,o.useState)({vertical:0,horizontal:0}),[E,F]=(0,o.useState)(!1),se=(0,o.useRef)(null),me=(0,S.$j)(),ne=typeof k=="number"?me.spacing(k):k;(0,o.useEffect)(()=>{B(e),G(n)},[n,e,R]);const Y=(0,o.useCallback)(()=>{const{horizontal:r,vertical:d,menuToLeft:w}=fe();r&&d&&(y({horizontal:r,vertical:d}),F(w))},[]);(0,o.useEffect)(()=>{W&&Y()},[W,C,Y]);const fe=()=>{const r=se?.current?.getBoundingClientRect();if(!r)return{};const{bottom:d,top:w,left:U,right:Ie}=r,We=window.innerHeight-d,ss=w,ns=window.innerWidth-Ie,ts=U;let te=U,oe=d,Pe=!1,$e=!1;return We<_&&ss>We&&(oe=w-_,$e=!0),ns<V&&ts<V?(te=Ie-V,Pe=!0):te=Math.max(0,U+(r.width-V)/2),te=Math.max(0,Math.min(te,window.innerWidth-we)),oe=Math.max(0,Math.min(oe,window.innerHeight-_)),$e&&(oe-=48),{horizontal:te,vertical:oe,menuToLeft:Pe}},xe=(0,o.useCallback)(r=>{c||(r.preventDefault(),r.stopPropagation(),Y(),a(!0))},[c,Y]),re=(0,o.useCallback)(()=>{a(!1),A(""),G(n),B(e)},[n,e]),ge=()=>W&&re(),he=r=>{A(r||"")},g=r=>{G(r)},l=r=>{B(r)},u=(r,d)=>{R&&d&&d!==e&&R(d),x&&j(r),A(""),a(!1)},b=()=>{const r=p.map(d=>({...d,delegatable:x&&d.delegatable}));return D&&D.trim()!==""?r.filter(d=>d.name?.toLowerCase().includes(D.toLowerCase())):r};return(0,s.jsx)("div",{"data-testid":"role-picker",style:{position:"relative",maxWidth:ne||m,width:ne},ref:se,children:(0,s.jsxs)(M.N,{onClick:ge,useCapture:!1,children:[(0,s.jsx)(Ne,{basicRole:z,appliedRoles:C,query:D,onQueryChange:he,onOpen:xe,onClose:re,isFocused:W,disabled:c,showBasicRole:P,width:ne,isLoading:i}),W&&(0,s.jsx)(K.ZL,{children:(0,s.jsx)("div",{onClick:r=>r.stopPropagation(),children:(0,s.jsx)(Je,{options:b(),isFiltered:D.trim()!=="",basicRole:z,appliedRoles:n,onBasicRoleSelect:l,onSelect:g,onUpdate:u,showGroups:D.length===0||D.trim()==="",basicRoleDisabled:h,disabledMessage:I,showBasicRole:P,updateDisabled:h&&!x,apply:$,offset:ee,menuLeft:E})})})]})})}}}]);

//# sourceMappingURL=265.b044323886617024415a.js.map